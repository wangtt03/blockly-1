{"version":3,"sources":["webpack:/// [synthetic:base] ","webpack:/// [synthetic:util/checkstringargs] ","webpack:/// [synthetic:util/defines] ","webpack:/// [synthetic:util/defineproperty] ","webpack:/// [synthetic:util/global] ","webpack:/// [synthetic:util/polyfill] ","webpack:/// [synthetic:es6/string/repeat] ","webpack:/// [synthetic:util/findinternal] ","webpack:/// [synthetic:es6/array/findindex] ","webpack:/// [synthetic:es6/array/find] ","webpack:/// [synthetic:es6/symbol] ","webpack:/// [synthetic:es6/util/iteratorfromarray] ","webpack:/// [synthetic:es6/array/keys] ","webpack:/// [synthetic:es6/string/endswith] ","webpack:/// [synthetic:es6/string/startswith] ","webpack:/// [synthetic:es6/array/values] ","webpack:///node_modules/google-closure-library/closure/goog/base.js","webpack:///core/ui/block_svg/block_svg_unused.js","webpack:///node_modules/google-closure-library/closure/goog/debug/error.js","webpack:///node_modules/google-closure-library/closure/goog/dom/nodetype.js","webpack:///node_modules/google-closure-library/closure/goog/string/string.js","webpack:///node_modules/google-closure-library/closure/goog/asserts/asserts.js","webpack:///node_modules/google-closure-library/closure/goog/array/array.js","webpack:///node_modules/google-closure-library/closure/goog/labs/useragent/util.js","webpack:///node_modules/google-closure-library/closure/goog/object/object.js","webpack:///node_modules/google-closure-library/closure/goog/labs/useragent/browser.js","webpack:///node_modules/google-closure-library/closure/goog/labs/useragent/engine.js","webpack:///node_modules/google-closure-library/closure/goog/labs/useragent/platform.js","webpack:///node_modules/google-closure-library/closure/goog/reflect/reflect.js","webpack:///node_modules/google-closure-library/closure/goog/useragent/useragent.js","webpack:///core/ui/block_svg/block_svg.js","webpack:///core/ui/block_svg/block_svg_framed.js","webpack:///core/ui/block_svg/block_svg_functional.js","webpack:///blocks/block_stub.js","webpack:///core/ui/block_space/scrollbar.js","webpack:///node_modules/google-closure-library/closure/goog/math/math.js","webpack:///node_modules/google-closure-library/closure/goog/math/coordinate.js","webpack:///node_modules/google-closure-library/closure/goog/math/box.js","webpack:///node_modules/google-closure-library/closure/goog/math/irect.js","webpack:///node_modules/google-closure-library/closure/goog/math/size.js","webpack:///node_modules/google-closure-library/closure/goog/math/rect.js","webpack:///core/ui/block_space/trashcan.js","webpack:///core/ui/block_space/pan_drag_handler.js","webpack:///core/ui/block_space/scroll_on_wheel_handler.js","webpack:///node_modules/google-closure-library/closure/goog/disposable/idisposable.js","webpack:///node_modules/google-closure-library/closure/goog/disposable/disposable.js","webpack:///node_modules/google-closure-library/closure/goog/debug/entrypointregistry.js","webpack:///node_modules/google-closure-library/closure/goog/events/browserfeature.js","webpack:///node_modules/google-closure-library/closure/goog/events/eventid.js","webpack:///node_modules/google-closure-library/closure/goog/events/event.js","webpack:///node_modules/google-closure-library/closure/goog/events/eventtype.js","webpack:///node_modules/google-closure-library/closure/goog/events/browserevent.js","webpack:///node_modules/google-closure-library/closure/goog/events/listenable.js","webpack:///node_modules/google-closure-library/closure/goog/events/listener.js","webpack:///node_modules/google-closure-library/closure/goog/events/listenermap.js","webpack:///node_modules/google-closure-library/closure/goog/events/events.js","webpack:///node_modules/google-closure-library/closure/goog/functions/functions.js","webpack:///node_modules/google-closure-library/closure/goog/async/animationdelay.js","webpack:///core/ui/block_space/auto_scroll.js","webpack:///node_modules/google-closure-library/closure/goog/math/vec2.js","webpack:///core/ui/block_space/scroll_on_block_drag_handler.js","webpack:///core/utils/xml.js","webpack:///core/ui/block_space/block_space.js","webpack:///core/connections/connection.js","webpack:///node_modules/google-closure-library/closure/goog/dom/browserfeature.js","webpack:///node_modules/google-closure-library/closure/goog/dom/tagname.js","webpack:///node_modules/google-closure-library/closure/goog/dom/tags.js","webpack:///node_modules/google-closure-library/closure/goog/string/typedstring.js","webpack:///node_modules/google-closure-library/closure/goog/string/const.js","webpack:///node_modules/google-closure-library/closure/goog/html/safescript.js","webpack:///node_modules/google-closure-library/closure/goog/html/safestyle.js","webpack:///node_modules/google-closure-library/closure/goog/html/safestylesheet.js","webpack:///node_modules/google-closure-library/closure/goog/fs/url.js","webpack:///node_modules/google-closure-library/closure/goog/i18n/bidi.js","webpack:///node_modules/google-closure-library/closure/goog/html/safeurl.js","webpack:///node_modules/google-closure-library/closure/goog/html/trustedresourceurl.js","webpack:///node_modules/google-closure-library/closure/goog/html/safehtml.js","webpack:///node_modules/google-closure-library/closure/goog/dom/safe.js","webpack:///node_modules/google-closure-library/closure/goog/html/uncheckedconversions.js","webpack:///node_modules/google-closure-library/closure/goog/dom/dom.js","webpack:///node_modules/google-closure-library/closure/goog/dom/vendor.js","webpack:///node_modules/google-closure-library/closure/goog/html/legacyconversions.js","webpack:///node_modules/google-closure-library/closure/goog/style/style.js","webpack:///node_modules/google-closure-library/closure/goog/events/eventhandler.js","webpack:///node_modules/google-closure-library/closure/goog/events/eventtarget.js","webpack:///node_modules/google-closure-library/closure/goog/ui/idgenerator.js","webpack:///node_modules/google-closure-library/closure/goog/ui/component.js","webpack:///node_modules/google-closure-library/closure/goog/a11y/aria/roles.js","webpack:///node_modules/google-closure-library/closure/goog/a11y/aria/attributes.js","webpack:///node_modules/google-closure-library/closure/goog/a11y/aria/datatables.js","webpack:///node_modules/google-closure-library/closure/goog/a11y/aria/aria.js","webpack:///node_modules/google-closure-library/closure/goog/events/keycodes.js","webpack:///node_modules/google-closure-library/closure/goog/events/keyhandler.js","webpack:///node_modules/google-closure-library/closure/goog/dom/classlist.js","webpack:///node_modules/google-closure-library/closure/goog/ui/registry.js","webpack:///node_modules/google-closure-library/closure/goog/ui/containerrenderer.js","webpack:///node_modules/google-closure-library/closure/goog/ui/controlrenderer.js","webpack:///node_modules/google-closure-library/closure/goog/ui/control.js","webpack:///node_modules/google-closure-library/closure/goog/ui/container.js","webpack:///node_modules/google-closure-library/closure/goog/ui/menuheaderrenderer.js","webpack:///node_modules/google-closure-library/closure/goog/ui/menuheader.js","webpack:///node_modules/google-closure-library/closure/goog/ui/menuitemrenderer.js","webpack:///node_modules/google-closure-library/closure/goog/ui/menuitem.js","webpack:///node_modules/google-closure-library/closure/goog/ui/menuseparatorrenderer.js","webpack:///node_modules/google-closure-library/closure/goog/ui/separator.js","webpack:///node_modules/google-closure-library/closure/goog/ui/menurenderer.js","webpack:///node_modules/google-closure-library/closure/goog/ui/menuseparator.js","webpack:///node_modules/google-closure-library/closure/goog/ui/menu.js","webpack:///core/ui/contextmenu.js","webpack:///core/ui/fields/field.js","webpack:///core/ui/tooltip.js","webpack:///core/ui/fields/field_label.js","webpack:///core/ui/input.js","webpack:///core/namespaces/msg.js","webpack:///core/ui/bubble.js","webpack:///core/ui/icon.js","webpack:///core/ui/mutator.js","webpack:///core/ui/warning.js","webpack:///core/ui/block.js","webpack:///core/ui/fields/angle_helper.js","webpack:///core/utils/block_field_helper.js","webpack:///core/ui/fields/field_textinput.js","webpack:///core/ui/fields/field_angle.js","webpack:///core/ui/fields/field_button.js","webpack:///core/ui/fields/field_rectangular_dropdown.js","webpack:///core/ui/fields/field_checkbox.js","webpack:///node_modules/google-closure-library/closure/goog/color/names.js","webpack:///node_modules/google-closure-library/closure/goog/color/color.js","webpack:///node_modules/google-closure-library/closure/goog/iter/iter.js","webpack:///node_modules/google-closure-library/closure/goog/dom/tagiterator.js","webpack:///node_modules/google-closure-library/closure/goog/dom/nodeiterator.js","webpack:///node_modules/google-closure-library/closure/goog/ui/paletterenderer.js","webpack:///node_modules/google-closure-library/closure/goog/ui/selectionmodel.js","webpack:///node_modules/google-closure-library/closure/goog/ui/palette.js","webpack:///node_modules/google-closure-library/closure/goog/ui/colorpalette.js","webpack:///node_modules/google-closure-library/closure/goog/ui/colorpicker.js","webpack:///core/ui/fields/field_colour.js","webpack:///core/utils/image_dimension_cache.js","webpack:///core/ui/fields/field_image.js","webpack:///core/ui/fields/field_colour_dropdown.js","webpack:///core/ui/fields/field_dropdown.js","webpack:///core/ui/fields/field_angle_dropdown.js","webpack:///core/ui/fields/field_angle_textinput.js","webpack:///core/ui/fields/field_icon.js","webpack:///core/ui/fields/field_image_dropdown.js","webpack:///core/ui/block_space/block_limits.js","webpack:///core/ui/block_space/flyout.js","webpack:///node_modules/google-closure-library/closure/goog/events/focushandler.js","webpack:///node_modules/google-closure-library/closure/goog/structs/structs.js","webpack:///node_modules/google-closure-library/closure/goog/structs/collection.js","webpack:///node_modules/google-closure-library/closure/goog/structs/map.js","webpack:///node_modules/google-closure-library/closure/goog/structs/set.js","webpack:///node_modules/google-closure-library/closure/goog/debug/debug.js","webpack:///node_modules/google-closure-library/closure/goog/debug/logrecord.js","webpack:///node_modules/google-closure-library/closure/goog/debug/logbuffer.js","webpack:///node_modules/google-closure-library/closure/goog/debug/logger.js","webpack:///node_modules/google-closure-library/closure/goog/log/log.js","webpack:///node_modules/google-closure-library/closure/goog/promise/thenable.js","webpack:///node_modules/google-closure-library/closure/goog/async/freelist.js","webpack:///node_modules/google-closure-library/closure/goog/async/workqueue.js","webpack:///node_modules/google-closure-library/closure/goog/async/nexttick.js","webpack:///node_modules/google-closure-library/closure/goog/async/run.js","webpack:///node_modules/google-closure-library/closure/goog/promise/resolver.js","webpack:///node_modules/google-closure-library/closure/goog/promise/promise.js","webpack:///node_modules/google-closure-library/closure/goog/timer/timer.js","webpack:///node_modules/google-closure-library/closure/goog/string/stringbuffer.js","webpack:///node_modules/google-closure-library/closure/goog/ui/tree/basenode.js","webpack:///node_modules/google-closure-library/closure/goog/ui/tree/treenode.js","webpack:///node_modules/google-closure-library/closure/goog/structs/trie.js","webpack:///node_modules/google-closure-library/closure/goog/ui/tree/typeahead.js","webpack:///node_modules/google-closure-library/closure/goog/ui/tree/treecontrol.js","webpack:///core/ui/block_space/toolbox.js","webpack:///core/utils/variables.js","webpack:///core/ui/fields/field_variable.js","webpack:///core/ui/fields/field_parameter.js","webpack:///core/ui/block_space/block_space_editor.js","webpack:///core/ui/block_space/horizontal_flyout.js","webpack:///node_modules/google-closure-library/closure/goog/structs/linkedmap.js","webpack:///core/ui/function_editor.js","webpack:///core/utils/block_value_type.js","webpack:///core/utils/functional_block_utils.js","webpack:///node_modules/google-closure-library/closure/goog/dom/classes.js","webpack:///core/ui/contract_editor/example_view.js","webpack:///core/ui/contract_editor/contract_editor_section_view.js","webpack:///core/ui/contract_editor/contract_definition_section.js","webpack:///core/ui/contract_editor/svg_header.js","webpack:///core/ui/contract_editor/svg_text_button.js","webpack:///core/ui/contract_editor/svg_highlight_box.js","webpack:///core/ui/contract_editor/type_dropdown.js","webpack:///core/ui/contract_editor/domain_name_input.js","webpack:///core/ui/contract_editor/x_button.js","webpack:///core/ui/contract_editor/domain_editor.js","webpack:///core/ui/closure_tools/custom_css_class_menu_renderer.js","webpack:///node_modules/google-closure-library/closure/goog/ui/buttonside.js","webpack:///node_modules/google-closure-library/closure/goog/ui/buttonrenderer.js","webpack:///node_modules/google-closure-library/closure/goog/dom/inputtype.js","webpack:///node_modules/google-closure-library/closure/goog/ui/nativebuttonrenderer.js","webpack:///node_modules/google-closure-library/closure/goog/ui/button.js","webpack:///node_modules/google-closure-library/closure/goog/ui/cssnames.js","webpack:///node_modules/google-closure-library/closure/goog/ui/flatbuttonrenderer.js","webpack:///node_modules/google-closure-library/closure/goog/style/bidi.js","webpack:///node_modules/google-closure-library/closure/goog/positioning/positioning.js","webpack:///node_modules/google-closure-library/closure/goog/positioning/abstractposition.js","webpack:///node_modules/google-closure-library/closure/goog/positioning/anchoredposition.js","webpack:///node_modules/google-closure-library/closure/goog/positioning/anchoredviewportposition.js","webpack:///node_modules/google-closure-library/closure/goog/positioning/menuanchoredposition.js","webpack:///node_modules/google-closure-library/closure/goog/ui/custombuttonrenderer.js","webpack:///node_modules/google-closure-library/closure/goog/ui/menubuttonrenderer.js","webpack:///node_modules/google-closure-library/closure/goog/useragent/product.js","webpack:///node_modules/google-closure-library/closure/goog/ui/menubutton.js","webpack:///node_modules/google-closure-library/closure/goog/ui/flatmenubuttonrenderer.js","webpack:///node_modules/google-closure-library/closure/goog/ui/option.js","webpack:///node_modules/google-closure-library/closure/goog/ui/select.js","webpack:///node_modules/google-closure-library/closure/goog/ui/decorate.js","webpack:///core/ui/contract_editor/contract_editor.js","webpack:///core/code_generation/generator.js","webpack:///core/code_generation/names.js","webpack:///core/utils/procedures.js","webpack:///node_modules/google-closure-library/closure/goog/cssom/cssom.js","webpack:///core/ui/css.js","webpack:///core/ui/widgetdiv.js","webpack:///core/initialization/inject.js","webpack:///node_modules/google-closure-library/closure/goog/memoize/memoize.js","webpack:///core/utils/utils.js","webpack:///blocks/colour.js","webpack:///blocks/functional_examples.js","webpack:///blocks/variables.js","webpack:///blocks/functional_parameters.js","webpack:///blocks/procedures.js","webpack:///blocks/functional_procedures.js","webpack:///blocks/lists.js","webpack:///blocks/logic.js","webpack:///blocks/loops.js","webpack:///blocks/math.js","webpack:///blocks/text.js","webpack:///blocks/unknown.js","webpack:///generators/javascript.js","webpack:///generators/javascript/colour.js","webpack:///generators/javascript/functional_examples.js","webpack:///generators/javascript/functional_parameters.js","webpack:///generators/javascript/functional_procedures.js","webpack:///generators/javascript/lists.js","webpack:///generators/javascript/logic.js","webpack:///generators/javascript/loops.js","webpack:///generators/javascript/math.js","webpack:///generators/javascript/procedures.js","webpack:///generators/javascript/text.js","webpack:///generators/javascript/variables.js","webpack:///core/initialization/blockly.js","webpack:///core/module.js"],"names":["$jscomp","scope","checkStringArgs","a","b","c","TypeError","RegExp","ASSUME_ES5","ASSUME_NO_NATIVE_MAP","ASSUME_NO_NATIVE_SET","defineProperty","Object","defineProperties","Array","prototype","value","getGlobal","window","global","this","polyfill","d","split","length","e","configurable","writable","RangeError","findInternal","String","f","call","i","v","SYMBOL_PREFIX","initSymbol","Symbol","initSymbolIterator","iterator","arrayIterator","iteratorPrototype","done","next","iteratorFromArray","Math","max","min","g","COMPILED","goog","isDef","goog.isDef","val","exportPath_","goog.exportPath_","name","opt_object","opt_objectToExportTo","parts","cur","execScript","part","shift","define","goog.define","defaultValue","CLOSURE_UNCOMPILED_DEFINES","hasOwnProperty","CLOSURE_DEFINES","DEBUG","LOCALE","TRUSTED_SITE","STRICT_MODE_COMPATIBLE","DISALLOW_TEST_ONLY_CODE","ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING","provide","goog.provide","isInModuleLoader_","Error","isProvided_","constructNamespace_","goog.constructNamespace_","opt_obj","implicitNamespaces_","namespace","substring","lastIndexOf","getObjectByName","VALID_MODULE_RE_","module","goog.module","isString","search","moduleLoaderState_","moduleName","get","goog.module.get","getInternal_","goog.module.getInternal_","loadedModules_","ns","goog.isInModuleLoader_","declareLegacyNamespace","goog.module.declareLegacyNamespace","setTestOnly","goog.setTestOnly","opt_message","forwardDeclare","goog.forwardDeclare","goog.isProvided_","isDefAndNotNull","goog.getObjectByName","globalize","goog.globalize","obj","opt_global","x","addDependency","goog.addDependency","relPath","provides","requires","opt_loadFlags","DEPENDENCIES_ENABLED","path","replace","deps","dependencies_","nameToPath","loadFlags","j","require","ENABLE_DEBUG_LOADER","logToConsole_","goog.logToConsole_","msg","console","error","goog.require","IS_OLD_IE_","maybeProcessDeferredDep_","getPathFromDeps_","errorMessage","writeScripts_","basePath","nullFunction","goog.nullFunction","abstractMethod","goog.abstractMethod","addSingletonGetter","goog.addSingletonGetter","ctor","instance_","undefined","getInstance","ctor.getInstance","instantiatedSingletons_","LOAD_MODULE_USING_EVAL","SEAL_MODULE_EXPORTS","TRANSPILE","TRANSPILER","visited","written","deferred","inHtmlDocument_","goog.inHtmlDocument_","doc","document","findBasePath_","goog.findBasePath_","CLOSURE_BASE_PATH","scripts","getElementsByTagName","src","qmark","l","substr","importScript_","goog.importScript_","opt_sourceText","CLOSURE_IMPORT_SCRIPT","writeScriptTag_","atob","all","importProcessedScript_","goog.importProcessedScript_","isModule","needsTranspile","queuedModules_","wrapModule_","goog.wrapModule_","srcUrl","scriptText","JSON","stringify","loadQueuedModules_","goog.loadQueuedModules_","count","queue","maybeProcessDeferredPath_","goog.maybeProcessDeferredDep_","isDeferredModule_","allDepsAreAvailable_","goog.isDeferredModule_","languageLevel","lang","needsTranspile_","goog.allDepsAreAvailable_","requireName","goog.maybeProcessDeferredPath_","abspath","globalEval","loadModuleFromUrl","goog.loadModuleFromUrl","url","retrieveAndExec_","writeScriptSrcNode_","goog.writeScriptSrcNode_","write","appendScriptSrcNode_","goog.appendScriptSrcNode_","scriptEl","createElement","type","defer","async","head","appendChild","goog.writeScriptTag_","readyState","test","state","lastNonModuleScriptIndex_","protectScriptTag_","goog.protectScriptTag_","str","goog.needsTranspile_","requiresTranspilation_","createRequiresTranspilation_","onScriptLoad_","goog.onScriptLoad_","script","scriptIndex","goog.writeScripts_","pathToLoad","seenScript","visitNode","push","moduleState","goog.getPathFromDeps_","rule","CLOSURE_NO_DEPS","loadModule","goog.loadModule","moduleDef","previousState","isFunction","exports","loadModuleFromSource_","seal","isObject","goog.loadModuleFromSource_","eval","normalizePath_","goog.normalizePath_","components","splice","join","loadFileSync_","goog.loadFileSync_","CLOSURE_LOAD_FILE_SYNC","xhr","XMLHttpRequest","open","send","status","responseText","err","goog.retrieveAndExec_","originalPath","importScript","transpile_","goog.transpile_","code","jscomp","transpile","transpilerPath","transpilerCode","$gwtExport","jscomp.transpile","suffix","typeOf","goog.typeOf","s","className","toString","propertyIsEnumerable","isNull","goog.isNull","goog.isDefAndNotNull","isArray","goog.isArray","isArrayLike","goog.isArrayLike","isDateLike","goog.isDateLike","getFullYear","goog.isString","isBoolean","goog.isBoolean","isNumber","goog.isNumber","goog.isFunction","goog.isObject","getUid","goog.getUid","UID_PROPERTY_","uidCounter_","hasUid","goog.hasUid","removeUid","goog.removeUid","removeAttribute","ex","random","getHashCode","removeHashCode","cloneObject","goog.cloneObject","clone","key","bindNative_","goog.bindNative_","fn","selfObj","var_args","apply","bind","arguments","bindJs_","goog.bindJs_","boundArgs","slice","newArgs","unshift","goog.bind","Function","indexOf","partial","goog.partial","args","mixin","goog.mixin","target","source","now","Date","goog.globalEval","evalWorksForGlobals_","_evalTest_","ignore","scriptElt","createTextNode","body","removeChild","getCssName","goog.getCssName","opt_modifier","charAt","getMapping","cssName","cssNameMapping_","renameByParts","mapped","rename","cssNameMappingStyle_","result","CLOSURE_CSS_NAME_MAP_FN","setCssNameMapping","goog.setCssNameMapping","mapping","opt_style","CLOSURE_CSS_NAME_MAPPING","getMsg","goog.getMsg","opt_values","match","getMsgWithFallback","goog.getMsgWithFallback","exportSymbol","goog.exportSymbol","publicPath","object","exportProperty","goog.exportProperty","publicName","symbol","inherits","goog.inherits","childCtor","parentCtor","tempCtor","superClass_","constructor","base","childCtor.base","me","methodName","goog.base","opt_methodName","caller","callee","ctorArgs","foundCaller","goog.scope","defineClass","goog.defineClass","superClass","def","statics","cls","createSealingConstructor_","applyProperties_","SEAL_CLASS_INSTANCES","goog.defineClass.createSealingConstructor_","ctr","superclassSealable","isUnsealable_","wrappedCtr","instance","goog.defineClass.isUnsealable_","UNSEALABLE_CONSTRUCTOR_PROPERTY_","OBJECT_PROTOTYPE_FIELDS_","goog.defineClass.applyProperties_","tagUnsealableClass","goog.tagUnsealableClass","goog.createRequiresTranspilation_","addNewerLanguageTranspilationCheck","modeName","isSupported","transpilationRequiredForAllLaterModes","requiresTranspilation","evalCheck","ignored","es3","Blockly","FRAME_MARGIN_SIDE","FRAME_MARGIN_TOP","FRAME_MARGIN_BOTTOM","FRAME_HEADER_HEIGHT","BlockSvgUnused","Blockly.BlockSvgUnused","block","block_","frameHelp_","frameText_","frameHeader_","frameBase_","frameClipRect_","frameGroup_","bindData_","initChildren","UNUSED_BLOCK_HELP_EVENT","Blockly.BlockSvgUnused.prototype.initChildren","createSvgElement","class","clip","id","y","height","fill","stroke","rx","ry","clip-path","frameTextVerticalPosition","ieVersion","style","dominant-baseline","Msg","UNUSED_CODE","r","getPadding","Blockly.BlockSvgUnused.prototype.getPadding","top","right","bottom","left","bindClickEvent","Blockly.BlockSvgUnused.prototype.bindClickEvent","isbound_","bindEvent_","isRightButton","fireUiEvent","stopPropagation","preventDefault","render","Blockly.BlockSvgUnused.prototype.render","svgGroup","dom","removeNode","groupRect","getBoundingClientRect","insertChildAt","addClass_","frameGroup","setTimeout","removeClass_","minWidth","width","setAttribute","RTL","dispose","Blockly.BlockSvgUnused.prototype.dispose","unbindEvent_","goog.debug","debug","goog.debug.Error","opt_msg","captureStackTrace","stack","message","reportErrorToServer","goog.dom","NodeType","ELEMENT","ATTRIBUTE","TEXT","CDATA_SECTION","ENTITY_REFERENCE","ENTITY","PROCESSING_INSTRUCTION","COMMENT","DOCUMENT","DOCUMENT_TYPE","DOCUMENT_FRAGMENT","NOTATION","goog.string","string","DETECT_DOUBLE_ESCAPING","FORCE_NON_DOM_HTML_UNESCAPING","Unicode","NBSP","startsWith","goog.string.startsWith","prefix","endsWith","goog.string.endsWith","caseInsensitiveStartsWith","goog.string.caseInsensitiveStartsWith","caseInsensitiveCompare","caseInsensitiveEndsWith","goog.string.caseInsensitiveEndsWith","caseInsensitiveEquals","goog.string.caseInsensitiveEquals","str1","str2","toLowerCase","subs","goog.string.subs","splitParts","returnString","subsArguments","collapseWhitespace","goog.string.collapseWhitespace","isEmptyOrWhitespace","goog.string.isEmptyOrWhitespace","isEmptyString","goog.string.isEmptyString","isEmpty","isEmptyOrWhitespaceSafe","goog.string.isEmptyOrWhitespaceSafe","makeSafe","isEmptySafe","isBreakingWhitespace","goog.string.isBreakingWhitespace","isAlpha","goog.string.isAlpha","isNumeric","goog.string.isNumeric","isAlphaNumeric","goog.string.isAlphaNumeric","isSpace","goog.string.isSpace","ch","isUnicodeChar","goog.string.isUnicodeChar","stripNewlines","goog.string.stripNewlines","canonicalizeNewlines","goog.string.canonicalizeNewlines","normalizeWhitespace","goog.string.normalizeWhitespace","normalizeSpaces","goog.string.normalizeSpaces","collapseBreakingSpaces","goog.string.collapseBreakingSpaces","trim","trimLeft","goog.string.trimLeft","trimRight","goog.string.trimRight","goog.string.caseInsensitiveCompare","test1","test2","numberAwareCompare_","goog.string.numberAwareCompare_","tokenizerRegExp","tokens1","tokens2","num1","parseInt","isNaN","num2","intAwareCompare","goog.string.intAwareCompare","floatAwareCompare","goog.string.floatAwareCompare","numerateCompare","urlEncode","goog.string.urlEncode","encodeURIComponent","urlDecode","goog.string.urlDecode","decodeURIComponent","newLineToBr","goog.string.newLineToBr","opt_xml","htmlEscape","goog.string.htmlEscape","opt_isLikelyToContainHtmlChars","AMP_RE_","LT_RE_","GT_RE_","QUOT_RE_","SINGLE_QUOTE_RE_","NULL_RE_","E_RE_","ALL_RE_","unescapeEntities","goog.string.unescapeEntities","contains","unescapeEntitiesUsingDom_","unescapePureXmlEntities_","unescapeEntitiesWithDocument","goog.string.unescapeEntitiesWithDocument","goog.string.unescapeEntitiesUsingDom_","opt_document","seen","&amp;","&lt;","&gt;","&quot;","div","HTML_ENTITY_PATTERN_","entity","n","Number","fromCharCode","innerHTML","firstChild","nodeValue","goog.string.unescapePureXmlEntities_","whitespaceEscape","goog.string.whitespaceEscape","preserveSpaces","goog.string.preserveSpaces","stripQuotes","goog.string.stripQuotes","quoteChars","quoteChar","truncate","goog.string.truncate","chars","opt_protectEscapedCharacters","truncateMiddle","goog.string.truncateMiddle","opt_trailingChars","endPoint","half","floor","endPos","specialEscapeChars_","\u0000","\b","\f","\n","\r","\t","\u000b","\"","\\","<","jsEscapeCache_","'","quote","goog.string.quote","sb","cc","charCodeAt","escapeChar","escapeString","goog.string.escapeString","goog.string.escapeChar","rv","toUpperCase","goog.string.contains","subString","caseInsensitiveContains","goog.string.caseInsensitiveContains","countOf","goog.string.countOf","ss","removeAt","goog.string.removeAt","index","stringLength","resultStr","remove","goog.string.remove","removeAll","goog.string.removeAll","re","regExpEscape","replaceAll","goog.string.replaceAll","replacement","goog.string.regExpEscape","repeat","padNumber","goog.string.padNumber","num","opt_precision","toFixed","goog.string.makeSafe","buildString","goog.string.buildString","getRandomString","goog.string.getRandomString","abs","compareVersions","goog.string.compareVersions","version1","version2","order","v1Subs","v2Subs","subCount","subIdx","v1Sub","v2Sub","v1Comp","exec","v2Comp","v1CompNum","v2CompNum","compareElements_","goog.string.compareElements_","hashCode","goog.string.hashCode","uniqueStringCounter_","createUniqueString","goog.string.createUniqueString","toNumber","goog.string.toNumber","NaN","isLowerCamelCase","goog.string.isLowerCamelCase","isUpperCamelCase","goog.string.isUpperCamelCase","toCamelCase","goog.string.toCamelCase","toSelectorCase","goog.string.toSelectorCase","toTitleCase","goog.string.toTitleCase","opt_delimiters","delimiters","regexp","p1","p2","capitalize","goog.string.capitalize","goog.string.parseInt","isFinite","splitLimit","goog.string.splitLimit","separator","limit","returnVal","lastComponent","goog.string.lastComponent","separators","lastSeparatorIndex","currentSeparatorIndex","editDistance","goog.string.editDistance","v0","v1","goog.asserts","asserts","ENABLE_ASSERTS","AssertionError","goog.asserts.AssertionError","messagePattern","messageArgs","DEFAULT_ERROR_HANDLER","goog.asserts.DEFAULT_ERROR_HANDLER","errorHandler_","doAssertFailure_","goog.asserts.doAssertFailure_","defaultMessage","defaultArgs","givenMessage","givenArgs","setErrorHandler","goog.asserts.setErrorHandler","errorHandler","assert","goog.asserts.assert","condition","fail","goog.asserts.fail","assertNumber","goog.asserts.assertNumber","assertString","goog.asserts.assertString","assertFunction","goog.asserts.assertFunction","assertObject","goog.asserts.assertObject","assertArray","goog.asserts.assertArray","assertBoolean","goog.asserts.assertBoolean","assertElement","goog.asserts.assertElement","nodeType","assertInstanceof","goog.asserts.assertInstanceof","getType_","assertObjectPrototypeIsIntact","goog.asserts.assertObjectPrototypeIsIntact","goog.asserts.getType_","displayName","goog.array","NATIVE_ARRAY_PROTOTYPES","array","ASSUME_NATIVE_FUNCTIONS","peek","goog.array.peek","last","arr","opt_fromIndex","fromIndex","forEach","arr2","forEachRight","goog.array.forEachRight","filter","res","resLength","map","reduce","rval","reduceRight","some","every","goog.array.count","element","find","goog.array.find","findIndex","goog.array.findIndex","findRight","goog.array.findRight","findIndexRight","goog.array.findIndexRight","goog.array.contains","goog.array.isEmpty","clear","goog.array.clear","insert","goog.array.insert","insertAt","goog.array.insertAt","opt_i","insertArrayAt","goog.array.insertArrayAt","elementsToAdd","insertBefore","goog.array.insertBefore","opt_obj2","goog.array.remove","removeLast","goog.array.removeLast","goog.array.removeAt","removeIf","goog.array.removeIf","removeAllIf","goog.array.removeAllIf","removedCount","concat","goog.array.concat","goog.array.join","toArray","goog.array.toArray","extend","goog.array.extend","arr1","len1","len2","goog.array.splice","howMany","goog.array.slice","start","opt_end","removeDuplicates","goog.array.removeDuplicates","opt_rv","opt_hashFn","returnArray","defaultHashFn","item","hashFn","cursorInsert","cursorRead","current","binarySearch","goog.array.binarySearch","opt_compareFn","binarySearch_","defaultCompare","binarySelect","goog.array.binarySelect","evaluator","goog.array.binarySearch_","compareFn","isEvaluator","opt_target","opt_selfObj","found","middle","compareResult","sort","goog.array.sort","stableSort","goog.array.stableSort","compArr","valueCompareFn","stableCompareFn","obj1","obj2","sortByKey","goog.array.sortByKey","keyFn","keyCompareFn","sortObjectsByKey","goog.array.sortObjectsByKey","isSorted","goog.array.isSorted","opt_strict","compare","equals","goog.array.equals","opt_equalsFn","equalsFn","defaultCompareEquality","compare3","goog.array.compare3","goog.array.defaultCompare","inverseDefaultCompare","goog.array.inverseDefaultCompare","goog.array.defaultCompareEquality","binaryInsert","goog.array.binaryInsert","binaryRemove","goog.array.binaryRemove","bucket","goog.array.bucket","sorter","buckets","toObject","goog.array.toObject","keyFunc","ret","range","goog.array.range","startOrEnd","opt_step","end","step","goog.array.repeat","flatten","goog.array.flatten","CHUNK_SIZE","chunk","recurseResult","rotate","goog.array.rotate","moveItem","goog.array.moveItem","toIndex","removedItems","zip","goog.array.zip","minLen","shuffle","goog.array.shuffle","opt_randFn","randFn","tmp","copyByIndex","goog.array.copyByIndex","index_arr","concatMap","goog.array.concatMap","goog.labs","labs","goog.labs.userAgent","userAgent","goog.labs.userAgent.util","util","getNativeUserAgentString_","goog.labs.userAgent.util.getNativeUserAgentString_","navigator","getNavigator_","goog.labs.userAgent.util.getNavigator_","userAgent_","setUserAgent","goog.labs.userAgent.util.setUserAgent","opt_userAgent","getUserAgent","goog.labs.userAgent.util.getUserAgent","matchUserAgent","goog.labs.userAgent.util.matchUserAgent","matchUserAgentIgnoreCase","goog.labs.userAgent.util.matchUserAgentIgnoreCase","extractVersionTuples","goog.labs.userAgent.util.extractVersionTuples","versionRegExp","data","goog.object","is","goog.object.is","v2","goog.object.forEach","goog.object.filter","goog.object.map","goog.object.some","goog.object.every","getCount","goog.object.getCount","getAnyKey","goog.object.getAnyKey","getAnyValue","goog.object.getAnyValue","goog.object.contains","containsValue","getValues","goog.object.getValues","getKeys","goog.object.getKeys","getValueByKeys","goog.object.getValueByKeys","keys","containsKey","goog.object.containsKey","goog.object.containsValue","findKey","goog.object.findKey","opt_this","findValue","goog.object.findValue","goog.object.isEmpty","goog.object.clear","goog.object.remove","add","goog.object.add","set","goog.object.get","opt_val","goog.object.set","setIfUndefined","goog.object.setIfUndefined","setWithReturnValueIfNotSet","goog.object.setWithReturnValueIfNotSet","goog.object.equals","k","goog.object.clone","unsafeClone","goog.object.unsafeClone","transpose","goog.object.transpose","transposed","PROTOTYPE_FIELDS_","goog.object.extend","create","goog.object.create","argLength","createSet","goog.object.createSet","createImmutableView","goog.object.createImmutableView","isFrozen","freeze","isImmutableView","goog.object.isImmutableView","getAllPropertyNames","goog.object.getAllPropertyNames","opt_includeObjectPrototype","getOwnPropertyNames","getPrototypeOf","visitedSet","proto","names","goog.labs.userAgent.browser","browser","matchOpera_","goog.labs.userAgent.browser.matchOpera_","matchIE_","goog.labs.userAgent.browser.matchIE_","matchEdge_","goog.labs.userAgent.browser.matchEdge_","matchFirefox_","goog.labs.userAgent.browser.matchFirefox_","matchSafari_","goog.labs.userAgent.browser.matchSafari_","matchChrome_","matchCoast_","isSilk","goog.labs.userAgent.browser.matchCoast_","matchIosWebview_","goog.labs.userAgent.browser.matchIosWebview_","goog.labs.userAgent.browser.matchChrome_","matchAndroidBrowser_","goog.labs.userAgent.browser.matchAndroidBrowser_","isChrome","isFirefox","isOpera","isIE","isEdge","isSafari","isCoast","isIosWebview","isAndroidBrowser","goog.labs.userAgent.browser.isSilk","getVersion","goog.labs.userAgent.browser.getVersion","lookUpValueWithKeys","versionMapHasKey","versionMap","userAgentString","getIEVersion_","versionTuples","tuple","isVersionOrHigher","goog.labs.userAgent.browser.isVersionOrHigher","version","goog.labs.userAgent.browser.getIEVersion_","msie","tridentVersion","goog.labs.userAgent.engine","engine","isPresto","goog.labs.userAgent.engine.isPresto","isTrident","goog.labs.userAgent.engine.isTrident","goog.labs.userAgent.engine.isEdge","isWebKit","goog.labs.userAgent.engine.isWebKit","isGecko","goog.labs.userAgent.engine.isGecko","goog.labs.userAgent.engine.getVersion","tuples","info","engineTuple","getEngineTuple_","getVersionForKey_","browserTuple","goog.labs.userAgent.engine.getEngineTuple_","goog.labs.userAgent.engine.isVersionOrHigher","goog.labs.userAgent.engine.getVersionForKey_","pair","goog.labs.userAgent.platform","platform","isAndroid","goog.labs.userAgent.platform.isAndroid","isIpod","goog.labs.userAgent.platform.isIpod","isIphone","goog.labs.userAgent.platform.isIphone","isIpad","goog.labs.userAgent.platform.isIpad","isIos","goog.labs.userAgent.platform.isIos","isMacintosh","goog.labs.userAgent.platform.isMacintosh","isLinux","goog.labs.userAgent.platform.isLinux","isWindows","goog.labs.userAgent.platform.isWindows","isChromeOS","goog.labs.userAgent.platform.isChromeOS","goog.labs.userAgent.platform.getVersion","goog.labs.userAgent.platform.isVersionOrHigher","goog.reflect","reflect","goog.reflect.object","objectProperty","goog.reflect.objectProperty","prop","sinkValue","goog.reflect.sinkValue","canAccessProperty","goog.reflect.canAccessProperty","cache","goog.reflect.cache","cacheObj","valueFn","opt_keyFn","storedKey","goog.userAgent","ASSUME_IE","ASSUME_EDGE","ASSUME_GECKO","ASSUME_WEBKIT","ASSUME_MOBILE_WEBKIT","ASSUME_OPERA","ASSUME_ANY_VERSION","BROWSER_KNOWN_","getUserAgentString","goog.userAgent.getUserAgentString","getNavigator","goog.userAgent.getNavigator","OPERA","IE","EDGE","EDGE_OR_IE","GECKO","WEBKIT","isMobile_","goog.userAgent.isMobile_","MOBILE","SAFARI","determinePlatform_","goog.userAgent.determinePlatform_","PLATFORM","ASSUME_MAC","ASSUME_WINDOWS","ASSUME_LINUX","ASSUME_X11","ASSUME_ANDROID","ASSUME_IPHONE","ASSUME_IPAD","ASSUME_IPOD","PLATFORM_KNOWN_","MAC","WINDOWS","isLegacyLinux_","goog.userAgent.isLegacyLinux_","LINUX","isX11_","goog.userAgent.isX11_","appVersion","X11","ANDROID","IPHONE","IPAD","IPOD","IOS","determineVersion_","goog.userAgent.determineVersion_","getVersionRegexResult_","docMode","getDocumentMode_","parseFloat","goog.userAgent.getVersionRegexResult_","goog.userAgent.getDocumentMode_","documentMode","VERSION","goog.userAgent.compare","isVersionOrHigherCache_","goog.userAgent.isVersionOrHigher","isVersion","isDocumentModeOrHigher","goog.userAgent.isDocumentModeOrHigher","DOCUMENT_MODE","isDocumentMode","mode","compatMode","INLINE_ROW","BlockSvg","Blockly.BlockSvg","options","tabindex","block-id","htmlId","svgGroup_","forcedInputWidths","Blockly.BlockSvg.prototype.initChildren","typeHints","svgTypeHints_","inputList","svgPath_","fill-rule","getFillPattern","svgPathFill_","svgPathLight_","tooltip","blockSpace","blockSpaceEditor","disableTooltip","Tooltip","bindMouseEvents","updateMovable","DISABLED_COLOUR","init","Blockly.BlockSvg.prototype.init","updateColour","input","mutator","createIcon","Blockly.BlockSvg.prototype.updateMovable","isMovable","grayOut","Blockly.BlockSvg.prototype.grayOut","shouldBeGray","getRootElement","Blockly.BlockSvg.prototype.getRootElement","BS","brokenControlPointWorkaround","oppositeIfRTL","thickenInlineRows","inputRows","row","thicker","z","INPUT_VALUE","FUNCTIONAL_INPUT","INLINE_PADDING_Y","inputRenderSize","renderHeight","MIN_BLOCK_Y","renderWidth","TAB_WIDTH","SEP_SPACE_X","CORNER_RADIUS","NOTCH_WIDTH","connection","targetConnection","bBox","targetBlock","getHeightWidth","getStatementTrailingSpace","inputTitleRenderSize","iconWidth","titleSize","title","titleRow","getSize","SEP_SPACE_Y","TAB_HEIGHT","TITLE_HEIGHT","DISTANCE_45_INSIDE","SQRT1_2","DISTANCE_45_OUTSIDE","NOTCH_PATH_WIDTH","JAGGED_TEETH","JAGGED_TEETH_HEIGHT","TAB_PATH_DOWN","TAB_PATH_DOWN_HIGHLIGHT","TAB_PATH_DOWN_HIGHLIGHT_RTL","TAB_PATH_UP","TAB_PATH_UP_HIGHLIGHT","TAB_PATH_UP_HIGHLIGHT_RTL","ANGLE_TAB_PATH_DOWN","ANGLE_TAB_PATH_DOWN_HIGHLIGHT_RTL","ANGLE_TAB_PATH_UP","ANGLE_TAB_PATH_UP_HIGHLIGHT","SQUARE_TAB_PATH_DOWN","SQUARE_TAB_PATH_DOWN_HIGHLIGHT","SQUARE_TAB_PATH_DOWN_HIGHLIGHT_RTL","SQUARE_TAB_PATH_UP","SQUARE_TAB_PATH_UP_HIGHLIGHT","SQUARE_TAB_PATH_UP_HIGHLIGHT_RTL","ROUNDED_TAB_PATH_DOWN","ROUNDED_TAB_PATH_DOWN_HIGHLIGHT","ROUNDED_TAB_PATH_DOWN_HIGHLIGHT_RTL","ROUNDED_TAB_PATH_UP","ROUNDED_TAB_PATH_UP_HIGHLIGHT","ROUNDED_TAB_PATH_UP_HIGHLIGHT_RTL","TAB_PATHS_BY_SHAPE","standard","angle","square","rounded","TOP_LEFT_CORNER_START","TOP_LEFT_CORNER_START_HIGHLIGHT_RTL","TOP_LEFT_CORNER_START_HIGHLIGHT_LTR","TOP_LEFT_CORNER","TOP_LEFT_CORNER_HIGHLIGHT","INNER_BOTTOM_LEFT_CORNER","INNER_TOP_LEFT_CORNER_HIGHLIGHT_RTL","INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_RTL","INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_LTR","Blockly.BlockSvg.prototype.getPadding","unusedSvg_","Blockly.BlockSvg.prototype.dispose","removeUnusedFrame","disposeUiEffect","Blockly.BlockSvg.prototype.disposeUiEffect","playAudio","parentSVGElement","svg_","xy","getSvgXY_","cloneNode","translateX_","translateY_","display","bBox_","getBBox","scrollWidth","scrollHeight","startDate_","disposeUiStep_","Blockly.BlockSvg.disposeUiStep_","percent","closure","connectionUiEffect","Blockly.BlockSvg.prototype.connectionUiEffect","outputConnection","previousConnection","ripple","cx","cy","stroke-width","connectionUiStep_","Blockly.BlockSvg.connectionUiStep_","opacity","Blockly.BlockSvg.prototype.updateColour","disabled","hexColour","shouldBeGrayedOut","getHexColour","updateToColour_","Blockly.BlockSvg.prototype.updateToColour_","rgb","color","hexToRgb","lighten","rgbDark","darken","rgbArrayToHex","pattern","updateDisabled","Blockly.BlockSvg.prototype.updateDisabled","getInheritedDisabled","child","children","getChildren","updateLimit","Blockly.BlockSvg.prototype.updateLimit","limitGroup_","limitRect_","BUBBLE_SIZE","HALF_BUBBLE_SIZE","limitText_","text-anchor","textContent","textWidth","ceil","rectWidth","round","isMsie","addSelect","Blockly.BlockSvg.prototype.addSelect","moveToTop","parentNode","addSelectNoMove","Blockly.BlockSvg.prototype.addSelectNoMove","elementHasClass_","removeSelect","Blockly.BlockSvg.prototype.removeSelect","addDragging","Blockly.BlockSvg.prototype.addDragging","removeDragging","Blockly.BlockSvg.prototype.removeDragging","addSpotlight","Blockly.BlockSvg.prototype.addSpotlight","removeSpotlight","Blockly.BlockSvg.prototype.removeSpotlight","Blockly.BlockSvg.prototype.render","selfOnly","rendered","cursorX","icons","getIcons","renderIcon","renderCompute_","renderDraw_","parentBlock","getParent","renderTitles_","Blockly.BlockSvg.prototype.renderTitles_","titleList","startX","t","translateX","getBufferY","Blockly.BlockSvg.prototype.renderCompute_","rightEdge","nextConnection","currentRow","titleValueWidth","titleStatementWidth","hasValue","hasStatement","hasDummy","isVisible","isInline","renderSize","titleWidth","NEXT_STATEMENT","DUMMY_INPUT","statementEdge","rightEdgeWithoutInline","widthInlineRow","Blockly.BlockSvg.prototype.widthInlineRow","inputWidthToOccupy_","Blockly.BlockSvg.prototype.renderDraw_","squareBottomLeftCorner_","squareTopLeftCorner_","prevBlock","nextBlock","FUNCTIONAL_OUTPUT","connectionsXY","getRelativeToSurfaceXY","renderInfo","core","inline","highlight","highlightInline","curX","curY","renderDrawTop_","renderDrawRight_","renderDrawBottom_","renderDrawLeft_","pathString","childNodes","pathInfo","getPathInfo","steps","transform","makeColour","Blockly.BlockSvg.prototype.renderDrawTop_","notchPaths","getNotchPaths","leftHighlight","connectionX","moveTo","Blockly.BlockSvg.prototype.renderDrawRight_","isCollapsed","renderDrawRightCollapsed_","renderDrawRightInline_","renderDrawRightInputValue_","renderDrawRightDummyInput_","renderDrawRightNextStatement_","Blockly.BlockSvg.prototype.renderDrawRightCollapsed_","remainder","Blockly.BlockSvg.prototype.renderDrawRightInputValue_","rowIndex","titleX","titleY","align","ALIGN_LEFT","titleRightX","ALIGN_RIGHT","ALIGN_CENTRE","tighten_","Blockly.BlockSvg.prototype.renderDrawRightDummyInput_","Blockly.BlockSvg.prototype.renderDrawRightNextStatement_","innerTopLeftCorner","Blockly.BlockSvg.prototype.renderDrawRightInline_","hasFunctionalInput","widths","connectionY","renderDrawRightInlineFunctional_","Blockly.BlockSvg.prototype.inputWidthToOccupy_","extraSpace","Blockly.BlockSvg.prototype.renderDrawRightInlineFunctional_","Blockly.BlockSvg.prototype.renderDrawBottom_","Blockly.BlockSvg.prototype.renderDrawLeft_","setVisible","Blockly.BlockSvg.prototype.setVisible","visible","Blockly.BlockSvg.prototype.innerTopLeftCorner","notchPathRight","isUnused","Blockly.BlockSvg.prototype.isUnused","setIsUnused","Blockly.BlockSvg.prototype.setIsUnused","addUnusedFrame","Blockly.BlockSvg.prototype.addUnusedFrame","Blockly.BlockSvg.prototype.removeUnusedFrame","BlockSvgFramed","Blockly.BlockSvgFramed","Blockly.BlockSvgFramed.prototype.initChildren","FUNCTION_HEADER","Blockly.BlockSvgFramed.prototype.getPadding","Blockly.BlockSvgFramed.prototype.renderDraw_","getAttribute","textHeight","svgPathDark_","Blockly.BlockSvgFramed.prototype.dispose","BlockSvgFunctional","Blockly.BlockSvgFunctional","headerHeight","rowBuffer","patternId_","inputMarkers_","inputClickTargets_","forcedInputSpacings","Blockly.BlockSvgFunctional.prototype.initChildren","getColour","getSaturation","getValue","lightColor","blockClipRect_","divider_","visibility","createFunctionalMarkers_","Blockly.BlockSvgFunctional.prototype.renderDraw_","rect","Blockly.BlockSvgFunctional.prototype.createFunctionalMarkers_","functionalMarkers","isFlyout","addInputClickListener_","markerName","Blockly.BlockSvgFunctional.prototype.addInputClickListener_","inputName","getInput","acceptsAnyType","acceptsType","childType","Block","initSvg","connect","titles","getTitles","FieldTextInput","showEditor_","Blockly.BlockSvgFunctional.prototype.renderDrawRight_","Blockly.BlockSvgFunctional.prototype.renderDrawRightInlineFunctional_","notchStart","inputSteps","Blockly.BlockSvgFunctional.prototype.updateToColour_","Blockly.BlockSvgFunctional.prototype.dispose","Blockly.Blocks","ScrollbarPair","Blockly.ScrollbarPair","addHorizontal","addVertical","blockSpace_","oldHostMetrics_","hScroll","Scrollbar","vScroll","corner_","scrollbarThickness","insertAfter_","getBubbleCanvas","Blockly.ScrollbarPair.prototype.dispose","onResizeWrapper_","canScrollHorizontally","Blockly.ScrollbarPair.prototype.canScrollHorizontally","canScrollVertically","Blockly.ScrollbarPair.prototype.canScrollVertically","resize","Blockly.ScrollbarPair.prototype.resize","hostMetrics","getMetrics","anyPropertyChanged","metricsChangedOnAxis","didResizeOccur","resizeH","resizeV","xCoordinate","yCoordinate","Blockly.ScrollbarPair.prototype.metricsChangedOnAxis","oldMetrics","currentMetrics","propertiesToCheck","propName","Blockly.ScrollbarPair.prototype.set","ScrollbarSvg","Blockly.ScrollbarSvg","horizontal","opt_pair","pair_","horizontal_","createDom_","svgBackground_","svgKnob_","onMouseDownBarWrapper_","scrollbar","onMouseDownBar_","onMouseDownKnobWrapper_","onMouseDownKnob_","Blockly.ScrollbarSvg.prototype.dispose","onMouseUpKnob_","Blockly.ScrollbarSvg.prototype.resize","opt_metrics","blockSpaceSize","getScrollableSize","outerLength","viewWidth","ratio_","Infinity","innerLength","innerOffset","viewLeft","absoluteLeft","absoluteTop","viewHeight","constrainKnob_","viewTop","onScroll_","Blockly.ScrollbarSvg.prototype.createDom_","radius","Blockly.ScrollbarSvg.prototype.isVisible","Blockly.ScrollbarSvg.prototype.setVisible","setMetrics","Blockly.ScrollbarSvg.prototype.onMouseDownBar_","hideChaff","mouseXY","mouseToSvg","mouseLocation","knobXY","knobStart","knobLength","knobValue","pageLength","Blockly.ScrollbarSvg.prototype.onMouseDownKnob_","startDragKnob","startDragMouse","clientX","clientY","onMouseUpWrapper_","onMouseMoveWrapper_","onMouseMoveKnob_","Blockly.ScrollbarSvg.prototype.onMouseMoveKnob_","Blockly.ScrollbarSvg.prototype.onMouseUpKnob_","Blockly.ScrollbarSvg.prototype.constrainKnob_","axis","barLength","Blockly.ScrollbarSvg.prototype.onScroll_","ratio","xyRatio","Blockly.ScrollbarSvg.prototype.set","fireEvents","Blockly.Scrollbar.insertAfter_","newNode","refNode","siblingNode","nextSibling","goog.math","math","randomInt","goog.math.randomInt","uniformRandom","goog.math.uniformRandom","clamp","goog.math.clamp","modulo","goog.math.modulo","lerp","goog.math.lerp","nearlyEquals","goog.math.nearlyEquals","opt_tolerance","standardAngle","goog.math.standardAngle","standardAngleInRadians","goog.math.standardAngleInRadians","PI","toRadians","goog.math.toRadians","angleDegrees","toDegrees","goog.math.toDegrees","angleRadians","angleDx","goog.math.angleDx","degrees","cos","angleDy","goog.math.angleDy","sin","goog.math.angle","x1","y1","x2","y2","atan2","angleDifference","goog.math.angleDifference","startAngle","endAngle","sign","goog.math.sign","longestCommonSubsequence","goog.math.longestCommonSubsequence","array1","array2","opt_collectorFn","collect","i1","i2","length1","length2","sum","goog.math.sum","average","goog.math.average","sampleVariance","goog.math.sampleVariance","sampleSize","mean","pow","standardDeviation","goog.math.standardDeviation","sqrt","isInt","goog.math.isInt","isFiniteNumber","goog.math.isFiniteNumber","isNegativeZero","goog.math.isNegativeZero","log10Floor","goog.math.log10Floor","log","LOG10E","safeFloor","goog.math.safeFloor","opt_epsilon","safeCeil","goog.math.safeCeil","Coordinate","goog.math.Coordinate","opt_x","opt_y","goog.math.Coordinate.prototype.clone","goog.math.Coordinate.prototype.toString","goog.math.Coordinate.prototype.equals","other","goog.math.Coordinate.equals","distance","goog.math.Coordinate.distance","dx","dy","magnitude","goog.math.Coordinate.magnitude","azimuth","goog.math.Coordinate.azimuth","squaredDistance","goog.math.Coordinate.squaredDistance","difference","goog.math.Coordinate.difference","goog.math.Coordinate.sum","goog.math.Coordinate.prototype.ceil","goog.math.Coordinate.prototype.floor","goog.math.Coordinate.prototype.round","translate","goog.math.Coordinate.prototype.translate","tx","opt_ty","scale","goog.math.Coordinate.prototype.scale","sx","opt_sy","sy","rotateRadians","goog.math.Coordinate.prototype.rotateRadians","radians","opt_center","center","rotateDegrees","goog.math.Coordinate.prototype.rotateDegrees","Box","goog.math.Box","boundingBox","goog.math.Box.boundingBox","box","expandToIncludeCoordinate","getWidth","goog.math.Box.prototype.getWidth","getHeight","goog.math.Box.prototype.getHeight","goog.math.Box.prototype.clone","goog.math.Box.prototype.toString","goog.math.Box.prototype.contains","expand","goog.math.Box.prototype.expand","opt_right","opt_bottom","opt_left","expandToInclude","goog.math.Box.prototype.expandToInclude","goog.math.Box.prototype.expandToIncludeCoordinate","coord","goog.math.Box.equals","goog.math.Box.contains","relativePositionX","goog.math.Box.relativePositionX","relativePositionY","goog.math.Box.relativePositionY","goog.math.Box.distance","intersects","goog.math.Box.intersects","intersectsWithPadding","goog.math.Box.intersectsWithPadding","padding","goog.math.Box.prototype.ceil","goog.math.Box.prototype.floor","goog.math.Box.prototype.round","goog.math.Box.prototype.translate","goog.math.Box.prototype.scale","IRect","goog.math.IRect","Size","goog.math.Size","goog.math.Size.equals","goog.math.Size.prototype.clone","goog.math.Size.prototype.toString","getLongest","goog.math.Size.prototype.getLongest","getShortest","goog.math.Size.prototype.getShortest","area","goog.math.Size.prototype.area","perimeter","goog.math.Size.prototype.perimeter","aspectRatio","goog.math.Size.prototype.aspectRatio","goog.math.Size.prototype.isEmpty","goog.math.Size.prototype.ceil","fitsInside","goog.math.Size.prototype.fitsInside","goog.math.Size.prototype.floor","goog.math.Size.prototype.round","goog.math.Size.prototype.scale","scaleToCover","goog.math.Size.prototype.scaleToCover","scaleToFit","goog.math.Size.prototype.scaleToFit","Rect","goog.math.Rect","w","h","goog.math.Rect.prototype.clone","toBox","goog.math.Rect.prototype.toBox","createFromPositionAndSize","goog.math.Rect.createFromPositionAndSize","position","size","createFromBox","goog.math.Rect.createFromBox","goog.math.Rect.prototype.toString","goog.math.Rect.equals","intersection","goog.math.Rect.prototype.intersection","x0","y0","goog.math.Rect.intersection","goog.math.Rect.intersects","goog.math.Rect.prototype.intersects","goog.math.Rect.difference","ar","ab","br","bb","goog.math.Rect.prototype.difference","boundingRect","goog.math.Rect.prototype.boundingRect","goog.math.Rect.boundingRect","newRect","goog.math.Rect.prototype.contains","another","goog.math.Rect.prototype.squaredDistance","point","goog.math.Rect.prototype.distance","goog.math.Rect.prototype.getSize","getTopLeft","goog.math.Rect.prototype.getTopLeft","getCenter","goog.math.Rect.prototype.getCenter","getBottomRight","goog.math.Rect.prototype.getBottomRight","goog.math.Rect.prototype.ceil","goog.math.Rect.prototype.floor","goog.math.Rect.prototype.round","goog.math.Rect.prototype.translate","goog.math.Rect.prototype.scale","Trashcan","Blockly.Trashcan","CLOSED_URL_","OPEN_URL_","WIDTH_","HEIGHT_","MARGIN_TOP_","MARGIN_SIDE_","MARGIN_HOTSPOT_","isOpen","svgClosedCan_","svgOpenCan_","left_","top_","createDom","Blockly.Trashcan.prototype.createDom","isPortrait","setAttributeNS","assetUrl","notAllowed_","getRect","Blockly.Trashcan.prototype.getRect","trashRect","Blockly.Trashcan.prototype.dispose","Blockly.Trashcan.prototype.getHeight","setOpen_","Blockly.Trashcan.prototype.setOpen_","animateLid_","setDisabled","Blockly.Trashcan.prototype.setDisabled","isDisabled","Blockly.Trashcan.prototype.animateLid_","close","Blockly.Trashcan.prototype.close","PanDragHandler","Blockly.PanDragHandler","startScrollY_","startScrollX_","startMouseY_","startMouseX_","mouseUpEventBindData_","mouseMoveEventBindData_","contextMenuBlockEventBindData_","mousewheelEventBindData_","wheelEventBindData_","mouseDownEventBindData_","onTargetMouseDown_","target_","bindBeginPanDragHandler","Blockly.PanDragHandler.prototype.bindBeginPanDragHandler","onDragTargetMouseDown","unbindBeginPanDragHandler","onPanDragTargetMouseDown_","blockContextMenu","Blockly.PanDragHandler.prototype.unbindBeginPanDragHandler","bindDuringPanDragHandlers_","Blockly.PanDragHandler.prototype.bindDuringPanDragHandlers_","unbindDuringPanDragHandlers_","onPanDragMouseMove_","onCapture","onPanDragMouseUp_","Blockly.PanDragHandler.prototype.unbindDuringPanDragHandlers_","Blockly.PanDragHandler.prototype.onPanDragTargetMouseDown_","clickIsOnTarget","selected","isReadOnly","unselect","blockNonInteractive","isEditable","shouldDrag","isLeftClick","scrollbarPair","beginDragScroll_","Blockly.PanDragHandler.prototype.beginDragScroll_","getScrollOffsetX","getScrollOffsetY","Blockly.PanDragHandler.prototype.onPanDragMouseMove_","removeAllRanges","scrollTo","Blockly.PanDragHandler.prototype.onPanDragMouseUp_","ScrollOnWheelHandler","Blockly.ScrollOnWheelHandler","bindTo","Blockly.ScrollOnWheelHandler.prototype.bindTo","wheelTarget","unbindWheelScrollHandler","onWheel_","Blockly.ScrollOnWheelHandler.prototype.unbindWheelScrollHandler","Blockly.ScrollOnWheelHandler.prototype.onWheel_","wheelDelta","getNormalizedWheelDeltaY","scrollWithAnySelectedBlock","goog.disposable","disposable","IDisposable","goog.disposable.IDisposable","isDisposed","Disposable","goog.Disposable","MONITORING_MODE","MonitoringMode","OFF","INCLUDE_STACK_ON_CREATION","creationStack","instances_","disposed_","onDisposeCallbacks_","PERMANENT","INTERACTIVE","getUndisposedObjects","goog.Disposable.getUndisposedObjects","clearUndisposedObjects","goog.Disposable.clearUndisposedObjects","goog.Disposable.prototype.isDisposed","getDisposed","goog.Disposable.prototype.dispose","disposeInternal","uid","registerDisposable","goog.Disposable.prototype.registerDisposable","addOnDisposeCallback","goog.Disposable.prototype.addOnDisposeCallback","callback","opt_scope","goog.Disposable.prototype.disposeInternal","goog.Disposable.isDisposed","goog.dispose","disposeAll","goog.disposeAll","len","goog.debug.entryPointRegistry","EntryPointMonitor","goog.debug.EntryPointMonitor","entryPointRegistry","refList_","monitors_","monitorsMayExist_","register","goog.debug.entryPointRegistry.register","monitors","wrap","monitorAll","goog.debug.entryPointRegistry.monitorAll","monitor","transformer","unmonitorAllIfPossible","goog.debug.entryPointRegistry.unmonitorAllIfPossible","unwrap","goog.events","events","BrowserFeature","HAS_W3C_BUTTON","HAS_W3C_EVENT_SUPPORT","SET_KEY_CODE_TO_PREVENT_DEFAULT","HAS_NAVIGATOR_ONLINE_PROPERTY","HAS_HTML5_NETWORK_EVENT_SUPPORT","HTML5_NETWORK_EVENTS_FIRE_ON_BODY","TOUCH_ENABLED","documentElement","msMaxTouchPoints","EventId","goog.events.EventId","eventId","goog.events.EventId.prototype.toString","Event","goog.events.Event","currentTarget","defaultPrevented","propagationStopped_","returnValue_","goog.events.Event.prototype.stopPropagation","goog.events.Event.prototype.preventDefault","goog.events.Event.stopPropagation","goog.events.Event.preventDefault","getVendorPrefixedName_","goog.events.getVendorPrefixedName_","eventName","EventType","CLICK","RIGHTCLICK","DBLCLICK","MOUSEDOWN","MOUSEUP","MOUSEOVER","MOUSEOUT","MOUSEMOVE","MOUSEENTER","MOUSELEAVE","SELECTIONCHANGE","SELECTSTART","WHEEL","KEYPRESS","KEYDOWN","KEYUP","BLUR","FOCUS","DEACTIVATE","FOCUSIN","FOCUSOUT","CHANGE","RESET","SELECT","SUBMIT","INPUT","PROPERTYCHANGE","DRAGSTART","DRAG","DRAGENTER","DRAGOVER","DRAGLEAVE","DROP","DRAGEND","TOUCHSTART","TOUCHMOVE","TOUCHEND","TOUCHCANCEL","BEFOREUNLOAD","CONSOLEMESSAGE","CONTEXTMENU","DEVICEORIENTATION","DOMCONTENTLOADED","ERROR","HELP","LOAD","LOSECAPTURE","ORIENTATIONCHANGE","READYSTATECHANGE","RESIZE","SCROLL","UNLOAD","CANPLAY","CANPLAYTHROUGH","DURATIONCHANGE","EMPTIED","ENDED","LOADEDDATA","LOADEDMETADATA","PAUSE","PLAY","PLAYING","RATECHANGE","SEEKED","SEEKING","STALLED","SUSPEND","TIMEUPDATE","VOLUMECHANGE","WAITING","HASHCHANGE","PAGEHIDE","PAGESHOW","POPSTATE","COPY","PASTE","CUT","BEFORECOPY","BEFORECUT","BEFOREPASTE","ONLINE","OFFLINE","MESSAGE","CONNECT","ANIMATIONSTART","ANIMATIONEND","ANIMATIONITERATION","TRANSITIONEND","POINTERDOWN","POINTERUP","POINTERCANCEL","POINTERMOVE","POINTEROVER","POINTEROUT","POINTERENTER","POINTERLEAVE","GOTPOINTERCAPTURE","LOSTPOINTERCAPTURE","MSGESTURECHANGE","MSGESTUREEND","MSGESTUREHOLD","MSGESTURESTART","MSGESTURETAP","MSGOTPOINTERCAPTURE","MSINERTIASTART","MSLOSTPOINTERCAPTURE","MSPOINTERCANCEL","MSPOINTERDOWN","MSPOINTERENTER","MSPOINTERHOVER","MSPOINTERLEAVE","MSPOINTERMOVE","MSPOINTEROUT","MSPOINTEROVER","MSPOINTERUP","TEXTINPUT","COMPOSITIONSTART","COMPOSITIONUPDATE","COMPOSITIONEND","EXIT","LOADABORT","LOADCOMMIT","LOADREDIRECT","LOADSTART","LOADSTOP","RESPONSIVE","SIZECHANGED","UNRESPONSIVE","VISIBILITYCHANGE","STORAGE","DOMSUBTREEMODIFIED","DOMNODEINSERTED","DOMNODEREMOVED","DOMNODEREMOVEDFROMDOCUMENT","DOMNODEINSERTEDINTODOCUMENT","DOMATTRMODIFIED","DOMCHARACTERDATAMODIFIED","BEFOREPRINT","AFTERPRINT","BrowserEvent","goog.events.BrowserEvent","opt_e","opt_currentTarget","goog.events.BrowserEvent.base","relatedTarget","charCode","keyCode","button","screenY","screenX","offsetY","offsetX","metaKey","shiftKey","altKey","ctrlKey","platformModifierKey","event_","MouseButton","LEFT","MIDDLE","RIGHT","IEButtonMap","goog.events.BrowserEvent.prototype.init","relevantTouch","changedTouches","srcElement","fromElement","toElement","layerX","layerY","pageX","pageY","isButton","goog.events.BrowserEvent.prototype.isButton","isMouseActionButton","goog.events.BrowserEvent.prototype.isMouseActionButton","goog.events.BrowserEvent.prototype.stopPropagation","cancelBubble","goog.events.BrowserEvent.prototype.preventDefault","be","returnValue","VK_F1","VK_F12","getBrowserEvent","goog.events.BrowserEvent.prototype.getBrowserEvent","Listenable","goog.events.Listenable","IMPLEMENTED_BY_PROP","addImplementation","goog.events.Listenable.addImplementation","isImplementedBy","goog.events.Listenable.isImplementedBy","ListenableKey","goog.events.ListenableKey","counter_","reserveKey","goog.events.ListenableKey.reserveKey","Listener","goog.events.Listener","listener","proxy","capture","opt_handler","ENABLE_MONITORING","handler","removed","callOnce","markAsRemoved","goog.events.Listener.prototype.markAsRemoved","ListenerMap","goog.events.ListenerMap","listeners","typeCount_","getTypeCount","goog.events.ListenerMap.prototype.getTypeCount","getListenerCount","goog.events.ListenerMap.prototype.getListenerCount","goog.events.ListenerMap.prototype.add","opt_useCapture","opt_listenerScope","typeStr","listenerArray","findListenerIndex_","listenerObj","goog.events.ListenerMap.prototype.remove","removeByKey","goog.events.ListenerMap.prototype.removeByKey","goog.events.ListenerMap.prototype.removeAll","opt_type","getListeners","goog.events.ListenerMap.prototype.getListeners","getListener","goog.events.ListenerMap.prototype.getListener","hasListener","goog.events.ListenerMap.prototype.hasListener","opt_capture","hasType","hasCapture","goog.events.ListenerMap.findListenerIndex_","LISTENER_MAP_PROP_","onString_","onStringMap_","CaptureSimulationMode","OFF_AND_FAIL","OFF_AND_SILENT","ON","CAPTURE_SIMULATION_MODE","listenerCountEstimate_","listen","goog.events.listen","opt_capt","wrapListener","listen_","goog.events.listen_","listenerMap","getListenerMap_","getProxy","addEventListener","attachEvent","getOnString_","goog.events.getProxy","proxyCallbackFunction","handleBrowserEvent_","eventObject","listenOnce","goog.events.listenOnce","listenWithWrapper","goog.events.listenWithWrapper","wrapper","unlisten","goog.events.unlisten","unlistenByKey","goog.events.unlistenByKey","removeEventListener","detachEvent","unlistenWithWrapper","goog.events.unlistenWithWrapper","goog.events.removeAll","removeAllListeners","goog.events.getListeners","goog.events.getListener","goog.events.hasListener","expose","goog.events.expose","goog.events.getOnString_","fireListeners","goog.events.fireListeners","fireListeners_","goog.events.fireListeners_","retval","fireListener","goog.events.fireListener","listenerFn","listenerHandler","getTotalListenerCount","goog.events.getTotalListenerCount","dispatchEvent","goog.events.dispatchEvent","protectBrowserEventEntryPoint","goog.events.protectBrowserEventEntryPoint","protectEntryPoint","goog.events.handleBrowserEvent_","opt_evt","ieEvent","evt","isMarkedIeEvent_","markIeEvent_","ancestors","parent","goog.events.markIeEvent_","useReturnValue","goog.events.isMarkedIeEvent_","uniqueIdCounter_","getUniqueId","goog.events.getUniqueId","identifier","goog.events.getListenerMap_","LISTENER_WRAPPER_PROP_","goog.events.wrapListener","handleEvent","goog.functions","functions","constant","goog.functions.constant","retValue","FALSE","TRUE","NULL","identity","goog.functions.identity","opt_returnValue","goog.functions.error","goog.functions.fail","lock","goog.functions.lock","opt_numArgs","nth","goog.functions.nth","partialRight","goog.functions.partialRight","rightArgs","withReturnValue","goog.functions.withReturnValue","sequence","equalTo","goog.functions.equalTo","opt_useLooseComparison","compose","goog.functions.compose","goog.functions.sequence","and","goog.functions.and","or","goog.functions.or","not","goog.functions.not","goog.functions.create","temp","CACHE_RETURN_VALUE","cacheReturnValue","goog.functions.cacheReturnValue","called","once","goog.functions.once","inner","debounce","goog.functions.debounce","interval","timeout","clearTimeout","throttle","goog.functions.throttle","shouldFire","handleTimeout","fire","rateLimit","goog.functions.rateLimit","goog.async","AnimationDelay","goog.async.AnimationDelay","opt_window","goog.async.AnimationDelay.base","id_","usingListeners_","listener_","handler_","win_","callback_","doAction_","TIMEOUT","MOZ_BEFORE_PAINT_EVENT_","goog.async.AnimationDelay.prototype.start","stop","raf","getRaf_","cancelRaf","getCancelRaf_","mozRequestAnimationFrame","goog.async.AnimationDelay.prototype.stop","isActive","goog.async.AnimationDelay.prototype.fire","fireIfActive","goog.async.AnimationDelay.prototype.fireIfActive","goog.async.AnimationDelay.prototype.isActive","goog.async.AnimationDelay.prototype.doAction_","goog.async.AnimationDelay.prototype.disposeInternal","goog.async.AnimationDelay.prototype.disposeInternal.base","goog.async.AnimationDelay.prototype.getRaf_","win","requestAnimationFrame","webkitRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","goog.async.AnimationDelay.prototype.getCancelRaf_","cancelAnimationFrame","cancelRequestAnimationFrame","webkitCancelRequestAnimationFrame","mozCancelRequestAnimationFrame","oCancelRequestAnimationFrame","msCancelRequestAnimationFrame","AutoScroll","Blockly.AutoScroll","startPanVector","activePanVector_","animationDelay_","handleAnimationDelay_","lastTime_","stopAndDestroy","Blockly.AutoScroll.prototype.stopAndDestroy","lastMouseY_","lastMouseX_","Blockly.AutoScroll.prototype.handleAnimationDelay_","dt","scrollTick_","Blockly.AutoScroll.prototype.scrollTick_","msPassed","scrollDeltaWithAnySelectedBlock","updateProperties","Blockly.AutoScroll.prototype.updateProperties","scrollVector","mouseClientX","mouseClientY","Vec2","goog.math.Vec2","randomUnit","goog.math.Vec2.randomUnit","goog.math.Vec2.random","mag","fromCoordinate","goog.math.Vec2.fromCoordinate","goog.math.Vec2.prototype.clone","goog.math.Vec2.prototype.magnitude","squaredMagnitude","goog.math.Vec2.prototype.squaredMagnitude","invert","goog.math.Vec2.prototype.invert","normalize","goog.math.Vec2.prototype.normalize","goog.math.Vec2.prototype.add","subtract","goog.math.Vec2.prototype.subtract","goog.math.Vec2.prototype.rotate","newY","rotateAroundPoint","goog.math.Vec2.rotateAroundPoint","axisPoint","goog.math.Vec2.prototype.equals","goog.math.Vec2.sum","goog.math.Vec2.difference","dot","goog.math.Vec2.dot","determinant","goog.math.Vec2.determinant","goog.math.Vec2.lerp","ScrollOnBlockDragHandler","Blockly.ScrollOnBlockDragHandler","SCROLL_DIRECTION_VECTORS","stopAutoScrolling","Blockly.ScrollOnBlockDragHandler.prototype.stopAutoScrolling","activeAutoScroll_","MS_PER_SEC","MOUSE_SPEED_SLOW","MOUSE_SPEED_FAST","BLOCK_SPEED_SLOW","BLOCK_SPEED_FAST","MOUSE_START_DISTANCE","MOUSE_START_FAST_DISTANCE","BLOCK_START_DISTANCE","BLOCK_START_FAST_DISTANCE","OVERSIZE_BLOCK_THRESHOLD","FALLBACK_DRAG_MARGIN","panIfOverEdge","Blockly.ScrollOnBlockDragHandler.prototype.panIfOverEdge","currentlyScrollable","SCROLLABLE_DIRECTIONS","mouseSvg","mouseCoordinatesToSvg","mouseViewport","svgCoordinatesToViewport","mouseBlockSpace","viewportCoordinateToBlockSpace","viewportBox","getViewportBox","blockBox","getBox","blockHeight","getBoxHeight","viewportHeight","blockWidth","getBoxWidth","viewportWidth","blockOverflows","getBoxOverflow","mouseOverflows","getPointBoxOverflow","drawDebugCircle","drawDebugBox","overallScrollVector","direction","mouseOverflow","blockOverflow","candidateScrolls","numberWithin","greatestScrollVector","fastestScroll","candidateScroll","Blockly.Xml","Xml","blockSpaceToDom","Blockly.Xml.blockSpaceToDom","xml","createElementNS","blocks","getTopBlocks","blockToDom","Blockly.Xml.blockToDom","ignoreChildBlocks","mutationToDom","mutation","EDITABLE","container","config","empty","ignoreChild","childBlock","isDeletable","isUserVisible","inputCount","isNextConnectionDisabled","canDisconnectFromParent","isFunctionDefinition","userCreated","editBlocks","blockLimits","getLimit","domToText","Blockly.Xml.domToText","serializeToString","XMLSerializer","domToPrettyText","Blockly.Xml.domToPrettyText","lines","indent","line","text","textToDom","Blockly.Xml.textToDom","parseFromString","DOMParser","nodeName","domToBlockSpace","Blockly.Xml.domToBlockSpace","metrics","paddingLeft","shouldHavePadding","BlockSpace","AUTO_LAYOUT_PADDING_LEFT","paddingTop","AUTO_LAYOUT_PADDING_TOP","positionBlock","blockly_block","getSvgPadding","heightWidth","xmlChild","domToBlock","topLevelProcedureAutopopulate","updateFlyout","EVENTS","EVENT_BLOCKS_IMPORTED","Blockly.Xml.domToBlock","xmlBlock","prototypeName","collapsed","setCollapsed","unknownBlock","deletable","setDeletable","movable","setMovable","editable","setEditable","next_connection_disabled","setNextConnectionDisabled","can_disconnect_from_parent","setCanDisconnectFromParent","userVisible","setUserVisible","setInputCount","shouldShowLimits","setLimit","grandchildNode","firstRealGrandchild","domToMutation","setFieldConfig","setTitleValue","appendValueInput","warn","appendStatementInput","appendFunctionalInput","blockChild","setPreviousStatement","setOutput","setNextStatement","deleteNext","Blockly.Xml.deleteNext","Blockly.BlockSpace","this.setMetrics","topBlocks_","deleteAreas_","pickedUpBlockOrigin_","maxBlocks","EventTarget","panDragHandler_","scrollOnWheelHandler_","scrollOnBlockDragHandler_","ConnectionDB","DEBUG_EVENTS","debugLogOnEvents","updateScrollableSize","MAIN_BLOCK_SPACE_CREATED","BLOCK_SPACE_CHANGE","BLOCK_SPACE_SCROLLED","RUN_BUTTON_CLICKED","SCAN_ANGLE","DROPPED_BLOCK_PAN_MARGIN","SCROLLABLE_MARGIN_BELOW_BOTTOM","createReadOnlyBlockSpace","Blockly.BlockSpace.createReadOnlyBlockSpace","opt_options","BlockSpaceEditor","getBlockSpaceMetrics_","setBlockSpaceMetrics_","hideTrashRect","readOnly","noScrolling","disableEventBindings","onMainBlockSpaceCreated","Blockly.BlockSpace.onMainBlockSpaceCreated","mainBlockSpace","xOffsetFromView","yOffsetFromView","trashcan","fireGlobalChangeEventPid_","fireChangeEventPid_","Blockly.BlockSpace.prototype.isReadOnly","isMovementLocked","Blockly.BlockSpace.prototype.isMovementLocked","Blockly.BlockSpace.prototype.debugLogOnEvents","eventIdentifier","eventConstant","findFunction","Blockly.BlockSpace.prototype.findFunction","functionName","Procedures","DEFINITION_BLOCK_TYPES","Names","getTitleValue","findFunctionExamples","Blockly.BlockSpace.prototype.findFunctionExamples","ContractEditor","EXAMPLE_BLOCK_TYPE","actualBlock","getInputTargetBlock","EXAMPLE_BLOCK_ACTUAL_INPUT_NAME","Blockly.BlockSpace.prototype.createDom","clippingGroup_","svgBlockCanvas_","svgBubbleCanvas_","svgDebugCanvas_","dragSvg","svgDragCanvas_","getSvgRenderer","svgTrashcan_","fireChangeEvent","moveElementToDragCanvas","Blockly.BlockSpace.prototype.moveElementToDragCanvas","blockSVGElement","getDragCanvas","moveElementToMainCanvas","Blockly.BlockSpace.prototype.moveElementToMainCanvas","getCanvas","Blockly.BlockSpace.prototype.dispose","flyout_","addTrashcan","Blockly.BlockSpace.prototype.addTrashcan","hasTrashcan","svgTrashcan","setTrashcan","Blockly.BlockSpace.prototype.setTrashcan","getClippingGroup","Blockly.BlockSpace.prototype.getClippingGroup","Blockly.BlockSpace.prototype.getCanvas","Blockly.BlockSpace.prototype.getDragCanvas","Blockly.BlockSpace.prototype.getBubbleCanvas","getTrashCan","Blockly.BlockSpace.prototype.getTrashCan","addTopBlock","Blockly.BlockSpace.prototype.addTopBlock","isTopBlock","Blockly.BlockSpace.prototype.isTopBlock","removeTopBlock","Blockly.BlockSpace.prototype.removeTopBlock","Blockly.BlockSpace.prototype.getTopBlocks","ordered","shareMainModal","modalBlockSpace","offset","aXY","bXY","getAllVisibleBlocks","Blockly.BlockSpace.prototype.getAllVisibleBlocks","getAllBlocks","getAllUsedBlocks","Blockly.BlockSpace.prototype.getAllUsedBlocks","getRootBlock","getTopUsedBlocks","Blockly.BlockSpace.prototype.getTopUsedBlocks","Blockly.BlockSpace.prototype.getAllBlocks","getBlockCount","Blockly.BlockSpace.prototype.getBlockCount","Blockly.BlockSpace.prototype.clear","Blockly.BlockSpace.prototype.render","renderList","getBlockById","Blockly.BlockSpace.prototype.getBlockById","traceOn","Blockly.BlockSpace.prototype.traceOn","armed","traceOn_","traceWrapper_","highlightBlock","Blockly.BlockSpace.prototype.highlightBlock","spotlight","isDragging","select","Blockly.BlockSpace.prototype.fireChangeEvent","canvas","self","paste","Blockly.BlockSpace.prototype.paste","querySelectorAll","remainingCapacity","bumpNeighbours","Blockly.BlockSpace.prototype.remainingCapacity","recordPickedUpBlockOrigin","Blockly.BlockSpace.prototype.recordPickedUpBlockOrigin","canvasBBox","getCanvasBBox","svgRectToRect","clearPickedUpBlockOrigin","Blockly.BlockSpace.prototype.clearPickedUpBlockOrigin","recordDeleteAreas","Blockly.BlockSpace.prototype.recordDeleteAreas","deleteAreaTrash_","getDeleteAreas","isDeleteArea","Blockly.BlockSpace.prototype.isDeleteArea","mouseX","mouseY","startDragX","undeletable","languageTree","mouseDragStartXY","dragStartXY","drawTrashZone","setCursor","Css","Cursor","CLOSED","hideDelete","Blockly.BlockSpace.prototype.hideDelete","Blockly.BlockSpace.prototype.drawTrashZone","blockGroupForeground","hideTrashRect_","mainBlockSpaceEditor","toolbox","background","blockGroup","tree_","element_","trashcanElement","trashcanHolder","flyout","toolbarWidth","pastThreshold","dragBuffer","xDifference","canvasAreaWidth","trashZoneWidth","normalIntensity","INNER_TRASH_TRASHCAN_INTENSITY","INNER_TRASH_NORMAL_INTENSITY","INNER_TRASH_DISTANCE","trashIntensity","TRASH_GREY","REGULAR_GREY","Blockly.BlockSpace.prototype.getScrollableSize","extraVerticalSpace","contentLeft","contentWidth","contentTop","contentHeight","getScrollableBox","Blockly.BlockSpace.prototype.getScrollableBox","scrollableSize","Blockly.BlockSpace.prototype.getViewportBox","Blockly.BlockSpace.prototype.panIfOverEdge","Blockly.BlockSpace.prototype.stopAutoScrolling","scrollIntoView","Blockly.BlockSpace.prototype.scrollIntoView","currentView","boxOverflows","addToNonZeroSides","isOversizedX","isBoxWiderThan","isOversizedY","isBoxTallerThan","isAlreadyInView","scrollToDelta","Blockly.BlockSpace.prototype.scrollDeltaWithAnySelectedBlock","scrollDx","scrollDy","Blockly.BlockSpace.prototype.scrollWithAnySelectedBlock","newScrollX","newScrollY","offsetBefore","getScrollOffset","isFreelyDragging","scrolledAmount","startDragMouseX","startDragMouseY","moveBlockBeingDragged_","Blockly.BlockSpace.prototype.scrollToDelta","Blockly.BlockSpace.prototype.scrollTo","maxScrollOffsets","getMaxScrollOffsets","Blockly.BlockSpace.prototype.currentlyScrollable","maxOffsets","Blockly.BlockSpace.prototype.getMaxScrollOffsets","Blockly.BlockSpace.prototype.getScrollOffset","Blockly.BlockSpace.prototype.getScrollOffsetX","Blockly.BlockSpace.prototype.getScrollOffsetY","Blockly.BlockSpace.prototype.updateScrollableSize","Blockly.BlockSpace.prototype.bindBeginPanDragHandler","bindScrollOnWheelHandler","Blockly.BlockSpace.prototype.bindScrollOnWheelHandler","Blockly.BlockSpace.prototype.unbindBeginPanDragHandler","debugRects_","Blockly.BlockSpace.prototype.drawDebugBox","debugSvgRect","debugCircles_","Blockly.BlockSpace.prototype.drawDebugCircle","coordinate","clearDebugDrawings","Blockly.BlockSpace.prototype.clearDebugDrawings","debugDict","ROUNDED_NOTCH_PATHS","SQUARE_NOTCH_PATHS","Connection","Blockly.Connection","sourceBlock_","y_","x_","inDB_","dbList_","connectionDBList","check_","fieldHelpers_","Shapes","STANDARD","ANGLE","SQUARE","ROUNDED","isConnected","Blockly.Connection.prototype.isConnected","Blockly.Connection.prototype.dispose","removeConnection_","highlightedConnection_","localConnection_","isSuperior","Blockly.Connection.prototype.isSuperior","Blockly.Connection.prototype.connect","connectTo","OPPOSITE_TYPE","handleOrphan_","setParent","PREVIOUS_STATEMENT","Blockly.Connection.prototype.handleOrphan_","existingConnection","orphanBlock","OUTPUT_VALUE","newBlock","singleConnection_","bumpAwayFrom_","BUMP_DELAY","Blockly.Connection.singleConnection_","thisConnection","checkAllowedConnectionType_","disconnect","Blockly.Connection.prototype.disconnect","otherConnection","Blockly.Connection.prototype.targetBlock","Blockly.Connection.prototype.bumpAwayFrom_","staticConnection","rootBlock","isInFlyout","reverse","getSvgRoot","SNAP_RADIUS","moveBy","Blockly.Connection.prototype.moveTo","addConnection_","Blockly.Connection.prototype.moveBy","colorForType","Blockly.Connection.prototype.colorForType","checks","Blockly.Connection.prototype.getPathInfo","getTabShape","moveWidth","Blockly.Connection.prototype.highlight","tabWidth","highlightedPath_","unhighlight","Blockly.Connection.prototype.unhighlight","Blockly.Connection.prototype.getNotchPaths","NOTCH_PATHS_OVERRIDE","constraints","BlockValueType","FUNCTION","Blockly.Connection.prototype.getTabShape","strictType_","valueTypeTabShapeMap","Blockly.Connection.prototype.tighten_","svgRoot","getRelativeXY","moveConnections_","closest","Blockly.Connection.prototype.closest","maxLimit","checkConnection_","yIndex","db","targetSourceBlock","sourceBlock","getDragging","currentX","distY","currentY","distX","closestConnection","pointerMin","pointerMax","pointerMid","Blockly.Connection.prototype.checkAllowedConnectionType_","strictCheck","Blockly.Connection.prototype.strictCheck","Blockly.Connection.prototype.acceptsAnyType","NONE","Blockly.Connection.prototype.acceptsType","setStrictCheck","Blockly.Connection.prototype.setStrictCheck","check","setCheck","Blockly.Connection.prototype.setCheck","setHSV","addFieldHelper","Blockly.Connection.prototype.addFieldHelper","fieldHelper","getFieldHelperOptions","Blockly.Connection.prototype.getFieldHelperOptions","getCheck","Blockly.Connection.prototype.getCheck","neighbours_","Blockly.Connection.prototype.neighbours_","neighbours","db1","db2","hideAll","Blockly.Connection.prototype.hideAll","getDescendants","connections","getConnections_","unhideAll","Blockly.Connection.prototype.unhideAll","Blockly.ConnectionDB","Blockly.ConnectionDB.prototype.addConnection_","Blockly.ConnectionDB.prototype.removeConnection_","Blockly.ConnectionDB.init","dbList","CAN_ADD_NAME_OR_TYPE_ATTRIBUTES","CAN_USE_CHILDREN_ATTRIBUTE","CAN_USE_INNER_TEXT","CAN_USE_PARENT_ELEMENT_PROPERTY","INNER_HTML_NEEDS_SCOPED_ELEMENT","LEGACY_IE_RANGES","TagName","goog.dom.TagName","tagName","tagName_","goog.dom.TagName.prototype.toString","A","ABBR","ACRONYM","ADDRESS","APPLET","AREA","ARTICLE","ASIDE","AUDIO","B","BASE","BASEFONT","BDI","BDO","BIG","BLOCKQUOTE","BODY","BR","BUTTON","CANVAS","CAPTION","CENTER","CITE","CODE","COL","COLGROUP","COMMAND","DATA","DATALIST","DD","DEL","DETAILS","DFN","DIALOG","DIR","DIV","DL","DT","EM","EMBED","FIELDSET","FIGCAPTION","FIGURE","FONT","FOOTER","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HEAD","HEADER","HGROUP","HR","HTML","I","IFRAME","IMG","INS","ISINDEX","KBD","KEYGEN","LABEL","LEGEND","LI","LINK","MAP","MARK","MATH","MENU","META","METER","NAV","NOFRAMES","NOSCRIPT","OBJECT","OL","OPTGROUP","OPTION","OUTPUT","P","PARAM","PRE","PROGRESS","Q","RP","RT","RUBY","S","SAMP","SCRIPT","SECTION","SMALL","SOURCE","SPAN","STRIKE","STRONG","STYLE","SUB","SUMMARY","SUP","SVG","TABLE","TBODY","TD","TEMPLATE","TEXTAREA","TFOOT","TH","THEAD","TIME","TITLE","TR","TRACK","TT","U","UL","VAR","VIDEO","WBR","goog.dom.tags","tags","VOID_TAGS_","col","command","embed","hr","img","keygen","link","meta","param","track","wbr","isVoidTag","goog.dom.tags.isVoidTag","TypedString","goog.string.TypedString","Const","goog.string.Const","stringConstValueWithSecurityContract__googStringSecurityPrivate_","STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_","TYPE_MARKER_","implementsGoogStringTypedString","getTypedStringValue","goog.string.Const.prototype.getTypedStringValue","goog.string.Const.prototype.toString","goog.string.Const.unwrap","stringConst","from","goog.string.Const.from","create__googStringSecurityPrivate_","goog.string.Const.create__googStringSecurityPrivate_","EMPTY","goog.html","html","SafeScript","goog.html.SafeScript","privateDoNotAccessOrElseSafeScriptWrappedValue_","SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","fromConstant","goog.html.SafeScript.fromConstant","scriptString","createSafeScriptSecurityPrivateDoNotAccessOrElse","goog.html.SafeScript.prototype.getTypedStringValue","goog.html.SafeScript.prototype.toString","goog.html.SafeScript.unwrap","safeScript","goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse","initSecurityPrivateDoNotAccessOrElse_","goog.html.SafeScript.prototype.initSecurityPrivateDoNotAccessOrElse_","SafeStyle","goog.html.SafeStyle","privateDoNotAccessOrElseSafeStyleWrappedValue_","SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","goog.html.SafeStyle.fromConstant","styleString","checkStyle_","createSafeStyleSecurityPrivateDoNotAccessOrElse","goog.html.SafeStyle.checkStyle_","goog.html.SafeStyle.prototype.getTypedStringValue","goog.html.SafeStyle.prototype.toString","goog.html.SafeStyle.unwrap","safeStyle","goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse","goog.html.SafeStyle.prototype.initSecurityPrivateDoNotAccessOrElse_","INNOCUOUS_STRING","goog.html.SafeStyle.create","VALUE_RE_","hasBalancedQuotes_","goog.html.SafeStyle.hasBalancedQuotes_","outsideSingle","outsideDouble","goog.html.SafeStyle.concat","addArgument","argument","SafeStyleSheet","goog.html.SafeStyleSheet","privateDoNotAccessOrElseSafeStyleSheetWrappedValue_","SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","goog.html.SafeStyleSheet.concat","createSafeStyleSheetSecurityPrivateDoNotAccessOrElse","goog.html.SafeStyleSheet.fromConstant","styleSheet","styleSheetString","goog.html.SafeStyleSheet.prototype.getTypedStringValue","goog.html.SafeStyleSheet.prototype.toString","goog.html.SafeStyleSheet.unwrap","safeStyleSheet","goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse","goog.html.SafeStyleSheet.prototype.initSecurityPrivateDoNotAccessOrElse_","goog.fs","fs","goog.fs.url","createObjectUrl","goog.fs.url.createObjectUrl","blob","getUrlObject_","createObjectURL","revokeObjectUrl","goog.fs.url.revokeObjectUrl","revokeObjectURL","goog.fs.url.getUrlObject_","urlObject","findUrlObject_","goog.fs.url.findUrlObject_","URL","webkitURL","browserSupportsObjectUrls","goog.fs.url.browserSupportsObjectUrls","goog.i18n","i18n","goog.i18n.bidi","bidi","FORCE_RTL","IS_RTL","Format","LRE","RLE","PDF","LRM","RLM","Dir","LTR","NEUTRAL","I18N_RIGHT","I18N_LEFT","toDir","goog.i18n.bidi.toDir","givenDir","opt_noNeutral","ltrChars_","rtlChars_","htmlSkipReg_","stripHtmlIfNeeded_","goog.i18n.bidi.stripHtmlIfNeeded_","opt_isStripNeeded","rtlCharReg_","ltrCharReg_","hasAnyRtl","goog.i18n.bidi.hasAnyRtl","opt_isHtml","hasRtlChar","hasAnyLtr","goog.i18n.bidi.hasAnyLtr","ltrRe_","rtlRe_","isRtlChar","goog.i18n.bidi.isRtlChar","isLtrChar","goog.i18n.bidi.isLtrChar","isNeutralChar","goog.i18n.bidi.isNeutralChar","ltrDirCheckRe_","rtlDirCheckRe_","startsWithRtl","goog.i18n.bidi.startsWithRtl","isRtlText","startsWithLtr","goog.i18n.bidi.startsWithLtr","isLtrText","isRequiredLtrRe_","isNeutralText","goog.i18n.bidi.isNeutralText","ltrExitDirCheckRe_","rtlExitDirCheckRe_","endsWithLtr","goog.i18n.bidi.endsWithLtr","isLtrExitText","endsWithRtl","goog.i18n.bidi.endsWithRtl","isRtlExitText","rtlLocalesRe_","isRtlLanguage","goog.i18n.bidi.isRtlLanguage","bracketGuardTextRe_","guardBracketInText","goog.i18n.bidi.guardBracketInText","opt_isRtlContext","mark","enforceRtlInHtml","goog.i18n.bidi.enforceRtlInHtml","enforceRtlInText","goog.i18n.bidi.enforceRtlInText","enforceLtrInHtml","goog.i18n.bidi.enforceLtrInHtml","enforceLtrInText","goog.i18n.bidi.enforceLtrInText","dimensionsRe_","leftRe_","rightRe_","tempRe_","mirrorCSS","goog.i18n.bidi.mirrorCSS","cssStr","doubleQuoteSubstituteRe_","singleQuoteSubstituteRe_","normalizeHebrewQuote","goog.i18n.bidi.normalizeHebrewQuote","wordSeparatorRe_","hasNumeralsRe_","rtlDetectionThreshold_","estimateDirection","goog.i18n.bidi.estimateDirection","rtlCount","totalCount","hasWeaklyLtr","tokens","token","detectRtlDirectionality","goog.i18n.bidi.detectRtlDirectionality","setElementDirAndAlign","goog.i18n.bidi.setElementDirAndAlign","dir","textAlign","setElementDirByTextDirectionality","goog.i18n.bidi.setElementDirByTextDirectionality","DirectionalString","goog.i18n.bidi.DirectionalString","SafeUrl","goog.html.SafeUrl","privateDoNotAccessOrElseSafeHtmlWrappedValue_","SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","goog.html.SafeUrl.prototype.getTypedStringValue","implementsGoogI18nBidiDirectionalString","getDirection","goog.html.SafeUrl.prototype.getDirection","goog.html.SafeUrl.prototype.toString","goog.html.SafeUrl.unwrap","safeUrl","goog.html.SafeUrl.fromConstant","createSafeUrlSecurityPrivateDoNotAccessOrElse","SAFE_MIME_TYPE_PATTERN_","fromBlob","goog.html.SafeUrl.fromBlob","DATA_URL_PATTERN_","fromDataUrl","goog.html.SafeUrl.fromDataUrl","dataUrl","valid","fromTelUrl","goog.html.SafeUrl.fromTelUrl","telUrl","SAFE_URL_PATTERN_","sanitize","goog.html.SafeUrl.sanitize","goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse","ABOUT_BLANK","TrustedResourceUrl","goog.html.TrustedResourceUrl","privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_","TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","goog.html.TrustedResourceUrl.prototype.getTypedStringValue","goog.html.TrustedResourceUrl.prototype.getDirection","goog.html.TrustedResourceUrl.prototype.toString","goog.html.TrustedResourceUrl.unwrap","trustedResourceUrl","format","goog.html.TrustedResourceUrl.format","formatStr","BASE_URL_","FORMAT_MARKER_","arg","createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse","goog.html.TrustedResourceUrl.fromConstant","fromConstants","goog.html.TrustedResourceUrl.fromConstants","unwrapped","goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse","SafeHtml","goog.html.SafeHtml","SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","dir_","goog.html.SafeHtml.prototype.getDirection","goog.html.SafeHtml.prototype.getTypedStringValue","goog.html.SafeHtml.prototype.toString","goog.html.SafeHtml.unwrap","safeHtml","goog.html.SafeHtml.htmlEscape","textOrHtml","textAsString","createSafeHtmlSecurityPrivateDoNotAccessOrElse","htmlEscapePreservingNewlines","goog.html.SafeHtml.htmlEscapePreservingNewlines","htmlEscapePreservingNewlinesAndSpaces","goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces","VALID_NAMES_IN_TAG_","URL_ATTRIBUTES_","action","cite","formaction","href","manifest","poster","NOT_ALLOWED_TAG_NAMES_","goog.html.SafeHtml.create","opt_attributes","opt_content","verifyTagName","createSafeHtmlTagSecurityPrivateDoNotAccessOrElse","goog.html.SafeHtml.verifyTagName","createIframe","goog.html.SafeHtml.createIframe","opt_src","opt_srcdoc","fixedAttributes","srcdoc","attributes","combineAttributes","sandbox","createSandboxIframe","goog.html.SafeHtml.createSandboxIframe","canUseSandboxIframe","goog.html.SafeHtml.canUseSandboxIframe","HTMLIFrameElement","createScriptSrc","goog.html.SafeHtml.createScriptSrc","createScript","goog.html.SafeHtml.createScript","attr","attrLower","content","htmlContent","createStyle","goog.html.SafeHtml.createStyle","createMetaRefresh","goog.html.SafeHtml.createMetaRefresh","opt_secs","unwrappedUrl","http-equiv","getAttrNameAndValue_","goog.html.SafeHtml.getAttrNameAndValue_","getStyleValue_","goog.html.SafeHtml.getStyleValue_","createWithDir","goog.html.SafeHtml.createWithDir","goog.html.SafeHtml.concat","htmlDir","concatWithDir","goog.html.SafeHtml.concatWithDir","goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse","goog.html.SafeHtml.prototype.initSecurityPrivateDoNotAccessOrElse_","goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse","stringifyAttributes","dirAttribute","goog.html.SafeHtml.stringifyAttributes","goog.html.SafeHtml.combineAttributes","defaultAttributes","combinedAttributes","nameLower","DOCTYPE_HTML","goog.dom.safe","safe","InsertAdjacentHtmlPosition","AFTERBEGIN","AFTEREND","BEFOREBEGIN","BEFOREEND","insertAdjacentHtml","goog.dom.safe.insertAdjacentHtml","node","insertAdjacentHTML","SET_INNER_HTML_DISALLOWED_TAGS_","setInnerHtml","goog.dom.safe.setInnerHtml","elem","setOuterHtml","goog.dom.safe.setOuterHtml","outerHTML","setStyle","goog.dom.safe.setStyle","cssText","documentWrite","goog.dom.safe.documentWrite","setAnchorHref","goog.dom.safe.setAnchorHref","anchor","assertIsHTMLAnchorElement_","setImageSrc","goog.dom.safe.setImageSrc","imageElement","assertIsHTMLImageElement_","setEmbedSrc","goog.dom.safe.setEmbedSrc","assertIsHTMLEmbedElement_","setFrameSrc","goog.dom.safe.setFrameSrc","frame","assertIsHTMLFrameElement_","setIframeSrc","goog.dom.safe.setIframeSrc","iframe","assertIsHTMLIFrameElement_","setIframeSrcdoc","goog.dom.safe.setIframeSrcdoc","setLinkHrefAndRel","goog.dom.safe.setLinkHrefAndRel","rel","assertIsHTMLLinkElement_","setObjectData","goog.dom.safe.setObjectData","assertIsHTMLObjectElement_","setScriptSrc","goog.dom.safe.setScriptSrc","assertIsHTMLScriptElement_","setLocationHref","goog.dom.safe.setLocationHref","loc","assertIsLocation_","openInWindow","goog.dom.safe.openInWindow","opt_openerWin","opt_name","opt_specs","opt_replace","goog.dom.safe.assertIsLocation_","o","Location","Element","debugStringForType_","goog.dom.safe.assertIsHTMLAnchorElement_","HTMLAnchorElement","goog.dom.safe.assertIsHTMLLinkElement_","HTMLLinkElement","goog.dom.safe.assertIsHTMLImageElement_","HTMLImageElement","goog.dom.safe.assertIsHTMLEmbedElement_","HTMLEmbedElement","goog.dom.safe.assertIsHTMLFrameElement_","HTMLFrameElement","goog.dom.safe.assertIsHTMLIFrameElement_","goog.dom.safe.assertIsHTMLObjectElement_","HTMLObjectElement","goog.dom.safe.assertIsHTMLScriptElement_","HTMLScriptElement","goog.dom.safe.debugStringForType_","goog.html.uncheckedconversions","uncheckedconversions","safeHtmlFromStringKnownToSatisfyTypeContract","goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract","justification","opt_dir","safeScriptFromStringKnownToSatisfyTypeContract","goog.html.uncheckedconversions.safeScriptFromStringKnownToSatisfyTypeContract","safeStyleFromStringKnownToSatisfyTypeContract","goog.html.uncheckedconversions.safeStyleFromStringKnownToSatisfyTypeContract","safeStyleSheetFromStringKnownToSatisfyTypeContract","goog.html.uncheckedconversions.safeStyleSheetFromStringKnownToSatisfyTypeContract","safeUrlFromStringKnownToSatisfyTypeContract","goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract","trustedResourceUrlFromStringKnownToSatisfyTypeContract","goog.html.uncheckedconversions.trustedResourceUrlFromStringKnownToSatisfyTypeContract","ASSUME_QUIRKS_MODE","ASSUME_STANDARDS_MODE","COMPAT_MODE_KNOWN_","getDomHelper","goog.dom.getDomHelper","opt_element","DomHelper","getOwnerDocument","defaultDomHelper_","getDocument","goog.dom.getDocument","getElement","goog.dom.getElement","getElementHelper_","goog.dom.getElementHelper_","getElementById","getRequiredElement","goog.dom.getRequiredElement","getRequiredElementHelper_","goog.dom.getRequiredElementHelper_","$","goog.dom.getElementsByTagName","opt_parent","getElementsByTagNameAndClass","goog.dom.getElementsByTagNameAndClass","opt_tag","opt_class","opt_el","getElementsByTagNameAndClass_","getElementsByClass","goog.dom.getElementsByClass","canUseQuerySelector_","getElementByClass","goog.dom.getElementByClass","getElementsByClassName","querySelector","getRequiredElementByClass","goog.dom.getRequiredElementByClass","opt_root","goog.dom.canUseQuerySelector_","goog.dom.getElementsByTagNameAndClass_","els","arrayLike","el","$$","setProperties","goog.dom.setProperties","properties","htmlFor","DIRECT_ATTRIBUTE_MAP_","cellpadding","cellspacing","colspan","frameborder","maxlength","nonce","role","rowspan","usemap","valign","getViewportSize","goog.dom.getViewportSize","getViewportSize_","goog.dom.getViewportSize_","isCss1CompatMode_","clientWidth","clientHeight","getDocumentHeight","goog.dom.getDocumentHeight","getDocumentHeight_","getDocumentHeightForWindow","goog.dom.getDocumentHeightForWindow","goog.dom.getDocumentHeight_","docEl","vh","offsetHeight","sh","oh","getPageScroll","goog.dom.getPageScroll","getDocumentScroll","goog.dom.getDocumentScroll","getDocumentScroll_","goog.dom.getDocumentScroll_","getDocumentScrollElement_","getWindow_","pageYOffset","scrollTop","scrollLeft","pageXOffset","getDocumentScrollElement","goog.dom.getDocumentScrollElement","goog.dom.getDocumentScrollElement_","scrollingElement","getWindow","goog.dom.getWindow","opt_doc","goog.dom.getWindow_","parentWindow","defaultView","goog.dom.createDom","opt_properties","goog.dom.createDom_","tagNameArr","append_","goog.dom.append_","startIndex","childHandler","isNodeLike","isNodeList","$dom","goog.dom.createElement","createElement_","goog.dom.createElement_","goog.dom.createTextNode","createTable","goog.dom.createTable","rows","columns","opt_fillWithNbsp","createTable_","goog.dom.createTable_","fillWithNbsp","table","tbody","tr","td","setTextContent","constHtmlToNode","goog.dom.constHtmlToNode","stringArray","safeHtmlToNode","goog.dom.safeHtmlToNode","safeHtmlToNode_","goog.dom.safeHtmlToNode_","tempDiv","childrenToNode_","goog.dom.childrenToNode_","fragment","createDocumentFragment","isCss1CompatMode","goog.dom.isCss1CompatMode","goog.dom.isCss1CompatMode_","canHaveChildren","goog.dom.canHaveChildren","goog.dom.appendChild","append","goog.dom.append","removeChildren","goog.dom.removeChildren","insertSiblingBefore","goog.dom.insertSiblingBefore","insertSiblingAfter","goog.dom.insertSiblingAfter","goog.dom.insertChildAt","goog.dom.removeNode","replaceNode","goog.dom.replaceNode","oldNode","replaceChild","flattenElement","goog.dom.flattenElement","goog.dom.getChildren","getFirstElementChild","goog.dom.getFirstElementChild","firstElementChild","getNextElementNode_","getLastElementChild","goog.dom.getLastElementChild","lastElementChild","lastChild","getNextElementSibling","goog.dom.getNextElementSibling","nextElementSibling","getPreviousElementSibling","goog.dom.getPreviousElementSibling","previousElementSibling","previousSibling","goog.dom.getNextElementNode_","forward","getNextNode","goog.dom.getNextNode","getPreviousNode","goog.dom.getPreviousNode","goog.dom.isNodeLike","isElement","goog.dom.isElement","isWindow","goog.dom.isWindow","getParentElement","goog.dom.getParentElement","SVGElement","parentElement","goog.dom.contains","descendant","compareDocumentPosition","compareNodeOrder","goog.dom.compareNodeOrder","node1","node2","isElement1","isElement2","sourceIndex","parent1","parent2","compareSiblingOrder_","compareParentsDescendantNodeIe_","range1","createRange","selectNode","collapse","range2","compareBoundaryPoints","Range","START_TO_END","goog.dom.compareParentsDescendantNodeIe_","textNode","sibling","goog.dom.compareSiblingOrder_","findCommonAncestor","goog.dom.findCommonAncestor","paths","minLength","output","first","goog.dom.getOwnerDocument","ownerDocument","getFrameContentDocument","goog.dom.getFrameContentDocument","contentDocument","contentWindow","getFrameContentWindow","goog.dom.getFrameContentWindow","goog.dom.setTextContent","getOuterHtml","goog.dom.getOuterHtml","findNode","goog.dom.findNode","root","p","findNodes_","findNodes","goog.dom.findNodes","goog.dom.findNodes_","findOne","TAGS_TO_IGNORE_","PREDEFINED_TAG_VALUES_","isFocusableTabIndex","goog.dom.isFocusableTabIndex","hasSpecifiedTabIndex_","isTabIndexFocusable_","setFocusableTabIndex","goog.dom.setFocusableTabIndex","enable","tabIndex","isFocusable","goog.dom.isFocusable","focusable","nativelySupportsFocus_","hasNonZeroBoundingRect_","goog.dom.hasSpecifiedTabIndex_","attrNode","getAttributeNode","specified","hasAttribute","goog.dom.isTabIndexFocusable_","goog.dom.nativelySupportsFocus_","goog.dom.hasNonZeroBoundingRect_","offsetWidth","getTextContent","goog.dom.getTextContent","innerText","buf","getTextContent_","getRawTextContent","goog.dom.getRawTextContent","goog.dom.getTextContent_","getNodeTextLength","goog.dom.getNodeTextLength","getNodeTextOffset","goog.dom.getNodeTextOffset","opt_offsetParent","getNodeAtOffset","goog.dom.getNodeAtOffset","opt_result","pos","pop","goog.dom.isNodeList","getAncestorByTagNameAndClass","goog.dom.getAncestorByTagNameAndClass","opt_maxSearchSteps","getAncestor","getAncestorByClass","goog.dom.getAncestorByClass","goog.dom.getAncestor","matcher","opt_includeNode","getActiveElement","goog.dom.getActiveElement","activeElement","getPixelRatio","goog.dom.getPixelRatio","devicePixelRatio","matchMedia","matchesPixelRatio_","goog.dom.matchesPixelRatio_","pixelRatio","dpiPerDppx","matches","getCanvasContext2D","goog.dom.getCanvasContext2D","getContext","goog.dom.DomHelper","document_","setDocument","goog.dom.DomHelper.prototype.setDocument","goog.dom.DomHelper.prototype.getDocument","goog.dom.DomHelper.prototype.getElement","goog.dom.DomHelper.prototype.getRequiredElement","goog.dom.DomHelper.prototype.getElementsByTagName","goog.dom.DomHelper.prototype.getElementsByTagNameAndClass","goog.dom.DomHelper.prototype.getElementsByClass","goog.dom.DomHelper.prototype.getElementByClass","goog.dom.DomHelper.prototype.getRequiredElementByClass","goog.dom.DomHelper.prototype.getViewportSize","goog.dom.DomHelper.prototype.getDocumentHeight","goog.dom.DomHelper.prototype.createDom","goog.dom.DomHelper.prototype.createElement","goog.dom.DomHelper.prototype.createTextNode","goog.dom.DomHelper.prototype.createTable","goog.dom.DomHelper.prototype.safeHtmlToNode","goog.dom.DomHelper.prototype.isCss1CompatMode","goog.dom.DomHelper.prototype.getWindow","goog.dom.DomHelper.prototype.getDocumentScrollElement","goog.dom.DomHelper.prototype.getDocumentScroll","goog.dom.DomHelper.prototype.getActiveElement","goog.dom.vendor","vendor","getVendorJsPrefix","goog.dom.vendor.getVendorJsPrefix","getVendorPrefix","goog.dom.vendor.getVendorPrefix","getPrefixedPropertyName","goog.dom.vendor.getPrefixedPropertyName","propertyName","prefixedPropertyName","getPrefixedEventType","goog.dom.vendor.getPrefixedEventType","eventType","goog.html.legacyconversions","legacyconversions","safeHtmlFromString","goog.html.legacyconversions.safeHtmlFromString","reportCallback_","safeStyleFromString","goog.html.legacyconversions.safeStyleFromString","safeStyleSheetFromString","goog.html.legacyconversions.safeStyleSheetFromString","safeUrlFromString","goog.html.legacyconversions.safeUrlFromString","trustedResourceUrlFromString","goog.html.legacyconversions.trustedResourceUrlFromString","setReportCallback","goog.html.legacyconversions.setReportCallback","goog.style","goog.style.setStyle","opt_value","setStyle_","goog.style.setStyle_","getVendorJsStyleName_","styleNameCache_","goog.style.getVendorJsStyleName_","camelStyle","prefixedStyle","getVendorStyleName_","goog.style.getVendorStyleName_","getStyle","goog.style.getStyle","property","styleValue","getComputedStyle","goog.style.getComputedStyle","styles","getPropertyValue","getCascadedStyle","goog.style.getCascadedStyle","currentStyle","getStyle_","goog.style.getStyle_","getComputedBoxSizing","goog.style.getComputedBoxSizing","getComputedPosition","goog.style.getComputedPosition","getBackgroundColor","goog.style.getBackgroundColor","getComputedOverflowX","goog.style.getComputedOverflowX","getComputedOverflowY","goog.style.getComputedOverflowY","getComputedZIndex","goog.style.getComputedZIndex","getComputedTextAlign","goog.style.getComputedTextAlign","getComputedCursor","goog.style.getComputedCursor","getComputedTransform","goog.style.getComputedTransform","setPosition","goog.style.setPosition","arg1","opt_arg2","getPixelStyleValue_","getPosition","goog.style.getPosition","offsetLeft","offsetTop","getClientViewportElement","goog.style.getClientViewportElement","opt_node","getViewportPageOffset","goog.style.getViewportPageOffset","getBoundingClientRect_","goog.style.getBoundingClientRect_","clientLeft","clientTop","getOffsetParent","goog.style.getOffsetParent","offsetParent","positionStyle","skipStatic","host","getVisibleRectForElement","goog.style.getVisibleRectForElement","visibleRect","scrollEl","getPageOffset","client","getClientLeftTop","scrollX","scrollY","winSize","getContainerOffsetToScrollInto","goog.style.getContainerOffsetToScrollInto","opt_container","elementPos","containerPos","containerBorder","getBorderBox","relX","relY","elementSize","getSizeWithDisplay_","spaceX","spaceY","scrollIntoContainerView","goog.style.scrollIntoContainerView","goog.style.getClientLeftTop","goog.style.getPageOffset","scrollCoord","getPageOffsetLeft","goog.style.getPageOffsetLeft","getPageOffsetTop","goog.style.getPageOffsetTop","getFramedPageOffset","goog.style.getFramedPageOffset","relativeWin","currentWin","currentEl","getClientPositionForElement_","frameElement","translateRectForAnotherFrame","goog.style.translateRectForAnotherFrame","origBase","newBase","getRelativePosition","goog.style.getRelativePosition","ap","getClientPosition","bp","goog.style.getClientPositionForElement_","goog.style.getClientPosition","targetEvent","setPageOffset","goog.style.setPageOffset","setSize","goog.style.setSize","opt_h","setWidth","setHeight","goog.style.getPixelStyleValue_","goog.style.setHeight","goog.style.setWidth","goog.style.getSize","evaluateWithTemporaryDisplay_","goog.style.evaluateWithTemporaryDisplay_","originalDisplay","originalVisibility","originalPosition","retVal","goog.style.getSizeWithDisplay_","webkitOffsetsZero","clientRect","getTransformedSize","goog.style.getTransformedSize","getBounds","goog.style.getBounds","goog.style.toCamelCase","selector","goog.style.toSelectorCase","getOpacity","goog.style.getOpacity","MozOpacity","setOpacity","goog.style.setOpacity","alpha","setTransparentBackgroundImage","goog.style.setTransparentBackgroundImage","backgroundImage","backgroundPosition","backgroundRepeat","clearTransparentBackgroundImage","goog.style.clearTransparentBackgroundImage","showElement","goog.style.showElement","setElementShown","goog.style.setElementShown","isShown","isElementShown","goog.style.isElementShown","installStyles","goog.style.installStyles","stylesString","installSafeStyleSheet","goog.style.installSafeStyleSheet","dh","createStyleSheet","setSafeStyleSheet","uninstallStyles","goog.style.uninstallStyles","ownerNode","owningElement","setStyles","goog.style.setStyles","goog.style.setSafeStyleSheet","setPreWrap","goog.style.setPreWrap","whiteSpace","wordWrap","setInlineBlock","goog.style.setInlineBlock","zoom","isRightToLeft","goog.style.isRightToLeft","unselectableStyle_","isUnselectable","goog.style.isUnselectable","setUnselectable","goog.style.setUnselectable","unselectable","opt_noRecurse","descendants","getBorderBoxSize","goog.style.getBorderBoxSize","setBorderBoxSize","goog.style.setBorderBoxSize","setBoxSizingSize_","paddingBox","getPaddingBox","borderBox","pixelWidth","pixelHeight","getContentBoxSize","goog.style.getContentBoxSize","ieCurrentStyle","boxSizing","getIePixelValue_","borderBoxSize","setContentBoxSize","goog.style.setContentBoxSize","goog.style.setBoxSizingSize_","MozBoxSizing","WebkitBoxSizing","goog.style.getIePixelValue_","pixelName","oldStyleValue","oldRuntimeValue","runtimeStyle","pixelValue","getIePixelDistance_","goog.style.getIePixelDistance_","getBox_","goog.style.getBox_","stylePrefix","goog.style.getPaddingBox","getMarginBox","goog.style.getMarginBox","ieBorderWidthKeywords_","thin","medium","thick","getIePixelBorder_","goog.style.getIePixelBorder_","goog.style.getBorderBox","getFontFamily","goog.style.getFontFamily","font","createTextRange","moveToElementText","queryCommandValue","fontsArray","lengthUnitRegex_","getLengthUnits","goog.style.getLengthUnits","units","ABSOLUTE_CSS_LENGTH_UNITS_","cm","in","mm","pc","pt","CONVERTIBLE_RELATIVE_CSS_UNITS_","em","getFontSize","goog.style.getFontSize","fontSize","sizeUnits","parentSize","sizeElement","parseStyleAttribute","goog.style.parseStyleAttribute","keyValue","styleName","toStyleAttribute","goog.style.toStyleAttribute","buffer","setFloat","goog.style.setFloat","getFloat","goog.style.getFloat","getScrollbarWidth","goog.style.getScrollbarWidth","opt_className","outerDiv","innerDiv","MATRIX_TRANSLATION_REGEX_","getCssTranslation","goog.style.getCssTranslation","EventHandler","goog.events.EventHandler","keys_","typeArray_","goog.events.EventHandler.prototype.listen","opt_fn","listenWithScope","goog.events.EventHandler.prototype.listenWithScope","goog.events.EventHandler.prototype.listen_","goog.events.EventHandler.prototype.listenOnce","listenOnce_","listenOnceWithScope","goog.events.EventHandler.prototype.listenOnceWithScope","goog.events.EventHandler.prototype.listenOnce_","goog.events.EventHandler.prototype.listenWithWrapper","listenWithWrapper_","listenWithWrapperAndScope","goog.events.EventHandler.prototype.listenWithWrapperAndScope","goog.events.EventHandler.prototype.listenWithWrapper_","goog.events.EventHandler.prototype.getListenerCount","goog.events.EventHandler.prototype.unlisten","goog.events.EventHandler.prototype.unlistenWithWrapper","goog.events.EventHandler.prototype.removeAll","goog.events.EventHandler.prototype.disposeInternal","goog.events.EventHandler.prototype.handleEvent","goog.events.EventTarget","eventTargetListeners_","actualEventTarget_","parentEventTarget_","MAX_ANCESTORS_","getParentEventTarget","goog.events.EventTarget.prototype.getParentEventTarget","setParentEventTarget","goog.events.EventTarget.prototype.setParentEventTarget","goog.events.EventTarget.prototype.addEventListener","opt_handlerScope","goog.events.EventTarget.prototype.removeEventListener","goog.events.EventTarget.prototype.dispatchEvent","assertInitialized_","ancestor","ancestorsTree","ancestorCount","dispatchEventInternal_","goog.events.EventTarget.prototype.disposeInternal","goog.events.EventTarget.prototype.listen","goog.events.EventTarget.prototype.listenOnce","goog.events.EventTarget.prototype.unlisten","goog.events.EventTarget.prototype.unlistenByKey","goog.events.EventTarget.prototype.removeAllListeners","goog.events.EventTarget.prototype.fireListeners","goog.events.EventTarget.prototype.getListeners","goog.events.EventTarget.prototype.getListener","goog.events.EventTarget.prototype.hasListener","setTargetForTesting","goog.events.EventTarget.prototype.setTargetForTesting","goog.events.EventTarget.prototype.assertInitialized_","goog.events.EventTarget.dispatchEventInternal_","opt_ancestorsTree","oldEvent","goog.ui","ui","IdGenerator","goog.ui.IdGenerator","nextId_","getNextUniqueId","goog.ui.IdGenerator.prototype.getNextUniqueId","Component","goog.ui.Component","opt_domHelper","dom_","rightToLeft_","defaultRightToLeft_","inDocument_","googUiComponentHandler_","childIndex_","children_","parent_","model_","wasDecorated_","ALLOW_DETACHED_DECORATION","idGenerator_","DEFAULT_BIDI_DIR","BEFORE_SHOW","SHOW","HIDE","DISABLE","ENABLE","HIGHLIGHT","UNHIGHLIGHT","ACTIVATE","UNSELECT","CHECK","UNCHECK","OPEN","CLOSE","ENTER","LEAVE","ACTION","NOT_SUPPORTED","DECORATE_INVALID","ALREADY_RENDERED","PARENT_UNABLE_TO_BE_SET","CHILD_INDEX_OUT_OF_BOUNDS","NOT_OUR_CHILD","NOT_IN_DOCUMENT","STATE_INVALID","State","ALL","DISABLED","HOVER","ACTIVE","SELECTED","CHECKED","FOCUSED","OPENED","getStateTransitionEvent","goog.ui.Component.getStateTransitionEvent","isEntering","setDefaultRightToLeft","goog.ui.Component.setDefaultRightToLeft","rightToLeft","getId","goog.ui.Component.prototype.getId","setId","goog.ui.Component.prototype.setId","goog.ui.Component.prototype.getElement","getElementStrict","goog.ui.Component.prototype.getElementStrict","setElementInternal","goog.ui.Component.prototype.setElementInternal","goog.ui.Component.prototype.getElementsByClass","goog.ui.Component.prototype.getElementByClass","goog.ui.Component.prototype.getRequiredElementByClass","getHandler","goog.ui.Component.prototype.getHandler","goog.ui.Component.prototype.setParent","getChild","goog.ui.Component.prototype.getParent","goog.ui.Component.prototype.setParentEventTarget","goog.ui.Component.prototype.getDomHelper","isInDocument","goog.ui.Component.prototype.isInDocument","goog.ui.Component.prototype.createDom","goog.ui.Component.prototype.render","opt_parentElement","render_","renderBefore","goog.ui.Component.prototype.renderBefore","goog.ui.Component.prototype.render_","opt_beforeNode","enterDocument","decorate","goog.ui.Component.prototype.decorate","canDecorate","decorateInternal","goog.ui.Component.prototype.canDecorate","wasDecorated","goog.ui.Component.prototype.wasDecorated","goog.ui.Component.prototype.decorateInternal","goog.ui.Component.prototype.enterDocument","forEachChild","exitDocument","goog.ui.Component.prototype.exitDocument","goog.ui.Component.prototype.disposeInternal","makeId","goog.ui.Component.prototype.makeId","idFragment","makeIds","goog.ui.Component.prototype.makeIds","ids","getModel","goog.ui.Component.prototype.getModel","setModel","goog.ui.Component.prototype.setModel","getFragmentFromId","goog.ui.Component.prototype.getFragmentFromId","getElementByFragment","goog.ui.Component.prototype.getElementByFragment","addChild","goog.ui.Component.prototype.addChild","opt_render","addChildAt","getChildCount","goog.ui.Component.prototype.addChildAt","insertBeforeElement","contentElement","getContentElement","getChildAt","goog.ui.Component.prototype.getContentElement","goog.ui.Component.prototype.isRightToLeft","setRightToLeft","goog.ui.Component.prototype.setRightToLeft","hasChildren","goog.ui.Component.prototype.hasChildren","goog.ui.Component.prototype.getChildCount","getChildIds","goog.ui.Component.prototype.getChildIds","goog.ui.Component.prototype.getChild","goog.ui.Component.prototype.getChildAt","goog.ui.Component.prototype.forEachChild","indexOfChild","goog.ui.Component.prototype.indexOfChild","goog.ui.Component.prototype.removeChild","opt_unrender","removeChildAt","goog.ui.Component.prototype.removeChildAt","goog.ui.Component.prototype.removeChildren","removedChildren","goog.a11y","a11y","goog.a11y.aria","aria","Role","ALERT","ALERTDIALOG","APPLICATION","BANNER","CHECKBOX","COLUMNHEADER","COMBOBOX","COMPLEMENTARY","CONTENTINFO","DEFINITION","DIRECTORY","GRID","GRIDCELL","GROUP","HEADING","LIST","LISTBOX","LISTITEM","LOG","MAIN","MARQUEE","MENUBAR","MENU_ITEM","MENU_ITEM_CHECKBOX","MENU_ITEM_RADIO","NAVIGATION","NOTE","PRESENTATION","PROGRESSBAR","RADIO","RADIOGROUP","REGION","ROW","ROWGROUP","ROWHEADER","SCROLLBAR","SEARCH","SEPARATOR","SLIDER","SPINBUTTON","STATUS","TAB","TAB_LIST","TAB_PANEL","TEXTBOX","TEXTINFO","TIMER","TOOLBAR","TOOLTIP","TREE","TREEGRID","TREEITEM","ACTIVEDESCENDANT","ATOMIC","AUTOCOMPLETE","BUSY","CONTROLS","DESCRIBEDBY","DROPEFFECT","EXPANDED","FLOWTO","GRABBED","HASPOPUP","HIDDEN","INVALID","LABELLEDBY","LEVEL","LIVE","MULTILINE","MULTISELECTABLE","ORIENTATION","OWNS","POSINSET","PRESSED","READONLY","RELEVANT","REQUIRED","SETSIZE","SORT","VALUEMAX","VALUEMIN","VALUENOW","VALUETEXT","AutoCompleteValues","INLINE","BOTH","DropEffectValues","MOVE","EXECUTE","POPUP","LivePriority","POLITE","ASSERTIVE","OrientationValues","VERTICAL","HORIZONTAL","RelevantValues","ADDITIONS","REMOVALS","SortValues","ASCENDING","DESCENDING","OTHER","CheckedValues","MIXED","UNDEFINED","ExpandedValues","GrabbedValues","InvalidValues","GRAMMAR","SPELLING","PressedValues","SelectedValues","goog.a11y.aria.datatables","datatables","getDefaultValuesMap","goog.a11y.aria.datatables.getDefaultValuesMap","DefaultStateValueMap_","ARIA_PREFIX_","ROLE_ATTRIBUTE_","TAGS_WITH_ASSUMED_ROLES_","CONTAINER_ROLES_","setRole","goog.a11y.aria.setRole","roleName","removeRole","getRole","goog.a11y.aria.getRole","goog.a11y.aria.removeRole","setState","goog.a11y.aria.setState","stateName","attrStateName","getAriaAttributeName_","defaultValueMap","toggleState","goog.a11y.aria.toggleState","getState","removeState","goog.a11y.aria.removeState","goog.a11y.aria.getState","getActiveDescendant","goog.a11y.aria.getActiveDescendant","setActiveDescendant","goog.a11y.aria.setActiveDescendant","getLabel","goog.a11y.aria.getLabel","setLabel","goog.a11y.aria.setLabel","label","assertRoleIsSetInternalUtil","goog.a11y.aria.assertRoleIsSetInternalUtil","allowedRoles","elementRole","getStateBoolean","goog.a11y.aria.getStateBoolean","getStateNumber","goog.a11y.aria.getStateNumber","getStateString","goog.a11y.aria.getStateString","getStringArrayStateInternalUtil","goog.a11y.aria.getStringArrayStateInternalUtil","attrValue","splitStringOnWhitespace_","hasState","goog.a11y.aria.hasState","isContainerRole","goog.a11y.aria.isContainerRole","goog.a11y.aria.splitStringOnWhitespace_","stringValue","goog.a11y.aria.getAriaAttributeName_","ariaName","KeyCodes","WIN_KEY_FF_LINUX","MAC_ENTER","BACKSPACE","NUM_CENTER","SHIFT","CTRL","ALT","CAPS_LOCK","ESC","SPACE","PAGE_UP","PAGE_DOWN","END","HOME","UP","DOWN","PLUS_SIGN","PRINT_SCREEN","INSERT","DELETE","ZERO","ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","FF_SEMICOLON","FF_EQUALS","FF_DASH","QUESTION_MARK","AT_SIGN","C","D","E","F","G","H","J","K","L","M","N","O","R","T","V","W","X","Y","Z","WIN_KEY_RIGHT","CONTEXT_MENU","NUM_ZERO","NUM_ONE","NUM_TWO","NUM_THREE","NUM_FOUR","NUM_FIVE","NUM_SIX","NUM_SEVEN","NUM_EIGHT","NUM_NINE","NUM_MULTIPLY","NUM_PLUS","NUM_MINUS","NUM_PERIOD","NUM_DIVISION","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","NUMLOCK","SCROLL_LOCK","FIRST_MEDIA_KEY","LAST_MEDIA_KEY","SEMICOLON","DASH","EQUALS","COMMA","PERIOD","SLASH","APOSTROPHE","TILDE","SINGLE_QUOTE","OPEN_SQUARE_BRACKET","BACKSLASH","CLOSE_SQUARE_BRACKET","WIN_KEY","MAC_FF_META","MAC_WK_CMD_LEFT","MAC_WK_CMD_RIGHT","WIN_IME","VK_NONAME","PHANTOM","isTextModifyingKeyEvent","goog.events.KeyCodes.isTextModifyingKeyEvent","firesKeyPressEvent","goog.events.KeyCodes.firesKeyPressEvent","opt_heldKeyCode","opt_shiftKey","opt_ctrlKey","opt_altKey","opt_metaKey","isCharacterKey","normalizeKeyCode","heldKeyIsModifier","modifiedShiftKey","goog.events.KeyCodes.isCharacterKey","goog.events.KeyCodes.normalizeKeyCode","normalizeGeckoKeyCode","normalizeMacWebKitKeyCode","goog.events.KeyCodes.normalizeGeckoKeyCode","goog.events.KeyCodes.normalizeMacWebKitKeyCode","KeyHandler","goog.events.KeyHandler","attach","keyPressKey_","keyDownKey_","keyUpKey_","lastKey_","keyCode_","altKey_","KEY","safariKey_","3","12","63232","63233","63234","63235","63236","63237","63238","63239","63240","63241","63242","63243","63244","63245","63246","63247","63248","63272","63273","63275","63276","63277","63289","63302","keyIdentifier_","Up","Down","Left","Right","Enter","U+007F","Home","End","PageUp","PageDown","Insert","USES_KEYDOWN_","SAVE_ALT_FOR_KEYPRESS_","handleKeyDown_","goog.events.KeyHandler.prototype.handleKeyDown_","resetState","goog.events.KeyHandler.prototype.resetState","handleKeyup_","goog.events.KeyHandler.prototype.handleKeyup_","goog.events.KeyHandler.prototype.handleEvent","keyIdentifier","event","KeyEvent","goog.events.KeyHandler.prototype.getElement","goog.events.KeyHandler.prototype.attach","detach","goog.events.KeyHandler.prototype.detach","goog.events.KeyHandler.prototype.disposeInternal","goog.events.KeyEvent","browserEvent","goog.dom.classlist","classlist","ALWAYS_USE_DOM_TOKEN_LIST","goog.dom.classlist.get","classList","goog.dom.classlist.set","goog.dom.classlist.contains","goog.dom.classlist.add","addAll","goog.dom.classlist.addAll","classesToAdd","classMap","goog.dom.classlist.remove","goog.dom.classlist.removeAll","classesToRemove","goog.dom.classlist.enable","enabled","enableAll","goog.dom.classlist.enableAll","classesToEnable","swap","goog.dom.classlist.swap","fromClass","toClass","toggle","goog.dom.classlist.toggle","addRemove","goog.dom.classlist.addRemove","classToRemove","classToAdd","goog.ui.registry","registry","getDefaultRenderer","goog.ui.registry.getDefaultRenderer","componentCtor","rendererCtor","defaultRenderers_","setDefaultRenderer","goog.ui.registry.setDefaultRenderer","getDecoratorByClassName","goog.ui.registry.getDecoratorByClassName","decoratorFunctions_","setDecoratorByClassName","goog.ui.registry.setDecoratorByClassName","decoratorFn","getDecorator","goog.ui.registry.getDecorator","classNames","decorator","reset","goog.ui.registry.reset","ContainerRenderer","goog.ui.ContainerRenderer","opt_ariaRole","ariaRole_","getCustomRenderer","goog.ui.ContainerRenderer.getCustomRenderer","cssClassName","renderer","getCssClass","renderer.getCssClass","CSS_CLASS","getAriaRole","goog.ui.ContainerRenderer.prototype.getAriaRole","enableTabIndex","goog.ui.ContainerRenderer.prototype.enableTabIndex","goog.ui.ContainerRenderer.prototype.createDom","getClassNames","goog.ui.ContainerRenderer.prototype.getContentElement","goog.ui.ContainerRenderer.prototype.canDecorate","goog.ui.ContainerRenderer.prototype.decorate","baseClass","hasBaseClass","setStateFromClassName","decorateChildren","goog.ui.ContainerRenderer.prototype.setStateFromClassName","setEnabled","setOrientation","Container","Orientation","goog.ui.ContainerRenderer.prototype.decorateChildren","opt_firstChild","getDecoratorForChild","isEnabled","goog.ui.ContainerRenderer.prototype.getDecoratorForChild","initializeDom","goog.ui.ContainerRenderer.prototype.initializeDom","hideFocus","ariaRole","getKeyEventTarget","goog.ui.ContainerRenderer.prototype.getKeyEventTarget","goog.ui.ContainerRenderer.prototype.getCssClass","goog.ui.ContainerRenderer.prototype.getClassNames","isHorizontal","getOrientation","getDefaultOrientation","goog.ui.ContainerRenderer.prototype.getDefaultOrientation","ControlRenderer","goog.ui.ControlRenderer","goog.ui.ControlRenderer.getCustomRenderer","IE6_CLASS_COMBINATIONS","TOGGLE_ARIA_STATE_MAP_","goog.ui.ControlRenderer.prototype.getAriaRole","goog.ui.ControlRenderer.prototype.createDom","control","getContent","goog.ui.ControlRenderer.prototype.getContentElement","enableClassName","goog.ui.ControlRenderer.prototype.enableClassName","getAppliedCombinedClassNames_","enableExtraClassName","goog.ui.ControlRenderer.prototype.enableExtraClassName","goog.ui.ControlRenderer.prototype.canDecorate","goog.ui.ControlRenderer.prototype.decorate","contentElem","setContentInternal","rendererClassName","structuralClassName","getStructuralCssClass","hasRendererClassName","hasStructuralClassName","hasCombinedClassName","getStateFromClass","setStateInternal","extraClassNames","getExtraClassNames","combinedClasses","goog.ui.ControlRenderer.prototype.initializeDom","setFocusable","setAriaRole","goog.ui.ControlRenderer.prototype.setAriaRole","opt_preferredRole","setAriaStates","goog.ui.ControlRenderer.prototype.setAriaStates","ariaLabel","getAriaLabel","setAriaLabel","updateAriaState","isSupportedState","isSelected","isChecked","goog.ui.ControlRenderer.prototype.setAriaLabel","setAllowTextSelection","goog.ui.ControlRenderer.prototype.setAllowTextSelection","allow","goog.ui.ControlRenderer.prototype.setRightToLeft","goog.ui.ControlRenderer.prototype.isFocusable","keyTarget","goog.ui.ControlRenderer.prototype.setFocusable","isFocused","blur","handleBlur","goog.ui.ControlRenderer.prototype.setVisible","goog.ui.ControlRenderer.prototype.setState","getClassForState","goog.ui.ControlRenderer.prototype.updateAriaState","ariaAttributeMap_","ariaAttr","getAriaStateForAriaRole_","goog.ui.ControlRenderer.getAriaStateForAriaRole_","matchAttr","isAriaState_","goog.ui.ControlRenderer.isAriaState_","setContent","goog.ui.ControlRenderer.prototype.setContent","goog.ui.ControlRenderer.prototype.getKeyEventTarget","goog.ui.ControlRenderer.prototype.getCssClass","getIe6ClassCombinations","goog.ui.ControlRenderer.prototype.getIe6ClassCombinations","goog.ui.ControlRenderer.prototype.getStructuralCssClass","goog.ui.ControlRenderer.prototype.getClassNames","cssClass","structuralCssClass","classNamesForState","getClassNamesForState","goog.ui.ControlRenderer.prototype.getAppliedCombinedClassNames_","classes","opt_includedClass","toAdd","combo","goog.ui.ControlRenderer.prototype.getClassNamesForState","mask","goog.ui.ControlRenderer.prototype.getClassForState","classByState_","createClassByStateMap_","goog.ui.ControlRenderer.prototype.getStateFromClass","stateByClass_","createStateByClassMap_","goog.ui.ControlRenderer.prototype.createClassByStateMap_","isValidClassName","goog.ui.ControlRenderer.prototype.createStateByClassMap_","Control","goog.ui.Control","opt_renderer","renderer_","ariaLabel_","registerDecorator","content_","state_","supportedStates_","autoStates_","statesWithTransitionEvents_","visible_","extraClassNames_","handleMouseEvents_","allowTextSelection_","preferredAriaRole_","isHandleMouseEvents","goog.ui.Control.prototype.isHandleMouseEvents","setHandleMouseEvents","goog.ui.Control.prototype.setHandleMouseEvents","enableMouseEventHandling_","goog.ui.Control.prototype.getKeyEventTarget","getKeyHandler","goog.ui.Control.prototype.getKeyHandler","keyHandler_","getRenderer","goog.ui.Control.prototype.getRenderer","setRenderer","goog.ui.Control.prototype.setRenderer","goog.ui.Control.prototype.getExtraClassNames","addClassName","goog.ui.Control.prototype.addClassName","removeClassName","goog.ui.Control.prototype.removeClassName","goog.ui.Control.prototype.enableClassName","goog.ui.Control.prototype.createDom","getPreferredAriaRole","isAllowTextSelection","goog.ui.Control.prototype.getPreferredAriaRole","setPreferredAriaRole","goog.ui.Control.prototype.setPreferredAriaRole","goog.ui.Control.prototype.getAriaLabel","goog.ui.Control.prototype.setAriaLabel","goog.ui.Control.prototype.getContentElement","goog.ui.Control.prototype.canDecorate","goog.ui.Control.prototype.decorateInternal","goog.ui.Control.prototype.enterDocument","keyHandler","handleKeyEvent","handleFocus","goog.ui.Control.prototype.enableMouseEventHandling_","handleMouseOver","handleMouseDown","handleMouseUp","handleMouseOut","handleContextMenu","handleDblClick","ieMouseEventSequenceSimulator_","IeMouseEventSequenceSimulator_","goog.ui.Control.prototype.exitDocument","goog.ui.Control.prototype.disposeInternal","goog.ui.Control.prototype.getContent","goog.ui.Control.prototype.setContent","goog.ui.Control.prototype.setContentInternal","getCaption","goog.ui.Control.prototype.getCaption","caption","setCaption","goog.ui.Control.prototype.setCaption","goog.ui.Control.prototype.setRightToLeft","goog.ui.Control.prototype.isAllowTextSelection","goog.ui.Control.prototype.setAllowTextSelection","goog.ui.Control.prototype.isVisible","goog.ui.Control.prototype.setVisible","opt_force","goog.ui.Control.prototype.isEnabled","isParentDisabled_","goog.ui.Control.prototype.isParentDisabled_","goog.ui.Control.prototype.setEnabled","isTransitionAllowed","setActive","setHighlighted","isHighlighted","goog.ui.Control.prototype.isHighlighted","goog.ui.Control.prototype.setHighlighted","goog.ui.Control.prototype.isActive","goog.ui.Control.prototype.setActive","active","goog.ui.Control.prototype.isSelected","setSelected","goog.ui.Control.prototype.setSelected","goog.ui.Control.prototype.isChecked","setChecked","goog.ui.Control.prototype.setChecked","goog.ui.Control.prototype.isFocused","setFocused","goog.ui.Control.prototype.setFocused","focused","goog.ui.Control.prototype.isOpen","setOpen","goog.ui.Control.prototype.setOpen","goog.ui.Control.prototype.getState","goog.ui.Control.prototype.hasState","goog.ui.Control.prototype.setState","opt_calledFrom","goog.ui.Control.prototype.setStateInternal","goog.ui.Control.prototype.isSupportedState","setSupportedState","goog.ui.Control.prototype.setSupportedState","support","isAutoState","goog.ui.Control.prototype.isAutoState","setAutoStates","goog.ui.Control.prototype.setAutoStates","states","isDispatchTransitionEvents","goog.ui.Control.prototype.isDispatchTransitionEvents","setDispatchTransitionEvents","goog.ui.Control.prototype.setDispatchTransitionEvents","goog.ui.Control.prototype.isTransitionAllowed","goog.ui.Control.prototype.handleMouseOver","isMouseEventWithinElement_","goog.ui.Control.prototype.handleMouseOut","goog.ui.Control.isMouseEventWithinElement_","goog.ui.Control.prototype.handleMouseDown","focus","goog.ui.Control.prototype.handleMouseUp","performActionInternal","goog.ui.Control.prototype.handleDblClick","goog.ui.Control.prototype.performActionInternal","actionEvent","goog.ui.Control.prototype.handleFocus","goog.ui.Control.prototype.handleBlur","goog.ui.Control.prototype.handleKeyEvent","handleKeyEventInternal","goog.ui.Control.prototype.handleKeyEventInternal","goog.ui.Control.IeMouseEventSequenceSimulator_","goog.ui.Control.IeMouseEventSequenceSimulator_.base","control_","clickExpected_","handleMouseDown_","handleMouseUp_","handleClick_","SYNTHETIC_EVENTS_","goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleMouseDown_","goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleMouseUp_","makeLeftMouseEvent_","goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_","typeArg","createEvent","initMouseEvent","bubbles","cancelable","view","detail","goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleClick_","origEventButton","origEventType","down","up","goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.disposeInternal","goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.disposeInternal.base","goog.ui.Container","opt_orientation","orientation_","AFTER_SHOW","AFTER_HIDE","keyEventTarget_","enabled_","focusable_","highlightedIndex_","openItem_","mouseButtonPressed_","allowFocusableChildren_","openFollowsHighlight_","childElementIdMap_","goog.ui.Container.prototype.getKeyEventTarget","setKeyEventTarget","goog.ui.Container.prototype.setKeyEventTarget","oldTarget","inDocument","newTarget","enableFocusHandling_","goog.ui.Container.prototype.getKeyHandler","goog.ui.Container.prototype.getRenderer","goog.ui.Container.prototype.setRenderer","goog.ui.Container.prototype.createDom","goog.ui.Container.prototype.getContentElement","goog.ui.Container.prototype.canDecorate","goog.ui.Container.prototype.decorateInternal","goog.ui.Container.prototype.enterDocument","registerChildId_","handleEnterItem","handleHighlightItem","handleUnHighlightItem","handleOpenItem","handleCloseItem","handleDocumentMouseUp","handleChildMouseEvents","goog.ui.Container.prototype.enableFocusHandling_","goog.ui.Container.prototype.exitDocument","setHighlightedIndex","goog.ui.Container.prototype.disposeInternal","goog.ui.Container.prototype.handleEnterItem","goog.ui.Container.prototype.handleHighlightItem","getHighlighted","isMouseButtonPressed","goog.ui.Container.prototype.handleUnHighlightItem","goog.ui.Container.prototype.handleOpenItem","goog.ui.Container.prototype.handleCloseItem","targetEl","goog.ui.Container.prototype.handleMouseDown","setMouseButtonPressed","goog.ui.Container.prototype.handleDocumentMouseUp","goog.ui.Container.prototype.handleChildMouseEvents","getOwnerControl","goog.ui.Container.prototype.getOwnerControl","goog.ui.Container.prototype.handleFocus","goog.ui.Container.prototype.handleBlur","goog.ui.Container.prototype.handleKeyEvent","goog.ui.Container.prototype.handleKeyEventInternal","highlighted","highlightFirst","highlightLast","highlightPrevious","highlightNext","goog.ui.Container.prototype.registerChildId_","childElem","goog.ui.Container.prototype.addChild","goog.ui.Container.prototype.addChildAt","isFocusableChildrenAllowed","srcIndex","updateHighlightedIndex_","goog.ui.Container.prototype.updateHighlightedIndex_","goog.ui.Container.prototype.removeChild","goog.ui.Container.prototype.getOrientation","goog.ui.Container.prototype.setOrientation","orientation","goog.ui.Container.prototype.isVisible","goog.ui.Container.prototype.setVisible","goog.ui.Container.prototype.isEnabled","goog.ui.Container.prototype.setEnabled","wasDisabled","goog.ui.Container.prototype.isFocusable","goog.ui.Container.prototype.setFocusable","goog.ui.Container.prototype.isFocusableChildrenAllowed","setFocusableChildrenAllowed","goog.ui.Container.prototype.setFocusableChildrenAllowed","isOpenFollowsHighlight","goog.ui.Container.prototype.isOpenFollowsHighlight","setOpenFollowsHighlight","goog.ui.Container.prototype.setOpenFollowsHighlight","follow","getHighlightedIndex","goog.ui.Container.prototype.getHighlightedIndex","goog.ui.Container.prototype.setHighlightedIndex","goog.ui.Container.prototype.setHighlighted","goog.ui.Container.prototype.getHighlighted","goog.ui.Container.prototype.highlightFirst","highlightHelper","goog.ui.Container.prototype.highlightLast","goog.ui.Container.prototype.highlightNext","goog.ui.Container.prototype.highlightPrevious","goog.ui.Container.prototype.highlightHelper","curIndex","numItems","canHighlightItem","setHighlightedIndexFromKeyEvent","goog.ui.Container.prototype.canHighlightItem","goog.ui.Container.prototype.setHighlightedIndexFromKeyEvent","getOpenItem","goog.ui.Container.prototype.getOpenItem","goog.ui.Container.prototype.isMouseButtonPressed","goog.ui.Container.prototype.setMouseButtonPressed","pressed","MenuHeaderRenderer","goog.ui.MenuHeaderRenderer","goog.ui.MenuHeaderRenderer.prototype.getCssClass","MenuHeader","goog.ui.MenuHeader","MenuItemRenderer","goog.ui.MenuItemRenderer","classNameCache_","CompositeCssClassIndex_","CONTENT","getCompositeCssClass_","goog.ui.MenuItemRenderer.prototype.getCompositeCssClass_","goog.ui.MenuItemRenderer.prototype.getAriaRole","goog.ui.MenuItemRenderer.prototype.createDom","createContent","setEnableCheckBoxStructure","goog.ui.MenuItemRenderer.prototype.getContentElement","goog.ui.MenuItemRenderer.prototype.decorate","hasContentStructure","setCheckable","goog.ui.MenuItemRenderer.prototype.setContent","checkBoxElement","hasCheckBoxStructure","goog.ui.MenuItemRenderer.prototype.hasContentStructure","contentClassName","goog.ui.MenuItemRenderer.prototype.createContent","setSelectable","goog.ui.MenuItemRenderer.prototype.setSelectable","selectable","goog.ui.MenuItemRenderer.prototype.setCheckable","checkable","goog.ui.MenuItemRenderer.prototype.hasCheckBoxStructure","checkboxClassName","goog.ui.MenuItemRenderer.prototype.setEnableCheckBoxStructure","goog.ui.MenuItemRenderer.prototype.getClassForState","goog.ui.MenuItemRenderer.prototype.getStateFromClass","hoverClassName","goog.ui.MenuItemRenderer.prototype.getCssClass","MenuItem","goog.ui.MenuItem","opt_model","setValue","MNEMONIC_WRAPPER_CLASS_","ACCELERATOR_CLASS","goog.ui.MenuItem.prototype.getValue","model","goog.ui.MenuItem.prototype.setValue","goog.ui.MenuItem.prototype.setSupportedState","goog.ui.MenuItem.prototype.setSupportedState.base","setSelectableInternal_","setCheckableInternal_","goog.ui.MenuItem.prototype.setSelectable","goog.ui.MenuItem.prototype.setSelectableInternal_","goog.ui.MenuItem.prototype.setCheckable","goog.ui.MenuItem.prototype.setCheckableInternal_","goog.ui.MenuItem.prototype.getCaption","acceleratorClass","mnemonicWrapClass","getAccelerator","goog.ui.MenuItem.prototype.getAccelerator","acceleratorEl","goog.ui.MenuItem.prototype.handleMouseUp","parentMenu","oldCoords","openingCoords","newCoords","goog.ui.MenuItem.prototype.handleMouseUp.base","goog.ui.MenuItem.prototype.handleKeyEventInternal","getMnemonic","goog.ui.MenuItem.prototype.handleKeyEventInternal.base","setMnemonic","goog.ui.MenuItem.prototype.setMnemonic","mnemonicKey_","goog.ui.MenuItem.prototype.getMnemonic","goog.ui.MenuItem.prototype.getPreferredAriaRole","goog.ui.MenuItem.prototype.getPreferredAriaRole.base","goog.ui.MenuItem.prototype.getParent","goog.ui.MenuItem.prototype.getParentEventTarget","MenuSeparatorRenderer","goog.ui.MenuSeparatorRenderer","goog.ui.MenuSeparatorRenderer.prototype.createDom","goog.ui.MenuSeparatorRenderer.prototype.decorate","goog.ui.MenuSeparatorRenderer.prototype.setContent","goog.ui.MenuSeparatorRenderer.prototype.getCssClass","Separator","goog.ui.Separator","goog.ui.Separator.prototype.enterDocument","MenuRenderer","goog.ui.MenuRenderer","goog.ui.MenuRenderer.prototype.canDecorate","goog.ui.MenuRenderer.prototype.getDecoratorForChild","containsElement","goog.ui.MenuRenderer.prototype.containsElement","menu","goog.ui.MenuRenderer.prototype.getCssClass","goog.ui.MenuRenderer.prototype.initializeDom","MenuSeparator","goog.ui.MenuSeparator","Menu","goog.ui.Menu","BEFORE_HIDE","allowAutoFocus_","allowHighlightDisabled_","goog.ui.Menu.prototype.getCssClass","goog.ui.Menu.prototype.containsElement","addItem","goog.ui.Menu.prototype.addItem","addItemAt","goog.ui.Menu.prototype.addItemAt","removeItem","goog.ui.Menu.prototype.removeItem","removedChild","removeItemAt","goog.ui.Menu.prototype.removeItemAt","getItemAt","goog.ui.Menu.prototype.getItemAt","getItemCount","goog.ui.Menu.prototype.getItemCount","getItems","goog.ui.Menu.prototype.getItems","goog.ui.Menu.prototype.setPosition","goog.ui.Menu.prototype.getPosition","setAllowAutoFocus","goog.ui.Menu.prototype.setAllowAutoFocus","getAllowAutoFocus","goog.ui.Menu.prototype.getAllowAutoFocus","setAllowHighlightDisabled","goog.ui.Menu.prototype.setAllowHighlightDisabled","getAllowHighlightDisabled","goog.ui.Menu.prototype.getAllowHighlightDisabled","goog.ui.Menu.prototype.setVisible","show","visibilityChanged","goog.ui.Menu.prototype.handleEnterItem","highlightNextPrefix","goog.ui.Menu.prototype.highlightNextPrefix","charStr","wrapped","goog.ui.Menu.prototype.canHighlightItem","goog.ui.Menu.prototype.decorateInternal","decorateContent","goog.ui.Menu.prototype.handleKeyEventInternal","handled","goog.ui.Menu.prototype.handleKeyEventInternal.base","menuItem","goog.ui.Menu.prototype.setHighlightedIndex","goog.ui.Menu.prototype.setHighlightedIndex.base","goog.ui.Menu.prototype.decorateContent","contentElements","Blockly.ContextMenu","ContextMenu","currentBlock","Blockly.ContextMenu.show","WidgetDiv","option","hide","windowSize","scrollOffset","menuDom","menuSize","Blockly.ContextMenu.hide","hideIfOwner","optionToDom_","Blockly.ContextMenu.optionToDom_","gElement","Y_HEIGHT","textElement","X_PADDING","callbackFactory","Blockly.ContextMenu.callbackFactory","Field","Blockly.Field","fieldGroup_","borderRect_","textElement_","size_","setText","getFieldHelperOptions_","Blockly.Field.prototype.getFieldHelperOptions_","getParentEditor_","Blockly.Field.prototype.getParentEditor_","getRootSVGElement_","Blockly.Field.prototype.getRootSVGElement_","Blockly.Field.prototype.init","updateEditable","mouseDownWrapper_","onMouseDown_","mouseUpWrapper_","onMouseUp_","clickWrapper_","onClick_","Blockly.Field.prototype.dispose","Blockly.Field.prototype.updateEditable","cursor","CURSOR","Blockly.Field.prototype.isVisible","Blockly.Field.prototype.setVisible","Blockly.Field.prototype.getRootElement","updateWidth_","Blockly.Field.prototype.updateWidth_","getComputedTextLength","Blockly.Field.prototype.getSize","Blockly.Field.prototype.getBufferY","getText","Blockly.Field.prototype.getText","text_","Blockly.Field.prototype.setText","refreshRender","Blockly.Field.prototype.refreshRender","Blockly.Field.prototype.getValue","Blockly.Field.prototype.setValue","isKeyboardInputField_","Blockly.Field.prototype.isKeyboardInputField_","showEditorOnClick_","Blockly.Field.prototype.showEditorOnClick_","Blockly.Field.prototype.onMouseDown_","Blockly.Field.prototype.onMouseUp_","Blockly.Field.prototype.onClick_","setTooltip","Blockly.Field.prototype.setTooltip","newTip","positionWidgetDiv","Blockly.Field.prototype.positionWidgetDiv","handleBlockSpaceScrolled","Blockly.Field.prototype.handleBlockSpaceScrolled","showWidgetDiv_","Blockly.Field.prototype.showWidgetDiv_","generateWidgetDisposeHandler_","blockSpaceScrolledListenKey_","Blockly.Field.prototype.generateWidgetDisposeHandler_","Blockly.Tooltip","mouseOutPid_","showPid_","lastXY_","poisonedElement_","svgText_","svgShadow_","OFFSET_X","OFFSET_Y","RADIUS_OK","HOVER_MS","MARGINS","Blockly.Tooltip.createDom","Blockly.Tooltip.bindMouseEvents","onMouseOver_","onMouseOut_","onMouseMove_","Blockly.Tooltip.onMouseOver_","Blockly.Tooltip.onMouseOut_","Blockly.Tooltip.onMouseMove_","show_","Blockly.Tooltip.hide","Blockly.Tooltip.show_","tip","tspanElement","maxWidth","anchorX","anchorY","svgSize","FieldLabel","Blockly.FieldLabel","customOptions","forceWidth_","forceSize_","fixedSize","fontSize_","Blockly.FieldLabel.prototype.init","Blockly.FieldLabel.prototype.getSize","Blockly.FieldLabel.prototype.getBufferY","Blockly.FieldLabel.prototype.setText","Blockly.FieldLabel.prototype.dispose","Blockly.FieldLabel.prototype.getRootElement","Blockly.FieldLabel.prototype.setTooltip","Input","Blockly.Input","statementTrailingSpace","inline_","colour_","hue","saturation","statementTrailingSpace_","appendTitle","Blockly.Input.prototype.appendTitle","prefixTitle","suffixTitle","Blockly.Input.prototype.isVisible","Blockly.Input.prototype.setVisible","Blockly.Input.prototype.setStrictCheck","Blockly.Input.prototype.setCheck","Blockly.Input.prototype.addFieldHelper","setAlign","Blockly.Input.prototype.setAlign","Blockly.Input.prototype.init","Blockly.Input.prototype.dispose","setInline","Blockly.Input.prototype.setInline","Blockly.Input.prototype.isInline","inputsInline","Blockly.Input.prototype.setHSV","Blockly.Input.prototype.getHexColour","Blockly.Input.prototype.getStatementTrailingSpace","matchesBlock","Blockly.Input.prototype.matchesBlock","Blockly.Msg","Bubble","Blockly.Bubble","shape","bubbleWidth","bubbleHeight","dragCanvas","ARROW_ANGLE","arrow_radians_","shape_","dragCanvas_","setAnchorLocation","BORDER_WIDTH","setBubbleSize","positionBubble_","renderArrow_","rendered_","bubbleBack_","bubbleMouseDown_","resizeGroup_","resizeMouseDown_","ARROW_THICKNESS","ARROW_BEND","ANCHOR_RADIUS","unbindDragEvents_","Blockly.Bubble.unbindDragEvents_","anchorX_","anchorY_","relativeLeft_","relativeTop_","width_","height_","autoLayout_","Blockly.Bubble.prototype.createDom_","hasResize","bubbleGroup_","bubbleEmboss","bubbleArrow_","resizeSize","points","Blockly.Bubble.prototype.bubbleMouseDown_","promote_","isTargetInput","dragDeltaX","dragDeltaY","bubbleMouseMove_","Blockly.Bubble.prototype.bubbleMouseMove_","Blockly.Bubble.prototype.resizeMouseDown_","resizeDeltaWidth","resizeDeltaHeight","resizeMouseMove_","Blockly.Bubble.prototype.resizeMouseMove_","registerResizeEvent","Blockly.Bubble.prototype.registerResizeEvent","thisObject","Blockly.Bubble.prototype.promote_","Blockly.Bubble.prototype.setAnchorLocation","layoutBubble_","Blockly.Bubble.prototype.layoutBubble_","relativeLeft","relativeTop","Blockly.Bubble.prototype.positionBubble_","convertCoordinates","blockSpaceWidth_","getBubbleSize","Blockly.Bubble.prototype.getBubbleSize","Blockly.Bubble.prototype.setBubbleSize","doubleBorderWidth","Blockly.Bubble.prototype.renderArrow_","relBubbleX","relBubbleY","relAnchorX","relAnchorY","run","hypotenuse","rise","acos","rightAngle","rightRise","rightRun","bubbleSize","thickness","backoffRatio","baseX1","baseY1","swirlAngle","swirlRise","swirlRun","baseX2","baseY2","setColour","Blockly.Bubble.prototype.setColour","Blockly.Bubble.prototype.dispose","Icon","Blockly.Icon","RADIUS","bubble_","iconX_","iconY_","createIcon_","Blockly.Icon.prototype.createIcon_","iconGroup_","iconClick_","Blockly.Icon.prototype.dispose","Blockly.Icon.prototype.updateEditable","Blockly.Icon.prototype.isVisible","Blockly.Icon.prototype.iconClick_","Blockly.Icon.prototype.updateColour","Blockly.Icon.prototype.renderIcon","diameter","computeIconLocation","setIconLocation","Blockly.Icon.prototype.setIconLocation","Blockly.Icon.prototype.computeIconLocation","blockXY","iconXY","newX","getIconLocation","Blockly.Icon.prototype.getIconLocation","Mutator","Blockly.Mutator","quarkNames","quarkXml_","blockSpaceHeight_","Blockly.Mutator.prototype.createIcon","quantum","iconMark_","createEditor_","Blockly.Mutator.prototype.createEditor_","svgDialog_","getFlyoutMetrics_","Flyout","autoClose","resizeBubble_","Blockly.Mutator.prototype.resizeBubble_","flyoutMetrics","getMetrics_","translation","Blockly.Mutator.prototype.setVisible","thisObj","rootBlock_","decompose","margin","saveConnections","sourceListener_","blockSpaceChanged_","Blockly.Mutator.prototype.blockSpaceChanged_","blockHW","MARGIN","savedRendered","Blockly.Mutator.prototype.getFlyoutMetrics_","Blockly.Mutator.prototype.dispose","Warning","Blockly.Warning","Blockly.Warning.prototype.createIcon_","textToDom_","Blockly.Warning.prototype.textToDom_","paragraph","Blockly.Warning.prototype.setVisible","foreignObject_","body_","bodyFocus_","Blockly.Warning.prototype.bodyFocus_","Blockly.Warning.prototype.setText","Blockly.Warning.prototype.dispose","warning","Blockly.Block","contextMenu","parentBlock_","childBlocks_","userVisible_","editable_","movable_","deletable_","currentlyHidden_","dragging_","collapsed_","nextConnectionDisabled_","canDisconnectFromParent_","editLabel_","colourSaturation_","colourValue_","fillPattern_","blockSvgClass_","customOptions_","beforeDispose","setRenderBlockSpace","Blocks","unknown","appendDummyInput","shouldHideIfInMainBlockSpace","setCurrentlyHidden","handleBlockLimitChanges","blockEvents","AFTER_DISPOSED","AFTER_DROPPED","onchange","Blockly.Block.prototype.handleBlockLimitChanges","onBlockLimitChange","Blockly.Block.prototype.onBlockLimitChange","remaining","Blockly.Block.prototype.setRenderBlockSpace","Blockly.Block.prototype.getIcons","Blockly.Block.prototype.initSvg","moveToFrontOfMainCanvas_","Blockly.Block.prototype.getSvgRoot","DRAG_MODE_NOT_DRAGGING","DRAG_MODE_INSIDE_STICKY_RADIUS","DRAG_MODE_FREELY_DRAGGING","dragMode_","Blockly.Block.isDragging","Blockly.Block.isFreelyDragging","startDragging","Blockly.Block.startDragging","terminateDrag_","Blockly.Block.terminateDrag_","startDragY","draggedBubbles_","setDragging_","bumpBlocksIntoBlockSpace","Blockly.Block.prototype.select","Blockly.Block.prototype.unselect","isCopyable","Blockly.Block.prototype.isCopyable","Blockly.Block.prototype.dispose","healStack","animate","unplug","updateBlockSpaceCallback","Blockly.Block.prototype.unplug","bump","previousTarget","nextTarget","Blockly.Block.prototype.getRelativeToSurfaceXY","elementIsRootCanvas","Blockly.Block.prototype.moveTo","oldXY","Blockly.Block.prototype.moveBy","Blockly.Block.prototype.getBox","Blockly.Block.prototype.getSvgPadding","Blockly.Block.prototype.getHeightWidth","ie10OrOlder","initialStyle","expectedBBoxY","BROKEN_CONTROL_POINTS","Blockly.Block.prototype.onMouseDown_","svgResize","showContextMenu_","startDragMouseX_","startDragMouseY_","bubble","Blockly.Block.prototype.onMouseUp_","thisBlockSpace","areBlockAndDescendantsDeletable","showHelp_","Blockly.Block.prototype.showHelp_","helpUrl","duplicate_","Blockly.Block.prototype.duplicate_","Blockly.Block.prototype.showContextMenu_","duplicateOption","DUPLICATE_BLOCK","disableOption","ENABLE_BLOCK","DISABLE_BLOCK","descendantCount","deleteOption","DELETE_BLOCK","DELETE_X_BLOCKS","limitOption","prompt","getCustomContextMenuItems","customContextMenu","Blockly.Block.prototype.getConnections_","myConnections","getLeafConnections_","Blockly.Block.prototype.getLeafConnections_","leaves","allConnections","Blockly.Block.prototype.moveConnections_","Blockly.Block.prototype.setDragging_","adding","setDraggingHandleImmovable_","Blockly.Block.prototype.getDragging","Blockly.Block.prototype.setDraggingHandleImmovable_","immovableBlockHandler","Blockly.Block.prototype.setCanDisconnectFromParent","canDisconnect","Blockly.Block.prototype.canDisconnectFromParent","moveToDragCanvas_","Blockly.Block.prototype.moveToDragCanvas_","Blockly.Block.prototype.moveToFrontOfMainCanvas_","Blockly.Block.prototype.moveBlockBeingDragged_","singleBlock","DRAG_RADIUS","firstImmovableBlockHandler","generateReconnector_","localConnection","radiusConnection","myConnection","neighbour","oldConnection","pendingConnection","Blockly.Block.prototype.pendingConnection","newConnection","Blockly.Block.prototype.onMouseMove_","Blockly.Block.prototype.generateReconnector_","earlierConnection","earlierNextConnection","Blockly.Block.prototype.bumpNeighbours","BUMP_UNCONNECTED","otherRootBlock","bumpOther","rootY","otherY","Blockly.Block.prototype.getParent","getSurroundParent","Blockly.Block.prototype.getSurroundParent","Blockly.Block.prototype.getRootBlock","Blockly.Block.prototype.getChildren","Blockly.Block.prototype.setParent","newParent","parentXY","newXY","Blockly.Block.prototype.getDescendants","Blockly.Block.prototype.areBlockAndDescendantsDeletable","deleteBlockedByChildren","Blockly.Block.prototype.isDeletable","Blockly.Block.prototype.setDeletable","Blockly.Block.prototype.shouldBeGrayedOut","grayOutUndeletableBlocks","Blockly.Block.prototype.isMovable","Blockly.Block.prototype.setMovable","Blockly.Block.prototype.isEditable","Blockly.Block.prototype.setEditable","Blockly.Block.prototype.isUserVisible","Blockly.Block.prototype.setUserVisible","opt_renderAfterVisible","Blockly.Block.prototype.isNextConnectionDisabled","Blockly.Block.prototype.isFunctionDefinition","getProcedureInfo","Blockly.Block.prototype.setNextConnectionDisabled","isCurrentlyBeingDragged","Blockly.Block.prototype.isCurrentlyBeingDragged","isCurrentlyHidden_","Blockly.Block.prototype.isCurrentlyHidden_","Blockly.Block.prototype.setCurrentlyHidden","hidden","Blockly.Block.prototype.isVisible","setHelpUrl","Blockly.Block.prototype.setHelpUrl","Blockly.Block.prototype.getHexColour","Blockly.Block.prototype.getColour","colourHue_","Blockly.Block.prototype.getSaturation","Blockly.Block.prototype.getFillPattern","isFramed","Blockly.Block.prototype.isFramed","Blockly.Block.prototype.getValue","Blockly.Block.prototype.setColour","colourHue","setFillPattern","Blockly.Block.prototype.setFillPattern","setFramed","Blockly.Block.prototype.setFramed","Blockly.Block.prototype.isUnused","Blockly.Block.prototype.setIsUnused","showUnusedBlocks","setFunctional","Blockly.Block.prototype.setFunctional","isFunctional","Blockly.Block.prototype.setHSV","colourSaturation","colourValue","getTitle_","Blockly.Block.prototype.getTitle_","Blockly.Block.prototype.getTitles","Blockly.Block.prototype.getTitleValue","Blockly.Block.prototype.setTitleValue","newValue","Blockly.Block.prototype.setFieldConfig","fieldName","configString","field","setConfig","Blockly.Block.prototype.setTooltip","Blockly.Block.prototype.setPreviousStatement","hasPrevious","opt_check","Blockly.Block.prototype.setNextStatement","hasNext","setStrictOutput","Blockly.Block.prototype.setStrictOutput","hasOutput","Blockly.Block.prototype.setOutput","Blockly.Block.prototype.refreshRender","setFunctionalOutput","Blockly.Block.prototype.setFunctionalOutput","changeFunctionalOutput","Blockly.Block.prototype.changeFunctionalOutput","newType","FunctionalTypeColors","setInputsInline","Blockly.Block.prototype.setInputsInline","Blockly.Block.prototype.setDisabled","Blockly.Block.prototype.getInheritedDisabled","Blockly.Block.prototype.isCollapsed","Blockly.Block.prototype.setCollapsed","COLLAPSE_CHARS","COLLAPSED_INPUT_NAME","removeInput","Blockly.Block.prototype.toString","opt_maxLength","Blockly.Block.prototype.appendValueInput","appendInput_","Blockly.Block.prototype.appendStatementInput","trailingSpacing","Blockly.Block.prototype.appendDummyInput","Blockly.Block.prototype.appendFunctionalInput","interpolateMsg","Blockly.Block.prototype.interpolateMsg","dummyAlign","digit","Blockly.Block.prototype.appendInput_","spacing","moveInputBefore","Blockly.Block.prototype.moveInputBefore","refName","inputIndex","refIndex","Blockly.Block.prototype.removeInput","opt_quiet","Blockly.Block.prototype.getInput","Blockly.Block.prototype.getInputTargetBlock","attachBlockToInputName","Blockly.Block.prototype.attachBlockToInputName","setMutator","Blockly.Block.prototype.setMutator","setWarningText","Blockly.Block.prototype.setWarningText","changedState","Blockly.Block.prototype.setInputCount","svgInitialized","Blockly.Block.prototype.svgInitialized","Blockly.Block.prototype.render","Blockly.Block.prototype.getSvgRenderer","hasUnfilledFunctionalInput","Blockly.Block.prototype.hasUnfilledFunctionalInput","AngleHelper","Blockly.AngleHelper","turnRight_","arcColour_","arcColour","angle_","circleR_","circleR","dragging","strokeWidth_","strokeWidth","snapPoints_","snapPoints","center_","lineLength_","circleCenter_","animationInterval_","variableLine_","circle_","arc_","onUpdate_","onUpdate","animateAngleChange","Blockly.AngleHelper.prototype.animateAngleChange","targetAngle","animationDuration","minSteps","totalDiff","getAngle","diffPerStep","clearInterval","setInterval","setAngle","newAngle","timePerStep","Blockly.AngleHelper.prototype.setAngle","skipSnap","snap_","update_","Blockly.AngleHelper.prototype.getAngle","Blockly.AngleHelper.prototype.init","svgContainer","xmlns","xmlns:html","xmlns:xlink","mouseMoveWrapper_","updateDrag_","stopDrag_","startDrag_","stroke-linecap","stroke-dasharray","stroke-opacity","Blockly.AngleHelper.prototype.update_","describeArc","arcStart","Blockly.AngleHelper.prototype.startDrag_","Blockly.AngleHelper.prototype.updateDrag_","Blockly.AngleHelper.prototype.stopDrag_","Blockly.AngleHelper.prototype.snap_","prev","curr","Blockly.AngleHelper.prototype.dispose","Blockly.AngleHelper.describeArc","vector","largeArcFlag","sweepFlag","BlockFieldHelper","ANGLE_HELPER","Blockly.FieldTextInput","opt_changeHandler","changeHandler_","angleHelper","ANGLE_HELPER_SIZE","Blockly.FieldTextInput.prototype.dispose","Blockly.FieldTextInput.prototype.setText","validated","shouldShowAngleHelper_","Blockly.FieldTextInput.prototype.shouldShowAngleHelper_","getAngleHelperDirection_","Blockly.FieldTextInput.prototype.getAngleHelperDirection_","directionTitleName","directionTitle","showAngleHelper_","Blockly.FieldTextInput.prototype.showAngleHelper_","colour","htmlInput_","Blockly.FieldTextInput.prototype.showEditor_","htmlInput","numberValidator","nonnegativeIntegerValidator","oldValue_","validate_","resizeEditor_","setSelectionRange","onKeyUpWrapper_","onHtmlInputChange_","onKeyPressWrapper_","blockSpaceSvg","onBlockSpaceChangeWrapper_","Blockly.FieldTextInput.prototype.onHtmlInputChange_","Blockly.FieldTextInput.prototype.validate_","Blockly.FieldTextInput.prototype.resizeEditor_","Blockly.FieldTextInput.prototype.positionWidgetDiv","getAbsoluteXY_","borderBBox","Blockly.FieldTextInput.prototype.generateWidgetDisposeHandler_","superWidgetDisposeHandler_","FieldRectangularDropdown","Blockly.FieldTextInput.prototype.isKeyboardInputField_","Blockly.FieldTextInput.numberValidator","Blockly.FieldTextInput.nonnegativeIntegerValidator","FieldAngle","Blockly.FieldAngle","changeHandler","angleValidator","symbol_","HALF","dispose_","Blockly.FieldAngle.prototype.dispose_","thisField","gauge_","moveWrapper1_","moveWrapper2_","Blockly.FieldAngle.prototype.showEditor_","svg","circle","marginLeft","onMouseMove","updateGraph","Blockly.FieldAngle.prototype.onMouseMove","ownerSVGElement","atan","Blockly.FieldAngle.prototype.setText","Blockly.FieldAngle.prototype.updateGraph","Blockly.FieldAngle.angleValidator","INNER_HEIGHT","Y_OFFSET","chooseNumberOfColumns","FieldButton","Blockly.FieldButton","opt_buttonHandler","opt_color","buttonHandler_","buttonElement_","fillOpacity","Blockly.FieldButton.prototype.getValue","value_","Blockly.FieldButton.prototype.setValue","override","Blockly.FieldButton.prototype.showEditor_","Blockly.FieldButton.prototype.updateWidth_","FieldCheckbox","Blockly.FieldCheckbox","checkElement_","Blockly.FieldCheckbox.prototype.getValue","Blockly.FieldCheckbox.prototype.setValue","strBool","newState","Blockly.FieldCheckbox.prototype.showEditor_","goog.color","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","parse","goog.color.parse","maybeHex","prependHashIfNecessaryHelper","isValidHexColor_","hex","normalizeHex","isValidRgbColor_","isValidColor","goog.color.isValidColor","parseRgb","goog.color.parseRgb","hexToRgbStyle","goog.color.hexToRgbStyle","hexColor","rgbStyle_","hexTripletRe_","goog.color.normalizeHex","goog.color.hexToRgb","rgbToHex","goog.color.rgbToHex","hexR","prependZeroIfNecessaryHelper","hexG","hexB","goog.color.rgbArrayToHex","rgbToHsl","goog.color.rgbToHsl","normR","normG","normB","rgbArrayToHsl","goog.color.rgbArrayToHsl","hueToRgb_","goog.color.hueToRgb_","vH","hslToRgb","goog.color.hslToRgb","temp2","temp1","normH","hslArrayToRgb","goog.color.hslArrayToRgb","hsl","validHexColorRe_","goog.color.isValidHexColor_","normalizedHexColorRe_","isNormalizedHexColor_","goog.color.isNormalizedHexColor_","rgbColorRe_","goog.color.isValidRgbColor_","regExpResultArray","goog.color.prependZeroIfNecessaryHelper","goog.color.prependHashIfNecessaryHelper","goog.color.rgbStyle_","hsvToRgb","goog.color.hsvToRgb","brightness","sextant","val1","val2","val3","rgbToHsv","goog.color.rgbToHsv","delta","rgbArrayToHsv","goog.color.rgbArrayToHsv","hsvArrayToRgb","goog.color.hsvArrayToRgb","hsv","hexToHsl","goog.color.hexToHsl","hslToHex","goog.color.hslToHex","hslArrayToHex","goog.color.hslArrayToHex","hexToHsv","goog.color.hexToHsv","hsvToHex","goog.color.hsvToHex","hsvArrayToHex","goog.color.hsvArrayToHex","hslDistance","goog.color.hslDistance","hsl1","hsl2","sl1","sl2","blend","goog.color.blend","rgb1","rgb2","factor","goog.color.darken","goog.color.lighten","highContrast","goog.color.highContrast","prime","suggestions","suggestionsWithDiff","diff","yiqBrightnessDiff_","colorDiff_","yiqBrightness_","goog.color.yiqBrightness_","goog.color.yiqBrightnessDiff_","goog.color.colorDiff_","goog.iter","iter","StopIteration","Iterator","goog.iter.Iterator","goog.iter.Iterator.prototype.next","__iterator__","goog.iter.Iterator.prototype.__iterator__","opt_keys","toIterator","goog.iter.toIterator","iterable","newIter","newIter.next","goog.iter.forEach","goog.iter.filter","filterFalse","goog.iter.filterFalse","goog.iter.range","startOrStop","opt_stop","goog.iter.join","deliminator","goog.iter.map","goog.iter.reduce","goog.iter.some","goog.iter.every","chain","goog.iter.chain","chainFromIterable","goog.iter.chainFromIterable","iter.next","it","dropWhile","goog.iter.dropWhile","dropping","takeWhile","goog.iter.takeWhile","goog.iter.toArray","goog.iter.equals","iterable1","iterable2","pairs","zipLongest","nextOrValue","goog.iter.nextOrValue","product","goog.iter.product","arrays","indicies","valueIndex","arrayIndex","cycle","goog.iter.cycle","baseIterator","cacheIndex","useCache","returnElement","goog.iter.count","opt_start","counter","goog.iter.repeat","accumulate","goog.iter.accumulate","total","goog.iter.zip","iterators","goog.iter.zipLongest","fillValue","iteratorsHaveValues","compress","goog.iter.compress","selectors","selectorIterator","GroupByIterator_","goog.iter.GroupByIterator_","opt_keyFunc","goog.iter.GroupByIterator_.prototype.next","currentKey","targetKey","currentValue","groupItems_","goog.iter.GroupByIterator_.prototype.groupItems_","groupBy","goog.iter.groupBy","starMap","goog.iter.starMap","tee","goog.iter.tee","opt_num","buffers","createIterator","addNextIteratorValueToBuffers","enumerate","goog.iter.enumerate","goog.iter.limit","limitSize","consume","goog.iter.consume","goog.iter.slice","hasDuplicates_","goog.iter.hasDuplicates_","deduped","permutations","goog.iter.permutations","opt_length","elements","sets","combinations","goog.iter.combinations","getIndexFromElements","indexes","indexIterator","sortedIndexIterator","combinationsWithReplacement","goog.iter.combinationsWithReplacement","TagWalkType","START_TAG","END_TAG","TagIterator","goog.dom.TagIterator","opt_reversed","opt_unconstrained","opt_tagType","opt_depth","reversed","tagType","started_","constrained","depth","goog.dom.TagIterator.prototype.setPosition","copyFrom","goog.dom.TagIterator.prototype.copyFrom","goog.dom.TagIterator.prototype.clone","skipTag","goog.dom.TagIterator.prototype.skipTag","restartTag","goog.dom.TagIterator.prototype.restartTag","goog.dom.TagIterator.prototype.next","startType","isStarted","goog.dom.TagIterator.prototype.isStarted","isStartTag","goog.dom.TagIterator.prototype.isStartTag","isEndTag","goog.dom.TagIterator.prototype.isEndTag","isNonElement","goog.dom.TagIterator.prototype.isNonElement","goog.dom.TagIterator.prototype.equals","goog.dom.TagIterator.prototype.splice","NodeIterator","goog.dom.NodeIterator","goog.dom.NodeIterator.prototype.next","PaletteRenderer","goog.ui.PaletteRenderer","cellId_","goog.ui.PaletteRenderer.prototype.createDom","palette","createGrid","goog.ui.PaletteRenderer.prototype.createGrid","items","cells","column","createCell","createRow","goog.ui.PaletteRenderer.prototype.createTable","cellSpacing","cellPadding","goog.ui.PaletteRenderer.prototype.createRow","goog.ui.PaletteRenderer.prototype.createCell","cell","ariaLabelForCell","findAriaLabelForCell_","goog.ui.PaletteRenderer.prototype.findAriaLabelForCell_","goog.ui.PaletteRenderer.prototype.canDecorate","goog.ui.PaletteRenderer.prototype.decorate","goog.ui.PaletteRenderer.prototype.setContent","getContainingItem","goog.ui.PaletteRenderer.prototype.getContainingItem","highlightCell","goog.ui.PaletteRenderer.prototype.highlightCell","getCellForItem","goog.ui.PaletteRenderer.prototype.getCellForItem","selectCell","goog.ui.PaletteRenderer.prototype.selectCell","goog.ui.PaletteRenderer.prototype.getCssClass","SelectionModel","goog.ui.SelectionModel","opt_items","items_","addItems","selectedItem_","selectionHandler_","getSelectionHandler","goog.ui.SelectionModel.prototype.getSelectionHandler","setSelectionHandler","goog.ui.SelectionModel.prototype.setSelectionHandler","goog.ui.SelectionModel.prototype.getItemCount","indexOfItem","goog.ui.SelectionModel.prototype.indexOfItem","getFirst","goog.ui.SelectionModel.prototype.getFirst","getLast","goog.ui.SelectionModel.prototype.getLast","goog.ui.SelectionModel.prototype.getItemAt","goog.ui.SelectionModel.prototype.addItems","selectItem_","goog.ui.SelectionModel.prototype.addItem","goog.ui.SelectionModel.prototype.addItemAt","goog.ui.SelectionModel.prototype.removeItem","goog.ui.SelectionModel.prototype.removeItemAt","getSelectedItem","goog.ui.SelectionModel.prototype.getSelectedItem","goog.ui.SelectionModel.prototype.getItems","setSelectedItem","goog.ui.SelectionModel.prototype.setSelectedItem","getSelectedIndex","goog.ui.SelectionModel.prototype.getSelectedIndex","setSelectedIndex","goog.ui.SelectionModel.prototype.setSelectedIndex","goog.ui.SelectionModel.prototype.clear","goog.ui.SelectionModel.prototype.disposeInternal","goog.ui.SelectionModel.prototype.selectItem_","Palette","goog.ui.Palette","goog.ui.Palette.base","currentCellControl_","CurrentCell_","lastHighlightedIndex_","AFTER_HIGHLIGHT","selectionModel_","goog.ui.Palette.prototype.disposeInternal","goog.ui.Palette.prototype.setContentInternal","adjustSize_","handleSelectionChange","goog.ui.Palette.prototype.getCaption","goog.ui.Palette.prototype.setCaption","goog.ui.Palette.prototype.handleMouseOver","getHighlightedItem","setHighlightedItem","goog.ui.Palette.prototype.handleMouseDown","goog.ui.Palette.prototype.performActionInternal","highlightedItem","shouldSelectHighlightedItem_","goog.ui.Palette.prototype.performActionInternal.base","goog.ui.Palette.prototype.shouldSelectHighlightedItem_","goog.ui.Palette.prototype.handleKeyEvent","numColumns","highlightedIndex","goog.ui.Palette.prototype.handleSelectionChange","goog.ui.Palette.prototype.getSize","goog.ui.Palette.prototype.setSize","opt_rows","goog.ui.Palette.prototype.getHighlightedIndex","goog.ui.Palette.prototype.getHighlightedItem","getHighlightedCellElement_","goog.ui.Palette.prototype.getHighlightedCellElement_","goog.ui.Palette.prototype.setHighlightedIndex","highlightIndex_","goog.ui.Palette.prototype.setHighlightedItem","goog.ui.Palette.prototype.getSelectedIndex","goog.ui.Palette.prototype.getSelectedItem","goog.ui.Palette.prototype.setSelectedIndex","goog.ui.Palette.prototype.setSelectedItem","goog.ui.Palette.prototype.highlightIndex_","cellEl","tryHighlight","goog.ui.Palette.prototype.setHighlighted","goog.ui.Palette.prototype.setHighlighted.base","goog.ui.Palette.prototype.selectItem_","goog.ui.Palette.prototype.adjustSize_","minRows","goog.ui.Palette.CurrentCell_","goog.ui.Palette.CurrentCell_.base","goog.ui.Palette.CurrentCell_.prototype.tryHighlight","ColorPalette","goog.ui.ColorPalette","opt_colors","colors_","setColors","normalizedColors_","labels_","getColors","goog.ui.ColorPalette.prototype.getColors","goog.ui.ColorPalette.prototype.setColors","colors","opt_labels","createColorNodes","getSelectedColor","goog.ui.ColorPalette.prototype.getSelectedColor","selectedItem","parseColor_","setSelectedColor","goog.ui.ColorPalette.prototype.setSelectedColor","goog.ui.ColorPalette.prototype.createColorNodes","swatch","goog.ui.ColorPalette.parseColor_","ColorPicker","goog.ui.ColorPicker","opt_colorPalette","colorPalette_","onColorPaletteAction_","DEFAULT_NUM_COLS","goog.ui.ColorPicker.prototype.getColors","goog.ui.ColorPicker.prototype.setColors","createColorPalette_","addColors","goog.ui.ColorPicker.prototype.addColors","goog.ui.ColorPicker.prototype.setSize","goog.ui.ColorPicker.prototype.getSize","setColumnCount","goog.ui.ColorPicker.prototype.setColumnCount","goog.ui.ColorPicker.prototype.getSelectedIndex","goog.ui.ColorPicker.prototype.setSelectedIndex","ind","goog.ui.ColorPicker.prototype.getSelectedColor","goog.ui.ColorPicker.prototype.setSelectedColor","goog.ui.ColorPicker.prototype.isFocusable","goog.ui.ColorPicker.prototype.setFocusable","goog.ui.ColorPicker.prototype.canDecorate","goog.ui.ColorPicker.prototype.enterDocument","goog.ui.ColorPicker.prototype.disposeInternal","goog.ui.ColorPicker.prototype.focus","goog.ui.ColorPicker.prototype.onColorPaletteAction_","goog.ui.ColorPicker.prototype.createColorPalette_","cp","createSimpleColorGrid","goog.ui.ColorPicker.createSimpleColorGrid","SIMPLE_GRID_COLORS","FieldColour","Blockly.FieldColour","Blockly.FieldColour.prototype.dispose","Blockly.FieldColour.prototype.getValue","Blockly.FieldColour.prototype.setValue","COLOURS","COLUMNS","Blockly.FieldColour.prototype.showEditor_","picker","changeEventKey_","Blockly.FieldColour.prototype.positionWidgetDiv","Blockly.FieldColour.prototype.generateWidgetDisposeHandler_","Blockly.ImageDimensionCache","ImageDimensionCache","imageDimensions_","IMAGE_LOADING_WIDTH","IMAGE_LOADING_HEIGHT","getCachedDimensionsOrDefaultAndUpdate","Blockly.ImageDimensionCache.getCachedDimensionsOrDefaultAndUpdate","imageUrl","onDimensionUpdate","cachedDimensions","getCachedDimensions","getDimensionsAsync","Blockly.ImageDimensionCache.getCachedDimensions","storeDimensions","Blockly.ImageDimensionCache.storeDimensions","Blockly.ImageDimensionCache.getDimensionsAsync","Image","onload","img.onload","FieldImage","Blockly.FieldImage","dimensions","updatedWidth","updatedHeight","isDestroyed_","updateDimensions_","initializeWithImage_","Blockly.FieldImage.prototype.isDestroyed_","imageElement_","IMAGE_OFFSET_Y","BELOW_IMAGE_PADDING","Blockly.FieldImage.prototype.initializeWithImage_","clickRectElement_","fill-opacity","Blockly.FieldImage.prototype.updateDimensions_","Blockly.FieldImage.prototype.init","topElement","getClickTarget","Blockly.FieldImage.prototype.dispose","Blockly.FieldImage.prototype.getClickTarget","Blockly.FieldImage.prototype.setTooltip","Blockly.FieldImage.prototype.getText","src_","Blockly.FieldImage.prototype.setText","Blockly.FieldRectangularDropdown","choices","choices_","firstTuple","TUPLE_VALUE_INDEX","firstPreviewData","TUPLE_PREVIEW_DATA_INDEX","buildDOMElements_","updatePreviewData_","BORDER_MARGIN","DROPDOWN_MENU_BORDER","MENU_CSS_CLASS","BORDER_OFFSET_X","BORDER_OFFSET_Y","BORDER_RECTANGLE_RADIUS","BORDER_EXTRA_ARROW_WIDTH","DROPDOWN_ARROW_WIDTH","DROPDOWN_ARROW_HEIGHT","DROPDOWN_ARROW_X_OFFSET_FROM_PREVIEW_RIGHT","DROPDOWN_ARROW_Y_OFFSET_FROM_PREVIEW_MIDDLE","CHECKMARK_OVERHANG","DOWN_ARROW_CHARACTER","UP_ARROW_CHARACTER","getOptions","Blockly.FieldRectangularDropdown.prototype.getOptions","Blockly.FieldRectangularDropdown.prototype.buildDOMElements_","dropdownBorderRectElement_","addPreviewElementTo_","createDropdownArrow_","Blockly.FieldRectangularDropdown.prototype.addPreviewElementTo_","Blockly.FieldRectangularDropdown.prototype.createDropdownArrow_","dropdownArrowText_","arrowCharacter_","Blockly.FieldRectangularDropdown.prototype.updatePreviewData_","previewData","Blockly.FieldRectangularDropdown.prototype.updateDimensions_","previewRectangleWidth","previewRectangleHeight","previewSize_","borderHeight","borderWidth","updatePreviewDimensions_","previewMiddle","Blockly.FieldRectangularDropdown.prototype.updatePreviewDimensions_","previewWidth","previewHeight","createDropdownPreviewElement_","Blockly.FieldRectangularDropdown.prototype.createDropdownPreviewElement_","pointArrowUp_","Blockly.FieldRectangularDropdown.prototype.pointArrowUp_","setArrowDirection_","pointArrowDown_","Blockly.FieldRectangularDropdown.prototype.pointArrowDown_","Blockly.FieldRectangularDropdown.prototype.setArrowDirection_","showMenu_","Blockly.FieldRectangularDropdown.prototype.showMenu_","menu_","createMenuWithChoices_","generateMenuItemSelectedHandler_","addPositionAndShowMenu","hideMenu_","Blockly.FieldRectangularDropdown.prototype.hideMenu_","menuAlreadyShowing_","Blockly.FieldRectangularDropdown.prototype.menuAlreadyShowing_","isOwner","Blockly.FieldRectangularDropdown.prototype.createMenuWithChoices_","isCurrentSelection","dropdownPreviewElement","singleColumnLayout","Blockly.FieldRectangularDropdown.prototype.generateMenuItemSelectedHandler_","fieldRectanglularDropdown","googMenuElement","Blockly.FieldRectangularDropdown.prototype.generateWidgetDisposeHandler_","Blockly.FieldRectangularDropdown.prototype.addPositionAndShowMenu","widgetDiv","backdropColour","calculateBackdropColourWithoutAlpha_","borderColor","numberOfColumns","marginWidth","Blockly.FieldRectangularDropdown.prototype.positionWidgetDiv","menuPosition","calculateMenuPosition_","previewElement_","Blockly.FieldRectangularDropdown.prototype.calculateMenuPosition_","dropdownTargetElement","positionBelow","menuTopLeft","previewTopLeft","Blockly.FieldRectangularDropdown.prototype.getValue","Blockly.FieldRectangularDropdown.prototype.setValue","refreshPreview_","Blockly.FieldRectangularDropdown.prototype.refreshPreview_","getCurrentPreviewData_","Blockly.FieldRectangularDropdown.prototype.getCurrentPreviewData_","getPreviewDataForValue_","Blockly.FieldRectangularDropdown.prototype.getPreviewDataForValue_","Blockly.FieldRectangularDropdown.prototype.init","updateDropdownArrowColour_","Blockly.FieldRectangularDropdown.prototype.updateDropdownArrowColour_","Blockly.FieldRectangularDropdown.prototype.dispose","Blockly.FieldRectangularDropdown.prototype.onMouseUp_","doNotOpenEditorNextMouseUp_","Blockly.FieldRectangularDropdown.prototype.onMouseDown_","Blockly.FieldRectangularDropdown.prototype.getClickTarget","sendClickRectToFront_","Blockly.FieldRectangularDropdown.prototype.sendClickRectToFront_","Blockly.FieldRectangularDropdown.prototype.calculateBackdropColourWithoutAlpha_","blockColour","mixColoursWithForegroundOpacity","backdropOverlayColour","backdropOverlayOpacity","FieldColourDropdown","Blockly.FieldColourDropdown","colourChoiceTuples","convertColourChoicesToTuples_","Blockly.FieldColourDropdown.prototype.convertColourChoicesToTuples_","previewDataValueTuples","choice","choiceTuple","Blockly.FieldColourDropdown.prototype.addPreviewElementTo_","Blockly.FieldColourDropdown.prototype.createDropdownPreviewElement_","backgroundColor","Blockly.FieldColourDropdown.prototype.updatePreviewData_","Blockly.FieldColourDropdown.prototype.updatePreviewDimensions_","FieldDropdown","Blockly.FieldDropdown","menuGenerator","opt_alwaysCallChangeHandler","menuGenerator_","NO_OPTIONS_MESSAGE","alwaysCallChangeHandler_","trimOptions_","arrow_","Blockly.FieldDropdown.prototype.showEditor_","overflowY","Blockly.FieldDropdown.prototype.positionWidgetDiv","isIOS","Blockly.FieldDropdown.prototype.trimOptions_","strings","shortest","shortestStringLength","prefixLength","commonWordPrefix","suffixLength","commonWordSuffix","newOptions","Blockly.FieldDropdown.prototype.getOptions","Blockly.FieldDropdown.prototype.getValue","Blockly.FieldDropdown.prototype.setValue","setToFirstValue_","Blockly.FieldDropdown.prototype.setToFirstValue_","Blockly.FieldDropdown.prototype.setConfig","numberOptions","printerRangeToNumbers","Blockly.FieldDropdown.prototype.setText","Blockly.FieldDropdown.prototype.dispose","FieldAngleDropdown","Blockly.FieldAngleDropdown","getAngleDirection_","Blockly.FieldAngleDropdown.prototype.getAngleDirection_","Blockly.FieldAngleDropdown.prototype.showEditor_","angleHelperHeight","angleHelperWidth","Blockly.FieldAngleDropdown.prototype.dispose","FieldAngleTextInput","Blockly.FieldAngleTextInput","Blockly.FieldAngleTextInput.prototype.getFieldHelperOptions_","field_helper","FieldIcon","Blockly.FieldIcon","Blockly.FieldIcon.prototype.showEditor_","FieldImageDropdown","Blockly.FieldImageDropdown","hasForcedDimensions_","Blockly.FieldImageDropdown.prototype.hasForcedDimensions_","Blockly.FieldImageDropdown.prototype.addPreviewElementTo_","preserveAspectRatio","Blockly.FieldImageDropdown.prototype.updatePreviewData_","getUpdatedDimensions_","Blockly.FieldImageDropdown.prototype.createDropdownPreviewElement_","imagePath","createAutoSizedDropdownPreviewElement_","createImageDropdownPreviewElement_","Blockly.FieldImageDropdown.prototype.createAutoSizedDropdownPreviewElement_","backgroundSize","Blockly.FieldImageDropdown.prototype.createImageDropdownPreviewElement_","Blockly.FieldImageDropdown.prototype.getUpdatedDimensions_","Blockly.FieldImageDropdown.prototype.updatePreviewDimensions_","BlockLimits","Blockly.BlockLimits","limits_","Blockly.BlockLimits.prototype.setLimit","updateCount","updateBlockTotals","Blockly.BlockLimits.prototype.updateBlockTotals","blockTypes","countsByType","aggregateCounts","Blockly.BlockLimits.prototype.updateCount","newCount","countChanged","Blockly.BlockLimits.prototype.getLimit","hasBlockLimits","Blockly.BlockLimits.prototype.hasBlockLimits","canAddBlocks","Blockly.BlockLimits.prototype.canAddBlocks","blockTypeWithinLimits","Blockly.BlockLimits.prototype.blockTypeWithinLimits","blockLimitExceeded","Blockly.BlockLimits.prototype.blockLimitExceeded","Blockly.Flyout","opt_static","blockSpaceEditor_","setMetrics_","static_","changeWrapper_","buttons_","listeners_","configure","Blockly.Flyout.configure","Blockly.Flyout.prototype.createDom","insideToolbox","Blockly.Flyout.prototype.dispose","targetBlockSpace_","Blockly.Flyout.prototype.getMetrics_","optionBox","Blockly.Flyout.prototype.getHeight","Blockly.Flyout.prototype.setMetrics_","yRatio","Blockly.Flyout.prototype.init","withScrollbars","useHorizontalScrollbar","useVerticalScrollbar","position_","onBlockSpaceChange_","Blockly.Flyout.prototype.position_","customFlyoutMetrics_","edgeWidth","flyoutWidth","Blockly.Flyout.prototype.isVisible","Blockly.Flyout.prototype.hide","opt_saveBlock","reflowWrapper_","layoutBlock_","Blockly.Flyout.prototype.layoutBlock_","gap","initialX","layoutXmlToBlocks_","Blockly.Flyout.prototype.layoutXmlToBlocks_","xmlList","gaps","Blockly.Flyout.prototype.show","minFlyoutWidth_","firstBlock","Variables","NAME_TYPE","flyoutCategory","DEFAULT_CATEGORY","functionEditor","addButtonToFlyout_","FUNCTION_CREATE","createFunction_","disableProcedureAutopopulate","procedureInfo","isFunctionalVariable","NAME_TYPE_FUNCTIONAL_VARIABLE","FUNCTIONAL_VARIABLE_CREATE","createFunctionalVariable_","addDefaultVar","initialize","allBlocks","flyoutRect_","createBlockFunc_","blockMouseDown_","reflow","filterForCapacity_","updateBlockLimitTotals_","Blockly.Flyout.prototype.addButtonToFlyout_","buttonText","onMouseDown","bounds","Blockly.Flyout.prototype.reflow","Blockly.Flyout.prototype.blockMouseDown_","startBlock_","startFlyout_","Blockly.Flyout.prototype.onMouseMove_","Blockly.Flyout.prototype.createFunction_","openWithNewFunction","Blockly.Flyout.prototype.createFunctionalVariable_","contractEditor","openWithNewVariable","Blockly.Flyout.prototype.createBlockFunc_","originBlock","targetBlockSpace","svgRootOld","xyOld","svgRootNew","xyNew","Blockly.Flyout.prototype.onBlockSpaceChange_","Blockly.Flyout.prototype.filterForCapacity_","Blockly.Flyout.prototype.updateBlockLimitTotals_","Blockly.Flyout.terminateDrag_","Blockly.Flyout.prototype.setEnabled","Blockly.Flyout.prototype.getRect","BIG_NUM","Blockly.Flyout.prototype.getAllBlocks","FocusHandler","goog.events.FocusHandler","typeOut","listenKeyIn_","listenKeyOut_","goog.events.FocusHandler.prototype.handleEvent","goog.events.FocusHandler.prototype.disposeInternal","goog.structs","structs","goog.structs.getCount","goog.structs.getValues","goog.structs.getKeys","goog.structs.contains","goog.structs.isEmpty","goog.structs.clear","goog.structs.forEach","values","goog.structs.filter","goog.structs.map","goog.structs.some","goog.structs.every","Collection","goog.structs.Collection","Map","goog.structs.Map","opt_map","map_","version_","count_","goog.structs.Map.prototype.getCount","goog.structs.Map.prototype.getValues","cleanupKeysArray_","goog.structs.Map.prototype.getKeys","goog.structs.Map.prototype.containsKey","hasKey_","goog.structs.Map.prototype.containsValue","goog.structs.Map.prototype.equals","otherMap","opt_equalityFn","equalityFn","defaultEquals","goog.structs.Map.defaultEquals","goog.structs.Map.prototype.isEmpty","goog.structs.Map.prototype.clear","goog.structs.Map.prototype.remove","goog.structs.Map.prototype.cleanupKeysArray_","destIndex","goog.structs.Map.prototype.get","goog.structs.Map.prototype.set","goog.structs.Map.prototype.addAll","goog.structs.Map.prototype.forEach","goog.structs.Map.prototype.clone","goog.structs.Map.prototype.transpose","goog.structs.Map.prototype.toObject","getKeyIterator","goog.structs.Map.prototype.getKeyIterator","getValueIterator","goog.structs.Map.prototype.getValueIterator","goog.structs.Map.prototype.__iterator__","goog.structs.Map.hasKey_","Set","goog.structs.Set","getKey_","goog.structs.Set.getKey_","goog.structs.Set.prototype.getCount","goog.structs.Set.prototype.add","goog.structs.Set.prototype.addAll","goog.structs.Set.prototype.removeAll","goog.structs.Set.prototype.remove","goog.structs.Set.prototype.clear","goog.structs.Set.prototype.isEmpty","goog.structs.Set.prototype.contains","containsAll","goog.structs.Set.prototype.containsAll","goog.structs.Set.prototype.intersection","goog.structs.Set.prototype.difference","goog.structs.Set.prototype.getValues","goog.structs.Set.prototype.clone","goog.structs.Set.prototype.equals","isSubsetOf","goog.structs.Set.prototype.isSubsetOf","colCount","goog.structs.Set.prototype.__iterator__","LOGGING_ENABLED","FORCE_SLOPPY_STACKS","catchErrors","goog.debug.catchErrors","logFunc","opt_cancel","oldErrorHandler","onerror","target.onerror","opt_col","opt_error","fileName","goog.debug.expose","opt_showFn","deepExpose","goog.debug.deepExpose","helper","space","parentSeen","nestspace","exposeArray","goog.debug.exposeArray","exposeException","goog.debug.exposeException","exposeExceptionAsHtml","goog.debug.exposeExceptionAsHtml","normalizeErrorObject","viewSourceUrl","createViewSourceUrl_","lineNumber","getStacktrace","e2","goog.debug.createViewSourceUrl_","opt_fileName","sanitizedFileName","goog.debug.normalizeErrorObject","threwError","filename","sourceURL","$googDebugFname","enhanceError","goog.debug.enhanceError","getStacktraceSimple","goog.debug.getStacktraceSimple","getNativeStackTrace_","getFunctionName","MAX_STACK_DEPTH","goog.debug.getNativeStackTrace_","tempErr","goog.debug.getStacktrace","getStacktraceHelper_","goog.debug.getStacktraceHelper_","argDesc","setFunctionResolver","goog.debug.setFunctionResolver","resolver","fnNameResolver_","goog.debug.getFunctionName","fnNameCache_","functionSource","makeWhitespaceVisible","goog.debug.makeWhitespaceVisible","runtimeType","goog.debug.runtimeType","LogRecord","goog.debug.LogRecord","level","loggerName","opt_time","opt_sequenceNumber","sequenceNumber_","exception_","ENABLE_SEQUENCE_NUMBERS","nextSequenceNumber_","goog.debug.LogRecord.prototype.reset","time_","level_","msg_","loggerName_","getLoggerName","goog.debug.LogRecord.prototype.getLoggerName","getException","goog.debug.LogRecord.prototype.getException","setException","goog.debug.LogRecord.prototype.setException","exception","setLoggerName","goog.debug.LogRecord.prototype.setLoggerName","getLevel","goog.debug.LogRecord.prototype.getLevel","setLevel","goog.debug.LogRecord.prototype.setLevel","getMessage","goog.debug.LogRecord.prototype.getMessage","setMessage","goog.debug.LogRecord.prototype.setMessage","getMillis","goog.debug.LogRecord.prototype.getMillis","setMillis","goog.debug.LogRecord.prototype.setMillis","time","getSequenceNumber","goog.debug.LogRecord.prototype.getSequenceNumber","LogBuffer","goog.debug.LogBuffer","isBufferingEnabled","goog.debug.LogBuffer.getInstance","CAPACITY","addRecord","goog.debug.LogBuffer.prototype.addRecord","curIndex_","isFull_","buffer_","goog.debug.LogBuffer.isBufferingEnabled","goog.debug.LogBuffer.prototype.clear","forEachRecord","goog.debug.LogBuffer.prototype.forEachRecord","func","Logger","goog.debug.Logger","name_","handlers_","ROOT_LOGGER_NAME","ENABLE_HIERARCHY","rootHandlers_","Level","goog.debug.Logger.Level","goog.debug.Logger.Level.prototype.toString","SHOUT","SEVERE","WARNING","INFO","CONFIG","FINE","FINER","FINEST","PREDEFINED_LEVELS","predefinedLevelsCache_","createPredefinedLevelsCache_","goog.debug.Logger.Level.createPredefinedLevelsCache_","getPredefinedLevel","goog.debug.Logger.Level.getPredefinedLevel","getPredefinedLevelByValue","goog.debug.Logger.Level.getPredefinedLevelByValue","getLogger","goog.debug.Logger.getLogger","LogManager","logToProfilers","goog.debug.Logger.logToProfilers","timeStamp","markTimeline","msWriteProfilerMark","getName","goog.debug.Logger.prototype.getName","addHandler","goog.debug.Logger.prototype.addHandler","removeHandler","goog.debug.Logger.prototype.removeHandler","handlers","goog.debug.Logger.prototype.getParent","goog.debug.Logger.prototype.getChildren","goog.debug.Logger.prototype.setLevel","rootLevel_","goog.debug.Logger.prototype.getLevel","getEffectiveLevel","goog.debug.Logger.prototype.getEffectiveLevel","isLoggable","goog.debug.Logger.prototype.isLoggable","goog.debug.Logger.prototype.log","opt_exception","doLogRecord_","getLogRecord","goog.debug.Logger.prototype.getLogRecord","logRecord","shout","goog.debug.Logger.prototype.shout","severe","goog.debug.Logger.prototype.severe","goog.debug.Logger.prototype.warning","goog.debug.Logger.prototype.info","goog.debug.Logger.prototype.config","fine","goog.debug.Logger.prototype.fine","finer","goog.debug.Logger.prototype.finer","finest","goog.debug.Logger.prototype.finest","goog.debug.Logger.prototype.logRecord","goog.debug.Logger.prototype.doLogRecord_","callPublish_","goog.debug.Logger.prototype.callPublish_","setParent_","goog.debug.Logger.prototype.setParent_","addChild_","goog.debug.Logger.prototype.addChild_","logger","loggers_","rootLogger_","goog.debug.LogManager.initialize","getLoggers","goog.debug.LogManager.getLoggers","getRoot","goog.debug.LogManager.getRoot","goog.debug.LogManager.getLogger","createLogger_","createFunctionForCatchErrors","goog.debug.LogManager.createFunctionForCatchErrors","opt_logger","goog.debug.LogManager.createLogger_","lastDotIndex","parentName","leafName","parentLogger","goog.log","ENABLED","goog.log.getLogger","opt_level","goog.log.addHandler","goog.log.removeHandler","goog.log.log","goog.log.error","goog.log.warning","goog.log.info","goog.log.fine","Thenable","goog.Thenable","then","goog.Thenable.prototype.then","opt_onFulfilled","opt_onRejected","opt_context","goog.Thenable.addImplementation","$goog_Thenable","goog.Thenable.isImplementedBy","FreeList","limit_","create_","reset_","occupants_","head_","put","occupants","WorkQueue","goog.async.WorkQueue","workTail_","workHead_","DEFAULT_MAX_UNUSED","freelist_","WorkItem","goog.async.WorkQueue.prototype.add","getUnusedItem_","goog.async.WorkQueue.prototype.remove","returnUnused","goog.async.WorkQueue.prototype.returnUnused","goog.async.WorkQueue.prototype.getUnusedItem_","goog.async.WorkItem","goog.async.WorkItem.prototype.set","goog.async.WorkItem.prototype.reset","throwException","goog.async.throwException","nextTick","goog.async.nextTick","opt_useSetImmediate","cb","wrapCallback_","setImmediate","useSetImmediate_","setImmediate_","getSetImmediateEmulator_","goog.async.nextTick.useSetImmediate_","Window","goog.async.nextTick.getSetImmediateEmulator_","Channel","MessageChannel","postMessage","origin","location","protocol","onmessage","port1","port2","channel","tail","onreadystatechange","script.onreadystatechange","goog.async.run","schedule_","initializeRunner_","workQueueScheduled_","workQueue_","goog.async.run.initializeRunner_","Promise","promise","resolve","goog.async.run.schedule_","processWorkQueue","forceNextTick","goog.async.run.forceNextTick","opt_realSetTimeout","resetQueue","goog.async.run.resetQueue","goog.async.run.processWorkQueue","goog.promise","Resolver","goog.promise.Resolver","goog.Promise","State_","PENDING","result_","callbackEntriesTail_","callbackEntries_","executing_","UNHANDLED_REJECTION_DELAY","unhandledRejectionId_","hadUnhandledRejection_","LONG_STACK_TRACES","stack_","addStackTrace_","currentStep_","resolve_","FULFILLED","reason","CancellationError","REJECTED","BLOCKED","CallbackEntry_","goog.Promise.CallbackEntry_","context","onRejected","onFulfilled","always","goog.Promise.CallbackEntry_.prototype.reset","getCallbackEntry_","goog.Promise.getCallbackEntry_","entry","returnEntry_","goog.Promise.returnEntry_","goog.Promise.resolve","reject","goog.Promise.reject","opt_reason","resolveThen_","goog.Promise.resolveThen_","maybeThen_","race","goog.Promise.race","promises","goog.Promise.all","toFulfill","onFulfill","onReject","allSettled","goog.Promise.allSettled","toSettle","results","onSettled","fulfilled","firstFulfilled","goog.Promise.firstFulfilled","toReject","reasons","withResolver","goog.Promise.withResolver","rs","rj","Resolver_","goog.Promise.prototype.then","addChildPromise_","thenVoid","goog.Promise.prototype.thenVoid","addCallbackEntry_","thenAlways","goog.Promise.prototype.thenAlways","thenCatch","goog.Promise.prototype.thenCatch","cancel","goog.Promise.prototype.cancel","cancelInternal_","goog.Promise.prototype.cancelInternal_","cancelChild_","goog.Promise.prototype.cancelChild_","childPromise","childCount","childEntry","beforeChildEntry","removeEntryAfter_","popEntry_","executeCallback_","goog.Promise.prototype.addCallbackEntry_","callbackEntry","hasEntry_","scheduleCallbacks_","queueEntry_","goog.Promise.prototype.addChildPromise_","unblockAndFulfill_","goog.Promise.prototype.unblockAndFulfill_","unblockAndReject_","goog.Promise.prototype.unblockAndReject_","goog.Promise.prototype.resolve_","addUnhandledRejection_","goog.Promise.maybeThen_","tryThen_","goog.Promise.tryThen_","thenable","goog.Promise.prototype.scheduleCallbacks_","executeCallbacks_","goog.Promise.prototype.hasEntry_","goog.Promise.prototype.queueEntry_","goog.Promise.prototype.popEntry_","goog.Promise.prototype.removeEntryAfter_","previous","goog.Promise.prototype.executeCallbacks_","goog.Promise.prototype.executeCallback_","removeUnhandledRejection_","invokeCallback_","handleRejection_","goog.Promise.invokeCallback_","goog.Promise.prototype.addStackTrace_","trace","appendLongStack_","goog.Promise.prototype.appendLongStack_","longTrace","goog.Promise.prototype.removeUnhandledRejection_","goog.Promise.addUnhandledRejection_","setUnhandledRejectionHandler","goog.Promise.setUnhandledRejectionHandler","goog.Promise.CancellationError","goog.Promise.CancellationError.base","goog.Promise.Resolver_","Timer","goog.Timer","opt_interval","opt_timerObject","interval_","timerObject_","defaultTimerObject","boundTick_","tick_","last_","MAX_TIMEOUT_","INVALID_TIMEOUT_ID_","intervalScale","timer_","getInterval","goog.Timer.prototype.getInterval","goog.Timer.prototype.setInterval","goog.Timer.prototype.tick_","elapsed","dispatchTick","goog.Timer.prototype.dispatchTick","TICK","goog.Timer.prototype.start","goog.Timer.prototype.stop","goog.Timer.prototype.disposeInternal","goog.Timer.callOnce","opt_delay","goog.Timer.clear","timerId","goog.Timer.promise","delay","timerKey","StringBuffer","goog.string.StringBuffer","opt_a1","goog.string.StringBuffer.prototype.set","goog.string.StringBuffer.prototype.append","a1","opt_a2","goog.string.StringBuffer.prototype.clear","getLength","goog.string.StringBuffer.prototype.getLength","goog.string.StringBuffer.prototype.toString","goog.ui.tree","tree","BaseNode","goog.ui.tree.BaseNode","opt_config","config_","defaultConfig","html_","expanded_","selected_","toolTip_","afterLabelHtml_","isUserCollapsible_","depth_","BEFORE_EXPAND","EXPAND","BEFORE_COLLAPSE","COLLAPSE","allNodes","goog.ui.tree.BaseNode.prototype.disposeInternal","initAccessibility","goog.ui.tree.BaseNode.prototype.initAccessibility","getLabelElement","getDepth","getIconElement","ei","getExpandIconElement","ce","getChildrenElement","hasChildNodes","goog.ui.tree.BaseNode.prototype.createDom","toSafeHtml","goog.ui.tree.BaseNode.prototype.enterDocument","goog.ui.tree.BaseNode.prototype.exitDocument","goog.ui.tree.BaseNode.prototype.addChildAt","prevNode","nextNode","previousSibling_","nextSibling_","firstChild_","lastChild_","getTree","setTreeInternal","setDepth_","updateExpandIcon","getExpanded","childElement","nextElement","setExpanded","goog.ui.tree.BaseNode.prototype.add","opt_before","goog.ui.tree.BaseNode.prototype.removeChild","childNode","selectedNode","hasFocus","onTimeoutSelect_","wasLast","isLastSibling","childEl","newLast","getLastChild","updateIcon_","goog.ui.tree.BaseNode.prototype.onTimeoutSelect_","goog.ui.tree.BaseNode.prototype.getDepth","computeDepth_","goog.ui.tree.BaseNode.prototype.computeDepth_","goog.ui.tree.BaseNode.prototype.setDepth_","getRowElement","getPixelIndent_","paddingRight","goog.ui.tree.BaseNode.prototype.contains","EMPTY_CHILDREN_","goog.ui.tree.BaseNode.prototype.getChildren","getFirstChild","goog.ui.tree.BaseNode.prototype.getFirstChild","goog.ui.tree.BaseNode.prototype.getLastChild","getPreviousSibling","goog.ui.tree.BaseNode.prototype.getPreviousSibling","getNextSibling","goog.ui.tree.BaseNode.prototype.getNextSibling","goog.ui.tree.BaseNode.prototype.isLastSibling","goog.ui.tree.BaseNode.prototype.isSelected","goog.ui.tree.BaseNode.prototype.select","deselect","setSelectedInternal","goog.ui.tree.BaseNode.prototype.setSelectedInternal","updateRow","treeElement","goog.ui.tree.BaseNode.prototype.getExpanded","setExpandedInternal","goog.ui.tree.BaseNode.prototype.setExpandedInternal","expanded","goog.ui.tree.BaseNode.prototype.setExpanded","isStateChange","goog.ui.tree.BaseNode.prototype.toggle","goog.ui.tree.BaseNode.prototype.expand","goog.ui.tree.BaseNode.prototype.collapse","collapseChildren","goog.ui.tree.BaseNode.prototype.collapseChildren","collapseAll","goog.ui.tree.BaseNode.prototype.collapseAll","expandChildren","goog.ui.tree.BaseNode.prototype.expandChildren","expandAll","goog.ui.tree.BaseNode.prototype.expandAll","reveal","goog.ui.tree.BaseNode.prototype.reveal","setIsUserCollapsible","goog.ui.tree.BaseNode.prototype.setIsUserCollapsible","isCollapsible","isUserCollapsible","goog.ui.tree.BaseNode.prototype.isUserCollapsible","goog.ui.tree.BaseNode.prototype.toSafeHtml","childClass","getShowLines","getShowRootLines","cssChildrenNoLines","cssChildren","nonEmptyAndExpanded","getLineStyle","cssItem","getRowSafeHtml","goog.ui.tree.BaseNode.prototype.getPixelIndent_","indentWidth","goog.ui.tree.BaseNode.prototype.getRowSafeHtml","getRowClassName","getExpandIconSafeHtml","getIconSafeHtml","getLabelSafeHtml","goog.ui.tree.BaseNode.prototype.getRowClassName","selectedClass","cssSelectedRow","cssTreeRow","goog.ui.tree.BaseNode.prototype.getLabelSafeHtml","cssItemLabel","getToolTip","getSafeHtml","getAfterLabelSafeHtml","getAfterLabelHtml","goog.ui.tree.BaseNode.prototype.getAfterLabelHtml","goog.ui.tree.BaseNode.prototype.getAfterLabelSafeHtml","setAfterLabelSafeHtml","goog.ui.tree.BaseNode.prototype.setAfterLabelSafeHtml","getAfterLabelElement","goog.ui.tree.BaseNode.prototype.getIconSafeHtml","getCalculatedIconClass","goog.ui.tree.BaseNode.prototype.getExpandIconSafeHtml","getExpandIconClass","goog.ui.tree.BaseNode.prototype.getExpandIconClass","hideLines","cssTreeIcon","cssExpandTreeIcon","bits","getShowExpandIcons","cssExpandTreeIconPlus","cssExpandTreeIconMinus","cssExpandTreeIconL","cssExpandTreeIconLPlus","cssExpandTreeIconLMinus","cssExpandTreeIconT","cssExpandTreeIconTPlus","cssExpandTreeIconTMinus","cssExpandTreeIconBlank","goog.ui.tree.BaseNode.prototype.getLineStyle","background-position","getBackgroundPosition","goog.ui.tree.BaseNode.prototype.getBackgroundPosition","goog.ui.tree.BaseNode.prototype.getElement","goog.ui.tree.BaseNode.prototype.getRowElement","goog.ui.tree.BaseNode.prototype.getExpandIconElement","goog.ui.tree.BaseNode.prototype.getIconElement","goog.ui.tree.BaseNode.prototype.getLabelElement","goog.ui.tree.BaseNode.prototype.getAfterLabelElement","goog.ui.tree.BaseNode.prototype.getChildrenElement","setIconClass","goog.ui.tree.BaseNode.prototype.setIconClass","iconClass_","getIconClass","goog.ui.tree.BaseNode.prototype.getIconClass","setExpandedIconClass","goog.ui.tree.BaseNode.prototype.setExpandedIconClass","expandedIconClass_","getExpandedIconClass","goog.ui.tree.BaseNode.prototype.getExpandedIconClass","goog.ui.tree.BaseNode.prototype.setText","setSafeHtml","goog.ui.tree.BaseNode.prototype.getText","goog.ui.tree.BaseNode.prototype.setSafeHtml","setNode","getHtml","goog.ui.tree.BaseNode.prototype.getHtml","goog.ui.tree.BaseNode.prototype.getSafeHtml","setToolTip","goog.ui.tree.BaseNode.prototype.setToolTip","goog.ui.tree.BaseNode.prototype.getToolTip","goog.ui.tree.BaseNode.prototype.updateRow","rowEl","goog.ui.tree.BaseNode.prototype.updateExpandIcon","cel","goog.ui.tree.BaseNode.prototype.updateIcon_","goog.ui.tree.BaseNode.prototype.onMouseDown","onDoubleClick_","goog.ui.tree.BaseNode.prototype.onDoubleClick_","onKeyDown","goog.ui.tree.BaseNode.prototype.onKeyDown","getShowRootNode","getNextShownNode","previousNode","getPreviousShownNode","clearTypeAhead","getLastShownDescendant","goog.ui.tree.BaseNode.prototype.getLastShownDescendant","goog.ui.tree.BaseNode.prototype.getNextShownNode","goog.ui.tree.BaseNode.prototype.getPreviousShownNode","ps","getClientData","setClientData","getConfig","goog.ui.tree.BaseNode.prototype.getConfig","goog.ui.tree.BaseNode.prototype.setTreeInternal","cssRoot","cssHideRoot","cssExpandedFolderIcon","cssCollapsedFolderIcon","cssFileIcon","cssExpandedRootIcon","cssCollapsedRootIcon","TreeNode","goog.ui.tree.TreeNode","goog.ui.tree.TreeNode.prototype.getTree","goog.ui.tree.TreeNode.prototype.getCalculatedIconClass","expandedIconClass","iconClass","Trie","goog.structs.Trie","opt_trie","childNodes_","setAll","goog.structs.Trie.prototype.set","setOrAdd_","goog.structs.Trie.prototype.add","goog.structs.Trie.prototype.setOrAdd_","opt_add","characterPosition","currentCharacter","goog.structs.Trie.prototype.setAll","trie","getChildNode_","goog.structs.Trie.prototype.getChildNode_","goog.structs.Trie.prototype.get","getKeyAndPrefixes","goog.structs.Trie.prototype.getKeyAndPrefixes","opt_keyStartIndex","goog.structs.Trie.prototype.getValues","allValues","getValuesInternal_","goog.structs.Trie.prototype.getValuesInternal_","goog.structs.Trie.prototype.getKeys","opt_prefix","allKeys","getKeysInternal_","goog.structs.Trie.prototype.getKeysInternal_","keySoFar","goog.structs.Trie.prototype.containsKey","containsPrefix","goog.structs.Trie.prototype.containsPrefix","goog.structs.Trie.prototype.containsValue","goog.structs.Trie.prototype.clear","goog.structs.Trie.prototype.remove","parents","oldValue","currentParent","currentParentAndCharacter","goog.structs.Trie.prototype.clone","goog.structs.Trie.prototype.getCount","goog.structs.Trie.prototype.isEmpty","TypeAhead","goog.ui.tree.TypeAhead","nodeMap_","matchingNodes_","matchingLabels_","matchingNodeIndex_","matchingLabelIndex_","Offset","handleNavigation","goog.ui.tree.TypeAhead.prototype.handleNavigation","jumpTo_","jumpToLabel_","handleTypeAheadChar","goog.ui.tree.TypeAhead.prototype.handleTypeAheadChar","setNodeInMap","goog.ui.tree.TypeAhead.prototype.setNodeInMap","labelText","previousValue","removeNodeFromMap","goog.ui.tree.TypeAhead.prototype.removeNodeFromMap","nodeList","goog.ui.tree.TypeAhead.prototype.jumpToLabel_","typeAhead","labels","nodes","selectMatchingNode_","goog.ui.tree.TypeAhead.prototype.jumpTo_","nodeIndexOutOfRange","newNodeIndex","newLabelIndex","goog.ui.tree.TypeAhead.prototype.selectMatchingNode_","goog.ui.tree.TypeAhead.prototype.clear","TreeControl","goog.ui.tree.TreeControl","typeAhead_","focusHandler_","logger_","focused_","focusedNode_","showRootLines_","showRootNode_","showExpandIcons_","showLines_","execCommand","goog.ui.tree.TreeControl.prototype.getTree","goog.ui.tree.TreeControl.prototype.getDepth","goog.ui.tree.TreeControl.prototype.reveal","handleFocus_","goog.ui.tree.TreeControl.prototype.handleFocus_","handleBlur_","goog.ui.tree.TreeControl.prototype.handleBlur_","goog.ui.tree.TreeControl.prototype.hasFocus","goog.ui.tree.TreeControl.prototype.getExpanded","goog.ui.tree.TreeControl.prototype.setExpanded","goog.ui.tree.TreeControl.prototype.getExpandIconSafeHtml","goog.ui.tree.TreeControl.prototype.getIconElement","goog.ui.tree.TreeControl.prototype.getExpandIconElement","goog.ui.tree.TreeControl.prototype.updateExpandIcon","goog.ui.tree.TreeControl.prototype.getRowClassName","goog.ui.tree.TreeControl.prototype.getCalculatedIconClass","goog.ui.tree.TreeControl.prototype.setSelectedItem","hadFocus","goog.ui.tree.TreeControl.prototype.getSelectedItem","setShowLines","goog.ui.tree.TreeControl.prototype.setShowLines","updateLinesAndExpandIcons_","goog.ui.tree.TreeControl.prototype.getShowLines","goog.ui.tree.TreeControl.prototype.updateLinesAndExpandIcons_","showLines","showRootLines","updateShowLines","childrenEl","expandIconEl","setShowRootLines","goog.ui.tree.TreeControl.prototype.setShowRootLines","goog.ui.tree.TreeControl.prototype.getShowRootLines","setShowExpandIcons","goog.ui.tree.TreeControl.prototype.setShowExpandIcons","goog.ui.tree.TreeControl.prototype.getShowExpandIcons","setShowRootNode","goog.ui.tree.TreeControl.prototype.setShowRootNode","goog.ui.tree.TreeControl.prototype.getShowRootNode","goog.ui.tree.TreeControl.prototype.initAccessibility","elt","goog.ui.tree.TreeControl.prototype.enterDocument","attachEvents_","goog.ui.tree.TreeControl.prototype.exitDocument","detachEvents_","goog.ui.tree.TreeControl.prototype.attachEvents_","kh","fh","handleMouseEvent_","goog.ui.tree.TreeControl.prototype.detachEvents_","goog.ui.tree.TreeControl.prototype.handleMouseEvent_","getNodeFromEvent_","goog.ui.tree.TreeControl.prototype.handleKeyEvent","goog.ui.tree.TreeControl.prototype.getNodeFromEvent_","createNode","goog.ui.tree.TreeControl.prototype.createNode","goog.ui.tree.TreeControl.prototype.setNode","goog.ui.tree.TreeControl.prototype.removeNode","goog.ui.tree.TreeControl.prototype.clearTypeAhead","Toolbox","Blockly.Toolbox","CONFIG_","Blockly.Toolbox.prototype.createDom","HtmlDiv","Blockly.Toolbox.prototype.init","cleardotPath","populate_","Blockly.Toolbox.prototype.position_","treeDiv","svgBox","toolboxWidth","trashcanWidth","updateToolbox","Blockly.Toolbox.prototype.updateToolbox","addColour_","Blockly.Toolbox.prototype.populate_","rootOut","syncTrees","treeIn","treeOut","childIn","catMsg","catname","childOut","categoryName","custom","hasColours_","hasColours","clearSelection","Blockly.Toolbox.prototype.clearSelection","Blockly.Toolbox.prototype.getRect","Blockly.Toolbox.TreeControl","toolbox_","Blockly.Toolbox.TreeControl.prototype.enterDocument","handleTouchEvent_","Blockly.Toolbox.TreeControl.prototype.handleTouchEvent_","touchRateLimited","stopImmediatePropagation","Blockly.Toolbox.TreeControl.prototype.createNode","Blockly.Toolbox.TreeControl.prototype.setSelectedItem","Blockly.Toolbox.TreeNode","Blockly.Toolbox.TreeNode.prototype.getExpandIconSafeHtml","Blockly.Toolbox.TreeNode.prototype.getExpandIconElement","Blockly.Toolbox.TreeNode.prototype.onMouseDown","Blockly.Toolbox.TreeNode.prototype.onDoubleClick_","Blockly.Toolbox.prototype.addColour_","opt_tree","opt_sub","Blockly.Variables","NAME_TYPE_LOCAL","allVariables","Blockly.Variables.allVariables","opt_blocks","opt_category","variableHash","getVars","blockVariables","allVariablesFromBlock","varName","PREFIX_","variableList","Blockly.Variables.allVariablesFromBlock","varsByCategory","vars","category","Blockly.Variables.getVars","renameVariable","Blockly.Variables.renameVariable","oldName","newName","renameVar","FunctionEditor","allFunctionEditors","renameParameter","refreshParamsEverywhere","deleteVariable","Blockly.Variables.deleteVariable","nameToRemove","removeVar","removeParameter","Blockly.Variables.flyoutCategory","defaultVariable","getBlock","getGetter","setBlock","getSetter","getters","Default","Blockly.Variables.getGetter","getterName","registerGetter","Blockly.Variables.registerGetter","blockName","setters","Blockly.Variables.getSetter","setterName","registerSetter","Blockly.Variables.registerSetter","generateUniqueName","Blockly.Variables.generateUniqueName","baseName","generateUniqueNameFromBase_","inUse","nameSuffix","potName","Blockly.Variables.generateUniqueNameFromBase_","FieldVariable","Blockly.FieldVariable","varname","opt_createHandler","FieldParameter","dropdownChange","newVal","dropdownCreate","Blockly.FieldVariable.prototype.getValue","Blockly.FieldVariable.prototype.setValue","Blockly.FieldVariable.dropdownCreate","RENAME_VARIABLE","NEW_VARIABLE","Blockly.FieldVariable.prototype.dropdownChange","oldVar","modalPromptName","RENAME_VARIABLE_TITLE","CONFIRM_RENAME_VARIABLE","newVar","NEW_VARIABLE_TITLE","CONFIRM_CREATE_VARIABLE","Blockly.FieldVariable.modalPromptName","promptText","confirmButtonLabel","defaultText","showSimpleDialog","bodyText","promptPrefill","cancelText","confirmText","CANCEL","onConfirm","onCancel","removeExtraWhitespace","Blockly.FieldVariable.removeExtraWhitespace","inputString","multipleWhitespaceCharactersRegex","leadingTrailingWhitespaceRegex","Blockly.FieldParameter","Blockly.FieldParameter.dropdownCreate","RENAME_PARAMETER","DELETE_PARAMETER","Blockly.FieldParameter.dropdownChange","RENAME_PARAMETER_TITLE","DELETE_PARAMETER_TITLE","KEEP","cancelButtonClass","Blockly.BlockSpaceEditor","readOnly_","noScrolling_","movementLocked_","init_","BUMP_ENTIRE_BLOCK","ENTIRE_BUMP_PADDING_TOP","ENTIRE_BUMP_PADDING_LEFT","ENTIRE_BUMP_PADDING_BOTTOM","ENTIRE_BUMP_PADDING_RIGHT","BUMP_PADDING_TOP","BUMP_PADDING_LEFT","BUMP_PADDING_BOTTOM","BUMP_PADDING_RIGHT","BUMP_DEBUG","SCROLL_DRAG_DEBUG","populateSVGEffects_","Blockly.BlockSpaceEditor.prototype.populateSVGEffects_","defs","stdDeviation","feSpecularLighting","surfaceScale","specularConstant","specularExponent","lighting-color","in2","operator","k1","k2","k3","k4","feMerge","patternUnits","kernelMatrix","Blockly.BlockSpaceEditor.prototype.createDom_","defs_","hasCategories","addToolboxOrFlyout_","addChangeListener","bumpBlocksIfNotDragging","setEnableToolbox","this.setEnableToolbox","addToSvgDefs","Blockly.BlockSpaceEditor.prototype.addToSvgDefs","definitionToAdd","Blockly.BlockSpaceEditor.prototype.addToolboxOrFlyout_","addFlyout_","Blockly.BlockSpaceEditor.prototype.addFlyout_","flyoutSvg","Blockly.BlockSpaceEditor.prototype.getDeleteAreas","deleteAreas","Blockly.BlockSpaceEditor.prototype.bumpBlocksIfNotDragging","Blockly.BlockSpaceEditor.prototype.bumpBlocksIntoBlockSpace","blockSpaceInnerTop","blockSpaceInnerLeft","blockSpaceInnerBottom","blockSpaceInnerRight","blockSpaceInnerWidth","blockSpaceInnerHeight","paddedBlockSpaceBox","originalBlockBox","overflow","howFarOutsideLeft","howFarOutsideRight","howFarAboveTop","howFarBelowBottom","moveX","moveY","shouldBump","afterBumpBlockBox","Blockly.BlockSpaceEditor.prototype.init_","detectBrokenControlPoints","documentEventsBound_","onKeyDown_","onCutCopy_","onPaste_","hasVerticalScrollbars","hasHorizontalScrollbars","Blockly.BlockSpaceEditor.prototype.updateFlyout","getAllFlyoutBlocks","Blockly.BlockSpaceEditor.prototype.getAllFlyoutBlocks","Blockly.BlockSpaceEditor.prototype.detectBrokenControlPoints","Blockly.BlockSpaceEditor.prototype.svgSize","cachedWidth_","cachedHeight_","Blockly.BlockSpaceEditor.prototype.svgResize","svgStyle","svgBorderWidth","borderLeftWidth","borderRightWidth","containerDiv","getWorkspaceTopOffset","svgWidth","svgHeight","setBlockSpaceMetricsNoScroll_","Blockly.BlockSpaceEditor.prototype.getWorkspaceTopOffset","containerStyle","containerTopBorder","borderTopWidth","appendSVGChild","Blockly.BlockSpaceEditor.prototype.appendSVGChild","svgElementToAdd","getSVGElement","Blockly.BlockSpaceEditor.prototype.getSVGElement","getBlockSpaceWidth","Blockly.BlockSpaceEditor.prototype.getBlockSpaceWidth","getToolboxWidth","Blockly.BlockSpaceEditor.prototype.getToolboxWidth","Blockly.BlockSpaceEditor.prototype.setCursor","cursorType","Blockly.BlockSpaceEditor.prototype.onKeyDown_","copy_","Blockly.BlockSpaceEditor.prototype.onCutCopy_","clipboardData","setData","clipboard_","Blockly.BlockSpaceEditor.prototype.onPaste_","getData","focusedBlockSpace","Blockly.BlockSpaceEditor.terminateDrag_","Blockly.BlockSpaceEditor.copy_","Blockly.BlockSpaceEditor.showContextMenu_","hasCollapsedBlocks","hasExpandedBlocks","topBlocks","collapseOption","COLLAPSE_ALL","collapseOption.callback","expandOption","EXPAND_ALL","expandOption.callback","helpOption","helpOption.callback","Blockly.BlockSpaceEditor.prototype.hideChaff","opt_allowToolbox","Blockly.BlockSpaceEditor.prototype.getBlockSpaceMetrics_","mainCanvasBBox","blockBoundingRect","Blockly.BlockSpaceEditor.prototype.getCanvasBBox","Blockly.BlockSpaceEditor.prototype.setBlockSpaceMetrics_","Blockly.BlockSpaceEditor.prototype.setBlockSpaceMetricsNoScroll_","Blockly.BlockSpaceEditor.prototype.addChangeListener","addUnusedBlocksHelpListener","Blockly.BlockSpaceEditor.prototype.addUnusedBlocksHelpListener","Blockly.BlockSpaceEditor.prototype.isReadOnly","lockMovement","Blockly.BlockSpaceEditor.prototype.lockMovement","unlockMovement","Blockly.BlockSpaceEditor.prototype.unlockMovement","Blockly.BlockSpaceEditor.prototype.isMovementLocked","Blockly.BlockSpaceEditor.prototype.shouldHavePadding","removeChangeListener","Blockly.removeChangeListener","bindData","HorizontalFlyout","Blockly.HorizontalFlyout","customYOffset","flyoutRows","Blockly.HorizontalFlyout.prototype.show","Blockly.HorizontalFlyout.prototype.hide","setVisibility","Blockly.HorizontalFlyout.prototype.setVisibility","softShow","softHide","Blockly.HorizontalFlyout.prototype.softHide","Blockly.HorizontalFlyout.prototype.softShow","Blockly.HorizontalFlyout.prototype.position_","edgeHeight","scrollbar_","pointerEvents","getYPosition","Blockly.HorizontalFlyout.prototype.getYPosition","Blockly.HorizontalFlyout.prototype.layoutBlock_","Blockly.HorizontalFlyout.prototype.reflow","LinkedMap","goog.structs.LinkedMap","opt_maxCount","opt_cache","opt_evictionCallback","maxCount_","cache_","evictionCallback_","Node_","findAndMoveToTop_","goog.structs.LinkedMap.prototype.findAndMoveToTop_","insert_","goog.structs.LinkedMap.prototype.get","peekValue","goog.structs.LinkedMap.prototype.peekValue","goog.structs.LinkedMap.prototype.set","goog.structs.LinkedMap.prototype.peek","peekLast","goog.structs.LinkedMap.prototype.peekLast","goog.structs.LinkedMap.prototype.shift","popNode_","goog.structs.LinkedMap.prototype.pop","goog.structs.LinkedMap.prototype.remove","goog.structs.LinkedMap.prototype.removeNode","goog.structs.LinkedMap.prototype.getCount","goog.structs.LinkedMap.prototype.isEmpty","setEvictionCallback","goog.structs.LinkedMap.prototype.setEvictionCallback","evictionCallback","setMaxCount","goog.structs.LinkedMap.prototype.setMaxCount","maxCount","truncate_","goog.structs.LinkedMap.prototype.getKeys","goog.structs.LinkedMap.prototype.getValues","goog.structs.LinkedMap.prototype.contains","goog.structs.LinkedMap.prototype.containsKey","goog.structs.LinkedMap.prototype.clear","goog.structs.LinkedMap.prototype.forEach","goog.structs.LinkedMap.prototype.map","goog.structs.LinkedMap.prototype.some","goog.structs.LinkedMap.prototype.every","goog.structs.LinkedMap.prototype.insert_","goog.structs.LinkedMap.prototype.truncate_","toRemove","goog.structs.LinkedMap.prototype.popNode_","goog.structs.LinkedMap.Node_","goog.structs.LinkedMap.Node_.prototype.remove","Blockly.FunctionEditor","opt_msgOverrides","opt_definitionBlockType","opt_parameterBlockTypes","opt_disableParamEditing","opt_paramTypes","created_","orderedParamIDsToBlocks_","modalBackground_","frameInner_","contractDiv_","deleteButton_","closeButton_","container_","functionDefinitionBlock","msgOverrides_","definitionBlockType","parameterBlockTypes","disableParamEditing","paramTypes","BLOCK_LAYOUT_LEFT_MARGIN","BLOCK_LAYOUT_TOP_MARGIN","DELETE_BUTTON_MARGIN","CLOSE_BUTTON_OVERHANG","RTL_CLOSE_BUTTON_OFFSET","BUTTON_TOP_OFFSET","Blockly.FunctionEditor.prototype.getMsg","paramEditingDisabled","Blockly.FunctionEditor.prototype.paramEditingDisabled","defaultParameterBlockType","autoOpenFunction","Blockly.FunctionEditor.prototype.autoOpenFunction","autoOpenWithLevelConfiguration","Blockly.FunctionEditor.prototype.autoOpenWithLevelConfiguration","configuration","openAndEditFunction","openEditorForCallBlock_","Blockly.FunctionEditor.prototype.openEditorForCallBlock_","procedureBlock","openEditorForFunction","Blockly.FunctionEditor.prototype.openEditorForFunction","hideIfOpen","Blockly.FunctionEditor.prototype.openAndEditFunction","targetFunctionDefinitionBlock","setupUIForBlock_","moveToModalBlockSpace","populateParamToolbox_","setupUIAfterBlockInEditor_","description_","Blockly.FunctionEditor.prototype.setupUIForBlock_","Blockly.FunctionEditor.prototype.setupUIAfterBlockInEditor_","Blockly.FunctionEditor.prototype.populateParamToolbox_","addParamsFromProcedure_","resetParamIDs_","Blockly.FunctionEditor.prototype.addParamsFromProcedure_","parameterNames","parameterTypes","addParameter","getParamNameType","Blockly.FunctionEditor.prototype.getParamNameType","parameterID","blockXML","paramNameTypeFromXML_","Blockly.FunctionEditor.prototype.paramNameTypeFromXML_","infoObject","Blockly.FunctionEditor.prototype.openWithNewFunction","ensureCreated_","tempFunctionDefinitionBlock","bindToolboxHandlers_","Blockly.FunctionEditor.prototype.bindToolboxHandlers_","paramAddTextElement","paramAddTypeSelect","paramAddButton","addParamFromInputField_","Blockly.FunctionEditor.prototype.addParamFromInputField_","parameterTextElement","newParamName","Blockly.FunctionEditor.prototype.addParameter","newParameterName","newParameterType","newParameterBlock","getParameterBlockType","Blockly.FunctionEditor.prototype.getParameterBlockType","Blockly.FunctionEditor.prototype.newParameterBlock","parameterBlockType","Blockly.FunctionEditor.prototype.renameParameter","paramID","linkedMap","forEachParameterGetBlock","changeParameterTypeInFlyoutXML","Blockly.FunctionEditor.prototype.changeParameterTypeInFlyoutXML","Blockly.FunctionEditor.prototype.removeParameter","keysToDelete","Blockly.FunctionEditor.prototype.refreshParamsEverywhere","refreshParamsInFlyout_","refreshParamsOnFunction_","Blockly.FunctionEditor.prototype.refreshParamsInFlyout_","Blockly.FunctionEditor.prototype.resetParamIDs_","paramArrays","paramsAsParallelArrays_","paramIDs","updateParamsFromArrays","paramNames","Blockly.FunctionEditor.prototype.refreshParamsOnFunction_","Blockly.FunctionEditor.prototype.paramsAsParallelArrays_","Blockly.FunctionEditor.prototype.forEachParameterGetBlock","paramName","Blockly.FunctionEditor.prototype.show","Blockly.FunctionEditor.prototype.isOpen","isCreated","Blockly.FunctionEditor.prototype.isCreated","Blockly.FunctionEditor.prototype.ensureCreated_","onClose","Blockly.FunctionEditor.prototype.onClose","Blockly.FunctionEditor.prototype.hideIfOpen","hideAndRestoreBlocks_","Blockly.FunctionEditor.prototype.hideAndRestoreBlocks_","moveToMainBlockSpace_","Blockly.FunctionEditor.prototype.moveToMainBlockSpace_","blockToMove","Blockly.FunctionEditor.prototype.moveToModalBlockSpace","newCopyOfBlock","Blockly.FunctionEditor.prototype.create_","functionNameChange","disallowedCharacters","functionDescriptionChange","modalBlockSpaceEditor","getBlockSpaceEditorToScreenTop_","getWindowBorderChromeHeight","resizeUIComponents_","layOutBlockSpaceItems_","clipPath","clipPathID","clipPathURL","clipPathRect_","addCloseButton_","addDeleteButton_","addEditorFrame_","createContractDom_","createParameterEditor_","setupParametersToolbox_","Blockly.FunctionEditor.prototype.resizeUIComponents_","resizeFrame_","positionClippingRects_","positionSizeContractDom_","positionCloseButton_","positionDeleteButton_","Blockly.FunctionEditor.prototype.resizeFrame_","Blockly.FunctionEditor.prototype.positionClippingRects_","frameClipDiv_","Blockly.FunctionEditor.prototype.positionSizeContractDom_","getContractDomTopY_","positionFlyout_","Blockly.FunctionEditor.prototype.positionCloseButton_","Blockly.FunctionEditor.prototype.positionDeleteButton_","closeButtonWidth","deleteButtonWidth","getButtonWidth","ltrXOffset","rtlXOffset","renderAt","Blockly.FunctionEditor.prototype.getBlockSpaceEditorToScreenTop_","Blockly.FunctionEditor.prototype.getWindowBorderChromeHeight","getContractDivHeight","Blockly.FunctionEditor.prototype.getContractDivHeight","readyToBeLaidOut_","Blockly.FunctionEditor.prototype.readyToBeLaidOut_","Blockly.FunctionEditor.prototype.positionFlyout_","Blockly.FunctionEditor.prototype.layOutBlockSpaceItems_","Blockly.FunctionEditor.prototype.addCloseButton_","Blockly.FunctionEditor.prototype.addDeleteButton_","SvgTextButton","onDeletePressed","Blockly.FunctionEditor.prototype.onDeletePressed","deleteMessage","onDeleteConfirmed","Blockly.FunctionEditor.prototype.onDeleteConfirmed","functionDefinition","Blockly.FunctionEditor.prototype.setupParametersToolbox_","flyoutDom","Blockly.FunctionEditor.prototype.addEditorFrame_","Blockly.FunctionEditor.prototype.position_","Blockly.FunctionEditor.prototype.getContractDomTopY_","Blockly.FunctionEditor.prototype.createParameterEditor_","paramTypeSelect","createFrameClipDiv_","Blockly.FunctionEditor.prototype.createFrameClipDiv_","frameClipDiv","Blockly.FunctionEditor.prototype.createContractDom_","STRING","NUMBER","IMAGE","BOOLEAN","COLOUR","ARRAY","SPRITE","BEHAVIOR","LOCATION","Blockly.FunctionalBlockUtils","typesToColors","FunctionalBlockUtils","initTitledFunctionalBlock","Blockly.FunctionalBlockUtils.initTitledFunctionalBlock","config_opt","titleFontSize","verticallyStackInputs","installStringPicker","Blockly.FunctionalBlockUtils.installStringPicker","blockly","generator","JavaScript","quote_","goog.dom.classes","goog.dom.classes.set","goog.dom.classes.get","goog.dom.classes.add","expectedCount","add_","goog.dom.classes.remove","newClasses","getDifference_","goog.dom.classes.add_","goog.dom.classes.getDifference_","goog.dom.classes.swap","goog.dom.classes.addRemove","has","goog.dom.classes.has","goog.dom.classes.enable","goog.dom.classes.toggle","NO_RESULT_TEXT","SUCCESS_TEXT","RESULT_TEXT_TOP_MARGIN","EMPTY_EXAMPLE_INPUT_WIDTH","ExampleView","Blockly.ExampleView","domParent_","svgParent_","contractEditor_","horizontalLine","GRID_LINE_COLOR","svgIgnoreMouseEvents","grayBackdrop","belowExisting","testExampleButton","initializeTestButton_","testExample_","resetExampleButton","resultText","refreshTestingUI","Blockly.ExampleView.prototype.initializeTestButton_","newButton","testText","runImage","Blockly.ExampleView.prototype.getBlock","Blockly.ExampleView.prototype.testExample_","resetExampleViews","failure","testExample","setResult","Blockly.ExampleView.prototype.reset","resetExample","Blockly.ExampleView.prototype.setResult","Blockly.ExampleView.prototype.refreshTestingUI","showExampleTestButtons","placeExampleAndGetNewY","Blockly.ExampleView.prototype.placeExampleAndGetNewY","exampleMaxInputWidth","marginBelow","fullWidth","midLineX","exampleDivTop","originalExtraSpace","functionCallBlock","commonMargin","exampleButtonX","buttonWidth","buttonHeight","Blockly.ExampleView.prototype.dispose","DOWN_TRIANGLE_CHARACTER","RIGHT_TRIANGLE_CHARACTER","DARK_GRAY_HEX","YELLOW_HEX","HIGHLIGHT_BOX_WIDTH","DEFAULT_HEADER_HEIGHT","ContractEditorSectionView","Blockly.ContractEditorSectionView","headerText_","headerText","onCollapseCallback_","onCollapseCallback","placeContentCallback","sectionNumber_","sectionNumber","highlightBox_","highlightBox","completelyHidden_","highlighted_","header_","SvgHeader","textForCurrentState_","toggleCollapse","showHeader_","setHeaderColor","Blockly.ContractEditorSectionView.prototype.setHeaderColor","colorHex","setColor","Blockly.ContractEditorSectionView.prototype.textForCurrentState_","displayText","setHidden","Blockly.ContractEditorSectionView.prototype.setHidden","shouldBeHidden","refreshHeaderText_","removeSectionNumber","Blockly.ContractEditorSectionView.prototype.removeSectionNumber","Blockly.ContractEditorSectionView.prototype.toggleCollapse","Blockly.ContractEditorSectionView.prototype.setCollapsed","showSeparator","Blockly.ContractEditorSectionView.prototype.isCollapsed","Blockly.ContractEditorSectionView.prototype.refreshHeaderText_","Blockly.ContractEditorSectionView.prototype.setHighlighted","setHeaderVisible","Blockly.ContractEditorSectionView.prototype.setHeaderVisible","showHeader","placeAndGetNewY","Blockly.ContractEditorSectionView.prototype.placeAndGetNewY","startY","setPositionSize","placeAndGetNewYInnerSegment_","Blockly.ContractEditorSectionView.prototype.placeAndGetNewYInnerSegment_","FUNCTION_BLOCK_VERTICAL_MARGIN","FUNCTION_BLOCK_MIN_HORIZONTAL_MARGIN","ContractDefinitionSection","Blockly.ContractDefinitionSection","canvasToDrawOn","definitionTableGroup","grayDefinitionBackground","verticalDefinitionMidline","horizontalDefinitionTopLine","horizontalDefinitionBottomLine","handleCollapse","Blockly.ContractDefinitionSection.prototype.handleCollapse","isNowCollapsed","placeContent","Blockly.ContractDefinitionSection.prototype.placeContent","verticalMidlineX","verticalMidlineY","isVariable","xOffset","TEXT_PADDING_LEFT","SEPARATOR_LINE_HEIGHT","Blockly.SvgHeader","extraStyle","rectangleElement_","separatorElement_","Blockly.SvgHeader.prototype.showSeparator","shouldShow","Blockly.SvgHeader.prototype.setColor","Blockly.SvgHeader.prototype.setPositionSize","yOffset","rectangleMiddleY","thirdTextHeight","Blockly.SvgHeader.prototype.setText","Blockly.SvgHeader.prototype.setVisible","removeSelf","Blockly.SvgHeader.prototype.removeSelf","Blockly.SvgTextButton","buttonRect","purpleFillColor","buttonRectHeight","buttonRectYOffset","Blockly.SvgTextButton.prototype.renderAt","Blockly.SvgTextButton.prototype.setVisible","Blockly.SvgTextButton.prototype.getButtonWidth","SvgHighlightBox","Blockly.SvgHighlightBox","highlightRectangle_","Blockly.SvgHighlightBox.prototype.setPositionSize","TypeDropdown","Blockly.TypeDropdown","buttonColorSquareDiv_","selectComponent_","onTypeChanged_","onTypeChanged","typeChoices_","typeChoices","type_","changeListenerKey_","Blockly.TypeDropdown.prototype.render","selectComponent","renderSelectComponent_","createColorSquareDiv","setSquareIconColor","attachListeners_","setType_","Blockly.TypeDropdown.prototype.setType_","Blockly.TypeDropdown.prototype.renderSelectComponent_","createSelect_","Blockly.TypeDropdown.prototype.createSelect_","newTypeDropdown","Select","FlatMenuButtonRenderer","CustomCssClassMenuRenderer","choiceKey","colorIconDiv","Blockly.TypeDropdown.prototype.createColorSquareDiv","Blockly.TypeDropdown.prototype.attachListeners_","selectChanged_","Blockly.TypeDropdown.prototype.selectChanged_","comboBoxEvent","Blockly.TypeDropdown.prototype.setSquareIconColor","hsvColor","Blockly.TypeDropdown.prototype.dispose","DomainNameInput","Blockly.DomainNameInput","onNameChanged","onEnterPressed","eventsToUnbind_","inputElement_","Blockly.DomainNameInput.prototype.render","inputElement","placeholder","FUNCTIONAL_NAME_LABEL","onInputChange_","Blockly.DomainNameInput.prototype.onInputChange_","Blockly.DomainNameInput.prototype.dispose","eventHandle","XButton","Blockly.XButton","onButtonPressed","Blockly.XButton.prototype.render","buttonElement","marginRight","Blockly.XButton.prototype.dispose","DomainEditor","Blockly.DomainEditor","nameInput_","typeDropdown_","editorDom_","getParamID","Blockly.DomainEditor.prototype.getParamID","Blockly.DomainEditor.prototype.render","editorDOM","typeDropdown","nameInput","xButton","onRemovePress","Blockly.DomainEditor.prototype.dispose","Blockly.CustomCssClassMenuRenderer","customCssClass","customCssClass_","Blockly.CustomCssClassMenuRenderer.prototype.getCssClass","ButtonSide","START","ButtonRenderer","goog.ui.ButtonRenderer","goog.ui.ButtonRenderer.prototype.getAriaRole","goog.ui.ButtonRenderer.prototype.updateAriaState","goog.ui.ButtonRenderer.prototype.updateAriaState.base","goog.ui.ButtonRenderer.prototype.createDom","goog.ui.ButtonRenderer.prototype.createDom.base","getTooltip","goog.ui.ButtonRenderer.prototype.decorate","setValueInternal","setTooltipInternal","goog.ui.ButtonRenderer.prototype.getTooltip","goog.ui.ButtonRenderer.prototype.setTooltip","goog.ui.ButtonRenderer.prototype.setCollapsed","sides","isRtl","collapseLeftClassName","collapseRightClassName","goog.ui.ButtonRenderer.prototype.getCssClass","InputType","COLOR","DATE","DATETIME","DATETIME_LOCAL","EMAIL","FILE","MONTH","PASSWORD","RANGE","SELECT_MULTIPLE","SELECT_ONE","TEL","WEEK","NativeButtonRenderer","goog.ui.NativeButtonRenderer","goog.ui.NativeButtonRenderer.prototype.getAriaRole","goog.ui.NativeButtonRenderer.prototype.createDom","setUpNativeButton_","goog.ui.NativeButtonRenderer.prototype.canDecorate","goog.ui.NativeButtonRenderer.prototype.decorate","disabledClassName","goog.ui.NativeButtonRenderer.prototype.initializeDom","goog.ui.NativeButtonRenderer.prototype.isFocusable","goog.ui.NativeButtonRenderer.prototype.setState","goog.ui.NativeButtonRenderer.prototype.getValue","goog.ui.NativeButtonRenderer.prototype.setValue","goog.ui.NativeButtonRenderer.prototype.setUpNativeButton_","Button","goog.ui.Button","Side","goog.ui.Button.prototype.getValue","goog.ui.Button.prototype.setValue","goog.ui.Button.prototype.setValueInternal","goog.ui.Button.prototype.getTooltip","tooltip_","goog.ui.Button.prototype.setTooltip","goog.ui.Button.prototype.setTooltipInternal","goog.ui.Button.prototype.setCollapsed","goog.ui.Button.prototype.disposeInternal","goog.ui.Button.prototype.enterDocument","goog.ui.Button.prototype.handleKeyEventInternal","INLINE_BLOCK_CLASSNAME","FlatButtonRenderer","goog.ui.FlatButtonRenderer","goog.ui.FlatButtonRenderer.prototype.createDom","goog.ui.FlatButtonRenderer.prototype.getAriaRole","goog.ui.FlatButtonRenderer.prototype.canDecorate","goog.ui.FlatButtonRenderer.prototype.decorate","goog.ui.FlatButtonRenderer.prototype.getValue","goog.ui.FlatButtonRenderer.prototype.getCssClass","goog.style.bidi","getScrollLeft","goog.style.bidi.getScrollLeft","getOffsetStart","goog.style.bidi.getOffsetStart","offsetLeftForReal","bestParent","borderWidths","setScrollOffset","goog.style.bidi.setScrollOffset","offsetStart","goog.style.bidi.setPosition","goog.positioning","positioning","CornerBit","BOTTOM","FLIP_RTL","Corner","TOP_LEFT","TOP_RIGHT","BOTTOM_LEFT","BOTTOM_RIGHT","TOP_START","TOP_END","BOTTOM_START","BOTTOM_END","TOP_CENTER","BOTTOM_CENTER","Overflow","IGNORE","ADJUST_X","FAIL_X","ADJUST_Y","FAIL_Y","RESIZE_WIDTH","RESIZE_HEIGHT","ADJUST_X_EXCEPT_OFFSCREEN","ADJUST_Y_EXCEPT_OFFSCREEN","OverflowStatus","ADJUSTED_X","ADJUSTED_Y","WIDTH_ADJUSTED","HEIGHT_ADJUSTED","FAILED_LEFT","FAILED_RIGHT","FAILED_TOP","FAILED_BOTTOM","FAILED_OUTSIDE_VIEWPORT","FAILED","FAILED_HORIZONTAL","FAILED_VERTICAL","positionAtAnchor","goog.positioning.positionAtAnchor","anchorElement","anchorElementCorner","movableElement","movableElementCorner","opt_offset","opt_margin","opt_overflow","opt_preferredSize","opt_viewport","movableParentTopLeft","getOffsetParentPageOffset","anchorRect","getVisiblePart_","corner","getEffectiveCorner","absolutePos","viewport","positionAtCoordinate","goog.positioning.getOffsetParentPageOffset","isBody","goog.positioning.getVisiblePart_","visibleBox","goog.positioning.positionAtCoordinate","positionResult","getPositionAtCoordinate","goog.positioning.getPositionAtCoordinate","elementCorner","adjustForViewport_","goog.positioning.adjustForViewport_","originalX","originalY","goog.positioning.getEffectiveCorner","flipCornerHorizontal","goog.positioning.flipCornerHorizontal","flipCornerVertical","goog.positioning.flipCornerVertical","flipCorner","goog.positioning.flipCorner","AbstractPosition","goog.positioning.AbstractPosition","reposition","goog.positioning.AbstractPosition.prototype.reposition","AnchoredPosition","goog.positioning.AnchoredPosition","overflow_","goog.positioning.AnchoredPosition.prototype.reposition","movableCorner","AnchoredViewportPosition","goog.positioning.AnchoredViewportPosition","opt_adjust","opt_overflowConstraint","lastResortOverflow_","overflowConstraint_","getOverflowConstraint","goog.positioning.AnchoredViewportPosition.prototype.getOverflowConstraint","setOverflowConstraint","goog.positioning.AnchoredViewportPosition.prototype.setOverflowConstraint","overflowConstraint","getLastResortOverflow","goog.positioning.AnchoredViewportPosition.prototype.getLastResortOverflow","setLastResortOverflow","goog.positioning.AnchoredViewportPosition.prototype.setLastResortOverflow","lastResortOverflow","goog.positioning.AnchoredViewportPosition.prototype.reposition","cornerFallback","adjustCorner","movableCornerFallback","goog.positioning.AnchoredViewportPosition.prototype.adjustCorner","MenuAnchoredPosition","goog.positioning.MenuAnchoredPosition","opt_resize","CustomButtonRenderer","goog.ui.CustomButtonRenderer","goog.ui.CustomButtonRenderer.prototype.createDom","createButton","goog.ui.CustomButtonRenderer.prototype.getAriaRole","goog.ui.CustomButtonRenderer.prototype.getContentElement","goog.ui.CustomButtonRenderer.prototype.createButton","goog.ui.CustomButtonRenderer.prototype.canDecorate","hasBoxStructure","goog.ui.CustomButtonRenderer.prototype.hasBoxStructure","outer","outerClassName","innerClassName","goog.ui.CustomButtonRenderer.prototype.decorate","trimTextNodes_","goog.ui.CustomButtonRenderer.prototype.getCssClass","goog.ui.CustomButtonRenderer.trimTextNodes_","fromStart","MenuButtonRenderer","goog.ui.MenuButtonRenderer","goog.ui.MenuButtonRenderer.prototype.getContentElement","goog.ui.MenuButtonRenderer.prototype.decorate","menuElem","setMenu","goog.ui.MenuButtonRenderer.prototype.createButton","createCaption","createDropdown","goog.ui.MenuButtonRenderer.prototype.createCaption","wrapCaption","goog.ui.MenuButtonRenderer.wrapCaption","goog.ui.MenuButtonRenderer.prototype.createDropdown","goog.ui.MenuButtonRenderer.prototype.getCssClass","goog.userAgent.product","ASSUME_FIREFOX","ASSUME_CHROME","ASSUME_SAFARI","PRODUCT_KNOWN_","FIREFOX","isIphoneOrIpod_","goog.userAgent.product.isIphoneOrIpod_","CHROME","isSafariDesktop_","goog.userAgent.product.isSafariDesktop_","MenuButton","goog.ui.MenuButton","opt_menu","opt_menuRenderer","menuPosition_","menuMargin_","setFocusablePopupMenu","menuRenderer_","isFocusablePopupMenu_","renderMenuAsSibling_","selectFirstOnEnterOrSpace_","goog.ui.MenuButton.prototype.enterDocument","attachKeyDownEventListener_","attachMenuEventListeners_","goog.ui.MenuButton.prototype.exitDocument","menuElement","goog.ui.MenuButton.prototype.disposeInternal","positionElement_","goog.ui.MenuButton.prototype.handleMouseDown","goog.ui.MenuButton.prototype.handleMouseUp","goog.ui.MenuButton.prototype.performActionInternal","handleDocumentMouseDown","goog.ui.MenuButton.prototype.handleDocumentMouseDown","goog.ui.MenuButton.prototype.containsElement","goog.ui.MenuButton.prototype.handleKeyEventInternal","isEnterOrSpace","handledByMenu","handleMenuAction","goog.ui.MenuButton.prototype.handleMenuAction","handleMenuBlur","goog.ui.MenuButton.prototype.handleMenuBlur","goog.ui.MenuButton.prototype.handleBlur","isFocusablePopupMenu","getMenu","goog.ui.MenuButton.prototype.getMenu","goog.ui.MenuButton.prototype.setMenu","oldMenu","setMenuPosition","goog.ui.MenuButton.prototype.setMenuPosition","setPositionElement","goog.ui.MenuButton.prototype.setPositionElement","positionElement","positionMenu","setMenuMargin","goog.ui.MenuButton.prototype.setMenuMargin","setSelectFirstOnEnterOrSpace","goog.ui.MenuButton.prototype.setSelectFirstOnEnterOrSpace","goog.ui.MenuButton.prototype.addItem","goog.ui.MenuButton.prototype.addItemAt","goog.ui.MenuButton.prototype.removeItem","goog.ui.MenuButton.prototype.removeItemAt","goog.ui.MenuButton.prototype.getItemAt","goog.ui.MenuButton.prototype.getItemCount","goog.ui.MenuButton.prototype.setVisible","goog.ui.MenuButton.prototype.setEnabled","isAlignMenuToStart","goog.ui.MenuButton.prototype.isAlignMenuToStart","setAlignMenuToStart","goog.ui.MenuButton.prototype.setAlignMenuToStart","alignToStart","setScrollOnOverflow","goog.ui.MenuButton.prototype.setScrollOnOverflow","scrollOnOverflow","isScrollOnOverflow","goog.ui.MenuButton.prototype.isScrollOnOverflow","goog.ui.MenuButton.prototype.isFocusablePopupMenu","goog.ui.MenuButton.prototype.setFocusablePopupMenu","setRenderMenuAsSibling","goog.ui.MenuButton.prototype.setRenderMenuAsSibling","renderMenuAsSibling","showMenu","goog.ui.MenuButton.prototype.showMenu","hideMenu","goog.ui.MenuButton.prototype.hideMenu","goog.ui.MenuButton.prototype.setOpen","viewportBox_","buttonRect_","originalSize_","attachPopupListeners_","invalidateMenuSize","goog.ui.MenuButton.prototype.invalidateMenuSize","goog.ui.MenuButton.prototype.positionMenu","popupCorner","onTick_","goog.ui.MenuButton.prototype.onTick_","currentButtonRect","currentViewport","goog.ui.MenuButton.prototype.attachMenuEventListeners_","method","goog.ui.MenuButton.prototype.attachKeyDownEventListener_","handleKeyDownEvent_","goog.ui.MenuButton.prototype.handleHighlightItem","setAriaActiveDescendant_","goog.ui.MenuButton.prototype.handleKeyDownEvent_","goog.ui.MenuButton.prototype.handleUnHighlightItem","goog.ui.MenuButton.prototype.handleCloseItem","menuItemEl","goog.ui.MenuButton.prototype.setAriaActiveDescendant_","activeDescendant","idGenerator","goog.ui.MenuButton.prototype.attachPopupListeners_","goog.ui.FlatMenuButtonRenderer","goog.ui.FlatMenuButtonRenderer.prototype.createDom","goog.ui.FlatMenuButtonRenderer.prototype.getContentElement","goog.ui.FlatMenuButtonRenderer.prototype.decorate","goog.ui.FlatMenuButtonRenderer.prototype.createCaption","goog.ui.FlatMenuButtonRenderer.prototype.createDropdown","aria-hidden","goog.ui.FlatMenuButtonRenderer.prototype.getCssClass","Option","goog.ui.Option","goog.ui.Option.prototype.performActionInternal","goog.ui.Select","opt_caption","goog.ui.Select.base","defaultCaption_","initialAriaLabel_","goog.ui.Select.prototype.enterDocument","updateCaption","listenToSelectionModelEvents_","goog.ui.Select.prototype.decorateInternal","setDefaultCaption","goog.ui.Select.prototype.disposeInternal","goog.ui.Select.prototype.handleMenuAction","goog.ui.Select.prototype.handleMenuAction.base","goog.ui.Select.prototype.handleSelectionChange","goog.ui.Select.prototype.setMenu","setCorrectAriaRole_","createSelectionModel_","getDefaultCaption","goog.ui.Select.prototype.getDefaultCaption","goog.ui.Select.prototype.setDefaultCaption","goog.ui.Select.prototype.addItem","updateAriaActiveDescendant_","goog.ui.Select.prototype.addItemAt","goog.ui.Select.prototype.removeItem","goog.ui.Select.prototype.removeItemAt","goog.ui.Select.prototype.setSelectedItem","prevItem","goog.ui.Select.prototype.setSelectedIndex","goog.ui.Select.prototype.setValue","goog.ui.Select.prototype.getValue","goog.ui.Select.prototype.getSelectedItem","goog.ui.Select.prototype.getSelectedIndex","getSelectionModel","goog.ui.Select.prototype.getSelectionModel","goog.ui.Select.prototype.createSelectionModel_","opt_component","goog.ui.Select.prototype.listenToSelectionModelEvents_","goog.ui.Select.prototype.updateCaption","itemElement","goog.ui.Select.prototype.updateAriaActiveDescendant_","getNumMenuItems_","goog.ui.Select.prototype.getNumMenuItems_","goog.ui.Select.prototype.setCorrectAriaRole_","goog.ui.Select.prototype.setOpen","goog.ui.decorate","EXAMPLE_BLOCK_MARGIN_BELOW","EXAMPLE_BLOCK_MARGIN_LEFT","EXAMPLE_BLOCK_SECTION_MAGIN_BELOW","EXAMPLE_BLOCK_SECTION_MAGIN_ABOVE","HEADER_HEIGHT","DEFAULT_EXAMPLE_CALL_SECTION_WIDTH","MARGIN_BLOCK_TO_CALL_SLOT","USER_TYPE_CHOICES","CONTRACT_SECTION_NAME","EXAMPLES_SECTION_NAME","DEFINITION_SECTION_NAME","HIGHLIGHT_CONFIG_SUFFIX","COLLAPSE_CONFIG_SUFFIX","DISABLE_EXAMPLES_CONFIG_NAME","Blockly.ContractEditor","disableExamples_","outputTypeSelector","exampleBlocks","domainEditors_","definitionSectionView_","examplesSectionView_","contractSectionView_","allSections_","autoOpenConfig_","testHandler_","this.testHandler_","testResetHandler_","this.testResetHandler_","customFailureCloseHandler_","this.customFailureCloseHandler_","exampleViews_","DEFAULT_OUTPUT_TYPE","DEFAULT_PARAMETER_TYPE","Blockly.ContractEditor.prototype.create_","sharedHighlightBox","hiddenExampleBlocks_","exampleAreaDiv","addExampleButton","addNewExampleBlock_","callText","examplesTableGroup","topHorizontalLine","verticalExampleMidline","onPlaceExampleContent","setBlockSubsetVisibility","isBlockInExampleArea","hiddenDefinitionBlocks_","definitionSectionLogic_","isBlockInFunctionArea","getVerticalMidlineOffset_","getFullWidth","Blockly.ContractEditor.prototype.autoOpenWithLevelConfiguration","Blockly.ContractEditor.prototype.setBlockSubsetVisibility","blockFilter","hiddenBlockArray","nowHidden","Blockly.ContractEditor.prototype.isBlockInFunctionArea","isVisibleInEditor_","Blockly.ContractEditor.prototype.isBlockInExampleArea","isAnExampleBlockInEditor_","getFlyoutTopPosition","Blockly.ContractEditor.prototype.isVisibleInEditor_","Blockly.ContractEditor.prototype.getFlyoutTopPosition","Blockly.ContractEditor.prototype.isAnExampleBlockInEditor_","Blockly.ContractEditor.prototype.hideAndRestoreBlocks_","exampleBlock","editor","Blockly.ContractEditor.prototype.openAndEditFunction","addRangeEditor_","updateFrameColorForType_","getOutputType","moveExampleBlocksToModal_","setupAfterExampleBlocksAdded_","setSectionHighlighted","Blockly.ContractEditor.prototype.setSectionHighlighted","viewToHighlight","Blockly.ContractEditor.prototype.addNewExampleBlock_","addNewExampleBlockForFunction_","refreshBlockInputTypes_","Blockly.ContractEditor.prototype.addNewExampleBlockForFunction_","createdExampleBlock","createExampleBlock_","addExampleBlockFromMainBlockSpace","Blockly.ContractEditor.prototype.moveExampleBlocksToModal_","registerTestHandler","Blockly.ContractEditor.prototype.registerTestHandler","testHandler","registerTestResetHandler","Blockly.ContractEditor.prototype.registerTestResetHandler","testResetHandler","registerTestsFailedOnCloseHandler","Blockly.ContractEditor.prototype.registerTestsFailedOnCloseHandler","Blockly.ContractEditor.prototype.addExampleBlockFromMainBlockSpace","movedExampleBlock","removeExampleBlock_","Blockly.ContractEditor.prototype.refreshBlockInputTypes_","setBlockInputsToType_","currentFunctionDefinitionType_","Blockly.ContractEditor.prototype.setBlockInputsToType_","updateInputsToType","Blockly.ContractEditor.prototype.currentFunctionDefinitionType_","outputType_","Blockly.ContractEditor.prototype.removeExampleBlock_","Blockly.ContractEditor.prototype.openWithNewVariable","Blockly.ContractEditor.prototype.openWithNewFunction","updateOutputType","convertToVariable","defaultNumExampleBlocks","Blockly.ContractEditor.prototype.createExampleBlock_","temporaryExampleBlock","createCallerFromDefinition","Blockly.ContractEditor.prototype.getFullWidth","Blockly.ContractEditor.prototype.layOutBlockSpaceItems_","Blockly.ContractEditor.prototype.createContractDom_","FUNCTIONAL_DOMAIN_LABEL","FUNCTIONAL_RANGE_LABEL","FUNCTIONAL_DESCRIPTION_LABEL","initializeAddButton_","Blockly.ContractEditor.prototype.createParameterEditor_","Blockly.ContractEditor.prototype.bindToolboxHandlers_","chromeBottomToContractDivDistance_","Blockly.ContractEditor.prototype.chromeBottomToContractDivDistance_","isShowingHeaders_","Blockly.ContractEditor.prototype.getContractDomTopY_","Blockly.ContractEditor.prototype.setupUIForBlock_","isEditingVariable","FUNCTIONAL_VARIABLE_HEADER","CONTRACT_EDITOR_HEADER","FUNCTIONAL_VARIABLE_TYPE","Blockly.ContractEditor.prototype.setupAfterExampleBlocksAdded_","setupSectionsForVariable_","setupSectionsForContract_","Blockly.ContractEditor.prototype.setupSectionsForVariable_","Blockly.ContractEditor.prototype.setupSectionsForContract_","autoOpenConfig","sectionView","sectionName","Blockly.ContractEditor.prototype.isShowingHeaders_","Blockly.ContractEditor.prototype.isEditingVariable","Blockly.ContractEditor.prototype.addParameter","opt_newParameterType","newParameterID","addDomainEditorForParamID_","Blockly.ContractEditor.prototype.addDomainEditorForParamID_","paramInfo","domainEditor","removeContractParameter_","changeParameterType_","changeParameterName_","Blockly.ContractEditor.prototype.removeContractParameter_","Blockly.ContractEditor.prototype.newParameterBlock","newParamBlockDOM","Blockly.ContractEditor.prototype.addParamsFromProcedure_","Blockly.ContractEditor.prototype.addRangeEditor_","outputTypeChanged_","getOutputTypeDropdownElement_","Blockly.ContractEditor.prototype.outputTypeChanged_","Blockly.ContractEditor.prototype.updateFrameColorForType_","newColorHSV","newColorHex","setFrameColor_","Blockly.ContractEditor.prototype.setFrameColor_","Blockly.ContractEditor.prototype.getOutputTypeDropdownElement_","Blockly.ContractEditor.prototype.initializeAddButton_","Blockly.ContractEditor.prototype.changeParameterType_","changeParamType","Blockly.ContractEditor.prototype.changeParameterName_","Blockly.ContractEditor.prototype.getVerticalMidlineOffset_","getMaxExampleCallBlockWidth_","Blockly.ContractEditor.prototype.getMaxExampleCallBlockWidth_","previousMax","Blockly.ContractEditor.prototype.resetExampleViews","exampleView","Blockly.ContractEditor.prototype.testExample","visualize","testHandlerResult","DEFINE_FUNCTION_FOR_EXAMPLE","Blockly.ContractEditor.prototype.resetExample","updateExampleResult","Blockly.ContractEditor.prototype.updateExampleResult","Blockly.ContractEditor.prototype.onPlaceExampleContent","blockSplitMargin","verticalMidlineOffset","exampleSectionVisible","newExampleView","Blockly.ContractEditor.prototype.onClose","allPass","Generator","languages","Blockly.Generator.get","CodeGenerator","blocksToCode","Blockly.Generator.blocksToCode","opt_showHidden","blockToCode","scrubNakedValue","finish","xmlToCode","Blockly.Generator.xmlToCode","xmlToBlocks","Blockly.Generator.xmlToBlocks","blockSpaceToCode","Blockly.Generator.blockSpaceToCode","opt_typeFilter","blocksToGenerate","prefixLines","Blockly.Generator.prefixLines","Blockly.CodeGenerator","RESERVED_WORDS_","Blockly.CodeGenerator.prototype.blockToCode","scrub_","valueToCode","Blockly.CodeGenerator.prototype.valueToCode","innerOrder","statementToCode","Blockly.CodeGenerator.prototype.statementToCode","addReservedWords","Blockly.CodeGenerator.prototype.addReservedWords","words","Blockly.Names","reservedWords","reservedDict_","splitWords","Blockly.Names.prototype.reset","db_","dbSpecificType_","dbReverse_","Blockly.Names.prototype.getName","specificType","normalized","safeName","getDistinctName","checkSpecificType","Blockly.Names.prototype.checkSpecificType","Blockly.Names.prototype.getDistinctName","safeName_","Blockly.Names.prototype.safeName_","Blockly.Names.equals","name1","name2","Blockly.Procedures","PROCEDURAL_TO_FUNCTIONAL_CALL_TYPE","allProcedures","Blockly.Procedures.allProcedures","proceduresReturn","proceduresNoReturn","proceduresFunctional","proceduresOther","proceduralCallProcedureInfo","callType","procedureInfoSort_","Blockly.Procedures.procedureInfoSort_","ta","tb","findLegalName","Blockly.Procedures.findLegalName","isLegalName","matchResult","Blockly.Procedures.isLegalName","opt_exclude","Blockly.Procedures.rename","renameProcedure","Blockly.Procedures.flyoutCategory","opt_procedureInfoFilter","procedures_defnoreturn","procedures_defreturn","procedures_ifreturn","procedureDefinitionInfo","newCallBlock","createCallerBlock","newPassBlock","createFunctionPassingBlock","Blockly.Procedures.createCallerFromDefinition","definitionBlock","Blockly.Procedures.createCallerBlock","tempIds","setProcedureParameters","Blockly.Procedures.createFunctionPassingBlock","getCallers","Blockly.Procedures.getCallers","getCallName","disposeCallers","Blockly.Procedures.disposeCallers","mutateCallers","Blockly.Procedures.mutateCallers","paramIds","opt_typeNames","getDefinition","Blockly.Procedures.getDefinition","goog.cssom","cssom","CssRuleType","IMPORT","MEDIA","FONT_FACE","PAGE","NAMESPACE","getAllCssText","goog.cssom.getAllCssText","opt_styleSheet","getAllCss_","styleSheets","getAllCssStyleRules","goog.cssom.getAllCssStyleRules","getCssRulesFromStyleSheet","goog.cssom.getCssRulesFromStyleSheet","cssRuleList","cssRules","rules","getAllCssStyleSheets","goog.cssom.getAllCssStyleSheets","opt_includeDisabled","styleSheetsOutput","includeDisabled","imports","cssRule","getCssTextFromCssRule","goog.cssom.getCssTextFromCssRule","selectorText","styleCssText","getCssRuleIndexInParentStyleSheet","goog.cssom.getCssRuleIndexInParentStyleSheet","opt_parentStyleSheet","parentStyleSheet","getParentStyleSheet","goog.cssom.getParentStyleSheet","replaceCssRule","goog.cssom.replaceCssRule","opt_index","removeCssRule","addCssRule","goog.cssom.addCssRule","cssStyleSheet","insertRule","addRule","goog.cssom.removeCssRule","deleteRule","removeRule","addCssText","goog.cssom.addCssText","domHelper","cssNode","cssTextNode","getFileNameFromStyleSheet","goog.cssom.getFileNameFromStyleSheet","goog.cssom.getAllCss_","isTextOutput","cssOut","ruleIndex","Blockly.Css","currentCursor_","styleSheet_","inject","Blockly.Css.inject","sheet","Blockly.Css.setCursor","opt_svg","Blockly.WidgetDiv","owner_","Blockly.WidgetDiv.show","newOwner","Blockly.WidgetDiv.isVisible","Blockly.WidgetDiv.hide","Blockly.WidgetDiv.hideIfOwner","oldOwner","Blockly.WidgetDiv.isOwner","owner","Blockly.WidgetDiv.position","Blockly.inject","opt_audioPlayer","parseOptions_","audioPlayer","registerUISounds_","useModalFunctionEditor","useContractEditor","disableExamples","Blockly.parseOptions_","hasCollapse","XSLTProcessor","scrollbars","rtl","customSimpleDialog","varsInGlobals","disableIfElseEditing","disableVariableEditing","Blockly.registerUISounds_","mp3","wav","ogg","memoize","goog.memoize","opt_serializer","serializer","simpleSerializer","ENABLE_MEMOIZE","thisOrGlobal","CACHE_PROPERTY_","clearCache","goog.memoize.clearCache","cacheOwner","goog.memoize.simpleSerializer","functionUid","Blockly.utils","Blockly.addClass_","stringContainsClass_","Blockly.elementHasClass_","Blockly.stringContainsClass_","Blockly.removeClass_","Blockly.bindEvent_","useCapture","wrapFunc","equivTouchEvent","TOUCH_MAP","pointerEnabled","msPointerEnabled","targetStyle","touchAction","msTouchAction","touchPoints","mousedown","mousemove","mouseup","Blockly.unbindEvent_","bindDatum","Blockly.fireUiEvent","initEvent","createEventObject","fireEvent","noEvent","Blockly.noEvent","Blockly.getRelativeXY","Blockly.getSvgXY_","opt_svgParent","topMostSVG","topMostSVGParent","Blockly.getAbsoluteXY_","Blockly.topMostSVGParent","Blockly.createSvgElement","attrs","SVG_NS","Blockly.isRightButton","Blockly.convertCoordinates","toSvg","svgPoint","createSVGPoint","matrix","getScreenCTM","createSVGMatrix","inverse","matrixTransform","Blockly.mouseToSvg","Blockly.mouseCoordinatesToSvg","Blockly.svgCoordinatesToViewport","coordinates","blockSpaceMetrics","Blockly.viewportCoordinateToBlockSpace","Blockly.shortestStringLength","Blockly.commonWordPrefix","opt_shortest","wordPrefix","letter","Blockly.commonWordSuffix","Blockly.isNumber","Blockly.isMsie","Blockly.isTrident","Blockly.isIOS","Blockly.ieVersion","Blockly.mixColoursWithForegroundOpacity","foregroundColor","foregroundOpacity","foregroundRGB","backgroundRGB","Blockly.printerRangeToNumbers","rangeString","rangeItems","fullNumberList","rangeRegexp","numberRegexp","numberOrRange","rangeResult","numberResult","rangeArray","getUID","Blockly.getUID","Blockly.isTargetInput","Blockly.blockContextMenu","Blockly.getNormalizedWheelDeltaY","wheelDeltaY","deltaY","Blockly.getBoxOverflow","outerBox","innerBox","Blockly.getPointBoxOverflow","innerPoint","Blockly.isBoxWiderThan","boxA","boxB","Blockly.isBoxTallerThan","Blockly.getBoxWidth","Blockly.getBoxHeight","Blockly.numberWithin","number","inclusive","Blockly.svgRectToRect","svgRect","Blockly.showSimpleDialog","dialogOptions","BOX_DIRECTIONS","Blockly.addToNonZeroSides","amount","Blockly.svgIgnoreMouseEvents","fireTestClickSequence","Blockly.fireTestClickSequence","fireTestMouseEvent","Blockly.fireTestMouseEvent","makeTestMouseEvent","Blockly.makeTestMouseEvent","findEmptyContainerBlock","Blockly.findEmptyContainerBlock","findEmptyInput","Blockly.findEmptyInput","inputType","Blockly.aggregateCounts","list","Blockly.Blocks.colour","colour_picker","COLOUR_PICKER_HELPURL","COLOUR_PICKER_TOOLTIP","colour_random","COLOUR_RANDOM_HELPURL","COLOUR_RANDOM_TITLE","COLOUR_RANDOM_TOOLTIP","colour_rgb","COLOUR_RGB_HELPURL","COLOUR_RGB_TITLE","COLOUR_RGB_RED","COLOUR_RGB_GREEN","COLOUR_RGB_BLUE","COLOUR_RGB_TOOLTIP","colour_blend","COLOUR_BLEND_HELPURL","COLOUR_BLEND_TITLE","COLOUR_BLEND_COLOUR1","COLOUR_BLEND_COLOUR2","COLOUR_BLEND_RATIO","COLOUR_BLEND_TOOLTIP","Blockly.Blocks.functionalExamples","functional_example","EXAMPLE_DESCRIPTION","xmlElement","outputType","updateInputType_","Blockly.Blocks.variables","variables_get","fieldLabel","VARIABLES_GET_ITEM","VARIABLES_GET_HELPURL","VARIABLES_GET_TITLE","VARIABLES_GET_TAIL","VARIABLES_GET_TOOLTIP","contextMenuType_","VARIABLES_GET_CREATE_SET","xmlTitle","variables_set","VARIABLES_SET_ITEM","VARIABLES_SET_HELPURL","assetUrlRoot","VARIABLES_SET_TITLE","VARIABLES_SET_TAIL","VARIABLES_SET_TOOLTIP","contextMenuMsg_","VARIABLES_SET_CREATE_GET","parameters_get","Blockly.Blocks.functionalParameters","functional_parameters_get","desc","Blockly.Blocks.procedures","createProcedureDefinitionBlock","Blockly.Block.createProcedureDefinitionBlock","overrides","showParamEditIcon","PROCEDURES_DEFNORETURN_HELPURL","PROCEDURES_DEFNORETURN_PROCEDURE","PROCEDURES_DEFNORETURN_DO","PROCEDURES_DEFNORETURN_TOOLTIP","parameterNames_","parameterTypes_","initPostScript","updateParams_","badArg","hash","PROCEDURES_DEF_DUPLICATE_WARNING","paramString","PROCEDURES_BEFORE_PARAMS","parameter","containerBlock","paramBlock","oldLocation","currentParamBlock","paramIds_","updateCallerParams_","opt_keepCallers","parameterIDs","callType_","change","PROCEDURES_CREATE_DO","xmlMutation","xmlArg","PROCEDURES_DEFRETURN_HELPURL","PROCEDURES_DEFRETURN_PROCEDURE","PROCEDURES_DEFRETURN_TITLE","PROCEDURES_DEFRETURN_DO","PROCEDURES_DEFRETURN_RETURN","PROCEDURES_DEFRETURN_TOOLTIP","procedures_mutatorcontainer","PROCEDURES_MUTATORCONTAINER_TITLE","procedures_mutatorarg","PROCEDURES_MUTATORARG_TITLE","validator","PROCEDURES_MUTATORARG_TYPE","typeOptions","Blockly.Blocks.procedures_mutatorarg.validator","procedures_callnoreturn","PROCEDURES_CALLNORETURN_HELPURL","mainTitle","PROCEDURES_CALLNORETURN_CALL","editLabel","FUNCTION_EDIT","openEditor","PROCEDURES_CALLNORETURN_TOOLTIP","currentParameterNames_","currentParameterIDs","parameterIDsToArgumentConnections","PROCEDURES_CALLRETURN_TOOLTIP","currentParameterTypes_","PROCEDURES_HIGHLIGHT_DEF","option.callback","procedures_callreturn","PROCEDURES_CALLRETURN_HELPURL","PROCEDURES_CALLRETURN_CALL","CONTROLS_IF_MSG_IF","PROCEDURES_IFRETURN_TOOLTIP","hasReturnValue_","legal","PROCEDURES_IFRETURN_WARNING","Blockly.Blocks.functionalProcedures","functional_definition","DEFINE_FUNCTION_DEFINE","FUNCTIONAL_PROCEDURE_DEFINE_TOOLTIP","isFunctionalVariable_","outputTypeMutation","functionalVariableMutation","changed","functional_call","parameterIDsToArgumentConnections_","currentParameterIDs_","currentDescription_","currentOutputType_","updateAttributesFromDefinition_","procedureDefinition","getParamTypes","currentParameterType","refreshParameterTitleString_","parameterListString","functional_pass","setColorFromName_","functionBlock","procedural_to_functional_call","Blockly.Blocks.lists","lists_create_empty","LISTS_CREATE_EMPTY_HELPURL","LISTS_CREATE_EMPTY_TITLE","LISTS_CREATE_EMPTY_TOOLTIP","lists_create_with","LISTS_CREATE_WITH_INPUT_WITH","LISTS_CREATE_WITH_TOOLTIP","itemCount_","itemBlock","valueConnection_","lists_create_with_container","LISTS_CREATE_WITH_CONTAINER_TITLE_ADD","LISTS_CREATE_WITH_CONTAINER_TOOLTIP","lists_create_with_item","LISTS_CREATE_WITH_ITEM_TITLE","LISTS_CREATE_WITH_ITEM_TOOLTIP","lists_repeat","LISTS_REPEAT_HELPURL","LISTS_REPEAT_TITLE","LISTS_REPEAT_TOOLTIP","lists_length","LISTS_LENGTH_HELPURL","LISTS_LENGTH_INPUT_LENGTH","LISTS_LENGTH_TOOLTIP","lists_isEmpty","LISTS_IS_EMPTY_HELPURL","LISTS_IS_EMPTY_TITLE","LISTS_TOOLTIP","lists_indexOf","OPERATORS","LISTS_INDEX_OF_FIRST","LISTS_INDEX_OF_LAST","LISTS_INDEX_OF_HELPURL","LISTS_INDEX_OF_INPUT_IN_LIST","LISTS_INDEX_OF_TOOLTIP","lists_getIndex","MODE","LISTS_GET_INDEX_GET","LISTS_GET_INDEX_GET_REMOVE","LISTS_GET_INDEX_REMOVE","WHERE_OPTIONS","LISTS_GET_INDEX_FROM_START","LISTS_GET_INDEX_FROM_END","LISTS_GET_INDEX_FIRST","LISTS_GET_INDEX_LAST","LISTS_GET_INDEX_RANDOM","LISTS_GET_INDEX_HELPURL","modeMenu","updateStatement","LISTS_GET_INDEX_INPUT_IN_LIST","LISTS_GET_INDEX_TAIL","updateAt","thisBlock","isAt","isStatement","newStatement","ORDINAL_NUMBER_SUFFIX","newAt","lists_setIndex","LISTS_SET_INDEX_SET","LISTS_SET_INDEX_INSERT","LISTS_SET_INDEX_HELPURL","LISTS_SET_INDEX_INPUT_IN_LIST","LISTS_SET_INDEX_INPUT_TO","LISTS_SET_INDEX_TOOLTIP","lists_getSublist","WHERE_OPTIONS_1","WHERE_OPTIONS_2","LISTS_GET_SUBLIST_HELPURL","LISTS_GET_SUBLIST_INPUT_IN_LIST","LISTS_GET_SUBLIST_TAIL","LISTS_GET_SUBLIST_TOOLTIP","isAt1","isAt2","Blockly.Blocks.logic","controls_if","CONTROLS_IF_HELPURL","CONTROLS_IF_MSG_THEN","elseifCount_","elseCount_","CONTROLS_IF_TOOLTIP_2","CONTROLS_IF_TOOLTIP_3","CONTROLS_IF_TOOLTIP_4","CONTROLS_IF_TOOLTIP_1","CONTROLS_IF_MSG_ELSEIF","CONTROLS_IF_MSG_ELSE","elseifBlock","elseBlock","clauseBlock","ifInput","doInput","statementConnection_","elseInput","inputIf","inputDo","controls_if_if","CONTROLS_IF_IF_TITLE_IF","CONTROLS_IF_IF_TOOLTIP","controls_if_elseif","CONTROLS_IF_ELSEIF_TITLE_ELSEIF","CONTROLS_IF_ELSEIF_TOOLTIP","controls_if_else","CONTROLS_IF_ELSE_TITLE_ELSE","CONTROLS_IF_ELSE_TOOLTIP","logic_compare","LOGIC_COMPARE_HELPURL","op","EQ","LOGIC_COMPARE_TOOLTIP_EQ","NEQ","LOGIC_COMPARE_TOOLTIP_NEQ","LT","LOGIC_COMPARE_TOOLTIP_LT","LTE","LOGIC_COMPARE_TOOLTIP_LTE","GT","LOGIC_COMPARE_TOOLTIP_GT","GTE","LOGIC_COMPARE_TOOLTIP_GTE","logic_operation","LOGIC_OPERATION_AND","LOGIC_OPERATION_OR","LOGIC_OPERATION_HELPURL","TOOLTIPS","logic_negate","LOGIC_NEGATE_HELPURL","LOGIC_NEGATE_TITLE","LOGIC_NEGATE_TOOLTIP","logic_boolean","BOOLEANS","LOGIC_BOOLEAN_TRUE","LOGIC_BOOLEAN_FALSE","LOGIC_BOOLEAN_HELPURL","LOGIC_BOOLEAN_TOOLTIP","logic_null","LOGIC_NULL_HELPURL","LOGIC_NULL","LOGIC_NULL_TOOLTIP","logic_ternary","LOGIC_TERNARY_HELPURL","LOGIC_TERNARY_CONDITION","LOGIC_TERNARY_IF_TRUE","LOGIC_TERNARY_IF_FALSE","LOGIC_TERNARY_TOOLTIP","Blockly.Blocks.loops","controls_repeat","CONTROLS_REPEAT_HELPURL","CONTROLS_REPEAT_TITLE_REPEAT","CONTROLS_REPEAT_TITLE_TIMES","CONTROLS_REPEAT_INPUT_DO","CONTROLS_REPEAT_TOOLTIP","controls_repeat_ext","CONTROLS_REPEAT_TITLE","controls_whileUntil","CONTROLS_WHILEUNTIL_OPERATOR_WHILE","CONTROLS_WHILEUNTIL_OPERATOR_UNTIL","CONTROLS_WHILEUNTIL_HELPURL","CONTROLS_WHILEUNTIL_INPUT_DO","WHILE","CONTROLS_WHILEUNTIL_TOOLTIP_WHILE","UNTIL","CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL","controls_for","CONTROLS_FOR_HELPURL","CONTROLS_FOR_INPUT_WITH","CONTROLS_FOR_INPUT_FROM_TO_BY","CONTROLS_FOR_INPUT_DO","CONTROLS_FOR_TOOLTIP","controls_forEach","CONTROLS_FOREACH_HELPURL","CONTROLS_FOREACH_INPUT_ITEM","CONTROLS_FOREACH_INPUT_INLIST","CONTROLS_FOREACH_INPUT_INLIST_TAIL","CONTROLS_FOREACH_INPUT_DO","CONTROLS_FOREACH_TOOLTIP","controls_flow_statements","CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK","CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE","CONTROLS_FLOW_STATEMENTS_HELPURL","CONTROLS_FLOW_STATEMENTS_WARNING","Blockly.Blocks.math","math_number","MATH_NUMBER_HELPURL","MATH_NUMBER_TOOLTIP","math_arithmetic","MATH_ADDITION_SYMBOL","MATH_SUBTRACTION_SYMBOL","MATH_MULTIPLICATION_SYMBOL","MATH_DIVISION_SYMBOL","MATH_POWER_SYMBOL","MATH_ARITHMETIC_HELPURL","ADD","MATH_ARITHMETIC_TOOLTIP_ADD","MINUS","MATH_ARITHMETIC_TOOLTIP_MINUS","MULTIPLY","MATH_ARITHMETIC_TOOLTIP_MULTIPLY","DIVIDE","MATH_ARITHMETIC_TOOLTIP_DIVIDE","POWER","MATH_ARITHMETIC_TOOLTIP_POWER","math_single","MATH_SINGLE_OP_ROOT","MATH_SINGLE_OP_ABSOLUTE","MATH_SINGLE_HELPURL","ROOT","MATH_SINGLE_TOOLTIP_ROOT","ABS","MATH_SINGLE_TOOLTIP_ABS","NEG","MATH_SINGLE_TOOLTIP_NEG","LN","MATH_SINGLE_TOOLTIP_LN","LOG10","MATH_SINGLE_TOOLTIP_LOG10","EXP","MATH_SINGLE_TOOLTIP_EXP","POW10","MATH_SINGLE_TOOLTIP_POW10","math_trig","MATH_TRIG_SIN","MATH_TRIG_COS","MATH_TRIG_TAN","MATH_TRIG_ASIN","MATH_TRIG_ACOS","MATH_TRIG_ATAN","MATH_TRIG_HELPURL","SIN","MATH_TRIG_TOOLTIP_SIN","COS","MATH_TRIG_TOOLTIP_COS","TAN","MATH_TRIG_TOOLTIP_TAN","ASIN","MATH_TRIG_TOOLTIP_ASIN","ACOS","MATH_TRIG_TOOLTIP_ACOS","ATAN","MATH_TRIG_TOOLTIP_ATAN","math_constant","MATH_CONSTANT_HELPURL","MATH_CONSTANT_TOOLTIP","math_number_property","PROPERTIES","MATH_IS_EVEN","MATH_IS_ODD","MATH_IS_PRIME","MATH_IS_WHOLE","MATH_IS_POSITIVE","MATH_IS_NEGATIVE","MATH_IS_DIVISIBLE_BY","dropdown","updateShape","MATH_IS_TOOLTIP","divisorInput","inputExists","math_change","MATH_CHANGE_HELPURL","MATH_CHANGE_TITLE_CHANGE","MATH_CHANGE_TITLE_ITEM","MATH_CHANGE_INPUT_BY","MATH_CHANGE_TOOLTIP","math_round","MATH_ROUND_OPERATOR_ROUND","MATH_ROUND_OPERATOR_ROUNDUP","MATH_ROUND_OPERATOR_ROUNDDOWN","MATH_ROUND_HELPURL","MATH_ROUND_TOOLTIP","math_on_list","MATH_ONLIST_OPERATOR_SUM","MATH_ONLIST_OPERATOR_MIN","MATH_ONLIST_OPERATOR_MAX","MATH_ONLIST_OPERATOR_AVERAGE","MATH_ONLIST_OPERATOR_MEDIAN","MATH_ONLIST_OPERATOR_MODE","MATH_ONLIST_OPERATOR_STD_DEV","MATH_ONLIST_OPERATOR_RANDOM","MATH_ONLIST_HELPURL","newOp","math_modulo","MATH_MODULO_HELPURL","MATH_MODULO_TITLE","MATH_MODULO_TOOLTIP","math_constrain","MATH_CONSTRAIN_HELPURL","MATH_CONSTRAIN_TITLE","MATH_CONSTRAIN_TOOLTIP","math_random_int","MATH_RANDOM_INT_HELPURL","MATH_RANDOM_INT_TITLE","MATH_RANDOM_INT_TOOLTIP","math_random_float","MATH_RANDOM_FLOAT_HELPURL","MATH_RANDOM_FLOAT_TITLE_RANDOM","MATH_RANDOM_FLOAT_TOOLTIP","TEXT_TEXT_HELPURL","TEXT_TEXT_TOOLTIP","text_join","TEXT_JOIN_HELPURL","TEXT_JOIN_TITLE_CREATEWITH","TEXT_JOIN_TOOLTIP","text_create_join_container","TEXT_CREATE_JOIN_TITLE_JOIN","TEXT_CREATE_JOIN_TOOLTIP","text_create_join_item","TEXT_CREATE_JOIN_ITEM_TITLE_ITEM","TEXT_CREATE_JOIN_ITEM_TOOLTIP","text_append","TEXT_APPEND_HELPURL","TEXT_APPEND_TO","TEXT_APPEND_VARIABLE","TEXT_APPEND_APPENDTEXT","TEXT_APPEND_TOOLTIP","text_length","TEXT_LENGTH_HELPURL","TEXT_LENGTH_TITLE","TEXT_LENGTH_TOOLTIP","text_isEmpty","TEXT_ISEMPTY_HELPURL","TEXT_ISEMPTY_TITLE","TEXT_ISEMPTY_TOOLTIP","text_indexOf","TEXT_INDEXOF_OPERATOR_FIRST","TEXT_INDEXOF_OPERATOR_LAST","TEXT_INDEXOF_HELPURL","TEXT_INDEXOF_INPUT_INTEXT","TEXT_INDEXOF_TAIL","TEXT_INDEXOF_TOOLTIP","text_charAt","TEXT_CHARAT_FROM_START","TEXT_CHARAT_FROM_END","TEXT_CHARAT_FIRST","TEXT_CHARAT_LAST","TEXT_CHARAT_RANDOM","TEXT_CHARAT_HELPURL","TEXT_CHARAT_INPUT_INTEXT","TEXT_CHARAT_TOOLTIP","TEXT_CHARAT_TAIL","text_getSubstring","TEXT_GET_SUBSTRING_START_FROM_START","TEXT_GET_SUBSTRING_START_FROM_END","TEXT_GET_SUBSTRING_START_FIRST","TEXT_GET_SUBSTRING_END_FROM_START","TEXT_GET_SUBSTRING_END_FROM_END","TEXT_GET_SUBSTRING_END_LAST","TEXT_GET_SUBSTRING_HELPURL","TEXT_GET_SUBSTRING_INPUT_IN_TEXT","TEXT_GET_SUBSTRING_TAIL","TEXT_GET_SUBSTRING_TOOLTIP","text_changeCase","TEXT_CHANGECASE_OPERATOR_UPPERCASE","TEXT_CHANGECASE_OPERATOR_LOWERCASE","TEXT_CHANGECASE_OPERATOR_TITLECASE","TEXT_CHANGECASE_HELPURL","TEXT_CHANGECASE_TOOLTIP","text_trim","TEXT_TRIM_OPERATOR_BOTH","TEXT_TRIM_OPERATOR_LEFT","TEXT_TRIM_OPERATOR_RIGHT","TEXT_TRIM_HELPURL","TEXT_TRIM_TOOLTIP","text_print","TEXT_PRINT_HELPURL","TEXT_PRINT_TITLE","TEXT_PRINT_TOOLTIP","text_prompt","TYPES","TEXT_PROMPT_TYPE_TEXT","TEXT_PROMPT_TYPE_NUMBER","TEXT_PROMPT_HELPURL","TEXT_PROMPT_TOOLTIP_TEXT","TEXT_PROMPT_TOOLTIP_NUMBER","ORDER_ATOMIC","ORDER_MEMBER","ORDER_NEW","ORDER_FUNCTION_CALL","ORDER_INCREMENT","ORDER_DECREMENT","ORDER_LOGICAL_NOT","ORDER_BITWISE_NOT","ORDER_UNARY_PLUS","ORDER_UNARY_NEGATION","ORDER_TYPEOF","ORDER_VOID","ORDER_DELETE","ORDER_MULTIPLICATION","ORDER_DIVISION","ORDER_MODULUS","ORDER_ADDITION","ORDER_SUBTRACTION","ORDER_BITWISE_SHIFT","ORDER_RELATIONAL","ORDER_IN","ORDER_INSTANCEOF","ORDER_EQUALITY","ORDER_BITWISE_AND","ORDER_BITWISE_XOR","ORDER_BITWISE_OR","ORDER_LOGICAL_AND","ORDER_LOGICAL_OR","ORDER_CONDITIONAL","ORDER_ASSIGNMENT","ORDER_COMMA","ORDER_NONE","INFINITE_LOOP_TRAP","Blockly.JavaScript.init","definitions_","variableDB_","defvars","variables","Blockly.JavaScript.finish","definitions","Blockly.JavaScript.scrubNakedValue","Blockly.JavaScript.quote_","translateVarName","Blockly.JavaScript.translateVarName","Blockly.JavaScript.scrub_","skipNextBlockGeneration","nextCode","Blockly.JavaScript.colour","Blockly.JavaScript.colour_picker","Blockly.JavaScript.colour_random","Blockly.JavaScript.colour_rgb","Blockly.JavaScript.colour_blend","c1","c2","Blockly.JavaScript.functionalExamples","Blockly.JavaScript.functional_example","Blockly.JavaScript.functionalParameters","Blockly.JavaScript.functional_parameters_get","Blockly.JavaScript.functionalProcedures","Blockly.JavaScript.functional_definition","funcName","branch","Blockly.JavaScript.functional_call","Blockly.JavaScript.functional_pass","Blockly.JavaScript.procedural_to_functional_call","Blockly.JavaScript.lists","Blockly.JavaScript.lists_create_empty","Blockly.JavaScript.lists_create_with","Blockly.JavaScript.lists_repeat","argument0","argument1","Blockly.JavaScript.lists_length","Blockly.JavaScript.lists_isEmpty","Blockly.JavaScript.lists_indexOf","Blockly.JavaScript.lists_getIndex","where","at","lists_remove_from_end","lists_get_random_item","Blockly.JavaScript.lists_setIndex","cacheList","listVar","xVar","Blockly.JavaScript.lists_getSublist","where1","where2","at1","at2","lists_get_sublist","Blockly.JavaScript.logic","Blockly.JavaScript.controls_if","Blockly.JavaScript.logic_compare","Blockly.JavaScript.logic_operation","Blockly.JavaScript.logic_negate","Blockly.JavaScript.logic_boolean","Blockly.JavaScript.logic_null","Blockly.JavaScript.logic_ternary","Blockly.JavaScript.loops","Blockly.JavaScript.controls_repeat","repeats","loopVar","Blockly.JavaScript.controls_repeat_ext","endVar","Blockly.JavaScript.controls_whileUntil","until","Blockly.JavaScript.controls_for","variable0","increment","variable0Undec","startVar","incVar","Blockly.JavaScript.controls_forEach","indexVar","Blockly.JavaScript.controls_flow_statements","Blockly.JavaScript.math","Blockly.JavaScript.math_number","Blockly.JavaScript.math_arithmetic","Blockly.JavaScript.math_single","Blockly.JavaScript.math_constant","CONSTANTS","GOLDEN_RATIO","SQRT2","INFINITY","Blockly.JavaScript.math_number_property","number_to_check","dropdown_property","isPrime","logic_prime","divisor","Blockly.JavaScript.math_change","Blockly.JavaScript.math_on_list","math_mean","math_median","math_modes","math_standard_deviation","math_random_item","Blockly.JavaScript.math_modulo","Blockly.JavaScript.math_constrain","Blockly.JavaScript.math_random_int","random_function","Blockly.JavaScript.math_random_float","Blockly.JavaScript.procedures","Blockly.JavaScript.procedures_defreturn","Blockly.JavaScript.procedures_callreturn","Blockly.JavaScript.procedures_callnoreturn","Blockly.JavaScript.procedures_ifreturn","Blockly.JavaScript.text","Blockly.JavaScript.text_join","Blockly.JavaScript.text_append","Blockly.JavaScript.text_length","Blockly.JavaScript.text_isEmpty","Blockly.JavaScript.text_indexOf","Blockly.JavaScript.text_charAt","text_random_letter","Blockly.JavaScript.text_getSubstring","text_get_substring","Blockly.JavaScript.text_changeCase","text_toTitleCase","UPPERCASE","LOWERCASE","TITLECASE","Blockly.JavaScript.text_trim","Blockly.JavaScript.text_print","Blockly.JavaScript.text_prompt","Blockly.JavaScript.variables","Blockly.JavaScript.variables_get","Blockly.JavaScript.variables_set","parameters_set","sprite_variables_get","sprite_variables_set","HTML_NS","HSV_SATURATION","HSV_VALUE","Blockly.makeColour","Blockly.playAudio","play","Blockly.removeAllRanges","removeAllSafe","getSelection","sel","BlocklyModule"],"mappings":"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D,SAAiB,uBAH5C52D,QAII,wBAAyBgU,QAAA4iD,SAAiB,yBACrD5iD,QAAA+9E,IAAAmtN,YAA0B9jT,KAAAigT,MAAAgD,WAAsBp6N,GAAtBo7N,eAU5BttN,IAAAD,UAAwBwtN,SAAS/kI,EAAQglI,GACnCvrS,QAAA01E,UAIA11E,QAAA+9E,IAAAktN,iBAA+B1kI,IACjCvmK,QAAA+9E,IAAAktN,eAA6B1kI,EAIzBglI,IACEhlI,GAAUvmK,QAAA+9E,IAAAC,OAAA8gD,KACZ9+H,QAAA8D,aAAqBynS,EAAA7qQ,WAAoB,YAEzC1gC,QAAA2D,UAAkB4nS,EAAA7qQ,WAAoB,uBAS9Cq9C,IAAAg9E,SACE,gCACA,4BACA,uBACA,IACA,+BACA,kCACA,yBACA,uBACA,IACA,qCACA,iBACA,IACA,0CACA,sBACA,uBACA,wBACA,IACA,iDACA,iBACA,oCACA,wBACA,iBACA,cACA,cACA,IACA,uBACA,kBACA,IACA,iCACA,kBACA,IACA,+BACA,oBACA,eACA,IACA,sCACA,kBACA,IACA,8CACA,iBACA,IACA,wIACA,kBACA,IACA,uCACA,2BACA,iBACA,IACA,oDACA,eACA,IACA,8CACA,eACA,sBACA,IACA,gCACA,oBACA,IACA,6CACA,eACA,oBACA,wBACA,+BACA,IACA,sBACA,+CACA,IACA,kEACA,4DACA,IACA,oBACA,4BACA,IACA,gCACA,mBACA,IACA,kCACA,8BACA,IACA,qCACA,qBACA,uBACA,IACA,kDACA,uBACA,IACA,0GACA,mBACA,IACA,gBACA,qBACA,4BACA,sBACA,IACA,uBACA,yBACA,IACA,uBACA,4BACA,wBACA,IACA,sBACA,wBACA,mBACA,kBACA,IACA,qBACA,gBACA,uBACA,IACA,qBACA,gBACA,uBACA,IACA,uBACA,qBACA,kBACA,IACA,sCACA,uBACA,kBACA,gBACA,IACA,sBACA,gBACA,qBACA,2BACA,IACA,qBACA,gBACA,qBACA,IACA,uEACA,mBACA,IACA,mCACA,gBACA,IACA,kCACA,uBACA,kBACA,IACA,uCACA,mBACA,IACA,kDACA,uBACA,mBACA,IACA,uBACA,mBACA,0BACA,wBACA,YACA,aACA,iBACA,IACA,kCACA,oBACA,IACA,iCACA,uCACA,uBACA,yBACA,IACA,sCACA,mBACA,IACA,kCACA,wBACA,0BACA,IACA,sCACA,sCACA,mBACA,IACA,iBACA,qBACA,6BACA,qBACA,gBACA,IACA,mBACA,qCACA,IACA,yCACA,2BACA,wBACA,0BACA,0BACA,IACA,qBACA,4BACA,IACA,oCACA,qBACA,uBACA,wBACA,IACA,8BACA,qBACA,qBACA,gBACA,IACA,wBACA,oBACA,qBACA,IACA,oBACA,0BACA,IACA,oBACA,iBACA,wBACA,IACA,uBACA,6BACA,wBACA,IACA,mBACA,oBACA,IACA,gBACA,+BACA,gCACA,IACA,iBACA,0CACA,0CACA,IACA,yBACA,wBACA,qBACA,IACA,uBACA,iBACA,iBACA,kBACA,kCACA,iCACA,IACA,sCACA,kCACA,gCACA,IACA,iCACA,0BACA,IACA,gCACA,8BACA,gBACA,uBACA,IACA,gCACA,8BACA,gBACA,IACA,oCACA,qBACA,kBACA,IACA,KACA,wEACA,mDACA,MACA,qBACA,4BACA,+BACA,uBACA,qBACA,IAEA,mBACA,mBACA,IACA,8CACA,oBACA,IACA,8BACA,mBACA,uBACA,qBACA,IACA,yBACA,6BACA,+BACA,gBACA,uCACA,IACA,wBACA,6BACA,oBACA,gBACA,IACA,iCACA,mBACA,IACA,8BACA,mBACA,IACA,uBACA,0CACA,0CACA,IACA,uBACA,qBACA,gBACA,uBACA,kBACA,IACA,+CACA,gBACA,kBACA,IACA,6CACA,gBACA,IACA,qBACA,gCACA,6BACA,oBACA,uBACA,gBACA,yBACA,IACA,wBACA,IACA,wBACA,eACA,gBACA,IACA,sBACA,6BACA,qBACA,kBACA,mBACA,iBACA,gCACA,IACA,+FACA,8BACA,IACA,iCACA,8BACA,gBACA,qBACA,kBACA,IACA,oBACA,wBACA,gBACA,iBACA,IACA,mDACA,oBACA,sBACA,qBACA,qBACA,IACA,8CACA,sDACA,gDACA,gBACA,IACA,yDACA,2DACA,gBACA,IACA,8BACA,gBACA,IACA,qBACA,gCACA,6BACA,uEACA,gBACA,IACA,qEACA,uEACA,gBACA,IACA,0CACA,gBACA,IACA,6CACA,gBACA,IACA,6BACA,gBACA,uBACA,IACA,8BACA,gBACA,IACA,uBACA,gBACA,IACA,gCACA,gBACA,qBACA,qBACA,IACA,0BACA,gBACA,IACA,2DACA,gCACA,gBACA,IACA,yBACA,sBACA,IACA,wBACA,kBACA,qBACA,gBACA,uBACA,IACA,uBACA,kBACA,qBACA,IACA,uBACA,gBACA,yBACA,IACA,wBACA,wBACA,IACA,yBACA,2BACA,mCACA,IACA,mDACA,kBACA,2BACA,wBACA,mCACA,IACA,sCACA,gBACA,uBACA,IACA,qCACA,mBACA,gCACA,IACA,mFACA,sCACA,qCACA,kCACA,oCACA,kCACA,oCACA,oCACA,iCACA,IACA,kDACA,oBACA,iBACA,IACA,4CACA,gCACA,IACA,eACA,kCACA,uBACA,IACA,mBAEA,oBACA,uBACA,IACA,4BACA,yBACA,qBACA,4BACA,IACA,oDACA,iBACA,IACA,yDACA,kBACA,IACA,4BACA,mBACA,IACA,wCACA,gCACA,6BACA,wBACA,IACA,oCACA,wBACA,iCACA,IAEA,iDACA,8CAGA,IACA,kCACA,uBACA,mBACA,yBACA,sBACA,wBACA,IACA,qBACA,oBACA,IACA,2BACA,mBACA,IACA,oBACA,uBACA,kBACA,wBACA,yBACA,IACA,kDACA,sBACA,kCACA,IACA,0BACA,+BACA,IACA,qBACA,kBACA,iBACA,4BACA,wCACA,IACA,8BACA,qCACA,IACA,8BACA,mCACA,IACA,yBACA,qCACA,IACA,yBACA,qCACA,IACA,mDACA,sCACA,IACA,mDACA,oCACA,IACA,8CACA,sCACA,IACA,8CACA,sCACA,IACA,sBACA,qBACA,6BACA,qBACA,oBACA,4BACA,4BACA,+BACA,2BACA,uBACA,IACA,yBACA,uCACA,IACA,2CACA,iBACA,IACA,kBACA,oBACA,IACA,kBACA,wBACA,0BACA,IACA,gDACA,4BACA,iBACA,eACA,kBACA,IACA,8CACA,kBACA,eACA,IACA,sBACA,sBACA,IACA,oBACA,wBACA,iBACA,eACA,IACA,0BACA,wBACA,YACA,aACA,6BACA,0BACA,IACA,4BACA,oCACA,IAEA,KACA,sEACA,KACA,6EACA,uCACA,MAEA,kDAEA,KACA,uEACA,8EACA,KACA,kBACA,mBACA,qBACA,IAEA,wBACA,4BACA,+BACA,IAEA,uBACA,kBACA,iBACA,eACA,eACA,wBACA,4BACA,kCACA,oBACA,IAEA,8BACA,wBACA,kBACA,iBACA,4BACA,IAEA,uDACA,4BACA,IAEA,0DACA,4BACA,iBACA,IAeA,eACA,sBACA,uCACA,yBACA,uBACA,qBACA,yCACA,eACA,mBACA,oBACA,wBACA,oBACA,IA+BA,mBACA,iBACA,yCACA,sBACA,eAEA,+BACA,yBACA,IAIA,qCAEA,uBACA,yBACA,IAGA,wCACA,qCACA,wBACA,IAMA,8DACA,yBACA,IACA,wDACA,wBACA,IAEA,2BACA,iBACA,qBACA,IAGA,gDACA,mDACA,4BACA,IAEA,gDACA,kBACA,uBACA,+BACA,IAGA,4BACA,yBACA,+BAGA,2BACA,0BACA,yBACA,yBACA,sBACA,IAGA,2BACA,wBACA,kCACA,kBACA,eACA,wBACA,iBACA,4BACA,iBACA,IAIA,8CACA,2CAEA,gBACA,gBACA,IAEA,iDACA,8CAIA,IAGA,yBACA,iBAGA,oBACA,gBACA,oBACA,wBACA,cACA,uBACA,IAIA,4CAEA,aACA,iBACA,sBACA,IAGA,iCACA,gCACA,IAEA,sCACA,iBACA,qBACA,uBACA,IAgBA,wBACA,gCACA,mBACA,gBACA,IAKA,2BACA,4BACA,+BACA,iBACA,qBACA,sBACA,sBACA,mBACA,mBACA,sBACA,wBACA,2BACA,4BACA,IAEA,sCACA,wBACA,iBACA,qBACA,IAEA,iCACA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","file":"blockly.js","sourcesContent":["/*\n * Copyright 2012 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * @fileoverview The base namespace for code injected by the compiler\n * at compile-time.\n *\n * @author nicksantos@google.com (Nick Santos)\n */\n\n/** @const */\nvar $jscomp = $jscomp || {};\n\n/** @const Locals for goog.scope */\n$jscomp.scope = {};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require base';\n\n\n/**\n * Throws if the argument is a RegExp, or if thisArg is undefined.\n * @param {?} thisArg The 'this' arg, which must be defined.\n * @param {*} arg The first argument of the function, which mustn't be a RegExp.\n * @param {string} func Name of the function, for reporting.\n * @return {string} The thisArg, coerced to a string.\n * @suppress {reportUnknownTypes}\n */\n$jscomp.checkStringArgs = function(thisArg, arg, func) {\n  if (thisArg == null) {\n    throw new TypeError(\n        \"The 'this' value for String.prototype.\" + func +\n        ' must not be null or undefined');\n  }\n  if (arg instanceof RegExp) {\n    throw new TypeError(\n        'First argument to String.prototype.' + func +\n        ' must not be a regular expression');\n  }\n  return thisArg + '';\n};\n","/*\n * Copyright 2017 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require base';\n\n\n/**\n * Whether to assume ES5 is available.  This enables removing several\n * internal polyfills, which must otherwise be detected at runtime.\n * @define {boolean}\n */\n$jscomp.ASSUME_ES5 = false;\n\n/**\n * Whether to skip the conformance check and simply use the polyfill always.\n * @define {boolean}\n */\n$jscomp.ASSUME_NO_NATIVE_MAP = false;\n\n/**\n * Whether to skip the conformance check and simply use the polyfill always.\n * @define {boolean}\n */\n$jscomp.ASSUME_NO_NATIVE_SET = false;\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Provides methods to polyfill native objects.\n * @suppress {reportUnknownTypes}\n */\n'require util/defines';\n\n\n/**\n * Polyfill for Object.defineProperty() method:\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty\n *\n * Refuses to define properties on Array.prototype and Object.prototype,\n * since we can't make them non-enumerable and this messes up peoples' for\n * loops.  Beyond this, we simply assign values and not worry\n * about enumerability or writeability.\n * @param {?} target\n * @param {string} property\n * @param {?} descriptor\n * @suppress {reportUnknownTypes}\n */\n$jscomp.defineProperty =\n    $jscomp.ASSUME_ES5 || typeof Object.defineProperties == 'function' ?\n    Object.defineProperty :\n    function(target, property, descriptor) {\n      descriptor = /** @type {!ObjectPropertyDescriptor} */ (descriptor);\n      // NOTE: This is currently never called with a descriptor outside\n      // the control of the compiler.  If we ever decide to polyfill either\n      // Object.defineProperty or Reflect.defineProperty for ES3, we should\n      // explicitly check for `get` or `set` on the descriptor and throw a\n      // TypeError, since it's impossible to properly polyfill it.\n      if (target == Array.prototype || target == Object.prototype) return;\n      target[property] = descriptor.value;\n    };\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Runtime code to store the global object.\n */\n'require base';\n'declare global';\n'declare window';\n\n\n/**\n * @param {!Object} maybeGlobal\n * @return {!Object} The global object.\n * @suppress {undefinedVars|reportUnknownTypes}\n */\n$jscomp.getGlobal = function(maybeGlobal) {\n  return (typeof window != 'undefined' && window === maybeGlobal) ?\n      maybeGlobal :\n      (typeof global != 'undefined' && global != null) ? global : maybeGlobal;\n};\n\n\n// TODO(sdh): This should be typed as \"the global object\", but there's not\n// currently any way to do this in the existing type system.\n/**\n * The global object. For browsers we could just use `this` but in Node that\n * doesn't work.\n * @const {?}\n */\n$jscomp.global = $jscomp.getGlobal(this);\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Provides methods to polyfill native objects.\n */\n'require util/defineproperty';\n'require util/global';\n\n\n/**\n * @param {string} target Qualified name of the class or method to polyfill,\n *     e.g. 'Array.prototype.includes' or 'Map'.\n * @param {?function(*): *} polyfill A function that takes the current browser\n *     implementation of the target and returns an optional new polyfill\n *     implementation.  If null is returned, then no polyfill will be added.  A\n *     null argument for this parameter indicates that the function will not be\n *     polyfilled, and is only useful for `build_polyfill_table.js` bookkeeping.\n * @param {string} fromLang The language level in which the target is expected\n *     to already be present in the browser.  The compiler requires that\n *     `languageOut < fromLang` before injecting a polyfill (i.e. if the\n *     specified output language already includes the feature then there's no\n *     need to polyfill it).\n * @param {string} toLang The language level required by the polyfill\n *     implementation.  The compiler will issue an error if a polyfill is\n *     required, but `languageOut < toLang`.  Additionally, the\n *     `build_polyfill_table.js` script audits the polyfill dependency tree to\n *     ensure that no polyfill with a lower `toLang` depends on one with a\n *     higher `toLang`.\n * @suppress {reportUnknownTypes}\n * @noinline\n * NOTE: We prevent inlining so RemoveUnusedPolyfills can always recognize this\n * call.\n */\n$jscomp.polyfill = function(target, polyfill, fromLang, toLang) {\n  if (!polyfill) return;\n  var obj = $jscomp.global;\n  var split = target.split('.');\n  for (var i = 0; i < split.length - 1; i++) {\n    var key = split[i];\n    if (!(key in obj)) obj[key] = {};  // Might want to be defineProperty.\n    obj = obj[key];\n  }\n  var property = split[split.length - 1];\n  var orig = obj[property];\n  var impl = polyfill(orig);\n  if (impl == orig || impl == null) return;\n  $jscomp.defineProperty(\n      obj, property, {configurable: true, writable: true, value: impl});\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require util/checkstringargs';\n'require util/polyfill';\n\n$jscomp.polyfill('String.prototype.repeat', function(orig) {\n  if (orig) return orig;\n\n  /**\n   * Returns a new string repeated the given number of times.\n   *\n   * <p>Polyfills the instance method String.prototype.repeat().\n   *\n   * @this {string}\n   * @param {number} copies\n   * @return {string}\n   */\n  var polyfill = function(copies) {\n    'use strict';\n    var string = $jscomp.checkStringArgs(this, null, 'repeat');\n    if (copies < 0 || copies > 0x4FFFFFFF) { // impose a 1GB limit\n      throw new RangeError('Invalid count value');\n    }\n    copies = copies | 0; // cast to a signed integer.\n    var result = '';\n    while (copies) {\n      if (copies & 1) result += string;\n      if ((copies >>>= 1)) string += string;\n    }\n    return result;\n  };\n\n  return polyfill;\n}, 'es6', 'es3');\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Utility for Array methods that find elements.\n */\n'require base';\n\n// TODO(sdh): would be nice to template on the ARRAY type as well,\n// so that the third arg type of callback can be refined to be\n// exactly the same as the array type, but then there's no way to\n// enforce that it must, in fact, be an array.\n/**\n * Internal implementation of find.\n * @param {!IArrayLike<VALUE>} array\n * @param {function(this: THIS, VALUE, number, !IArrayLike<VALUE>): *} callback\n * @param {THIS} thisArg\n * @return {{i: number, v: (VALUE|undefined)}}\n * @template THIS, VALUE\n * @suppress {reportUnknownTypes}\n */\n$jscomp.findInternal = function(array, callback, thisArg) {\n  if (array instanceof String) {\n    array = /** @type {!IArrayLike} */ (String(array));\n  }\n  var len = array.length;\n  for (var i = 0; i < len; i++) {\n    var value = array[i];\n    if (callback.call(thisArg, value, i, array)) return {i: i, v: value};\n  }\n  return {i: -1, v: void 0};\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require util/findinternal';\n'require util/polyfill';\n\n$jscomp.polyfill('Array.prototype.findIndex', function(orig) {\n  if (orig) return orig;\n\n  /**\n   * Finds an element that satisfies the given predicate, returning its index.\n   *\n   * @this {!IArrayLike<VALUE>}\n   * @param {function(this: THIS, VALUE, number, !IArrayLike<VALUE>): *}\n   *     callback\n   * @param {THIS=} opt_thisArg\n   * @return {number} The found value, or undefined.\n   * @template VALUE, THIS\n   * @suppress {reportUnknownTypes}\n   */\n  var polyfill = function(callback, opt_thisArg) {\n    return $jscomp.findInternal(this, callback, opt_thisArg).i;\n  };\n\n  return polyfill;\n}, 'es6', 'es3');\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require util/findinternal';\n'require util/polyfill';\n\n$jscomp.polyfill('Array.prototype.find', function(orig) {\n  if (orig) return orig;\n\n  /**\n   * Finds and returns an element that satisfies the given predicate.\n   *\n   * @this {!IArrayLike<VALUE>}\n   * @param {function(this: THIS, VALUE, number, !IArrayLike<VALUE>): *}\n   *     callback\n   * @param {THIS=} opt_thisArg\n   * @return {VALUE|undefined} The found value, or undefined.\n   * @template VALUE, THIS\n   * @suppress {reportUnknownTypes}\n   */\n  var polyfill = function(callback, opt_thisArg) {\n    return $jscomp.findInternal(this, callback, opt_thisArg).v;\n  };\n\n  return polyfill;\n}, 'es6', 'es3');\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require util/defineproperty';\n'require util/global';\n\n/** @const {string} */\n$jscomp.SYMBOL_PREFIX = 'jscomp_symbol_';\n\n\n/**\n * Initializes the Symbol function.\n * @suppress {reportUnknownTypes}\n */\n$jscomp.initSymbol = function() {\n  // Only need to do this once. All future calls are no-ops.\n  $jscomp.initSymbol = function() {};\n\n  if (!$jscomp.global['Symbol']) {\n    $jscomp.global['Symbol'] = $jscomp.Symbol;\n  }\n};\n\n\n/**\n * Produces \"symbols\" (actually just unique strings).\n * @param {string=} opt_description\n * @return {symbol}\n */\n$jscomp.Symbol = /** @type {function(): !Function} */ (function() {\n  var counter = 0;\n  /**\n   * @param {string=} opt_description\n   * @return {symbol}\n   * @suppress {reportUnknownTypes}\n   */\n  function Symbol(opt_description) {\n    return /** @type {?} */ (\n        $jscomp.SYMBOL_PREFIX + (opt_description || '') + (counter++));\n  }\n  return Symbol;\n})();\n\n\n/**\n * Initializes Symbol.iterator (if it's not already defined) and adds a\n * Symbol.iterator property to the Array prototype.\n * @suppress {reportUnknownTypes}\n */\n$jscomp.initSymbolIterator = function() {\n  $jscomp.initSymbol();\n  var symbolIterator = $jscomp.global['Symbol'].iterator;\n  if (!symbolIterator) {\n    symbolIterator = $jscomp.global['Symbol'].iterator =\n        $jscomp.global['Symbol']('iterator');\n  }\n\n  if (typeof Array.prototype[symbolIterator] != 'function') {\n    $jscomp.defineProperty(\n        Array.prototype, symbolIterator, {\n          configurable: true,\n          writable: true,\n          /**\n           * @this {Array}\n           * @return {!IteratorIterable}\n           */\n          value: function() {\n            return $jscomp.arrayIterator(this);\n          }\n        });\n  }\n\n  // Only need to do this once. All future calls are no-ops.\n  $jscomp.initSymbolIterator = function() {};\n};\n\n\n/**\n * Returns an iterator from the given array.\n * @param {!Array<T>} array\n * @return {!IteratorIterable<T>}\n * @template T\n */\n$jscomp.arrayIterator = function(array) {\n  var index = 0;\n  return $jscomp.iteratorPrototype(function() {\n    if (index < array.length) {\n      return {\n        done: false,\n        value: array[index++],\n      };\n    } else {\n      return {done: true};\n    }\n  });\n};\n\n\n/**\n * Returns an iterator with the given `next` method.  Passing\n * all iterators through this function allows easily extending\n * the definition of `%IteratorPrototype%` if methods are ever\n * added to it in the future.\n *\n * @param {function(this: Iterator<T>): T} next\n * @return {!IteratorIterable<T>}\n * @template T\n * @suppress {reportUnknownTypes}\n */\n$jscomp.iteratorPrototype = function(next) {\n  $jscomp.initSymbolIterator();\n\n  var iterator = {next: next};\n  /**\n   * @this {IteratorIterable}\n   * @return {!IteratorIterable}\n   */\n  iterator[$jscomp.global['Symbol'].iterator] = function() { return this; };\n  return /** @type {!IteratorIterable} */ (iterator);\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Utilities for iterator-returning methods.\n */\n'require es6/symbol';\n\n\n/**\n * Creates an iterator from an array-like, with a transformation function.\n * @param {!IArrayLike<INPUT>} array\n * @param {function(number, INPUT): OUTPUT} transform\n * @return {!IteratorIterable<OUTPUT>}\n * @template INPUT, OUTPUT\n * @suppress {checkTypes|reportUnknownTypes}\n */\n$jscomp.iteratorFromArray = function(array, transform) {\n  $jscomp.initSymbolIterator();\n  // NOTE: IE8 doesn't support indexing from boxed Strings.\n  if (array instanceof String) array = array + '';\n  var i = 0;\n  var iter = {\n    next: function() {\n      if (i < array.length) {\n        var index = i++;\n        return {value: transform(index, array[index]), done: false};\n      }\n      iter.next = function() { return {done: true, value: void 0}; };\n      return iter.next();\n    }\n  };\n  iter[Symbol.iterator] = function() { return iter; };\n  return iter;\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require es6/util/iteratorfromarray';\n'require util/polyfill';\n\n$jscomp.polyfill('Array.prototype.keys', function(orig) {\n  if (orig) return orig;\n\n  /**\n   * Returns an iterator of keys of the given array.\n   *\n   * @this {!IArrayLike}\n   * @return {!IteratorIterable<number>}\n   */\n  var polyfill = function() {\n    return $jscomp.iteratorFromArray(this, function(i) { return i; });\n  };\n\n  return polyfill;\n}, 'es6', 'es3');\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require util/checkstringargs';\n'require util/polyfill';\n\n$jscomp.polyfill('String.prototype.endsWith', function(orig) {\n  if (orig) return orig;\n\n  /**\n   * Tests whether the string ends with a given substring.\n   *\n   * <p>Polyfills the instance method String.prototype.endsWith().\n   *\n   * @this {string}\n   * @param {string} searchString\n   * @param {number=} opt_position\n   * @return {boolean}\n   */\n  var polyfill = function(searchString, opt_position) {\n    'use strict';\n    var string = $jscomp.checkStringArgs(this, searchString, 'endsWith');\n    searchString = searchString + '';\n    if (opt_position === void 0) opt_position = string.length;\n    var i = Math.max(0, Math.min(opt_position | 0, string.length));\n    var j = searchString.length;\n    while (j > 0 && i > 0) {\n      if (string[--i] != searchString[--j]) return false;\n    }\n    return j <= 0;\n  };\nreturn polyfill;\n}, 'es6', 'es3');\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require util/checkstringargs';\n'require util/polyfill';\n\n$jscomp.polyfill('String.prototype.startsWith', function(orig) {\n  if (orig) return orig;\n\n  /**\n   * Tests whether the string starts with a given substring.\n   *\n   * <p>Polyfills the instance method String.prototype.startsWith().\n   *\n   * @this {string}\n   * @param {string} searchString\n   * @param {number=} opt_position\n   * @return {boolean}\n   */\n  var polyfill = function(searchString, opt_position) {\n    'use strict';\n    var string = $jscomp.checkStringArgs(this, searchString, 'startsWith');\n    searchString = searchString + '';\n    var strLen = string.length;\n    var searchLen = searchString.length;\n    var i = Math.max(\n        0,\n        Math.min(/** @type {number} */ (opt_position) | 0, string.length));\n    var j = 0;\n    while (j < searchLen && i < strLen) {\n      if (string[i++] != searchString[j++]) return false;\n    }\n    return j >= searchLen;\n  };\n\n  return polyfill;\n}, 'es6', 'es3');\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require es6/util/iteratorfromarray';\n'require util/polyfill';\n\n// NOTE: Although Array.prototype.values was added to the 2015 edition of the\n// spec, we consider it an \"ES8\" feature because many browsers which are\n// otherwise ES6-compatible, have not implemented it due to web compatibility\n// issues. See https://bugs.chromium.org/p/chromium/issues/detail?id=615873\n$jscomp.polyfill('Array.prototype.values', function(orig) {\n  if (orig) return orig;\n\n  /**\n   * Returns an iterator of values of the given array.\n   *\n   * @this {!IArrayLike<VALUE>}\n   * @return {!IteratorIterable<VALUE>}\n   * @template VALUE\n   * @suppress {reportUnknownTypes}\n   */\n  var polyfill = function() {\n    return $jscomp.iteratorFromArray(this, function(k, v) { return v; });\n  };\n\n  return polyfill;\n}, 'es8', 'es3');\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Bootstrap for the Google JS Library (Closure).\n *\n * In uncompiled mode base.js will write out Closure's deps file, unless the\n * global <code>CLOSURE_NO_DEPS</code> is set to true.  This allows projects to\n * include their own deps file(s) from different locations.\n *\n * @author arv@google.com (Erik Arvidsson)\n *\n * @provideGoog\n */\n\n\n/**\n * @define {boolean} Overridden to true by the compiler when\n *     --process_closure_primitives is specified.\n */\nvar COMPILED = false;\n\n\n/**\n * Base namespace for the Closure library.  Checks to see goog is already\n * defined in the current scope before assigning to prevent clobbering if\n * base.js is loaded more than once.\n *\n * @const\n */\nvar goog = goog || {};\n\n\n/**\n * Reference to the global context.  In most cases this will be 'window'.\n */\ngoog.global = this;\n\n\n/**\n * A hook for overriding the define values in uncompiled mode.\n *\n * In uncompiled mode, {@code CLOSURE_UNCOMPILED_DEFINES} may be defined before\n * loading base.js.  If a key is defined in {@code CLOSURE_UNCOMPILED_DEFINES},\n * {@code goog.define} will use the value instead of the default value.  This\n * allows flags to be overwritten without compilation (this is normally\n * accomplished with the compiler's \"define\" flag).\n *\n * Example:\n * <pre>\n *   var CLOSURE_UNCOMPILED_DEFINES = {'goog.DEBUG': false};\n * </pre>\n *\n * @type {Object<string, (string|number|boolean)>|undefined}\n */\ngoog.global.CLOSURE_UNCOMPILED_DEFINES;\n\n\n/**\n * A hook for overriding the define values in uncompiled or compiled mode,\n * like CLOSURE_UNCOMPILED_DEFINES but effective in compiled code.  In\n * uncompiled code CLOSURE_UNCOMPILED_DEFINES takes precedence.\n *\n * Also unlike CLOSURE_UNCOMPILED_DEFINES the values must be number, boolean or\n * string literals or the compiler will emit an error.\n *\n * While any @define value may be set, only those set with goog.define will be\n * effective for uncompiled code.\n *\n * Example:\n * <pre>\n *   var CLOSURE_DEFINES = {'goog.DEBUG': false} ;\n * </pre>\n *\n * @type {Object<string, (string|number|boolean)>|undefined}\n */\ngoog.global.CLOSURE_DEFINES;\n\n\n/**\n * Returns true if the specified value is not undefined.\n * WARNING: Do not use this to test if an object has a property. Use the in\n * operator instead.\n *\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is defined.\n */\ngoog.isDef = function(val) {\n  // void 0 always evaluates to undefined and hence we do not need to depend on\n  // the definition of the global variable named 'undefined'.\n  return val !== void 0;\n};\n\n\n/**\n * Builds an object structure for the provided namespace path, ensuring that\n * names that already exist are not overwritten. For example:\n * \"a.b.c\" -> a = {};a.b={};a.b.c={};\n * Used by goog.provide and goog.exportSymbol.\n * @param {string} name name of the object that this file defines.\n * @param {*=} opt_object the object to expose at the end of the path.\n * @param {Object=} opt_objectToExportTo The object to add the path to; default\n *     is |goog.global|.\n * @private\n */\ngoog.exportPath_ = function(name, opt_object, opt_objectToExportTo) {\n  var parts = name.split('.');\n  var cur = opt_objectToExportTo || goog.global;\n\n  // Internet Explorer exhibits strange behavior when throwing errors from\n  // methods externed in this manner.  See the testExportSymbolExceptions in\n  // base_test.html for an example.\n  if (!(parts[0] in cur) && cur.execScript) {\n    cur.execScript('var ' + parts[0]);\n  }\n\n  // Certain browsers cannot parse code in the form for((a in b); c;);\n  // This pattern is produced by the JSCompiler when it collapses the\n  // statement above into the conditional loop below. To prevent this from\n  // happening, use a for-loop and reserve the init logic as below.\n\n  // Parentheses added to eliminate strict JS warning in Firefox.\n  for (var part; parts.length && (part = parts.shift());) {\n    if (!parts.length && goog.isDef(opt_object)) {\n      // last part and we have an object; use it\n      cur[part] = opt_object;\n    } else if (cur[part]) {\n      cur = cur[part];\n    } else {\n      cur = cur[part] = {};\n    }\n  }\n};\n\n\n/**\n * Defines a named value. In uncompiled mode, the value is retrieved from\n * CLOSURE_DEFINES or CLOSURE_UNCOMPILED_DEFINES if the object is defined and\n * has the property specified, and otherwise used the defined defaultValue.\n * When compiled the default can be overridden using the compiler\n * options or the value set in the CLOSURE_DEFINES object.\n *\n * @param {string} name The distinguished name to provide.\n * @param {string|number|boolean} defaultValue\n */\ngoog.define = function(name, defaultValue) {\n  var value = defaultValue;\n  if (!COMPILED) {\n    if (goog.global.CLOSURE_UNCOMPILED_DEFINES &&\n        Object.prototype.hasOwnProperty.call(\n            goog.global.CLOSURE_UNCOMPILED_DEFINES, name)) {\n      value = goog.global.CLOSURE_UNCOMPILED_DEFINES[name];\n    } else if (\n        goog.global.CLOSURE_DEFINES &&\n        Object.prototype.hasOwnProperty.call(\n            goog.global.CLOSURE_DEFINES, name)) {\n      value = goog.global.CLOSURE_DEFINES[name];\n    }\n  }\n  goog.exportPath_(name, value);\n};\n\n\n/**\n * @define {boolean} DEBUG is provided as a convenience so that debugging code\n * that should not be included in a production js_binary can be easily stripped\n * by specifying --define goog.DEBUG=false to the JSCompiler. For example, most\n * toString() methods should be declared inside an \"if (goog.DEBUG)\" conditional\n * because they are generally used for debugging purposes and it is difficult\n * for the JSCompiler to statically determine whether they are used.\n */\ngoog.define('goog.DEBUG', true);\n\n\n/**\n * @define {string} LOCALE defines the locale being used for compilation. It is\n * used to select locale specific data to be compiled in js binary. BUILD rule\n * can specify this value by \"--define goog.LOCALE=<locale_name>\" as JSCompiler\n * option.\n *\n * Take into account that the locale code format is important. You should use\n * the canonical Unicode format with hyphen as a delimiter. Language must be\n * lowercase, Language Script - Capitalized, Region - UPPERCASE.\n * There are few examples: pt-BR, en, en-US, sr-Latin-BO, zh-Hans-CN.\n *\n * See more info about locale codes here:\n * http://www.unicode.org/reports/tr35/#Unicode_Language_and_Locale_Identifiers\n *\n * For language codes you should use values defined by ISO 693-1. See it here\n * http://www.w3.org/WAI/ER/IG/ert/iso639.htm. There is only one exception from\n * this rule: the Hebrew language. For legacy reasons the old code (iw) should\n * be used instead of the new code (he), see http://wiki/Main/IIISynonyms.\n */\ngoog.define('goog.LOCALE', 'en');  // default to en\n\n\n/**\n * @define {boolean} Whether this code is running on trusted sites.\n *\n * On untrusted sites, several native functions can be defined or overridden by\n * external libraries like Prototype, Datejs, and JQuery and setting this flag\n * to false forces closure to use its own implementations when possible.\n *\n * If your JavaScript can be loaded by a third party site and you are wary about\n * relying on non-standard implementations, specify\n * \"--define goog.TRUSTED_SITE=false\" to the JSCompiler.\n */\ngoog.define('goog.TRUSTED_SITE', true);\n\n\n/**\n * @define {boolean} Whether a project is expected to be running in strict mode.\n *\n * This define can be used to trigger alternate implementations compatible with\n * running in EcmaScript Strict mode or warn about unavailable functionality.\n * @see https://goo.gl/PudQ4y\n *\n */\ngoog.define('goog.STRICT_MODE_COMPATIBLE', false);\n\n\n/**\n * @define {boolean} Whether code that calls {@link goog.setTestOnly} should\n *     be disallowed in the compilation unit.\n */\ngoog.define('goog.DISALLOW_TEST_ONLY_CODE', COMPILED && !goog.DEBUG);\n\n\n/**\n * @define {boolean} Whether to use a Chrome app CSP-compliant method for\n *     loading scripts via goog.require. @see appendScriptSrcNode_.\n */\ngoog.define('goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING', false);\n\n\n/**\n * Defines a namespace in Closure.\n *\n * A namespace may only be defined once in a codebase. It may be defined using\n * goog.provide() or goog.module().\n *\n * The presence of one or more goog.provide() calls in a file indicates\n * that the file defines the given objects/namespaces.\n * Provided symbols must not be null or undefined.\n *\n * In addition, goog.provide() creates the object stubs for a namespace\n * (for example, goog.provide(\"goog.foo.bar\") will create the object\n * goog.foo.bar if it does not already exist).\n *\n * Build tools also scan for provide/require/module statements\n * to discern dependencies, build dependency files (see deps.js), etc.\n *\n * @see goog.require\n * @see goog.module\n * @param {string} name Namespace provided by this file in the form\n *     \"goog.package.part\".\n */\ngoog.provide = function(name) {\n  if (goog.isInModuleLoader_()) {\n    throw Error('goog.provide can not be used within a goog.module.');\n  }\n  if (!COMPILED) {\n    // Ensure that the same namespace isn't provided twice.\n    // A goog.module/goog.provide maps a goog.require to a specific file\n    if (goog.isProvided_(name)) {\n      throw Error('Namespace \"' + name + '\" already declared.');\n    }\n  }\n\n  goog.constructNamespace_(name);\n};\n\n\n/**\n * @param {string} name Namespace provided by this file in the form\n *     \"goog.package.part\".\n * @param {Object=} opt_obj The object to embed in the namespace.\n * @private\n */\ngoog.constructNamespace_ = function(name, opt_obj) {\n  if (!COMPILED) {\n    delete goog.implicitNamespaces_[name];\n\n    var namespace = name;\n    while ((namespace = namespace.substring(0, namespace.lastIndexOf('.')))) {\n      if (goog.getObjectByName(namespace)) {\n        break;\n      }\n      goog.implicitNamespaces_[namespace] = true;\n    }\n  }\n\n  goog.exportPath_(name, opt_obj);\n};\n\n\n/**\n * Module identifier validation regexp.\n * Note: This is a conservative check, it is very possible to be more lenient,\n *   the primary exclusion here is \"/\" and \"\\\" and a leading \".\", these\n *   restrictions are intended to leave the door open for using goog.require\n *   with relative file paths rather than module identifiers.\n * @private\n */\ngoog.VALID_MODULE_RE_ = /^[a-zA-Z_$][a-zA-Z0-9._$]*$/;\n\n\n/**\n * Defines a module in Closure.\n *\n * Marks that this file must be loaded as a module and claims the namespace.\n *\n * A namespace may only be defined once in a codebase. It may be defined using\n * goog.provide() or goog.module().\n *\n * goog.module() has three requirements:\n * - goog.module may not be used in the same file as goog.provide.\n * - goog.module must be the first statement in the file.\n * - only one goog.module is allowed per file.\n *\n * When a goog.module annotated file is loaded, it is enclosed in\n * a strict function closure. This means that:\n * - any variables declared in a goog.module file are private to the file\n * (not global), though the compiler is expected to inline the module.\n * - The code must obey all the rules of \"strict\" JavaScript.\n * - the file will be marked as \"use strict\"\n *\n * NOTE: unlike goog.provide, goog.module does not declare any symbols by\n * itself. If declared symbols are desired, use\n * goog.module.declareLegacyNamespace().\n *\n *\n * See the public goog.module proposal: http://goo.gl/Va1hin\n *\n * @param {string} name Namespace provided by this file in the form\n *     \"goog.package.part\", is expected but not required.\n * @return {void}\n */\ngoog.module = function(name) {\n  if (!goog.isString(name) || !name ||\n      name.search(goog.VALID_MODULE_RE_) == -1) {\n    throw Error('Invalid module identifier');\n  }\n  if (!goog.isInModuleLoader_()) {\n    throw Error(\n        'Module ' + name + ' has been loaded incorrectly. Note, ' +\n        'modules cannot be loaded as normal scripts. They require some kind of ' +\n        'pre-processing step. You\\'re likely trying to load a module via a ' +\n        'script tag or as a part of a concatenated bundle without rewriting the ' +\n        'module. For more info see: ' +\n        'https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.');\n  }\n  if (goog.moduleLoaderState_.moduleName) {\n    throw Error('goog.module may only be called once per module.');\n  }\n\n  // Store the module name for the loader.\n  goog.moduleLoaderState_.moduleName = name;\n  if (!COMPILED) {\n    // Ensure that the same namespace isn't provided twice.\n    // A goog.module/goog.provide maps a goog.require to a specific file\n    if (goog.isProvided_(name)) {\n      throw Error('Namespace \"' + name + '\" already declared.');\n    }\n    delete goog.implicitNamespaces_[name];\n  }\n};\n\n\n/**\n * @param {string} name The module identifier.\n * @return {?} The module exports for an already loaded module or null.\n *\n * Note: This is not an alternative to goog.require, it does not\n * indicate a hard dependency, instead it is used to indicate\n * an optional dependency or to access the exports of a module\n * that has already been loaded.\n * @suppress {missingProvide}\n */\ngoog.module.get = function(name) {\n  return goog.module.getInternal_(name);\n};\n\n\n/**\n * @param {string} name The module identifier.\n * @return {?} The module exports for an already loaded module or null.\n * @private\n */\ngoog.module.getInternal_ = function(name) {\n  if (!COMPILED) {\n    if (name in goog.loadedModules_) {\n      return goog.loadedModules_[name];\n    } else if (!goog.implicitNamespaces_[name]) {\n      var ns = goog.getObjectByName(name);\n      return ns != null ? ns : null;\n    }\n  }\n  return null;\n};\n\n\n/**\n * @private {?{moduleName: (string|undefined), declareLegacyNamespace:boolean}}\n */\ngoog.moduleLoaderState_ = null;\n\n\n/**\n * @private\n * @return {boolean} Whether a goog.module is currently being initialized.\n */\ngoog.isInModuleLoader_ = function() {\n  return goog.moduleLoaderState_ != null;\n};\n\n\n/**\n * Provide the module's exports as a globally accessible object under the\n * module's declared name.  This is intended to ease migration to goog.module\n * for files that have existing usages.\n * @suppress {missingProvide}\n */\ngoog.module.declareLegacyNamespace = function() {\n  if (!COMPILED && !goog.isInModuleLoader_()) {\n    throw new Error(\n        'goog.module.declareLegacyNamespace must be called from ' +\n        'within a goog.module');\n  }\n  if (!COMPILED && !goog.moduleLoaderState_.moduleName) {\n    throw Error(\n        'goog.module must be called prior to ' +\n        'goog.module.declareLegacyNamespace.');\n  }\n  goog.moduleLoaderState_.declareLegacyNamespace = true;\n};\n\n\n/**\n * Marks that the current file should only be used for testing, and never for\n * live code in production.\n *\n * In the case of unit tests, the message may optionally be an exact namespace\n * for the test (e.g. 'goog.stringTest'). The linter will then ignore the extra\n * provide (if not explicitly defined in the code).\n *\n * @param {string=} opt_message Optional message to add to the error that's\n *     raised when used in production code.\n */\ngoog.setTestOnly = function(opt_message) {\n  if (goog.DISALLOW_TEST_ONLY_CODE) {\n    opt_message = opt_message || '';\n    throw Error(\n        'Importing test-only code into non-debug environment' +\n        (opt_message ? ': ' + opt_message : '.'));\n  }\n};\n\n\n/**\n * Forward declares a symbol. This is an indication to the compiler that the\n * symbol may be used in the source yet is not required and may not be provided\n * in compilation.\n *\n * The most common usage of forward declaration is code that takes a type as a\n * function parameter but does not need to require it. By forward declaring\n * instead of requiring, no hard dependency is made, and (if not required\n * elsewhere) the namespace may never be required and thus, not be pulled\n * into the JavaScript binary. If it is required elsewhere, it will be type\n * checked as normal.\n *\n * Before using goog.forwardDeclare, please read the documentation at\n * https://github.com/google/closure-compiler/wiki/Bad-Type-Annotation to\n * understand the options and tradeoffs when working with forward declarations.\n *\n * @param {string} name The namespace to forward declare in the form of\n *     \"goog.package.part\".\n */\ngoog.forwardDeclare = function(name) {};\n\n\n/**\n * Forward declare type information. Used to assign types to goog.global\n * referenced object that would otherwise result in unknown type references\n * and thus block property disambiguation.\n */\ngoog.forwardDeclare('Document');\ngoog.forwardDeclare('HTMLScriptElement');\ngoog.forwardDeclare('XMLHttpRequest');\n\n\nif (!COMPILED) {\n  /**\n   * Check if the given name has been goog.provided. This will return false for\n   * names that are available only as implicit namespaces.\n   * @param {string} name name of the object to look for.\n   * @return {boolean} Whether the name has been provided.\n   * @private\n   */\n  goog.isProvided_ = function(name) {\n    return (name in goog.loadedModules_) ||\n        (!goog.implicitNamespaces_[name] &&\n         goog.isDefAndNotNull(goog.getObjectByName(name)));\n  };\n\n  /**\n   * Namespaces implicitly defined by goog.provide. For example,\n   * goog.provide('goog.events.Event') implicitly declares that 'goog' and\n   * 'goog.events' must be namespaces.\n   *\n   * @type {!Object<string, (boolean|undefined)>}\n   * @private\n   */\n  goog.implicitNamespaces_ = {'goog.module': true};\n\n  // NOTE: We add goog.module as an implicit namespace as goog.module is defined\n  // here and because the existing module package has not been moved yet out of\n  // the goog.module namespace. This satisifies both the debug loader and\n  // ahead-of-time dependency management.\n}\n\n\n/**\n * Returns an object based on its fully qualified external name.  The object\n * is not found if null or undefined.  If you are using a compilation pass that\n * renames property names beware that using this function will not find renamed\n * properties.\n *\n * @param {string} name The fully qualified name.\n * @param {Object=} opt_obj The object within which to look; default is\n *     |goog.global|.\n * @return {?} The value (object or primitive) or, if not found, null.\n */\ngoog.getObjectByName = function(name, opt_obj) {\n  var parts = name.split('.');\n  var cur = opt_obj || goog.global;\n  for (var part; part = parts.shift();) {\n    if (goog.isDefAndNotNull(cur[part])) {\n      cur = cur[part];\n    } else {\n      return null;\n    }\n  }\n  return cur;\n};\n\n\n/**\n * Globalizes a whole namespace, such as goog or goog.lang.\n *\n * @param {!Object} obj The namespace to globalize.\n * @param {Object=} opt_global The object to add the properties to.\n * @deprecated Properties may be explicitly exported to the global scope, but\n *     this should no longer be done in bulk.\n */\ngoog.globalize = function(obj, opt_global) {\n  var global = opt_global || goog.global;\n  for (var x in obj) {\n    global[x] = obj[x];\n  }\n};\n\n\n/**\n * Adds a dependency from a file to the files it requires.\n * @param {string} relPath The path to the js file.\n * @param {!Array<string>} provides An array of strings with\n *     the names of the objects this file provides.\n * @param {!Array<string>} requires An array of strings with\n *     the names of the objects this file requires.\n * @param {boolean|!Object<string>=} opt_loadFlags Parameters indicating\n *     how the file must be loaded.  The boolean 'true' is equivalent\n *     to {'module': 'goog'} for backwards-compatibility.  Valid properties\n *     and values include {'module': 'goog'} and {'lang': 'es6'}.\n */\ngoog.addDependency = function(relPath, provides, requires, opt_loadFlags) {\n  if (goog.DEPENDENCIES_ENABLED) {\n    var provide, require;\n    var path = relPath.replace(/\\\\/g, '/');\n    var deps = goog.dependencies_;\n    if (!opt_loadFlags || typeof opt_loadFlags === 'boolean') {\n      opt_loadFlags = opt_loadFlags ? {'module': 'goog'} : {};\n    }\n    for (var i = 0; provide = provides[i]; i++) {\n      deps.nameToPath[provide] = path;\n      deps.loadFlags[path] = opt_loadFlags;\n    }\n    for (var j = 0; require = requires[j]; j++) {\n      if (!(path in deps.requires)) {\n        deps.requires[path] = {};\n      }\n      deps.requires[path][require] = true;\n    }\n  }\n};\n\n\n\n\n// NOTE(nnaze): The debug DOM loader was included in base.js as an original way\n// to do \"debug-mode\" development.  The dependency system can sometimes be\n// confusing, as can the debug DOM loader's asynchronous nature.\n//\n// With the DOM loader, a call to goog.require() is not blocking -- the script\n// will not load until some point after the current script.  If a namespace is\n// needed at runtime, it needs to be defined in a previous script, or loaded via\n// require() with its registered dependencies.\n//\n// User-defined namespaces may need their own deps file. For a reference on\n// creating a deps file, see:\n// Externally: https://developers.google.com/closure/library/docs/depswriter\n//\n// Because of legacy clients, the DOM loader can't be easily removed from\n// base.js.  Work is being done to make it disableable or replaceable for\n// different environments (DOM-less JavaScript interpreters like Rhino or V8,\n// for example). See bootstrap/ for more information.\n\n\n/**\n * @define {boolean} Whether to enable the debug loader.\n *\n * If enabled, a call to goog.require() will attempt to load the namespace by\n * appending a script tag to the DOM (if the namespace has been registered).\n *\n * If disabled, goog.require() will simply assert that the namespace has been\n * provided (and depend on the fact that some outside tool correctly ordered\n * the script).\n */\ngoog.define('goog.ENABLE_DEBUG_LOADER', true);\n\n\n/**\n * @param {string} msg\n * @private\n */\ngoog.logToConsole_ = function(msg) {\n  if (goog.global.console) {\n    goog.global.console['error'](msg);\n  }\n};\n\n\n/**\n * Implements a system for the dynamic resolution of dependencies that works in\n * parallel with the BUILD system. Note that all calls to goog.require will be\n * stripped by the JSCompiler when the --process_closure_primitives option is\n * used.\n * @see goog.provide\n * @param {string} name Namespace to include (as was given in goog.provide()) in\n *     the form \"goog.package.part\".\n * @return {?} If called within a goog.module file, the associated namespace or\n *     module otherwise null.\n */\ngoog.require = function(name) {\n  // If the object already exists we do not need do do anything.\n  if (!COMPILED) {\n    if (goog.ENABLE_DEBUG_LOADER && goog.IS_OLD_IE_) {\n      goog.maybeProcessDeferredDep_(name);\n    }\n\n    if (goog.isProvided_(name)) {\n      if (goog.isInModuleLoader_()) {\n        return goog.module.getInternal_(name);\n      }\n    } else if (goog.ENABLE_DEBUG_LOADER) {\n      var path = goog.getPathFromDeps_(name);\n      if (path) {\n        goog.writeScripts_(path);\n      } else {\n        var errorMessage = 'goog.require could not find: ' + name;\n        goog.logToConsole_(errorMessage);\n\n        throw Error(errorMessage);\n      }\n    }\n\n    return null;\n  }\n};\n\n\n/**\n * Path for included scripts.\n * @type {string}\n */\ngoog.basePath = '';\n\n\n/**\n * A hook for overriding the base path.\n * @type {string|undefined}\n */\ngoog.global.CLOSURE_BASE_PATH;\n\n\n/**\n * Whether to write out Closure's deps file. By default, the deps are written.\n * @type {boolean|undefined}\n */\ngoog.global.CLOSURE_NO_DEPS;\n\n\n/**\n * A function to import a single script. This is meant to be overridden when\n * Closure is being run in non-HTML contexts, such as web workers. It's defined\n * in the global scope so that it can be set before base.js is loaded, which\n * allows deps.js to be imported properly.\n *\n * The function is passed the script source, which is a relative URI. It should\n * return true if the script was imported, false otherwise.\n * @type {(function(string): boolean)|undefined}\n */\ngoog.global.CLOSURE_IMPORT_SCRIPT;\n\n\n/**\n * Null function used for default values of callbacks, etc.\n * @return {void} Nothing.\n */\ngoog.nullFunction = function() {};\n\n\n/**\n * When defining a class Foo with an abstract method bar(), you can do:\n * Foo.prototype.bar = goog.abstractMethod\n *\n * Now if a subclass of Foo fails to override bar(), an error will be thrown\n * when bar() is invoked.\n *\n * Note: This does not take the name of the function to override as an argument\n * because that would make it more difficult to obfuscate our JavaScript code.\n *\n * @type {!Function}\n * @throws {Error} when invoked to indicate the method should be overridden.\n */\ngoog.abstractMethod = function() {\n  throw Error('unimplemented abstract method');\n};\n\n\n/**\n * Adds a {@code getInstance} static method that always returns the same\n * instance object.\n * @param {!Function} ctor The constructor for the class to add the static\n *     method to.\n */\ngoog.addSingletonGetter = function(ctor) {\n  // instance_ is immediately set to prevent issues with sealed constructors\n  // such as are encountered when a constructor is returned as the export object\n  // of a goog.module in unoptimized code.\n  ctor.instance_ = undefined;\n  ctor.getInstance = function() {\n    if (ctor.instance_) {\n      return ctor.instance_;\n    }\n    if (goog.DEBUG) {\n      // NOTE: JSCompiler can't optimize away Array#push.\n      goog.instantiatedSingletons_[goog.instantiatedSingletons_.length] = ctor;\n    }\n    return ctor.instance_ = new ctor;\n  };\n};\n\n\n/**\n * All singleton classes that have been instantiated, for testing. Don't read\n * it directly, use the {@code goog.testing.singleton} module. The compiler\n * removes this variable if unused.\n * @type {!Array<!Function>}\n * @private\n */\ngoog.instantiatedSingletons_ = [];\n\n\n/**\n * @define {boolean} Whether to load goog.modules using {@code eval} when using\n * the debug loader.  This provides a better debugging experience as the\n * source is unmodified and can be edited using Chrome Workspaces or similar.\n * However in some environments the use of {@code eval} is banned\n * so we provide an alternative.\n */\ngoog.define('goog.LOAD_MODULE_USING_EVAL', true);\n\n\n/**\n * @define {boolean} Whether the exports of goog.modules should be sealed when\n * possible.\n */\ngoog.define('goog.SEAL_MODULE_EXPORTS', goog.DEBUG);\n\n\n/**\n * The registry of initialized modules:\n * the module identifier to module exports map.\n * @private @const {!Object<string, ?>}\n */\ngoog.loadedModules_ = {};\n\n\n/**\n * True if goog.dependencies_ is available.\n * @const {boolean}\n */\ngoog.DEPENDENCIES_ENABLED = !COMPILED && goog.ENABLE_DEBUG_LOADER;\n\n\n/**\n * @define {string} How to decide whether to transpile.  Valid values\n * are 'always', 'never', and 'detect'.  The default ('detect') is to\n * use feature detection to determine which language levels need\n * transpilation.\n */\n// NOTE(user): we could expand this to accept a language level to bypass\n// detection: e.g. goog.TRANSPILE == 'es5' would transpile ES6 files but\n// would leave ES3 and ES5 files alone.\ngoog.define('goog.TRANSPILE', 'detect');\n\n\n/**\n * @define {string} Path to the transpiler.  Executing the script at this\n * path (relative to base.js) should define a function $jscomp.transpile.\n */\ngoog.define('goog.TRANSPILER', 'transpile.js');\n\n\nif (goog.DEPENDENCIES_ENABLED) {\n  /**\n   * This object is used to keep track of dependencies and other data that is\n   * used for loading scripts.\n   * @private\n   * @type {{\n   *   loadFlags: !Object<string, !Object<string, string>>,\n   *   nameToPath: !Object<string, string>,\n   *   requires: !Object<string, !Object<string, boolean>>,\n   *   visited: !Object<string, boolean>,\n   *   written: !Object<string, boolean>,\n   *   deferred: !Object<string, string>\n   * }}\n   */\n  goog.dependencies_ = {\n    loadFlags: {},  // 1 to 1\n\n    nameToPath: {},  // 1 to 1\n\n    requires: {},  // 1 to many\n\n    // Used when resolving dependencies to prevent us from visiting file twice.\n    visited: {},\n\n    written: {},  // Used to keep track of script files we have written.\n\n    deferred: {}  // Used to track deferred module evaluations in old IEs\n  };\n\n\n  /**\n   * Tries to detect whether is in the context of an HTML document.\n   * @return {boolean} True if it looks like HTML document.\n   * @private\n   */\n  goog.inHtmlDocument_ = function() {\n    /** @type {Document} */\n    var doc = goog.global.document;\n    return doc != null && 'write' in doc;  // XULDocument misses write.\n  };\n\n\n  /**\n   * Tries to detect the base path of base.js script that bootstraps Closure.\n   * @private\n   */\n  goog.findBasePath_ = function() {\n    if (goog.isDef(goog.global.CLOSURE_BASE_PATH)) {\n      goog.basePath = goog.global.CLOSURE_BASE_PATH;\n      return;\n    } else if (!goog.inHtmlDocument_()) {\n      return;\n    }\n    /** @type {Document} */\n    var doc = goog.global.document;\n    var scripts = doc.getElementsByTagName('SCRIPT');\n    // Search backwards since the current script is in almost all cases the one\n    // that has base.js.\n    for (var i = scripts.length - 1; i >= 0; --i) {\n      var script = /** @type {!HTMLScriptElement} */ (scripts[i]);\n      var src = script.src;\n      var qmark = src.lastIndexOf('?');\n      var l = qmark == -1 ? src.length : qmark;\n      if (src.substr(l - 7, 7) == 'base.js') {\n        goog.basePath = src.substr(0, l - 7);\n        return;\n      }\n    }\n  };\n\n\n  /**\n   * Imports a script if, and only if, that script hasn't already been imported.\n   * (Must be called at execution time)\n   * @param {string} src Script source.\n   * @param {string=} opt_sourceText The optionally source text to evaluate\n   * @private\n   */\n  goog.importScript_ = function(src, opt_sourceText) {\n    var importScript =\n        goog.global.CLOSURE_IMPORT_SCRIPT || goog.writeScriptTag_;\n    if (importScript(src, opt_sourceText)) {\n      goog.dependencies_.written[src] = true;\n    }\n  };\n\n\n  /**\n   * Whether the browser is IE9 or earlier, which needs special handling\n   * for deferred modules.\n   * @const @private {boolean}\n   */\n  goog.IS_OLD_IE_ =\n      !!(!goog.global.atob && goog.global.document && goog.global.document.all);\n\n\n  /**\n   * Given a URL initiate retrieval and execution of a script that needs\n   * pre-processing.\n   * @param {string} src Script source URL.\n   * @param {boolean} isModule Whether this is a goog.module.\n   * @param {boolean} needsTranspile Whether this source needs transpilation.\n   * @private\n   */\n  goog.importProcessedScript_ = function(src, isModule, needsTranspile) {\n    // In an attempt to keep browsers from timing out loading scripts using\n    // synchronous XHRs, put each load in its own script block.\n    var bootstrap = 'goog.retrieveAndExec_(\"' + src + '\", ' + isModule + ', ' +\n        needsTranspile + ');';\n\n    goog.importScript_('', bootstrap);\n  };\n\n\n  /** @private {!Array<string>} */\n  goog.queuedModules_ = [];\n\n\n  /**\n   * Return an appropriate module text. Suitable to insert into\n   * a script tag (that is unescaped).\n   * @param {string} srcUrl\n   * @param {string} scriptText\n   * @return {string}\n   * @private\n   */\n  goog.wrapModule_ = function(srcUrl, scriptText) {\n    if (!goog.LOAD_MODULE_USING_EVAL || !goog.isDef(goog.global.JSON)) {\n      return '' +\n          'goog.loadModule(function(exports) {' +\n          '\"use strict\";' + scriptText +\n          '\\n' +  // terminate any trailing single line comment.\n          ';return exports' +\n          '});' +\n          '\\n//# sourceURL=' + srcUrl + '\\n';\n    } else {\n      return '' +\n          'goog.loadModule(' +\n          goog.global.JSON.stringify(\n              scriptText + '\\n//# sourceURL=' + srcUrl + '\\n') +\n          ');';\n    }\n  };\n\n  // On IE9 and earlier, it is necessary to handle\n  // deferred module loads. In later browsers, the\n  // code to be evaluated is simply inserted as a script\n  // block in the correct order. To eval deferred\n  // code at the right time, we piggy back on goog.require to call\n  // goog.maybeProcessDeferredDep_.\n  //\n  // The goog.requires are used both to bootstrap\n  // the loading process (when no deps are available) and\n  // declare that they should be available.\n  //\n  // Here we eval the sources, if all the deps are available\n  // either already eval'd or goog.require'd.  This will\n  // be the case when all the dependencies have already\n  // been loaded, and the dependent module is loaded.\n  //\n  // But this alone isn't sufficient because it is also\n  // necessary to handle the case where there is no root\n  // that is not deferred.  For that there we register for an event\n  // and trigger goog.loadQueuedModules_ handle any remaining deferred\n  // evaluations.\n\n  /**\n   * Handle any remaining deferred goog.module evals.\n   * @private\n   */\n  goog.loadQueuedModules_ = function() {\n    var count = goog.queuedModules_.length;\n    if (count > 0) {\n      var queue = goog.queuedModules_;\n      goog.queuedModules_ = [];\n      for (var i = 0; i < count; i++) {\n        var path = queue[i];\n        goog.maybeProcessDeferredPath_(path);\n      }\n    }\n  };\n\n\n  /**\n   * Eval the named module if its dependencies are\n   * available.\n   * @param {string} name The module to load.\n   * @private\n   */\n  goog.maybeProcessDeferredDep_ = function(name) {\n    if (goog.isDeferredModule_(name) && goog.allDepsAreAvailable_(name)) {\n      var path = goog.getPathFromDeps_(name);\n      goog.maybeProcessDeferredPath_(goog.basePath + path);\n    }\n  };\n\n  /**\n   * @param {string} name The module to check.\n   * @return {boolean} Whether the name represents a\n   *     module whose evaluation has been deferred.\n   * @private\n   */\n  goog.isDeferredModule_ = function(name) {\n    var path = goog.getPathFromDeps_(name);\n    var loadFlags = path && goog.dependencies_.loadFlags[path] || {};\n    var languageLevel = loadFlags['lang'] || 'es3';\n    if (path && (loadFlags['module'] == 'goog' ||\n                 goog.needsTranspile_(languageLevel))) {\n      var abspath = goog.basePath + path;\n      return (abspath) in goog.dependencies_.deferred;\n    }\n    return false;\n  };\n\n  /**\n   * @param {string} name The module to check.\n   * @return {boolean} Whether the name represents a\n   *     module whose declared dependencies have all been loaded\n   *     (eval'd or a deferred module load)\n   * @private\n   */\n  goog.allDepsAreAvailable_ = function(name) {\n    var path = goog.getPathFromDeps_(name);\n    if (path && (path in goog.dependencies_.requires)) {\n      for (var requireName in goog.dependencies_.requires[path]) {\n        if (!goog.isProvided_(requireName) &&\n            !goog.isDeferredModule_(requireName)) {\n          return false;\n        }\n      }\n    }\n    return true;\n  };\n\n\n  /**\n   * @param {string} abspath\n   * @private\n   */\n  goog.maybeProcessDeferredPath_ = function(abspath) {\n    if (abspath in goog.dependencies_.deferred) {\n      var src = goog.dependencies_.deferred[abspath];\n      delete goog.dependencies_.deferred[abspath];\n      goog.globalEval(src);\n    }\n  };\n\n\n  /**\n   * Load a goog.module from the provided URL.  This is not a general purpose\n   * code loader and does not support late loading code, that is it should only\n   * be used during page load. This method exists to support unit tests and\n   * \"debug\" loaders that would otherwise have inserted script tags. Under the\n   * hood this needs to use a synchronous XHR and is not recommeneded for\n   * production code.\n   *\n   * The module's goog.requires must have already been satisified; an exception\n   * will be thrown if this is not the case. This assumption is that no\n   * \"deps.js\" file exists, so there is no way to discover and locate the\n   * module-to-be-loaded's dependencies and no attempt is made to do so.\n   *\n   * There should only be one attempt to load a module.  If\n   * \"goog.loadModuleFromUrl\" is called for an already loaded module, an\n   * exception will be throw.\n   *\n   * @param {string} url The URL from which to attempt to load the goog.module.\n   */\n  goog.loadModuleFromUrl = function(url) {\n    // Because this executes synchronously, we don't need to do any additional\n    // bookkeeping. When \"goog.loadModule\" the namespace will be marked as\n    // having been provided which is sufficient.\n    goog.retrieveAndExec_(url, true, false);\n  };\n\n\n  /**\n   * Writes a new script pointing to {@code src} directly into the DOM.\n   *\n   * NOTE: This method is not CSP-compliant. @see goog.appendScriptSrcNode_ for\n   * the fallback mechanism.\n   *\n   * @param {string} src The script URL.\n   * @private\n   */\n  goog.writeScriptSrcNode_ = function(src) {\n    goog.global.document.write(\n        '<script type=\"text/javascript\" src=\"' + src + '\"></' +\n        'script>');\n  };\n\n\n  /**\n   * Appends a new script node to the DOM using a CSP-compliant mechanism. This\n   * method exists as a fallback for document.write (which is not allowed in a\n   * strict CSP context, e.g., Chrome apps).\n   *\n   * NOTE: This method is not analogous to using document.write to insert a\n   * <script> tag; specifically, the user agent will execute a script added by\n   * document.write immediately after the current script block finishes\n   * executing, whereas the DOM-appended script node will not be executed until\n   * the entire document is parsed and executed. That is to say, this script is\n   * added to the end of the script execution queue.\n   *\n   * The page must not attempt to call goog.required entities until after the\n   * document has loaded, e.g., in or after the window.onload callback.\n   *\n   * @param {string} src The script URL.\n   * @private\n   */\n  goog.appendScriptSrcNode_ = function(src) {\n    /** @type {Document} */\n    var doc = goog.global.document;\n    var scriptEl =\n        /** @type {HTMLScriptElement} */ (doc.createElement('script'));\n    scriptEl.type = 'text/javascript';\n    scriptEl.src = src;\n    scriptEl.defer = false;\n    scriptEl.async = false;\n    doc.head.appendChild(scriptEl);\n  };\n\n\n  /**\n   * The default implementation of the import function. Writes a script tag to\n   * import the script.\n   *\n   * @param {string} src The script url.\n   * @param {string=} opt_sourceText The optionally source text to evaluate\n   * @return {boolean} True if the script was imported, false otherwise.\n   * @private\n   */\n  goog.writeScriptTag_ = function(src, opt_sourceText) {\n    if (goog.inHtmlDocument_()) {\n      /** @type {!HTMLDocument} */\n      var doc = goog.global.document;\n\n      // If the user tries to require a new symbol after document load,\n      // something has gone terribly wrong. Doing a document.write would\n      // wipe out the page. This does not apply to the CSP-compliant method\n      // of writing script tags.\n      if (!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING &&\n          doc.readyState == 'complete') {\n        // Certain test frameworks load base.js multiple times, which tries\n        // to write deps.js each time. If that happens, just fail silently.\n        // These frameworks wipe the page between each load of base.js, so this\n        // is OK.\n        var isDeps = /\\bdeps.js$/.test(src);\n        if (isDeps) {\n          return false;\n        } else {\n          throw Error('Cannot write \"' + src + '\" after document load');\n        }\n      }\n\n      if (opt_sourceText === undefined) {\n        if (!goog.IS_OLD_IE_) {\n          if (goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING) {\n            goog.appendScriptSrcNode_(src);\n          } else {\n            goog.writeScriptSrcNode_(src);\n          }\n        } else {\n          var state = ' onreadystatechange=\\'goog.onScriptLoad_(this, ' +\n              ++goog.lastNonModuleScriptIndex_ + ')\\' ';\n          doc.write(\n              '<script type=\"text/javascript\" src=\"' + src + '\"' + state +\n              '></' +\n              'script>');\n        }\n      } else {\n        doc.write(\n            '<script type=\"text/javascript\">' +\n            goog.protectScriptTag_(opt_sourceText) + '</' +\n            'script>');\n      }\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  /**\n   * Rewrites closing script tags in input to avoid ending an enclosing script\n   * tag.\n   *\n   * @param {string} str\n   * @return {string}\n   * @private\n   */\n  goog.protectScriptTag_ = function(str) {\n    return str.replace(/<\\/(SCRIPT)/ig, '\\\\x3c\\\\$1');\n  };\n\n  /**\n   * Determines whether the given language needs to be transpiled.\n   * @param {string} lang\n   * @return {boolean}\n   * @private\n   */\n  goog.needsTranspile_ = function(lang) {\n    if (goog.TRANSPILE == 'always') {\n      return true;\n    } else if (goog.TRANSPILE == 'never') {\n      return false;\n    } else if (!goog.requiresTranspilation_) {\n      goog.requiresTranspilation_ = goog.createRequiresTranspilation_();\n    }\n    if (lang in goog.requiresTranspilation_) {\n      return goog.requiresTranspilation_[lang];\n    } else {\n      throw new Error('Unknown language mode: ' + lang);\n    }\n  };\n\n  /** @private {?Object<string, boolean>} */\n  goog.requiresTranspilation_ = null;\n\n\n  /** @private {number} */\n  goog.lastNonModuleScriptIndex_ = 0;\n\n\n  /**\n   * A readystatechange handler for legacy IE\n   * @param {!HTMLScriptElement} script\n   * @param {number} scriptIndex\n   * @return {boolean}\n   * @private\n   */\n  goog.onScriptLoad_ = function(script, scriptIndex) {\n    // for now load the modules when we reach the last script,\n    // later allow more inter-mingling.\n    if (script.readyState == 'complete' &&\n        goog.lastNonModuleScriptIndex_ == scriptIndex) {\n      goog.loadQueuedModules_();\n    }\n    return true;\n  };\n\n  /**\n   * Resolves dependencies based on the dependencies added using addDependency\n   * and calls importScript_ in the correct order.\n   * @param {string} pathToLoad The path from which to start discovering\n   *     dependencies.\n   * @private\n   */\n  goog.writeScripts_ = function(pathToLoad) {\n    /** @type {!Array<string>} The scripts we need to write this time. */\n    var scripts = [];\n    var seenScript = {};\n    var deps = goog.dependencies_;\n\n    /** @param {string} path */\n    function visitNode(path) {\n      if (path in deps.written) {\n        return;\n      }\n\n      // We have already visited this one. We can get here if we have cyclic\n      // dependencies.\n      if (path in deps.visited) {\n        return;\n      }\n\n      deps.visited[path] = true;\n\n      if (path in deps.requires) {\n        for (var requireName in deps.requires[path]) {\n          // If the required name is defined, we assume that it was already\n          // bootstrapped by other means.\n          if (!goog.isProvided_(requireName)) {\n            if (requireName in deps.nameToPath) {\n              visitNode(deps.nameToPath[requireName]);\n            } else {\n              throw Error('Undefined nameToPath for ' + requireName);\n            }\n          }\n        }\n      }\n\n      if (!(path in seenScript)) {\n        seenScript[path] = true;\n        scripts.push(path);\n      }\n    }\n\n    visitNode(pathToLoad);\n\n    // record that we are going to load all these scripts.\n    for (var i = 0; i < scripts.length; i++) {\n      var path = scripts[i];\n      goog.dependencies_.written[path] = true;\n    }\n\n    // If a module is loaded synchronously then we need to\n    // clear the current inModuleLoader value, and restore it when we are\n    // done loading the current \"requires\".\n    var moduleState = goog.moduleLoaderState_;\n    goog.moduleLoaderState_ = null;\n\n    for (var i = 0; i < scripts.length; i++) {\n      var path = scripts[i];\n      if (path) {\n        var loadFlags = deps.loadFlags[path] || {};\n        var languageLevel = loadFlags['lang'] || 'es3';\n        var needsTranspile = goog.needsTranspile_(languageLevel);\n        if (loadFlags['module'] == 'goog' || needsTranspile) {\n          goog.importProcessedScript_(\n              goog.basePath + path, loadFlags['module'] == 'goog',\n              needsTranspile);\n        } else {\n          goog.importScript_(goog.basePath + path);\n        }\n      } else {\n        goog.moduleLoaderState_ = moduleState;\n        throw Error('Undefined script input');\n      }\n    }\n\n    // restore the current \"module loading state\"\n    goog.moduleLoaderState_ = moduleState;\n  };\n\n\n  /**\n   * Looks at the dependency rules and tries to determine the script file that\n   * fulfills a particular rule.\n   * @param {string} rule In the form goog.namespace.Class or project.script.\n   * @return {?string} Url corresponding to the rule, or null.\n   * @private\n   */\n  goog.getPathFromDeps_ = function(rule) {\n    if (rule in goog.dependencies_.nameToPath) {\n      return goog.dependencies_.nameToPath[rule];\n    } else {\n      return null;\n    }\n  };\n\n  goog.findBasePath_();\n\n  // Allow projects to manage the deps files themselves.\n  if (!goog.global.CLOSURE_NO_DEPS) {\n    goog.importScript_(goog.basePath + 'deps.js');\n  }\n}\n\n\n/**\n * @param {function(?):?|string} moduleDef The module definition.\n */\ngoog.loadModule = function(moduleDef) {\n  // NOTE: we allow function definitions to be either in the from\n  // of a string to eval (which keeps the original source intact) or\n  // in a eval forbidden environment (CSP) we allow a function definition\n  // which in its body must call {@code goog.module}, and return the exports\n  // of the module.\n  var previousState = goog.moduleLoaderState_;\n  try {\n    goog.moduleLoaderState_ = {\n      moduleName: undefined,\n      declareLegacyNamespace: false\n    };\n    var exports;\n    if (goog.isFunction(moduleDef)) {\n      exports = moduleDef.call(undefined, {});\n    } else if (goog.isString(moduleDef)) {\n      exports = goog.loadModuleFromSource_.call(undefined, moduleDef);\n    } else {\n      throw Error('Invalid module definition');\n    }\n\n    var moduleName = goog.moduleLoaderState_.moduleName;\n    if (!goog.isString(moduleName) || !moduleName) {\n      throw Error('Invalid module name \\\"' + moduleName + '\\\"');\n    }\n\n    // Don't seal legacy namespaces as they may be uses as a parent of\n    // another namespace\n    if (goog.moduleLoaderState_.declareLegacyNamespace) {\n      goog.constructNamespace_(moduleName, exports);\n    } else if (\n        goog.SEAL_MODULE_EXPORTS && Object.seal && goog.isObject(exports)) {\n      Object.seal(exports);\n    }\n\n    goog.loadedModules_[moduleName] = exports;\n  } finally {\n    goog.moduleLoaderState_ = previousState;\n  }\n};\n\n\n/**\n * @private @const {function(string):?}\n *\n * The new type inference warns because this function has no formal\n * parameters, but its jsdoc says that it takes one argument.\n * (The argument is used via arguments[0], but NTI does not detect this.)\n * @suppress {newCheckTypes}\n */\ngoog.loadModuleFromSource_ = function() {\n  // NOTE: we avoid declaring parameters or local variables here to avoid\n  // masking globals or leaking values into the module definition.\n  'use strict';\n  var exports = {};\n  eval(arguments[0]);\n  return exports;\n};\n\n\n/**\n * Normalize a file path by removing redundant \"..\" and extraneous \".\" file\n * path components.\n * @param {string} path\n * @return {string}\n * @private\n */\ngoog.normalizePath_ = function(path) {\n  var components = path.split('/');\n  var i = 0;\n  while (i < components.length) {\n    if (components[i] == '.') {\n      components.splice(i, 1);\n    } else if (\n        i && components[i] == '..' && components[i - 1] &&\n        components[i - 1] != '..') {\n      components.splice(--i, 2);\n    } else {\n      i++;\n    }\n  }\n  return components.join('/');\n};\n\n\n/**\n * Loads file by synchronous XHR. Should not be used in production environments.\n * @param {string} src Source URL.\n * @return {?string} File contents, or null if load failed.\n * @private\n */\ngoog.loadFileSync_ = function(src) {\n  if (goog.global.CLOSURE_LOAD_FILE_SYNC) {\n    return goog.global.CLOSURE_LOAD_FILE_SYNC(src);\n  } else {\n    try {\n      /** @type {XMLHttpRequest} */\n      var xhr = new goog.global['XMLHttpRequest']();\n      xhr.open('get', src, false);\n      xhr.send();\n      // NOTE: Successful http: requests have a status of 200, but successful\n      // file: requests may have a status of zero.  Any other status, or a\n      // thrown exception (particularly in case of file: requests) indicates\n      // some sort of error, which we treat as a missing or unavailable file.\n      return xhr.status == 0 || xhr.status == 200 ? xhr.responseText : null;\n    } catch (err) {\n      // No need to rethrow or log, since errors should show up on their own.\n      return null;\n    }\n  }\n};\n\n\n/**\n * Retrieve and execute a script that needs some sort of wrapping.\n * @param {string} src Script source URL.\n * @param {boolean} isModule Whether to load as a module.\n * @param {boolean} needsTranspile Whether to transpile down to ES3.\n * @private\n */\ngoog.retrieveAndExec_ = function(src, isModule, needsTranspile) {\n  if (!COMPILED) {\n    // The full but non-canonicalized URL for later use.\n    var originalPath = src;\n    // Canonicalize the path, removing any /./ or /../ since Chrome's debugging\n    // console doesn't auto-canonicalize XHR loads as it does <script> srcs.\n    src = goog.normalizePath_(src);\n\n    var importScript =\n        goog.global.CLOSURE_IMPORT_SCRIPT || goog.writeScriptTag_;\n\n    var scriptText = goog.loadFileSync_(src);\n    if (scriptText == null) {\n      throw new Error('Load of \"' + src + '\" failed');\n    }\n\n    if (needsTranspile) {\n      scriptText = goog.transpile_.call(goog.global, scriptText, src);\n    }\n\n    if (isModule) {\n      scriptText = goog.wrapModule_(src, scriptText);\n    } else {\n      scriptText += '\\n//# sourceURL=' + src;\n    }\n    var isOldIE = goog.IS_OLD_IE_;\n    if (isOldIE) {\n      goog.dependencies_.deferred[originalPath] = scriptText;\n      goog.queuedModules_.push(originalPath);\n    } else {\n      importScript(src, scriptText);\n    }\n  }\n};\n\n\n/**\n * Lazily retrieves the transpiler and applies it to the source.\n * @param {string} code JS code.\n * @param {string} path Path to the code.\n * @return {string} The transpiled code.\n * @private\n */\ngoog.transpile_ = function(code, path) {\n  var jscomp = goog.global['$jscomp'];\n  if (!jscomp) {\n    goog.global['$jscomp'] = jscomp = {};\n  }\n  var transpile = jscomp.transpile;\n  if (!transpile) {\n    var transpilerPath = goog.basePath + goog.TRANSPILER;\n    var transpilerCode = goog.loadFileSync_(transpilerPath);\n    if (transpilerCode) {\n      // This must be executed synchronously, since by the time we know we\n      // need it, we're about to load and write the ES6 code synchronously,\n      // so a normal script-tag load will be too slow.\n      eval(transpilerCode + '\\n//# sourceURL=' + transpilerPath);\n      // Even though the transpiler is optional, if $gwtExport is found, it's\n      // a sign the transpiler was loaded and the $jscomp.transpile *should*\n      // be there.\n      if (goog.global['$gwtExport'] && goog.global['$gwtExport']['$jscomp'] &&\n          !goog.global['$gwtExport']['$jscomp']['transpile']) {\n        throw new Error(\n            'The transpiler did not properly export the \"transpile\" ' +\n            'method. $gwtExport: ' + JSON.stringify(goog.global['$gwtExport']));\n      }\n      // transpile.js only exports a single $jscomp function, transpile. We\n      // grab just that and add it to the existing definition of $jscomp which\n      // contains the polyfills.\n      goog.global['$jscomp'].transpile =\n          goog.global['$gwtExport']['$jscomp']['transpile'];\n      jscomp = goog.global['$jscomp'];\n      transpile = jscomp.transpile;\n    }\n  }\n  if (!transpile) {\n    // The transpiler is an optional component.  If it's not available then\n    // replace it with a pass-through function that simply logs.\n    var suffix = ' requires transpilation but no transpiler was found.';\n    transpile = jscomp.transpile = function(code, path) {\n      // TODO(user): figure out some way to get this error to show up\n      // in test results, noting that the failure may occur in many\n      // different ways, including in loadModule() before the test\n      // runner even comes up.\n      goog.logToConsole_(path + suffix);\n      return code;\n    };\n  }\n  // Note: any transpilation errors/warnings will be logged to the console.\n  return transpile(code, path);\n};\n\n\n//==============================================================================\n// Language Enhancements\n//==============================================================================\n\n\n/**\n * This is a \"fixed\" version of the typeof operator.  It differs from the typeof\n * operator in such a way that null returns 'null' and arrays return 'array'.\n * @param {?} value The value to get the type of.\n * @return {string} The name of the type.\n */\ngoog.typeOf = function(value) {\n  var s = typeof value;\n  if (s == 'object') {\n    if (value) {\n      // Check these first, so we can avoid calling Object.prototype.toString if\n      // possible.\n      //\n      // IE improperly marshals typeof across execution contexts, but a\n      // cross-context object will still return false for \"instanceof Object\".\n      if (value instanceof Array) {\n        return 'array';\n      } else if (value instanceof Object) {\n        return s;\n      }\n\n      // HACK: In order to use an Object prototype method on the arbitrary\n      //   value, the compiler requires the value be cast to type Object,\n      //   even though the ECMA spec explicitly allows it.\n      var className = Object.prototype.toString.call(\n          /** @type {!Object} */ (value));\n      // In Firefox 3.6, attempting to access iframe window objects' length\n      // property throws an NS_ERROR_FAILURE, so we need to special-case it\n      // here.\n      if (className == '[object Window]') {\n        return 'object';\n      }\n\n      // We cannot always use constructor == Array or instanceof Array because\n      // different frames have different Array objects. In IE6, if the iframe\n      // where the array was created is destroyed, the array loses its\n      // prototype. Then dereferencing val.splice here throws an exception, so\n      // we can't use goog.isFunction. Calling typeof directly returns 'unknown'\n      // so that will work. In this case, this function will return false and\n      // most array functions will still work because the array is still\n      // array-like (supports length and []) even though it has lost its\n      // prototype.\n      // Mark Miller noticed that Object.prototype.toString\n      // allows access to the unforgeable [[Class]] property.\n      //  15.2.4.2 Object.prototype.toString ( )\n      //  When the toString method is called, the following steps are taken:\n      //      1. Get the [[Class]] property of this object.\n      //      2. Compute a string value by concatenating the three strings\n      //         \"[object \", Result(1), and \"]\".\n      //      3. Return Result(2).\n      // and this behavior survives the destruction of the execution context.\n      if ((className == '[object Array]' ||\n           // In IE all non value types are wrapped as objects across window\n           // boundaries (not iframe though) so we have to do object detection\n           // for this edge case.\n           typeof value.length == 'number' &&\n               typeof value.splice != 'undefined' &&\n               typeof value.propertyIsEnumerable != 'undefined' &&\n               !value.propertyIsEnumerable('splice')\n\n               )) {\n        return 'array';\n      }\n      // HACK: There is still an array case that fails.\n      //     function ArrayImpostor() {}\n      //     ArrayImpostor.prototype = [];\n      //     var impostor = new ArrayImpostor;\n      // this can be fixed by getting rid of the fast path\n      // (value instanceof Array) and solely relying on\n      // (value && Object.prototype.toString.vall(value) === '[object Array]')\n      // but that would require many more function calls and is not warranted\n      // unless closure code is receiving objects from untrusted sources.\n\n      // IE in cross-window calls does not correctly marshal the function type\n      // (it appears just as an object) so we cannot use just typeof val ==\n      // 'function'. However, if the object has a call property, it is a\n      // function.\n      if ((className == '[object Function]' ||\n           typeof value.call != 'undefined' &&\n               typeof value.propertyIsEnumerable != 'undefined' &&\n               !value.propertyIsEnumerable('call'))) {\n        return 'function';\n      }\n\n    } else {\n      return 'null';\n    }\n\n  } else if (s == 'function' && typeof value.call == 'undefined') {\n    // In Safari typeof nodeList returns 'function', and on Firefox typeof\n    // behaves similarly for HTML{Applet,Embed,Object}, Elements and RegExps. We\n    // would like to return object for those and we can detect an invalid\n    // function by making sure that the function object has a call method.\n    return 'object';\n  }\n  return s;\n};\n\n\n/**\n * Returns true if the specified value is null.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is null.\n */\ngoog.isNull = function(val) {\n  return val === null;\n};\n\n\n/**\n * Returns true if the specified value is defined and not null.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is defined and not null.\n */\ngoog.isDefAndNotNull = function(val) {\n  // Note that undefined == null.\n  return val != null;\n};\n\n\n/**\n * Returns true if the specified value is an array.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is an array.\n */\ngoog.isArray = function(val) {\n  return goog.typeOf(val) == 'array';\n};\n\n\n/**\n * Returns true if the object looks like an array. To qualify as array like\n * the value needs to be either a NodeList or an object with a Number length\n * property. As a special case, a function value is not array like, because its\n * length property is fixed to correspond to the number of expected arguments.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is an array.\n */\ngoog.isArrayLike = function(val) {\n  var type = goog.typeOf(val);\n  // We do not use goog.isObject here in order to exclude function values.\n  return type == 'array' || type == 'object' && typeof val.length == 'number';\n};\n\n\n/**\n * Returns true if the object looks like a Date. To qualify as Date-like the\n * value needs to be an object and have a getFullYear() function.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is a like a Date.\n */\ngoog.isDateLike = function(val) {\n  return goog.isObject(val) && typeof val.getFullYear == 'function';\n};\n\n\n/**\n * Returns true if the specified value is a string.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is a string.\n */\ngoog.isString = function(val) {\n  return typeof val == 'string';\n};\n\n\n/**\n * Returns true if the specified value is a boolean.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is boolean.\n */\ngoog.isBoolean = function(val) {\n  return typeof val == 'boolean';\n};\n\n\n/**\n * Returns true if the specified value is a number.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is a number.\n */\ngoog.isNumber = function(val) {\n  return typeof val == 'number';\n};\n\n\n/**\n * Returns true if the specified value is a function.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is a function.\n */\ngoog.isFunction = function(val) {\n  return goog.typeOf(val) == 'function';\n};\n\n\n/**\n * Returns true if the specified value is an object.  This includes arrays and\n * functions.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is an object.\n */\ngoog.isObject = function(val) {\n  var type = typeof val;\n  return type == 'object' && val != null || type == 'function';\n  // return Object(val) === val also works, but is slower, especially if val is\n  // not an object.\n};\n\n\n/**\n * Gets a unique ID for an object. This mutates the object so that further calls\n * with the same object as a parameter returns the same value. The unique ID is\n * guaranteed to be unique across the current session amongst objects that are\n * passed into {@code getUid}. There is no guarantee that the ID is unique or\n * consistent across sessions. It is unsafe to generate unique ID for function\n * prototypes.\n *\n * @param {Object} obj The object to get the unique ID for.\n * @return {number} The unique ID for the object.\n */\ngoog.getUid = function(obj) {\n  // TODO(arv): Make the type stricter, do not accept null.\n\n  // In Opera window.hasOwnProperty exists but always returns false so we avoid\n  // using it. As a consequence the unique ID generated for BaseClass.prototype\n  // and SubClass.prototype will be the same.\n  return obj[goog.UID_PROPERTY_] ||\n      (obj[goog.UID_PROPERTY_] = ++goog.uidCounter_);\n};\n\n\n/**\n * Whether the given object is already assigned a unique ID.\n *\n * This does not modify the object.\n *\n * @param {!Object} obj The object to check.\n * @return {boolean} Whether there is an assigned unique id for the object.\n */\ngoog.hasUid = function(obj) {\n  return !!obj[goog.UID_PROPERTY_];\n};\n\n\n/**\n * Removes the unique ID from an object. This is useful if the object was\n * previously mutated using {@code goog.getUid} in which case the mutation is\n * undone.\n * @param {Object} obj The object to remove the unique ID field from.\n */\ngoog.removeUid = function(obj) {\n  // TODO(arv): Make the type stricter, do not accept null.\n\n  // In IE, DOM nodes are not instances of Object and throw an exception if we\n  // try to delete.  Instead we try to use removeAttribute.\n  if (obj !== null && 'removeAttribute' in obj) {\n    obj.removeAttribute(goog.UID_PROPERTY_);\n  }\n  /** @preserveTry */\n  try {\n    delete obj[goog.UID_PROPERTY_];\n  } catch (ex) {\n  }\n};\n\n\n/**\n * Name for unique ID property. Initialized in a way to help avoid collisions\n * with other closure JavaScript on the same page.\n * @type {string}\n * @private\n */\ngoog.UID_PROPERTY_ = 'closure_uid_' + ((Math.random() * 1e9) >>> 0);\n\n\n/**\n * Counter for UID.\n * @type {number}\n * @private\n */\ngoog.uidCounter_ = 0;\n\n\n/**\n * Adds a hash code field to an object. The hash code is unique for the\n * given object.\n * @param {Object} obj The object to get the hash code for.\n * @return {number} The hash code for the object.\n * @deprecated Use goog.getUid instead.\n */\ngoog.getHashCode = goog.getUid;\n\n\n/**\n * Removes the hash code field from an object.\n * @param {Object} obj The object to remove the field from.\n * @deprecated Use goog.removeUid instead.\n */\ngoog.removeHashCode = goog.removeUid;\n\n\n/**\n * Clones a value. The input may be an Object, Array, or basic type. Objects and\n * arrays will be cloned recursively.\n *\n * WARNINGS:\n * <code>goog.cloneObject</code> does not detect reference loops. Objects that\n * refer to themselves will cause infinite recursion.\n *\n * <code>goog.cloneObject</code> is unaware of unique identifiers, and copies\n * UIDs created by <code>getUid</code> into cloned results.\n *\n * @param {*} obj The value to clone.\n * @return {*} A clone of the input value.\n * @deprecated goog.cloneObject is unsafe. Prefer the goog.object methods.\n */\ngoog.cloneObject = function(obj) {\n  var type = goog.typeOf(obj);\n  if (type == 'object' || type == 'array') {\n    if (obj.clone) {\n      return obj.clone();\n    }\n    var clone = type == 'array' ? [] : {};\n    for (var key in obj) {\n      clone[key] = goog.cloneObject(obj[key]);\n    }\n    return clone;\n  }\n\n  return obj;\n};\n\n\n/**\n * A native implementation of goog.bind.\n * @param {Function} fn A function to partially apply.\n * @param {Object|undefined} selfObj Specifies the object which this should\n *     point to when the function is run.\n * @param {...*} var_args Additional arguments that are partially applied to the\n *     function.\n * @return {!Function} A partially-applied form of the function bind() was\n *     invoked as a method of.\n * @private\n * @suppress {deprecated} The compiler thinks that Function.prototype.bind is\n *     deprecated because some people have declared a pure-JS version.\n *     Only the pure-JS version is truly deprecated.\n */\ngoog.bindNative_ = function(fn, selfObj, var_args) {\n  return /** @type {!Function} */ (fn.call.apply(fn.bind, arguments));\n};\n\n\n/**\n * A pure-JS implementation of goog.bind.\n * @param {Function} fn A function to partially apply.\n * @param {Object|undefined} selfObj Specifies the object which this should\n *     point to when the function is run.\n * @param {...*} var_args Additional arguments that are partially applied to the\n *     function.\n * @return {!Function} A partially-applied form of the function bind() was\n *     invoked as a method of.\n * @private\n */\ngoog.bindJs_ = function(fn, selfObj, var_args) {\n  if (!fn) {\n    throw new Error();\n  }\n\n  if (arguments.length > 2) {\n    var boundArgs = Array.prototype.slice.call(arguments, 2);\n    return function() {\n      // Prepend the bound arguments to the current arguments.\n      var newArgs = Array.prototype.slice.call(arguments);\n      Array.prototype.unshift.apply(newArgs, boundArgs);\n      return fn.apply(selfObj, newArgs);\n    };\n\n  } else {\n    return function() {\n      return fn.apply(selfObj, arguments);\n    };\n  }\n};\n\n\n/**\n * Partially applies this function to a particular 'this object' and zero or\n * more arguments. The result is a new function with some arguments of the first\n * function pre-filled and the value of this 'pre-specified'.\n *\n * Remaining arguments specified at call-time are appended to the pre-specified\n * ones.\n *\n * Also see: {@link #partial}.\n *\n * Usage:\n * <pre>var barMethBound = goog.bind(myFunction, myObj, 'arg1', 'arg2');\n * barMethBound('arg3', 'arg4');</pre>\n *\n * @param {?function(this:T, ...)} fn A function to partially apply.\n * @param {T} selfObj Specifies the object which this should point to when the\n *     function is run.\n * @param {...*} var_args Additional arguments that are partially applied to the\n *     function.\n * @return {!Function} A partially-applied form of the function goog.bind() was\n *     invoked as a method of.\n * @template T\n * @suppress {deprecated} See above.\n */\ngoog.bind = function(fn, selfObj, var_args) {\n  // TODO(nicksantos): narrow the type signature.\n  if (Function.prototype.bind &&\n      // NOTE(nicksantos): Somebody pulled base.js into the default Chrome\n      // extension environment. This means that for Chrome extensions, they get\n      // the implementation of Function.prototype.bind that calls goog.bind\n      // instead of the native one. Even worse, we don't want to introduce a\n      // circular dependency between goog.bind and Function.prototype.bind, so\n      // we have to hack this to make sure it works correctly.\n      Function.prototype.bind.toString().indexOf('native code') != -1) {\n    goog.bind = goog.bindNative_;\n  } else {\n    goog.bind = goog.bindJs_;\n  }\n  return goog.bind.apply(null, arguments);\n};\n\n\n/**\n * Like goog.bind(), except that a 'this object' is not required. Useful when\n * the target function is already bound.\n *\n * Usage:\n * var g = goog.partial(f, arg1, arg2);\n * g(arg3, arg4);\n *\n * @param {Function} fn A function to partially apply.\n * @param {...*} var_args Additional arguments that are partially applied to fn.\n * @return {!Function} A partially-applied form of the function goog.partial()\n *     was invoked as a method of.\n */\ngoog.partial = function(fn, var_args) {\n  var args = Array.prototype.slice.call(arguments, 1);\n  return function() {\n    // Clone the array (with slice()) and append additional arguments\n    // to the existing arguments.\n    var newArgs = args.slice();\n    newArgs.push.apply(newArgs, arguments);\n    return fn.apply(this, newArgs);\n  };\n};\n\n\n/**\n * Copies all the members of a source object to a target object. This method\n * does not work on all browsers for all objects that contain keys such as\n * toString or hasOwnProperty. Use goog.object.extend for this purpose.\n * @param {Object} target Target.\n * @param {Object} source Source.\n */\ngoog.mixin = function(target, source) {\n  for (var x in source) {\n    target[x] = source[x];\n  }\n\n  // For IE7 or lower, the for-in-loop does not contain any properties that are\n  // not enumerable on the prototype object (for example, isPrototypeOf from\n  // Object.prototype) but also it will not include 'replace' on objects that\n  // extend String and change 'replace' (not that it is common for anyone to\n  // extend anything except Object).\n};\n\n\n/**\n * @return {number} An integer value representing the number of milliseconds\n *     between midnight, January 1, 1970 and the current time.\n */\ngoog.now = (goog.TRUSTED_SITE && Date.now) || (function() {\n             // Unary plus operator converts its operand to a number which in\n             // the case of\n             // a date is done by calling getTime().\n             return +new Date();\n           });\n\n\n/**\n * Evals JavaScript in the global scope.  In IE this uses execScript, other\n * browsers use goog.global.eval. If goog.global.eval does not evaluate in the\n * global scope (for example, in Safari), appends a script tag instead.\n * Throws an exception if neither execScript or eval is defined.\n * @param {string} script JavaScript string.\n */\ngoog.globalEval = function(script) {\n  if (goog.global.execScript) {\n    goog.global.execScript(script, 'JavaScript');\n  } else if (goog.global.eval) {\n    // Test to see if eval works\n    if (goog.evalWorksForGlobals_ == null) {\n      goog.global.eval('var _evalTest_ = 1;');\n      if (typeof goog.global['_evalTest_'] != 'undefined') {\n        try {\n          delete goog.global['_evalTest_'];\n        } catch (ignore) {\n          // Microsoft edge fails the deletion above in strict mode.\n        }\n        goog.evalWorksForGlobals_ = true;\n      } else {\n        goog.evalWorksForGlobals_ = false;\n      }\n    }\n\n    if (goog.evalWorksForGlobals_) {\n      goog.global.eval(script);\n    } else {\n      /** @type {Document} */\n      var doc = goog.global.document;\n      var scriptElt =\n          /** @type {!HTMLScriptElement} */ (doc.createElement('SCRIPT'));\n      scriptElt.type = 'text/javascript';\n      scriptElt.defer = false;\n      // Note(user): can't use .innerHTML since \"t('<test>')\" will fail and\n      // .text doesn't work in Safari 2.  Therefore we append a text node.\n      scriptElt.appendChild(doc.createTextNode(script));\n      doc.body.appendChild(scriptElt);\n      doc.body.removeChild(scriptElt);\n    }\n  } else {\n    throw Error('goog.globalEval not available');\n  }\n};\n\n\n/**\n * Indicates whether or not we can call 'eval' directly to eval code in the\n * global scope. Set to a Boolean by the first call to goog.globalEval (which\n * empirically tests whether eval works for globals). @see goog.globalEval\n * @type {?boolean}\n * @private\n */\ngoog.evalWorksForGlobals_ = null;\n\n\n/**\n * Optional map of CSS class names to obfuscated names used with\n * goog.getCssName().\n * @private {!Object<string, string>|undefined}\n * @see goog.setCssNameMapping\n */\ngoog.cssNameMapping_;\n\n\n/**\n * Optional obfuscation style for CSS class names. Should be set to either\n * 'BY_WHOLE' or 'BY_PART' if defined.\n * @type {string|undefined}\n * @private\n * @see goog.setCssNameMapping\n */\ngoog.cssNameMappingStyle_;\n\n\n/**\n * Handles strings that are intended to be used as CSS class names.\n *\n * This function works in tandem with @see goog.setCssNameMapping.\n *\n * Without any mapping set, the arguments are simple joined with a hyphen and\n * passed through unaltered.\n *\n * When there is a mapping, there are two possible styles in which these\n * mappings are used. In the BY_PART style, each part (i.e. in between hyphens)\n * of the passed in css name is rewritten according to the map. In the BY_WHOLE\n * style, the full css name is looked up in the map directly. If a rewrite is\n * not specified by the map, the compiler will output a warning.\n *\n * When the mapping is passed to the compiler, it will replace calls to\n * goog.getCssName with the strings from the mapping, e.g.\n *     var x = goog.getCssName('foo');\n *     var y = goog.getCssName(this.baseClass, 'active');\n *  becomes:\n *     var x = 'foo';\n *     var y = this.baseClass + '-active';\n *\n * If one argument is passed it will be processed, if two are passed only the\n * modifier will be processed, as it is assumed the first argument was generated\n * as a result of calling goog.getCssName.\n *\n * @param {string} className The class name.\n * @param {string=} opt_modifier A modifier to be appended to the class name.\n * @return {string} The class name or the concatenation of the class name and\n *     the modifier.\n */\ngoog.getCssName = function(className, opt_modifier) {\n  // String() is used for compatibility with compiled soy where the passed\n  // className can be non-string objects like here\n  // http://google3/java/com/google/privacy/accountcentral/common/ui/client/cards/popupcard.soy?l=74&rcl=94079467\n  if (String(className).charAt(0) == '.') {\n    throw new Error(\n        'className passed in goog.getCssName must not start with \".\".' +\n        ' You passed: ' + className);\n  }\n\n  var getMapping = function(cssName) {\n    return goog.cssNameMapping_[cssName] || cssName;\n  };\n\n  var renameByParts = function(cssName) {\n    // Remap all the parts individually.\n    var parts = cssName.split('-');\n    var mapped = [];\n    for (var i = 0; i < parts.length; i++) {\n      mapped.push(getMapping(parts[i]));\n    }\n    return mapped.join('-');\n  };\n\n  var rename;\n  if (goog.cssNameMapping_) {\n    rename =\n        goog.cssNameMappingStyle_ == 'BY_WHOLE' ? getMapping : renameByParts;\n  } else {\n    rename = function(a) {\n      return a;\n    };\n  }\n\n  var result =\n      opt_modifier ? className + '-' + rename(opt_modifier) : rename(className);\n\n  // The special CLOSURE_CSS_NAME_MAP_FN allows users to specify further\n  // processing of the class name.\n  if (goog.global.CLOSURE_CSS_NAME_MAP_FN) {\n    return goog.global.CLOSURE_CSS_NAME_MAP_FN(result);\n  }\n\n  return result;\n};\n\n\n/**\n * Sets the map to check when returning a value from goog.getCssName(). Example:\n * <pre>\n * goog.setCssNameMapping({\n *   \"goog\": \"a\",\n *   \"disabled\": \"b\",\n * });\n *\n * var x = goog.getCssName('goog');\n * // The following evaluates to: \"a a-b\".\n * goog.getCssName('goog') + ' ' + goog.getCssName(x, 'disabled')\n * </pre>\n * When declared as a map of string literals to string literals, the JSCompiler\n * will replace all calls to goog.getCssName() using the supplied map if the\n * --process_closure_primitives flag is set.\n *\n * @param {!Object} mapping A map of strings to strings where keys are possible\n *     arguments to goog.getCssName() and values are the corresponding values\n *     that should be returned.\n * @param {string=} opt_style The style of css name mapping. There are two valid\n *     options: 'BY_PART', and 'BY_WHOLE'.\n * @see goog.getCssName for a description.\n */\ngoog.setCssNameMapping = function(mapping, opt_style) {\n  goog.cssNameMapping_ = mapping;\n  goog.cssNameMappingStyle_ = opt_style;\n};\n\n\n/**\n * To use CSS renaming in compiled mode, one of the input files should have a\n * call to goog.setCssNameMapping() with an object literal that the JSCompiler\n * can extract and use to replace all calls to goog.getCssName(). In uncompiled\n * mode, JavaScript code should be loaded before this base.js file that declares\n * a global variable, CLOSURE_CSS_NAME_MAPPING, which is used below. This is\n * to ensure that the mapping is loaded before any calls to goog.getCssName()\n * are made in uncompiled mode.\n *\n * A hook for overriding the CSS name mapping.\n * @type {!Object<string, string>|undefined}\n */\ngoog.global.CLOSURE_CSS_NAME_MAPPING;\n\n\nif (!COMPILED && goog.global.CLOSURE_CSS_NAME_MAPPING) {\n  // This does not call goog.setCssNameMapping() because the JSCompiler\n  // requires that goog.setCssNameMapping() be called with an object literal.\n  goog.cssNameMapping_ = goog.global.CLOSURE_CSS_NAME_MAPPING;\n}\n\n\n/**\n * Gets a localized message.\n *\n * This function is a compiler primitive. If you give the compiler a localized\n * message bundle, it will replace the string at compile-time with a localized\n * version, and expand goog.getMsg call to a concatenated string.\n *\n * Messages must be initialized in the form:\n * <code>\n * var MSG_NAME = goog.getMsg('Hello {$placeholder}', {'placeholder': 'world'});\n * </code>\n *\n * This function produces a string which should be treated as plain text. Use\n * {@link goog.html.SafeHtmlFormatter} in conjunction with goog.getMsg to\n * produce SafeHtml.\n *\n * @param {string} str Translatable string, places holders in the form {$foo}.\n * @param {Object<string, string>=} opt_values Maps place holder name to value.\n * @return {string} message with placeholders filled.\n */\ngoog.getMsg = function(str, opt_values) {\n  if (opt_values) {\n    str = str.replace(/\\{\\$([^}]+)}/g, function(match, key) {\n      return (opt_values != null && key in opt_values) ? opt_values[key] :\n                                                         match;\n    });\n  }\n  return str;\n};\n\n\n/**\n * Gets a localized message. If the message does not have a translation, gives a\n * fallback message.\n *\n * This is useful when introducing a new message that has not yet been\n * translated into all languages.\n *\n * This function is a compiler primitive. Must be used in the form:\n * <code>var x = goog.getMsgWithFallback(MSG_A, MSG_B);</code>\n * where MSG_A and MSG_B were initialized with goog.getMsg.\n *\n * @param {string} a The preferred message.\n * @param {string} b The fallback message.\n * @return {string} The best translated message.\n */\ngoog.getMsgWithFallback = function(a, b) {\n  return a;\n};\n\n\n/**\n * Exposes an unobfuscated global namespace path for the given object.\n * Note that fields of the exported object *will* be obfuscated, unless they are\n * exported in turn via this function or goog.exportProperty.\n *\n * Also handy for making public items that are defined in anonymous closures.\n *\n * ex. goog.exportSymbol('public.path.Foo', Foo);\n *\n * ex. goog.exportSymbol('public.path.Foo.staticFunction', Foo.staticFunction);\n *     public.path.Foo.staticFunction();\n *\n * ex. goog.exportSymbol('public.path.Foo.prototype.myMethod',\n *                       Foo.prototype.myMethod);\n *     new public.path.Foo().myMethod();\n *\n * @param {string} publicPath Unobfuscated name to export.\n * @param {*} object Object the name should point to.\n * @param {Object=} opt_objectToExportTo The object to add the path to; default\n *     is goog.global.\n */\ngoog.exportSymbol = function(publicPath, object, opt_objectToExportTo) {\n  goog.exportPath_(publicPath, object, opt_objectToExportTo);\n};\n\n\n/**\n * Exports a property unobfuscated into the object's namespace.\n * ex. goog.exportProperty(Foo, 'staticFunction', Foo.staticFunction);\n * ex. goog.exportProperty(Foo.prototype, 'myMethod', Foo.prototype.myMethod);\n * @param {Object} object Object whose static property is being exported.\n * @param {string} publicName Unobfuscated name to export.\n * @param {*} symbol Object the name should point to.\n */\ngoog.exportProperty = function(object, publicName, symbol) {\n  object[publicName] = symbol;\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * Usage:\n * <pre>\n * function ParentClass(a, b) { }\n * ParentClass.prototype.foo = function(a) { };\n *\n * function ChildClass(a, b, c) {\n *   ChildClass.base(this, 'constructor', a, b);\n * }\n * goog.inherits(ChildClass, ParentClass);\n *\n * var child = new ChildClass('a', 'b', 'see');\n * child.foo(); // This works.\n * </pre>\n *\n * @param {!Function} childCtor Child class.\n * @param {!Function} parentCtor Parent class.\n */\ngoog.inherits = function(childCtor, parentCtor) {\n  /** @constructor */\n  function tempCtor() {}\n  tempCtor.prototype = parentCtor.prototype;\n  childCtor.superClass_ = parentCtor.prototype;\n  childCtor.prototype = new tempCtor();\n  /** @override */\n  childCtor.prototype.constructor = childCtor;\n\n  /**\n   * Calls superclass constructor/method.\n   *\n   * This function is only available if you use goog.inherits to\n   * express inheritance relationships between classes.\n   *\n   * NOTE: This is a replacement for goog.base and for superClass_\n   * property defined in childCtor.\n   *\n   * @param {!Object} me Should always be \"this\".\n   * @param {string} methodName The method name to call. Calling\n   *     superclass constructor can be done with the special string\n   *     'constructor'.\n   * @param {...*} var_args The arguments to pass to superclass\n   *     method/constructor.\n   * @return {*} The return value of the superclass method/constructor.\n   */\n  childCtor.base = function(me, methodName, var_args) {\n    // Copying using loop to avoid deop due to passing arguments object to\n    // function. This is faster in many JS engines as of late 2014.\n    var args = new Array(arguments.length - 2);\n    for (var i = 2; i < arguments.length; i++) {\n      args[i - 2] = arguments[i];\n    }\n    return parentCtor.prototype[methodName].apply(me, args);\n  };\n};\n\n\n/**\n * Call up to the superclass.\n *\n * If this is called from a constructor, then this calls the superclass\n * constructor with arguments 1-N.\n *\n * If this is called from a prototype method, then you must pass the name of the\n * method as the second argument to this function. If you do not, you will get a\n * runtime error. This calls the superclass' method with arguments 2-N.\n *\n * This function only works if you use goog.inherits to express inheritance\n * relationships between your classes.\n *\n * This function is a compiler primitive. At compile-time, the compiler will do\n * macro expansion to remove a lot of the extra overhead that this function\n * introduces. The compiler will also enforce a lot of the assumptions that this\n * function makes, and treat it as a compiler error if you break them.\n *\n * @param {!Object} me Should always be \"this\".\n * @param {*=} opt_methodName The method name if calling a super method.\n * @param {...*} var_args The rest of the arguments.\n * @return {*} The return value of the superclass method.\n * @suppress {es5Strict} This method can not be used in strict mode, but\n *     all Closure Library consumers must depend on this file.\n */\ngoog.base = function(me, opt_methodName, var_args) {\n  var caller = arguments.callee.caller;\n\n  if (goog.STRICT_MODE_COMPATIBLE || (goog.DEBUG && !caller)) {\n    throw Error(\n        'arguments.caller not defined.  goog.base() cannot be used ' +\n        'with strict mode code. See ' +\n        'http://www.ecma-international.org/ecma-262/5.1/#sec-C');\n  }\n\n  if (caller.superClass_) {\n    // Copying using loop to avoid deop due to passing arguments object to\n    // function. This is faster in many JS engines as of late 2014.\n    var ctorArgs = new Array(arguments.length - 1);\n    for (var i = 1; i < arguments.length; i++) {\n      ctorArgs[i - 1] = arguments[i];\n    }\n    // This is a constructor. Call the superclass constructor.\n    return caller.superClass_.constructor.apply(me, ctorArgs);\n  }\n\n  // Copying using loop to avoid deop due to passing arguments object to\n  // function. This is faster in many JS engines as of late 2014.\n  var args = new Array(arguments.length - 2);\n  for (var i = 2; i < arguments.length; i++) {\n    args[i - 2] = arguments[i];\n  }\n  var foundCaller = false;\n  for (var ctor = me.constructor; ctor;\n       ctor = ctor.superClass_ && ctor.superClass_.constructor) {\n    if (ctor.prototype[opt_methodName] === caller) {\n      foundCaller = true;\n    } else if (foundCaller) {\n      return ctor.prototype[opt_methodName].apply(me, args);\n    }\n  }\n\n  // If we did not find the caller in the prototype chain, then one of two\n  // things happened:\n  // 1) The caller is an instance method.\n  // 2) This method was not called by the right caller.\n  if (me[opt_methodName] === caller) {\n    return me.constructor.prototype[opt_methodName].apply(me, args);\n  } else {\n    throw Error(\n        'goog.base called from a method of one name ' +\n        'to a method of a different name');\n  }\n};\n\n\n/**\n * Allow for aliasing within scope functions.  This function exists for\n * uncompiled code - in compiled code the calls will be inlined and the aliases\n * applied.  In uncompiled code the function is simply run since the aliases as\n * written are valid JavaScript.\n *\n *\n * @param {function()} fn Function to call.  This function can contain aliases\n *     to namespaces (e.g. \"var dom = goog.dom\") or classes\n *     (e.g. \"var Timer = goog.Timer\").\n */\ngoog.scope = function(fn) {\n  if (goog.isInModuleLoader_()) {\n    throw Error('goog.scope is not supported within a goog.module.');\n  }\n  fn.call(goog.global);\n};\n\n\n/*\n * To support uncompiled, strict mode bundles that use eval to divide source\n * like so:\n *    eval('someSource;//# sourceUrl sourcefile.js');\n * We need to export the globally defined symbols \"goog\" and \"COMPILED\".\n * Exporting \"goog\" breaks the compiler optimizations, so we required that\n * be defined externally.\n * NOTE: We don't use goog.exportSymbol here because we don't want to trigger\n * extern generation when that compiler option is enabled.\n */\nif (!COMPILED) {\n  goog.global['COMPILED'] = COMPILED;\n}\n\n\n//==============================================================================\n// goog.defineClass implementation\n//==============================================================================\n\n\n/**\n * Creates a restricted form of a Closure \"class\":\n *   - from the compiler's perspective, the instance returned from the\n *     constructor is sealed (no new properties may be added).  This enables\n *     better checks.\n *   - the compiler will rewrite this definition to a form that is optimal\n *     for type checking and optimization (initially this will be a more\n *     traditional form).\n *\n * @param {Function} superClass The superclass, Object or null.\n * @param {goog.defineClass.ClassDescriptor} def\n *     An object literal describing\n *     the class.  It may have the following properties:\n *     \"constructor\": the constructor function\n *     \"statics\": an object literal containing methods to add to the constructor\n *        as \"static\" methods or a function that will receive the constructor\n *        function as its only parameter to which static properties can\n *        be added.\n *     all other properties are added to the prototype.\n * @return {!Function} The class constructor.\n */\ngoog.defineClass = function(superClass, def) {\n  // TODO(johnlenz): consider making the superClass an optional parameter.\n  var constructor = def.constructor;\n  var statics = def.statics;\n  // Wrap the constructor prior to setting up the prototype and static methods.\n  if (!constructor || constructor == Object.prototype.constructor) {\n    constructor = function() {\n      throw Error('cannot instantiate an interface (no constructor defined).');\n    };\n  }\n\n  var cls = goog.defineClass.createSealingConstructor_(constructor, superClass);\n  if (superClass) {\n    goog.inherits(cls, superClass);\n  }\n\n  // Remove all the properties that should not be copied to the prototype.\n  delete def.constructor;\n  delete def.statics;\n\n  goog.defineClass.applyProperties_(cls.prototype, def);\n  if (statics != null) {\n    if (statics instanceof Function) {\n      statics(cls);\n    } else {\n      goog.defineClass.applyProperties_(cls, statics);\n    }\n  }\n\n  return cls;\n};\n\n\n/**\n * @typedef {{\n *   constructor: (!Function|undefined),\n *   statics: (Object|undefined|function(Function):void)\n * }}\n */\ngoog.defineClass.ClassDescriptor;\n\n\n/**\n * @define {boolean} Whether the instances returned by goog.defineClass should\n *     be sealed when possible.\n *\n * When sealing is disabled the constructor function will not be wrapped by\n * goog.defineClass, making it incompatible with ES6 class methods.\n */\ngoog.define('goog.defineClass.SEAL_CLASS_INSTANCES', goog.DEBUG);\n\n\n/**\n * If goog.defineClass.SEAL_CLASS_INSTANCES is enabled and Object.seal is\n * defined, this function will wrap the constructor in a function that seals the\n * results of the provided constructor function.\n *\n * @param {!Function} ctr The constructor whose results maybe be sealed.\n * @param {Function} superClass The superclass constructor.\n * @return {!Function} The replacement constructor.\n * @private\n */\ngoog.defineClass.createSealingConstructor_ = function(ctr, superClass) {\n  if (!goog.defineClass.SEAL_CLASS_INSTANCES) {\n    // Do now wrap the constructor when sealing is disabled. Angular code\n    // depends on this for injection to work properly.\n    return ctr;\n  }\n\n  // Compute whether the constructor is sealable at definition time, rather\n  // than when the instance is being constructed.\n  var superclassSealable = !goog.defineClass.isUnsealable_(superClass);\n\n  /**\n   * @this {Object}\n   * @return {?}\n   */\n  var wrappedCtr = function() {\n    // Don't seal an instance of a subclass when it calls the constructor of\n    // its super class as there is most likely still setup to do.\n    var instance = ctr.apply(this, arguments) || this;\n    instance[goog.UID_PROPERTY_] = instance[goog.UID_PROPERTY_];\n\n    if (this.constructor === wrappedCtr && superclassSealable &&\n        Object.seal instanceof Function) {\n      Object.seal(instance);\n    }\n    return instance;\n  };\n\n  return wrappedCtr;\n};\n\n\n/**\n * @param {Function} ctr The constructor to test.\n * @return {boolean} Whether the constructor has been tagged as unsealable\n *     using goog.tagUnsealableClass.\n * @private\n */\ngoog.defineClass.isUnsealable_ = function(ctr) {\n  return ctr && ctr.prototype &&\n      ctr.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_];\n};\n\n\n// TODO(johnlenz): share these values with the goog.object\n/**\n * The names of the fields that are defined on Object.prototype.\n * @type {!Array<string>}\n * @private\n * @const\n */\ngoog.defineClass.OBJECT_PROTOTYPE_FIELDS_ = [\n  'constructor', 'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable',\n  'toLocaleString', 'toString', 'valueOf'\n];\n\n\n// TODO(johnlenz): share this function with the goog.object\n/**\n * @param {!Object} target The object to add properties to.\n * @param {!Object} source The object to copy properties from.\n * @private\n */\ngoog.defineClass.applyProperties_ = function(target, source) {\n  // TODO(johnlenz): update this to support ES5 getters/setters\n\n  var key;\n  for (key in source) {\n    if (Object.prototype.hasOwnProperty.call(source, key)) {\n      target[key] = source[key];\n    }\n  }\n\n  // For IE the for-in-loop does not contain any properties that are not\n  // enumerable on the prototype object (for example isPrototypeOf from\n  // Object.prototype) and it will also not include 'replace' on objects that\n  // extend String and change 'replace' (not that it is common for anyone to\n  // extend anything except Object).\n  for (var i = 0; i < goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length; i++) {\n    key = goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[i];\n    if (Object.prototype.hasOwnProperty.call(source, key)) {\n      target[key] = source[key];\n    }\n  }\n};\n\n\n/**\n * Sealing classes breaks the older idiom of assigning properties on the\n * prototype rather than in the constructor. As such, goog.defineClass\n * must not seal subclasses of these old-style classes until they are fixed.\n * Until then, this marks a class as \"broken\", instructing defineClass\n * not to seal subclasses.\n * @param {!Function} ctr The legacy constructor to tag as unsealable.\n */\ngoog.tagUnsealableClass = function(ctr) {\n  if (!COMPILED && goog.defineClass.SEAL_CLASS_INSTANCES) {\n    ctr.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_] = true;\n  }\n};\n\n\n/**\n * Name for unsealable tag property.\n * @const @private {string}\n */\ngoog.UNSEALABLE_CONSTRUCTOR_PROPERTY_ = 'goog_defineClass_legacy_unsealable';\n\n\n/**\n * Returns a newly created map from language mode string to a boolean\n * indicating whether transpilation should be done for that mode.\n *\n * Guaranteed invariant:\n * For any two modes, l1 and l2 where l2 is a newer mode than l1,\n * `map[l1] == true` implies that `map[l2] == true`.\n * @private\n * @return {!Object<string, boolean>}\n */\ngoog.createRequiresTranspilation_ = function() {\n  var /** !Object<string, boolean> */ requiresTranspilation = {'es3': false};\n  var transpilationRequiredForAllLaterModes = false;\n\n  /**\n   * Adds an entry to requiresTranspliation for the given language mode.\n   *\n   * IMPORTANT: Calls must be made in order from oldest to newest language\n   * mode.\n   * @param {string} modeName\n   * @param {function(): boolean} isSupported Returns true if the JS engine\n   *     supports the given mode.\n   */\n  function addNewerLanguageTranspilationCheck(modeName, isSupported) {\n    if (transpilationRequiredForAllLaterModes) {\n      requiresTranspilation[modeName] = true;\n    } else if (isSupported()) {\n      requiresTranspilation[modeName] = false;\n    } else {\n      requiresTranspilation[modeName] = true;\n      transpilationRequiredForAllLaterModes = true;\n    }\n  }\n\n  /**\n   * Does the given code evaluate without syntax errors and return a truthy\n   * result?\n   */\n  function /** boolean */ evalCheck(/** string */ code) {\n    try {\n      return !!eval(code);\n    } catch (ignored) {\n      return false;\n    }\n  }\n\n  // Identify ES3-only browsers by their incorrect treatment of commas.\n  addNewerLanguageTranspilationCheck('es5', function() {\n    return evalCheck('[1,].length==1');\n  });\n  addNewerLanguageTranspilationCheck('es6', function() {\n    // Test es6: [FF50 (?), Edge 14 (?), Chrome 50]\n    //   (a) default params (specifically shadowing locals),\n    //   (b) destructuring, (c) block-scoped functions,\n    //   (d) for-of (const), (e) new.target/Reflect.construct\n    var es6fullTest =\n        'class X{constructor(){if(new.target!=String)throw 1;this.x=42}}' +\n        'let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof ' +\n        'String))throw 1;for(const a of[2,3]){if(a==2)continue;function ' +\n        'f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()' +\n        '==3}';\n\n    return evalCheck('(()=>{\"use strict\";' + es6fullTest + '})()');\n  });\n  // TODO(joeltine): Remove es6-impl references for b/31340605.\n  // Consider es6-impl (widely-implemented es6 features) to be supported\n  // whenever es6 is supported. Technically es6-impl is a lower level of\n  // support than es6, but we don't have tests specifically for it.\n  addNewerLanguageTranspilationCheck('es6-impl', function() {\n    return true;\n  });\n  // ** and **= are the only new features in 'es7'\n  addNewerLanguageTranspilationCheck('es7', function() {\n    return evalCheck('2 ** 2 == 4');\n  });\n  // async functions are the only new features in 'es8'\n  addNewerLanguageTranspilationCheck('es8', function() {\n    return evalCheck('async () => 1, true');\n  });\n  return requiresTranspilation;\n};\n","/**\n * @fileoverview\n */\n\n/* global Blockly, goog, document */\n'use strict';\n\ngoog.provide('Blockly.BlockSvgUnused');\n\nvar FRAME_MARGIN_SIDE = 15;\nvar FRAME_MARGIN_TOP = 10;\nvar FRAME_MARGIN_BOTTOM = 5;\n\nvar FRAME_HEADER_HEIGHT = 25;\n\nBlockly.BlockSvgUnused = function (block) {\n  this.block_ = block;\n\n  this.bindData_ = undefined;\n\n  this.frameGroup_ = undefined;\n  this.frameClipRect_ = undefined;\n  this.frameBase_ = undefined;\n  this.frameHeader_ = undefined;\n  this.frameText_ = undefined;\n  this.frameHelp_ = undefined;\n\n  this.initChildren();\n};\n\nBlockly.BlockSvgUnused.UNUSED_BLOCK_HELP_EVENT = 'blocklyUnusedBlockHelpClicked';\n\nBlockly.BlockSvgUnused.prototype.initChildren = function () {\n  this.frameGroup_ = Blockly.createSvgElement('g', {\n    'class': 'blocklyUnusedFrame'\n  });\n\n  var clip = Blockly.createSvgElement('clipPath', {\n    id: 'frameClip' + this.block_.id\n  }, this.frameGroup_);\n  this.frameClipRect_ = Blockly.createSvgElement('rect', {\n    x: -FRAME_MARGIN_SIDE,\n    y: -(FRAME_MARGIN_TOP + FRAME_HEADER_HEIGHT),\n    height: FRAME_HEADER_HEIGHT\n  }, clip);\n\n  this.frameBase_ = Blockly.createSvgElement('rect', {\n    x: -FRAME_MARGIN_SIDE,\n    y: -(FRAME_MARGIN_TOP + FRAME_HEADER_HEIGHT),\n    fill: '#e7e8ea',\n    stroke: '#c6cacd',\n    rx: 15,\n    ry:15\n  }, this.frameGroup_);\n\n  this.frameHeader_ = Blockly.createSvgElement('rect', {\n    x: -FRAME_MARGIN_SIDE,\n    y: -(FRAME_MARGIN_TOP + FRAME_HEADER_HEIGHT),\n    fill: '#c6cacd',\n    rx: 15,\n    ry:15,\n    'clip-path': 'url(#frameClip' + this.block_.id + ')'\n  }, this.frameGroup_);\n\n  var frameTextVerticalPosition = -(FRAME_MARGIN_TOP + FRAME_HEADER_HEIGHT / 2);\n  if (Blockly.ieVersion()) {\n    // in non-IE browsers, we use dominant-baseline to vertically center\n    // our text. That is unfortunately not supported in IE, so we\n    // manually offset by 4 pixels to compensate.\n    frameTextVerticalPosition += 4;\n  }\n  this.frameText_ = Blockly.createSvgElement('text', {\n    'class': 'blocklyText',\n    style: 'font-size: 12pt',\n    y: frameTextVerticalPosition,\n    'dominant-baseline': 'central'\n  }, this.frameGroup_);\n  this.frameText_.appendChild(document.createTextNode(Blockly.Msg.UNUSED_CODE));\n\n  this.frameHelp_ = Blockly.createSvgElement('g', {\n    'class': 'blocklyHelp'\n  }, this.frameGroup_);\n  Blockly.createSvgElement('circle', {\n    fill: '#7665a0',\n    r: FRAME_HEADER_HEIGHT * 0.75 * 0.5\n  }, this.frameHelp_);\n  Blockly.createSvgElement('text', {\n    'class': 'blocklyText',\n    y: Blockly.ieVersion() ? 4 : 0 // again, offset text manually in IE\n  }, this.frameHelp_).appendChild(document.createTextNode(\"?\"));\n};\n\n/**\n * @override\n */\nBlockly.BlockSvgUnused.prototype.getPadding = function () {\n  return {\n    top: FRAME_MARGIN_TOP + FRAME_HEADER_HEIGHT,\n    right: FRAME_MARGIN_SIDE,\n    bottom: FRAME_MARGIN_BOTTOM,\n    left: FRAME_MARGIN_SIDE\n  };\n};\n\nBlockly.BlockSvgUnused.prototype.bindClickEvent = function () {\n  if (this.isbound_) {\n    return;\n  }\n  this.isbound_ = true;\n\n  // We bind to mousedown rather than click so we can interrupt the drag\n  // that would otherwise be initiated.\n  Blockly.bindEvent_(this.frameHelp_, 'mousedown', this, function (e) {\n    if (Blockly.isRightButton(e)) {\n      // Right-click.\n      return;\n    }\n\n    Blockly.fireUiEvent(this.frameHelp_, Blockly.BlockSvgUnused.UNUSED_BLOCK_HELP_EVENT);\n    e.stopPropagation();\n    e.preventDefault();\n  });\n};\n\nBlockly.BlockSvgUnused.prototype.render = function (svgGroup) {\n\n  // Remove ourselves from the DOM and calculate the size of our\n  // container, then insert ourselves into the container.\n  // We do this because otherwise, the value returned by\n  // getBoundingClientRect would take our size into account, and we\n  // would 'grow' every time render was called.\n  goog.dom.removeNode(this.frameGroup_);\n  var groupRect = svgGroup.getBoundingClientRect();\n  goog.dom.insertChildAt(svgGroup, this.frameGroup_, 0);\n\n  Blockly.addClass_(this.frameGroup_, 'hidden');\n  var frameGroup = this.frameGroup_;\n  // Trigger the CSS fade-in transition.\n  setTimeout(function () {\n    Blockly.removeClass_(frameGroup, 'hidden');\n  }, 0);\n\n  this.bindClickEvent();\n\n  var minWidth = this.frameText_.getBoundingClientRect().width + this.frameHelp_.getBoundingClientRect().width;\n\n  var width = Math.max(groupRect.width, minWidth) + 2 * FRAME_MARGIN_SIDE;\n  var height = groupRect.height + FRAME_MARGIN_TOP + FRAME_MARGIN_BOTTOM + FRAME_HEADER_HEIGHT;\n\n  this.frameClipRect_.setAttribute('width', width);\n  this.frameBase_.setAttribute('width', width);\n  this.frameBase_.setAttribute('height', height);\n  this.frameHeader_.setAttribute('width', width);\n  this.frameHeader_.setAttribute('height', height);\n\n  if (Blockly.RTL) {\n    this.frameClipRect_.setAttribute('x', -width + FRAME_MARGIN_SIDE);\n    this.frameHeader_.setAttribute('x', -width + FRAME_MARGIN_SIDE);\n    this.frameBase_.setAttribute('x', -width + FRAME_MARGIN_SIDE);\n    this.frameText_.setAttribute('x', -width + 2 * FRAME_MARGIN_SIDE);\n  }\n\n  this.frameHelp_.setAttribute('transform', 'translate(' + (width - 2 * FRAME_MARGIN_SIDE) + ',' + (-(FRAME_MARGIN_TOP + FRAME_HEADER_HEIGHT / 2)) + ')');\n};\n\nBlockly.BlockSvgUnused.prototype.dispose = function () {\n  if (this.bindData_) {\n    Blockly.unbindEvent_(this.bindData_);\n  }\n  goog.dom.removeNode(this.frameGroup_);\n  this.frameGroup_ = undefined;\n  this.frameClipRect_ = undefined;\n  this.frameBase_ = undefined;\n  this.frameHeader_ = undefined;\n  this.frameText_ = undefined;\n  this.frameHelp_ = undefined;\n};\n","// Copyright 2009 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Provides a base class for custom Error objects such that the\n * stack is correctly maintained.\n *\n * You should never need to throw goog.debug.Error(msg) directly, Error(msg) is\n * sufficient.\n *\n */\n\ngoog.provide('goog.debug.Error');\n\n\n\n/**\n * Base class for custom error objects.\n * @param {*=} opt_msg The message associated with the error.\n * @constructor\n * @extends {Error}\n */\ngoog.debug.Error = function(opt_msg) {\n\n  // Attempt to ensure there is a stack trace.\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, goog.debug.Error);\n  } else {\n    var stack = new Error().stack;\n    if (stack) {\n      this.stack = stack;\n    }\n  }\n\n  if (opt_msg) {\n    this.message = String(opt_msg);\n  }\n\n  /**\n   * Whether to report this error to the server. Setting this to false will\n   * cause the error reporter to not report the error back to the server,\n   * which can be useful if the client knows that the error has already been\n   * logged on the server.\n   * @type {boolean}\n   */\n  this.reportErrorToServer = true;\n};\ngoog.inherits(goog.debug.Error, Error);\n\n\n/** @override */\ngoog.debug.Error.prototype.name = 'CustomError';\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Definition of goog.dom.NodeType.\n */\n\ngoog.provide('goog.dom.NodeType');\n\n\n/**\n * Constants for the nodeType attribute in the Node interface.\n *\n * These constants match those specified in the Node interface. These are\n * usually present on the Node object in recent browsers, but not in older\n * browsers (specifically, early IEs) and thus are given here.\n *\n * In some browsers (early IEs), these are not defined on the Node object,\n * so they are provided here.\n *\n * See http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-1950641247\n * @enum {number}\n */\ngoog.dom.NodeType = {\n  ELEMENT: 1,\n  ATTRIBUTE: 2,\n  TEXT: 3,\n  CDATA_SECTION: 4,\n  ENTITY_REFERENCE: 5,\n  ENTITY: 6,\n  PROCESSING_INSTRUCTION: 7,\n  COMMENT: 8,\n  DOCUMENT: 9,\n  DOCUMENT_TYPE: 10,\n  DOCUMENT_FRAGMENT: 11,\n  NOTATION: 12\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for string manipulation.\n * @author arv@google.com (Erik Arvidsson)\n */\n\n\n/**\n * Namespace for string utilities\n */\ngoog.provide('goog.string');\ngoog.provide('goog.string.Unicode');\n\n\n/**\n * @define {boolean} Enables HTML escaping of lowercase letter \"e\" which helps\n * with detection of double-escaping as this letter is frequently used.\n */\ngoog.define('goog.string.DETECT_DOUBLE_ESCAPING', false);\n\n\n/**\n * @define {boolean} Whether to force non-dom html unescaping.\n */\ngoog.define('goog.string.FORCE_NON_DOM_HTML_UNESCAPING', false);\n\n\n/**\n * Common Unicode string characters.\n * @enum {string}\n */\ngoog.string.Unicode = {\n  NBSP: '\\xa0'\n};\n\n\n/**\n * Fast prefix-checker.\n * @param {string} str The string to check.\n * @param {string} prefix A string to look for at the start of {@code str}.\n * @return {boolean} True if {@code str} begins with {@code prefix}.\n */\ngoog.string.startsWith = function(str, prefix) {\n  return str.lastIndexOf(prefix, 0) == 0;\n};\n\n\n/**\n * Fast suffix-checker.\n * @param {string} str The string to check.\n * @param {string} suffix A string to look for at the end of {@code str}.\n * @return {boolean} True if {@code str} ends with {@code suffix}.\n */\ngoog.string.endsWith = function(str, suffix) {\n  var l = str.length - suffix.length;\n  return l >= 0 && str.indexOf(suffix, l) == l;\n};\n\n\n/**\n * Case-insensitive prefix-checker.\n * @param {string} str The string to check.\n * @param {string} prefix  A string to look for at the end of {@code str}.\n * @return {boolean} True if {@code str} begins with {@code prefix} (ignoring\n *     case).\n */\ngoog.string.caseInsensitiveStartsWith = function(str, prefix) {\n  return goog.string.caseInsensitiveCompare(\n             prefix, str.substr(0, prefix.length)) == 0;\n};\n\n\n/**\n * Case-insensitive suffix-checker.\n * @param {string} str The string to check.\n * @param {string} suffix A string to look for at the end of {@code str}.\n * @return {boolean} True if {@code str} ends with {@code suffix} (ignoring\n *     case).\n */\ngoog.string.caseInsensitiveEndsWith = function(str, suffix) {\n  return (\n      goog.string.caseInsensitiveCompare(\n          suffix, str.substr(str.length - suffix.length, suffix.length)) == 0);\n};\n\n\n/**\n * Case-insensitive equality checker.\n * @param {string} str1 First string to check.\n * @param {string} str2 Second string to check.\n * @return {boolean} True if {@code str1} and {@code str2} are the same string,\n *     ignoring case.\n */\ngoog.string.caseInsensitiveEquals = function(str1, str2) {\n  return str1.toLowerCase() == str2.toLowerCase();\n};\n\n\n/**\n * Does simple python-style string substitution.\n * subs(\"foo%s hot%s\", \"bar\", \"dog\") becomes \"foobar hotdog\".\n * @param {string} str The string containing the pattern.\n * @param {...*} var_args The items to substitute into the pattern.\n * @return {string} A copy of {@code str} in which each occurrence of\n *     {@code %s} has been replaced an argument from {@code var_args}.\n */\ngoog.string.subs = function(str, var_args) {\n  var splitParts = str.split('%s');\n  var returnString = '';\n\n  var subsArguments = Array.prototype.slice.call(arguments, 1);\n  while (subsArguments.length &&\n         // Replace up to the last split part. We are inserting in the\n         // positions between split parts.\n         splitParts.length > 1) {\n    returnString += splitParts.shift() + subsArguments.shift();\n  }\n\n  return returnString + splitParts.join('%s');  // Join unused '%s'\n};\n\n\n/**\n * Converts multiple whitespace chars (spaces, non-breaking-spaces, new lines\n * and tabs) to a single space, and strips leading and trailing whitespace.\n * @param {string} str Input string.\n * @return {string} A copy of {@code str} with collapsed whitespace.\n */\ngoog.string.collapseWhitespace = function(str) {\n  // Since IE doesn't include non-breaking-space (0xa0) in their \\s character\n  // class (as required by section 7.2 of the ECMAScript spec), we explicitly\n  // include it in the regexp to enforce consistent cross-browser behavior.\n  return str.replace(/[\\s\\xa0]+/g, ' ').replace(/^\\s+|\\s+$/g, '');\n};\n\n\n/**\n * Checks if a string is empty or contains only whitespaces.\n * @param {string} str The string to check.\n * @return {boolean} Whether {@code str} is empty or whitespace only.\n */\ngoog.string.isEmptyOrWhitespace = function(str) {\n  // testing length == 0 first is actually slower in all browsers (about the\n  // same in Opera).\n  // Since IE doesn't include non-breaking-space (0xa0) in their \\s character\n  // class (as required by section 7.2 of the ECMAScript spec), we explicitly\n  // include it in the regexp to enforce consistent cross-browser behavior.\n  return /^[\\s\\xa0]*$/.test(str);\n};\n\n\n/**\n * Checks if a string is empty.\n * @param {string} str The string to check.\n * @return {boolean} Whether {@code str} is empty.\n */\ngoog.string.isEmptyString = function(str) {\n  return str.length == 0;\n};\n\n\n/**\n * Checks if a string is empty or contains only whitespaces.\n *\n * TODO(user): Deprecate this when clients have been switched over to\n * goog.string.isEmptyOrWhitespace.\n *\n * @param {string} str The string to check.\n * @return {boolean} Whether {@code str} is empty or whitespace only.\n */\ngoog.string.isEmpty = goog.string.isEmptyOrWhitespace;\n\n\n/**\n * Checks if a string is null, undefined, empty or contains only whitespaces.\n * @param {*} str The string to check.\n * @return {boolean} Whether {@code str} is null, undefined, empty, or\n *     whitespace only.\n * @deprecated Use goog.string.isEmptyOrWhitespace(goog.string.makeSafe(str))\n *     instead.\n */\ngoog.string.isEmptyOrWhitespaceSafe = function(str) {\n  return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(str));\n};\n\n\n/**\n * Checks if a string is null, undefined, empty or contains only whitespaces.\n *\n * TODO(user): Deprecate this when clients have been switched over to\n * goog.string.isEmptyOrWhitespaceSafe.\n *\n * @param {*} str The string to check.\n * @return {boolean} Whether {@code str} is null, undefined, empty, or\n *     whitespace only.\n */\ngoog.string.isEmptySafe = goog.string.isEmptyOrWhitespaceSafe;\n\n\n/**\n * Checks if a string is all breaking whitespace.\n * @param {string} str The string to check.\n * @return {boolean} Whether the string is all breaking whitespace.\n */\ngoog.string.isBreakingWhitespace = function(str) {\n  return !/[^\\t\\n\\r ]/.test(str);\n};\n\n\n/**\n * Checks if a string contains all letters.\n * @param {string} str string to check.\n * @return {boolean} True if {@code str} consists entirely of letters.\n */\ngoog.string.isAlpha = function(str) {\n  return !/[^a-zA-Z]/.test(str);\n};\n\n\n/**\n * Checks if a string contains only numbers.\n * @param {*} str string to check. If not a string, it will be\n *     casted to one.\n * @return {boolean} True if {@code str} is numeric.\n */\ngoog.string.isNumeric = function(str) {\n  return !/[^0-9]/.test(str);\n};\n\n\n/**\n * Checks if a string contains only numbers or letters.\n * @param {string} str string to check.\n * @return {boolean} True if {@code str} is alphanumeric.\n */\ngoog.string.isAlphaNumeric = function(str) {\n  return !/[^a-zA-Z0-9]/.test(str);\n};\n\n\n/**\n * Checks if a character is a space character.\n * @param {string} ch Character to check.\n * @return {boolean} True if {@code ch} is a space.\n */\ngoog.string.isSpace = function(ch) {\n  return ch == ' ';\n};\n\n\n/**\n * Checks if a character is a valid unicode character.\n * @param {string} ch Character to check.\n * @return {boolean} True if {@code ch} is a valid unicode character.\n */\ngoog.string.isUnicodeChar = function(ch) {\n  return ch.length == 1 && ch >= ' ' && ch <= '~' ||\n      ch >= '\\u0080' && ch <= '\\uFFFD';\n};\n\n\n/**\n * Takes a string and replaces newlines with a space. Multiple lines are\n * replaced with a single space.\n * @param {string} str The string from which to strip newlines.\n * @return {string} A copy of {@code str} stripped of newlines.\n */\ngoog.string.stripNewlines = function(str) {\n  return str.replace(/(\\r\\n|\\r|\\n)+/g, ' ');\n};\n\n\n/**\n * Replaces Windows and Mac new lines with unix style: \\r or \\r\\n with \\n.\n * @param {string} str The string to in which to canonicalize newlines.\n * @return {string} {@code str} A copy of {@code} with canonicalized newlines.\n */\ngoog.string.canonicalizeNewlines = function(str) {\n  return str.replace(/(\\r\\n|\\r|\\n)/g, '\\n');\n};\n\n\n/**\n * Normalizes whitespace in a string, replacing all whitespace chars with\n * a space.\n * @param {string} str The string in which to normalize whitespace.\n * @return {string} A copy of {@code str} with all whitespace normalized.\n */\ngoog.string.normalizeWhitespace = function(str) {\n  return str.replace(/\\xa0|\\s/g, ' ');\n};\n\n\n/**\n * Normalizes spaces in a string, replacing all consecutive spaces and tabs\n * with a single space. Replaces non-breaking space with a space.\n * @param {string} str The string in which to normalize spaces.\n * @return {string} A copy of {@code str} with all consecutive spaces and tabs\n *    replaced with a single space.\n */\ngoog.string.normalizeSpaces = function(str) {\n  return str.replace(/\\xa0|[ \\t]+/g, ' ');\n};\n\n\n/**\n * Removes the breaking spaces from the left and right of the string and\n * collapses the sequences of breaking spaces in the middle into single spaces.\n * The original and the result strings render the same way in HTML.\n * @param {string} str A string in which to collapse spaces.\n * @return {string} Copy of the string with normalized breaking spaces.\n */\ngoog.string.collapseBreakingSpaces = function(str) {\n  return str.replace(/[\\t\\r\\n ]+/g, ' ')\n      .replace(/^[\\t\\r\\n ]+|[\\t\\r\\n ]+$/g, '');\n};\n\n\n/**\n * Trims white spaces to the left and right of a string.\n * @param {string} str The string to trim.\n * @return {string} A trimmed copy of {@code str}.\n */\ngoog.string.trim =\n    (goog.TRUSTED_SITE && String.prototype.trim) ? function(str) {\n      return str.trim();\n    } : function(str) {\n      // Since IE doesn't include non-breaking-space (0xa0) in their \\s\n      // character class (as required by section 7.2 of the ECMAScript spec),\n      // we explicitly include it in the regexp to enforce consistent\n      // cross-browser behavior.\n      return str.replace(/^[\\s\\xa0]+|[\\s\\xa0]+$/g, '');\n    };\n\n\n/**\n * Trims whitespaces at the left end of a string.\n * @param {string} str The string to left trim.\n * @return {string} A trimmed copy of {@code str}.\n */\ngoog.string.trimLeft = function(str) {\n  // Since IE doesn't include non-breaking-space (0xa0) in their \\s character\n  // class (as required by section 7.2 of the ECMAScript spec), we explicitly\n  // include it in the regexp to enforce consistent cross-browser behavior.\n  return str.replace(/^[\\s\\xa0]+/, '');\n};\n\n\n/**\n * Trims whitespaces at the right end of a string.\n * @param {string} str The string to right trim.\n * @return {string} A trimmed copy of {@code str}.\n */\ngoog.string.trimRight = function(str) {\n  // Since IE doesn't include non-breaking-space (0xa0) in their \\s character\n  // class (as required by section 7.2 of the ECMAScript spec), we explicitly\n  // include it in the regexp to enforce consistent cross-browser behavior.\n  return str.replace(/[\\s\\xa0]+$/, '');\n};\n\n\n/**\n * A string comparator that ignores case.\n * -1 = str1 less than str2\n *  0 = str1 equals str2\n *  1 = str1 greater than str2\n *\n * @param {string} str1 The string to compare.\n * @param {string} str2 The string to compare {@code str1} to.\n * @return {number} The comparator result, as described above.\n */\ngoog.string.caseInsensitiveCompare = function(str1, str2) {\n  var test1 = String(str1).toLowerCase();\n  var test2 = String(str2).toLowerCase();\n\n  if (test1 < test2) {\n    return -1;\n  } else if (test1 == test2) {\n    return 0;\n  } else {\n    return 1;\n  }\n};\n\n\n/**\n * Compares two strings interpreting their numeric substrings as numbers.\n *\n * @param {string} str1 First string.\n * @param {string} str2 Second string.\n * @param {!RegExp} tokenizerRegExp Splits a string into substrings of\n *     non-negative integers, non-numeric characters and optionally fractional\n *     numbers starting with a decimal point.\n * @return {number} Negative if str1 < str2, 0 is str1 == str2, positive if\n *     str1 > str2.\n * @private\n */\ngoog.string.numberAwareCompare_ = function(str1, str2, tokenizerRegExp) {\n  if (str1 == str2) {\n    return 0;\n  }\n  if (!str1) {\n    return -1;\n  }\n  if (!str2) {\n    return 1;\n  }\n\n  // Using match to split the entire string ahead of time turns out to be faster\n  // for most inputs than using RegExp.exec or iterating over each character.\n  var tokens1 = str1.toLowerCase().match(tokenizerRegExp);\n  var tokens2 = str2.toLowerCase().match(tokenizerRegExp);\n\n  var count = Math.min(tokens1.length, tokens2.length);\n\n  for (var i = 0; i < count; i++) {\n    var a = tokens1[i];\n    var b = tokens2[i];\n\n    // Compare pairs of tokens, returning if one token sorts before the other.\n    if (a != b) {\n      // Only if both tokens are integers is a special comparison required.\n      // Decimal numbers are sorted as strings (e.g., '.09' < '.1').\n      var num1 = parseInt(a, 10);\n      if (!isNaN(num1)) {\n        var num2 = parseInt(b, 10);\n        if (!isNaN(num2) && num1 - num2) {\n          return num1 - num2;\n        }\n      }\n      return a < b ? -1 : 1;\n    }\n  }\n\n  // If one string is a substring of the other, the shorter string sorts first.\n  if (tokens1.length != tokens2.length) {\n    return tokens1.length - tokens2.length;\n  }\n\n  // The two strings must be equivalent except for case (perfect equality is\n  // tested at the head of the function.) Revert to default ASCII string\n  // comparison to stabilize the sort.\n  return str1 < str2 ? -1 : 1;\n};\n\n\n/**\n * String comparison function that handles non-negative integer numbers in a\n * way humans might expect. Using this function, the string 'File 2.jpg' sorts\n * before 'File 10.jpg', and 'Version 1.9' before 'Version 1.10'. The comparison\n * is mostly case-insensitive, though strings that are identical except for case\n * are sorted with the upper-case strings before lower-case.\n *\n * This comparison function is up to 50x slower than either the default or the\n * case-insensitive compare. It should not be used in time-critical code, but\n * should be fast enough to sort several hundred short strings (like filenames)\n * with a reasonable delay.\n *\n * @param {string} str1 The string to compare in a numerically sensitive way.\n * @param {string} str2 The string to compare {@code str1} to.\n * @return {number} less than 0 if str1 < str2, 0 if str1 == str2, greater than\n *     0 if str1 > str2.\n */\ngoog.string.intAwareCompare = function(str1, str2) {\n  return goog.string.numberAwareCompare_(str1, str2, /\\d+|\\D+/g);\n};\n\n\n/**\n * String comparison function that handles non-negative integer and fractional\n * numbers in a way humans might expect. Using this function, the string\n * 'File 2.jpg' sorts before 'File 10.jpg', and '3.14' before '3.2'. Equivalent\n * to {@link goog.string.intAwareCompare} apart from the way how it interprets\n * dots.\n *\n * @param {string} str1 The string to compare in a numerically sensitive way.\n * @param {string} str2 The string to compare {@code str1} to.\n * @return {number} less than 0 if str1 < str2, 0 if str1 == str2, greater than\n *     0 if str1 > str2.\n */\ngoog.string.floatAwareCompare = function(str1, str2) {\n  return goog.string.numberAwareCompare_(str1, str2, /\\d+|\\.\\d+|\\D+/g);\n};\n\n\n/**\n * Alias for {@link goog.string.floatAwareCompare}.\n *\n * @param {string} str1\n * @param {string} str2\n * @return {number}\n */\ngoog.string.numerateCompare = goog.string.floatAwareCompare;\n\n\n/**\n * URL-encodes a string\n * @param {*} str The string to url-encode.\n * @return {string} An encoded copy of {@code str} that is safe for urls.\n *     Note that '#', ':', and other characters used to delimit portions\n *     of URLs *will* be encoded.\n */\ngoog.string.urlEncode = function(str) {\n  return encodeURIComponent(String(str));\n};\n\n\n/**\n * URL-decodes the string. We need to specially handle '+'s because\n * the javascript library doesn't convert them to spaces.\n * @param {string} str The string to url decode.\n * @return {string} The decoded {@code str}.\n */\ngoog.string.urlDecode = function(str) {\n  return decodeURIComponent(str.replace(/\\+/g, ' '));\n};\n\n\n/**\n * Converts \\n to <br>s or <br />s.\n * @param {string} str The string in which to convert newlines.\n * @param {boolean=} opt_xml Whether to use XML compatible tags.\n * @return {string} A copy of {@code str} with converted newlines.\n */\ngoog.string.newLineToBr = function(str, opt_xml) {\n  return str.replace(/(\\r\\n|\\r|\\n)/g, opt_xml ? '<br />' : '<br>');\n};\n\n\n/**\n * Escapes double quote '\"' and single quote '\\'' characters in addition to\n * '&', '<', and '>' so that a string can be included in an HTML tag attribute\n * value within double or single quotes.\n *\n * It should be noted that > doesn't need to be escaped for the HTML or XML to\n * be valid, but it has been decided to escape it for consistency with other\n * implementations.\n *\n * With goog.string.DETECT_DOUBLE_ESCAPING, this function escapes also the\n * lowercase letter \"e\".\n *\n * NOTE(user):\n * HtmlEscape is often called during the generation of large blocks of HTML.\n * Using statics for the regular expressions and strings is an optimization\n * that can more than half the amount of time IE spends in this function for\n * large apps, since strings and regexes both contribute to GC allocations.\n *\n * Testing for the presence of a character before escaping increases the number\n * of function calls, but actually provides a speed increase for the average\n * case -- since the average case often doesn't require the escaping of all 4\n * characters and indexOf() is much cheaper than replace().\n * The worst case does suffer slightly from the additional calls, therefore the\n * opt_isLikelyToContainHtmlChars option has been included for situations\n * where all 4 HTML entities are very likely to be present and need escaping.\n *\n * Some benchmarks (times tended to fluctuate +-0.05ms):\n *                                     FireFox                     IE6\n * (no chars / average (mix of cases) / all 4 chars)\n * no checks                     0.13 / 0.22 / 0.22         0.23 / 0.53 / 0.80\n * indexOf                       0.08 / 0.17 / 0.26         0.22 / 0.54 / 0.84\n * indexOf + re test             0.07 / 0.17 / 0.28         0.19 / 0.50 / 0.85\n *\n * An additional advantage of checking if replace actually needs to be called\n * is a reduction in the number of object allocations, so as the size of the\n * application grows the difference between the various methods would increase.\n *\n * @param {string} str string to be escaped.\n * @param {boolean=} opt_isLikelyToContainHtmlChars Don't perform a check to see\n *     if the character needs replacing - use this option if you expect each of\n *     the characters to appear often. Leave false if you expect few html\n *     characters to occur in your strings, such as if you are escaping HTML.\n * @return {string} An escaped copy of {@code str}.\n */\ngoog.string.htmlEscape = function(str, opt_isLikelyToContainHtmlChars) {\n\n  if (opt_isLikelyToContainHtmlChars) {\n    str = str.replace(goog.string.AMP_RE_, '&amp;')\n              .replace(goog.string.LT_RE_, '&lt;')\n              .replace(goog.string.GT_RE_, '&gt;')\n              .replace(goog.string.QUOT_RE_, '&quot;')\n              .replace(goog.string.SINGLE_QUOTE_RE_, '&#39;')\n              .replace(goog.string.NULL_RE_, '&#0;');\n    if (goog.string.DETECT_DOUBLE_ESCAPING) {\n      str = str.replace(goog.string.E_RE_, '&#101;');\n    }\n    return str;\n\n  } else {\n    // quick test helps in the case when there are no chars to replace, in\n    // worst case this makes barely a difference to the time taken\n    if (!goog.string.ALL_RE_.test(str)) return str;\n\n    // str.indexOf is faster than regex.test in this case\n    if (str.indexOf('&') != -1) {\n      str = str.replace(goog.string.AMP_RE_, '&amp;');\n    }\n    if (str.indexOf('<') != -1) {\n      str = str.replace(goog.string.LT_RE_, '&lt;');\n    }\n    if (str.indexOf('>') != -1) {\n      str = str.replace(goog.string.GT_RE_, '&gt;');\n    }\n    if (str.indexOf('\"') != -1) {\n      str = str.replace(goog.string.QUOT_RE_, '&quot;');\n    }\n    if (str.indexOf('\\'') != -1) {\n      str = str.replace(goog.string.SINGLE_QUOTE_RE_, '&#39;');\n    }\n    if (str.indexOf('\\x00') != -1) {\n      str = str.replace(goog.string.NULL_RE_, '&#0;');\n    }\n    if (goog.string.DETECT_DOUBLE_ESCAPING && str.indexOf('e') != -1) {\n      str = str.replace(goog.string.E_RE_, '&#101;');\n    }\n    return str;\n  }\n};\n\n\n/**\n * Regular expression that matches an ampersand, for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.AMP_RE_ = /&/g;\n\n\n/**\n * Regular expression that matches a less than sign, for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.LT_RE_ = /</g;\n\n\n/**\n * Regular expression that matches a greater than sign, for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.GT_RE_ = />/g;\n\n\n/**\n * Regular expression that matches a double quote, for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.QUOT_RE_ = /\"/g;\n\n\n/**\n * Regular expression that matches a single quote, for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.SINGLE_QUOTE_RE_ = /'/g;\n\n\n/**\n * Regular expression that matches null character, for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.NULL_RE_ = /\\x00/g;\n\n\n/**\n * Regular expression that matches a lowercase letter \"e\", for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.E_RE_ = /e/g;\n\n\n/**\n * Regular expression that matches any character that needs to be escaped.\n * @const {!RegExp}\n * @private\n */\ngoog.string.ALL_RE_ =\n    (goog.string.DETECT_DOUBLE_ESCAPING ? /[\\x00&<>\"'e]/ : /[\\x00&<>\"']/);\n\n\n/**\n * Unescapes an HTML string.\n *\n * @param {string} str The string to unescape.\n * @return {string} An unescaped copy of {@code str}.\n */\ngoog.string.unescapeEntities = function(str) {\n  if (goog.string.contains(str, '&')) {\n    // We are careful not to use a DOM if we do not have one or we explicitly\n    // requested non-DOM html unescaping.\n    if (!goog.string.FORCE_NON_DOM_HTML_UNESCAPING &&\n        'document' in goog.global) {\n      return goog.string.unescapeEntitiesUsingDom_(str);\n    } else {\n      // Fall back on pure XML entities\n      return goog.string.unescapePureXmlEntities_(str);\n    }\n  }\n  return str;\n};\n\n\n/**\n * Unescapes a HTML string using the provided document.\n *\n * @param {string} str The string to unescape.\n * @param {!Document} document A document to use in escaping the string.\n * @return {string} An unescaped copy of {@code str}.\n */\ngoog.string.unescapeEntitiesWithDocument = function(str, document) {\n  if (goog.string.contains(str, '&')) {\n    return goog.string.unescapeEntitiesUsingDom_(str, document);\n  }\n  return str;\n};\n\n\n/**\n * Unescapes an HTML string using a DOM to resolve non-XML, non-numeric\n * entities. This function is XSS-safe and whitespace-preserving.\n * @private\n * @param {string} str The string to unescape.\n * @param {Document=} opt_document An optional document to use for creating\n *     elements. If this is not specified then the default window.document\n *     will be used.\n * @return {string} The unescaped {@code str} string.\n */\ngoog.string.unescapeEntitiesUsingDom_ = function(str, opt_document) {\n  /** @type {!Object<string, string>} */\n  var seen = {'&amp;': '&', '&lt;': '<', '&gt;': '>', '&quot;': '\"'};\n  var div;\n  if (opt_document) {\n    div = opt_document.createElement('div');\n  } else {\n    div = goog.global.document.createElement('div');\n  }\n  // Match as many valid entity characters as possible. If the actual entity\n  // happens to be shorter, it will still work as innerHTML will return the\n  // trailing characters unchanged. Since the entity characters do not include\n  // open angle bracket, there is no chance of XSS from the innerHTML use.\n  // Since no whitespace is passed to innerHTML, whitespace is preserved.\n  return str.replace(goog.string.HTML_ENTITY_PATTERN_, function(s, entity) {\n    // Check for cached entity.\n    var value = seen[s];\n    if (value) {\n      return value;\n    }\n    // Check for numeric entity.\n    if (entity.charAt(0) == '#') {\n      // Prefix with 0 so that hex entities (e.g. &#x10) parse as hex numbers.\n      var n = Number('0' + entity.substr(1));\n      if (!isNaN(n)) {\n        value = String.fromCharCode(n);\n      }\n    }\n    // Fall back to innerHTML otherwise.\n    if (!value) {\n      // Append a non-entity character to avoid a bug in Webkit that parses\n      // an invalid entity at the end of innerHTML text as the empty string.\n      div.innerHTML = s + ' ';\n      // Then remove the trailing character from the result.\n      value = div.firstChild.nodeValue.slice(0, -1);\n    }\n    // Cache and return.\n    return seen[s] = value;\n  });\n};\n\n\n/**\n * Unescapes XML entities.\n * @private\n * @param {string} str The string to unescape.\n * @return {string} An unescaped copy of {@code str}.\n */\ngoog.string.unescapePureXmlEntities_ = function(str) {\n  return str.replace(/&([^;]+);/g, function(s, entity) {\n    switch (entity) {\n      case 'amp':\n        return '&';\n      case 'lt':\n        return '<';\n      case 'gt':\n        return '>';\n      case 'quot':\n        return '\"';\n      default:\n        if (entity.charAt(0) == '#') {\n          // Prefix with 0 so that hex entities (e.g. &#x10) parse as hex.\n          var n = Number('0' + entity.substr(1));\n          if (!isNaN(n)) {\n            return String.fromCharCode(n);\n          }\n        }\n        // For invalid entities we just return the entity\n        return s;\n    }\n  });\n};\n\n\n/**\n * Regular expression that matches an HTML entity.\n * See also HTML5: Tokenization / Tokenizing character references.\n * @private\n * @type {!RegExp}\n */\ngoog.string.HTML_ENTITY_PATTERN_ = /&([^;\\s<&]+);?/g;\n\n\n/**\n * Do escaping of whitespace to preserve spatial formatting. We use character\n * entity #160 to make it safer for xml.\n * @param {string} str The string in which to escape whitespace.\n * @param {boolean=} opt_xml Whether to use XML compatible tags.\n * @return {string} An escaped copy of {@code str}.\n */\ngoog.string.whitespaceEscape = function(str, opt_xml) {\n  // This doesn't use goog.string.preserveSpaces for backwards compatibility.\n  return goog.string.newLineToBr(str.replace(/  /g, ' &#160;'), opt_xml);\n};\n\n\n/**\n * Preserve spaces that would be otherwise collapsed in HTML by replacing them\n * with non-breaking space Unicode characters.\n * @param {string} str The string in which to preserve whitespace.\n * @return {string} A copy of {@code str} with preserved whitespace.\n */\ngoog.string.preserveSpaces = function(str) {\n  return str.replace(/(^|[\\n ]) /g, '$1' + goog.string.Unicode.NBSP);\n};\n\n\n/**\n * Strip quote characters around a string.  The second argument is a string of\n * characters to treat as quotes.  This can be a single character or a string of\n * multiple character and in that case each of those are treated as possible\n * quote characters. For example:\n *\n * <pre>\n * goog.string.stripQuotes('\"abc\"', '\"`') --> 'abc'\n * goog.string.stripQuotes('`abc`', '\"`') --> 'abc'\n * </pre>\n *\n * @param {string} str The string to strip.\n * @param {string} quoteChars The quote characters to strip.\n * @return {string} A copy of {@code str} without the quotes.\n */\ngoog.string.stripQuotes = function(str, quoteChars) {\n  var length = quoteChars.length;\n  for (var i = 0; i < length; i++) {\n    var quoteChar = length == 1 ? quoteChars : quoteChars.charAt(i);\n    if (str.charAt(0) == quoteChar && str.charAt(str.length - 1) == quoteChar) {\n      return str.substring(1, str.length - 1);\n    }\n  }\n  return str;\n};\n\n\n/**\n * Truncates a string to a certain length and adds '...' if necessary.  The\n * length also accounts for the ellipsis, so a maximum length of 10 and a string\n * 'Hello World!' produces 'Hello W...'.\n * @param {string} str The string to truncate.\n * @param {number} chars Max number of characters.\n * @param {boolean=} opt_protectEscapedCharacters Whether to protect escaped\n *     characters from being cut off in the middle.\n * @return {string} The truncated {@code str} string.\n */\ngoog.string.truncate = function(str, chars, opt_protectEscapedCharacters) {\n  if (opt_protectEscapedCharacters) {\n    str = goog.string.unescapeEntities(str);\n  }\n\n  if (str.length > chars) {\n    str = str.substring(0, chars - 3) + '...';\n  }\n\n  if (opt_protectEscapedCharacters) {\n    str = goog.string.htmlEscape(str);\n  }\n\n  return str;\n};\n\n\n/**\n * Truncate a string in the middle, adding \"...\" if necessary,\n * and favoring the beginning of the string.\n * @param {string} str The string to truncate the middle of.\n * @param {number} chars Max number of characters.\n * @param {boolean=} opt_protectEscapedCharacters Whether to protect escaped\n *     characters from being cutoff in the middle.\n * @param {number=} opt_trailingChars Optional number of trailing characters to\n *     leave at the end of the string, instead of truncating as close to the\n *     middle as possible.\n * @return {string} A truncated copy of {@code str}.\n */\ngoog.string.truncateMiddle = function(\n    str, chars, opt_protectEscapedCharacters, opt_trailingChars) {\n  if (opt_protectEscapedCharacters) {\n    str = goog.string.unescapeEntities(str);\n  }\n\n  if (opt_trailingChars && str.length > chars) {\n    if (opt_trailingChars > chars) {\n      opt_trailingChars = chars;\n    }\n    var endPoint = str.length - opt_trailingChars;\n    var startPoint = chars - opt_trailingChars;\n    str = str.substring(0, startPoint) + '...' + str.substring(endPoint);\n  } else if (str.length > chars) {\n    // Favor the beginning of the string:\n    var half = Math.floor(chars / 2);\n    var endPos = str.length - half;\n    half += chars % 2;\n    str = str.substring(0, half) + '...' + str.substring(endPos);\n  }\n\n  if (opt_protectEscapedCharacters) {\n    str = goog.string.htmlEscape(str);\n  }\n\n  return str;\n};\n\n\n/**\n * Special chars that need to be escaped for goog.string.quote.\n * @private {!Object<string, string>}\n */\ngoog.string.specialEscapeChars_ = {\n  '\\0': '\\\\0',\n  '\\b': '\\\\b',\n  '\\f': '\\\\f',\n  '\\n': '\\\\n',\n  '\\r': '\\\\r',\n  '\\t': '\\\\t',\n  '\\x0B': '\\\\x0B',  // '\\v' is not supported in JScript\n  '\"': '\\\\\"',\n  '\\\\': '\\\\\\\\',\n  // To support the use case of embedding quoted strings inside of script\n  // tags, we have to make sure HTML comments and opening/closing script tags do\n  // not appear in the resulting string. The specific strings that must be\n  // escaped are documented at:\n  // http://www.w3.org/TR/html51/semantics.html#restrictions-for-contents-of-script-elements\n  '<': '\\x3c'\n};\n\n\n/**\n * Character mappings used internally for goog.string.escapeChar.\n * @private {!Object<string, string>}\n */\ngoog.string.jsEscapeCache_ = {\n  '\\'': '\\\\\\''\n};\n\n\n/**\n * Encloses a string in double quotes and escapes characters so that the\n * string is a valid JS string. The resulting string is safe to embed in\n * `<script>` tags as \"<\" is escaped.\n * @param {string} s The string to quote.\n * @return {string} A copy of {@code s} surrounded by double quotes.\n */\ngoog.string.quote = function(s) {\n  s = String(s);\n  var sb = ['\"'];\n  for (var i = 0; i < s.length; i++) {\n    var ch = s.charAt(i);\n    var cc = ch.charCodeAt(0);\n    sb[i + 1] = goog.string.specialEscapeChars_[ch] ||\n        ((cc > 31 && cc < 127) ? ch : goog.string.escapeChar(ch));\n  }\n  sb.push('\"');\n  return sb.join('');\n};\n\n\n/**\n * Takes a string and returns the escaped string for that character.\n * @param {string} str The string to escape.\n * @return {string} An escaped string representing {@code str}.\n */\ngoog.string.escapeString = function(str) {\n  var sb = [];\n  for (var i = 0; i < str.length; i++) {\n    sb[i] = goog.string.escapeChar(str.charAt(i));\n  }\n  return sb.join('');\n};\n\n\n/**\n * Takes a character and returns the escaped string for that character. For\n * example escapeChar(String.fromCharCode(15)) -> \"\\\\x0E\".\n * @param {string} c The character to escape.\n * @return {string} An escaped string representing {@code c}.\n */\ngoog.string.escapeChar = function(c) {\n  if (c in goog.string.jsEscapeCache_) {\n    return goog.string.jsEscapeCache_[c];\n  }\n\n  if (c in goog.string.specialEscapeChars_) {\n    return goog.string.jsEscapeCache_[c] = goog.string.specialEscapeChars_[c];\n  }\n\n  var rv = c;\n  var cc = c.charCodeAt(0);\n  if (cc > 31 && cc < 127) {\n    rv = c;\n  } else {\n    // tab is 9 but handled above\n    if (cc < 256) {\n      rv = '\\\\x';\n      if (cc < 16 || cc > 256) {\n        rv += '0';\n      }\n    } else {\n      rv = '\\\\u';\n      if (cc < 4096) {  // \\u1000\n        rv += '0';\n      }\n    }\n    rv += cc.toString(16).toUpperCase();\n  }\n\n  return goog.string.jsEscapeCache_[c] = rv;\n};\n\n\n/**\n * Determines whether a string contains a substring.\n * @param {string} str The string to search.\n * @param {string} subString The substring to search for.\n * @return {boolean} Whether {@code str} contains {@code subString}.\n */\ngoog.string.contains = function(str, subString) {\n  return str.indexOf(subString) != -1;\n};\n\n\n/**\n * Determines whether a string contains a substring, ignoring case.\n * @param {string} str The string to search.\n * @param {string} subString The substring to search for.\n * @return {boolean} Whether {@code str} contains {@code subString}.\n */\ngoog.string.caseInsensitiveContains = function(str, subString) {\n  return goog.string.contains(str.toLowerCase(), subString.toLowerCase());\n};\n\n\n/**\n * Returns the non-overlapping occurrences of ss in s.\n * If either s or ss evalutes to false, then returns zero.\n * @param {string} s The string to look in.\n * @param {string} ss The string to look for.\n * @return {number} Number of occurrences of ss in s.\n */\ngoog.string.countOf = function(s, ss) {\n  return s && ss ? s.split(ss).length - 1 : 0;\n};\n\n\n/**\n * Removes a substring of a specified length at a specific\n * index in a string.\n * @param {string} s The base string from which to remove.\n * @param {number} index The index at which to remove the substring.\n * @param {number} stringLength The length of the substring to remove.\n * @return {string} A copy of {@code s} with the substring removed or the full\n *     string if nothing is removed or the input is invalid.\n */\ngoog.string.removeAt = function(s, index, stringLength) {\n  var resultStr = s;\n  // If the index is greater or equal to 0 then remove substring\n  if (index >= 0 && index < s.length && stringLength > 0) {\n    resultStr = s.substr(0, index) +\n        s.substr(index + stringLength, s.length - index - stringLength);\n  }\n  return resultStr;\n};\n\n\n/**\n * Removes the first occurrence of a substring from a string.\n * @param {string} str The base string from which to remove.\n * @param {string} substr The string to remove.\n * @return {string} A copy of {@code str} with {@code substr} removed or the\n *     full string if nothing is removed.\n */\ngoog.string.remove = function(str, substr) {\n  return str.replace(substr, '');\n};\n\n\n/**\n *  Removes all occurrences of a substring from a string.\n *  @param {string} s The base string from which to remove.\n *  @param {string} ss The string to remove.\n *  @return {string} A copy of {@code s} with {@code ss} removed or the full\n *      string if nothing is removed.\n */\ngoog.string.removeAll = function(s, ss) {\n  var re = new RegExp(goog.string.regExpEscape(ss), 'g');\n  return s.replace(re, '');\n};\n\n\n/**\n *  Replaces all occurrences of a substring of a string with a new substring.\n *  @param {string} s The base string from which to remove.\n *  @param {string} ss The string to replace.\n *  @param {string} replacement The replacement string.\n *  @return {string} A copy of {@code s} with {@code ss} replaced by\n *      {@code replacement} or the original string if nothing is replaced.\n */\ngoog.string.replaceAll = function(s, ss, replacement) {\n  var re = new RegExp(goog.string.regExpEscape(ss), 'g');\n  return s.replace(re, replacement.replace(/\\$/g, '$$$$'));\n};\n\n\n/**\n * Escapes characters in the string that are not safe to use in a RegExp.\n * @param {*} s The string to escape. If not a string, it will be casted\n *     to one.\n * @return {string} A RegExp safe, escaped copy of {@code s}.\n */\ngoog.string.regExpEscape = function(s) {\n  return String(s)\n      .replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')\n      .replace(/\\x08/g, '\\\\x08');\n};\n\n\n/**\n * Repeats a string n times.\n * @param {string} string The string to repeat.\n * @param {number} length The number of times to repeat.\n * @return {string} A string containing {@code length} repetitions of\n *     {@code string}.\n */\ngoog.string.repeat = (String.prototype.repeat) ? function(string, length) {\n  // The native method is over 100 times faster than the alternative.\n  return string.repeat(length);\n} : function(string, length) {\n  return new Array(length + 1).join(string);\n};\n\n\n/**\n * Pads number to given length and optionally rounds it to a given precision.\n * For example:\n * <pre>padNumber(1.25, 2, 3) -> '01.250'\n * padNumber(1.25, 2) -> '01.25'\n * padNumber(1.25, 2, 1) -> '01.3'\n * padNumber(1.25, 0) -> '1.25'</pre>\n *\n * @param {number} num The number to pad.\n * @param {number} length The desired length.\n * @param {number=} opt_precision The desired precision.\n * @return {string} {@code num} as a string with the given options.\n */\ngoog.string.padNumber = function(num, length, opt_precision) {\n  var s = goog.isDef(opt_precision) ? num.toFixed(opt_precision) : String(num);\n  var index = s.indexOf('.');\n  if (index == -1) {\n    index = s.length;\n  }\n  return goog.string.repeat('0', Math.max(0, length - index)) + s;\n};\n\n\n/**\n * Returns a string representation of the given object, with\n * null and undefined being returned as the empty string.\n *\n * @param {*} obj The object to convert.\n * @return {string} A string representation of the {@code obj}.\n */\ngoog.string.makeSafe = function(obj) {\n  return obj == null ? '' : String(obj);\n};\n\n\n/**\n * Concatenates string expressions. This is useful\n * since some browsers are very inefficient when it comes to using plus to\n * concat strings. Be careful when using null and undefined here since\n * these will not be included in the result. If you need to represent these\n * be sure to cast the argument to a String first.\n * For example:\n * <pre>buildString('a', 'b', 'c', 'd') -> 'abcd'\n * buildString(null, undefined) -> ''\n * </pre>\n * @param {...*} var_args A list of strings to concatenate. If not a string,\n *     it will be casted to one.\n * @return {string} The concatenation of {@code var_args}.\n */\ngoog.string.buildString = function(var_args) {\n  return Array.prototype.join.call(arguments, '');\n};\n\n\n/**\n * Returns a string with at least 64-bits of randomness.\n *\n * Doesn't trust Javascript's random function entirely. Uses a combination of\n * random and current timestamp, and then encodes the string in base-36 to\n * make it shorter.\n *\n * @return {string} A random string, e.g. sn1s7vb4gcic.\n */\ngoog.string.getRandomString = function() {\n  var x = 2147483648;\n  return Math.floor(Math.random() * x).toString(36) +\n      Math.abs(Math.floor(Math.random() * x) ^ goog.now()).toString(36);\n};\n\n\n/**\n * Compares two version numbers.\n *\n * @param {string|number} version1 Version of first item.\n * @param {string|number} version2 Version of second item.\n *\n * @return {number}  1 if {@code version1} is higher.\n *                   0 if arguments are equal.\n *                  -1 if {@code version2} is higher.\n */\ngoog.string.compareVersions = function(version1, version2) {\n  var order = 0;\n  // Trim leading and trailing whitespace and split the versions into\n  // subversions.\n  var v1Subs = goog.string.trim(String(version1)).split('.');\n  var v2Subs = goog.string.trim(String(version2)).split('.');\n  var subCount = Math.max(v1Subs.length, v2Subs.length);\n\n  // Iterate over the subversions, as long as they appear to be equivalent.\n  for (var subIdx = 0; order == 0 && subIdx < subCount; subIdx++) {\n    var v1Sub = v1Subs[subIdx] || '';\n    var v2Sub = v2Subs[subIdx] || '';\n\n    do {\n      // Split the subversions into pairs of numbers and qualifiers (like 'b').\n      // Two different RegExp objects are use to make it clear the code\n      // is side-effect free\n      var v1Comp = /(\\d*)(\\D*)(.*)/.exec(v1Sub) || ['', '', '', ''];\n      var v2Comp = /(\\d*)(\\D*)(.*)/.exec(v2Sub) || ['', '', '', ''];\n      // Break if there are no more matches.\n      if (v1Comp[0].length == 0 && v2Comp[0].length == 0) {\n        break;\n      }\n\n      // Parse the numeric part of the subversion. A missing number is\n      // equivalent to 0.\n      var v1CompNum = v1Comp[1].length == 0 ? 0 : parseInt(v1Comp[1], 10);\n      var v2CompNum = v2Comp[1].length == 0 ? 0 : parseInt(v2Comp[1], 10);\n\n      // Compare the subversion components. The number has the highest\n      // precedence. Next, if the numbers are equal, a subversion without any\n      // qualifier is always higher than a subversion with any qualifier. Next,\n      // the qualifiers are compared as strings.\n      order = goog.string.compareElements_(v1CompNum, v2CompNum) ||\n          goog.string.compareElements_(\n              v1Comp[2].length == 0, v2Comp[2].length == 0) ||\n          goog.string.compareElements_(v1Comp[2], v2Comp[2]);\n      // Stop as soon as an inequality is discovered.\n\n      v1Sub = v1Comp[3];\n      v2Sub = v2Comp[3];\n    } while (order == 0);\n  }\n\n  return order;\n};\n\n\n/**\n * Compares elements of a version number.\n *\n * @param {string|number|boolean} left An element from a version number.\n * @param {string|number|boolean} right An element from a version number.\n *\n * @return {number}  1 if {@code left} is higher.\n *                   0 if arguments are equal.\n *                  -1 if {@code right} is higher.\n * @private\n */\ngoog.string.compareElements_ = function(left, right) {\n  if (left < right) {\n    return -1;\n  } else if (left > right) {\n    return 1;\n  }\n  return 0;\n};\n\n\n/**\n * String hash function similar to java.lang.String.hashCode().\n * The hash code for a string is computed as\n * s[0] * 31 ^ (n - 1) + s[1] * 31 ^ (n - 2) + ... + s[n - 1],\n * where s[i] is the ith character of the string and n is the length of\n * the string. We mod the result to make it between 0 (inclusive) and 2^32\n * (exclusive).\n * @param {string} str A string.\n * @return {number} Hash value for {@code str}, between 0 (inclusive) and 2^32\n *  (exclusive). The empty string returns 0.\n */\ngoog.string.hashCode = function(str) {\n  var result = 0;\n  for (var i = 0; i < str.length; ++i) {\n    // Normalize to 4 byte range, 0 ... 2^32.\n    result = (31 * result + str.charCodeAt(i)) >>> 0;\n  }\n  return result;\n};\n\n\n/**\n * The most recent unique ID. |0 is equivalent to Math.floor in this case.\n * @type {number}\n * @private\n */\ngoog.string.uniqueStringCounter_ = Math.random() * 0x80000000 | 0;\n\n\n/**\n * Generates and returns a string which is unique in the current document.\n * This is useful, for example, to create unique IDs for DOM elements.\n * @return {string} A unique id.\n */\ngoog.string.createUniqueString = function() {\n  return 'goog_' + goog.string.uniqueStringCounter_++;\n};\n\n\n/**\n * Converts the supplied string to a number, which may be Infinity or NaN.\n * This function strips whitespace: (toNumber(' 123') === 123)\n * This function accepts scientific notation: (toNumber('1e1') === 10)\n *\n * This is better than Javascript's built-in conversions because, sadly:\n *     (Number(' ') === 0) and (parseFloat('123a') === 123)\n *\n * @param {string} str The string to convert.\n * @return {number} The number the supplied string represents, or NaN.\n */\ngoog.string.toNumber = function(str) {\n  var num = Number(str);\n  if (num == 0 && goog.string.isEmptyOrWhitespace(str)) {\n    return NaN;\n  }\n  return num;\n};\n\n\n/**\n * Returns whether the given string is lower camel case (e.g. \"isFooBar\").\n *\n * Note that this assumes the string is entirely letters.\n * @see http://en.wikipedia.org/wiki/CamelCase#Variations_and_synonyms\n *\n * @param {string} str String to test.\n * @return {boolean} Whether the string is lower camel case.\n */\ngoog.string.isLowerCamelCase = function(str) {\n  return /^[a-z]+([A-Z][a-z]*)*$/.test(str);\n};\n\n\n/**\n * Returns whether the given string is upper camel case (e.g. \"FooBarBaz\").\n *\n * Note that this assumes the string is entirely letters.\n * @see http://en.wikipedia.org/wiki/CamelCase#Variations_and_synonyms\n *\n * @param {string} str String to test.\n * @return {boolean} Whether the string is upper camel case.\n */\ngoog.string.isUpperCamelCase = function(str) {\n  return /^([A-Z][a-z]*)+$/.test(str);\n};\n\n\n/**\n * Converts a string from selector-case to camelCase (e.g. from\n * \"multi-part-string\" to \"multiPartString\"), useful for converting\n * CSS selectors and HTML dataset keys to their equivalent JS properties.\n * @param {string} str The string in selector-case form.\n * @return {string} The string in camelCase form.\n */\ngoog.string.toCamelCase = function(str) {\n  return String(str).replace(\n      /\\-([a-z])/g, function(all, match) { return match.toUpperCase(); });\n};\n\n\n/**\n * Converts a string from camelCase to selector-case (e.g. from\n * \"multiPartString\" to \"multi-part-string\"), useful for converting JS\n * style and dataset properties to equivalent CSS selectors and HTML keys.\n * @param {string} str The string in camelCase form.\n * @return {string} The string in selector-case form.\n */\ngoog.string.toSelectorCase = function(str) {\n  return String(str).replace(/([A-Z])/g, '-$1').toLowerCase();\n};\n\n\n/**\n * Converts a string into TitleCase. First character of the string is always\n * capitalized in addition to the first letter of every subsequent word.\n * Words are delimited by one or more whitespaces by default. Custom delimiters\n * can optionally be specified to replace the default, which doesn't preserve\n * whitespace delimiters and instead must be explicitly included if needed.\n *\n * Default delimiter => \" \":\n *    goog.string.toTitleCase('oneTwoThree')    => 'OneTwoThree'\n *    goog.string.toTitleCase('one two three')  => 'One Two Three'\n *    goog.string.toTitleCase('  one   two   ') => '  One   Two   '\n *    goog.string.toTitleCase('one_two_three')  => 'One_two_three'\n *    goog.string.toTitleCase('one-two-three')  => 'One-two-three'\n *\n * Custom delimiter => \"_-.\":\n *    goog.string.toTitleCase('oneTwoThree', '_-.')       => 'OneTwoThree'\n *    goog.string.toTitleCase('one two three', '_-.')     => 'One two three'\n *    goog.string.toTitleCase('  one   two   ', '_-.')    => '  one   two   '\n *    goog.string.toTitleCase('one_two_three', '_-.')     => 'One_Two_Three'\n *    goog.string.toTitleCase('one-two-three', '_-.')     => 'One-Two-Three'\n *    goog.string.toTitleCase('one...two...three', '_-.') => 'One...Two...Three'\n *    goog.string.toTitleCase('one. two. three', '_-.')   => 'One. two. three'\n *    goog.string.toTitleCase('one-two.three', '_-.')     => 'One-Two.Three'\n *\n * @param {string} str String value in camelCase form.\n * @param {string=} opt_delimiters Custom delimiter character set used to\n *      distinguish words in the string value. Each character represents a\n *      single delimiter. When provided, default whitespace delimiter is\n *      overridden and must be explicitly included if needed.\n * @return {string} String value in TitleCase form.\n */\ngoog.string.toTitleCase = function(str, opt_delimiters) {\n  var delimiters = goog.isString(opt_delimiters) ?\n      goog.string.regExpEscape(opt_delimiters) :\n      '\\\\s';\n\n  // For IE8, we need to prevent using an empty character set. Otherwise,\n  // incorrect matching will occur.\n  delimiters = delimiters ? '|[' + delimiters + ']+' : '';\n\n  var regexp = new RegExp('(^' + delimiters + ')([a-z])', 'g');\n  return str.replace(\n      regexp, function(all, p1, p2) { return p1 + p2.toUpperCase(); });\n};\n\n\n/**\n * Capitalizes a string, i.e. converts the first letter to uppercase\n * and all other letters to lowercase, e.g.:\n *\n * goog.string.capitalize('one')     => 'One'\n * goog.string.capitalize('ONE')     => 'One'\n * goog.string.capitalize('one two') => 'One two'\n *\n * Note that this function does not trim initial whitespace.\n *\n * @param {string} str String value to capitalize.\n * @return {string} String value with first letter in uppercase.\n */\ngoog.string.capitalize = function(str) {\n  return String(str.charAt(0)).toUpperCase() +\n      String(str.substr(1)).toLowerCase();\n};\n\n\n/**\n * Parse a string in decimal or hexidecimal ('0xFFFF') form.\n *\n * To parse a particular radix, please use parseInt(string, radix) directly. See\n * https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseInt\n *\n * This is a wrapper for the built-in parseInt function that will only parse\n * numbers as base 10 or base 16.  Some JS implementations assume strings\n * starting with \"0\" are intended to be octal. ES3 allowed but discouraged\n * this behavior. ES5 forbids it.  This function emulates the ES5 behavior.\n *\n * For more information, see Mozilla JS Reference: http://goo.gl/8RiFj\n *\n * @param {string|number|null|undefined} value The value to be parsed.\n * @return {number} The number, parsed. If the string failed to parse, this\n *     will be NaN.\n */\ngoog.string.parseInt = function(value) {\n  // Force finite numbers to strings.\n  if (isFinite(value)) {\n    value = String(value);\n  }\n\n  if (goog.isString(value)) {\n    // If the string starts with '0x' or '-0x', parse as hex.\n    return /^\\s*-?0x/i.test(value) ? parseInt(value, 16) : parseInt(value, 10);\n  }\n\n  return NaN;\n};\n\n\n/**\n * Splits a string on a separator a limited number of times.\n *\n * This implementation is more similar to Python or Java, where the limit\n * parameter specifies the maximum number of splits rather than truncating\n * the number of results.\n *\n * See http://docs.python.org/2/library/stdtypes.html#str.split\n * See JavaDoc: http://goo.gl/F2AsY\n * See Mozilla reference: http://goo.gl/dZdZs\n *\n * @param {string} str String to split.\n * @param {string} separator The separator.\n * @param {number} limit The limit to the number of splits. The resulting array\n *     will have a maximum length of limit+1.  Negative numbers are the same\n *     as zero.\n * @return {!Array<string>} The string, split.\n */\ngoog.string.splitLimit = function(str, separator, limit) {\n  var parts = str.split(separator);\n  var returnVal = [];\n\n  // Only continue doing this while we haven't hit the limit and we have\n  // parts left.\n  while (limit > 0 && parts.length) {\n    returnVal.push(parts.shift());\n    limit--;\n  }\n\n  // If there are remaining parts, append them to the end.\n  if (parts.length) {\n    returnVal.push(parts.join(separator));\n  }\n\n  return returnVal;\n};\n\n\n/**\n * Finds the characters to the right of the last instance of any separator\n *\n * This function is similar to goog.string.path.baseName, except it can take a\n * list of characters to split the string on. It will return the rightmost\n * grouping of characters to the right of any separator as a left-to-right\n * oriented string.\n *\n * @see goog.string.path.baseName\n * @param {string} str The string\n * @param {string|!Array<string>} separators A list of separator characters\n * @return {string} The last part of the string with respect to the separators\n */\ngoog.string.lastComponent = function(str, separators) {\n  if (!separators) {\n    return str;\n  } else if (typeof separators == 'string') {\n    separators = [separators];\n  }\n\n  var lastSeparatorIndex = -1;\n  for (var i = 0; i < separators.length; i++) {\n    if (separators[i] == '') {\n      continue;\n    }\n    var currentSeparatorIndex = str.lastIndexOf(separators[i]);\n    if (currentSeparatorIndex > lastSeparatorIndex) {\n      lastSeparatorIndex = currentSeparatorIndex;\n    }\n  }\n  if (lastSeparatorIndex == -1) {\n    return str;\n  }\n  return str.slice(lastSeparatorIndex + 1);\n};\n\n\n/**\n * Computes the Levenshtein edit distance between two strings.\n * @param {string} a\n * @param {string} b\n * @return {number} The edit distance between the two strings.\n */\ngoog.string.editDistance = function(a, b) {\n  var v0 = [];\n  var v1 = [];\n\n  if (a == b) {\n    return 0;\n  }\n\n  if (!a.length || !b.length) {\n    return Math.max(a.length, b.length);\n  }\n\n  for (var i = 0; i < b.length + 1; i++) {\n    v0[i] = i;\n  }\n\n  for (var i = 0; i < a.length; i++) {\n    v1[0] = i + 1;\n\n    for (var j = 0; j < b.length; j++) {\n      var cost = Number(a[i] != b[j]);\n      // Cost for the substring is the minimum of adding one character, removing\n      // one character, or a swap.\n      v1[j + 1] = Math.min(v1[j] + 1, v0[j + 1] + 1, v0[j] + cost);\n    }\n\n    for (var j = 0; j < v0.length; j++) {\n      v0[j] = v1[j];\n    }\n  }\n\n  return v1[b.length];\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities to check the preconditions, postconditions and\n * invariants runtime.\n *\n * Methods in this package should be given special treatment by the compiler\n * for type-inference. For example, <code>goog.asserts.assert(foo)</code>\n * will restrict <code>foo</code> to a truthy value.\n *\n * The compiler has an option to disable asserts. So code like:\n * <code>\n * var x = goog.asserts.assert(foo()); goog.asserts.assert(bar());\n * </code>\n * will be transformed into:\n * <code>\n * var x = foo();\n * </code>\n * The compiler will leave in foo() (because its return value is used),\n * but it will remove bar() because it assumes it does not have side-effects.\n *\n * @author agrieve@google.com (Andrew Grieve)\n */\n\ngoog.provide('goog.asserts');\ngoog.provide('goog.asserts.AssertionError');\n\ngoog.require('goog.debug.Error');\ngoog.require('goog.dom.NodeType');\ngoog.require('goog.string');\n\n\n/**\n * @define {boolean} Whether to strip out asserts or to leave them in.\n */\ngoog.define('goog.asserts.ENABLE_ASSERTS', goog.DEBUG);\n\n\n\n/**\n * Error object for failed assertions.\n * @param {string} messagePattern The pattern that was used to form message.\n * @param {!Array<*>} messageArgs The items to substitute into the pattern.\n * @constructor\n * @extends {goog.debug.Error}\n * @final\n */\ngoog.asserts.AssertionError = function(messagePattern, messageArgs) {\n  messageArgs.unshift(messagePattern);\n  goog.debug.Error.call(this, goog.string.subs.apply(null, messageArgs));\n  // Remove the messagePattern afterwards to avoid permanently modifying the\n  // passed in array.\n  messageArgs.shift();\n\n  /**\n   * The message pattern used to format the error message. Error handlers can\n   * use this to uniquely identify the assertion.\n   * @type {string}\n   */\n  this.messagePattern = messagePattern;\n};\ngoog.inherits(goog.asserts.AssertionError, goog.debug.Error);\n\n\n/** @override */\ngoog.asserts.AssertionError.prototype.name = 'AssertionError';\n\n\n/**\n * The default error handler.\n * @param {!goog.asserts.AssertionError} e The exception to be handled.\n */\ngoog.asserts.DEFAULT_ERROR_HANDLER = function(e) {\n  throw e;\n};\n\n\n/**\n * The handler responsible for throwing or logging assertion errors.\n * @private {function(!goog.asserts.AssertionError)}\n */\ngoog.asserts.errorHandler_ = goog.asserts.DEFAULT_ERROR_HANDLER;\n\n\n/**\n * Throws an exception with the given message and \"Assertion failed\" prefixed\n * onto it.\n * @param {string} defaultMessage The message to use if givenMessage is empty.\n * @param {Array<*>} defaultArgs The substitution arguments for defaultMessage.\n * @param {string|undefined} givenMessage Message supplied by the caller.\n * @param {Array<*>} givenArgs The substitution arguments for givenMessage.\n * @throws {goog.asserts.AssertionError} When the value is not a number.\n * @private\n */\ngoog.asserts.doAssertFailure_ = function(\n    defaultMessage, defaultArgs, givenMessage, givenArgs) {\n  var message = 'Assertion failed';\n  if (givenMessage) {\n    message += ': ' + givenMessage;\n    var args = givenArgs;\n  } else if (defaultMessage) {\n    message += ': ' + defaultMessage;\n    args = defaultArgs;\n  }\n  // The '' + works around an Opera 10 bug in the unit tests. Without it,\n  // a stack trace is added to var message above. With this, a stack trace is\n  // not added until this line (it causes the extra garbage to be added after\n  // the assertion message instead of in the middle of it).\n  var e = new goog.asserts.AssertionError('' + message, args || []);\n  goog.asserts.errorHandler_(e);\n};\n\n\n/**\n * Sets a custom error handler that can be used to customize the behavior of\n * assertion failures, for example by turning all assertion failures into log\n * messages.\n * @param {function(!goog.asserts.AssertionError)} errorHandler\n */\ngoog.asserts.setErrorHandler = function(errorHandler) {\n  if (goog.asserts.ENABLE_ASSERTS) {\n    goog.asserts.errorHandler_ = errorHandler;\n  }\n};\n\n\n/**\n * Checks if the condition evaluates to true if goog.asserts.ENABLE_ASSERTS is\n * true.\n * @template T\n * @param {T} condition The condition to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {T} The value of the condition.\n * @throws {goog.asserts.AssertionError} When the condition evaluates to false.\n */\ngoog.asserts.assert = function(condition, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !condition) {\n    goog.asserts.doAssertFailure_(\n        '', null, opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return condition;\n};\n\n\n/**\n * Fails if goog.asserts.ENABLE_ASSERTS is true. This function is useful in case\n * when we want to add a check in the unreachable area like switch-case\n * statement:\n *\n * <pre>\n *  switch(type) {\n *    case FOO: doSomething(); break;\n *    case BAR: doSomethingElse(); break;\n *    default: goog.asserts.fail('Unrecognized type: ' + type);\n *      // We have only 2 types - \"default:\" section is unreachable code.\n *  }\n * </pre>\n *\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @throws {goog.asserts.AssertionError} Failure.\n */\ngoog.asserts.fail = function(opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS) {\n    goog.asserts.errorHandler_(\n        new goog.asserts.AssertionError(\n            'Failure' + (opt_message ? ': ' + opt_message : ''),\n            Array.prototype.slice.call(arguments, 1)));\n  }\n};\n\n\n/**\n * Checks if the value is a number if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {number} The value, guaranteed to be a number when asserts enabled.\n * @throws {goog.asserts.AssertionError} When the value is not a number.\n */\ngoog.asserts.assertNumber = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !goog.isNumber(value)) {\n    goog.asserts.doAssertFailure_(\n        'Expected number but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {number} */ (value);\n};\n\n\n/**\n * Checks if the value is a string if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {string} The value, guaranteed to be a string when asserts enabled.\n * @throws {goog.asserts.AssertionError} When the value is not a string.\n */\ngoog.asserts.assertString = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !goog.isString(value)) {\n    goog.asserts.doAssertFailure_(\n        'Expected string but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {string} */ (value);\n};\n\n\n/**\n * Checks if the value is a function if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {!Function} The value, guaranteed to be a function when asserts\n *     enabled.\n * @throws {goog.asserts.AssertionError} When the value is not a function.\n */\ngoog.asserts.assertFunction = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !goog.isFunction(value)) {\n    goog.asserts.doAssertFailure_(\n        'Expected function but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {!Function} */ (value);\n};\n\n\n/**\n * Checks if the value is an Object if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {!Object} The value, guaranteed to be a non-null object.\n * @throws {goog.asserts.AssertionError} When the value is not an object.\n */\ngoog.asserts.assertObject = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !goog.isObject(value)) {\n    goog.asserts.doAssertFailure_(\n        'Expected object but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {!Object} */ (value);\n};\n\n\n/**\n * Checks if the value is an Array if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {!Array<?>} The value, guaranteed to be a non-null array.\n * @throws {goog.asserts.AssertionError} When the value is not an array.\n */\ngoog.asserts.assertArray = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !goog.isArray(value)) {\n    goog.asserts.doAssertFailure_(\n        'Expected array but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {!Array<?>} */ (value);\n};\n\n\n/**\n * Checks if the value is a boolean if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {boolean} The value, guaranteed to be a boolean when asserts are\n *     enabled.\n * @throws {goog.asserts.AssertionError} When the value is not a boolean.\n */\ngoog.asserts.assertBoolean = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !goog.isBoolean(value)) {\n    goog.asserts.doAssertFailure_(\n        'Expected boolean but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {boolean} */ (value);\n};\n\n\n/**\n * Checks if the value is a DOM Element if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {!Element} The value, likely to be a DOM Element when asserts are\n *     enabled.\n * @throws {goog.asserts.AssertionError} When the value is not an Element.\n */\ngoog.asserts.assertElement = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS &&\n      (!goog.isObject(value) || value.nodeType != goog.dom.NodeType.ELEMENT)) {\n    goog.asserts.doAssertFailure_(\n        'Expected Element but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {!Element} */ (value);\n};\n\n\n/**\n * Checks if the value is an instance of the user-defined type if\n * goog.asserts.ENABLE_ASSERTS is true.\n *\n * The compiler may tighten the type returned by this function.\n *\n * @param {?} value The value to check.\n * @param {function(new: T, ...)} type A user-defined constructor.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @throws {goog.asserts.AssertionError} When the value is not an instance of\n *     type.\n * @return {T}\n * @template T\n */\ngoog.asserts.assertInstanceof = function(value, type, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !(value instanceof type)) {\n    goog.asserts.doAssertFailure_(\n        'Expected instanceof %s but got %s.',\n        [goog.asserts.getType_(type), goog.asserts.getType_(value)],\n        opt_message, Array.prototype.slice.call(arguments, 3));\n  }\n  return value;\n};\n\n\n/**\n * Checks that no enumerable keys are present in Object.prototype. Such keys\n * would break most code that use {@code for (var ... in ...)} loops.\n */\ngoog.asserts.assertObjectPrototypeIsIntact = function() {\n  for (var key in Object.prototype) {\n    goog.asserts.fail(key + ' should not be enumerable in Object.prototype.');\n  }\n};\n\n\n/**\n * Returns the type of a value. If a constructor is passed, and a suitable\n * string cannot be found, 'unknown type name' will be returned.\n * @param {*} value A constructor, object, or primitive.\n * @return {string} The best display name for the value, or 'unknown type name'.\n * @private\n */\ngoog.asserts.getType_ = function(value) {\n  if (value instanceof Function) {\n    return value.displayName || value.name || 'unknown type name';\n  } else if (value instanceof Object) {\n    return value.constructor.displayName || value.constructor.name ||\n        Object.prototype.toString.call(value);\n  } else {\n    return value === null ? 'null' : typeof value;\n  }\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for manipulating arrays.\n *\n * @author arv@google.com (Erik Arvidsson)\n */\n\n\ngoog.provide('goog.array');\n\ngoog.require('goog.asserts');\n\n\n/**\n * @define {boolean} NATIVE_ARRAY_PROTOTYPES indicates whether the code should\n * rely on Array.prototype functions, if available.\n *\n * The Array.prototype functions can be defined by external libraries like\n * Prototype and setting this flag to false forces closure to use its own\n * goog.array implementation.\n *\n * If your javascript can be loaded by a third party site and you are wary about\n * relying on the prototype functions, specify\n * \"--define goog.NATIVE_ARRAY_PROTOTYPES=false\" to the JSCompiler.\n *\n * Setting goog.TRUSTED_SITE to false will automatically set\n * NATIVE_ARRAY_PROTOTYPES to false.\n */\ngoog.define('goog.NATIVE_ARRAY_PROTOTYPES', goog.TRUSTED_SITE);\n\n\n/**\n * @define {boolean} If true, JSCompiler will use the native implementation of\n * array functions where appropriate (e.g., {@code Array#filter}) and remove the\n * unused pure JS implementation.\n */\ngoog.define('goog.array.ASSUME_NATIVE_FUNCTIONS', false);\n\n\n/**\n * Returns the last element in an array without removing it.\n * Same as goog.array.last.\n * @param {IArrayLike<T>|string} array The array.\n * @return {T} Last item in array.\n * @template T\n */\ngoog.array.peek = function(array) {\n  return array[array.length - 1];\n};\n\n\n/**\n * Returns the last element in an array without removing it.\n * Same as goog.array.peek.\n * @param {IArrayLike<T>|string} array The array.\n * @return {T} Last item in array.\n * @template T\n */\ngoog.array.last = goog.array.peek;\n\n// NOTE(arv): Since most of the array functions are generic it allows you to\n// pass an array-like object. Strings have a length and are considered array-\n// like. However, the 'in' operator does not work on strings so we cannot just\n// use the array path even if the browser supports indexing into strings. We\n// therefore end up splitting the string.\n\n\n/**\n * Returns the index of the first element of an array with a specified value, or\n * -1 if the element is not present in the array.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-indexof}\n *\n * @param {IArrayLike<T>|string} arr The array to be searched.\n * @param {T} obj The object for which we are searching.\n * @param {number=} opt_fromIndex The index at which to start the search. If\n *     omitted the search starts at index 0.\n * @return {number} The index of the first matching array element.\n * @template T\n */\ngoog.array.indexOf = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.indexOf) ?\n    function(arr, obj, opt_fromIndex) {\n      goog.asserts.assert(arr.length != null);\n\n      return Array.prototype.indexOf.call(arr, obj, opt_fromIndex);\n    } :\n    function(arr, obj, opt_fromIndex) {\n      var fromIndex = opt_fromIndex == null ?\n          0 :\n          (opt_fromIndex < 0 ? Math.max(0, arr.length + opt_fromIndex) :\n                               opt_fromIndex);\n\n      if (goog.isString(arr)) {\n        // Array.prototype.indexOf uses === so only strings should be found.\n        if (!goog.isString(obj) || obj.length != 1) {\n          return -1;\n        }\n        return arr.indexOf(obj, fromIndex);\n      }\n\n      for (var i = fromIndex; i < arr.length; i++) {\n        if (i in arr && arr[i] === obj) return i;\n      }\n      return -1;\n    };\n\n\n/**\n * Returns the index of the last element of an array with a specified value, or\n * -1 if the element is not present in the array.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-lastindexof}\n *\n * @param {!IArrayLike<T>|string} arr The array to be searched.\n * @param {T} obj The object for which we are searching.\n * @param {?number=} opt_fromIndex The index at which to start the search. If\n *     omitted the search starts at the end of the array.\n * @return {number} The index of the last matching array element.\n * @template T\n */\ngoog.array.lastIndexOf = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.lastIndexOf) ?\n    function(arr, obj, opt_fromIndex) {\n      goog.asserts.assert(arr.length != null);\n\n      // Firefox treats undefined and null as 0 in the fromIndex argument which\n      // leads it to always return -1\n      var fromIndex = opt_fromIndex == null ? arr.length - 1 : opt_fromIndex;\n      return Array.prototype.lastIndexOf.call(arr, obj, fromIndex);\n    } :\n    function(arr, obj, opt_fromIndex) {\n      var fromIndex = opt_fromIndex == null ? arr.length - 1 : opt_fromIndex;\n\n      if (fromIndex < 0) {\n        fromIndex = Math.max(0, arr.length + fromIndex);\n      }\n\n      if (goog.isString(arr)) {\n        // Array.prototype.lastIndexOf uses === so only strings should be found.\n        if (!goog.isString(obj) || obj.length != 1) {\n          return -1;\n        }\n        return arr.lastIndexOf(obj, fromIndex);\n      }\n\n      for (var i = fromIndex; i >= 0; i--) {\n        if (i in arr && arr[i] === obj) return i;\n      }\n      return -1;\n    };\n\n\n/**\n * Calls a function for each element in an array. Skips holes in the array.\n * See {@link http://tinyurl.com/developer-mozilla-org-array-foreach}\n *\n * @param {IArrayLike<T>|string} arr Array or array like object over\n *     which to iterate.\n * @param {?function(this: S, T, number, ?): ?} f The function to call for every\n *     element. This function takes 3 arguments (the element, the index and the\n *     array). The return value is ignored.\n * @param {S=} opt_obj The object to be used as the value of 'this' within f.\n * @template T,S\n */\ngoog.array.forEach = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.forEach) ?\n    function(arr, f, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n\n      Array.prototype.forEach.call(arr, f, opt_obj);\n    } :\n    function(arr, f, opt_obj) {\n      var l = arr.length;  // must be fixed during loop... see docs\n      var arr2 = goog.isString(arr) ? arr.split('') : arr;\n      for (var i = 0; i < l; i++) {\n        if (i in arr2) {\n          f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr);\n        }\n      }\n    };\n\n\n/**\n * Calls a function for each element in an array, starting from the last\n * element rather than the first.\n *\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this: S, T, number, ?): ?} f The function to call for every\n *     element. This function\n *     takes 3 arguments (the element, the index and the array). The return\n *     value is ignored.\n * @param {S=} opt_obj The object to be used as the value of 'this'\n *     within f.\n * @template T,S\n */\ngoog.array.forEachRight = function(arr, f, opt_obj) {\n  var l = arr.length;  // must be fixed during loop... see docs\n  var arr2 = goog.isString(arr) ? arr.split('') : arr;\n  for (var i = l - 1; i >= 0; --i) {\n    if (i in arr2) {\n      f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr);\n    }\n  }\n};\n\n\n/**\n * Calls a function for each element in an array, and if the function returns\n * true adds the element to a new array.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-filter}\n *\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?):boolean} f The function to call for\n *     every element. This function\n *     takes 3 arguments (the element, the index and the array) and must\n *     return a Boolean. If the return value is true the element is added to the\n *     result array. If it is false the element is not included.\n * @param {S=} opt_obj The object to be used as the value of 'this'\n *     within f.\n * @return {!Array<T>} a new array in which only elements that passed the test\n *     are present.\n * @template T,S\n */\ngoog.array.filter = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.filter) ?\n    function(arr, f, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n\n      return Array.prototype.filter.call(arr, f, opt_obj);\n    } :\n    function(arr, f, opt_obj) {\n      var l = arr.length;  // must be fixed during loop... see docs\n      var res = [];\n      var resLength = 0;\n      var arr2 = goog.isString(arr) ? arr.split('') : arr;\n      for (var i = 0; i < l; i++) {\n        if (i in arr2) {\n          var val = arr2[i];  // in case f mutates arr2\n          if (f.call(/** @type {?} */ (opt_obj), val, i, arr)) {\n            res[resLength++] = val;\n          }\n        }\n      }\n      return res;\n    };\n\n\n/**\n * Calls a function for each element in an array and inserts the result into a\n * new array.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-map}\n *\n * @param {IArrayLike<VALUE>|string} arr Array or array like object\n *     over which to iterate.\n * @param {function(this:THIS, VALUE, number, ?): RESULT} f The function to call\n *     for every element. This function takes 3 arguments (the element,\n *     the index and the array) and should return something. The result will be\n *     inserted into a new array.\n * @param {THIS=} opt_obj The object to be used as the value of 'this' within f.\n * @return {!Array<RESULT>} a new array with the results from f.\n * @template THIS, VALUE, RESULT\n */\ngoog.array.map = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.map) ?\n    function(arr, f, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n\n      return Array.prototype.map.call(arr, f, opt_obj);\n    } :\n    function(arr, f, opt_obj) {\n      var l = arr.length;  // must be fixed during loop... see docs\n      var res = new Array(l);\n      var arr2 = goog.isString(arr) ? arr.split('') : arr;\n      for (var i = 0; i < l; i++) {\n        if (i in arr2) {\n          res[i] = f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr);\n        }\n      }\n      return res;\n    };\n\n\n/**\n * Passes every element of an array into a function and accumulates the result.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-reduce}\n *\n * For example:\n * var a = [1, 2, 3, 4];\n * goog.array.reduce(a, function(r, v, i, arr) {return r + v;}, 0);\n * returns 10\n *\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {function(this:S, R, T, number, ?) : R} f The function to call for\n *     every element. This function\n *     takes 4 arguments (the function's previous result or the initial value,\n *     the value of the current array element, the current array index, and the\n *     array itself)\n *     function(previousValue, currentValue, index, array).\n * @param {?} val The initial value to pass into the function on the first call.\n * @param {S=} opt_obj  The object to be used as the value of 'this'\n *     within f.\n * @return {R} Result of evaluating f repeatedly across the values of the array.\n * @template T,S,R\n */\ngoog.array.reduce = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.reduce) ?\n    function(arr, f, val, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n      if (opt_obj) {\n        f = goog.bind(f, opt_obj);\n      }\n      return Array.prototype.reduce.call(arr, f, val);\n    } :\n    function(arr, f, val, opt_obj) {\n      var rval = val;\n      goog.array.forEach(arr, function(val, index) {\n        rval = f.call(/** @type {?} */ (opt_obj), rval, val, index, arr);\n      });\n      return rval;\n    };\n\n\n/**\n * Passes every element of an array into a function and accumulates the result,\n * starting from the last element and working towards the first.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-reduceright}\n *\n * For example:\n * var a = ['a', 'b', 'c'];\n * goog.array.reduceRight(a, function(r, v, i, arr) {return r + v;}, '');\n * returns 'cba'\n *\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, R, T, number, ?) : R} f The function to call for\n *     every element. This function\n *     takes 4 arguments (the function's previous result or the initial value,\n *     the value of the current array element, the current array index, and the\n *     array itself)\n *     function(previousValue, currentValue, index, array).\n * @param {?} val The initial value to pass into the function on the first call.\n * @param {S=} opt_obj The object to be used as the value of 'this'\n *     within f.\n * @return {R} Object returned as a result of evaluating f repeatedly across the\n *     values of the array.\n * @template T,S,R\n */\ngoog.array.reduceRight = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.reduceRight) ?\n    function(arr, f, val, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n      goog.asserts.assert(f != null);\n      if (opt_obj) {\n        f = goog.bind(f, opt_obj);\n      }\n      return Array.prototype.reduceRight.call(arr, f, val);\n    } :\n    function(arr, f, val, opt_obj) {\n      var rval = val;\n      goog.array.forEachRight(arr, function(val, index) {\n        rval = f.call(/** @type {?} */ (opt_obj), rval, val, index, arr);\n      });\n      return rval;\n    };\n\n\n/**\n * Calls f for each element of an array. If any call returns true, some()\n * returns true (without checking the remaining elements). If all calls\n * return false, some() returns false.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-some}\n *\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call for\n *     for every element. This function takes 3 arguments (the element, the\n *     index and the array) and should return a boolean.\n * @param {S=} opt_obj  The object to be used as the value of 'this'\n *     within f.\n * @return {boolean} true if any element passes the test.\n * @template T,S\n */\ngoog.array.some = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.some) ?\n    function(arr, f, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n\n      return Array.prototype.some.call(arr, f, opt_obj);\n    } :\n    function(arr, f, opt_obj) {\n      var l = arr.length;  // must be fixed during loop... see docs\n      var arr2 = goog.isString(arr) ? arr.split('') : arr;\n      for (var i = 0; i < l; i++) {\n        if (i in arr2 && f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr)) {\n          return true;\n        }\n      }\n      return false;\n    };\n\n\n/**\n * Call f for each element of an array. If all calls return true, every()\n * returns true. If any call returns false, every() returns false and\n * does not continue to check the remaining elements.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-every}\n *\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call for\n *     for every element. This function takes 3 arguments (the element, the\n *     index and the array) and should return a boolean.\n * @param {S=} opt_obj The object to be used as the value of 'this'\n *     within f.\n * @return {boolean} false if any element fails the test.\n * @template T,S\n */\ngoog.array.every = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.every) ?\n    function(arr, f, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n\n      return Array.prototype.every.call(arr, f, opt_obj);\n    } :\n    function(arr, f, opt_obj) {\n      var l = arr.length;  // must be fixed during loop... see docs\n      var arr2 = goog.isString(arr) ? arr.split('') : arr;\n      for (var i = 0; i < l; i++) {\n        if (i in arr2 && !f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr)) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n\n/**\n * Counts the array elements that fulfill the predicate, i.e. for which the\n * callback function returns true. Skips holes in the array.\n *\n * @param {!IArrayLike<T>|string} arr Array or array like object\n *     over which to iterate.\n * @param {function(this: S, T, number, ?): boolean} f The function to call for\n *     every element. Takes 3 arguments (the element, the index and the array).\n * @param {S=} opt_obj The object to be used as the value of 'this' within f.\n * @return {number} The number of the matching elements.\n * @template T,S\n */\ngoog.array.count = function(arr, f, opt_obj) {\n  var count = 0;\n  goog.array.forEach(arr, function(element, index, arr) {\n    if (f.call(/** @type {?} */ (opt_obj), element, index, arr)) {\n      ++count;\n    }\n  }, opt_obj);\n  return count;\n};\n\n\n/**\n * Search an array for the first element that satisfies a given condition and\n * return that element.\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call\n *     for every element. This function takes 3 arguments (the element, the\n *     index and the array) and should return a boolean.\n * @param {S=} opt_obj An optional \"this\" context for the function.\n * @return {T|null} The first array element that passes the test, or null if no\n *     element is found.\n * @template T,S\n */\ngoog.array.find = function(arr, f, opt_obj) {\n  var i = goog.array.findIndex(arr, f, opt_obj);\n  return i < 0 ? null : goog.isString(arr) ? arr.charAt(i) : arr[i];\n};\n\n\n/**\n * Search an array for the first element that satisfies a given condition and\n * return its index.\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call for\n *     every element. This function\n *     takes 3 arguments (the element, the index and the array) and should\n *     return a boolean.\n * @param {S=} opt_obj An optional \"this\" context for the function.\n * @return {number} The index of the first array element that passes the test,\n *     or -1 if no element is found.\n * @template T,S\n */\ngoog.array.findIndex = function(arr, f, opt_obj) {\n  var l = arr.length;  // must be fixed during loop... see docs\n  var arr2 = goog.isString(arr) ? arr.split('') : arr;\n  for (var i = 0; i < l; i++) {\n    if (i in arr2 && f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr)) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n\n/**\n * Search an array (in reverse order) for the last element that satisfies a\n * given condition and return that element.\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call\n *     for every element. This function\n *     takes 3 arguments (the element, the index and the array) and should\n *     return a boolean.\n * @param {S=} opt_obj An optional \"this\" context for the function.\n * @return {T|null} The last array element that passes the test, or null if no\n *     element is found.\n * @template T,S\n */\ngoog.array.findRight = function(arr, f, opt_obj) {\n  var i = goog.array.findIndexRight(arr, f, opt_obj);\n  return i < 0 ? null : goog.isString(arr) ? arr.charAt(i) : arr[i];\n};\n\n\n/**\n * Search an array (in reverse order) for the last element that satisfies a\n * given condition and return its index.\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call\n *     for every element. This function\n *     takes 3 arguments (the element, the index and the array) and should\n *     return a boolean.\n * @param {S=} opt_obj An optional \"this\" context for the function.\n * @return {number} The index of the last array element that passes the test,\n *     or -1 if no element is found.\n * @template T,S\n */\ngoog.array.findIndexRight = function(arr, f, opt_obj) {\n  var l = arr.length;  // must be fixed during loop... see docs\n  var arr2 = goog.isString(arr) ? arr.split('') : arr;\n  for (var i = l - 1; i >= 0; i--) {\n    if (i in arr2 && f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr)) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n\n/**\n * Whether the array contains the given object.\n * @param {IArrayLike<?>|string} arr The array to test for the presence of the\n *     element.\n * @param {*} obj The object for which to test.\n * @return {boolean} true if obj is present.\n */\ngoog.array.contains = function(arr, obj) {\n  return goog.array.indexOf(arr, obj) >= 0;\n};\n\n\n/**\n * Whether the array is empty.\n * @param {IArrayLike<?>|string} arr The array to test.\n * @return {boolean} true if empty.\n */\ngoog.array.isEmpty = function(arr) {\n  return arr.length == 0;\n};\n\n\n/**\n * Clears the array.\n * @param {IArrayLike<?>} arr Array or array like object to clear.\n */\ngoog.array.clear = function(arr) {\n  // For non real arrays we don't have the magic length so we delete the\n  // indices.\n  if (!goog.isArray(arr)) {\n    for (var i = arr.length - 1; i >= 0; i--) {\n      delete arr[i];\n    }\n  }\n  arr.length = 0;\n};\n\n\n/**\n * Pushes an item into an array, if it's not already in the array.\n * @param {Array<T>} arr Array into which to insert the item.\n * @param {T} obj Value to add.\n * @template T\n */\ngoog.array.insert = function(arr, obj) {\n  if (!goog.array.contains(arr, obj)) {\n    arr.push(obj);\n  }\n};\n\n\n/**\n * Inserts an object at the given index of the array.\n * @param {IArrayLike<?>} arr The array to modify.\n * @param {*} obj The object to insert.\n * @param {number=} opt_i The index at which to insert the object. If omitted,\n *      treated as 0. A negative index is counted from the end of the array.\n */\ngoog.array.insertAt = function(arr, obj, opt_i) {\n  goog.array.splice(arr, opt_i, 0, obj);\n};\n\n\n/**\n * Inserts at the given index of the array, all elements of another array.\n * @param {IArrayLike<?>} arr The array to modify.\n * @param {IArrayLike<?>} elementsToAdd The array of elements to add.\n * @param {number=} opt_i The index at which to insert the object. If omitted,\n *      treated as 0. A negative index is counted from the end of the array.\n */\ngoog.array.insertArrayAt = function(arr, elementsToAdd, opt_i) {\n  goog.partial(goog.array.splice, arr, opt_i, 0).apply(null, elementsToAdd);\n};\n\n\n/**\n * Inserts an object into an array before a specified object.\n * @param {Array<T>} arr The array to modify.\n * @param {T} obj The object to insert.\n * @param {T=} opt_obj2 The object before which obj should be inserted. If obj2\n *     is omitted or not found, obj is inserted at the end of the array.\n * @template T\n */\ngoog.array.insertBefore = function(arr, obj, opt_obj2) {\n  var i;\n  if (arguments.length == 2 || (i = goog.array.indexOf(arr, opt_obj2)) < 0) {\n    arr.push(obj);\n  } else {\n    goog.array.insertAt(arr, obj, i);\n  }\n};\n\n\n/**\n * Removes the first occurrence of a particular value from an array.\n * @param {IArrayLike<T>} arr Array from which to remove\n *     value.\n * @param {T} obj Object to remove.\n * @return {boolean} True if an element was removed.\n * @template T\n */\ngoog.array.remove = function(arr, obj) {\n  var i = goog.array.indexOf(arr, obj);\n  var rv;\n  if ((rv = i >= 0)) {\n    goog.array.removeAt(arr, i);\n  }\n  return rv;\n};\n\n\n/**\n * Removes the last occurrence of a particular value from an array.\n * @param {!IArrayLike<T>} arr Array from which to remove value.\n * @param {T} obj Object to remove.\n * @return {boolean} True if an element was removed.\n * @template T\n */\ngoog.array.removeLast = function(arr, obj) {\n  var i = goog.array.lastIndexOf(arr, obj);\n  if (i >= 0) {\n    goog.array.removeAt(arr, i);\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Removes from an array the element at index i\n * @param {IArrayLike<?>} arr Array or array like object from which to\n *     remove value.\n * @param {number} i The index to remove.\n * @return {boolean} True if an element was removed.\n */\ngoog.array.removeAt = function(arr, i) {\n  goog.asserts.assert(arr.length != null);\n\n  // use generic form of splice\n  // splice returns the removed items and if successful the length of that\n  // will be 1\n  return Array.prototype.splice.call(arr, i, 1).length == 1;\n};\n\n\n/**\n * Removes the first value that satisfies the given condition.\n * @param {IArrayLike<T>} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call\n *     for every element. This function\n *     takes 3 arguments (the element, the index and the array) and should\n *     return a boolean.\n * @param {S=} opt_obj An optional \"this\" context for the function.\n * @return {boolean} True if an element was removed.\n * @template T,S\n */\ngoog.array.removeIf = function(arr, f, opt_obj) {\n  var i = goog.array.findIndex(arr, f, opt_obj);\n  if (i >= 0) {\n    goog.array.removeAt(arr, i);\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Removes all values that satisfy the given condition.\n * @param {IArrayLike<T>} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call\n *     for every element. This function\n *     takes 3 arguments (the element, the index and the array) and should\n *     return a boolean.\n * @param {S=} opt_obj An optional \"this\" context for the function.\n * @return {number} The number of items removed\n * @template T,S\n */\ngoog.array.removeAllIf = function(arr, f, opt_obj) {\n  var removedCount = 0;\n  goog.array.forEachRight(arr, function(val, index) {\n    if (f.call(/** @type {?} */ (opt_obj), val, index, arr)) {\n      if (goog.array.removeAt(arr, index)) {\n        removedCount++;\n      }\n    }\n  });\n  return removedCount;\n};\n\n\n/**\n * Returns a new array that is the result of joining the arguments.  If arrays\n * are passed then their items are added, however, if non-arrays are passed they\n * will be added to the return array as is.\n *\n * Note that ArrayLike objects will be added as is, rather than having their\n * items added.\n *\n * goog.array.concat([1, 2], [3, 4]) -> [1, 2, 3, 4]\n * goog.array.concat(0, [1, 2]) -> [0, 1, 2]\n * goog.array.concat([1, 2], null) -> [1, 2, null]\n *\n * There is bug in all current versions of IE (6, 7 and 8) where arrays created\n * in an iframe become corrupted soon (not immediately) after the iframe is\n * destroyed. This is common if loading data via goog.net.IframeIo, for example.\n * This corruption only affects the concat method which will start throwing\n * Catastrophic Errors (#-2147418113).\n *\n * See http://endoflow.com/scratch/corrupted-arrays.html for a test case.\n *\n * Internally goog.array should use this, so that all methods will continue to\n * work on these broken array objects.\n *\n * @param {...*} var_args Items to concatenate.  Arrays will have each item\n *     added, while primitives and objects will be added as is.\n * @return {!Array<?>} The new resultant array.\n */\ngoog.array.concat = function(var_args) {\n  return Array.prototype.concat.apply(Array.prototype, arguments);\n};\n\n\n/**\n * Returns a new array that contains the contents of all the arrays passed.\n * @param {...!Array<T>} var_args\n * @return {!Array<T>}\n * @template T\n */\ngoog.array.join = function(var_args) {\n  return Array.prototype.concat.apply(Array.prototype, arguments);\n};\n\n\n/**\n * Converts an object to an array.\n * @param {IArrayLike<T>|string} object  The object to convert to an\n *     array.\n * @return {!Array<T>} The object converted into an array. If object has a\n *     length property, every property indexed with a non-negative number\n *     less than length will be included in the result. If object does not\n *     have a length property, an empty array will be returned.\n * @template T\n */\ngoog.array.toArray = function(object) {\n  var length = object.length;\n\n  // If length is not a number the following it false. This case is kept for\n  // backwards compatibility since there are callers that pass objects that are\n  // not array like.\n  if (length > 0) {\n    var rv = new Array(length);\n    for (var i = 0; i < length; i++) {\n      rv[i] = object[i];\n    }\n    return rv;\n  }\n  return [];\n};\n\n\n/**\n * Does a shallow copy of an array.\n * @param {IArrayLike<T>|string} arr  Array or array-like object to\n *     clone.\n * @return {!Array<T>} Clone of the input array.\n * @template T\n */\ngoog.array.clone = goog.array.toArray;\n\n\n/**\n * Extends an array with another array, element, or \"array like\" object.\n * This function operates 'in-place', it does not create a new Array.\n *\n * Example:\n * var a = [];\n * goog.array.extend(a, [0, 1]);\n * a; // [0, 1]\n * goog.array.extend(a, 2);\n * a; // [0, 1, 2]\n *\n * @param {Array<VALUE>} arr1  The array to modify.\n * @param {...(Array<VALUE>|VALUE)} var_args The elements or arrays of elements\n *     to add to arr1.\n * @template VALUE\n */\ngoog.array.extend = function(arr1, var_args) {\n  for (var i = 1; i < arguments.length; i++) {\n    var arr2 = arguments[i];\n    if (goog.isArrayLike(arr2)) {\n      var len1 = arr1.length || 0;\n      var len2 = arr2.length || 0;\n      arr1.length = len1 + len2;\n      for (var j = 0; j < len2; j++) {\n        arr1[len1 + j] = arr2[j];\n      }\n    } else {\n      arr1.push(arr2);\n    }\n  }\n};\n\n\n/**\n * Adds or removes elements from an array. This is a generic version of Array\n * splice. This means that it might work on other objects similar to arrays,\n * such as the arguments object.\n *\n * @param {IArrayLike<T>} arr The array to modify.\n * @param {number|undefined} index The index at which to start changing the\n *     array. If not defined, treated as 0.\n * @param {number} howMany How many elements to remove (0 means no removal. A\n *     value below 0 is treated as zero and so is any other non number. Numbers\n *     are floored).\n * @param {...T} var_args Optional, additional elements to insert into the\n *     array.\n * @return {!Array<T>} the removed elements.\n * @template T\n */\ngoog.array.splice = function(arr, index, howMany, var_args) {\n  goog.asserts.assert(arr.length != null);\n\n  return Array.prototype.splice.apply(arr, goog.array.slice(arguments, 1));\n};\n\n\n/**\n * Returns a new array from a segment of an array. This is a generic version of\n * Array slice. This means that it might work on other objects similar to\n * arrays, such as the arguments object.\n *\n * @param {IArrayLike<T>|string} arr The array from\n * which to copy a segment.\n * @param {number} start The index of the first element to copy.\n * @param {number=} opt_end The index after the last element to copy.\n * @return {!Array<T>} A new array containing the specified segment of the\n *     original array.\n * @template T\n */\ngoog.array.slice = function(arr, start, opt_end) {\n  goog.asserts.assert(arr.length != null);\n\n  // passing 1 arg to slice is not the same as passing 2 where the second is\n  // null or undefined (in that case the second argument is treated as 0).\n  // we could use slice on the arguments object and then use apply instead of\n  // testing the length\n  if (arguments.length <= 2) {\n    return Array.prototype.slice.call(arr, start);\n  } else {\n    return Array.prototype.slice.call(arr, start, opt_end);\n  }\n};\n\n\n/**\n * Removes all duplicates from an array (retaining only the first\n * occurrence of each array element).  This function modifies the\n * array in place and doesn't change the order of the non-duplicate items.\n *\n * For objects, duplicates are identified as having the same unique ID as\n * defined by {@link goog.getUid}.\n *\n * Alternatively you can specify a custom hash function that returns a unique\n * value for each item in the array it should consider unique.\n *\n * Runtime: N,\n * Worstcase space: 2N (no dupes)\n *\n * @param {IArrayLike<T>} arr The array from which to remove\n *     duplicates.\n * @param {Array=} opt_rv An optional array in which to return the results,\n *     instead of performing the removal inplace.  If specified, the original\n *     array will remain unchanged.\n * @param {function(T):string=} opt_hashFn An optional function to use to\n *     apply to every item in the array. This function should return a unique\n *     value for each item in the array it should consider unique.\n * @template T\n */\ngoog.array.removeDuplicates = function(arr, opt_rv, opt_hashFn) {\n  var returnArray = opt_rv || arr;\n  var defaultHashFn = function(item) {\n    // Prefix each type with a single character representing the type to\n    // prevent conflicting keys (e.g. true and 'true').\n    return goog.isObject(item) ? 'o' + goog.getUid(item) :\n                                 (typeof item).charAt(0) + item;\n  };\n  var hashFn = opt_hashFn || defaultHashFn;\n\n  var seen = {}, cursorInsert = 0, cursorRead = 0;\n  while (cursorRead < arr.length) {\n    var current = arr[cursorRead++];\n    var key = hashFn(current);\n    if (!Object.prototype.hasOwnProperty.call(seen, key)) {\n      seen[key] = true;\n      returnArray[cursorInsert++] = current;\n    }\n  }\n  returnArray.length = cursorInsert;\n};\n\n\n/**\n * Searches the specified array for the specified target using the binary\n * search algorithm.  If no opt_compareFn is specified, elements are compared\n * using <code>goog.array.defaultCompare</code>, which compares the elements\n * using the built in < and > operators.  This will produce the expected\n * behavior for homogeneous arrays of String(s) and Number(s). The array\n * specified <b>must</b> be sorted in ascending order (as defined by the\n * comparison function).  If the array is not sorted, results are undefined.\n * If the array contains multiple instances of the specified target value, any\n * of these instances may be found.\n *\n * Runtime: O(log n)\n *\n * @param {IArrayLike<VALUE>} arr The array to be searched.\n * @param {TARGET} target The sought value.\n * @param {function(TARGET, VALUE): number=} opt_compareFn Optional comparison\n *     function by which the array is ordered. Should take 2 arguments to\n *     compare, and return a negative number, zero, or a positive number\n *     depending on whether the first argument is less than, equal to, or\n *     greater than the second.\n * @return {number} Lowest index of the target value if found, otherwise\n *     (-(insertion point) - 1). The insertion point is where the value should\n *     be inserted into arr to preserve the sorted property.  Return value >= 0\n *     iff target is found.\n * @template TARGET, VALUE\n */\ngoog.array.binarySearch = function(arr, target, opt_compareFn) {\n  return goog.array.binarySearch_(\n      arr, opt_compareFn || goog.array.defaultCompare, false /* isEvaluator */,\n      target);\n};\n\n\n/**\n * Selects an index in the specified array using the binary search algorithm.\n * The evaluator receives an element and determines whether the desired index\n * is before, at, or after it.  The evaluator must be consistent (formally,\n * goog.array.map(goog.array.map(arr, evaluator, opt_obj), goog.math.sign)\n * must be monotonically non-increasing).\n *\n * Runtime: O(log n)\n *\n * @param {IArrayLike<VALUE>} arr The array to be searched.\n * @param {function(this:THIS, VALUE, number, ?): number} evaluator\n *     Evaluator function that receives 3 arguments (the element, the index and\n *     the array). Should return a negative number, zero, or a positive number\n *     depending on whether the desired index is before, at, or after the\n *     element passed to it.\n * @param {THIS=} opt_obj The object to be used as the value of 'this'\n *     within evaluator.\n * @return {number} Index of the leftmost element matched by the evaluator, if\n *     such exists; otherwise (-(insertion point) - 1). The insertion point is\n *     the index of the first element for which the evaluator returns negative,\n *     or arr.length if no such element exists. The return value is non-negative\n *     iff a match is found.\n * @template THIS, VALUE\n */\ngoog.array.binarySelect = function(arr, evaluator, opt_obj) {\n  return goog.array.binarySearch_(\n      arr, evaluator, true /* isEvaluator */, undefined /* opt_target */,\n      opt_obj);\n};\n\n\n/**\n * Implementation of a binary search algorithm which knows how to use both\n * comparison functions and evaluators. If an evaluator is provided, will call\n * the evaluator with the given optional data object, conforming to the\n * interface defined in binarySelect. Otherwise, if a comparison function is\n * provided, will call the comparison function against the given data object.\n *\n * This implementation purposefully does not use goog.bind or goog.partial for\n * performance reasons.\n *\n * Runtime: O(log n)\n *\n * @param {IArrayLike<?>} arr The array to be searched.\n * @param {function(?, ?, ?): number | function(?, ?): number} compareFn\n *     Either an evaluator or a comparison function, as defined by binarySearch\n *     and binarySelect above.\n * @param {boolean} isEvaluator Whether the function is an evaluator or a\n *     comparison function.\n * @param {?=} opt_target If the function is a comparison function, then\n *     this is the target to binary search for.\n * @param {Object=} opt_selfObj If the function is an evaluator, this is an\n *     optional this object for the evaluator.\n * @return {number} Lowest index of the target value if found, otherwise\n *     (-(insertion point) - 1). The insertion point is where the value should\n *     be inserted into arr to preserve the sorted property.  Return value >= 0\n *     iff target is found.\n * @private\n */\ngoog.array.binarySearch_ = function(\n    arr, compareFn, isEvaluator, opt_target, opt_selfObj) {\n  var left = 0;            // inclusive\n  var right = arr.length;  // exclusive\n  var found;\n  while (left < right) {\n    var middle = (left + right) >> 1;\n    var compareResult;\n    if (isEvaluator) {\n      compareResult = compareFn.call(opt_selfObj, arr[middle], middle, arr);\n    } else {\n      // NOTE(dimvar): To avoid this cast, we'd have to use function overloading\n      // for the type of binarySearch_, which the type system can't express yet.\n      compareResult = /** @type {function(?, ?): number} */ (compareFn)(\n          opt_target, arr[middle]);\n    }\n    if (compareResult > 0) {\n      left = middle + 1;\n    } else {\n      right = middle;\n      // We are looking for the lowest index so we can't return immediately.\n      found = !compareResult;\n    }\n  }\n  // left is the index if found, or the insertion point otherwise.\n  // ~left is a shorthand for -left - 1.\n  return found ? left : ~left;\n};\n\n\n/**\n * Sorts the specified array into ascending order.  If no opt_compareFn is\n * specified, elements are compared using\n * <code>goog.array.defaultCompare</code>, which compares the elements using\n * the built in < and > operators.  This will produce the expected behavior\n * for homogeneous arrays of String(s) and Number(s), unlike the native sort,\n * but will give unpredictable results for heterogeneous lists of strings and\n * numbers with different numbers of digits.\n *\n * This sort is not guaranteed to be stable.\n *\n * Runtime: Same as <code>Array.prototype.sort</code>\n *\n * @param {Array<T>} arr The array to be sorted.\n * @param {?function(T,T):number=} opt_compareFn Optional comparison\n *     function by which the\n *     array is to be ordered. Should take 2 arguments to compare, and return a\n *     negative number, zero, or a positive number depending on whether the\n *     first argument is less than, equal to, or greater than the second.\n * @template T\n */\ngoog.array.sort = function(arr, opt_compareFn) {\n  // TODO(arv): Update type annotation since null is not accepted.\n  arr.sort(opt_compareFn || goog.array.defaultCompare);\n};\n\n\n/**\n * Sorts the specified array into ascending order in a stable way.  If no\n * opt_compareFn is specified, elements are compared using\n * <code>goog.array.defaultCompare</code>, which compares the elements using\n * the built in < and > operators.  This will produce the expected behavior\n * for homogeneous arrays of String(s) and Number(s).\n *\n * Runtime: Same as <code>Array.prototype.sort</code>, plus an additional\n * O(n) overhead of copying the array twice.\n *\n * @param {Array<T>} arr The array to be sorted.\n * @param {?function(T, T): number=} opt_compareFn Optional comparison function\n *     by which the array is to be ordered. Should take 2 arguments to compare,\n *     and return a negative number, zero, or a positive number depending on\n *     whether the first argument is less than, equal to, or greater than the\n *     second.\n * @template T\n */\ngoog.array.stableSort = function(arr, opt_compareFn) {\n  var compArr = new Array(arr.length);\n  for (var i = 0; i < arr.length; i++) {\n    compArr[i] = {index: i, value: arr[i]};\n  }\n  var valueCompareFn = opt_compareFn || goog.array.defaultCompare;\n  function stableCompareFn(obj1, obj2) {\n    return valueCompareFn(obj1.value, obj2.value) || obj1.index - obj2.index;\n  }\n  goog.array.sort(compArr, stableCompareFn);\n  for (var i = 0; i < arr.length; i++) {\n    arr[i] = compArr[i].value;\n  }\n};\n\n\n/**\n * Sort the specified array into ascending order based on item keys\n * returned by the specified key function.\n * If no opt_compareFn is specified, the keys are compared in ascending order\n * using <code>goog.array.defaultCompare</code>.\n *\n * Runtime: O(S(f(n)), where S is runtime of <code>goog.array.sort</code>\n * and f(n) is runtime of the key function.\n *\n * @param {Array<T>} arr The array to be sorted.\n * @param {function(T): K} keyFn Function taking array element and returning\n *     a key used for sorting this element.\n * @param {?function(K, K): number=} opt_compareFn Optional comparison function\n *     by which the keys are to be ordered. Should take 2 arguments to compare,\n *     and return a negative number, zero, or a positive number depending on\n *     whether the first argument is less than, equal to, or greater than the\n *     second.\n * @template T,K\n */\ngoog.array.sortByKey = function(arr, keyFn, opt_compareFn) {\n  var keyCompareFn = opt_compareFn || goog.array.defaultCompare;\n  goog.array.sort(\n      arr, function(a, b) { return keyCompareFn(keyFn(a), keyFn(b)); });\n};\n\n\n/**\n * Sorts an array of objects by the specified object key and compare\n * function. If no compare function is provided, the key values are\n * compared in ascending order using <code>goog.array.defaultCompare</code>.\n * This won't work for keys that get renamed by the compiler. So use\n * {'foo': 1, 'bar': 2} rather than {foo: 1, bar: 2}.\n * @param {Array<Object>} arr An array of objects to sort.\n * @param {string} key The object key to sort by.\n * @param {Function=} opt_compareFn The function to use to compare key\n *     values.\n */\ngoog.array.sortObjectsByKey = function(arr, key, opt_compareFn) {\n  goog.array.sortByKey(arr, function(obj) { return obj[key]; }, opt_compareFn);\n};\n\n\n/**\n * Tells if the array is sorted.\n * @param {!Array<T>} arr The array.\n * @param {?function(T,T):number=} opt_compareFn Function to compare the\n *     array elements.\n *     Should take 2 arguments to compare, and return a negative number, zero,\n *     or a positive number depending on whether the first argument is less\n *     than, equal to, or greater than the second.\n * @param {boolean=} opt_strict If true no equal elements are allowed.\n * @return {boolean} Whether the array is sorted.\n * @template T\n */\ngoog.array.isSorted = function(arr, opt_compareFn, opt_strict) {\n  var compare = opt_compareFn || goog.array.defaultCompare;\n  for (var i = 1; i < arr.length; i++) {\n    var compareResult = compare(arr[i - 1], arr[i]);\n    if (compareResult > 0 || compareResult == 0 && opt_strict) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * Compares two arrays for equality. Two arrays are considered equal if they\n * have the same length and their corresponding elements are equal according to\n * the comparison function.\n *\n * @param {IArrayLike<?>} arr1 The first array to compare.\n * @param {IArrayLike<?>} arr2 The second array to compare.\n * @param {Function=} opt_equalsFn Optional comparison function.\n *     Should take 2 arguments to compare, and return true if the arguments\n *     are equal. Defaults to {@link goog.array.defaultCompareEquality} which\n *     compares the elements using the built-in '===' operator.\n * @return {boolean} Whether the two arrays are equal.\n */\ngoog.array.equals = function(arr1, arr2, opt_equalsFn) {\n  if (!goog.isArrayLike(arr1) || !goog.isArrayLike(arr2) ||\n      arr1.length != arr2.length) {\n    return false;\n  }\n  var l = arr1.length;\n  var equalsFn = opt_equalsFn || goog.array.defaultCompareEquality;\n  for (var i = 0; i < l; i++) {\n    if (!equalsFn(arr1[i], arr2[i])) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * 3-way array compare function.\n * @param {!IArrayLike<VALUE>} arr1 The first array to\n *     compare.\n * @param {!IArrayLike<VALUE>} arr2 The second array to\n *     compare.\n * @param {function(VALUE, VALUE): number=} opt_compareFn Optional comparison\n *     function by which the array is to be ordered. Should take 2 arguments to\n *     compare, and return a negative number, zero, or a positive number\n *     depending on whether the first argument is less than, equal to, or\n *     greater than the second.\n * @return {number} Negative number, zero, or a positive number depending on\n *     whether the first argument is less than, equal to, or greater than the\n *     second.\n * @template VALUE\n */\ngoog.array.compare3 = function(arr1, arr2, opt_compareFn) {\n  var compare = opt_compareFn || goog.array.defaultCompare;\n  var l = Math.min(arr1.length, arr2.length);\n  for (var i = 0; i < l; i++) {\n    var result = compare(arr1[i], arr2[i]);\n    if (result != 0) {\n      return result;\n    }\n  }\n  return goog.array.defaultCompare(arr1.length, arr2.length);\n};\n\n\n/**\n * Compares its two arguments for order, using the built in < and >\n * operators.\n * @param {VALUE} a The first object to be compared.\n * @param {VALUE} b The second object to be compared.\n * @return {number} A negative number, zero, or a positive number as the first\n *     argument is less than, equal to, or greater than the second,\n *     respectively.\n * @template VALUE\n */\ngoog.array.defaultCompare = function(a, b) {\n  return a > b ? 1 : a < b ? -1 : 0;\n};\n\n\n/**\n * Compares its two arguments for inverse order, using the built in < and >\n * operators.\n * @param {VALUE} a The first object to be compared.\n * @param {VALUE} b The second object to be compared.\n * @return {number} A negative number, zero, or a positive number as the first\n *     argument is greater than, equal to, or less than the second,\n *     respectively.\n * @template VALUE\n */\ngoog.array.inverseDefaultCompare = function(a, b) {\n  return -goog.array.defaultCompare(a, b);\n};\n\n\n/**\n * Compares its two arguments for equality, using the built in === operator.\n * @param {*} a The first object to compare.\n * @param {*} b The second object to compare.\n * @return {boolean} True if the two arguments are equal, false otherwise.\n */\ngoog.array.defaultCompareEquality = function(a, b) {\n  return a === b;\n};\n\n\n/**\n * Inserts a value into a sorted array. The array is not modified if the\n * value is already present.\n * @param {IArrayLike<VALUE>} array The array to modify.\n * @param {VALUE} value The object to insert.\n * @param {function(VALUE, VALUE): number=} opt_compareFn Optional comparison\n *     function by which the array is ordered. Should take 2 arguments to\n *     compare, and return a negative number, zero, or a positive number\n *     depending on whether the first argument is less than, equal to, or\n *     greater than the second.\n * @return {boolean} True if an element was inserted.\n * @template VALUE\n */\ngoog.array.binaryInsert = function(array, value, opt_compareFn) {\n  var index = goog.array.binarySearch(array, value, opt_compareFn);\n  if (index < 0) {\n    goog.array.insertAt(array, value, -(index + 1));\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Removes a value from a sorted array.\n * @param {!IArrayLike<VALUE>} array The array to modify.\n * @param {VALUE} value The object to remove.\n * @param {function(VALUE, VALUE): number=} opt_compareFn Optional comparison\n *     function by which the array is ordered. Should take 2 arguments to\n *     compare, and return a negative number, zero, or a positive number\n *     depending on whether the first argument is less than, equal to, or\n *     greater than the second.\n * @return {boolean} True if an element was removed.\n * @template VALUE\n */\ngoog.array.binaryRemove = function(array, value, opt_compareFn) {\n  var index = goog.array.binarySearch(array, value, opt_compareFn);\n  return (index >= 0) ? goog.array.removeAt(array, index) : false;\n};\n\n\n/**\n * Splits an array into disjoint buckets according to a splitting function.\n * @param {Array<T>} array The array.\n * @param {function(this:S, T,number,Array<T>):?} sorter Function to call for\n *     every element.  This takes 3 arguments (the element, the index and the\n *     array) and must return a valid object key (a string, number, etc), or\n *     undefined, if that object should not be placed in a bucket.\n * @param {S=} opt_obj The object to be used as the value of 'this' within\n *     sorter.\n * @return {!Object} An object, with keys being all of the unique return values\n *     of sorter, and values being arrays containing the items for\n *     which the splitter returned that key.\n * @template T,S\n */\ngoog.array.bucket = function(array, sorter, opt_obj) {\n  var buckets = {};\n\n  for (var i = 0; i < array.length; i++) {\n    var value = array[i];\n    var key = sorter.call(/** @type {?} */ (opt_obj), value, i, array);\n    if (goog.isDef(key)) {\n      // Push the value to the right bucket, creating it if necessary.\n      var bucket = buckets[key] || (buckets[key] = []);\n      bucket.push(value);\n    }\n  }\n\n  return buckets;\n};\n\n\n/**\n * Creates a new object built from the provided array and the key-generation\n * function.\n * @param {IArrayLike<T>} arr Array or array like object over\n *     which to iterate whose elements will be the values in the new object.\n * @param {?function(this:S, T, number, ?) : string} keyFunc The function to\n *     call for every element. This function takes 3 arguments (the element, the\n *     index and the array) and should return a string that will be used as the\n *     key for the element in the new object. If the function returns the same\n *     key for more than one element, the value for that key is\n *     implementation-defined.\n * @param {S=} opt_obj The object to be used as the value of 'this'\n *     within keyFunc.\n * @return {!Object<T>} The new object.\n * @template T,S\n */\ngoog.array.toObject = function(arr, keyFunc, opt_obj) {\n  var ret = {};\n  goog.array.forEach(arr, function(element, index) {\n    ret[keyFunc.call(/** @type {?} */ (opt_obj), element, index, arr)] =\n        element;\n  });\n  return ret;\n};\n\n\n/**\n * Creates a range of numbers in an arithmetic progression.\n *\n * Range takes 1, 2, or 3 arguments:\n * <pre>\n * range(5) is the same as range(0, 5, 1) and produces [0, 1, 2, 3, 4]\n * range(2, 5) is the same as range(2, 5, 1) and produces [2, 3, 4]\n * range(-2, -5, -1) produces [-2, -3, -4]\n * range(-2, -5, 1) produces [], since stepping by 1 wouldn't ever reach -5.\n * </pre>\n *\n * @param {number} startOrEnd The starting value of the range if an end argument\n *     is provided. Otherwise, the start value is 0, and this is the end value.\n * @param {number=} opt_end The optional end value of the range.\n * @param {number=} opt_step The step size between range values. Defaults to 1\n *     if opt_step is undefined or 0.\n * @return {!Array<number>} An array of numbers for the requested range. May be\n *     an empty array if adding the step would not converge toward the end\n *     value.\n */\ngoog.array.range = function(startOrEnd, opt_end, opt_step) {\n  var array = [];\n  var start = 0;\n  var end = startOrEnd;\n  var step = opt_step || 1;\n  if (opt_end !== undefined) {\n    start = startOrEnd;\n    end = opt_end;\n  }\n\n  if (step * (end - start) < 0) {\n    // Sign mismatch: start + step will never reach the end value.\n    return [];\n  }\n\n  if (step > 0) {\n    for (var i = start; i < end; i += step) {\n      array.push(i);\n    }\n  } else {\n    for (var i = start; i > end; i += step) {\n      array.push(i);\n    }\n  }\n  return array;\n};\n\n\n/**\n * Returns an array consisting of the given value repeated N times.\n *\n * @param {VALUE} value The value to repeat.\n * @param {number} n The repeat count.\n * @return {!Array<VALUE>} An array with the repeated value.\n * @template VALUE\n */\ngoog.array.repeat = function(value, n) {\n  var array = [];\n  for (var i = 0; i < n; i++) {\n    array[i] = value;\n  }\n  return array;\n};\n\n\n/**\n * Returns an array consisting of every argument with all arrays\n * expanded in-place recursively.\n *\n * @param {...*} var_args The values to flatten.\n * @return {!Array<?>} An array containing the flattened values.\n */\ngoog.array.flatten = function(var_args) {\n  var CHUNK_SIZE = 8192;\n\n  var result = [];\n  for (var i = 0; i < arguments.length; i++) {\n    var element = arguments[i];\n    if (goog.isArray(element)) {\n      for (var c = 0; c < element.length; c += CHUNK_SIZE) {\n        var chunk = goog.array.slice(element, c, c + CHUNK_SIZE);\n        var recurseResult = goog.array.flatten.apply(null, chunk);\n        for (var r = 0; r < recurseResult.length; r++) {\n          result.push(recurseResult[r]);\n        }\n      }\n    } else {\n      result.push(element);\n    }\n  }\n  return result;\n};\n\n\n/**\n * Rotates an array in-place. After calling this method, the element at\n * index i will be the element previously at index (i - n) %\n * array.length, for all values of i between 0 and array.length - 1,\n * inclusive.\n *\n * For example, suppose list comprises [t, a, n, k, s]. After invoking\n * rotate(array, 1) (or rotate(array, -4)), array will comprise [s, t, a, n, k].\n *\n * @param {!Array<T>} array The array to rotate.\n * @param {number} n The amount to rotate.\n * @return {!Array<T>} The array.\n * @template T\n */\ngoog.array.rotate = function(array, n) {\n  goog.asserts.assert(array.length != null);\n\n  if (array.length) {\n    n %= array.length;\n    if (n > 0) {\n      Array.prototype.unshift.apply(array, array.splice(-n, n));\n    } else if (n < 0) {\n      Array.prototype.push.apply(array, array.splice(0, -n));\n    }\n  }\n  return array;\n};\n\n\n/**\n * Moves one item of an array to a new position keeping the order of the rest\n * of the items. Example use case: keeping a list of JavaScript objects\n * synchronized with the corresponding list of DOM elements after one of the\n * elements has been dragged to a new position.\n * @param {!IArrayLike<?>} arr The array to modify.\n * @param {number} fromIndex Index of the item to move between 0 and\n *     {@code arr.length - 1}.\n * @param {number} toIndex Target index between 0 and {@code arr.length - 1}.\n */\ngoog.array.moveItem = function(arr, fromIndex, toIndex) {\n  goog.asserts.assert(fromIndex >= 0 && fromIndex < arr.length);\n  goog.asserts.assert(toIndex >= 0 && toIndex < arr.length);\n  // Remove 1 item at fromIndex.\n  var removedItems = Array.prototype.splice.call(arr, fromIndex, 1);\n  // Insert the removed item at toIndex.\n  Array.prototype.splice.call(arr, toIndex, 0, removedItems[0]);\n  // We don't use goog.array.insertAt and goog.array.removeAt, because they're\n  // significantly slower than splice.\n};\n\n\n/**\n * Creates a new array for which the element at position i is an array of the\n * ith element of the provided arrays.  The returned array will only be as long\n * as the shortest array provided; additional values are ignored.  For example,\n * the result of zipping [1, 2] and [3, 4, 5] is [[1,3], [2, 4]].\n *\n * This is similar to the zip() function in Python.  See {@link\n * http://docs.python.org/library/functions.html#zip}\n *\n * @param {...!IArrayLike<?>} var_args Arrays to be combined.\n * @return {!Array<!Array<?>>} A new array of arrays created from\n *     provided arrays.\n */\ngoog.array.zip = function(var_args) {\n  if (!arguments.length) {\n    return [];\n  }\n  var result = [];\n  var minLen = arguments[0].length;\n  for (var i = 1; i < arguments.length; i++) {\n    if (arguments[i].length < minLen) {\n      minLen = arguments[i].length;\n    }\n  }\n  for (var i = 0; i < minLen; i++) {\n    var value = [];\n    for (var j = 0; j < arguments.length; j++) {\n      value.push(arguments[j][i]);\n    }\n    result.push(value);\n  }\n  return result;\n};\n\n\n/**\n * Shuffles the values in the specified array using the Fisher-Yates in-place\n * shuffle (also known as the Knuth Shuffle). By default, calls Math.random()\n * and so resets the state of that random number generator. Similarly, may reset\n * the state of the any other specified random number generator.\n *\n * Runtime: O(n)\n *\n * @param {!Array<?>} arr The array to be shuffled.\n * @param {function():number=} opt_randFn Optional random function to use for\n *     shuffling.\n *     Takes no arguments, and returns a random number on the interval [0, 1).\n *     Defaults to Math.random() using JavaScript's built-in Math library.\n */\ngoog.array.shuffle = function(arr, opt_randFn) {\n  var randFn = opt_randFn || Math.random;\n\n  for (var i = arr.length - 1; i > 0; i--) {\n    // Choose a random array index in [0, i] (inclusive with i).\n    var j = Math.floor(randFn() * (i + 1));\n\n    var tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n  }\n};\n\n\n/**\n * Returns a new array of elements from arr, based on the indexes of elements\n * provided by index_arr. For example, the result of index copying\n * ['a', 'b', 'c'] with index_arr [1,0,0,2] is ['b', 'a', 'a', 'c'].\n *\n * @param {!Array<T>} arr The array to get a indexed copy from.\n * @param {!Array<number>} index_arr An array of indexes to get from arr.\n * @return {!Array<T>} A new array of elements from arr in index_arr order.\n * @template T\n */\ngoog.array.copyByIndex = function(arr, index_arr) {\n  var result = [];\n  goog.array.forEach(index_arr, function(index) { result.push(arr[index]); });\n  return result;\n};\n\n\n/**\n * Maps each element of the input array into zero or more elements of the output\n * array.\n *\n * @param {!IArrayLike<VALUE>|string} arr Array or array like object\n *     over which to iterate.\n * @param {function(this:THIS, VALUE, number, ?): !Array<RESULT>} f The function\n *     to call for every element. This function takes 3 arguments (the element,\n *     the index and the array) and should return an array. The result will be\n *     used to extend a new array.\n * @param {THIS=} opt_obj The object to be used as the value of 'this' within f.\n * @return {!Array<RESULT>} a new array with the concatenation of all arrays\n *     returned from f.\n * @template THIS, VALUE, RESULT\n */\ngoog.array.concatMap = function(arr, f, opt_obj) {\n  return goog.array.concat.apply([], goog.array.map(arr, f, opt_obj));\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities used by goog.labs.userAgent tools. These functions\n * should not be used outside of goog.labs.userAgent.*.\n *\n *\n * @author nnaze@google.com (Nathan Naze)\n */\n\ngoog.provide('goog.labs.userAgent.util');\n\ngoog.require('goog.string');\n\n\n/**\n * Gets the native userAgent string from navigator if it exists.\n * If navigator or navigator.userAgent string is missing, returns an empty\n * string.\n * @return {string}\n * @private\n */\ngoog.labs.userAgent.util.getNativeUserAgentString_ = function() {\n  var navigator = goog.labs.userAgent.util.getNavigator_();\n  if (navigator) {\n    var userAgent = navigator.userAgent;\n    if (userAgent) {\n      return userAgent;\n    }\n  }\n  return '';\n};\n\n\n/**\n * Getter for the native navigator.\n * This is a separate function so it can be stubbed out in testing.\n * @return {Navigator}\n * @private\n */\ngoog.labs.userAgent.util.getNavigator_ = function() {\n  return goog.global.navigator;\n};\n\n\n/**\n * A possible override for applications which wish to not check\n * navigator.userAgent but use a specified value for detection instead.\n * @private {string}\n */\ngoog.labs.userAgent.util.userAgent_ =\n    goog.labs.userAgent.util.getNativeUserAgentString_();\n\n\n/**\n * Applications may override browser detection on the built in\n * navigator.userAgent object by setting this string. Set to null to use the\n * browser object instead.\n * @param {?string=} opt_userAgent The User-Agent override.\n */\ngoog.labs.userAgent.util.setUserAgent = function(opt_userAgent) {\n  goog.labs.userAgent.util.userAgent_ =\n      opt_userAgent || goog.labs.userAgent.util.getNativeUserAgentString_();\n};\n\n\n/**\n * @return {string} The user agent string.\n */\ngoog.labs.userAgent.util.getUserAgent = function() {\n  return goog.labs.userAgent.util.userAgent_;\n};\n\n\n/**\n * @param {string} str\n * @return {boolean} Whether the user agent contains the given string, ignoring\n *     case.\n */\ngoog.labs.userAgent.util.matchUserAgent = function(str) {\n  var userAgent = goog.labs.userAgent.util.getUserAgent();\n  return goog.string.contains(userAgent, str);\n};\n\n\n/**\n * @param {string} str\n * @return {boolean} Whether the user agent contains the given string.\n */\ngoog.labs.userAgent.util.matchUserAgentIgnoreCase = function(str) {\n  var userAgent = goog.labs.userAgent.util.getUserAgent();\n  return goog.string.caseInsensitiveContains(userAgent, str);\n};\n\n\n/**\n * Parses the user agent into tuples for each section.\n * @param {string} userAgent\n * @return {!Array<!Array<string>>} Tuples of key, version, and the contents\n *     of the parenthetical.\n */\ngoog.labs.userAgent.util.extractVersionTuples = function(userAgent) {\n  // Matches each section of a user agent string.\n  // Example UA:\n  // Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us)\n  // AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/7B405\n  // This has three version tuples: Mozilla, AppleWebKit, and Mobile.\n\n  var versionRegExp = new RegExp(\n      // Key. Note that a key may have a space.\n      // (i.e. 'Mobile Safari' in 'Mobile Safari/5.0')\n      '(\\\\w[\\\\w ]+)' +\n\n          '/' +                // slash\n          '([^\\\\s]+)' +        // version (i.e. '5.0b')\n          '\\\\s*' +             // whitespace\n          '(?:\\\\((.*?)\\\\))?',  // parenthetical info. parentheses not matched.\n      'g');\n\n  var data = [];\n  var match;\n\n  // Iterate and collect the version tuples.  Each iteration will be the\n  // next regex match.\n  while (match = versionRegExp.exec(userAgent)) {\n    data.push([\n      match[1],  // key\n      match[2],  // value\n      // || undefined as this is not undefined in IE7 and IE8\n      match[3] || undefined  // info\n    ]);\n  }\n\n  return data;\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for manipulating objects/maps/hashes.\n * @author arv@google.com (Erik Arvidsson)\n */\n\ngoog.provide('goog.object');\n\n\n/**\n * Whether two values are not observably distinguishable. This\n * correctly detects that 0 is not the same as -0 and two NaNs are\n * practically equivalent.\n *\n * The implementation is as suggested by harmony:egal proposal.\n *\n * @param {*} v The first value to compare.\n * @param {*} v2 The second value to compare.\n * @return {boolean} Whether two values are not observably distinguishable.\n * @see http://wiki.ecmascript.org/doku.php?id=harmony:egal\n */\ngoog.object.is = function(v, v2) {\n  if (v === v2) {\n    // 0 === -0, but they are not identical.\n    // We need the cast because the compiler requires that v2 is a\n    // number (although 1/v2 works with non-number). We cast to ? to\n    // stop the compiler from type-checking this statement.\n    return v !== 0 || 1 / v === 1 / /** @type {?} */ (v2);\n  }\n\n  // NaN is non-reflexive: NaN !== NaN, although they are identical.\n  return v !== v && v2 !== v2;\n};\n\n\n/**\n * Calls a function for each element in an object/map/hash.\n *\n * @param {Object<K,V>} obj The object over which to iterate.\n * @param {function(this:T,V,?,Object<K,V>):?} f The function to call\n *     for every element. This function takes 3 arguments (the value, the\n *     key and the object) and the return value is ignored.\n * @param {T=} opt_obj This is used as the 'this' object within f.\n * @template T,K,V\n */\ngoog.object.forEach = function(obj, f, opt_obj) {\n  for (var key in obj) {\n    f.call(/** @type {?} */ (opt_obj), obj[key], key, obj);\n  }\n};\n\n\n/**\n * Calls a function for each element in an object/map/hash. If that call returns\n * true, adds the element to a new object.\n *\n * @param {Object<K,V>} obj The object over which to iterate.\n * @param {function(this:T,V,?,Object<K,V>):boolean} f The function to call\n *     for every element. This\n *     function takes 3 arguments (the value, the key and the object)\n *     and should return a boolean. If the return value is true the\n *     element is added to the result object. If it is false the\n *     element is not included.\n * @param {T=} opt_obj This is used as the 'this' object within f.\n * @return {!Object<K,V>} a new object in which only elements that passed the\n *     test are present.\n * @template T,K,V\n */\ngoog.object.filter = function(obj, f, opt_obj) {\n  var res = {};\n  for (var key in obj) {\n    if (f.call(/** @type {?} */ (opt_obj), obj[key], key, obj)) {\n      res[key] = obj[key];\n    }\n  }\n  return res;\n};\n\n\n/**\n * For every element in an object/map/hash calls a function and inserts the\n * result into a new object.\n *\n * @param {Object<K,V>} obj The object over which to iterate.\n * @param {function(this:T,V,?,Object<K,V>):R} f The function to call\n *     for every element. This function\n *     takes 3 arguments (the value, the key and the object)\n *     and should return something. The result will be inserted\n *     into a new object.\n * @param {T=} opt_obj This is used as the 'this' object within f.\n * @return {!Object<K,R>} a new object with the results from f.\n * @template T,K,V,R\n */\ngoog.object.map = function(obj, f, opt_obj) {\n  var res = {};\n  for (var key in obj) {\n    res[key] = f.call(/** @type {?} */ (opt_obj), obj[key], key, obj);\n  }\n  return res;\n};\n\n\n/**\n * Calls a function for each element in an object/map/hash. If any\n * call returns true, returns true (without checking the rest). If\n * all calls return false, returns false.\n *\n * @param {Object<K,V>} obj The object to check.\n * @param {function(this:T,V,?,Object<K,V>):boolean} f The function to\n *     call for every element. This function\n *     takes 3 arguments (the value, the key and the object) and should\n *     return a boolean.\n * @param {T=} opt_obj This is used as the 'this' object within f.\n * @return {boolean} true if any element passes the test.\n * @template T,K,V\n */\ngoog.object.some = function(obj, f, opt_obj) {\n  for (var key in obj) {\n    if (f.call(/** @type {?} */ (opt_obj), obj[key], key, obj)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Calls a function for each element in an object/map/hash. If\n * all calls return true, returns true. If any call returns false, returns\n * false at this point and does not continue to check the remaining elements.\n *\n * @param {Object<K,V>} obj The object to check.\n * @param {?function(this:T,V,?,Object<K,V>):boolean} f The function to\n *     call for every element. This function\n *     takes 3 arguments (the value, the key and the object) and should\n *     return a boolean.\n * @param {T=} opt_obj This is used as the 'this' object within f.\n * @return {boolean} false if any element fails the test.\n * @template T,K,V\n */\ngoog.object.every = function(obj, f, opt_obj) {\n  for (var key in obj) {\n    if (!f.call(/** @type {?} */ (opt_obj), obj[key], key, obj)) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * Returns the number of key-value pairs in the object map.\n *\n * @param {Object} obj The object for which to get the number of key-value\n *     pairs.\n * @return {number} The number of key-value pairs in the object map.\n */\ngoog.object.getCount = function(obj) {\n  var rv = 0;\n  for (var key in obj) {\n    rv++;\n  }\n  return rv;\n};\n\n\n/**\n * Returns one key from the object map, if any exists.\n * For map literals the returned key will be the first one in most of the\n * browsers (a know exception is Konqueror).\n *\n * @param {Object} obj The object to pick a key from.\n * @return {string|undefined} The key or undefined if the object is empty.\n */\ngoog.object.getAnyKey = function(obj) {\n  for (var key in obj) {\n    return key;\n  }\n};\n\n\n/**\n * Returns one value from the object map, if any exists.\n * For map literals the returned value will be the first one in most of the\n * browsers (a know exception is Konqueror).\n *\n * @param {Object<K,V>} obj The object to pick a value from.\n * @return {V|undefined} The value or undefined if the object is empty.\n * @template K,V\n */\ngoog.object.getAnyValue = function(obj) {\n  for (var key in obj) {\n    return obj[key];\n  }\n};\n\n\n/**\n * Whether the object/hash/map contains the given object as a value.\n * An alias for goog.object.containsValue(obj, val).\n *\n * @param {Object<K,V>} obj The object in which to look for val.\n * @param {V} val The object for which to check.\n * @return {boolean} true if val is present.\n * @template K,V\n */\ngoog.object.contains = function(obj, val) {\n  return goog.object.containsValue(obj, val);\n};\n\n\n/**\n * Returns the values of the object/map/hash.\n *\n * @param {Object<K,V>} obj The object from which to get the values.\n * @return {!Array<V>} The values in the object/map/hash.\n * @template K,V\n */\ngoog.object.getValues = function(obj) {\n  var res = [];\n  var i = 0;\n  for (var key in obj) {\n    res[i++] = obj[key];\n  }\n  return res;\n};\n\n\n/**\n * Returns the keys of the object/map/hash.\n *\n * @param {Object} obj The object from which to get the keys.\n * @return {!Array<string>} Array of property keys.\n */\ngoog.object.getKeys = function(obj) {\n  var res = [];\n  var i = 0;\n  for (var key in obj) {\n    res[i++] = key;\n  }\n  return res;\n};\n\n\n/**\n * Get a value from an object multiple levels deep.  This is useful for\n * pulling values from deeply nested objects, such as JSON responses.\n * Example usage: getValueByKeys(jsonObj, 'foo', 'entries', 3)\n *\n * @param {!Object} obj An object to get the value from.  Can be array-like.\n * @param {...(string|number|!IArrayLike<number|string>)}\n *     var_args A number of keys\n *     (as strings, or numbers, for array-like objects).  Can also be\n *     specified as a single array of keys.\n * @return {*} The resulting value.  If, at any point, the value for a key\n *     is undefined, returns undefined.\n */\ngoog.object.getValueByKeys = function(obj, var_args) {\n  var isArrayLike = goog.isArrayLike(var_args);\n  var keys = isArrayLike ? var_args : arguments;\n\n  // Start with the 2nd parameter for the variable parameters syntax.\n  for (var i = isArrayLike ? 0 : 1; i < keys.length; i++) {\n    obj = obj[keys[i]];\n    if (!goog.isDef(obj)) {\n      break;\n    }\n  }\n\n  return obj;\n};\n\n\n/**\n * Whether the object/map/hash contains the given key.\n *\n * @param {Object} obj The object in which to look for key.\n * @param {?} key The key for which to check.\n * @return {boolean} true If the map contains the key.\n */\ngoog.object.containsKey = function(obj, key) {\n  return obj !== null && key in obj;\n};\n\n\n/**\n * Whether the object/map/hash contains the given value. This is O(n).\n *\n * @param {Object<K,V>} obj The object in which to look for val.\n * @param {V} val The value for which to check.\n * @return {boolean} true If the map contains the value.\n * @template K,V\n */\ngoog.object.containsValue = function(obj, val) {\n  for (var key in obj) {\n    if (obj[key] == val) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Searches an object for an element that satisfies the given condition and\n * returns its key.\n * @param {Object<K,V>} obj The object to search in.\n * @param {function(this:T,V,string,Object<K,V>):boolean} f The\n *      function to call for every element. Takes 3 arguments (the value,\n *     the key and the object) and should return a boolean.\n * @param {T=} opt_this An optional \"this\" context for the function.\n * @return {string|undefined} The key of an element for which the function\n *     returns true or undefined if no such element is found.\n * @template T,K,V\n */\ngoog.object.findKey = function(obj, f, opt_this) {\n  for (var key in obj) {\n    if (f.call(/** @type {?} */ (opt_this), obj[key], key, obj)) {\n      return key;\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * Searches an object for an element that satisfies the given condition and\n * returns its value.\n * @param {Object<K,V>} obj The object to search in.\n * @param {function(this:T,V,string,Object<K,V>):boolean} f The function\n *     to call for every element. Takes 3 arguments (the value, the key\n *     and the object) and should return a boolean.\n * @param {T=} opt_this An optional \"this\" context for the function.\n * @return {V} The value of an element for which the function returns true or\n *     undefined if no such element is found.\n * @template T,K,V\n */\ngoog.object.findValue = function(obj, f, opt_this) {\n  var key = goog.object.findKey(obj, f, opt_this);\n  return key && obj[key];\n};\n\n\n/**\n * Whether the object/map/hash is empty.\n *\n * @param {Object} obj The object to test.\n * @return {boolean} true if obj is empty.\n */\ngoog.object.isEmpty = function(obj) {\n  for (var key in obj) {\n    return false;\n  }\n  return true;\n};\n\n\n/**\n * Removes all key value pairs from the object/map/hash.\n *\n * @param {Object} obj The object to clear.\n */\ngoog.object.clear = function(obj) {\n  for (var i in obj) {\n    delete obj[i];\n  }\n};\n\n\n/**\n * Removes a key-value pair based on the key.\n *\n * @param {Object} obj The object from which to remove the key.\n * @param {?} key The key to remove.\n * @return {boolean} Whether an element was removed.\n */\ngoog.object.remove = function(obj, key) {\n  var rv;\n  if (rv = key in /** @type {!Object} */ (obj)) {\n    delete obj[key];\n  }\n  return rv;\n};\n\n\n/**\n * Adds a key-value pair to the object. Throws an exception if the key is\n * already in use. Use set if you want to change an existing pair.\n *\n * @param {Object<K,V>} obj The object to which to add the key-value pair.\n * @param {string} key The key to add.\n * @param {V} val The value to add.\n * @template K,V\n */\ngoog.object.add = function(obj, key, val) {\n  if (obj !== null && key in obj) {\n    throw Error('The object already contains the key \"' + key + '\"');\n  }\n  goog.object.set(obj, key, val);\n};\n\n\n/**\n * Returns the value for the given key.\n *\n * @param {Object<K,V>} obj The object from which to get the value.\n * @param {string} key The key for which to get the value.\n * @param {R=} opt_val The value to return if no item is found for the given\n *     key (default is undefined).\n * @return {V|R|undefined} The value for the given key.\n * @template K,V,R\n */\ngoog.object.get = function(obj, key, opt_val) {\n  if (obj !== null && key in obj) {\n    return obj[key];\n  }\n  return opt_val;\n};\n\n\n/**\n * Adds a key-value pair to the object/map/hash.\n *\n * @param {Object<K,V>} obj The object to which to add the key-value pair.\n * @param {string} key The key to add.\n * @param {V} value The value to add.\n * @template K,V\n */\ngoog.object.set = function(obj, key, value) {\n  obj[key] = value;\n};\n\n\n/**\n * Adds a key-value pair to the object/map/hash if it doesn't exist yet.\n *\n * @param {Object<K,V>} obj The object to which to add the key-value pair.\n * @param {string} key The key to add.\n * @param {V} value The value to add if the key wasn't present.\n * @return {V} The value of the entry at the end of the function.\n * @template K,V\n */\ngoog.object.setIfUndefined = function(obj, key, value) {\n  return key in /** @type {!Object} */ (obj) ? obj[key] : (obj[key] = value);\n};\n\n\n/**\n * Sets a key and value to an object if the key is not set. The value will be\n * the return value of the given function. If the key already exists, the\n * object will not be changed and the function will not be called (the function\n * will be lazily evaluated -- only called if necessary).\n *\n * This function is particularly useful for use with a map used a as a cache.\n *\n * @param {!Object<K,V>} obj The object to which to add the key-value pair.\n * @param {string} key The key to add.\n * @param {function():V} f The value to add if the key wasn't present.\n * @return {V} The value of the entry at the end of the function.\n * @template K,V\n */\ngoog.object.setWithReturnValueIfNotSet = function(obj, key, f) {\n  if (key in obj) {\n    return obj[key];\n  }\n\n  var val = f();\n  obj[key] = val;\n  return val;\n};\n\n\n/**\n * Compares two objects for equality using === on the values.\n *\n * @param {!Object<K,V>} a\n * @param {!Object<K,V>} b\n * @return {boolean}\n * @template K,V\n */\ngoog.object.equals = function(a, b) {\n  for (var k in a) {\n    if (!(k in b) || a[k] !== b[k]) {\n      return false;\n    }\n  }\n  for (var k in b) {\n    if (!(k in a)) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * Returns a shallow clone of the object.\n *\n * @param {Object<K,V>} obj Object to clone.\n * @return {!Object<K,V>} Clone of the input object.\n * @template K,V\n */\ngoog.object.clone = function(obj) {\n  // We cannot use the prototype trick because a lot of methods depend on where\n  // the actual key is set.\n\n  var res = {};\n  for (var key in obj) {\n    res[key] = obj[key];\n  }\n  return res;\n  // We could also use goog.mixin but I wanted this to be independent from that.\n};\n\n\n/**\n * Clones a value. The input may be an Object, Array, or basic type. Objects and\n * arrays will be cloned recursively.\n *\n * WARNINGS:\n * <code>goog.object.unsafeClone</code> does not detect reference loops. Objects\n * that refer to themselves will cause infinite recursion.\n *\n * <code>goog.object.unsafeClone</code> is unaware of unique identifiers, and\n * copies UIDs created by <code>getUid</code> into cloned results.\n *\n * @param {T} obj The value to clone.\n * @return {T} A clone of the input value.\n * @template T\n */\ngoog.object.unsafeClone = function(obj) {\n  var type = goog.typeOf(obj);\n  if (type == 'object' || type == 'array') {\n    if (goog.isFunction(obj.clone)) {\n      return obj.clone();\n    }\n    var clone = type == 'array' ? [] : {};\n    for (var key in obj) {\n      clone[key] = goog.object.unsafeClone(obj[key]);\n    }\n    return clone;\n  }\n\n  return obj;\n};\n\n\n/**\n * Returns a new object in which all the keys and values are interchanged\n * (keys become values and values become keys). If multiple keys map to the\n * same value, the chosen transposed value is implementation-dependent.\n *\n * @param {Object} obj The object to transpose.\n * @return {!Object} The transposed object.\n */\ngoog.object.transpose = function(obj) {\n  var transposed = {};\n  for (var key in obj) {\n    transposed[obj[key]] = key;\n  }\n  return transposed;\n};\n\n\n/**\n * The names of the fields that are defined on Object.prototype.\n * @type {Array<string>}\n * @private\n */\ngoog.object.PROTOTYPE_FIELDS_ = [\n  'constructor', 'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable',\n  'toLocaleString', 'toString', 'valueOf'\n];\n\n\n/**\n * Extends an object with another object.\n * This operates 'in-place'; it does not create a new Object.\n *\n * Example:\n * var o = {};\n * goog.object.extend(o, {a: 0, b: 1});\n * o; // {a: 0, b: 1}\n * goog.object.extend(o, {b: 2, c: 3});\n * o; // {a: 0, b: 2, c: 3}\n *\n * @param {Object} target The object to modify. Existing properties will be\n *     overwritten if they are also present in one of the objects in\n *     {@code var_args}.\n * @param {...Object} var_args The objects from which values will be copied.\n */\ngoog.object.extend = function(target, var_args) {\n  var key, source;\n  for (var i = 1; i < arguments.length; i++) {\n    source = arguments[i];\n    for (key in source) {\n      target[key] = source[key];\n    }\n\n    // For IE the for-in-loop does not contain any properties that are not\n    // enumerable on the prototype object (for example isPrototypeOf from\n    // Object.prototype) and it will also not include 'replace' on objects that\n    // extend String and change 'replace' (not that it is common for anyone to\n    // extend anything except Object).\n\n    for (var j = 0; j < goog.object.PROTOTYPE_FIELDS_.length; j++) {\n      key = goog.object.PROTOTYPE_FIELDS_[j];\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n};\n\n\n/**\n * Creates a new object built from the key-value pairs provided as arguments.\n * @param {...*} var_args If only one argument is provided and it is an array\n *     then this is used as the arguments, otherwise even arguments are used as\n *     the property names and odd arguments are used as the property values.\n * @return {!Object} The new object.\n * @throws {Error} If there are uneven number of arguments or there is only one\n *     non array argument.\n */\ngoog.object.create = function(var_args) {\n  var argLength = arguments.length;\n  if (argLength == 1 && goog.isArray(arguments[0])) {\n    return goog.object.create.apply(null, arguments[0]);\n  }\n\n  if (argLength % 2) {\n    throw Error('Uneven number of arguments');\n  }\n\n  var rv = {};\n  for (var i = 0; i < argLength; i += 2) {\n    rv[arguments[i]] = arguments[i + 1];\n  }\n  return rv;\n};\n\n\n/**\n * Creates a new object where the property names come from the arguments but\n * the value is always set to true\n * @param {...*} var_args If only one argument is provided and it is an array\n *     then this is used as the arguments, otherwise the arguments are used\n *     as the property names.\n * @return {!Object} The new object.\n */\ngoog.object.createSet = function(var_args) {\n  var argLength = arguments.length;\n  if (argLength == 1 && goog.isArray(arguments[0])) {\n    return goog.object.createSet.apply(null, arguments[0]);\n  }\n\n  var rv = {};\n  for (var i = 0; i < argLength; i++) {\n    rv[arguments[i]] = true;\n  }\n  return rv;\n};\n\n\n/**\n * Creates an immutable view of the underlying object, if the browser\n * supports immutable objects.\n *\n * In default mode, writes to this view will fail silently. In strict mode,\n * they will throw an error.\n *\n * @param {!Object<K,V>} obj An object.\n * @return {!Object<K,V>} An immutable view of that object, or the\n *     original object if this browser does not support immutables.\n * @template K,V\n */\ngoog.object.createImmutableView = function(obj) {\n  var result = obj;\n  if (Object.isFrozen && !Object.isFrozen(obj)) {\n    result = Object.create(obj);\n    Object.freeze(result);\n  }\n  return result;\n};\n\n\n/**\n * @param {!Object} obj An object.\n * @return {boolean} Whether this is an immutable view of the object.\n */\ngoog.object.isImmutableView = function(obj) {\n  return !!Object.isFrozen && Object.isFrozen(obj);\n};\n\n\n/**\n * Get all properties names on a given Object regardless of enumerability.\n *\n * <p> If the browser does not support {@code Object.getOwnPropertyNames} nor\n * {@code Object.getPrototypeOf} then this is equivalent to using {@code\n * goog.object.getKeys}\n *\n * @param {?Object} obj The object to get the properties of.\n * @param {boolean=} opt_includeObjectPrototype Whether properties defined on\n *     {@code Object.prototype} should be included in the result.\n * @return {!Array<string>}\n * @public\n */\ngoog.object.getAllPropertyNames = function(obj, opt_includeObjectPrototype) {\n  if (!obj) {\n    return [];\n  }\n\n  // Naively use a for..in loop to get the property names if the browser doesn't\n  // support any other APIs for getting it.\n  if (!Object.getOwnPropertyNames || !Object.getPrototypeOf) {\n    return goog.object.getKeys(obj);\n  }\n\n  var visitedSet = {};\n\n  // Traverse the prototype chain and add all properties to the visited set.\n  var proto = obj;\n  while (proto &&\n         (proto !== Object.prototype || !!opt_includeObjectPrototype)) {\n    var names = Object.getOwnPropertyNames(proto);\n    for (var i = 0; i < names.length; i++) {\n      visitedSet[names[i]] = true;\n    }\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return goog.object.getKeys(visitedSet);\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Closure user agent detection (Browser).\n * @see <a href=\"http://www.useragentstring.com/\">User agent strings</a>\n * For more information on rendering engine, platform, or device see the other\n * sub-namespaces in goog.labs.userAgent, goog.labs.userAgent.platform,\n * goog.labs.userAgent.device respectively.)\n *\n * @author martone@google.com (Andy Martone)\n */\n\ngoog.provide('goog.labs.userAgent.browser');\n\ngoog.require('goog.array');\ngoog.require('goog.labs.userAgent.util');\ngoog.require('goog.object');\ngoog.require('goog.string');\n\n\n// TODO(nnaze): Refactor to remove excessive exclusion logic in matching\n// functions.\n\n\n/**\n * @return {boolean} Whether the user's browser is Opera.  Note: Chromium\n *     based Opera (Opera 15+) is detected as Chrome to avoid unnecessary\n *     special casing.\n * @private\n */\ngoog.labs.userAgent.browser.matchOpera_ = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Opera');\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is IE.\n * @private\n */\ngoog.labs.userAgent.browser.matchIE_ = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Trident') ||\n      goog.labs.userAgent.util.matchUserAgent('MSIE');\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is Edge.\n * @private\n */\ngoog.labs.userAgent.browser.matchEdge_ = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Edge');\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is Firefox.\n * @private\n */\ngoog.labs.userAgent.browser.matchFirefox_ = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Firefox');\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is Safari.\n * @private\n */\ngoog.labs.userAgent.browser.matchSafari_ = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Safari') &&\n      !(goog.labs.userAgent.browser.matchChrome_() ||\n        goog.labs.userAgent.browser.matchCoast_() ||\n        goog.labs.userAgent.browser.matchOpera_() ||\n        goog.labs.userAgent.browser.matchEdge_() ||\n        goog.labs.userAgent.browser.isSilk() ||\n        goog.labs.userAgent.util.matchUserAgent('Android'));\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is Coast (Opera's Webkit-based\n *     iOS browser).\n * @private\n */\ngoog.labs.userAgent.browser.matchCoast_ = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Coast');\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is iOS Webview.\n * @private\n */\ngoog.labs.userAgent.browser.matchIosWebview_ = function() {\n  // iOS Webview does not show up as Chrome or Safari. Also check for Opera's\n  // WebKit-based iOS browser, Coast.\n  return (goog.labs.userAgent.util.matchUserAgent('iPad') ||\n          goog.labs.userAgent.util.matchUserAgent('iPhone')) &&\n      !goog.labs.userAgent.browser.matchSafari_() &&\n      !goog.labs.userAgent.browser.matchChrome_() &&\n      !goog.labs.userAgent.browser.matchCoast_() &&\n      goog.labs.userAgent.util.matchUserAgent('AppleWebKit');\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is Chrome.\n * @private\n */\ngoog.labs.userAgent.browser.matchChrome_ = function() {\n  return (goog.labs.userAgent.util.matchUserAgent('Chrome') ||\n          goog.labs.userAgent.util.matchUserAgent('CriOS')) &&\n      !goog.labs.userAgent.browser.matchEdge_();\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is the Android browser.\n * @private\n */\ngoog.labs.userAgent.browser.matchAndroidBrowser_ = function() {\n  // Android can appear in the user agent string for Chrome on Android.\n  // This is not the Android standalone browser if it does.\n  return goog.labs.userAgent.util.matchUserAgent('Android') &&\n      !(goog.labs.userAgent.browser.isChrome() ||\n        goog.labs.userAgent.browser.isFirefox() ||\n        goog.labs.userAgent.browser.isOpera() ||\n        goog.labs.userAgent.browser.isSilk());\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is Opera.\n */\ngoog.labs.userAgent.browser.isOpera = goog.labs.userAgent.browser.matchOpera_;\n\n\n/**\n * @return {boolean} Whether the user's browser is IE.\n */\ngoog.labs.userAgent.browser.isIE = goog.labs.userAgent.browser.matchIE_;\n\n\n/**\n * @return {boolean} Whether the user's browser is Edge.\n */\ngoog.labs.userAgent.browser.isEdge = goog.labs.userAgent.browser.matchEdge_;\n\n\n/**\n * @return {boolean} Whether the user's browser is Firefox.\n */\ngoog.labs.userAgent.browser.isFirefox =\n    goog.labs.userAgent.browser.matchFirefox_;\n\n\n/**\n * @return {boolean} Whether the user's browser is Safari.\n */\ngoog.labs.userAgent.browser.isSafari = goog.labs.userAgent.browser.matchSafari_;\n\n\n/**\n * @return {boolean} Whether the user's browser is Coast (Opera's Webkit-based\n *     iOS browser).\n */\ngoog.labs.userAgent.browser.isCoast = goog.labs.userAgent.browser.matchCoast_;\n\n\n/**\n * @return {boolean} Whether the user's browser is iOS Webview.\n */\ngoog.labs.userAgent.browser.isIosWebview =\n    goog.labs.userAgent.browser.matchIosWebview_;\n\n\n/**\n * @return {boolean} Whether the user's browser is Chrome.\n */\ngoog.labs.userAgent.browser.isChrome = goog.labs.userAgent.browser.matchChrome_;\n\n\n/**\n * @return {boolean} Whether the user's browser is the Android browser.\n */\ngoog.labs.userAgent.browser.isAndroidBrowser =\n    goog.labs.userAgent.browser.matchAndroidBrowser_;\n\n\n/**\n * For more information, see:\n * http://docs.aws.amazon.com/silk/latest/developerguide/user-agent.html\n * @return {boolean} Whether the user's browser is Silk.\n */\ngoog.labs.userAgent.browser.isSilk = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Silk');\n};\n\n\n/**\n * @return {string} The browser version or empty string if version cannot be\n *     determined. Note that for Internet Explorer, this returns the version of\n *     the browser, not the version of the rendering engine. (IE 8 in\n *     compatibility mode will return 8.0 rather than 7.0. To determine the\n *     rendering engine version, look at document.documentMode instead. See\n *     http://msdn.microsoft.com/en-us/library/cc196988(v=vs.85).aspx for more\n *     details.)\n */\ngoog.labs.userAgent.browser.getVersion = function() {\n  var userAgentString = goog.labs.userAgent.util.getUserAgent();\n  // Special case IE since IE's version is inside the parenthesis and\n  // without the '/'.\n  if (goog.labs.userAgent.browser.isIE()) {\n    return goog.labs.userAgent.browser.getIEVersion_(userAgentString);\n  }\n\n  var versionTuples =\n      goog.labs.userAgent.util.extractVersionTuples(userAgentString);\n\n  // Construct a map for easy lookup.\n  var versionMap = {};\n  goog.array.forEach(versionTuples, function(tuple) {\n    // Note that the tuple is of length three, but we only care about the\n    // first two.\n    var key = tuple[0];\n    var value = tuple[1];\n    versionMap[key] = value;\n  });\n\n  var versionMapHasKey = goog.partial(goog.object.containsKey, versionMap);\n\n  // Gives the value with the first key it finds, otherwise empty string.\n  function lookUpValueWithKeys(keys) {\n    var key = goog.array.find(keys, versionMapHasKey);\n    return versionMap[key] || '';\n  }\n\n  // Check Opera before Chrome since Opera 15+ has \"Chrome\" in the string.\n  // See\n  // http://my.opera.com/ODIN/blog/2013/07/15/opera-user-agent-strings-opera-15-and-beyond\n  if (goog.labs.userAgent.browser.isOpera()) {\n    // Opera 10 has Version/10.0 but Opera/9.8, so look for \"Version\" first.\n    // Opera uses 'OPR' for more recent UAs.\n    return lookUpValueWithKeys(['Version', 'Opera']);\n  }\n\n  // Check Edge before Chrome since it has Chrome in the string.\n  if (goog.labs.userAgent.browser.isEdge()) {\n    return lookUpValueWithKeys(['Edge']);\n  }\n\n  if (goog.labs.userAgent.browser.isChrome()) {\n    return lookUpValueWithKeys(['Chrome', 'CriOS']);\n  }\n\n  // Usually products browser versions are in the third tuple after \"Mozilla\"\n  // and the engine.\n  var tuple = versionTuples[2];\n  return tuple && tuple[1] || '';\n};\n\n\n/**\n * @param {string|number} version The version to check.\n * @return {boolean} Whether the browser version is higher or the same as the\n *     given version.\n */\ngoog.labs.userAgent.browser.isVersionOrHigher = function(version) {\n  return goog.string.compareVersions(\n             goog.labs.userAgent.browser.getVersion(), version) >= 0;\n};\n\n\n/**\n * Determines IE version. More information:\n * http://msdn.microsoft.com/en-us/library/ie/bg182625(v=vs.85).aspx#uaString\n * http://msdn.microsoft.com/en-us/library/hh869301(v=vs.85).aspx\n * http://blogs.msdn.com/b/ie/archive/2010/03/23/introducing-ie9-s-user-agent-string.aspx\n * http://blogs.msdn.com/b/ie/archive/2009/01/09/the-internet-explorer-8-user-agent-string-updated-edition.aspx\n *\n * @param {string} userAgent the User-Agent.\n * @return {string}\n * @private\n */\ngoog.labs.userAgent.browser.getIEVersion_ = function(userAgent) {\n  // IE11 may identify itself as MSIE 9.0 or MSIE 10.0 due to an IE 11 upgrade\n  // bug. Example UA:\n  // Mozilla/5.0 (MSIE 9.0; Windows NT 6.1; WOW64; Trident/7.0; rv:11.0)\n  // like Gecko.\n  // See http://www.whatismybrowser.com/developers/unknown-user-agent-fragments.\n  var rv = /rv: *([\\d\\.]*)/.exec(userAgent);\n  if (rv && rv[1]) {\n    return rv[1];\n  }\n\n  var version = '';\n  var msie = /MSIE +([\\d\\.]+)/.exec(userAgent);\n  if (msie && msie[1]) {\n    // IE in compatibility mode usually identifies itself as MSIE 7.0; in this\n    // case, use the Trident version to determine the version of IE. For more\n    // details, see the links above.\n    var tridentVersion = /Trident\\/(\\d.\\d)/.exec(userAgent);\n    if (msie[1] == '7.0') {\n      if (tridentVersion && tridentVersion[1]) {\n        switch (tridentVersion[1]) {\n          case '4.0':\n            version = '8.0';\n            break;\n          case '5.0':\n            version = '9.0';\n            break;\n          case '6.0':\n            version = '10.0';\n            break;\n          case '7.0':\n            version = '11.0';\n            break;\n        }\n      } else {\n        version = '7.0';\n      }\n    } else {\n      version = msie[1];\n    }\n  }\n  return version;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Closure user agent detection.\n * @see http://en.wikipedia.org/wiki/User_agent\n * For more information on browser brand, platform, or device see the other\n * sub-namespaces in goog.labs.userAgent (browser, platform, and device).\n *\n */\n\ngoog.provide('goog.labs.userAgent.engine');\n\ngoog.require('goog.array');\ngoog.require('goog.labs.userAgent.util');\ngoog.require('goog.string');\n\n\n/**\n * @return {boolean} Whether the rendering engine is Presto.\n */\ngoog.labs.userAgent.engine.isPresto = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Presto');\n};\n\n\n/**\n * @return {boolean} Whether the rendering engine is Trident.\n */\ngoog.labs.userAgent.engine.isTrident = function() {\n  // IE only started including the Trident token in IE8.\n  return goog.labs.userAgent.util.matchUserAgent('Trident') ||\n      goog.labs.userAgent.util.matchUserAgent('MSIE');\n};\n\n\n/**\n * @return {boolean} Whether the rendering engine is Edge.\n */\ngoog.labs.userAgent.engine.isEdge = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Edge');\n};\n\n\n/**\n * @return {boolean} Whether the rendering engine is WebKit.\n */\ngoog.labs.userAgent.engine.isWebKit = function() {\n  return goog.labs.userAgent.util.matchUserAgentIgnoreCase('WebKit') &&\n      !goog.labs.userAgent.engine.isEdge();\n};\n\n\n/**\n * @return {boolean} Whether the rendering engine is Gecko.\n */\ngoog.labs.userAgent.engine.isGecko = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Gecko') &&\n      !goog.labs.userAgent.engine.isWebKit() &&\n      !goog.labs.userAgent.engine.isTrident() &&\n      !goog.labs.userAgent.engine.isEdge();\n};\n\n\n/**\n * @return {string} The rendering engine's version or empty string if version\n *     can't be determined.\n */\ngoog.labs.userAgent.engine.getVersion = function() {\n  var userAgentString = goog.labs.userAgent.util.getUserAgent();\n  if (userAgentString) {\n    var tuples = goog.labs.userAgent.util.extractVersionTuples(userAgentString);\n\n    var engineTuple = goog.labs.userAgent.engine.getEngineTuple_(tuples);\n    if (engineTuple) {\n      // In Gecko, the version string is either in the browser info or the\n      // Firefox version.  See Gecko user agent string reference:\n      // http://goo.gl/mULqa\n      if (engineTuple[0] == 'Gecko') {\n        return goog.labs.userAgent.engine.getVersionForKey_(tuples, 'Firefox');\n      }\n\n      return engineTuple[1];\n    }\n\n    // MSIE has only one version identifier, and the Trident version is\n    // specified in the parenthetical. IE Edge is covered in the engine tuple\n    // detection.\n    var browserTuple = tuples[0];\n    var info;\n    if (browserTuple && (info = browserTuple[2])) {\n      var match = /Trident\\/([^\\s;]+)/.exec(info);\n      if (match) {\n        return match[1];\n      }\n    }\n  }\n  return '';\n};\n\n\n/**\n * @param {!Array<!Array<string>>} tuples Extracted version tuples.\n * @return {!Array<string>|undefined} The engine tuple or undefined if not\n *     found.\n * @private\n */\ngoog.labs.userAgent.engine.getEngineTuple_ = function(tuples) {\n  if (!goog.labs.userAgent.engine.isEdge()) {\n    return tuples[1];\n  }\n  for (var i = 0; i < tuples.length; i++) {\n    var tuple = tuples[i];\n    if (tuple[0] == 'Edge') {\n      return tuple;\n    }\n  }\n};\n\n\n/**\n * @param {string|number} version The version to check.\n * @return {boolean} Whether the rendering engine version is higher or the same\n *     as the given version.\n */\ngoog.labs.userAgent.engine.isVersionOrHigher = function(version) {\n  return goog.string.compareVersions(\n             goog.labs.userAgent.engine.getVersion(), version) >= 0;\n};\n\n\n/**\n * @param {!Array<!Array<string>>} tuples Version tuples.\n * @param {string} key The key to look for.\n * @return {string} The version string of the given key, if present.\n *     Otherwise, the empty string.\n * @private\n */\ngoog.labs.userAgent.engine.getVersionForKey_ = function(tuples, key) {\n  // TODO(nnaze): Move to util if useful elsewhere.\n\n  var pair = goog.array.find(tuples, function(pair) { return key == pair[0]; });\n\n  return pair && pair[1] || '';\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Closure user agent platform detection.\n * @see <a href=\"http://www.useragentstring.com/\">User agent strings</a>\n * For more information on browser brand, rendering engine, or device see the\n * other sub-namespaces in goog.labs.userAgent (browser, engine, and device\n * respectively).\n *\n */\n\ngoog.provide('goog.labs.userAgent.platform');\n\ngoog.require('goog.labs.userAgent.util');\ngoog.require('goog.string');\n\n\n/**\n * @return {boolean} Whether the platform is Android.\n */\ngoog.labs.userAgent.platform.isAndroid = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Android');\n};\n\n\n/**\n * @return {boolean} Whether the platform is iPod.\n */\ngoog.labs.userAgent.platform.isIpod = function() {\n  return goog.labs.userAgent.util.matchUserAgent('iPod');\n};\n\n\n/**\n * @return {boolean} Whether the platform is iPhone.\n */\ngoog.labs.userAgent.platform.isIphone = function() {\n  return goog.labs.userAgent.util.matchUserAgent('iPhone') &&\n      !goog.labs.userAgent.util.matchUserAgent('iPod') &&\n      !goog.labs.userAgent.util.matchUserAgent('iPad');\n};\n\n\n/**\n * @return {boolean} Whether the platform is iPad.\n */\ngoog.labs.userAgent.platform.isIpad = function() {\n  return goog.labs.userAgent.util.matchUserAgent('iPad');\n};\n\n\n/**\n * @return {boolean} Whether the platform is iOS.\n */\ngoog.labs.userAgent.platform.isIos = function() {\n  return goog.labs.userAgent.platform.isIphone() ||\n      goog.labs.userAgent.platform.isIpad() ||\n      goog.labs.userAgent.platform.isIpod();\n};\n\n\n/**\n * @return {boolean} Whether the platform is Mac.\n */\ngoog.labs.userAgent.platform.isMacintosh = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Macintosh');\n};\n\n\n/**\n * Note: ChromeOS is not considered to be Linux as it does not report itself\n * as Linux in the user agent string.\n * @return {boolean} Whether the platform is Linux.\n */\ngoog.labs.userAgent.platform.isLinux = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Linux');\n};\n\n\n/**\n * @return {boolean} Whether the platform is Windows.\n */\ngoog.labs.userAgent.platform.isWindows = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Windows');\n};\n\n\n/**\n * @return {boolean} Whether the platform is ChromeOS.\n */\ngoog.labs.userAgent.platform.isChromeOS = function() {\n  return goog.labs.userAgent.util.matchUserAgent('CrOS');\n};\n\n\n/**\n * The version of the platform. We only determine the version for Windows,\n * Mac, and Chrome OS. It doesn't make much sense on Linux. For Windows, we only\n * look at the NT version. Non-NT-based versions (e.g. 95, 98, etc.) are given\n * version 0.0.\n *\n * @return {string} The platform version or empty string if version cannot be\n *     determined.\n */\ngoog.labs.userAgent.platform.getVersion = function() {\n  var userAgentString = goog.labs.userAgent.util.getUserAgent();\n  var version = '', re;\n  if (goog.labs.userAgent.platform.isWindows()) {\n    re = /Windows (?:NT|Phone) ([0-9.]+)/;\n    var match = re.exec(userAgentString);\n    if (match) {\n      version = match[1];\n    } else {\n      version = '0.0';\n    }\n  } else if (goog.labs.userAgent.platform.isIos()) {\n    re = /(?:iPhone|iPod|iPad|CPU)\\s+OS\\s+(\\S+)/;\n    var match = re.exec(userAgentString);\n    // Report the version as x.y.z and not x_y_z\n    version = match && match[1].replace(/_/g, '.');\n  } else if (goog.labs.userAgent.platform.isMacintosh()) {\n    re = /Mac OS X ([0-9_.]+)/;\n    var match = re.exec(userAgentString);\n    // Note: some old versions of Camino do not report an OSX version.\n    // Default to 10.\n    version = match ? match[1].replace(/_/g, '.') : '10';\n  } else if (goog.labs.userAgent.platform.isAndroid()) {\n    re = /Android\\s+([^\\);]+)(\\)|;)/;\n    var match = re.exec(userAgentString);\n    version = match && match[1];\n  } else if (goog.labs.userAgent.platform.isChromeOS()) {\n    re = /(?:CrOS\\s+(?:i686|x86_64)\\s+([0-9.]+))/;\n    var match = re.exec(userAgentString);\n    version = match && match[1];\n  }\n  return version || '';\n};\n\n\n/**\n * @param {string|number} version The version to check.\n * @return {boolean} Whether the browser version is higher or the same as the\n *     given version.\n */\ngoog.labs.userAgent.platform.isVersionOrHigher = function(version) {\n  return goog.string.compareVersions(\n             goog.labs.userAgent.platform.getVersion(), version) >= 0;\n};\n","// Copyright 2009 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Useful compiler idioms.\n *\n * @author johnlenz@google.com (John Lenz)\n */\n\ngoog.provide('goog.reflect');\n\n\n/**\n * Syntax for object literal casts.\n * @see http://go/jscompiler-renaming\n * @see https://goo.gl/CRs09P\n *\n * Use this if you have an object literal whose keys need to have the same names\n * as the properties of some class even after they are renamed by the compiler.\n *\n * @param {!Function} type Type to cast to.\n * @param {Object} object Object literal to cast.\n * @return {Object} The object literal.\n */\ngoog.reflect.object = function(type, object) {\n  return object;\n};\n\n/**\n * Syntax for renaming property strings.\n * @see http://go/jscompiler-renaming\n * @see https://goo.gl/CRs09P\n *\n * Use this if you have an need to access a property as a string, but want\n * to also have the property renamed by the compiler. In contrast to\n * goog.reflect.object, this method takes an instance of an object.\n *\n * Properties must be simple names (not qualified names).\n *\n * @param {string} prop Name of the property\n * @param {!Object} object Instance of the object whose type will be used\n *     for renaming\n * @return {string} The renamed property.\n */\ngoog.reflect.objectProperty = function(prop, object) {\n  return prop;\n};\n\n/**\n * To assert to the compiler that an operation is needed when it would\n * otherwise be stripped. For example:\n * <code>\n *     // Force a layout\n *     goog.reflect.sinkValue(dialog.offsetHeight);\n * </code>\n * @param {T} x\n * @return {T}\n * @template T\n */\ngoog.reflect.sinkValue = function(x) {\n  goog.reflect.sinkValue[' '](x);\n  return x;\n};\n\n\n/**\n * The compiler should optimize this function away iff no one ever uses\n * goog.reflect.sinkValue.\n */\ngoog.reflect.sinkValue[' '] = goog.nullFunction;\n\n\n/**\n * Check if a property can be accessed without throwing an exception.\n * @param {Object} obj The owner of the property.\n * @param {string} prop The property name.\n * @return {boolean} Whether the property is accessible. Will also return true\n *     if obj is null.\n */\ngoog.reflect.canAccessProperty = function(obj, prop) {\n  /** @preserveTry */\n  try {\n    goog.reflect.sinkValue(obj[prop]);\n    return true;\n  } catch (e) {\n  }\n  return false;\n};\n\n\n/**\n * Retrieves a value from a cache given a key. The compiler provides special\n * consideration for this call such that it is generally considered side-effect\n * free. However, if the {@code opt_keyFn} or {@code valueFn} have side-effects\n * then the entire call is considered to have side-effects.\n *\n * Conventionally storing the value on the cache would be considered a\n * side-effect and preclude unused calls from being pruned, ie. even if\n * the value was never used, it would still always be stored in the cache.\n *\n * Providing a side-effect free {@code valueFn} and {@code opt_keyFn}\n * allows unused calls to {@code goog.reflect.cache} to be pruned.\n *\n * @param {!Object<K, V>} cacheObj The object that contains the cached values.\n * @param {?} key The key to lookup in the cache. If it is not string or number\n *     then a {@code opt_keyFn} should be provided. The key is also used as the\n *     parameter to the {@code valueFn}.\n * @param {function(?):V} valueFn The value provider to use to calculate the\n *     value to store in the cache. This function should be side-effect free\n *     to take advantage of the optimization.\n * @param {function(?):K=} opt_keyFn The key provider to determine the cache\n *     map key. This should be used if the given key is not a string or number.\n *     If not provided then the given key is used. This function should be\n *     side-effect free to take advantage of the optimization.\n * @return {V} The cached or calculated value.\n * @template K\n * @template V\n */\ngoog.reflect.cache = function(cacheObj, key, valueFn, opt_keyFn) {\n  var storedKey = opt_keyFn ? opt_keyFn(key) : key;\n\n  if (Object.prototype.hasOwnProperty.call(cacheObj, storedKey)) {\n    return cacheObj[storedKey];\n  }\n\n  return (cacheObj[storedKey] = valueFn(key));\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Rendering engine detection.\n * @see <a href=\"http://www.useragentstring.com/\">User agent strings</a>\n * For information on the browser brand (such as Safari versus Chrome), see\n * goog.userAgent.product.\n * @author arv@google.com (Erik Arvidsson)\n * @see ../demos/useragent.html\n */\n\ngoog.provide('goog.userAgent');\n\ngoog.require('goog.labs.userAgent.browser');\ngoog.require('goog.labs.userAgent.engine');\ngoog.require('goog.labs.userAgent.platform');\ngoog.require('goog.labs.userAgent.util');\ngoog.require('goog.reflect');\ngoog.require('goog.string');\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the browser is IE.\n */\ngoog.define('goog.userAgent.ASSUME_IE', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the browser is EDGE.\n */\ngoog.define('goog.userAgent.ASSUME_EDGE', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the browser is GECKO.\n */\ngoog.define('goog.userAgent.ASSUME_GECKO', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the browser is WEBKIT.\n */\ngoog.define('goog.userAgent.ASSUME_WEBKIT', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the browser is a\n *     mobile device running WebKit e.g. iPhone or Android.\n */\ngoog.define('goog.userAgent.ASSUME_MOBILE_WEBKIT', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the browser is OPERA.\n */\ngoog.define('goog.userAgent.ASSUME_OPERA', false);\n\n\n/**\n * @define {boolean} Whether the\n *     {@code goog.userAgent.isVersionOrHigher}\n *     function will return true for any version.\n */\ngoog.define('goog.userAgent.ASSUME_ANY_VERSION', false);\n\n\n/**\n * Whether we know the browser engine at compile-time.\n * @type {boolean}\n * @private\n */\ngoog.userAgent.BROWSER_KNOWN_ = goog.userAgent.ASSUME_IE ||\n    goog.userAgent.ASSUME_EDGE || goog.userAgent.ASSUME_GECKO ||\n    goog.userAgent.ASSUME_MOBILE_WEBKIT || goog.userAgent.ASSUME_WEBKIT ||\n    goog.userAgent.ASSUME_OPERA;\n\n\n/**\n * Returns the userAgent string for the current browser.\n *\n * @return {string} The userAgent string.\n */\ngoog.userAgent.getUserAgentString = function() {\n  return goog.labs.userAgent.util.getUserAgent();\n};\n\n\n/**\n * TODO(nnaze): Change type to \"Navigator\" and update compilation targets.\n * @return {Object} The native navigator object.\n */\ngoog.userAgent.getNavigator = function() {\n  // Need a local navigator reference instead of using the global one,\n  // to avoid the rare case where they reference different objects.\n  // (in a WorkerPool, for example).\n  return goog.global['navigator'] || null;\n};\n\n\n/**\n * Whether the user agent is Opera.\n * @type {boolean}\n */\ngoog.userAgent.OPERA = goog.userAgent.BROWSER_KNOWN_ ?\n    goog.userAgent.ASSUME_OPERA :\n    goog.labs.userAgent.browser.isOpera();\n\n\n/**\n * Whether the user agent is Internet Explorer.\n * @type {boolean}\n */\ngoog.userAgent.IE = goog.userAgent.BROWSER_KNOWN_ ?\n    goog.userAgent.ASSUME_IE :\n    goog.labs.userAgent.browser.isIE();\n\n\n/**\n * Whether the user agent is Microsoft Edge.\n * @type {boolean}\n */\ngoog.userAgent.EDGE = goog.userAgent.BROWSER_KNOWN_ ?\n    goog.userAgent.ASSUME_EDGE :\n    goog.labs.userAgent.engine.isEdge();\n\n\n/**\n * Whether the user agent is MS Internet Explorer or MS Edge.\n * @type {boolean}\n */\ngoog.userAgent.EDGE_OR_IE = goog.userAgent.EDGE || goog.userAgent.IE;\n\n\n/**\n * Whether the user agent is Gecko. Gecko is the rendering engine used by\n * Mozilla, Firefox, and others.\n * @type {boolean}\n */\ngoog.userAgent.GECKO = goog.userAgent.BROWSER_KNOWN_ ?\n    goog.userAgent.ASSUME_GECKO :\n    goog.labs.userAgent.engine.isGecko();\n\n\n/**\n * Whether the user agent is WebKit. WebKit is the rendering engine that\n * Safari, Android and others use.\n * @type {boolean}\n */\ngoog.userAgent.WEBKIT = goog.userAgent.BROWSER_KNOWN_ ?\n    goog.userAgent.ASSUME_WEBKIT || goog.userAgent.ASSUME_MOBILE_WEBKIT :\n    goog.labs.userAgent.engine.isWebKit();\n\n\n/**\n * Whether the user agent is running on a mobile device.\n *\n * This is a separate function so that the logic can be tested.\n *\n * TODO(nnaze): Investigate swapping in goog.labs.userAgent.device.isMobile().\n *\n * @return {boolean} Whether the user agent is running on a mobile device.\n * @private\n */\ngoog.userAgent.isMobile_ = function() {\n  return goog.userAgent.WEBKIT &&\n      goog.labs.userAgent.util.matchUserAgent('Mobile');\n};\n\n\n/**\n * Whether the user agent is running on a mobile device.\n *\n * TODO(nnaze): Consider deprecating MOBILE when labs.userAgent\n *   is promoted as the gecko/webkit logic is likely inaccurate.\n *\n * @type {boolean}\n */\ngoog.userAgent.MOBILE =\n    goog.userAgent.ASSUME_MOBILE_WEBKIT || goog.userAgent.isMobile_();\n\n\n/**\n * Used while transitioning code to use WEBKIT instead.\n * @type {boolean}\n * @deprecated Use {@link goog.userAgent.product.SAFARI} instead.\n * TODO(nicksantos): Delete this from goog.userAgent.\n */\ngoog.userAgent.SAFARI = goog.userAgent.WEBKIT;\n\n\n/**\n * @return {string} the platform (operating system) the user agent is running\n *     on. Default to empty string because navigator.platform may not be defined\n *     (on Rhino, for example).\n * @private\n */\ngoog.userAgent.determinePlatform_ = function() {\n  var navigator = goog.userAgent.getNavigator();\n  return navigator && navigator.platform || '';\n};\n\n\n/**\n * The platform (operating system) the user agent is running on. Default to\n * empty string because navigator.platform may not be defined (on Rhino, for\n * example).\n * @type {string}\n */\ngoog.userAgent.PLATFORM = goog.userAgent.determinePlatform_();\n\n\n/**\n * @define {boolean} Whether the user agent is running on a Macintosh operating\n *     system.\n */\ngoog.define('goog.userAgent.ASSUME_MAC', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on a Windows operating\n *     system.\n */\ngoog.define('goog.userAgent.ASSUME_WINDOWS', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on a Linux operating\n *     system.\n */\ngoog.define('goog.userAgent.ASSUME_LINUX', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on a X11 windowing\n *     system.\n */\ngoog.define('goog.userAgent.ASSUME_X11', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on Android.\n */\ngoog.define('goog.userAgent.ASSUME_ANDROID', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on an iPhone.\n */\ngoog.define('goog.userAgent.ASSUME_IPHONE', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on an iPad.\n */\ngoog.define('goog.userAgent.ASSUME_IPAD', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on an iPod.\n */\ngoog.define('goog.userAgent.ASSUME_IPOD', false);\n\n\n/**\n * @type {boolean}\n * @private\n */\ngoog.userAgent.PLATFORM_KNOWN_ = goog.userAgent.ASSUME_MAC ||\n    goog.userAgent.ASSUME_WINDOWS || goog.userAgent.ASSUME_LINUX ||\n    goog.userAgent.ASSUME_X11 || goog.userAgent.ASSUME_ANDROID ||\n    goog.userAgent.ASSUME_IPHONE || goog.userAgent.ASSUME_IPAD ||\n    goog.userAgent.ASSUME_IPOD;\n\n\n/**\n * Whether the user agent is running on a Macintosh operating system.\n * @type {boolean}\n */\ngoog.userAgent.MAC = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_MAC :\n    goog.labs.userAgent.platform.isMacintosh();\n\n\n/**\n * Whether the user agent is running on a Windows operating system.\n * @type {boolean}\n */\ngoog.userAgent.WINDOWS = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_WINDOWS :\n    goog.labs.userAgent.platform.isWindows();\n\n\n/**\n * Whether the user agent is Linux per the legacy behavior of\n * goog.userAgent.LINUX, which considered ChromeOS to also be\n * Linux.\n * @return {boolean}\n * @private\n */\ngoog.userAgent.isLegacyLinux_ = function() {\n  return goog.labs.userAgent.platform.isLinux() ||\n      goog.labs.userAgent.platform.isChromeOS();\n};\n\n\n/**\n * Whether the user agent is running on a Linux operating system.\n *\n * Note that goog.userAgent.LINUX considers ChromeOS to be Linux,\n * while goog.labs.userAgent.platform considers ChromeOS and\n * Linux to be different OSes.\n *\n * @type {boolean}\n */\ngoog.userAgent.LINUX = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_LINUX :\n    goog.userAgent.isLegacyLinux_();\n\n\n/**\n * @return {boolean} Whether the user agent is an X11 windowing system.\n * @private\n */\ngoog.userAgent.isX11_ = function() {\n  var navigator = goog.userAgent.getNavigator();\n  return !!navigator &&\n      goog.string.contains(navigator['appVersion'] || '', 'X11');\n};\n\n\n/**\n * Whether the user agent is running on a X11 windowing system.\n * @type {boolean}\n */\ngoog.userAgent.X11 = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_X11 :\n    goog.userAgent.isX11_();\n\n\n/**\n * Whether the user agent is running on Android.\n * @type {boolean}\n */\ngoog.userAgent.ANDROID = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_ANDROID :\n    goog.labs.userAgent.platform.isAndroid();\n\n\n/**\n * Whether the user agent is running on an iPhone.\n * @type {boolean}\n */\ngoog.userAgent.IPHONE = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_IPHONE :\n    goog.labs.userAgent.platform.isIphone();\n\n\n/**\n * Whether the user agent is running on an iPad.\n * @type {boolean}\n */\ngoog.userAgent.IPAD = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_IPAD :\n    goog.labs.userAgent.platform.isIpad();\n\n\n/**\n * Whether the user agent is running on an iPod.\n * @type {boolean}\n */\ngoog.userAgent.IPOD = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_IPOD :\n    goog.labs.userAgent.platform.isIpod();\n\n\n/**\n * Whether the user agent is running on iOS.\n * @type {boolean}\n */\ngoog.userAgent.IOS = goog.userAgent.PLATFORM_KNOWN_ ?\n    (goog.userAgent.ASSUME_IPHONE || goog.userAgent.ASSUME_IPAD ||\n     goog.userAgent.ASSUME_IPOD) :\n    goog.labs.userAgent.platform.isIos();\n\n/**\n * @return {string} The string that describes the version number of the user\n *     agent.\n * @private\n */\ngoog.userAgent.determineVersion_ = function() {\n  // All browsers have different ways to detect the version and they all have\n  // different naming schemes.\n  // version is a string rather than a number because it may contain 'b', 'a',\n  // and so on.\n  var version = '';\n  var arr = goog.userAgent.getVersionRegexResult_();\n  if (arr) {\n    version = arr ? arr[1] : '';\n  }\n\n  if (goog.userAgent.IE) {\n    // IE9 can be in document mode 9 but be reporting an inconsistent user agent\n    // version.  If it is identifying as a version lower than 9 we take the\n    // documentMode as the version instead.  IE8 has similar behavior.\n    // It is recommended to set the X-UA-Compatible header to ensure that IE9\n    // uses documentMode 9.\n    var docMode = goog.userAgent.getDocumentMode_();\n    if (docMode != null && docMode > parseFloat(version)) {\n      return String(docMode);\n    }\n  }\n\n  return version;\n};\n\n\n/**\n * @return {?Array|undefined} The version regex matches from parsing the user\n *     agent string. These regex statements must be executed inline so they can\n *     be compiled out by the closure compiler with the rest of the useragent\n *     detection logic when ASSUME_* is specified.\n * @private\n */\ngoog.userAgent.getVersionRegexResult_ = function() {\n  var userAgent = goog.userAgent.getUserAgentString();\n  if (goog.userAgent.GECKO) {\n    return /rv\\:([^\\);]+)(\\)|;)/.exec(userAgent);\n  }\n  if (goog.userAgent.EDGE) {\n    return /Edge\\/([\\d\\.]+)/.exec(userAgent);\n  }\n  if (goog.userAgent.IE) {\n    return /\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(userAgent);\n  }\n  if (goog.userAgent.WEBKIT) {\n    // WebKit/125.4\n    return /WebKit\\/(\\S+)/.exec(userAgent);\n  }\n  if (goog.userAgent.OPERA) {\n    // If none of the above browsers were detected but the browser is Opera, the\n    // only string that is of interest is 'Version/<number>'.\n    return /(?:Version)[ \\/]?(\\S+)/.exec(userAgent);\n  }\n  return undefined;\n};\n\n\n/**\n * @return {number|undefined} Returns the document mode (for testing).\n * @private\n */\ngoog.userAgent.getDocumentMode_ = function() {\n  // NOTE(user): goog.userAgent may be used in context where there is no DOM.\n  var doc = goog.global['document'];\n  return doc ? doc['documentMode'] : undefined;\n};\n\n\n/**\n * The version of the user agent. This is a string because it might contain\n * 'b' (as in beta) as well as multiple dots.\n * @type {string}\n */\ngoog.userAgent.VERSION = goog.userAgent.determineVersion_();\n\n\n/**\n * Compares two version numbers.\n *\n * @param {string} v1 Version of first item.\n * @param {string} v2 Version of second item.\n *\n * @return {number}  1 if first argument is higher\n *                   0 if arguments are equal\n *                  -1 if second argument is higher.\n * @deprecated Use goog.string.compareVersions.\n */\ngoog.userAgent.compare = function(v1, v2) {\n  return goog.string.compareVersions(v1, v2);\n};\n\n\n/**\n * Cache for {@link goog.userAgent.isVersionOrHigher}.\n * Calls to compareVersions are surprisingly expensive and, as a browser's\n * version number is unlikely to change during a session, we cache the results.\n * @const\n * @private\n */\ngoog.userAgent.isVersionOrHigherCache_ = {};\n\n\n/**\n * Whether the user agent version is higher or the same as the given version.\n * NOTE: When checking the version numbers for Firefox and Safari, be sure to\n * use the engine's version, not the browser's version number.  For example,\n * Firefox 3.0 corresponds to Gecko 1.9 and Safari 3.0 to Webkit 522.11.\n * Opera and Internet Explorer versions match the product release number.<br>\n * @see <a href=\"http://en.wikipedia.org/wiki/Safari_version_history\">\n *     Webkit</a>\n * @see <a href=\"http://en.wikipedia.org/wiki/Gecko_engine\">Gecko</a>\n *\n * @param {string|number} version The version to check.\n * @return {boolean} Whether the user agent version is higher or the same as\n *     the given version.\n */\ngoog.userAgent.isVersionOrHigher = function(version) {\n  return goog.userAgent.ASSUME_ANY_VERSION ||\n      goog.reflect.cache(\n          goog.userAgent.isVersionOrHigherCache_, version, function() {\n            return goog.string.compareVersions(\n                       goog.userAgent.VERSION, version) >= 0;\n          });\n};\n\n\n/**\n * Deprecated alias to {@code goog.userAgent.isVersionOrHigher}.\n * @param {string|number} version The version to check.\n * @return {boolean} Whether the user agent version is higher or the same as\n *     the given version.\n * @deprecated Use goog.userAgent.isVersionOrHigher().\n */\ngoog.userAgent.isVersion = goog.userAgent.isVersionOrHigher;\n\n\n/**\n * Whether the IE effective document mode is higher or the same as the given\n * document mode version.\n * NOTE: Only for IE, return false for another browser.\n *\n * @param {number} documentMode The document mode version to check.\n * @return {boolean} Whether the IE effective document mode is higher or the\n *     same as the given version.\n */\ngoog.userAgent.isDocumentModeOrHigher = function(documentMode) {\n  return Number(goog.userAgent.DOCUMENT_MODE) >= documentMode;\n};\n\n\n/**\n * Deprecated alias to {@code goog.userAgent.isDocumentModeOrHigher}.\n * @param {number} version The version to check.\n * @return {boolean} Whether the IE effective document mode is higher or the\n *      same as the given version.\n * @deprecated Use goog.userAgent.isDocumentModeOrHigher().\n */\ngoog.userAgent.isDocumentMode = goog.userAgent.isDocumentModeOrHigher;\n\n\n/**\n * For IE version < 7, documentMode is undefined, so attempt to use the\n * CSS1Compat property to see if we are in standards mode. If we are in\n * standards mode, treat the browser version as the document mode. Otherwise,\n * IE is emulating version 5.\n * @type {number|undefined}\n * @const\n */\ngoog.userAgent.DOCUMENT_MODE = (function() {\n  var doc = goog.global['document'];\n  var mode = goog.userAgent.getDocumentMode_();\n  if (!doc || !goog.userAgent.IE) {\n    return undefined;\n  }\n  return mode || (doc['compatMode'] == 'CSS1Compat' ?\n                      parseInt(goog.userAgent.VERSION, 10) :\n                      5);\n})();\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* global Blockly, goog */\n\n/**\n * @fileoverview Methods for graphically rendering a block as SVG.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.BlockSvg');\ngoog.require('Blockly.BlockSvgUnused');\n\ngoog.require('goog.userAgent');\n\n/**\n * Constant for identifying rows that are to be rendered inline.\n * Don't collide with Blockly.INPUT_VALUE and friends.\n * @const\n */\nvar INLINE_ROW = -1;\n\n/**\n * Class for a block's SVG representation.\n * @param {!Blockly.Block} block The underlying block object.\n * @constructor\n */\nBlockly.BlockSvg = function(block) {\n\n  this.block_ = block;\n  var options = {\n    \"tabindex\": 0,\n    \"block-id\": block.id\n  };\n  if (block.htmlId) {\n    options.id = block.htmlId;\n  }\n  // Create core elements for the block.\n  this.svgGroup_ = Blockly.createSvgElement('g', options, null);\n\n  this.initChildren();\n\n  /**\n   * Configurable lookup table of input widths\n   * @type {{string, number}}\n   */\n  this.forcedInputWidths = {};\n};\n\nBlockly.BlockSvg.prototype.initChildren = function () {\n  if (Blockly.typeHints) {\n    this.svgTypeHints_ = Blockly.createSvgElement('g', {\n      'class': 'blocklyTypeHint'\n    }, this.svgGroup_);\n    for (var i = 0; i < this.block_.inputList.length; i++) {\n      Blockly.createSvgElement('path', {\n        'filter': 'url(#blocklyTypeHintFilter)'\n      }, this.svgTypeHints_);\n    }\n  }\n  // this.svgPathDark_ = Blockly.createSvgElement('path', {\n  //   'class': 'blocklyPathDark',\n  //   'transform': 'translate(1, 1)',\n  //   'fill-rule': 'evenodd'\n  // }, this.svgGroup_);\n  this.svgPath_ = Blockly.createSvgElement('path', {\n    'class': 'blocklyPath',\n    'fill-rule': 'evenodd'\n  }, this.svgGroup_);\n  var pattern = this.block_.getFillPattern();\n  if (pattern) {\n    this.svgPathFill_ = Blockly.createSvgElement('path', {'class': 'blocklyPath'},\n      this.svgGroup_);\n  }\n  this.svgPathLight_ = Blockly.createSvgElement('path',\n      {'class': 'blocklyPathLight'}, this.svgGroup_);\n  this.svgPath_.tooltip = this.block_;\n  if (!this.block_.blockSpace.blockSpaceEditor.disableTooltip) {\n    Blockly.Tooltip.bindMouseEvents(this.svgPath_);\n  }\n  this.updateMovable();\n};\n\n\nBlockly.BlockSvg.DISABLED_COLOUR = '#808080';\n\n/**\n * Initialize the SVG representation with any block attributes which have\n * already been defined.\n */\nBlockly.BlockSvg.prototype.init = function() {\n  var block = this.block_;\n  this.updateColour();\n  for (var x = 0, input; input = block.inputList[x]; x++) {\n    input.init();\n  }\n  if (block.mutator) {\n    block.mutator.createIcon();\n  }\n};\n\n/**\n * Add or remove the UI indicating if this block is movable or not.\n */\nBlockly.BlockSvg.prototype.updateMovable = function() {\n  if (this.block_.isMovable()) {\n    Blockly.addClass_(this.svgGroup_, 'blocklyDraggable');\n    Blockly.removeClass_(this.svgGroup_, 'blocklyUndraggable');\n  } else {\n    Blockly.removeClass_(this.svgGroup_, 'blocklyDraggable');\n    Blockly.addClass_(this.svgGroup_, 'blocklyUndraggable');\n  }\n  this.updateColour();\n};\n\n/**\n * Add or remove the UI indicating if this block is deletable or not\n * @param {boolean} shouldBeGray\n */\nBlockly.BlockSvg.prototype.grayOut = function(shouldBeGray) {\n  if (shouldBeGray) {\n    Blockly.addClass_(this.svgGroup_, 'blocklyUndeletable');\n    Blockly.removeClass_(this.svgGroup_, 'blocklyDeletable');\n  } else {\n    Blockly.addClass_(this.svgGroup_, 'blocklyDeletable');\n    Blockly.removeClass_(this.svgGroup_, 'blocklyUndeletable');\n  }\n  this.updateColour();\n};\n\n/**\n * Get the root SVG element.\n * @return {!Element} The root SVG element.\n */\nBlockly.BlockSvg.prototype.getRootElement = function() {\n  return this.svgGroup_;\n};\n\n// UI constants for rendering blocks.\n\n// Create shortform that we can use locally for readability, while still having\n// these exposed externally via Blockly.BlockSvg.\nvar BS = Blockly.BlockSvg;\n/**\n * Horizontal space between elements.\n * @const\n */\nBS.SEP_SPACE_X = 10;\n/**\n * Vertical space between elements.\n * @const\n */\nBS.SEP_SPACE_Y = 10;\n/**\n * Vertical padding around inline elements.\n * @const\n */\nBS.INLINE_PADDING_Y = 5;\n/**\n * Minimum height of a block.\n * @const\n */\nBS.MIN_BLOCK_Y = 36;\n/**\n * Height of horizontal puzzle tab.\n * @const\n */\nBS.TAB_HEIGHT = 20;\n/**\n * Width of horizontal puzzle tab.\n * @const\n */\nBS.TAB_WIDTH = 8;\n/**\n * Width of vertical tab (inc left margin).\n * @const\n */\nBS.NOTCH_WIDTH = 30;\n\n/**\n * Rounded corner radius.\n * @const\n */\nBS.CORNER_RADIUS = 5;\n/**\n * Minimum height of title rows.\n * @const\n */\nBS.TITLE_HEIGHT = 23;\n/**\n * Distance from shape edge to intersect with a curved corner at 45 degrees.\n * Applies to highlighting on around the inside of a curve.\n * @const\n */\nBS.DISTANCE_45_INSIDE = (1 - Math.SQRT1_2) * (BS.CORNER_RADIUS - 1) + 1;\n/**\n * Distance from shape edge to intersect with a curved corner at 45 degrees.\n * Applies to highlighting on around the outside of a curve.\n * @const\n */\nBS.DISTANCE_45_OUTSIDE = (1 - Math.SQRT1_2) * (BS.CORNER_RADIUS + 1) - 1;\n\nBS.NOTCH_PATH_WIDTH = 15;\n/**\n * SVG path for drawing jagged teeth at the end of collapsed blocks.\n * @const\n */\nBS.JAGGED_TEETH = 'l 8,0 0,4 8,4 -16,8 8,4';\n/**\n * SVG path for drawing jagged teeth at the end of collapsed blocks.\n * @const\n */\nBS.JAGGED_TEETH_HEIGHT = 20;\n/**\n * SVG path for drawing a horizontal puzzle tab from top to bottom.\n * @const\n */\nBS.TAB_PATH_DOWN = 'v 5 c 0,10 -' + BS.TAB_WIDTH +\n    ',-8 -' + BS.TAB_WIDTH + ',7.5 s ' +\n    BS.TAB_WIDTH + ',-2.5 ' + BS.TAB_WIDTH + ',7.5';\n/**\n * SVG path for drawing a short highlight glint at the bottom of a tab\n * @const\n */\nBS.TAB_PATH_DOWN_HIGHLIGHT =\n  'm -4.2,' + (BS.TAB_HEIGHT - 0.4) + ' ' +\n  'l ' + (BS.TAB_WIDTH * 0.42) + ',-1.8';\n\n/**\n * SVG path for drawing a horizontal puzzle tab from top to bottom with\n * highlighting from the upper-right.\n * @const\n */\nBS.TAB_PATH_DOWN_HIGHLIGHT_RTL = 'v 6.5 m -' +\n    (BS.TAB_WIDTH * 0.98) + ',2.5 q -' +\n    (BS.TAB_WIDTH * .05) + ',10 ' +\n    (BS.TAB_WIDTH * .27) + ',10 m ' +\n    (BS.TAB_WIDTH * .71) + ',-2.5 v 1.5';\n\n/**\n * SVG paths for drawing a horizontal puzzle tab from bottom to top.\n * @const\n */\nBS.TAB_PATH_UP =\n  'V ' + BS.TAB_HEIGHT +\n  'c 0,-10 ' +\n    '-' + BS.TAB_WIDTH + ',8 ' +\n    '-' + BS.TAB_WIDTH + ',-7.5 ' +\n  's ' + BS.TAB_WIDTH + ',2.5 ' +\n    BS.TAB_WIDTH + ',-7.5';\n\nBS.TAB_PATH_UP_HIGHLIGHT =\n  'V ' + (BS.TAB_HEIGHT - 1) + ' ' +\n  'm ' + (BS.TAB_WIDTH * -0.92) + ',-1 ' +\n  'q ' + (BS.TAB_WIDTH * -0.19) + ',-5.5 0,-11 ' +\n  'm ' + (BS.TAB_WIDTH * 0.92) + ',1 ' +\n  'V 1 ' +\n  'H 2';\n\nBS.TAB_PATH_UP_HIGHLIGHT_RTL =\n  'M ' + (BS.TAB_WIDTH * -0.3) + ',8.9 ' +\n  'l ' + (BS.TAB_WIDTH * -0.45) + ',-2.1';\n\n/**\n * SVG paths for drawing a horizontal angle tab from top to bottom\n * @const\n */\nBS.ANGLE_TAB_PATH_DOWN =\n  'v ' + (BS.TAB_HEIGHT / 3) + ' ' +\n  'l ' + (BS.TAB_WIDTH * -1) + ' ' + (BS.TAB_HEIGHT / 3) + ' ' +\n  'l ' + (BS.TAB_WIDTH) + ' ' + (BS.TAB_HEIGHT / 3);\n\nBS.ANGLE_TAB_PATH_DOWN_HIGHLIGHT_RTL =\n  'v 5.5 ' +\n  'm -' + (BS.TAB_WIDTH - 1) + ',' + (BS.TAB_HEIGHT / 3 + 1) + ' ' +\n  'l ' + (BS.TAB_WIDTH - 1) + ',' + (BS.TAB_HEIGHT / 3);\n\n/**\n * SVG paths for drawing a horizontal angle tab from bottom to top\n * @const\n */\nBS.ANGLE_TAB_PATH_UP =\n  'V' + BS.TAB_HEIGHT + ' ' +\n  'L' + (BS.TAB_WIDTH * -1) +', ' + (BS.TAB_HEIGHT * 0.66) + ' ' +\n  'L' + 0 + ', ' + (BS.TAB_HEIGHT * 0.33);\n\nBS.ANGLE_TAB_PATH_UP_HIGHLIGHT =\n  'V ' + (BS.TAB_HEIGHT + 2) + ' ' +\n  'M ' + ((BS.TAB_WIDTH * -1) + 1) + ', ' + (BS.TAB_HEIGHT * 0.66) + ' ' +\n  'L ' + '1, ' + (BS.TAB_HEIGHT * 0.33 + 1) + ' ' +\n  'V ' + 1;\n\n/**\n * SVG paths for drawing a horizontal square tab from top to bottom\n * @const\n */\nBS.SQUARE_TAB_PATH_DOWN =\n  'v 7 ' +\n  'h ' + (BS.TAB_WIDTH * -1) + ' ' +\n  'v 11 ' +\n  'h ' + BS.TAB_WIDTH + ' ' +\n  'v 2';\n\nBS.SQUARE_TAB_PATH_DOWN_HIGHLIGHT =\n  'm 0 18.5 ' +\n  'h ' + (BS.TAB_WIDTH * -0.85);\n\nBS.SQUARE_TAB_PATH_DOWN_HIGHLIGHT_RTL =\n  'v 6 ' +\n  'm ' + (BS.TAB_WIDTH * -1) + ' 1 ' +\n  'v 11 ' +\n  'h ' + BS.TAB_WIDTH + ' ' +\n  'v 2';\n\n/**\n * SVG paths for drawing a horizontal square tab from bottom to top\n * @const\n */\nBS.SQUARE_TAB_PATH_UP =\n  'V 17 ' +\n  'h ' + (BS.TAB_WIDTH * -1) + ' ' +\n  'v -10 ' +\n  'h ' + BS.TAB_WIDTH;\n\nBS.SQUARE_TAB_PATH_UP_HIGHLIGHT =\n  'V 18 ' +\n  'm ' + (BS.TAB_WIDTH * -1) + ' -1.5 ' +\n  'v -9 ' +\n  'h ' + BS.TAB_WIDTH + ' ' +\n  'v -6.5';\n\nBS.SQUARE_TAB_PATH_UP_HIGHLIGHT_RTL =\n  'M -1.5 7.5 ' +\n  'h ' + (BS.TAB_WIDTH * -0.8);\n\n/**\n * SVG paths for drawing a horizontal square tab from top to bottom\n * @const\n */\nBS.ROUNDED_TAB_PATH_DOWN =\n  'v 5.5 ' +\n  'c ' + (BS.TAB_WIDTH * -0.5) + ' 0, ' + (BS.TAB_WIDTH * -1) + ' 2, ' + (BS.TAB_WIDTH * -1) + ' 7 ' +\n  'c 0 5, ' + (BS.TAB_WIDTH * 0.5) + ' 7, ' + BS.TAB_WIDTH + ' 7 ' +\n  'v 0.5';\n\nBS.ROUNDED_TAB_PATH_DOWN_HIGHLIGHT =\n  'm 0 20 ' +\n  'c -2 0, -4 -0.5, -4 -0.5';\n\nBS.ROUNDED_TAB_PATH_DOWN_HIGHLIGHT_RTL =\n  'v 4.5 ' +\n  'm -6 2.5 ' +\n  'c -2 0, -2 5, -2 5.5 ' +\n  'c 0 5, ' + (BS.TAB_WIDTH * 0.5) + ' 7, ' + BS.TAB_WIDTH + ' 7 ' +\n  'v 1';\n\n/**\n * SVG paths for drawing a horizontal square tab from bottom to top\n * @const\n */\nBS.ROUNDED_TAB_PATH_UP =\n  'V 19 ' +\n  'c ' + (BS.TAB_WIDTH * -0.5) + ' 0, ' + (BS.TAB_WIDTH * -1) + ' 0, ' + (BS.TAB_WIDTH * -1) + ' -6 ' +\n  'c 0 -6, ' + (BS.TAB_WIDTH * 0.5) + ' -6, ' + BS.TAB_WIDTH + ' -6 ';\n\nBS.ROUNDED_TAB_PATH_UP_HIGHLIGHT =\n  'V 19.5 ' +\n  'm -6 -2 ' +\n  'c -1 -1, -2 -2, -2 -4.5 ' +\n  'c 0 -6, ' + (BS.TAB_WIDTH * 0.5) + ' -6, ' + BS.TAB_WIDTH + ' -6 ' +\n  'v -6';\n\nBS.ROUNDED_TAB_PATH_UP_HIGHLIGHT_RTL =\n  'M -0.5 7.5 ' +\n  'c -2 0, -4 0.5, -4 0.5';\n\n/**\n * Map of connection tab shapes to the corresponding set of svg paths\n * TAB_PATH_DOWN and TAB_PATH_DOWN_HIGHLIGHT_RTL should have a height of\n *   BS.TAB_HEIGHT (20px), and will be started from top of the row\n * TAB_PATH_DOWN_HIGHLIGHT starts at the top of the row, but can end anywhere\n *\n * TAB_PATH_UP starts from BS.TAB_HEIGHT pixels below the top of the row, and\n *   will be followed by a 'Z' path element to draw a straight line to the top\n *   left of the block\n * TAB_PATH_UP_HIGHLIGHT and TAB_PATH_UP_HIGHLIGHT_RTL start from the bottom\n *   of the row, and can end anywhere\n * @const\n */\nBS.TAB_PATHS_BY_SHAPE = {\n  standard: {\n    TAB_PATH_DOWN: BS.TAB_PATH_DOWN,\n    TAB_PATH_DOWN_HIGHLIGHT: BS.TAB_PATH_DOWN_HIGHLIGHT,\n    TAB_PATH_DOWN_HIGHLIGHT_RTL: BS.TAB_PATH_DOWN_HIGHLIGHT_RTL,\n    TAB_PATH_UP: BS.TAB_PATH_UP,\n    TAB_PATH_UP_HIGHLIGHT: BS.TAB_PATH_UP_HIGHLIGHT,\n    TAB_PATH_UP_HIGHLIGHT_RTL: BS.TAB_PATH_UP_HIGHLIGHT_RTL,\n  },\n  angle: {\n    TAB_PATH_DOWN: BS.ANGLE_TAB_PATH_DOWN,\n    TAB_PATH_DOWN_HIGHLIGHT: '',\n    TAB_PATH_DOWN_HIGHLIGHT_RTL: BS.ANGLE_TAB_PATH_DOWN_HIGHLIGHT_RTL,\n    TAB_PATH_UP: BS.ANGLE_TAB_PATH_UP,\n    TAB_PATH_UP_HIGHLIGHT: BS.ANGLE_TAB_PATH_UP_HIGHLIGHT,\n    TAB_PATH_UP_HIGHLIGHT_RTL: '',\n  },\n  square: {\n    TAB_PATH_DOWN: BS.SQUARE_TAB_PATH_DOWN,\n    TAB_PATH_DOWN_HIGHLIGHT: BS.SQUARE_TAB_PATH_DOWN_HIGHLIGHT,\n    TAB_PATH_DOWN_HIGHLIGHT_RTL: BS.SQUARE_TAB_PATH_DOWN_HIGHLIGHT_RTL,\n    TAB_PATH_UP: BS.SQUARE_TAB_PATH_UP,\n    TAB_PATH_UP_HIGHLIGHT: BS.SQUARE_TAB_PATH_UP_HIGHLIGHT,\n    TAB_PATH_UP_HIGHLIGHT_RTL: BS.SQUARE_TAB_PATH_UP_HIGHLIGHT_RTL,\n  },\n  rounded: {\n    TAB_PATH_DOWN: BS.ROUNDED_TAB_PATH_DOWN,\n    TAB_PATH_DOWN_HIGHLIGHT: BS.ROUNDED_TAB_PATH_DOWN_HIGHLIGHT,\n    TAB_PATH_DOWN_HIGHLIGHT_RTL: BS.ROUNDED_TAB_PATH_DOWN_HIGHLIGHT_RTL,\n    TAB_PATH_UP: BS.ROUNDED_TAB_PATH_UP,\n    TAB_PATH_UP_HIGHLIGHT: BS.ROUNDED_TAB_PATH_UP_HIGHLIGHT,\n    TAB_PATH_UP_HIGHLIGHT_RTL: BS.ROUNDED_TAB_PATH_UP_HIGHLIGHT_RTL,\n  }\n};\n\n/**\n * SVG start point for drawing the top-left corner.\n * @const\n */\nBS.TOP_LEFT_CORNER_START =\n    'm 0,' + BS.CORNER_RADIUS;\n/**\n * SVG start point for drawing the top-left corner's highlight in RTL.\n * @const\n */\nBS.TOP_LEFT_CORNER_START_HIGHLIGHT_RTL =\n    'm ' + BS.DISTANCE_45_INSIDE + ',' +\n    BS.DISTANCE_45_INSIDE;\n/**\n * SVG start point for drawing the top-left corner's highlight in LTR.\n * @const\n */\nBS.TOP_LEFT_CORNER_START_HIGHLIGHT_LTR = 'm 1,' + (BS.CORNER_RADIUS - 1);\n/**\n * SVG path for drawing the rounded top-left corner.\n * @const\n */\nBS.TOP_LEFT_CORNER =\n    'A ' + BS.CORNER_RADIUS + ',' +\n    BS.CORNER_RADIUS + ' 0 0,1 ' +\n    BS.CORNER_RADIUS + ',0';\n/**\n * SVG path for drawing the highlight on the rounded top-left corner.\n * @const\n */\nBS.TOP_LEFT_CORNER_HIGHLIGHT =\n    'A ' + (BS.CORNER_RADIUS - 1) + ',' +\n    (BS.CORNER_RADIUS - 1) + ' 0 0,1 ' +\n    BS.CORNER_RADIUS + ',1';\n/**\n * SVG path for drawing the bottom-left corner of a statement input.\n * Includes the rounded inside corner.\n * @const\n */\nBS.INNER_BOTTOM_LEFT_CORNER =\n    'a ' + BS.CORNER_RADIUS + ',' +\n    BS.CORNER_RADIUS + ' 0 0,0 ' +\n    BS.CORNER_RADIUS + ',' +\n    BS.CORNER_RADIUS;\n/**\n * SVG path for drawing highlight on the top-left corner of a statement\n * input in RTL.\n * @const\n */\nBS.INNER_TOP_LEFT_CORNER_HIGHLIGHT_RTL =\n    'a ' + (BS.CORNER_RADIUS + 1) + ',' +\n    (BS.CORNER_RADIUS + 1) + ' 0 0,0 ' +\n    (-BS.DISTANCE_45_OUTSIDE - 1) + ',' +\n    (BS.CORNER_RADIUS -\n    BS.DISTANCE_45_OUTSIDE);\n/**\n * SVG path for drawing highlight on the bottom-left corner of a statement\n * input in RTL.\n * @const\n */\nBS.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_RTL =\n    'a ' + (BS.CORNER_RADIUS + 1) + ',' +\n    (BS.CORNER_RADIUS + 1) + ' 0 0,0 ' +\n    (BS.CORNER_RADIUS + 1) + ',' +\n    (BS.CORNER_RADIUS + 1);\n/**\n * SVG path for drawing highlight on the bottom-left corner of a statement\n * input in LTR.\n * @const\n */\nBS.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_LTR =\n    'a ' + (BS.CORNER_RADIUS + 1) + ',' +\n    (BS.CORNER_RADIUS + 1) + ' 0 0,0 ' +\n    (BS.CORNER_RADIUS -\n    BS.DISTANCE_45_OUTSIDE) + ',' +\n    (BS.DISTANCE_45_OUTSIDE + 1);\n\n/**\n * Returns the padding of this SVG. Default block SVG has no padding;\n * framed blocks override this method to add padding for the frame\n * @return {Object} object with padding values for top, bottom, left, and right\n */\nBlockly.BlockSvg.prototype.getPadding = function() {\n  if (this.unusedSvg_) {\n    return this.unusedSvg_.getPadding();\n  }\n  return {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0\n  };\n};\n\n/**\n * HACK:\n * WebKit bug 67298 causes control points to be included in the reported\n * bounding box.  Add 5px control point to the top of the path.\n*/\nfunction brokenControlPointWorkaround() {\n  // return Blockly.BROKEN_CONTROL_POINTS ? 'c 0,5 0,-5 0,0' : '';\n  return '';\n}\n\n/**\n * Given a value, returns that value, or the opposite if RTL is true.\n */\nfunction oppositeIfRTL(val) {\n  return Blockly.RTL ? -val : val;\n}\n\n/**\n * Dispose of this SVG block.\n */\nBlockly.BlockSvg.prototype.dispose = function() {\n  goog.dom.removeNode(this.svgGroup_);\n  // Sever JavaScript to DOM connections.\n  this.svgGroup_ = null;\n  this.svgPath_ = null;\n  this.svgPathFill_ = null;\n  this.svgTypeHints_ = null;\n  this.svgPathLight_ = null;\n  // this.svgPathDark_ = null;\n  // dispose of children\n  this.removeUnusedFrame();\n  // Break circular references.\n  this.block_ = null;\n};\n\n/**\n * Play some UI effects (sound, animation) when disposing of a block.\n */\nBlockly.BlockSvg.prototype.disposeUiEffect = function() {\n  Blockly.playAudio('delete');\n\n  var parentSVGElement = this.block_.blockSpace.blockSpaceEditor.svg_;\n  var xy = Blockly.getSvgXY_(this.svgGroup_, parentSVGElement);\n  // Deeply clone the current block.\n  var clone = this.svgGroup_.cloneNode(true);\n  clone.translateX_ = xy.x;\n  clone.translateY_ = xy.y;\n  clone.setAttribute('transform',\n      'translate(' + clone.translateX_ + ',' + clone.translateY_ + ')');\n  parentSVGElement.appendChild(clone);\n  if (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0) {\n      clone.style.display = \"inline\";   /* reqd for IE */\n      clone.bBox_ = {\n          x: clone.getBBox().x,\n          y: clone.getBBox().y,\n          width: clone.scrollWidth,\n          height: clone.scrollHeight\n      };\n  }\n  else {\n      clone.bBox_ = clone.getBBox();\n  }\n  // Start the animation.\n  clone.startDate_ = new Date();\n  Blockly.BlockSvg.disposeUiStep_(clone);\n};\n\n/**\n * Animate a cloned block and eventually dispose of it.\n * @param {!Element} clone SVG element to animate and dispose of.\n * @private\n */\nBlockly.BlockSvg.disposeUiStep_ = function(clone) {\n  var ms = (new Date()) - clone.startDate_;\n  var percent = ms / 150;\n  if (percent > 1) {\n    goog.dom.removeNode(clone);\n  } else {\n    var x = clone.translateX_ + oppositeIfRTL(clone.bBox_.width / 2 * percent);\n    var y = clone.translateY_ + clone.bBox_.height * percent;\n    var translate = x + ', ' + y;\n    var scale = 1 - percent;\n    clone.setAttribute('transform', 'translate(' + translate + ')' +\n        ' scale(' + scale + ')');\n    var closure = function() {\n      Blockly.BlockSvg.disposeUiStep_(clone);\n    };\n    window.setTimeout(closure, 10);\n  }\n};\n\n/**\n * Play some UI effects (sound, ripple) after a connection has been established.\n */\nBlockly.BlockSvg.prototype.connectionUiEffect = function() {\n  Blockly.playAudio('click');\n\n  // Determine the absolute coordinates of the inferior block.\n  var xy = Blockly.getSvgXY_(this.svgGroup_, this.block_.blockSpace.blockSpaceEditor.svg_);\n  // Offset the coordinates based on the two connection types.\n  if (this.block_.outputConnection) {\n    xy.x += oppositeIfRTL(-3);\n    xy.y += 13;\n  } else if (this.block_.previousConnection) {\n    xy.x += oppositeIfRTL(23);\n    xy.y += 3;\n  }\n  var ripple = Blockly.createSvgElement('circle',\n      {'cx': xy.x, 'cy': xy.y, 'r': 0, 'fill': 'none',\n       'stroke': '#888', 'stroke-width': 10},\n      this.block_.blockSpace.blockSpaceEditor.svg_);\n  // Start the animation.\n  ripple.startDate_ = new Date();\n  Blockly.BlockSvg.connectionUiStep_(ripple);\n};\n\n/**\n * Expand a ripple around a connection.\n * @param {!Element} ripple Element to animate.\n * @private\n */\nBlockly.BlockSvg.connectionUiStep_ = function(ripple) {\n  var ms = (new Date()) - ripple.startDate_;\n  var percent = ms / 150;\n  if (percent > 1) {\n    goog.dom.removeNode(ripple);\n  } else {\n    ripple.setAttribute('r', percent * 25);\n    ripple.style.opacity = 1 - percent;\n    var closure = function() {\n      Blockly.BlockSvg.connectionUiStep_(ripple);\n    };\n    window.setTimeout(closure, 10);\n  }\n};\n\n/**\n * Change the display colour of a block. In the case of block.shouldBeGrayedOut\n * this means the block color on the block object and the display color (gray)\n * are potentially out of sync.\n */\nBlockly.BlockSvg.prototype.updateColour = function() {\n  if (this.block_.disabled) {\n    // Disabled blocks don't have colour.\n    return;\n  }\n\n  var hexColour;\n\n  if (this.block_.shouldBeGrayedOut()) {\n    hexColour = BS.DISABLED_COLOUR;\n  } else {\n    hexColour = this.block_.getHexColour();\n  }\n\n  this.updateToColour_(hexColour);\n};\n\n/**\n * @param {string} hexColour the colour to update to, in hexadecimal\n * @private\n */\nBlockly.BlockSvg.prototype.updateToColour_ = function(hexColour) {\n  var rgb = goog.color.hexToRgb(hexColour);\n  var rgbLight = goog.color.lighten(rgb, 0.3);\n  var rgbDark = goog.color.darken(rgb, 0.2);\n  this.svgPathLight_.setAttribute('stroke', goog.color.rgbArrayToHex(rgbDark));\n  // this.svgPathDark_.setAttribute('fill', goog.color.rgbArrayToHex(rgbDark));\n  this.svgPath_.setAttribute('fill', hexColour);\n  var pattern = this.block_.getFillPattern();\n  if (pattern) {\n    this.svgPathFill_.setAttribute('fill', 'url(#' + pattern + ')');\n  }\n};\n\n/**\n * Enable or disable a block.\n */\nBlockly.BlockSvg.prototype.updateDisabled = function() {\n  if (this.block_.disabled || this.block_.getInheritedDisabled()) {\n    Blockly.addClass_(this.svgGroup_, 'blocklyDisabled');\n    this.svgPath_.setAttribute('fill', 'url(#blocklyDisabledPattern)');\n  } else {\n    Blockly.removeClass_(this.svgGroup_, 'blocklyDisabled');\n    this.updateColour();\n  }\n  var children = this.block_.getChildren();\n  for (var x = 0, child; child = children[x]; x++) {\n    child.svg_.updateDisabled();\n  }\n};\n\n/**\n * Update block limit UI\n * @param {number} limit count to display\n */\nBlockly.BlockSvg.prototype.updateLimit = function (limit) {\n  var BUBBLE_SIZE = 18;\n  var HALF_BUBBLE_SIZE = BUBBLE_SIZE / 2;\n\n  if (!this.limitGroup_) {\n    this.limitGroup_ = Blockly.createSvgElement('g', {\n      'class': 'blocklyLimit',\n      y: -3\n    }, this.svgGroup_);\n\n    this.limitRect_ = Blockly.createSvgElement('rect', {\n      height: BUBBLE_SIZE,\n      width: BUBBLE_SIZE,\n      x: -HALF_BUBBLE_SIZE,\n      y: -HALF_BUBBLE_SIZE,\n      rx: HALF_BUBBLE_SIZE,\n      ry: HALF_BUBBLE_SIZE\n    }, this.limitGroup_);\n\n    this.limitText_ = Blockly.createSvgElement('text', {\n      'class': 'blocklyText',\n      'dominant-baseline': 'central',\n      'text-anchor': 'middle'\n    }, this.limitGroup_);\n  }\n\n  if (limit < 0) {\n    this.limitText_.textContent = '!';\n    Blockly.addClass_(this.limitGroup_, 'overLimit');\n  } else {\n    this.limitText_.textContent = limit;\n    Blockly.removeClass_(this.limitGroup_, 'overLimit');\n  }\n\n  var textWidth = this.limitText_.getBBox ? Math.ceil(this.limitText_.getBBox().width) : HALF_BUBBLE_SIZE;\n  var rectWidth = Math.max(textWidth + HALF_BUBBLE_SIZE, BUBBLE_SIZE);\n  this.limitRect_.setAttribute('width', rectWidth);\n  this.limitText_.setAttribute('x', Math.round(rectWidth * 0.5) - HALF_BUBBLE_SIZE);\n\n  // IE Does not support dominant-baseline, so we can't actually vertically\n  // center the text. Instead simply shift it down by one quarter the height of\n  // the bubble, which should be visually quite close if not necessarily exact\n  if (Blockly.isMsie() || Blockly.isTrident()) {\n    this.limitText_.setAttribute('y', BUBBLE_SIZE / 4);\n  }\n\n};\n\n/**\n * Select this block.  Highlight it visually.\n * @param {boolean} moveToTop Move the selected block to the top of the stack.\n */\nBlockly.BlockSvg.prototype.addSelect = function(moveToTop) {\n  Blockly.addClass_(this.svgGroup_, 'blocklySelected');\n  if (moveToTop) {\n    this.svgGroup_.parentNode.appendChild(this.svgGroup_);\n  }\n};\n\n/**\n * Select this block.  Highlight it visually.  Needed for toolbox scenarios\n * because IE will lose mouseout events if addSelect() is called in the hover\n * case.\n */\nBlockly.BlockSvg.prototype.addSelectNoMove = function() {\n  if (Blockly.elementHasClass_(this.svgGroup_, 'blocklyDraggable')) {\n    Blockly.addClass_(this.svgGroup_, 'blocklySelected');\n  }\n};\n\n/**\n * Unselect this block.  Remove its highlighting.\n */\nBlockly.BlockSvg.prototype.removeSelect = function() {\n  Blockly.removeClass_(this.svgGroup_, 'blocklySelected');\n};\n\n/**\n * Adds the dragging class to this block.\n * Also disables the highlights/shadows to improve performance.\n */\nBlockly.BlockSvg.prototype.addDragging = function() {\n  Blockly.addClass_(this.svgGroup_, 'blocklyDragging');\n};\n\n/**\n * Removes the dragging class from this block.\n */\nBlockly.BlockSvg.prototype.removeDragging = function() {\n  Blockly.removeClass_(this.svgGroup_, 'blocklyDragging');\n};\n\n/**\n * Adds the spotlight class to this block.\n */\nBlockly.BlockSvg.prototype.addSpotlight = function() {\n  Blockly.addClass_(this.svgGroup_, 'blocklySpotlight');\n};\n\n/**\n * Removes the spotlight class from this block.\n */\nBlockly.BlockSvg.prototype.removeSpotlight = function() {\n  Blockly.removeClass_(this.svgGroup_, 'blocklySpotlight');\n};\n\n/**\n * Render the block.\n * Lays out and reflows a block based on its contents and settings.\n * @param {boolean} selfOnly - whether to render only this block and NOT also\n * its parents which in turn would trigger a window resize event. Defaults to\n * false.\n */\nBlockly.BlockSvg.prototype.render = function(selfOnly) {\n  this.block_.rendered = true;\n\n  var cursorX = oppositeIfRTL(BS.SEP_SPACE_X);\n  // Move the icons into position.\n  var icons = this.block_.getIcons();\n  for (var x = 0; x < icons.length; x++) {\n    cursorX = icons[x].renderIcon(cursorX);\n  }\n  cursorX -= oppositeIfRTL(BS.SEP_SPACE_X);\n  // If there are no icons, cursorX will be 0, otherwise it will be the\n  // width that the first label needs to move over by.\n\n  var inputRows = this.renderCompute_(cursorX);\n  this.renderDraw_(cursorX, inputRows);\n\n  if (!selfOnly) {\n    // Render all blocks above this one (propagate a reflow).\n    var parentBlock = this.block_.getParent();\n    if (parentBlock) {\n      parentBlock.render();\n    } else {\n      // Top-most block.  Fire an event to allow scrollbars to resize.\n      Blockly.fireUiEvent(window, 'resize');\n    }\n  }\n\n  this.removeUnusedFrame();\n};\n\n/**\n * Render a list of titles starting at the specified location.\n * @param {!Array.<!Blockly.Field>} titleList List of titles.\n * @param {number} x X-coordinate to start the titles.\n * @param {number} y Y-coordinate to start the titles.\n * @return {number} width of the title row\n * @private\n */\nBlockly.BlockSvg.prototype.renderTitles_ = function(titleList, x, y) {\n  var startX = x;\n  for (var t = 0, title; title = titleList[t]; t++) {\n    // Get the dimensions of the title.\n    var titleSize = title.getSize();\n\n    var translateX = x;\n    if (Blockly.RTL) {\n      translateX = -(x + titleSize.width);\n    }\n\n    title.getRootElement().setAttribute('transform', 'translate(' + translateX +\n      ', ' + (y + title.getBufferY()) + ')');\n    if (titleSize.width) {\n      x += titleSize.width + BS.SEP_SPACE_X;\n    }\n  }\n\n  return x - startX;\n};\n\n/**\n * Computes the height and widths for each row and title.\n * @param {number} iconWidth Offset of first row due to icons.\n * @return {!Array.<!Array.<!Object>>} 2D array of objects, each containing\n *     position information.\n * @private\n */\nBlockly.BlockSvg.prototype.renderCompute_ = function(iconWidth) {\n  var inputList = this.block_.inputList;\n  var inputRows = [];\n  inputRows.rightEdge = iconWidth + BS.SEP_SPACE_X * 2;\n  if (this.block_.previousConnection || this.block_.nextConnection) {\n    inputRows.rightEdge = Math.max(inputRows.rightEdge,\n        BS.NOTCH_WIDTH + BS.SEP_SPACE_X);\n  }\n  var titleValueWidth = 0;  // Width of longest external value title.\n  var titleStatementWidth = 0;  // Width of longest statement title.\n  var hasValue = false;\n  var hasStatement = false;\n  var hasDummy = false;\n  var currentRow;\n  for (var i = 0, input; input = inputList[i]; i++) {\n    if (!input.isVisible()) {\n      continue;\n    }\n\n    // Each row will contain one or more inputs. As we parse the inputs, we\n    // either append it to the current row if it's inlined, or create a new row\n    // if it isn't.  See Input.isInline/Input.setInline for further explanation\n    // on how we determine whether an input is inlined.\n    if (i === 0 || !input.isInline()) {\n      // Create new row.\n      currentRow = [];\n      currentRow.type = input.type;\n      currentRow.height = 0;\n      inputRows.push(currentRow);\n    }\n    if (currentRow.length > 0 || input.isInline()) {\n      currentRow.type = INLINE_ROW;\n    }\n    // rows with a single FUNCTIONAL_INPUT should be treated as inlined\n    if (currentRow.length === 0 && input.type === Blockly.FUNCTIONAL_INPUT) {\n      currentRow.type = INLINE_ROW;\n    }\n    currentRow.push(input);\n\n    var renderSize = inputRenderSize(input);\n    input.renderHeight = renderSize.height;\n    input.renderWidth = renderSize.width;\n\n    currentRow.height = Math.max(currentRow.height, input.renderHeight);\n\n    var titleSize = inputTitleRenderSize(input, i === 0 ? iconWidth : 0);\n    input.titleWidth = titleSize.width;\n    currentRow.height = Math.max(currentRow.height, titleSize.height);\n\n    if (currentRow.type != INLINE_ROW) {\n      if (currentRow.type == Blockly.NEXT_STATEMENT) {\n        hasStatement = true;\n        titleStatementWidth = Math.max(titleStatementWidth, input.titleWidth);\n      } else {\n        if (currentRow.type === Blockly.INPUT_VALUE ||\n            currentRow.type === Blockly.FUNCTIONAL_INPUT) {\n          hasValue = true;\n        } else if (currentRow.type === Blockly.DUMMY_INPUT) {\n          hasDummy = true;\n        }\n        titleValueWidth = Math.max(titleValueWidth, input.titleWidth);\n      }\n    }\n  }\n\n  thickenInlineRows(inputRows);\n\n  // Compute the statement edge.\n  // This is the width of a block where statements are nested.\n  inputRows.statementEdge = 2 * BS.SEP_SPACE_X + titleStatementWidth;\n  // Compute the preferred right edge.  Inline blocks may extend beyond.\n  // This is the width of the block where external inputs connect.\n  if (hasStatement) {\n    inputRows.rightEdge = Math.max(inputRows.rightEdge,\n        inputRows.statementEdge + BS.NOTCH_WIDTH);\n  }\n  if (hasValue) {\n    inputRows.rightEdge = Math.max(inputRows.rightEdge, titleValueWidth +\n        BS.SEP_SPACE_X * 2 + BS.TAB_WIDTH);\n  } else if (hasDummy) {\n    inputRows.rightEdge = Math.max(inputRows.rightEdge, titleValueWidth +\n        BS.SEP_SPACE_X * 2);\n  }\n\n  inputRows.hasValue = hasValue;\n  inputRows.hasStatement = hasStatement;\n  inputRows.hasDummy = hasDummy;\n\n  // rightEdgeWithoutInline is used to know how deep to draw our next statement\n  // inputs\n  inputRows.rightEdgeWithoutInline = inputRows.rightEdge;\n\n  // see if our inline rows push out our right edge\n  for (i = 0; currentRow = inputRows[i]; i++) {\n    if (currentRow.type === INLINE_ROW) {\n      inputRows.rightEdge = Math.max(inputRows.rightEdge,\n        this.widthInlineRow(currentRow));\n    }\n  }\n\n  return inputRows;\n};\n\n/**\n * Make inline rows a bit thicker in order to enclose the values. Note: has\n * side effects\n */\nfunction thickenInlineRows (inputRows) {\n  var row;\n  for (var y = 0; row = inputRows[y]; y++) {\n    row.thicker = false;\n    if (row.type === INLINE_ROW) {\n      for (var z = 0, input; input = row[z]; z++) {\n        if (input.type === Blockly.INPUT_VALUE ||\n          input.type === Blockly.FUNCTIONAL_INPUT) {\n          row.height += 2 * BS.INLINE_PADDING_Y;\n          row.thicker = true;\n          break;\n        }\n      }\n    }\n  }\n}\n\n/**\n * Calculate the render width and height of a given input\n * @param {Blockly.Input} input given input\n */\nfunction inputRenderSize(input) {\n  // Compute minimum input size.\n  var renderHeight = BS.MIN_BLOCK_Y;\n  var renderWidth = BS.TAB_WIDTH + BS.SEP_SPACE_X + BS.CORNER_RADIUS;\n  if (input.type === Blockly.FUNCTIONAL_INPUT) {\n    renderWidth = BS.NOTCH_WIDTH + BS.SEP_SPACE_X;\n  }\n\n  // Expand input size if there is a connection.\n  if (input.connection && input.connection.targetConnection) {\n    var linkedBlock = input.connection.targetBlock();\n    var bBox = linkedBlock.getHeightWidth();\n    renderHeight = Math.max(renderHeight, bBox.height);\n    renderWidth = Math.max(renderWidth, bBox.width);\n    renderHeight += input.getStatementTrailingSpace();\n  }\n\n  return {\n    width: renderWidth,\n    height: renderHeight\n  };\n}\n\n/**\n * Given an input, calculates the render width/height of the title(s).\n */\nfunction inputTitleRenderSize (input, iconWidth) {\n  var width = oppositeIfRTL(iconWidth);\n  var height = 0;\n  var titleSize;\n\n  for (var j = 0, title; title = input.titleRow[j]; j++) {\n    // Get the dimensions of the title.\n    titleSize = title.getSize();\n    if (titleSize.width) {\n      width += titleSize.width + (j > 0 ? BS.SEP_SPACE_X : 0);\n    }\n    height = Math.max(height, titleSize.height);\n  }\n\n  return {\n    width: width,\n    height: height\n  };\n}\n\n/**\n * Given a row, calculates the width, including padding, from the set of inputs\n */\nBlockly.BlockSvg.prototype.widthInlineRow = function (row) {\n  var width = BS.SEP_SPACE_X;\n  for (var i = 0, input; input = row[i]; i++) {\n    width += BS.SEP_SPACE_X + this.inputWidthToOccupy_(input);\n  }\n\n  return width;\n};\n\n/**\n * Draw the path of the block.\n * Move the titles to the correct locations.\n * @param {number} iconWidth Offset of first row due to icons.\n * @param {!Array.<!Array.<!Object>>} inputRows 2D array of objects, each\n *     containing position information.\n * @private\n */\nBlockly.BlockSvg.prototype.renderDraw_ = function(iconWidth, inputRows) {\n  // Should the top and bottom left corners be rounded or square?\n  if (this.block_.outputConnection) {\n    this.squareTopLeftCorner_ = true;\n    this.squareBottomLeftCorner_ = true;\n  } else {\n    this.squareTopLeftCorner_ = false;\n    this.squareBottomLeftCorner_ = false;\n    // If this block is in the middle of a stack, square the corners.\n    if (this.block_.previousConnection) {\n      var prevBlock = this.block_.previousConnection.targetBlock();\n      if (prevBlock && prevBlock.nextConnection &&\n          prevBlock.nextConnection.targetConnection ==\n          this.block_.previousConnection) {\n        this.squareTopLeftCorner_ = true;\n       }\n    }\n    if (this.block_.nextConnection) {\n      var nextBlock = this.block_.nextConnection.targetBlock();\n      if (nextBlock && nextBlock.previousConnection &&\n          nextBlock.previousConnection.targetConnection ==\n          this.block_.nextConnection) {\n        this.squareBottomLeftCorner_ = true;\n      }\n    }\n  }\n\n  if (this.block_.previousConnection &&\n      this.block_.previousConnection.type === Blockly.FUNCTIONAL_OUTPUT) {\n    this.squareTopLeftCorner_ = true;\n    this.squareBottomLeftCorner_ = true;\n  }\n\n  for (var i = 0; i < this.block_.inputList.length; i++) {\n    if (this.block_.inputList[i].type === Blockly.FUNCTIONAL_INPUT) {\n      // todo (brent) - do we actually want these to be square\n      this.squareTopLeftCorner_ = true;\n      this.squareBottomLeftCorner_ = true;\n    }\n  }\n\n  // Fetch the block's coordinates on the surface for use in anchoring\n  // the connections.\n  var connectionsXY = this.block_.getRelativeToSurfaceXY();\n\n  // Assemble the block's path.\n  var renderInfo = {\n    core: [],\n    inline: [],\n    // The highlighting applies to edges facing the upper-left corner.\n    // Since highlighting is a two-pixel wide border, it would normally overhang\n    // the edge of the block by a pixel. So undersize all measurements by a pixel.\n    highlight: [],\n    highlightInline: [],\n    // current x/y location\n    curX: iconWidth,\n    curY: 0\n  };\n\n  this.renderDrawTop_(renderInfo, inputRows.rightEdge, connectionsXY);\n  this.renderDrawRight_(renderInfo, connectionsXY, inputRows, iconWidth);\n  this.renderDrawBottom_(renderInfo, connectionsXY);\n  this.renderDrawLeft_(renderInfo);\n\n  var pathString = renderInfo.core.join(' ') + '\\n' + renderInfo.inline.join(' ');\n  this.svgPath_.setAttribute('d', pathString);\n  if (this.svgPathFill_) {\n    this.svgPathFill_.setAttribute('d', pathString);\n  }\n  if (this.svgTypeHints_) {\n    var g = this.svgTypeHints_;\n    var max = Math.max(this.block_.inputList.length, g.childNodes.length);\n    for (var j = 0; j < max; j++) {\n      var element = g.childNodes[j] || Blockly.createSvgElement('path', {\n        'filter': 'url(#blocklyTypeHintFilter)'\n      }, g);\n      var input = this.block_.inputList[j];\n      if (!input || !input.connection) {\n        element.setAttribute('d', '');\n        continue;\n      }\n\n      var pathInfo = input.connection.getPathInfo();\n      if (pathInfo && pathInfo.color) {\n        element.setAttribute('d', pathInfo.steps);\n        element.setAttribute('transform',\n          pathInfo.transform);\n        element.setAttribute('stroke',\n          Blockly.makeColour.apply(null, pathInfo.color));\n      } else {\n        element.setAttribute('d', '');\n      }\n    }\n  }\n  //this.svgPathDark_.setAttribute('d', pathString);\n  //pathString = renderInfo.highlight.join(' ') + '\\n' + renderInfo.highlightInline.join(' ');\n  this.svgPathLight_.setAttribute('d', pathString);\n  if (Blockly.RTL) {\n    // Mirror the block's path.\n    this.svgPath_.setAttribute('transform', 'scale(-1 1)');\n    this.svgPathLight_.setAttribute('transform', 'scale(-1 1)');\n    // this.svgPathDark_.setAttribute('transform', 'translate(1,1) scale(-1 1)');\n  }\n};\n\n/**\n * Render the top edge of the block. Side effect: moves connections to their\n *     new locations.\n * @param {!Object} renderInfo Current state of our paths\n * @param {number} rightEdge Minimum width of block.\n * @param {!Object} connectionsXY Location of block.\n * @private\n */\nBlockly.BlockSvg.prototype.renderDrawTop_ = function(renderInfo, rightEdge,\n    connectionsXY) {\n  // Position the cursor at the top-left starting point.\n  if (this.squareTopLeftCorner_) {\n    renderInfo.core.push('m 0,0');\n    renderInfo.highlight.push('m 1,1');\n  } else {\n    renderInfo.core.push(BS.TOP_LEFT_CORNER_START);\n    renderInfo.highlight.push(Blockly.RTL ?\n        BS.TOP_LEFT_CORNER_START_HIGHLIGHT_RTL :\n        BS.TOP_LEFT_CORNER_START_HIGHLIGHT_LTR);\n    // Top-left rounded corner.\n    renderInfo.core.push(BS.TOP_LEFT_CORNER);\n    renderInfo.highlight.push(BS.TOP_LEFT_CORNER_HIGHLIGHT);\n  }\n\n  renderInfo.core.push(brokenControlPointWorkaround());\n\n  // Top edge.\n  if (this.block_.previousConnection) {\n    var notchPaths = this.block_.previousConnection.getNotchPaths();\n\n    renderInfo.core.push('H', BS.NOTCH_WIDTH - BS.NOTCH_PATH_WIDTH);\n    renderInfo.highlight.push('H', BS.NOTCH_WIDTH - BS.NOTCH_PATH_WIDTH);\n    renderInfo.core.push(notchPaths.left);\n    renderInfo.highlight.push(notchPaths.leftHighlight);\n    // Create previous block connection.\n    var connectionX = connectionsXY.x + oppositeIfRTL(BS.NOTCH_WIDTH);\n    var connectionY = connectionsXY.y;\n    this.block_.previousConnection.moveTo(connectionX, connectionY);\n    // This connection will be tightened when the parent renders.\n  }\n  renderInfo.core.push('H', rightEdge);\n  renderInfo.highlight.push('H', rightEdge + (Blockly.RTL ? -1 : 0));\n\n  renderInfo.curX = rightEdge;\n};\n\n/**\n * Render the right edge of the block. Side effect: moves connections to their\n *     new locations.\n * @param {!Object} renderInfo Current state of our paths\n * @param {!Object} connectionsXY Location of block.\n * @param {!Array.<!Array.<!Object>>} inputRows 2D array of objects, each\n *     containing position information.\n * @param {number} iconWidth Offset of first row due to icons.\n * @return {number} Height of block.\n * @private\n */\nBlockly.BlockSvg.prototype.renderDrawRight_ = function(renderInfo, connectionsXY,\n    inputRows, iconWidth) {\n  for (var i = 0, row; row = inputRows[i]; i++) {\n    renderInfo.curX = BS.SEP_SPACE_X;\n    if (i === 0) {\n      renderInfo.curX += oppositeIfRTL(iconWidth);\n    }\n    renderInfo.highlight.push('M', (inputRows.rightEdge - 1) + ',' + (renderInfo.curY + 1));\n    if (this.block_.isCollapsed()) {\n      this.renderDrawRightCollapsed_(renderInfo ,row);\n    } else if (row.type === INLINE_ROW) {\n      this.renderDrawRightInline_(renderInfo, inputRows, i, connectionsXY);\n    } else if (row.type === Blockly.INPUT_VALUE) {\n      this.renderDrawRightInputValue_(renderInfo, inputRows, i, connectionsXY);\n    } else if (row.type === Blockly.DUMMY_INPUT) {\n      this.renderDrawRightDummyInput_(renderInfo, inputRows, i);\n    } else if (row.type === Blockly.NEXT_STATEMENT) {\n      this.renderDrawRightNextStatement_(renderInfo, inputRows, i, connectionsXY);\n    }\n    renderInfo.curY += row.height;\n  }\n  if (!inputRows.length) {\n    renderInfo.curY = BS.MIN_BLOCK_Y;\n    renderInfo.core.push('V', renderInfo.curY);\n    if (Blockly.RTL) {\n      renderInfo.highlight.push('V', renderInfo.curY - 1);\n    }\n  }\n};\n\nBlockly.BlockSvg.prototype.renderDrawRightCollapsed_ = function (renderInfo, row) {\n  // Jagged right edge.\n  var input = row[0];\n  var titleX = renderInfo.curX;\n  var titleY = renderInfo.curY + BS.TITLE_HEIGHT;\n  renderInfo.curX += this.renderTitles_(input.titleRow, titleX, titleY);\n  renderInfo.core.push(BS.JAGGED_TEETH);\n  if (Blockly.RTL) {\n    renderInfo.highlight.push('l 8,0 0,3.8 7,3.2 m -14.5,9 l 8,4');\n  } else {\n    renderInfo.highlight.push('h 8');\n  }\n  var remainder = row.height - BS.JAGGED_TEETH_HEIGHT;\n  renderInfo.core.push('v', remainder);\n  if (Blockly.RTL) {\n    renderInfo.highlight.push('v', remainder - 2);\n  }\n};\n\nBlockly.BlockSvg.prototype.renderDrawRightInputValue_ = function (renderInfo,\n  inputRows, rowIndex, connectionsXY) {\n  var connectionX, connectionY;\n  // External input.\n  var connectionX, connectionY;\n  var row = inputRows[rowIndex];\n  var input = row[0];\n  var titleX = renderInfo.curX;\n  var titleY = renderInfo.curY + BS.TITLE_HEIGHT;\n  if (input.align != Blockly.ALIGN_LEFT) {\n    var titleRightX = inputRows.rightEdge - input.titleWidth - BS.TAB_WIDTH -\n      2 * BS.SEP_SPACE_X;\n    if (input.align === Blockly.ALIGN_RIGHT) {\n      titleX += titleRightX;\n    } else if (input.align === Blockly.ALIGN_CENTRE) {\n      titleX += (titleRightX + titleX) / 2;\n    }\n  }\n  renderInfo.curX += this.renderTitles_(input.titleRow, titleX, titleY);\n  renderInfo.core.push(BS.TAB_PATH_DOWN);\n  renderInfo.core.push('v', row.height - BS.TAB_HEIGHT);\n  if (Blockly.RTL) {\n    // Highlight around back of tab.\n    renderInfo.highlight.push(BS.TAB_PATH_DOWN_HIGHLIGHT_RTL);\n    renderInfo.highlight.push('v', row.height - BS.TAB_HEIGHT);\n  } else {\n    // Short highlight glint at bottom of tab.\n    renderInfo.highlight.push('M', (inputRows.rightEdge - 4.2) + ',' +\n      (renderInfo.curY + BS.TAB_HEIGHT - 0.4));\n    renderInfo.highlight.push('l', (BS.TAB_WIDTH * 0.42) + ',-1.8');\n  }\n  // Create external input connection.\n  connectionX = connectionsXY.x + oppositeIfRTL(inputRows.rightEdge + 1);\n  connectionY = connectionsXY.y + renderInfo.curY;\n  input.connection.moveTo(connectionX, connectionY);\n  if (input.connection.targetConnection) {\n    input.connection.tighten_();\n  }\n};\n\nBlockly.BlockSvg.prototype.renderDrawRightDummyInput_ = function (renderInfo,\n  inputRows, rowIndex) {\n  // External naked title.\n  var row = inputRows[rowIndex];\n  var input = row[0];\n  var titleX = renderInfo.curX;\n  var titleY = renderInfo.curY + BS.TITLE_HEIGHT;\n  if (input.align === Blockly.ALIGN_RIGHT) {\n    var titleRightX = inputRows.rightEdge - input.titleWidth -\n      2 * BS.SEP_SPACE_X;\n    if (inputRows.hasValue) {\n      titleRightX -= BS.TAB_WIDTH;\n    }\n    titleX += titleRightX;\n  }\n\n  if (input.align === Blockly.ALIGN_CENTRE) {\n    titleX = (inputRows.rightEdge - input.titleWidth) / 2;\n  }\n\n  this.renderTitles_(input.titleRow, titleX, titleY);\n  renderInfo.core.push('a', BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS + \" 0 0 1 \" + BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS);\n  renderInfo.core.push(\"v\", row.height - BS.CORNER_RADIUS * 2);\n  renderInfo.core.push('a', BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS + \" 0 0 1 -\" + BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS);\n  // renderInfo.core.push('a', row.height/2 + \" \" +row.height/2 + \" 0 0 1 0 \" + row.height);\n  if (Blockly.RTL) {\n    // renderInfo.highlight.push('a', row.height/2 + \" \" + row.height/2 + \" 0 0 1 0 \" + row.height);\n    renderInfo.core.push('a', BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS + \" 0 0 1 \" + BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS);\n    renderInfo.core.push(\"v\", row.height - BS.CORNER_RADIUS * 2);\n    renderInfo.core.push('a', BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS + \" 0 0 1 -\" + BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS);\n  }\n};\n\nBlockly.BlockSvg.prototype.renderDrawRightNextStatement_ = function(renderInfo,\n  inputRows, rowIndex, connectionsXY) {\n  var connectionX, connectionY;\n  // Nested statement.\n  var connectionX, connectionY;\n  var row = inputRows[rowIndex];\n  var input = row[0];\n  if (rowIndex === 0) {\n    // If the first input is a statement stack, add a small row on top.\n    renderInfo.core.push('v', BS.SEP_SPACE_Y);\n    if (Blockly.RTL) {\n      renderInfo.highlight.push('v', BS.SEP_SPACE_Y - 1);\n    }\n    renderInfo.curY += BS.SEP_SPACE_Y;\n  }\n  var titleX = renderInfo.curX;\n  var titleY = renderInfo.curY + BS.TITLE_HEIGHT;\n  if (input.align != Blockly.ALIGN_LEFT) {\n    var titleRightX = inputRows.statementEdge - input.titleWidth -\n      2 * BS.SEP_SPACE_X;\n    if (input.align == Blockly.ALIGN_RIGHT) {\n      titleX += titleRightX;\n    } else if (input.align == Blockly.ALIGN_CENTRE) {\n      titleX += (titleRightX + titleX) / 2;\n    }\n  }\n  var notchPaths = input.connection.getNotchPaths();\n  this.renderTitles_(input.titleRow, titleX, titleY);\n  renderInfo.curX = inputRows.statementEdge + BS.NOTCH_WIDTH;\n  renderInfo.core.push('H', renderInfo.curX);\n  renderInfo.core.push(this.innerTopLeftCorner(notchPaths.right));\n  renderInfo.core.push('v', row.height - 2 * BS.CORNER_RADIUS);\n  renderInfo.core.push(BS.INNER_BOTTOM_LEFT_CORNER);\n  renderInfo.core.push('H', inputRows.rightEdgeWithoutInline);\n  if (Blockly.RTL) {\n    renderInfo.highlight.push('M',\n      (renderInfo.curX - BS.NOTCH_WIDTH + BS.DISTANCE_45_OUTSIDE) +\n      ',' + (renderInfo.curY + BS.DISTANCE_45_OUTSIDE));\n    renderInfo.highlight.push(BS.INNER_TOP_LEFT_CORNER_HIGHLIGHT_RTL);\n    renderInfo.highlight.push('v',row.height - 2 * BS.CORNER_RADIUS);\n    renderInfo.highlight.push(BS.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_RTL);\n    renderInfo.highlight.push('H', inputRows.rightEdgeWithoutInline - 1);\n  } else {\n    renderInfo.highlight.push('M',\n      (renderInfo.curX - BS.NOTCH_WIDTH + BS.DISTANCE_45_OUTSIDE) + ',' +\n      (renderInfo.curY + row.height - BS.DISTANCE_45_OUTSIDE));\n    renderInfo.highlight.push(BS.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_LTR);\n    renderInfo.highlight.push('H', inputRows.rightEdgeWithoutInline);\n  }\n  // Create statement connection.\n  connectionX = connectionsXY.x + oppositeIfRTL(renderInfo.curX);\n  connectionY = connectionsXY.y + renderInfo.curY + 1;\n  input.connection.moveTo(connectionX, connectionY);\n  if (input.connection.targetConnection) {\n    input.connection.tighten_();\n  }\n  if (rowIndex === inputRows.length - 1 ||\n      inputRows[rowIndex + 1].type === Blockly.NEXT_STATEMENT) {\n    // If the final input is a statement stack, add a small row underneath.\n    // Consecutive statement stacks are also separated by a small divider.\n    renderInfo.core.push('v', BS.SEP_SPACE_Y);\n    if (Blockly.RTL) {\n      renderInfo.highlight.push('v', BS.SEP_SPACE_Y - 1);\n    }\n    renderInfo.curY += BS.SEP_SPACE_Y;\n  }\n};\n\nBlockly.BlockSvg.prototype.renderDrawRightInline_ = function (renderInfo, inputRows,\n  rowIndex, connectionsXY) {\n  var connectionX, connectionY;\n  // Inline inputs.\n  var row = inputRows[rowIndex];\n  var hasFunctionalInput = false;\n\n  // Align everything according to the align of the first input. Right now only\n  // left and center work\n  var align = row[0].align;\n\n  // If the first input is functional, assume all inputs are functional. Figure\n  // out how much space they will take up, so that we can center the set of them.\n  if (row[0].type === Blockly.FUNCTIONAL_INPUT) {\n    var widths = BS.SEP_SPACE_X * (row.length - 1);\n    row.forEach(function (input) {\n      widths += this.inputWidthToOccupy_(input);\n    }, this);\n    if (inputRows.rightEdge > widths && align === Blockly.ALIGN_CENTRE) {\n      renderInfo.curX = (inputRows.rightEdge - widths) / 2;\n    }\n  }\n\n  for (var x = 0, input; input = row[x]; x++) {\n    var titleX = renderInfo.curX;\n    var titleY = renderInfo.curY + BS.TITLE_HEIGHT;\n    if (row.thicker) {\n      // Lower the title slightly.\n      titleY += BS.INLINE_PADDING_Y;\n    }\n\n    renderInfo.curX += this.renderTitles_(input.titleRow, titleX, titleY);\n\n    if (input.type === Blockly.INPUT_VALUE) {\n      renderInfo.curX += input.renderWidth + BS.SEP_SPACE_X * 2;\n      renderInfo.inline.push(\"M\", renderInfo.curX - BS.SEP_SPACE_X * 1 - BS.TAB_WIDTH - BS.CORNER_RADIUS  + \",\" + (renderInfo.curY + BS.INLINE_PADDING_Y));\n      renderInfo.inline.push(\"h\", 0 - input.renderWidth + BS.TAB_WIDTH + BS.CORNER_RADIUS);\n      renderInfo.inline.push(BS.TAB_PATH_DOWN);\n      renderInfo.inline.push(\"v\", input.renderHeight - BS.TAB_HEIGHT);\n      renderInfo.inline.push(\"h\", input.renderWidth - BS.TAB_WIDTH - BS.CORNER_RADIUS);\n      renderInfo.inline.push(\"a\", BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS + \" 0 0 0 \" + BS.CORNER_RADIUS + \" -\" + BS.CORNER_RADIUS);\n      renderInfo.inline.push(\"v\", -(input.renderHeight - BS.CORNER_RADIUS * 2));\n      renderInfo.inline.push(\"a\", BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS + \" 0 0 0 -\" + BS.CORNER_RADIUS + \" -\" + BS.CORNER_RADIUS);\n      renderInfo.inline.push(\"z\");\n      if (Blockly.RTL) {\n        // Highlight right edge, around back of tab, and bottom.\n        renderInfo.highlightInline.push('M',\n          (renderInfo.curX - BS.SEP_SPACE_X +\n           BS.TAB_WIDTH - input.renderWidth - 1) + ',' +\n          (renderInfo.curY + BS.INLINE_PADDING_Y + 1));\n        renderInfo.highlightInline.push(BS.TAB_PATH_DOWN_HIGHLIGHT_RTL);\n        renderInfo.highlightInline.push('v', input.renderHeight - BS.TAB_HEIGHT + 2);\n        renderInfo.highlightInline.push('h', input.renderWidth - BS.TAB_WIDTH);\n      } else {\n        // Highlight right edge, bottom, and glint at bottom of tab.\n        renderInfo.highlightInline.push('M',\n            (renderInfo.curX - BS.SEP_SPACE_X + 1) + ',' +\n            (renderInfo.curY + BS.INLINE_PADDING_Y + 1));\n        // renderInfo.highlightInline.push('a', input.renderHeight/2 + \" \" + input.renderHeight/2 + \" 0 0 1 0 \" + input.renderHeight);\n        renderInfo.highlightInline.push('a', BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS + \" 0 0 0 \" + BS.CORNER_RADIUS + \" -\" + BS.CORNER_RADIUS);\n        renderInfo.highlightInline.push(\"v\", -(input.renderHeight - BS.CORNER_RADIUS * 2));\n        renderInfo.highlightInline.push('a', BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS + \" 0 0 0 -\" + BS.CORNER_RADIUS + \" -\" + BS.CORNER_RADIUS);\n        renderInfo.highlightInline.push('h', BS.TAB_WIDTH - input.renderWidth);\n        renderInfo.highlightInline.push('M',\n          (renderInfo.curX - input.renderWidth - BS.SEP_SPACE_X +\n           3.8) + ',' + (renderInfo.curY + BS.INLINE_PADDING_Y +\n           BS.TAB_HEIGHT - 0.4));\n        renderInfo.highlightInline.push('l', (BS.TAB_WIDTH * 0.42) + ',-1.8');\n      }\n      // Create inline input connection.\n      var connectionX = connectionsXY.x + oppositeIfRTL(renderInfo.curX  - BS.SEP_SPACE_X - input.renderWidth + 1);\n\n      var connectionY = connectionsXY.y + renderInfo.curY + BS.INLINE_PADDING_Y;\n      input.connection.moveTo(connectionX, connectionY);\n      if (input.connection.targetConnection) {\n        input.connection.tighten_();\n      }\n    } else if (input.type === Blockly.FUNCTIONAL_INPUT) {\n      hasFunctionalInput = true;\n\n      this.renderDrawRightInlineFunctional_(renderInfo, input, connectionsXY);\n\n    } else if (input.type != Blockly.DUMMY_INPUT) {\n      renderInfo.curX += input.renderWidth + BS.SEP_SPACE_X;\n    }\n  }\n\n  renderInfo.curX = Math.max(renderInfo.curX, inputRows.rightEdge);\n  renderInfo.core.push('H', renderInfo.curX);\n  if (!hasFunctionalInput) {\n    // this ends up just showing a little divot if we do this with our inline\n    // functional inputs\n    renderInfo.highlight.push('H', renderInfo.curX + (Blockly.RTL ? -1 : 0));\n  }\n  // renderInfo.core.push(\"a\", row.height/2 + \" \" + row.height/2 + \" 0 0 1 0 \" + row.height);\n  renderInfo.core.push('a', BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS + \" 0 0 1 \" + BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS);\n  renderInfo.core.push(\"v\", row.height - BS.CORNER_RADIUS * 2);\n  renderInfo.core.push('a', BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS + \" 0 0 1 -\" + BS.CORNER_RADIUS + \" \" + BS.CORNER_RADIUS);\n  if (Blockly.RTL) {\n    renderInfo.highlight.push('v', row.height - 2);\n  }\n};\n\n/**\n * Given an input, returns the amount of space it should occupy\n * @param {Blockly.Input} input\n * @returns {number}\n */\nBlockly.BlockSvg.prototype.inputWidthToOccupy_ = function (input) {\n  return input.renderWidth + (input.extraSpace || 0);\n};\n\n/**\n * Render a function input that is inlined\n * @param {!Object} renderInfo Current state of our paths\n * @param {!Object} input The input to render\n * @param {!Object} connectionsXY Location of block.\n * @private\n */\nBlockly.BlockSvg.prototype.renderDrawRightInlineFunctional_ = function(renderInfo,\n    input, connectionsXY) {\n  // Overriden by BlockSvgFunctional\n  throw \"Only supported for functional blocks\";\n};\n\n/**\n * Render the bottom edge of the block.\n * @param {!Object} renderInfo Current state of our paths\n * @param {!Object} connectionsXY Location of block.\n * @private\n */\nBlockly.BlockSvg.prototype.renderDrawBottom_ = function(renderInfo, connectionsXY) {\n  renderInfo.core.push(brokenControlPointWorkaround());\n\n  if (this.block_.nextConnection) {\n    var notchPaths = this.block_.nextConnection.getNotchPaths();\n    renderInfo.core.push('H', BS.NOTCH_WIDTH + ' ' + notchPaths.right);\n    // Create next block connection.\n    var connectionX = connectionsXY.x + oppositeIfRTL(BS.NOTCH_WIDTH);\n    var connectionY = connectionsXY.y + renderInfo.curY + 1;\n    this.block_.nextConnection.moveTo(connectionX, connectionY);\n    if (this.block_.nextConnection.targetConnection) {\n      this.block_.nextConnection.tighten_();\n    }\n  }\n\n  // Should the bottom-left corner be rounded or square?\n  if (this.squareBottomLeftCorner_) {\n    renderInfo.core.push('H 0');\n    if (!Blockly.RTL) {\n      renderInfo.highlight.push('M', '1,' + renderInfo.curY);\n    }\n  } else {\n    renderInfo.core.push('H', BS.CORNER_RADIUS);\n    renderInfo.core.push('a', BS.CORNER_RADIUS + ',' + BS.CORNER_RADIUS + ' 0 0,1 -' +\n      BS.CORNER_RADIUS + ',-' + BS.CORNER_RADIUS);\n    if (!Blockly.RTL) {\n      renderInfo.highlight.push('M', BS.DISTANCE_45_INSIDE + ',' +\n        (renderInfo.curY - BS.DISTANCE_45_INSIDE));\n      renderInfo.highlight.push('A', (BS.CORNER_RADIUS - 1) + ',' +\n        (BS.CORNER_RADIUS - 1) + ' 0 0,1 ' +\n        '1,' + (renderInfo.curY - BS.CORNER_RADIUS));\n    }\n  }\n};\n\n/**\n * Render the left edge of the block.\n * @param {!Object} renderInfo Current state of our paths\n * @private\n */\nBlockly.BlockSvg.prototype.renderDrawLeft_ = function(renderInfo) {\n  if (this.block_.outputConnection) {\n    renderInfo.core.push('V', BS.TAB_HEIGHT);\n    renderInfo.core.push('c 0,-10 -' + BS.TAB_WIDTH + ',8 -' +\n        BS.TAB_WIDTH + ',-7.5 s ' + BS.TAB_WIDTH +\n        ',2.5 ' + BS.TAB_WIDTH + ',-7.5');\n    if (Blockly.RTL) {\n      renderInfo.highlight.push('M', (BS.TAB_WIDTH * -0.3) + ',8.9');\n      renderInfo.highlight.push('l', (BS.TAB_WIDTH * -0.45) + ',-2.1');\n    } else {\n      renderInfo.highlight.push('V', BS.TAB_HEIGHT - 1);\n      renderInfo.highlight.push('m', (BS.TAB_WIDTH * -0.92) +\n                          ',-1 q ' + (BS.TAB_WIDTH * -0.19) +\n                          ',-5.5 0,-11');\n      renderInfo.highlight.push('m', (BS.TAB_WIDTH * 0.92) +\n                          ',1 V 1 H 2');\n    }\n  } else if (!Blockly.RTL) {\n    renderInfo.highlight.push('V', this.squareTopLeftCorner_ ? 1 : BS.CORNER_RADIUS);\n  }\n  renderInfo.core.push('z');\n};\n\n/**\n  * Set the blocks visibility.\n  * @param {string} visible Whether or not the block should be visible\n  */\nBlockly.BlockSvg.prototype.setVisible = function (visible) {\n  this.svgGroup_.style.display = visible ? \"\" : \"none\";\n};\n\n/**\n * SVG path for drawing the top-left corner of a statement input.\n * Includes the top notch, a horizontal space, and the rounded inside corner.\n */\nBlockly.BlockSvg.prototype.innerTopLeftCorner = function (notchPathRight) {\n  return notchPathRight + ' h -' +\n      (BS.NOTCH_WIDTH - BS.NOTCH_PATH_WIDTH -\n      BS.CORNER_RADIUS) +\n      ' a ' + BS.CORNER_RADIUS + ',' +\n      BS.CORNER_RADIUS + ' 0 0,0 -' +\n      BS.CORNER_RADIUS + ',' +\n      BS.CORNER_RADIUS;\n};\n\nBlockly.BlockSvg.prototype.isUnused = function () {\n  return Blockly.elementHasClass_(this.svgGroup_, 'blocklyUnused');\n};\n\nBlockly.BlockSvg.prototype.setIsUnused = function (isUnused) {\n  if (isUnused) {\n    Blockly.addClass_(this.svgGroup_, 'blocklyUnused');\n  } else {\n    Blockly.removeClass_(this.svgGroup_, 'blocklyUnused');\n  }\n\n  this.removeUnusedFrame();\n};\n\nBlockly.BlockSvg.prototype.addUnusedFrame = function () {\n  if (!this.unusedSvg_) {\n    this.unusedSvg_ = new Blockly.BlockSvgUnused(this);\n  }\n  this.unusedSvg_.render(this.svgGroup_);\n};\n\nBlockly.BlockSvg.prototype.removeUnusedFrame = function () {\n  if (this.unusedSvg_) {\n    this.unusedSvg_.dispose();\n    this.unusedSvg_ = null;\n  }\n};\n","/**\n * @fileoverview Methods for graphically rendering a block as SVG.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.BlockSvgFramed');\n\nvar FRAME_MARGIN_SIDE = 15;\nvar FRAME_MARGIN_TOP = 10;\nvar FRAME_MARGIN_BOTTOM = 5;\n\nvar FRAME_HEADER_HEIGHT = 25;\n\nBlockly.BlockSvgFramed = function (block) {\n  Blockly.BlockSvg.call(this, block);\n};\n\ngoog.inherits(Blockly.BlockSvgFramed, Blockly.BlockSvg);\n\nBlockly.BlockSvgFramed.prototype.initChildren = function () {\n  // create two frame rects.  the first is light gray and unclipped. the second\n  // is a darker gray, and clipped to be only the top FRAME_HEADER_HEIGHT pixels\n  var clip = Blockly.createSvgElement('clipPath', {\n    id: 'frameClip' + this.block_.id\n  }, this.svgGroup_);\n  this.frameClipRect_ = Blockly.createSvgElement('rect', {\n    x: -FRAME_MARGIN_SIDE,\n    y: -(FRAME_MARGIN_TOP + FRAME_HEADER_HEIGHT),\n    height: FRAME_HEADER_HEIGHT\n  }, clip);\n  this.frameBase_ = Blockly.createSvgElement('rect', {\n    x: -FRAME_MARGIN_SIDE,\n    y: -(FRAME_MARGIN_TOP + FRAME_HEADER_HEIGHT),\n    fill: '#dddddd',\n    stroke: '#aaaaaa',\n    rx: 15,\n    ry:15\n  }, this.svgGroup_);\n  this.frameHeader_ = Blockly.createSvgElement('rect', {\n    x: -FRAME_MARGIN_SIDE,\n    y: -(FRAME_MARGIN_TOP + FRAME_HEADER_HEIGHT),\n    fill: '#aaaaaa',\n    rx: 15,\n    ry:15,\n    'clip-path': 'url(#frameClip' + this.block_.id + ')'\n  }, this.svgGroup_);\n  this.frameText_ = Blockly.createSvgElement('text', {\n    'class': 'blocklyText',\n    style: 'font-size: 12pt'\n  }, this.svgGroup_);\n  this.frameText_.appendChild(document.createTextNode(Blockly.Msg.FUNCTION_HEADER));\n\n  Blockly.BlockSvgFramed.superClass_.initChildren.call(this);\n};\n\n/**\n * @override\n */\nBlockly.BlockSvgFramed.prototype.getPadding = function() {\n  return {\n    top: FRAME_MARGIN_TOP + FRAME_HEADER_HEIGHT,\n    right: FRAME_MARGIN_SIDE,\n    bottom: FRAME_MARGIN_BOTTOM,\n    left: FRAME_MARGIN_SIDE\n  };\n};\n\nBlockly.BlockSvgFramed.prototype.renderDraw_ = function(iconWidth, inputRows) {\n  Blockly.BlockSvgFramed.superClass_.renderDraw_.call(this, iconWidth, inputRows);\n\n  var groupRect = this.svgPath_.getBoundingClientRect();\n  var width = groupRect.width + 2 * FRAME_MARGIN_SIDE;\n  var height = groupRect.height + FRAME_MARGIN_TOP + FRAME_MARGIN_BOTTOM + FRAME_HEADER_HEIGHT;\n  this.frameClipRect_.setAttribute('width', width);\n  this.frameBase_.setAttribute('width', width);\n  this.frameBase_.setAttribute('height', height);\n  this.frameHeader_.setAttribute('width', width);\n  this.frameHeader_.setAttribute('height', height);\n  if (Blockly.RTL) {\n    this.frameClipRect_.setAttribute('x', -width + FRAME_MARGIN_SIDE);\n    this.frameHeader_.setAttribute('x', -width + FRAME_MARGIN_SIDE);\n    this.frameBase_.setAttribute('x', -width + FRAME_MARGIN_SIDE);\n    this.frameText_.setAttribute('x', -width + 2 * FRAME_MARGIN_SIDE);\n  }\n\n  if (!this.frameText_.getAttribute('y')) {\n    // The first time we render, we want to move our Function text inside of\n    // the header. The value Chrome was giving me for getBoundingRect().height\n    // seemed large, so instead I determine it by diffing the locations of the\n    // text's top, and the path's top.\n    var textHeight = Math.abs(this.frameText_.getBoundingClientRect().top -\n      this.svgPathDark_.getBoundingClientRect().top);\n    this.frameText_.setAttribute('y', -(FRAME_MARGIN_TOP + (FRAME_HEADER_HEIGHT - textHeight) / 2));\n  }\n};\n\nBlockly.BlockSvgFramed.prototype.dispose = function () {\n  Blockly.BlockSvgFramed.superClass_.dispose.call(this);\n\n  this.frameClipRect_ = null;\n  this.frameBase_ = null;\n  this.frameHeader_ = null;\n  this.frameText_ = null;\n};\n","/**\n * @fileoverview Extension of BlockSvg that allows for some settings specific\n * to functional blocks, including having a header row and input markers\n */\n'use strict';\n\ngoog.provide('Blockly.BlockSvgFunctional');\n\n/**\n * Render this block with a header row that has a different color.\n */\nBlockly.BlockSvgFunctional = function (block, options) {\n  options = options || {};\n  this.headerHeight = options.headerHeight || 0;\n  this.rowBuffer = options.rowBuffer || 0;\n  this.patternId_ = null; // updated when we set colour\n  this.inputMarkers_ = {};\n  this.inputClickTargets_ = {};\n  /**\n   * Input names to forced width spacing amount\n   * @type {{string, number}}\n   */\n  this.forcedInputSpacings = {};\n\n  Blockly.BlockSvg.call(this, block);\n};\ngoog.inherits(Blockly.BlockSvgFunctional, Blockly.BlockSvg);\n\nBlockly.BlockSvgFunctional.prototype.initChildren = function () {\n  var rgb = Blockly.makeColour(this.block_.getColour(),\n    this.block_.getSaturation(), this.block_.getValue());\n  var lightColor = goog.color.lighten(goog.color.hexToRgb(rgb), 0.3);\n  var lighterColor = goog.color.lighten(goog.color.hexToRgb(rgb), 0.8);\n\n  Blockly.BlockSvgFunctional.superClass_.initChildren.call(this);\n\n  var clip = Blockly.createSvgElement('clipPath', {\n    id: 'blockClip' + this.block_.id\n  }, this.svgGroup_);\n  this.blockClipRect_ = Blockly.createSvgElement('path', {}, clip);\n  this.divider_ = Blockly.createSvgElement('rect', {\n    x: 1,\n    y: this.headerHeight,\n    height: 3,\n    width: 0,\n    fill: goog.color.rgbArrayToHex(lightColor),\n    'clip-path': 'url(#blockClip' + this.block_.id + ')',\n    visibility: this.headerHeight > 0 ? 'visible' : 'hidden'\n  }, this.svgGroup_);\n  this.createFunctionalMarkers_();\n};\n\nBlockly.BlockSvgFunctional.prototype.renderDraw_ = function(iconWidth, inputRows) {\n  this.createFunctionalMarkers_();\n  Blockly.BlockSvgFunctional.superClass_.renderDraw_.call(this, iconWidth, inputRows);\n\n  this.blockClipRect_.setAttribute('d', this.svgPath_.getAttribute('d'));\n\n  try {\n    var rect = this.svgPath_.getBBox();\n    this.divider_.setAttribute('width', Math.max(0, rect.width - 2));\n  } catch (e) {\n    // Firefox has trouble with hidden elements (Bug 528969).\n    return;\n  }\n};\n\n/**\n * Ensures functional markers exist for each input\n * @private\n */\nBlockly.BlockSvgFunctional.prototype.createFunctionalMarkers_ = function () {\n  var functionalMarkers = [];\n  for (var i = 0; i < this.block_.inputList.length; i++) {\n    var input = this.block_.inputList[i];\n    functionalMarkers.push(input.name);\n    if (this.inputMarkers_[input.name]) {\n      continue;\n    }\n    if (input.type !== Blockly.FUNCTIONAL_INPUT) {\n      continue;\n    }\n    this.inputMarkers_[input.name] = Blockly.createSvgElement('rect', {\n      fill: 'white'\n    }, this.svgGroup_);\n\n    // Create a click target, that will end up having the same path as the input\n    // Set opacity to 0 so that we can see marker through it.\n    // Set class so that click handler knows not to select parent.\n    this.inputClickTargets_[input.name] = Blockly.createSvgElement('path', {\n      fill: 'white',\n      opacity: '0',\n      'class': 'inputClickTarget'\n    }, this.svgGroup_);\n\n    if (!this.block_.blockSpace.isFlyout) {\n      this.addInputClickListener_(input.name);\n    }\n  }\n\n  // Remove input markers that disappeared\n  Object.keys(this.inputMarkers_).forEach(function (markerName) {\n    if (functionalMarkers.indexOf(markerName) === -1) {\n      var element = this.inputMarkers_[markerName];\n      element.parentNode.removeChild(element);\n      delete this.inputMarkers_[markerName];\n\n      var element = this.inputClickTargets_[markerName];\n      element.parentNode.removeChild(element);\n      delete this.inputMarkers_[markerName];\n    }\n  }, this);\n\n};\n\n/**\n * Add a click listener to the marker for the given input, which will add a\n * child block on click if it's a number or string\n * @param {string} inputName\n */\nBlockly.BlockSvgFunctional.prototype.addInputClickListener_ = function (inputName) {\n  var blockSpace = this.block_.blockSpace;\n  var parentBlock = this.block_;\n  Blockly.bindEvent_(this.inputClickTargets_[inputName], 'mousedown', this, function (e) {\n    if (Blockly.isRightButton(e)) {\n      // Right-click.\n      return;\n    }\n    var childType;\n    var titleIndex;\n    var input = parentBlock.getInput(inputName);\n    if (input.connection.acceptsAnyType()) {\n      return;\n    }\n    if (input.connection.acceptsType('Number')) {\n      childType = 'functional_math_number';\n      titleIndex = 0;\n    } else if (input.connection.acceptsType('String')) {\n      childType = 'functional_string';\n      titleIndex = 1;\n    } else {\n      return;\n    }\n\n    var block = new Blockly.Block(blockSpace, childType);\n    block.initSvg();\n    input.connection.connect(block.previousConnection);\n\n    var titles = block.getTitles();\n    for (var i = 0; i < titles.length; i++) {\n      if (titles[i] instanceof Blockly.FieldTextInput) {\n        titles[i].showEditor_();\n      }\n    }\n    block.render();\n  });\n};\n\nBlockly.BlockSvgFunctional.prototype.renderDrawRight_ = function(renderInfo,\n    connectionsXY, inputRows, iconWidth) {\n\n  // add a little bit of extra buffer space on top so that our notch doesn't\n  // cut into our titles\n  if (this.rowBuffer) {\n    renderInfo.core.push('v', this.rowBuffer);\n    renderInfo.curY += this.rowBuffer;\n  }\n\n  Blockly.BlockSvgFunctional.superClass_.renderDrawRight_.call(this, renderInfo, connectionsXY, inputRows, iconWidth);\n\n};\n\n/**\n * Render a function input that is inlined\n * @param {!Object} renderInfo Current state of our paths\n * @param {!Object} input The input to render\n * @param {!Object} connectionsXY Location of block.\n * @private\n */\nBlockly.BlockSvgFunctional.prototype.renderDrawRightInlineFunctional_ =\n    function(renderInfo, input, connectionsXY) {\n  // todo (brent) - RTL\n  var inputTopLeft = {\n    x: renderInfo.curX,\n    y: renderInfo.curY + BS.INLINE_PADDING_Y\n  };\n\n  var notchStart = BS.NOTCH_WIDTH - BS.NOTCH_PATH_WIDTH;\n  var notchPaths = input.connection.getNotchPaths();\n\n  var inputSteps = [];\n\n  var forcedInputSpacing = this.forcedInputSpacings[input.name];\n  var inputWidthToTakeUp = forcedInputSpacing || input.renderWidth;\n\n  inputSteps.push('M', inputTopLeft.x + ',' + inputTopLeft.y);\n  inputSteps.push('h', notchStart);\n  inputSteps.push(notchPaths.left);\n  inputSteps.push('H', inputTopLeft.x + input.renderWidth);\n  inputSteps.push('v', input.renderHeight);\n  inputSteps.push('H', inputTopLeft.x);\n  inputSteps.push('z');\n\n  renderInfo.inline = renderInfo.inline.concat(inputSteps);\n\n  this.inputClickTargets_[input.name].setAttribute('d', inputSteps.join(' '));\n\n  this.inputMarkers_[input.name].setAttribute('x', inputTopLeft.x + 5);\n  this.inputMarkers_[input.name].setAttribute('y', inputTopLeft.y + 15);\n  this.inputMarkers_[input.name].setAttribute('width', input.renderWidth - 10);\n  this.inputMarkers_[input.name].setAttribute('height', 5);\n  this.inputMarkers_[input.name].setAttribute('fill', input.getHexColour());\n\n  // hide inputs that have targets, so that the rectangle doesn't show up when\n  // dragging\n  this.inputMarkers_[input.name].setAttribute('visibility',\n    input.connection.targetConnection ? 'hidden' : 'visible');\n  this.inputClickTargets_[input.name].setAttribute('visibility',\n    input.connection.targetConnection ? 'hidden' : 'visible');\n\n  renderInfo.curX += this.inputWidthToOccupy_(input) + BS.SEP_SPACE_X;\n\n  // Create inline input connection.\n  var connectionX = connectionsXY.x + inputTopLeft.x + BS.NOTCH_WIDTH;\n  var connectionY = connectionsXY.y + inputTopLeft.y;\n\n  input.connection.moveTo(connectionX, connectionY);\n  if (input.connection.targetConnection) {\n    input.connection.tighten_();\n  }\n};\n\nBlockly.BlockSvgFunctional.prototype.updateToColour_ = function(hexColour) {\n  Blockly.BlockSvgFunctional.superClass_.updateToColour_.call(this, hexColour);\n\n  if (!this.divider_) {\n    return;\n  }\n\n  // The block's color and the hexColour passed in here get out of sync if\n  // the block is grayed out (hexColour is gray, block color remains unchanged)\n  // Base our divider colour off of the rendered color (which is hexColour)\n  var lightColor = goog.color.lighten(goog.color.hexToRgb(hexColour), 0.3);\n  this.divider_.setAttribute('fill', goog.color.rgbArrayToHex(lightColor));\n};\n\nBlockly.BlockSvgFunctional.prototype.dispose = function () {\n  Blockly.BlockSvgFunctional.superClass_.dispose.call(this);\n\n  this.blockClipRect_ = null;\n  this.divider_ = null;\n};\n","goog.provide('Blockly.Blocks');\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Library for creating scrollbars.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Scrollbar');\ngoog.provide('Blockly.ScrollbarPair');\n\n/**\n * Class for a pair of scrollbars.  Horizontal and vertical.\n * @param {!Blockly.BlockSpace} blockSpace BlockSpace to bind the scrollbars to.\n * @param {boolean} addHorizontal\n * @param {boolean} addVertical\n * @constructor\n */\nBlockly.ScrollbarPair = function(blockSpace, addHorizontal, addVertical) {\n  this.blockSpace_ = blockSpace;\n  this.oldHostMetrics_ = null;\n\n  if (addHorizontal) {\n    this.hScroll = new Blockly.Scrollbar(blockSpace, true, addHorizontal && addVertical);\n  }\n\n  if (addVertical) {\n    this.vScroll = new Blockly.Scrollbar(blockSpace, false, addHorizontal && addVertical);\n  }\n\n  if (addHorizontal && addVertical) {\n    this.corner_ = Blockly.createSvgElement('rect',\n        {'height': Blockly.Scrollbar.scrollbarThickness,\n        'width': Blockly.Scrollbar.scrollbarThickness,\n        'style': 'fill: #fff'}, null);\n    Blockly.Scrollbar.insertAfter_(this.corner_, blockSpace.getBubbleCanvas());\n  }\n};\n\n/**\n * Dispose of this pair of scrollbars.\n * Unlink from all DOM elements to prevent memory leaks.\n */\nBlockly.ScrollbarPair.prototype.dispose = function() {\n  if (this.onResizeWrapper_) {\n    Blockly.unbindEvent_(this.onResizeWrapper_);\n    this.onResizeWrapper_ = null;\n  }\n  if (this.corner_) {\n    goog.dom.removeNode(this.corner_);\n  }\n  this.corner_ = null;\n  this.blockSpace_ = null;\n  this.oldHostMetrics_ = null;\n  if (this.hScroll) {\n    this.hScroll.dispose();\n  }\n  this.hScroll = null;\n  if (this.vScroll) {\n    this.vScroll.dispose();\n  }\n  this.vScroll = null;\n};\n\n/** @returns {boolean} */\nBlockly.ScrollbarPair.prototype.canScrollHorizontally = function() {\n  return !!(this.hScroll);\n};\n\n/** @returns {boolean} */\nBlockly.ScrollbarPair.prototype.canScrollVertically = function() {\n  return !!(this.vScroll);\n};\n\n/**\n * Recalculate both of the scrollbars' locations and lengths.\n * Also reposition the corner rectangle.\n */\nBlockly.ScrollbarPair.prototype.resize = function() {\n  // Look up the host metrics once, and use for both scrollbars.\n  var hostMetrics = this.blockSpace_.getMetrics();\n  if (!hostMetrics) {\n    // Host element is likely not visible.\n    return;\n  }\n\n  /**\n   * @type {function(this:Blockly.ScrollbarPair, string[])}\n   */\n  var anyPropertyChanged = this.metricsChangedOnAxis.bind(this, this.oldHostMetrics_, hostMetrics);\n  var didResizeOccur = anyPropertyChanged(['viewWidth', 'absoluteLeft', 'viewHeight', 'absoluteTop']);\n\n  // Only change the scrollbars if there has been a change in metrics.\n  var resizeH = didResizeOccur || anyPropertyChanged(['contentWidth', 'viewLeft', 'contentLeft']);\n  var resizeV = didResizeOccur || anyPropertyChanged(['contentHeight', 'viewTop', 'contentTop']);;\n\n  if (this.hScroll && resizeH) {\n    this.hScroll.resize(hostMetrics);\n  }\n  if (this.vScroll && resizeV) {\n    this.vScroll.resize(hostMetrics);\n  }\n\n  // Reposition the corner square.\n  if (this.vScroll && this.hScroll && didResizeOccur) {\n    this.corner_.setAttribute('x', this.vScroll.xCoordinate);\n    this.corner_.setAttribute('y', this.hScroll.yCoordinate);\n  }\n\n  // Cache the current metrics to potentially short-cut the next resize event.\n  this.oldHostMetrics_ = hostMetrics;\n};\n\nBlockly.ScrollbarPair.prototype.metricsChangedOnAxis = function(oldMetrics, currentMetrics, propertiesToCheck) {\n  if (!oldMetrics) {\n    return true;\n  }\n\n  return propertiesToCheck.some(function (propName) {\n    return oldMetrics[propName] != currentMetrics[propName];\n  });\n};\n\n/**\n * Set the sliders of both scrollbars to be at a certain position.\n * @param {number} x Horizontal scroll value.\n * @param {number} y Vertical scroll value.\n */\nBlockly.ScrollbarPair.prototype.set = function(x, y) {\n  // SVG scrollbars.\n  // Set both scrollbars and allow each to call a separate onScroll execution.\n  if (this.hScroll) {\n    this.hScroll.set(x, true);\n  }\n  if (this.vScroll) {\n    this.vScroll.set(y, true);\n  }\n};\n\n/**\n * Class for a pure SVG scrollbar.\n * This technique offers a scrollbar that is guaranteed to work, but may not\n * look or behave like the system's scrollbars.\n * @param {!Blockly.BlockSpace} blockSpace BlockSpace to bind the scrollbar to.\n * @param {boolean} horizontal True if horizontal, false if vertical.\n * @param {boolean} opt_pair True if the scrollbar is part of a horiz/vert pair.\n * @constructor\n */\nBlockly.ScrollbarSvg = function(blockSpace, horizontal, opt_pair) {\n  this.blockSpace_ = blockSpace;\n  this.pair_ = opt_pair || false;\n  this.horizontal_ = horizontal;\n\n  this.createDom_();\n\n  if (horizontal) {\n    this.svgBackground_.setAttribute('height',\n        Blockly.Scrollbar.scrollbarThickness);\n    this.svgKnob_.setAttribute('height',\n        Blockly.Scrollbar.scrollbarThickness - 6);\n    this.svgKnob_.setAttribute('y', 3);\n  } else {\n    this.svgBackground_.setAttribute('width',\n        Blockly.Scrollbar.scrollbarThickness);\n    this.svgKnob_.setAttribute('width',\n        Blockly.Scrollbar.scrollbarThickness - 6);\n    this.svgKnob_.setAttribute('x', 3);\n  }\n  var scrollbar = this;\n  this.onMouseDownBarWrapper_ = Blockly.bindEvent_(this.svgBackground_,\n      'mousedown', scrollbar, scrollbar.onMouseDownBar_);\n  this.onMouseDownKnobWrapper_ = Blockly.bindEvent_(this.svgKnob_,\n      'mousedown', scrollbar, scrollbar.onMouseDownKnob_);\n};\n\n/**\n * Dispose of this scrollbar.\n * Unlink from all DOM elements to prevent memory leaks.\n */\nBlockly.ScrollbarSvg.prototype.dispose = function() {\n  this.onMouseUpKnob_();\n  if (this.onResizeWrapper_) {\n    Blockly.unbindEvent_(this.onResizeWrapper_);\n    this.onResizeWrapper_ = null;\n  }\n  Blockly.unbindEvent_(this.onMouseDownBarWrapper_);\n  this.onMouseDownBarWrapper_ = null;\n  Blockly.unbindEvent_(this.onMouseDownKnobWrapper_);\n  this.onMouseDownKnobWrapper_ = null;\n\n  goog.dom.removeNode(this.svgGroup_);\n  this.svgGroup_ = null;\n  this.svgBackground_ = null;\n  this.svgKnob_ = null;\n  this.blockSpace_ = null;\n};\n\n/**\n * Recalculate the scrollbar's location and its length.\n * @param {Object=} opt_metrics A data structure of from the describing all the\n * required dimensions.  If not provided, it will be fetched from the host\n * object.\n */\nBlockly.ScrollbarSvg.prototype.resize = function(opt_metrics) {\n  // Determine the location, height and width of the host element.\n  var hostMetrics = opt_metrics;\n  if (!hostMetrics) {\n    hostMetrics = this.blockSpace_.getMetrics();\n    if (!hostMetrics) {\n      // Host element is likely not visible.\n      return;\n    }\n  }\n\n  var blockSpaceSize = this.blockSpace_.getScrollableSize(hostMetrics);\n\n  /* hostMetrics is an object with the following properties.\n   * .viewHeight: Height of the visible rectangle,\n   * .viewWidth: Width of the visible rectangle,\n   * .contentHeight: Height of the contents,\n   * .contentWidth: Width of the content,\n   * .viewTop: Offset of top edge of visible rectangle from parent,\n   * .viewLeft: Offset of left edge of visible rectangle from parent,\n   * .contentTop: Offset of the top-most content from the y=0 coordinate,\n   * .contentLeft: Offset of the left-most content from the x=0 coordinate,\n   * .absoluteTop: Top-edge of view.\n   * .absoluteLeft: Left-edge of view.\n   */\n  if (this.horizontal_) {\n    var outerLength = hostMetrics.viewWidth;\n    if (this.pair_) {\n      // Shorten the scrollbar to make room for the corner square.\n      outerLength -= Blockly.Scrollbar.scrollbarThickness;\n    } else {\n      // Only show the scrollbar if needed.\n      // Ideally this would also apply to scrollbar pairs, but that's a bigger\n      // headache (due to interactions with the corner square).\n      this.setVisible(outerLength < blockSpaceSize.width);\n    }\n    this.ratio_ = outerLength / blockSpaceSize.width;\n    if (this.ratio_ === -Infinity || this.ratio_ === Infinity ||\n        isNaN(this.ratio_)) {\n      this.ratio_ = 0;\n    }\n    var innerLength = hostMetrics.viewWidth * this.ratio_;\n    var innerOffset = hostMetrics.viewLeft * this.ratio_;\n    this.svgKnob_.setAttribute('width', Math.max(0, innerLength));\n    this.xCoordinate = hostMetrics.absoluteLeft;\n    if (this.pair_ && Blockly.RTL) {\n      this.xCoordinate += hostMetrics.absoluteLeft +\n          Blockly.Scrollbar.scrollbarThickness;\n    }\n    this.yCoordinate = hostMetrics.absoluteTop + hostMetrics.viewHeight -\n        Blockly.Scrollbar.scrollbarThickness;\n    this.svgGroup_.setAttribute('transform',\n        'translate(' + this.xCoordinate + ', ' + this.yCoordinate + ')');\n    this.svgBackground_.setAttribute('width', Math.max(0, outerLength));\n    this.svgKnob_.setAttribute('x', this.constrainKnob_(innerOffset));\n  } else {\n    var outerLength = hostMetrics.viewHeight;\n    if (this.pair_) {\n      // Shorten the scrollbar to make room for the corner square.\n      outerLength -= Blockly.Scrollbar.scrollbarThickness;\n    } else {\n      // Only show the scrollbar if needed.\n      this.setVisible(outerLength < blockSpaceSize.height);\n    }\n    this.ratio_ = outerLength / blockSpaceSize.height;\n    if (this.ratio_ === -Infinity || this.ratio_ === Infinity ||\n        isNaN(this.ratio_)) {\n      this.ratio_ = 0;\n    }\n    var innerLength = hostMetrics.viewHeight * this.ratio_;\n    var innerOffset = hostMetrics.viewTop * this.ratio_;\n    this.svgKnob_.setAttribute('height', Math.max(0, innerLength));\n    this.xCoordinate = hostMetrics.absoluteLeft;\n    if (!Blockly.RTL) {\n      this.xCoordinate += hostMetrics.viewWidth -\n          Blockly.Scrollbar.scrollbarThickness;\n    }\n    this.yCoordinate = hostMetrics.absoluteTop;\n    this.svgGroup_.setAttribute('transform',\n        'translate(' + this.xCoordinate + ', ' + this.yCoordinate + ')');\n    this.svgBackground_.setAttribute('height', Math.max(0, outerLength));\n    this.svgKnob_.setAttribute('y', this.constrainKnob_(innerOffset));\n  }\n  // Resizing may have caused some scrolling.\n  this.onScroll_();\n};\n\n/**\n * Create all the DOM elements required for a scrollbar.\n * The resulting widget is not sized.\n * @private\n */\nBlockly.ScrollbarSvg.prototype.createDom_ = function() {\n  /* Create the following DOM:\n  <g>\n    <rect class=\"blocklyScrollbarBackground\" />\n    <rect class=\"blocklyScrollbarKnob\" rx=\"7\" ry=\"7\" />\n  </g>\n  */\n  this.svgGroup_ = Blockly.createSvgElement('g', {}, null);\n  this.svgBackground_ = Blockly.createSvgElement('rect',\n      {'class': 'blocklyScrollbarBackground'}, this.svgGroup_);\n  var radius = Math.floor((Blockly.Scrollbar.scrollbarThickness - 6) / 2);\n  this.svgKnob_ = Blockly.createSvgElement('rect',\n      {'class': 'blocklyScrollbarKnob', 'rx': radius, 'ry': radius},\n      this.svgGroup_);\n  Blockly.Scrollbar.insertAfter_(this.svgGroup_,\n                                 this.blockSpace_.getBubbleCanvas());\n};\n\n/**\n * Is the scrollbar visible.  Non-paired scrollbars disappear when they aren't\n * needed.\n * @return {boolean} True if visible.\n */\nBlockly.ScrollbarSvg.prototype.isVisible = function() {\n  return this.svgGroup_.getAttribute('display') != 'none';\n};\n\n/**\n * Set whether the scrollbar is visible.\n * Only applies to non-paired scrollbars.\n * @param {boolean} visible True if visible.\n */\nBlockly.ScrollbarSvg.prototype.setVisible = function(visible) {\n  if (visible == this.isVisible()) {\n    return;\n  }\n  // Ideally this would also apply to scrollbar pairs, but that's a bigger\n  // headache (due to interactions with the corner square).\n  if (this.pair_) {\n    throw 'Unable to toggle visibility of paired scrollbars.';\n  }\n  if (visible) {\n    this.svgGroup_.setAttribute('display', 'block');\n  } else {\n    // Hide the scrollbar.\n    this.blockSpace_.setMetrics({x: 0, y: 0});\n    this.svgGroup_.setAttribute('display', 'none');\n  }\n};\n\n/**\n * Scroll by one pageful.\n * Called when scrollbar background is clicked.\n * @param {!Event} e Mouse down event.\n * @private\n */\nBlockly.ScrollbarSvg.prototype.onMouseDownBar_ = function(e) {\n  this.blockSpace_.blockSpaceEditor.hideChaff(true);\n  if (Blockly.isRightButton(e)) {\n    // Right-click.\n    // Scrollbars have no context menu.\n    e.stopPropagation();\n    return;\n  }\n  var mouseXY = Blockly.mouseToSvg(e, this.blockSpace_.blockSpaceEditor.svg_);\n  var mouseLocation = this.horizontal_ ? mouseXY.x : mouseXY.y;\n\n  var knobXY = Blockly.getSvgXY_(this.svgKnob_, this.blockSpace_.blockSpaceEditor.svg_);\n  var knobStart = this.horizontal_ ? knobXY.x : knobXY.y;\n  var knobLength = parseFloat(\n      this.svgKnob_.getAttribute(this.horizontal_ ? 'width' : 'height'));\n  var knobValue = parseFloat(\n      this.svgKnob_.getAttribute(this.horizontal_ ? 'x' : 'y'));\n\n  var pageLength = knobLength * 0.95;\n  if (mouseLocation <= knobStart) {\n    // Decrease the scrollbar's value by a page.\n    knobValue -= pageLength;\n  } else if (mouseLocation >= knobStart + knobLength) {\n    // Increase the scrollbar's value by a page.\n    knobValue += pageLength;\n  }\n  this.svgKnob_.setAttribute(this.horizontal_ ? 'x' : 'y',\n                             this.constrainKnob_(knobValue));\n  this.onScroll_();\n  e.stopPropagation();\n};\n\n/**\n * Start a dragging operation.\n * Called when scrollbar knob is clicked.\n * @param {!Event} e Mouse down event.\n * @private\n */\nBlockly.ScrollbarSvg.prototype.onMouseDownKnob_ = function(e) {\n  this.blockSpace_.blockSpaceEditor.hideChaff(true);\n  this.onMouseUpKnob_();\n  if (Blockly.isRightButton(e)) {\n    // Right-click.\n    // Scrollbars have no context menu.\n    e.stopPropagation();\n    return;\n  }\n  // Look up the current translation and record it.\n  this.startDragKnob = parseFloat(\n      this.svgKnob_.getAttribute(this.horizontal_ ? 'x' : 'y'));\n  // Record the current mouse position.\n  this.startDragMouse = this.horizontal_ ? e.clientX : e.clientY;\n  Blockly.ScrollbarSvg.onMouseUpWrapper_ = Blockly.bindEvent_(document,\n      'mouseup', this, this.onMouseUpKnob_);\n  Blockly.ScrollbarSvg.onMouseMoveWrapper_ = Blockly.bindEvent_(document,\n      'mousemove', this, this.onMouseMoveKnob_);\n  e.stopPropagation();\n};\n\n/**\n * Drag the scrollbar's knob.\n * @param {!Event} e Mouse up event.\n * @private\n */\nBlockly.ScrollbarSvg.prototype.onMouseMoveKnob_ = function(e) {\n  var currentMouse = this.horizontal_ ? e.clientX : e.clientY;\n  var mouseDelta = currentMouse - this.startDragMouse;\n  var knobValue = this.startDragKnob + mouseDelta;\n  // Position the bar.\n  this.svgKnob_.setAttribute(this.horizontal_ ? 'x' : 'y',\n                             this.constrainKnob_(knobValue));\n  this.onScroll_();\n};\n\n/**\n * Stop binding to the global mouseup and mousemove events.\n * @private\n */\nBlockly.ScrollbarSvg.prototype.onMouseUpKnob_ = function() {\n  if (Blockly.ScrollbarSvg.onMouseUpWrapper_) {\n    Blockly.unbindEvent_(Blockly.ScrollbarSvg.onMouseUpWrapper_);\n    Blockly.ScrollbarSvg.onMouseUpWrapper_ = null;\n  }\n  if (Blockly.ScrollbarSvg.onMouseMoveWrapper_) {\n    Blockly.unbindEvent_(Blockly.ScrollbarSvg.onMouseMoveWrapper_);\n    Blockly.ScrollbarSvg.onMouseMoveWrapper_ = null;\n  }\n};\n\n/**\n * Constrain the knob's position within the minimum (0) and maximum\n * (length of scrollbar) values allowed for the scrollbar.\n * @param {number} value Value that is potentially out of bounds.\n * @return {number} Constrained value.\n * @private\n */\nBlockly.ScrollbarSvg.prototype.constrainKnob_ = function(value) {\n  if (value <= 0 || isNaN(value)) {\n    value = 0;\n  } else {\n    var axis = this.horizontal_ ? 'width' : 'height';\n    var barLength = parseFloat(this.svgBackground_.getAttribute(axis));\n    var knobLength = parseFloat(this.svgKnob_.getAttribute(axis));\n    value = Math.min(value, barLength - knobLength);\n  }\n  return value;\n};\n\n/**\n * Called when scrollbar is moved.\n * @private\n */\nBlockly.ScrollbarSvg.prototype.onScroll_ = function() {\n  var knobValue = parseFloat(\n      this.svgKnob_.getAttribute(this.horizontal_ ? 'x' : 'y'));\n  var barLength = parseFloat(\n      this.svgBackground_.getAttribute(this.horizontal_ ? 'width' : 'height'));\n  var ratio = knobValue / barLength;\n  if (isNaN(ratio)) {\n    ratio = 0;\n  }\n  var xyRatio = {};\n  if (this.horizontal_) {\n    xyRatio.x = ratio;\n  } else {\n    xyRatio.y = ratio;\n  }\n  this.blockSpace_.setMetrics(xyRatio);\n};\n\n/**\n * Set the scrollbar slider's position.\n * @param {number} value The distance from the top/left end of the bar.\n * @param {boolean} fireEvents True if onScroll events should be fired.\n */\nBlockly.ScrollbarSvg.prototype.set = function(value, fireEvents) {\n  // Move the scrollbar slider.\n  this.svgKnob_.setAttribute(this.horizontal_ ? 'x' : 'y', value * this.ratio_);\n\n  if (fireEvents) {\n    this.onScroll_();\n  }\n};\n\nBlockly.Scrollbar = Blockly.ScrollbarSvg;\nBlockly.Scrollbar.scrollbarThickness = 15;\n\n/**\n * Insert a node after a reference node.\n * Contrast with node.insertBefore function.\n * @param {!Element} newNode New element to insert.\n * @param {!Element} refNode Existing element to precede new node.\n * @private\n */\nBlockly.Scrollbar.insertAfter_ = function(newNode, refNode) {\n  var siblingNode = refNode.nextSibling;\n  var parentNode = refNode.parentNode;\n  if (!parentNode) {\n    throw 'Reference node has no parent.';\n  }\n  if (siblingNode) {\n    parentNode.insertBefore(newNode, siblingNode);\n  } else {\n    parentNode.appendChild(newNode);\n  }\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Additional mathematical functions.\n */\n\ngoog.provide('goog.math');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\n\n\n/**\n * Returns a random integer greater than or equal to 0 and less than {@code a}.\n * @param {number} a  The upper bound for the random integer (exclusive).\n * @return {number} A random integer N such that 0 <= N < a.\n */\ngoog.math.randomInt = function(a) {\n  return Math.floor(Math.random() * a);\n};\n\n\n/**\n * Returns a random number greater than or equal to {@code a} and less than\n * {@code b}.\n * @param {number} a  The lower bound for the random number (inclusive).\n * @param {number} b  The upper bound for the random number (exclusive).\n * @return {number} A random number N such that a <= N < b.\n */\ngoog.math.uniformRandom = function(a, b) {\n  return a + Math.random() * (b - a);\n};\n\n\n/**\n * Takes a number and clamps it to within the provided bounds.\n * @param {number} value The input number.\n * @param {number} min The minimum value to return.\n * @param {number} max The maximum value to return.\n * @return {number} The input number if it is within bounds, or the nearest\n *     number within the bounds.\n */\ngoog.math.clamp = function(value, min, max) {\n  return Math.min(Math.max(value, min), max);\n};\n\n\n/**\n * The % operator in JavaScript returns the remainder of a / b, but differs from\n * some other languages in that the result will have the same sign as the\n * dividend. For example, -1 % 8 == -1, whereas in some other languages\n * (such as Python) the result would be 7. This function emulates the more\n * correct modulo behavior, which is useful for certain applications such as\n * calculating an offset index in a circular list.\n *\n * @param {number} a The dividend.\n * @param {number} b The divisor.\n * @return {number} a % b where the result is between 0 and b (either 0 <= x < b\n *     or b < x <= 0, depending on the sign of b).\n */\ngoog.math.modulo = function(a, b) {\n  var r = a % b;\n  // If r and b differ in sign, add b to wrap the result to the correct sign.\n  return (r * b < 0) ? r + b : r;\n};\n\n\n/**\n * Performs linear interpolation between values a and b. Returns the value\n * between a and b proportional to x (when x is between 0 and 1. When x is\n * outside this range, the return value is a linear extrapolation).\n * @param {number} a A number.\n * @param {number} b A number.\n * @param {number} x The proportion between a and b.\n * @return {number} The interpolated value between a and b.\n */\ngoog.math.lerp = function(a, b, x) {\n  return a + x * (b - a);\n};\n\n\n/**\n * Tests whether the two values are equal to each other, within a certain\n * tolerance to adjust for floating point errors.\n * @param {number} a A number.\n * @param {number} b A number.\n * @param {number=} opt_tolerance Optional tolerance range. Defaults\n *     to 0.000001. If specified, should be greater than 0.\n * @return {boolean} Whether {@code a} and {@code b} are nearly equal.\n */\ngoog.math.nearlyEquals = function(a, b, opt_tolerance) {\n  return Math.abs(a - b) <= (opt_tolerance || 0.000001);\n};\n\n\n// TODO(user): Rename to normalizeAngle, retaining old name as deprecated\n// alias.\n/**\n * Normalizes an angle to be in range [0-360). Angles outside this range will\n * be normalized to be the equivalent angle with that range.\n * @param {number} angle Angle in degrees.\n * @return {number} Standardized angle.\n */\ngoog.math.standardAngle = function(angle) {\n  return goog.math.modulo(angle, 360);\n};\n\n\n/**\n * Normalizes an angle to be in range [0-2*PI). Angles outside this range will\n * be normalized to be the equivalent angle with that range.\n * @param {number} angle Angle in radians.\n * @return {number} Standardized angle.\n */\ngoog.math.standardAngleInRadians = function(angle) {\n  return goog.math.modulo(angle, 2 * Math.PI);\n};\n\n\n/**\n * Converts degrees to radians.\n * @param {number} angleDegrees Angle in degrees.\n * @return {number} Angle in radians.\n */\ngoog.math.toRadians = function(angleDegrees) {\n  return angleDegrees * Math.PI / 180;\n};\n\n\n/**\n * Converts radians to degrees.\n * @param {number} angleRadians Angle in radians.\n * @return {number} Angle in degrees.\n */\ngoog.math.toDegrees = function(angleRadians) {\n  return angleRadians * 180 / Math.PI;\n};\n\n\n/**\n * For a given angle and radius, finds the X portion of the offset.\n * @param {number} degrees Angle in degrees (zero points in +X direction).\n * @param {number} radius Radius.\n * @return {number} The x-distance for the angle and radius.\n */\ngoog.math.angleDx = function(degrees, radius) {\n  return radius * Math.cos(goog.math.toRadians(degrees));\n};\n\n\n/**\n * For a given angle and radius, finds the Y portion of the offset.\n * @param {number} degrees Angle in degrees (zero points in +X direction).\n * @param {number} radius Radius.\n * @return {number} The y-distance for the angle and radius.\n */\ngoog.math.angleDy = function(degrees, radius) {\n  return radius * Math.sin(goog.math.toRadians(degrees));\n};\n\n\n/**\n * Computes the angle between two points (x1,y1) and (x2,y2).\n * Angle zero points in the +X direction, 90 degrees points in the +Y\n * direction (down) and from there we grow clockwise towards 360 degrees.\n * @param {number} x1 x of first point.\n * @param {number} y1 y of first point.\n * @param {number} x2 x of second point.\n * @param {number} y2 y of second point.\n * @return {number} Standardized angle in degrees of the vector from\n *     x1,y1 to x2,y2.\n */\ngoog.math.angle = function(x1, y1, x2, y2) {\n  return goog.math.standardAngle(\n      goog.math.toDegrees(Math.atan2(y2 - y1, x2 - x1)));\n};\n\n\n/**\n * Computes the difference between startAngle and endAngle (angles in degrees).\n * @param {number} startAngle  Start angle in degrees.\n * @param {number} endAngle  End angle in degrees.\n * @return {number} The number of degrees that when added to\n *     startAngle will result in endAngle. Positive numbers mean that the\n *     direction is clockwise. Negative numbers indicate a counter-clockwise\n *     direction.\n *     The shortest route (clockwise vs counter-clockwise) between the angles\n *     is used.\n *     When the difference is 180 degrees, the function returns 180 (not -180)\n *     angleDifference(30, 40) is 10, and angleDifference(40, 30) is -10.\n *     angleDifference(350, 10) is 20, and angleDifference(10, 350) is -20.\n */\ngoog.math.angleDifference = function(startAngle, endAngle) {\n  var d =\n      goog.math.standardAngle(endAngle) - goog.math.standardAngle(startAngle);\n  if (d > 180) {\n    d = d - 360;\n  } else if (d <= -180) {\n    d = 360 + d;\n  }\n  return d;\n};\n\n\n/**\n * Returns the sign of a number as per the \"sign\" or \"signum\" function.\n * @param {number} x The number to take the sign of.\n * @return {number} -1 when negative, 1 when positive, 0 when 0. Preserves\n *     signed zeros and NaN.\n */\ngoog.math.sign = function(x) {\n  if (x > 0) {\n    return 1;\n  }\n  if (x < 0) {\n    return -1;\n  }\n  return x;  // Preserves signed zeros and NaN.\n};\n\n\n/**\n * JavaScript implementation of Longest Common Subsequence problem.\n * http://en.wikipedia.org/wiki/Longest_common_subsequence\n *\n * Returns the longest possible array that is subarray of both of given arrays.\n *\n * @param {IArrayLike<S>} array1 First array of objects.\n * @param {IArrayLike<T>} array2 Second array of objects.\n * @param {Function=} opt_compareFn Function that acts as a custom comparator\n *     for the array ojects. Function should return true if objects are equal,\n *     otherwise false.\n * @param {Function=} opt_collectorFn Function used to decide what to return\n *     as a result subsequence. It accepts 2 arguments: index of common element\n *     in the first array and index in the second. The default function returns\n *     element from the first array.\n * @return {!Array<S|T>} A list of objects that are common to both arrays\n *     such that there is no common subsequence with size greater than the\n *     length of the list.\n * @template S,T\n */\ngoog.math.longestCommonSubsequence = function(\n    array1, array2, opt_compareFn, opt_collectorFn) {\n\n  var compare = opt_compareFn || function(a, b) { return a == b; };\n\n  var collect = opt_collectorFn || function(i1, i2) { return array1[i1]; };\n\n  var length1 = array1.length;\n  var length2 = array2.length;\n\n  var arr = [];\n  for (var i = 0; i < length1 + 1; i++) {\n    arr[i] = [];\n    arr[i][0] = 0;\n  }\n\n  for (var j = 0; j < length2 + 1; j++) {\n    arr[0][j] = 0;\n  }\n\n  for (i = 1; i <= length1; i++) {\n    for (j = 1; j <= length2; j++) {\n      if (compare(array1[i - 1], array2[j - 1])) {\n        arr[i][j] = arr[i - 1][j - 1] + 1;\n      } else {\n        arr[i][j] = Math.max(arr[i - 1][j], arr[i][j - 1]);\n      }\n    }\n  }\n\n  // Backtracking\n  var result = [];\n  var i = length1, j = length2;\n  while (i > 0 && j > 0) {\n    if (compare(array1[i - 1], array2[j - 1])) {\n      result.unshift(collect(i - 1, j - 1));\n      i--;\n      j--;\n    } else {\n      if (arr[i - 1][j] > arr[i][j - 1]) {\n        i--;\n      } else {\n        j--;\n      }\n    }\n  }\n\n  return result;\n};\n\n\n/**\n * Returns the sum of the arguments.\n * @param {...number} var_args Numbers to add.\n * @return {number} The sum of the arguments (0 if no arguments were provided,\n *     {@code NaN} if any of the arguments is not a valid number).\n */\ngoog.math.sum = function(var_args) {\n  return /** @type {number} */ (\n      goog.array.reduce(\n          arguments, function(sum, value) { return sum + value; }, 0));\n};\n\n\n/**\n * Returns the arithmetic mean of the arguments.\n * @param {...number} var_args Numbers to average.\n * @return {number} The average of the arguments ({@code NaN} if no arguments\n *     were provided or any of the arguments is not a valid number).\n */\ngoog.math.average = function(var_args) {\n  return goog.math.sum.apply(null, arguments) / arguments.length;\n};\n\n\n/**\n * Returns the unbiased sample variance of the arguments. For a definition,\n * see e.g. http://en.wikipedia.org/wiki/Variance\n * @param {...number} var_args Number samples to analyze.\n * @return {number} The unbiased sample variance of the arguments (0 if fewer\n *     than two samples were provided, or {@code NaN} if any of the samples is\n *     not a valid number).\n */\ngoog.math.sampleVariance = function(var_args) {\n  var sampleSize = arguments.length;\n  if (sampleSize < 2) {\n    return 0;\n  }\n\n  var mean = goog.math.average.apply(null, arguments);\n  var variance =\n      goog.math.sum.apply(null, goog.array.map(arguments, function(val) {\n        return Math.pow(val - mean, 2);\n      })) / (sampleSize - 1);\n\n  return variance;\n};\n\n\n/**\n * Returns the sample standard deviation of the arguments.  For a definition of\n * sample standard deviation, see e.g.\n * http://en.wikipedia.org/wiki/Standard_deviation\n * @param {...number} var_args Number samples to analyze.\n * @return {number} The sample standard deviation of the arguments (0 if fewer\n *     than two samples were provided, or {@code NaN} if any of the samples is\n *     not a valid number).\n */\ngoog.math.standardDeviation = function(var_args) {\n  return Math.sqrt(goog.math.sampleVariance.apply(null, arguments));\n};\n\n\n/**\n * Returns whether the supplied number represents an integer, i.e. that is has\n * no fractional component.  No range-checking is performed on the number.\n * @param {number} num The number to test.\n * @return {boolean} Whether {@code num} is an integer.\n */\ngoog.math.isInt = function(num) {\n  return isFinite(num) && num % 1 == 0;\n};\n\n\n/**\n * Returns whether the supplied number is finite and not NaN.\n * @param {number} num The number to test.\n * @return {boolean} Whether {@code num} is a finite number.\n */\ngoog.math.isFiniteNumber = function(num) {\n  return isFinite(num) && !isNaN(num);\n};\n\n\n/**\n * @param {number} num The number to test.\n * @return {boolean} Whether it is negative zero.\n */\ngoog.math.isNegativeZero = function(num) {\n  return num == 0 && 1 / num < 0;\n};\n\n\n/**\n * Returns the precise value of floor(log10(num)).\n * Simpler implementations didn't work because of floating point rounding\n * errors. For example\n * <ul>\n * <li>Math.floor(Math.log(num) / Math.LN10) is off by one for num == 1e+3.\n * <li>Math.floor(Math.log(num) * Math.LOG10E) is off by one for num == 1e+15.\n * <li>Math.floor(Math.log10(num)) is off by one for num == 1e+15 - 1.\n * </ul>\n * @param {number} num A floating point number.\n * @return {number} Its logarithm to base 10 rounded down to the nearest\n *     integer if num > 0. -Infinity if num == 0. NaN if num < 0.\n */\ngoog.math.log10Floor = function(num) {\n  if (num > 0) {\n    var x = Math.round(Math.log(num) * Math.LOG10E);\n    return x - (parseFloat('1e' + x) > num ? 1 : 0);\n  }\n  return num == 0 ? -Infinity : NaN;\n};\n\n\n/**\n * A tweaked variant of {@code Math.floor} which tolerates if the passed number\n * is infinitesimally smaller than the closest integer. It often happens with\n * the results of floating point calculations because of the finite precision\n * of the intermediate results. For example {@code Math.floor(Math.log(1000) /\n * Math.LN10) == 2}, not 3 as one would expect.\n * @param {number} num A number.\n * @param {number=} opt_epsilon An infinitesimally small positive number, the\n *     rounding error to tolerate.\n * @return {number} The largest integer less than or equal to {@code num}.\n */\ngoog.math.safeFloor = function(num, opt_epsilon) {\n  goog.asserts.assert(!goog.isDef(opt_epsilon) || opt_epsilon > 0);\n  return Math.floor(num + (opt_epsilon || 2e-15));\n};\n\n\n/**\n * A tweaked variant of {@code Math.ceil}. See {@code goog.math.safeFloor} for\n * details.\n * @param {number} num A number.\n * @param {number=} opt_epsilon An infinitesimally small positive number, the\n *     rounding error to tolerate.\n * @return {number} The smallest integer greater than or equal to {@code num}.\n */\ngoog.math.safeCeil = function(num, opt_epsilon) {\n  goog.asserts.assert(!goog.isDef(opt_epsilon) || opt_epsilon > 0);\n  return Math.ceil(num - (opt_epsilon || 2e-15));\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A utility class for representing two-dimensional positions.\n */\n\n\ngoog.provide('goog.math.Coordinate');\n\ngoog.require('goog.math');\n\n\n\n/**\n * Class for representing coordinates and positions.\n * @param {number=} opt_x Left, defaults to 0.\n * @param {number=} opt_y Top, defaults to 0.\n * @struct\n * @constructor\n */\ngoog.math.Coordinate = function(opt_x, opt_y) {\n  /**\n   * X-value\n   * @type {number}\n   */\n  this.x = goog.isDef(opt_x) ? opt_x : 0;\n\n  /**\n   * Y-value\n   * @type {number}\n   */\n  this.y = goog.isDef(opt_y) ? opt_y : 0;\n};\n\n\n/**\n * Returns a new copy of the coordinate.\n * @return {!goog.math.Coordinate} A clone of this coordinate.\n */\ngoog.math.Coordinate.prototype.clone = function() {\n  return new goog.math.Coordinate(this.x, this.y);\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a nice string representing the coordinate.\n   * @return {string} In the form (50, 73).\n   * @override\n   */\n  goog.math.Coordinate.prototype.toString = function() {\n    return '(' + this.x + ', ' + this.y + ')';\n  };\n}\n\n\n/**\n * Returns whether the specified value is equal to this coordinate.\n * @param {*} other Some other value.\n * @return {boolean} Whether the specified value is equal to this coordinate.\n */\ngoog.math.Coordinate.prototype.equals = function(other) {\n  return other instanceof goog.math.Coordinate &&\n      goog.math.Coordinate.equals(this, other);\n};\n\n\n/**\n * Compares coordinates for equality.\n * @param {goog.math.Coordinate} a A Coordinate.\n * @param {goog.math.Coordinate} b A Coordinate.\n * @return {boolean} True iff the coordinates are equal, or if both are null.\n */\ngoog.math.Coordinate.equals = function(a, b) {\n  if (a == b) {\n    return true;\n  }\n  if (!a || !b) {\n    return false;\n  }\n  return a.x == b.x && a.y == b.y;\n};\n\n\n/**\n * Returns the distance between two coordinates.\n * @param {!goog.math.Coordinate} a A Coordinate.\n * @param {!goog.math.Coordinate} b A Coordinate.\n * @return {number} The distance between {@code a} and {@code b}.\n */\ngoog.math.Coordinate.distance = function(a, b) {\n  var dx = a.x - b.x;\n  var dy = a.y - b.y;\n  return Math.sqrt(dx * dx + dy * dy);\n};\n\n\n/**\n * Returns the magnitude of a coordinate.\n * @param {!goog.math.Coordinate} a A Coordinate.\n * @return {number} The distance between the origin and {@code a}.\n */\ngoog.math.Coordinate.magnitude = function(a) {\n  return Math.sqrt(a.x * a.x + a.y * a.y);\n};\n\n\n/**\n * Returns the angle from the origin to a coordinate.\n * @param {!goog.math.Coordinate} a A Coordinate.\n * @return {number} The angle, in degrees, clockwise from the positive X\n *     axis to {@code a}.\n */\ngoog.math.Coordinate.azimuth = function(a) {\n  return goog.math.angle(0, 0, a.x, a.y);\n};\n\n\n/**\n * Returns the squared distance between two coordinates. Squared distances can\n * be used for comparisons when the actual value is not required.\n *\n * Performance note: eliminating the square root is an optimization often used\n * in lower-level languages, but the speed difference is not nearly as\n * pronounced in JavaScript (only a few percent.)\n *\n * @param {!goog.math.Coordinate} a A Coordinate.\n * @param {!goog.math.Coordinate} b A Coordinate.\n * @return {number} The squared distance between {@code a} and {@code b}.\n */\ngoog.math.Coordinate.squaredDistance = function(a, b) {\n  var dx = a.x - b.x;\n  var dy = a.y - b.y;\n  return dx * dx + dy * dy;\n};\n\n\n/**\n * Returns the difference between two coordinates as a new\n * goog.math.Coordinate.\n * @param {!goog.math.Coordinate} a A Coordinate.\n * @param {!goog.math.Coordinate} b A Coordinate.\n * @return {!goog.math.Coordinate} A Coordinate representing the difference\n *     between {@code a} and {@code b}.\n */\ngoog.math.Coordinate.difference = function(a, b) {\n  return new goog.math.Coordinate(a.x - b.x, a.y - b.y);\n};\n\n\n/**\n * Returns the sum of two coordinates as a new goog.math.Coordinate.\n * @param {!goog.math.Coordinate} a A Coordinate.\n * @param {!goog.math.Coordinate} b A Coordinate.\n * @return {!goog.math.Coordinate} A Coordinate representing the sum of the two\n *     coordinates.\n */\ngoog.math.Coordinate.sum = function(a, b) {\n  return new goog.math.Coordinate(a.x + b.x, a.y + b.y);\n};\n\n\n/**\n * Rounds the x and y fields to the next larger integer values.\n * @return {!goog.math.Coordinate} This coordinate with ceil'd fields.\n */\ngoog.math.Coordinate.prototype.ceil = function() {\n  this.x = Math.ceil(this.x);\n  this.y = Math.ceil(this.y);\n  return this;\n};\n\n\n/**\n * Rounds the x and y fields to the next smaller integer values.\n * @return {!goog.math.Coordinate} This coordinate with floored fields.\n */\ngoog.math.Coordinate.prototype.floor = function() {\n  this.x = Math.floor(this.x);\n  this.y = Math.floor(this.y);\n  return this;\n};\n\n\n/**\n * Rounds the x and y fields to the nearest integer values.\n * @return {!goog.math.Coordinate} This coordinate with rounded fields.\n */\ngoog.math.Coordinate.prototype.round = function() {\n  this.x = Math.round(this.x);\n  this.y = Math.round(this.y);\n  return this;\n};\n\n\n/**\n * Translates this box by the given offsets. If a {@code goog.math.Coordinate}\n * is given, then the x and y values are translated by the coordinate's x and y.\n * Otherwise, x and y are translated by {@code tx} and {@code opt_ty}\n * respectively.\n * @param {number|goog.math.Coordinate} tx The value to translate x by or the\n *     the coordinate to translate this coordinate by.\n * @param {number=} opt_ty The value to translate y by.\n * @return {!goog.math.Coordinate} This coordinate after translating.\n */\ngoog.math.Coordinate.prototype.translate = function(tx, opt_ty) {\n  if (tx instanceof goog.math.Coordinate) {\n    this.x += tx.x;\n    this.y += tx.y;\n  } else {\n    this.x += Number(tx);\n    if (goog.isNumber(opt_ty)) {\n      this.y += opt_ty;\n    }\n  }\n  return this;\n};\n\n\n/**\n * Scales this coordinate by the given scale factors. The x and y values are\n * scaled by {@code sx} and {@code opt_sy} respectively.  If {@code opt_sy}\n * is not given, then {@code sx} is used for both x and y.\n * @param {number} sx The scale factor to use for the x dimension.\n * @param {number=} opt_sy The scale factor to use for the y dimension.\n * @return {!goog.math.Coordinate} This coordinate after scaling.\n */\ngoog.math.Coordinate.prototype.scale = function(sx, opt_sy) {\n  var sy = goog.isNumber(opt_sy) ? opt_sy : sx;\n  this.x *= sx;\n  this.y *= sy;\n  return this;\n};\n\n\n/**\n * Rotates this coordinate clockwise about the origin (or, optionally, the given\n * center) by the given angle, in radians.\n * @param {number} radians The angle by which to rotate this coordinate\n *     clockwise about the given center, in radians.\n * @param {!goog.math.Coordinate=} opt_center The center of rotation. Defaults\n *     to (0, 0) if not given.\n */\ngoog.math.Coordinate.prototype.rotateRadians = function(radians, opt_center) {\n  var center = opt_center || new goog.math.Coordinate(0, 0);\n\n  var x = this.x;\n  var y = this.y;\n  var cos = Math.cos(radians);\n  var sin = Math.sin(radians);\n\n  this.x = (x - center.x) * cos - (y - center.y) * sin + center.x;\n  this.y = (x - center.x) * sin + (y - center.y) * cos + center.y;\n};\n\n\n/**\n * Rotates this coordinate clockwise about the origin (or, optionally, the given\n * center) by the given angle, in degrees.\n * @param {number} degrees The angle by which to rotate this coordinate\n *     clockwise about the given center, in degrees.\n * @param {!goog.math.Coordinate=} opt_center The center of rotation. Defaults\n *     to (0, 0) if not given.\n */\ngoog.math.Coordinate.prototype.rotateDegrees = function(degrees, opt_center) {\n  this.rotateRadians(goog.math.toRadians(degrees), opt_center);\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A utility class for representing a numeric box.\n */\n\n\ngoog.provide('goog.math.Box');\n\ngoog.require('goog.asserts');\ngoog.require('goog.math.Coordinate');\n\n\n\n/**\n * Class for representing a box. A box is specified as a top, right, bottom,\n * and left. A box is useful for representing margins and padding.\n *\n * This class assumes 'screen coordinates': larger Y coordinates are further\n * from the top of the screen.\n *\n * @param {number} top Top.\n * @param {number} right Right.\n * @param {number} bottom Bottom.\n * @param {number} left Left.\n * @struct\n * @constructor\n */\ngoog.math.Box = function(top, right, bottom, left) {\n  /**\n   * Top\n   * @type {number}\n   */\n  this.top = top;\n\n  /**\n   * Right\n   * @type {number}\n   */\n  this.right = right;\n\n  /**\n   * Bottom\n   * @type {number}\n   */\n  this.bottom = bottom;\n\n  /**\n   * Left\n   * @type {number}\n   */\n  this.left = left;\n};\n\n\n/**\n * Creates a Box by bounding a collection of goog.math.Coordinate objects\n * @param {...goog.math.Coordinate} var_args Coordinates to be included inside\n *     the box.\n * @return {!goog.math.Box} A Box containing all the specified Coordinates.\n */\ngoog.math.Box.boundingBox = function(var_args) {\n  var box = new goog.math.Box(\n      arguments[0].y, arguments[0].x, arguments[0].y, arguments[0].x);\n  for (var i = 1; i < arguments.length; i++) {\n    box.expandToIncludeCoordinate(arguments[i]);\n  }\n  return box;\n};\n\n\n/**\n * @return {number} width The width of this Box.\n */\ngoog.math.Box.prototype.getWidth = function() {\n  return this.right - this.left;\n};\n\n\n/**\n * @return {number} height The height of this Box.\n */\ngoog.math.Box.prototype.getHeight = function() {\n  return this.bottom - this.top;\n};\n\n\n/**\n * Creates a copy of the box with the same dimensions.\n * @return {!goog.math.Box} A clone of this Box.\n */\ngoog.math.Box.prototype.clone = function() {\n  return new goog.math.Box(this.top, this.right, this.bottom, this.left);\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a nice string representing the box.\n   * @return {string} In the form (50t, 73r, 24b, 13l).\n   * @override\n   */\n  goog.math.Box.prototype.toString = function() {\n    return '(' + this.top + 't, ' + this.right + 'r, ' + this.bottom + 'b, ' +\n        this.left + 'l)';\n  };\n}\n\n\n/**\n * Returns whether the box contains a coordinate or another box.\n *\n * @param {goog.math.Coordinate|goog.math.Box} other A Coordinate or a Box.\n * @return {boolean} Whether the box contains the coordinate or other box.\n */\ngoog.math.Box.prototype.contains = function(other) {\n  return goog.math.Box.contains(this, other);\n};\n\n\n/**\n * Expands box with the given margins.\n *\n * @param {number|goog.math.Box} top Top margin or box with all margins.\n * @param {number=} opt_right Right margin.\n * @param {number=} opt_bottom Bottom margin.\n * @param {number=} opt_left Left margin.\n * @return {!goog.math.Box} A reference to this Box.\n */\ngoog.math.Box.prototype.expand = function(\n    top, opt_right, opt_bottom, opt_left) {\n  if (goog.isObject(top)) {\n    this.top -= top.top;\n    this.right += top.right;\n    this.bottom += top.bottom;\n    this.left -= top.left;\n  } else {\n    this.top -= /** @type {number} */ (top);\n    this.right += Number(opt_right);\n    this.bottom += Number(opt_bottom);\n    this.left -= Number(opt_left);\n  }\n\n  return this;\n};\n\n\n/**\n * Expand this box to include another box.\n * NOTE(user): This is used in code that needs to be very fast, please don't\n * add functionality to this function at the expense of speed (variable\n * arguments, accepting multiple argument types, etc).\n * @param {goog.math.Box} box The box to include in this one.\n */\ngoog.math.Box.prototype.expandToInclude = function(box) {\n  this.left = Math.min(this.left, box.left);\n  this.top = Math.min(this.top, box.top);\n  this.right = Math.max(this.right, box.right);\n  this.bottom = Math.max(this.bottom, box.bottom);\n};\n\n\n/**\n * Expand this box to include the coordinate.\n * @param {!goog.math.Coordinate} coord The coordinate to be included\n *     inside the box.\n */\ngoog.math.Box.prototype.expandToIncludeCoordinate = function(coord) {\n  this.top = Math.min(this.top, coord.y);\n  this.right = Math.max(this.right, coord.x);\n  this.bottom = Math.max(this.bottom, coord.y);\n  this.left = Math.min(this.left, coord.x);\n};\n\n\n/**\n * Compares boxes for equality.\n * @param {goog.math.Box} a A Box.\n * @param {goog.math.Box} b A Box.\n * @return {boolean} True iff the boxes are equal, or if both are null.\n */\ngoog.math.Box.equals = function(a, b) {\n  if (a == b) {\n    return true;\n  }\n  if (!a || !b) {\n    return false;\n  }\n  return a.top == b.top && a.right == b.right && a.bottom == b.bottom &&\n      a.left == b.left;\n};\n\n\n/**\n * Returns whether a box contains a coordinate or another box.\n *\n * @param {goog.math.Box} box A Box.\n * @param {goog.math.Coordinate|goog.math.Box} other A Coordinate or a Box.\n * @return {boolean} Whether the box contains the coordinate or other box.\n */\ngoog.math.Box.contains = function(box, other) {\n  if (!box || !other) {\n    return false;\n  }\n\n  if (other instanceof goog.math.Box) {\n    return other.left >= box.left && other.right <= box.right &&\n        other.top >= box.top && other.bottom <= box.bottom;\n  }\n\n  // other is a Coordinate.\n  return other.x >= box.left && other.x <= box.right && other.y >= box.top &&\n      other.y <= box.bottom;\n};\n\n\n/**\n * Returns the relative x position of a coordinate compared to a box.  Returns\n * zero if the coordinate is inside the box.\n *\n * @param {goog.math.Box} box A Box.\n * @param {goog.math.Coordinate} coord A Coordinate.\n * @return {number} The x position of {@code coord} relative to the nearest\n *     side of {@code box}, or zero if {@code coord} is inside {@code box}.\n */\ngoog.math.Box.relativePositionX = function(box, coord) {\n  if (coord.x < box.left) {\n    return coord.x - box.left;\n  } else if (coord.x > box.right) {\n    return coord.x - box.right;\n  }\n  return 0;\n};\n\n\n/**\n * Returns the relative y position of a coordinate compared to a box.  Returns\n * zero if the coordinate is inside the box.\n *\n * @param {goog.math.Box} box A Box.\n * @param {goog.math.Coordinate} coord A Coordinate.\n * @return {number} The y position of {@code coord} relative to the nearest\n *     side of {@code box}, or zero if {@code coord} is inside {@code box}.\n */\ngoog.math.Box.relativePositionY = function(box, coord) {\n  if (coord.y < box.top) {\n    return coord.y - box.top;\n  } else if (coord.y > box.bottom) {\n    return coord.y - box.bottom;\n  }\n  return 0;\n};\n\n\n/**\n * Returns the distance between a coordinate and the nearest corner/side of a\n * box. Returns zero if the coordinate is inside the box.\n *\n * @param {goog.math.Box} box A Box.\n * @param {goog.math.Coordinate} coord A Coordinate.\n * @return {number} The distance between {@code coord} and the nearest\n *     corner/side of {@code box}, or zero if {@code coord} is inside\n *     {@code box}.\n */\ngoog.math.Box.distance = function(box, coord) {\n  var x = goog.math.Box.relativePositionX(box, coord);\n  var y = goog.math.Box.relativePositionY(box, coord);\n  return Math.sqrt(x * x + y * y);\n};\n\n\n/**\n * Returns whether two boxes intersect.\n *\n * @param {goog.math.Box} a A Box.\n * @param {goog.math.Box} b A second Box.\n * @return {boolean} Whether the boxes intersect.\n */\ngoog.math.Box.intersects = function(a, b) {\n  return (\n      a.left <= b.right && b.left <= a.right && a.top <= b.bottom &&\n      b.top <= a.bottom);\n};\n\n\n/**\n * Returns whether two boxes would intersect with additional padding.\n *\n * @param {goog.math.Box} a A Box.\n * @param {goog.math.Box} b A second Box.\n * @param {number} padding The additional padding.\n * @return {boolean} Whether the boxes intersect.\n */\ngoog.math.Box.intersectsWithPadding = function(a, b, padding) {\n  return (\n      a.left <= b.right + padding && b.left <= a.right + padding &&\n      a.top <= b.bottom + padding && b.top <= a.bottom + padding);\n};\n\n\n/**\n * Rounds the fields to the next larger integer values.\n *\n * @return {!goog.math.Box} This box with ceil'd fields.\n */\ngoog.math.Box.prototype.ceil = function() {\n  this.top = Math.ceil(this.top);\n  this.right = Math.ceil(this.right);\n  this.bottom = Math.ceil(this.bottom);\n  this.left = Math.ceil(this.left);\n  return this;\n};\n\n\n/**\n * Rounds the fields to the next smaller integer values.\n *\n * @return {!goog.math.Box} This box with floored fields.\n */\ngoog.math.Box.prototype.floor = function() {\n  this.top = Math.floor(this.top);\n  this.right = Math.floor(this.right);\n  this.bottom = Math.floor(this.bottom);\n  this.left = Math.floor(this.left);\n  return this;\n};\n\n\n/**\n * Rounds the fields to nearest integer values.\n *\n * @return {!goog.math.Box} This box with rounded fields.\n */\ngoog.math.Box.prototype.round = function() {\n  this.top = Math.round(this.top);\n  this.right = Math.round(this.right);\n  this.bottom = Math.round(this.bottom);\n  this.left = Math.round(this.left);\n  return this;\n};\n\n\n/**\n * Translates this box by the given offsets. If a {@code goog.math.Coordinate}\n * is given, then the left and right values are translated by the coordinate's\n * x value and the top and bottom values are translated by the coordinate's y\n * value.  Otherwise, {@code tx} and {@code opt_ty} are used to translate the x\n * and y dimension values.\n *\n * @param {number|goog.math.Coordinate} tx The value to translate the x\n *     dimension values by or the the coordinate to translate this box by.\n * @param {number=} opt_ty The value to translate y dimension values by.\n * @return {!goog.math.Box} This box after translating.\n */\ngoog.math.Box.prototype.translate = function(tx, opt_ty) {\n  if (tx instanceof goog.math.Coordinate) {\n    this.left += tx.x;\n    this.right += tx.x;\n    this.top += tx.y;\n    this.bottom += tx.y;\n  } else {\n    goog.asserts.assertNumber(tx);\n    this.left += tx;\n    this.right += tx;\n    if (goog.isNumber(opt_ty)) {\n      this.top += opt_ty;\n      this.bottom += opt_ty;\n    }\n  }\n  return this;\n};\n\n\n/**\n * Scales this coordinate by the given scale factors. The x and y dimension\n * values are scaled by {@code sx} and {@code opt_sy} respectively.\n * If {@code opt_sy} is not given, then {@code sx} is used for both x and y.\n *\n * @param {number} sx The scale factor to use for the x dimension.\n * @param {number=} opt_sy The scale factor to use for the y dimension.\n * @return {!goog.math.Box} This box after scaling.\n */\ngoog.math.Box.prototype.scale = function(sx, opt_sy) {\n  var sy = goog.isNumber(opt_sy) ? opt_sy : sx;\n  this.left *= sx;\n  this.right *= sx;\n  this.top *= sy;\n  this.bottom *= sy;\n  return this;\n};\n","// Copyright 2016 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A record declaration to allow ClientRect and other rectangle\n * like objects to be used with goog.math.Rect.\n */\n\ngoog.provide('goog.math.IRect');\n\n\n/**\n * Record for representing rectangular regions, allows compatibility between\n * things like ClientRect and goog.math.Rect.\n *\n * @record\n */\ngoog.math.IRect = function() {};\n\n\n/** @type {number} */\ngoog.math.IRect.prototype.left;\n\n\n/** @type {number} */\ngoog.math.IRect.prototype.top;\n\n\n/** @type {number} */\ngoog.math.IRect.prototype.width;\n\n\n/** @type {number} */\ngoog.math.IRect.prototype.height;\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A utility class for representing two-dimensional sizes.\n * @author brenneman@google.com (Shawn Brenneman)\n */\n\n\ngoog.provide('goog.math.Size');\n\n\n\n/**\n * Class for representing sizes consisting of a width and height. Undefined\n * width and height support is deprecated and results in compiler warning.\n * @param {number} width Width.\n * @param {number} height Height.\n * @struct\n * @constructor\n */\ngoog.math.Size = function(width, height) {\n  /**\n   * Width\n   * @type {number}\n   */\n  this.width = width;\n\n  /**\n   * Height\n   * @type {number}\n   */\n  this.height = height;\n};\n\n\n/**\n * Compares sizes for equality.\n * @param {goog.math.Size} a A Size.\n * @param {goog.math.Size} b A Size.\n * @return {boolean} True iff the sizes have equal widths and equal\n *     heights, or if both are null.\n */\ngoog.math.Size.equals = function(a, b) {\n  if (a == b) {\n    return true;\n  }\n  if (!a || !b) {\n    return false;\n  }\n  return a.width == b.width && a.height == b.height;\n};\n\n\n/**\n * @return {!goog.math.Size} A new copy of the Size.\n */\ngoog.math.Size.prototype.clone = function() {\n  return new goog.math.Size(this.width, this.height);\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a nice string representing size.\n   * @return {string} In the form (50 x 73).\n   * @override\n   */\n  goog.math.Size.prototype.toString = function() {\n    return '(' + this.width + ' x ' + this.height + ')';\n  };\n}\n\n\n/**\n * @return {number} The longer of the two dimensions in the size.\n */\ngoog.math.Size.prototype.getLongest = function() {\n  return Math.max(this.width, this.height);\n};\n\n\n/**\n * @return {number} The shorter of the two dimensions in the size.\n */\ngoog.math.Size.prototype.getShortest = function() {\n  return Math.min(this.width, this.height);\n};\n\n\n/**\n * @return {number} The area of the size (width * height).\n */\ngoog.math.Size.prototype.area = function() {\n  return this.width * this.height;\n};\n\n\n/**\n * @return {number} The perimeter of the size (width + height) * 2.\n */\ngoog.math.Size.prototype.perimeter = function() {\n  return (this.width + this.height) * 2;\n};\n\n\n/**\n * @return {number} The ratio of the size's width to its height.\n */\ngoog.math.Size.prototype.aspectRatio = function() {\n  return this.width / this.height;\n};\n\n\n/**\n * @return {boolean} True if the size has zero area, false if both dimensions\n *     are non-zero numbers.\n */\ngoog.math.Size.prototype.isEmpty = function() {\n  return !this.area();\n};\n\n\n/**\n * Clamps the width and height parameters upward to integer values.\n * @return {!goog.math.Size} This size with ceil'd components.\n */\ngoog.math.Size.prototype.ceil = function() {\n  this.width = Math.ceil(this.width);\n  this.height = Math.ceil(this.height);\n  return this;\n};\n\n\n/**\n * @param {!goog.math.Size} target The target size.\n * @return {boolean} True if this Size is the same size or smaller than the\n *     target size in both dimensions.\n */\ngoog.math.Size.prototype.fitsInside = function(target) {\n  return this.width <= target.width && this.height <= target.height;\n};\n\n\n/**\n * Clamps the width and height parameters downward to integer values.\n * @return {!goog.math.Size} This size with floored components.\n */\ngoog.math.Size.prototype.floor = function() {\n  this.width = Math.floor(this.width);\n  this.height = Math.floor(this.height);\n  return this;\n};\n\n\n/**\n * Rounds the width and height parameters to integer values.\n * @return {!goog.math.Size} This size with rounded components.\n */\ngoog.math.Size.prototype.round = function() {\n  this.width = Math.round(this.width);\n  this.height = Math.round(this.height);\n  return this;\n};\n\n\n/**\n * Scales this size by the given scale factors. The width and height are scaled\n * by {@code sx} and {@code opt_sy} respectively.  If {@code opt_sy} is not\n * given, then {@code sx} is used for both the width and height.\n * @param {number} sx The scale factor to use for the width.\n * @param {number=} opt_sy The scale factor to use for the height.\n * @return {!goog.math.Size} This Size object after scaling.\n */\ngoog.math.Size.prototype.scale = function(sx, opt_sy) {\n  var sy = goog.isNumber(opt_sy) ? opt_sy : sx;\n  this.width *= sx;\n  this.height *= sy;\n  return this;\n};\n\n\n/**\n * Uniformly scales the size to perfectly cover the dimensions of a given size.\n * If the size is already larger than the target, it will be scaled down to the\n * minimum size at which it still covers the entire target. The original aspect\n * ratio will be preserved.\n *\n * This function assumes that both Sizes contain strictly positive dimensions.\n * @param {!goog.math.Size} target The target size.\n * @return {!goog.math.Size} This Size object, after optional scaling.\n */\ngoog.math.Size.prototype.scaleToCover = function(target) {\n  var s = this.aspectRatio() <= target.aspectRatio() ?\n      target.width / this.width :\n      target.height / this.height;\n\n  return this.scale(s);\n};\n\n\n/**\n * Uniformly scales the size to fit inside the dimensions of a given size. The\n * original aspect ratio will be preserved.\n *\n * This function assumes that both Sizes contain strictly positive dimensions.\n * @param {!goog.math.Size} target The target size.\n * @return {!goog.math.Size} This Size object, after optional scaling.\n */\ngoog.math.Size.prototype.scaleToFit = function(target) {\n  var s = this.aspectRatio() > target.aspectRatio() ?\n      target.width / this.width :\n      target.height / this.height;\n\n  return this.scale(s);\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A utility class for representing rectangles. Some of these\n * functions should be migrated over to non-nullable params.\n */\n\ngoog.provide('goog.math.Rect');\n\ngoog.require('goog.asserts');\ngoog.require('goog.math.Box');\ngoog.require('goog.math.Coordinate');\ngoog.require('goog.math.IRect');\ngoog.require('goog.math.Size');\n\n\n\n/**\n * Class for representing rectangular regions.\n * @param {number} x Left.\n * @param {number} y Top.\n * @param {number} w Width.\n * @param {number} h Height.\n * @struct\n * @constructor\n * @implements {goog.math.IRect}\n */\ngoog.math.Rect = function(x, y, w, h) {\n  /** @type {number} */\n  this.left = x;\n\n  /** @type {number} */\n  this.top = y;\n\n  /** @type {number} */\n  this.width = w;\n\n  /** @type {number} */\n  this.height = h;\n};\n\n\n/**\n * @return {!goog.math.Rect} A new copy of this Rectangle.\n */\ngoog.math.Rect.prototype.clone = function() {\n  return new goog.math.Rect(this.left, this.top, this.width, this.height);\n};\n\n\n/**\n * Returns a new Box object with the same position and dimensions as this\n * rectangle.\n * @return {!goog.math.Box} A new Box representation of this Rectangle.\n */\ngoog.math.Rect.prototype.toBox = function() {\n  var right = this.left + this.width;\n  var bottom = this.top + this.height;\n  return new goog.math.Box(this.top, right, bottom, this.left);\n};\n\n\n/**\n * Creates a new Rect object with the position and size given.\n * @param {!goog.math.Coordinate} position The top-left coordinate of the Rect\n * @param {!goog.math.Size} size The size of the Rect\n * @return {!goog.math.Rect} A new Rect initialized with the given position and\n *     size.\n */\ngoog.math.Rect.createFromPositionAndSize = function(position, size) {\n  return new goog.math.Rect(position.x, position.y, size.width, size.height);\n};\n\n\n/**\n * Creates a new Rect object with the same position and dimensions as a given\n * Box.  Note that this is only the inverse of toBox if left/top are defined.\n * @param {goog.math.Box} box A box.\n * @return {!goog.math.Rect} A new Rect initialized with the box's position\n *     and size.\n */\ngoog.math.Rect.createFromBox = function(box) {\n  return new goog.math.Rect(\n      box.left, box.top, box.right - box.left, box.bottom - box.top);\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a nice string representing size and dimensions of rectangle.\n   * @return {string} In the form (50, 73 - 75w x 25h).\n   * @override\n   */\n  goog.math.Rect.prototype.toString = function() {\n    return '(' + this.left + ', ' + this.top + ' - ' + this.width + 'w x ' +\n        this.height + 'h)';\n  };\n}\n\n\n/**\n * Compares rectangles for equality.\n * @param {goog.math.IRect} a A Rectangle.\n * @param {goog.math.IRect} b A Rectangle.\n * @return {boolean} True iff the rectangles have the same left, top, width,\n *     and height, or if both are null.\n */\ngoog.math.Rect.equals = function(a, b) {\n  if (a == b) {\n    return true;\n  }\n  if (!a || !b) {\n    return false;\n  }\n  return a.left == b.left && a.width == b.width && a.top == b.top &&\n      a.height == b.height;\n};\n\n\n/**\n * Computes the intersection of this rectangle and the rectangle parameter.  If\n * there is no intersection, returns false and leaves this rectangle as is.\n * @param {goog.math.IRect} rect A Rectangle.\n * @return {boolean} True iff this rectangle intersects with the parameter.\n */\ngoog.math.Rect.prototype.intersection = function(rect) {\n  var x0 = Math.max(this.left, rect.left);\n  var x1 = Math.min(this.left + this.width, rect.left + rect.width);\n\n  if (x0 <= x1) {\n    var y0 = Math.max(this.top, rect.top);\n    var y1 = Math.min(this.top + this.height, rect.top + rect.height);\n\n    if (y0 <= y1) {\n      this.left = x0;\n      this.top = y0;\n      this.width = x1 - x0;\n      this.height = y1 - y0;\n\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Returns the intersection of two rectangles. Two rectangles intersect if they\n * touch at all, for example, two zero width and height rectangles would\n * intersect if they had the same top and left.\n * @param {goog.math.IRect} a A Rectangle.\n * @param {goog.math.IRect} b A Rectangle.\n * @return {goog.math.Rect} A new intersection rect (even if width and height\n *     are 0), or null if there is no intersection.\n */\ngoog.math.Rect.intersection = function(a, b) {\n  // There is no nice way to do intersection via a clone, because any such\n  // clone might be unnecessary if this function returns null.  So, we duplicate\n  // code from above.\n\n  var x0 = Math.max(a.left, b.left);\n  var x1 = Math.min(a.left + a.width, b.left + b.width);\n\n  if (x0 <= x1) {\n    var y0 = Math.max(a.top, b.top);\n    var y1 = Math.min(a.top + a.height, b.top + b.height);\n\n    if (y0 <= y1) {\n      return new goog.math.Rect(x0, y0, x1 - x0, y1 - y0);\n    }\n  }\n  return null;\n};\n\n\n/**\n * Returns whether two rectangles intersect. Two rectangles intersect if they\n * touch at all, for example, two zero width and height rectangles would\n * intersect if they had the same top and left.\n * @param {goog.math.IRect} a A Rectangle.\n * @param {goog.math.IRect} b A Rectangle.\n * @return {boolean} Whether a and b intersect.\n */\ngoog.math.Rect.intersects = function(a, b) {\n  return (\n      a.left <= b.left + b.width && b.left <= a.left + a.width &&\n      a.top <= b.top + b.height && b.top <= a.top + a.height);\n};\n\n\n/**\n * Returns whether a rectangle intersects this rectangle.\n * @param {goog.math.IRect} rect A rectangle.\n * @return {boolean} Whether rect intersects this rectangle.\n */\ngoog.math.Rect.prototype.intersects = function(rect) {\n  return goog.math.Rect.intersects(this, rect);\n};\n\n\n/**\n * Computes the difference regions between two rectangles. The return value is\n * an array of 0 to 4 rectangles defining the remaining regions of the first\n * rectangle after the second has been subtracted.\n * @param {goog.math.Rect} a A Rectangle.\n * @param {goog.math.IRect} b A Rectangle.\n * @return {!Array<!goog.math.Rect>} An array with 0 to 4 rectangles which\n *     together define the difference area of rectangle a minus rectangle b.\n */\ngoog.math.Rect.difference = function(a, b) {\n  var intersection = goog.math.Rect.intersection(a, b);\n  if (!intersection || !intersection.height || !intersection.width) {\n    return [a.clone()];\n  }\n\n  var result = [];\n\n  var top = a.top;\n  var height = a.height;\n\n  var ar = a.left + a.width;\n  var ab = a.top + a.height;\n\n  var br = b.left + b.width;\n  var bb = b.top + b.height;\n\n  // Subtract off any area on top where A extends past B\n  if (b.top > a.top) {\n    result.push(new goog.math.Rect(a.left, a.top, a.width, b.top - a.top));\n    top = b.top;\n    // If we're moving the top down, we also need to subtract the height diff.\n    height -= b.top - a.top;\n  }\n  // Subtract off any area on bottom where A extends past B\n  if (bb < ab) {\n    result.push(new goog.math.Rect(a.left, bb, a.width, ab - bb));\n    height = bb - top;\n  }\n  // Subtract any area on left where A extends past B\n  if (b.left > a.left) {\n    result.push(new goog.math.Rect(a.left, top, b.left - a.left, height));\n  }\n  // Subtract any area on right where A extends past B\n  if (br < ar) {\n    result.push(new goog.math.Rect(br, top, ar - br, height));\n  }\n\n  return result;\n};\n\n\n/**\n * Computes the difference regions between this rectangle and {@code rect}. The\n * return value is an array of 0 to 4 rectangles defining the remaining regions\n * of this rectangle after the other has been subtracted.\n * @param {goog.math.IRect} rect A Rectangle.\n * @return {!Array<!goog.math.Rect>} An array with 0 to 4 rectangles which\n *     together define the difference area of rectangle a minus rectangle b.\n */\ngoog.math.Rect.prototype.difference = function(rect) {\n  return goog.math.Rect.difference(this, rect);\n};\n\n\n/**\n * Expand this rectangle to also include the area of the given rectangle.\n * @param {goog.math.IRect} rect The other rectangle.\n */\ngoog.math.Rect.prototype.boundingRect = function(rect) {\n  // We compute right and bottom before we change left and top below.\n  var right = Math.max(this.left + this.width, rect.left + rect.width);\n  var bottom = Math.max(this.top + this.height, rect.top + rect.height);\n\n  this.left = Math.min(this.left, rect.left);\n  this.top = Math.min(this.top, rect.top);\n\n  this.width = right - this.left;\n  this.height = bottom - this.top;\n};\n\n\n/**\n * Returns a new rectangle which completely contains both input rectangles.\n * @param {goog.math.IRect} a A rectangle.\n * @param {goog.math.IRect} b A rectangle.\n * @return {goog.math.Rect} A new bounding rect, or null if either rect is\n *     null.\n */\ngoog.math.Rect.boundingRect = function(a, b) {\n  if (!a || !b) {\n    return null;\n  }\n\n  var newRect = new goog.math.Rect(a.left, a.top, a.width, a.height);\n  newRect.boundingRect(b);\n\n  return newRect;\n};\n\n\n/**\n * Tests whether this rectangle entirely contains another rectangle or\n * coordinate.\n *\n * @param {goog.math.IRect|goog.math.Coordinate} another The rectangle or\n *     coordinate to test for containment.\n * @return {boolean} Whether this rectangle contains given rectangle or\n *     coordinate.\n */\ngoog.math.Rect.prototype.contains = function(another) {\n  if (another instanceof goog.math.Coordinate) {\n    return another.x >= this.left && another.x <= this.left + this.width &&\n        another.y >= this.top && another.y <= this.top + this.height;\n  } else {  // (another instanceof goog.math.IRect)\n    return this.left <= another.left &&\n        this.left + this.width >= another.left + another.width &&\n        this.top <= another.top &&\n        this.top + this.height >= another.top + another.height;\n  }\n};\n\n\n/**\n * @param {!goog.math.Coordinate} point A coordinate.\n * @return {number} The squared distance between the point and the closest\n *     point inside the rectangle. Returns 0 if the point is inside the\n *     rectangle.\n */\ngoog.math.Rect.prototype.squaredDistance = function(point) {\n  var dx = point.x < this.left ?\n      this.left - point.x :\n      Math.max(point.x - (this.left + this.width), 0);\n  var dy = point.y < this.top ? this.top - point.y :\n                                Math.max(point.y - (this.top + this.height), 0);\n  return dx * dx + dy * dy;\n};\n\n\n/**\n * @param {!goog.math.Coordinate} point A coordinate.\n * @return {number} The distance between the point and the closest point\n *     inside the rectangle. Returns 0 if the point is inside the rectangle.\n */\ngoog.math.Rect.prototype.distance = function(point) {\n  return Math.sqrt(this.squaredDistance(point));\n};\n\n\n/**\n * @return {!goog.math.Size} The size of this rectangle.\n */\ngoog.math.Rect.prototype.getSize = function() {\n  return new goog.math.Size(this.width, this.height);\n};\n\n\n/**\n * @return {!goog.math.Coordinate} A new coordinate for the top-left corner of\n *     the rectangle.\n */\ngoog.math.Rect.prototype.getTopLeft = function() {\n  return new goog.math.Coordinate(this.left, this.top);\n};\n\n\n/**\n * @return {!goog.math.Coordinate} A new coordinate for the center of the\n *     rectangle.\n */\ngoog.math.Rect.prototype.getCenter = function() {\n  return new goog.math.Coordinate(\n      this.left + this.width / 2, this.top + this.height / 2);\n};\n\n\n/**\n * @return {!goog.math.Coordinate} A new coordinate for the bottom-right corner\n *     of the rectangle.\n */\ngoog.math.Rect.prototype.getBottomRight = function() {\n  return new goog.math.Coordinate(\n      this.left + this.width, this.top + this.height);\n};\n\n\n/**\n * Rounds the fields to the next larger integer values.\n * @return {!goog.math.Rect} This rectangle with ceil'd fields.\n */\ngoog.math.Rect.prototype.ceil = function() {\n  this.left = Math.ceil(this.left);\n  this.top = Math.ceil(this.top);\n  this.width = Math.ceil(this.width);\n  this.height = Math.ceil(this.height);\n  return this;\n};\n\n\n/**\n * Rounds the fields to the next smaller integer values.\n * @return {!goog.math.Rect} This rectangle with floored fields.\n */\ngoog.math.Rect.prototype.floor = function() {\n  this.left = Math.floor(this.left);\n  this.top = Math.floor(this.top);\n  this.width = Math.floor(this.width);\n  this.height = Math.floor(this.height);\n  return this;\n};\n\n\n/**\n * Rounds the fields to nearest integer values.\n * @return {!goog.math.Rect} This rectangle with rounded fields.\n */\ngoog.math.Rect.prototype.round = function() {\n  this.left = Math.round(this.left);\n  this.top = Math.round(this.top);\n  this.width = Math.round(this.width);\n  this.height = Math.round(this.height);\n  return this;\n};\n\n\n/**\n * Translates this rectangle by the given offsets. If a\n * {@code goog.math.Coordinate} is given, then the left and top values are\n * translated by the coordinate's x and y values. Otherwise, top and left are\n * translated by {@code tx} and {@code opt_ty} respectively.\n * @param {number|goog.math.Coordinate} tx The value to translate left by or the\n *     the coordinate to translate this rect by.\n * @param {number=} opt_ty The value to translate top by.\n * @return {!goog.math.Rect} This rectangle after translating.\n */\ngoog.math.Rect.prototype.translate = function(tx, opt_ty) {\n  if (tx instanceof goog.math.Coordinate) {\n    this.left += tx.x;\n    this.top += tx.y;\n  } else {\n    this.left += goog.asserts.assertNumber(tx);\n    if (goog.isNumber(opt_ty)) {\n      this.top += opt_ty;\n    }\n  }\n  return this;\n};\n\n\n/**\n * Scales this rectangle by the given scale factors. The left and width values\n * are scaled by {@code sx} and the top and height values are scaled by\n * {@code opt_sy}.  If {@code opt_sy} is not given, then all fields are scaled\n * by {@code sx}.\n * @param {number} sx The scale factor to use for the x dimension.\n * @param {number=} opt_sy The scale factor to use for the y dimension.\n * @return {!goog.math.Rect} This rectangle after scaling.\n */\ngoog.math.Rect.prototype.scale = function(sx, opt_sy) {\n  var sy = goog.isNumber(opt_sy) ? opt_sy : sx;\n  this.left *= sx;\n  this.width *= sx;\n  this.top *= sy;\n  this.height *= sy;\n  return this;\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Object representing a trash can icon.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Trashcan');\n\ngoog.require('goog.math.Rect');\n\n\n/**\n * Class for a trash can.\n * @param {!Blockly.BlockSpace} blockSpace The blockSpace to sit in.\n * @constructor\n */\nBlockly.Trashcan = function(blockSpace) {\n  this.blockSpace_ = blockSpace;\n};\n\n/**\n * URL of the trashcan image (minus lid).\n * @type {string}\n * @private\n */\nBlockly.Trashcan.CLOSED_URL_ = 'media/canclosed.png';\n\n/**\n * URL of the lid image.\n * @type {string}\n * @private\n */\nBlockly.Trashcan.OPEN_URL_ = 'media/canopen.png';\n\n/**\n * Width of both the trash can and lid images.\n * @type {number}\n * @private\n */\nBlockly.Trashcan.WIDTH_ = 70;\n\n/**\n * Height of the trashcan image in pixels.\n * @type {number}\n * @private\n */\nBlockly.Trashcan.HEIGHT_ = 70;\n\n/**\n * Distance between trashcan and top edge of blockSpace in pixels.\n * @type {number}\n * @private\n */\nBlockly.Trashcan.MARGIN_TOP_ = 15;\n\n/**\n * Distance between trashcan and right edge of blockSpace in pixels.\n * @type {number}\n * @private\n */\nBlockly.Trashcan.MARGIN_SIDE_ = 22;\n\n\n/**\n* Extent of hotspot on all sides beyond the size of the image.\n* @type {number}\n* @private\n*/\nBlockly.Trashcan.MARGIN_HOTSPOT_ = 25;\n\n/**\n * Current open/close state of the lid.\n * @type {boolean}\n */\nBlockly.Trashcan.prototype.isOpen = false;\n\n/**\n * Additional radius of the trashcan; used in determining the open/closed\n * state of the lid\n * @type {number}\n */\nBlockly.Trashcan.prototype.radius = 50;\n\n/**\n * The SVG group containing the trash can.\n * @type {Element}\n * @private\n */\nBlockly.Trashcan.prototype.svgGroup_ = null;\n\n/**\n * The SVG image element of the closed trash can.\n * @type {Element}\n * @private\n */\nBlockly.Trashcan.prototype.svgClosedCan_ = null;\n\n/**\n * The SVG image element of the open trash can.\n * @type {Element}\n * @private\n */\nBlockly.Trashcan.prototype.svgOpenCan_ = null;\n\n/**\n * Left coordinate of the trash can.\n * @type {number}\n * @private\n */\nBlockly.Trashcan.prototype.left_ = 0;\n\n/**\n * Top coordinate of the trash can.\n * @type {number}\n * @private\n */\nBlockly.Trashcan.prototype.top_ = 0;\n\n/**\n * Create the trash can elements.\n * @return {!Element} The trash can's SVG group.\n */\nBlockly.Trashcan.prototype.createDom = function() {\n  /*\n  <g filter=\"url(#blocklyTrashcanShadowFilter)\">\n    <image width=\"100\" height=\"100\" href=\"media/canclosed.png\"></image>\n    <image width=\"100\" height=\"100\" visibility=\"hidden\" href=\"media/canopen.png\"></image>\n  </g>\n  */\n  this.svgGroup_ = Blockly.createSvgElement('g',\n      {'id': 'trashcan', 'filter': Blockly.isPortrait? '' : 'url(#blocklyTrashcanShadowFilter)'}, null);\n  this.svgClosedCan_ = Blockly.createSvgElement('image',\n      {'width': Blockly.Trashcan.WIDTH_, 'height': Blockly.Trashcan.HEIGHT_},\n      this.svgGroup_);\n  this.svgClosedCan_.setAttributeNS(\n      'http://www.w3.org/1999/xlink', 'xlink:href',\n      Blockly.assetUrl(Blockly.Trashcan.CLOSED_URL_));\n  this.svgOpenCan_ = Blockly.createSvgElement('image',\n      {'width': Blockly.Trashcan.WIDTH_, 'height': Blockly.Trashcan.HEIGHT_},\n      this.svgGroup_);\n  this.svgOpenCan_.setAttribute('visibility', 'hidden');\n  this.svgOpenCan_.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href',\n      Blockly.assetUrl(Blockly.Trashcan.OPEN_URL_));\n  this.notAllowed_ = Blockly.createSvgElement('g', {}, this.svgGroup_);\n  Blockly.createSvgElement('line',\n      {x1: 15, y1: 15, x2: 55, y2: 55, stroke: '#c00', 'stroke-width': 5}, this.notAllowed_);\n  Blockly.createSvgElement('circle',\n    {cx: 36, cy: 34, r: 28, stroke: '#c00', 'stroke-width': 5, fill: 'none'}, this.notAllowed_);\n  this.notAllowed_.setAttribute('visibility', 'hidden');\n  return this.svgGroup_;\n};\n\n\nBlockly.Trashcan.prototype.getRect = function() {\n  if (!this.svgGroup_) {\n    return null;\n  }\n\n  var trashRect = this.svgGroup_.getBoundingClientRect();\n  var left = trashRect.left ;\n  var top = trashRect.top ;\n  var width = Blockly.Trashcan.WIDTH_ + 2 * Blockly.Trashcan.MARGIN_HOTSPOT_;\n  var height = Blockly.Trashcan.HEIGHT_ + 2 * Blockly.Trashcan.MARGIN_HOTSPOT_;\n  return new goog.math.Rect(left, top, width, height);\n\n};\n\n/**\n * Dispose of this trash can.\n * Unlink from all DOM elements to prevent memory leaks.\n */\nBlockly.Trashcan.prototype.dispose = function() {\n  if (this.svgGroup_) {\n    goog.dom.removeNode(this.svgGroup_);\n    this.svgGroup_ = null;\n  }\n  this.svgClosedCan_ = null;\n  this.svgOpenCan_ = null;\n  this.notAllowed_ = null;\n  this.blockSpace_ = null;\n};\n\n\n/**\n * Returns the trashcan's current height in pixels\n */\nBlockly.Trashcan.prototype.getHeight = function() {\n  return Blockly.Trashcan.HEIGHT_;\n};\n\n\n/**\n * Flip the lid open or shut.\n * @param {boolean} state True if open.\n * @private\n */\nBlockly.Trashcan.prototype.setOpen_ = function(state) {\n  if (this.isOpen == state) {\n    return;\n  }\n  this.isOpen = state;\n  this.animateLid_();\n};\n\n/**\n * Put a red slash over the trashcan to make it clear a block can't be deleted.\n * @param {boolean} state True if disabled.\n */\nBlockly.Trashcan.prototype.setDisabled = function(state) {\n  if (this.isDisabled === state) {\n    return;\n  }\n  this.isDisabled = state;\n  if (this.isDisabled) {\n    this.notAllowed_.setAttribute('visibility', 'visible');\n  } else {\n    this.notAllowed_.setAttribute('visibility', 'hidden');\n  }\n};\n\n/**\n * Rotate the lid open or closed by one step.  Then wait and recurse.\n * @private\n */\nBlockly.Trashcan.prototype.animateLid_ = function() {\n  if (this.isOpen) {\n    this.svgOpenCan_.setAttribute('visibility', 'visible');\n  } else {\n    this.svgOpenCan_.setAttribute('visibility', 'hidden');\n  }\n};\n\n/**\n * Flip the lid shut.\n * Called externally after a drag.\n */\nBlockly.Trashcan.prototype.close = function() {\n  this.setOpen_(false);\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Click-drag panning interaction handler for BlockSpaces\n */\n'use strict';\n\ngoog.provide('Blockly.PanDragHandler');\n\n/**\n * @param {!Blockly.BlockSpace} blockSpace\n * @constructor\n */\nBlockly.PanDragHandler = function (blockSpace) {\n  /**\n   * @private {Blockly.BlockSpace}\n   */\n  this.blockSpace_ = blockSpace;\n\n  /**\n   * Element which initiates pan-drag mode when clicked directly.\n   * @private {EventTarget}\n   */\n  this.target_ = null;\n\n  /**\n   * @private {function}\n   */\n  this.onTargetMouseDown_ = null;\n\n  /**\n   * @private {BindData}\n   */\n  this.mouseDownEventBindData_ = null;\n\n  /**\n   * @private {BindData}\n   */\n  this.wheelEventBindData_ = null;\n\n  /**\n   * (for Safari)\n   * @private {BindData}\n   */\n  this.mousewheelEventBindData_ = null;\n\n  /**\n   * @private {BindData}\n   */\n  this.contextMenuBlockEventBindData_ = null;\n\n  /**\n   * @private {BindData}\n   */\n  this.mouseMoveEventBindData_ = null;\n\n  /**\n   * @private {BindData}\n   */\n  this.mouseUpEventBindData_ = null;\n\n  /**\n   * @private {number}\n   */\n  this.startMouseX_ = null;\n\n  /**\n   * @private {number}\n   */\n  this.startMouseY_ = null;\n\n  /**\n   * @private {number}\n   */\n  this.startScrollX_ = null;\n\n  /**\n   * @private {number}\n   */\n  this.startScrollY_ = null;\n};\n\n/**\n * Establish a mousedown handler on the given dragTarget that will put the\n * blockspace into a pan-drag mode as long as the mouse is down.\n * @param {!EventTarget} target - Element which initiates pan-drag mode when\n *        clicked directly.\n * @param {function} [onDragTargetMouseDown] - optional function called when\n *        click on the drag target begins (used for hideChaff by BSE)\n */\nBlockly.PanDragHandler.prototype.bindBeginPanDragHandler = function (target,\n    onDragTargetMouseDown) {\n  this.unbindBeginPanDragHandler();\n  this.target_ = target;\n  this.onTargetMouseDown_ = onDragTargetMouseDown;\n  this.mouseDownEventBindData_ = Blockly.bindEvent_(\n      target, 'mousedown', this, this.onPanDragTargetMouseDown_);\n\n  // Also block the context menu on the pan-drag target element\n  this.contextMenuBlockEventBindData_ = Blockly.bindEvent_(\n      target, 'contextmenu', null, Blockly.blockContextMenu);\n};\n\n/**\n * Unbinds previously bound handler to begin pan-drag.  Safe to call if no\n * such handler is bound.\n */\nBlockly.PanDragHandler.prototype.unbindBeginPanDragHandler = function () {\n  if (this.mouseDownEventBindData_) {\n    Blockly.unbindEvent_(this.mouseDownEventBindData_);\n    this.mouseDownEventBindData_ = null;\n  }\n\n  if (this.contextMenuBlockEventBindData_) {\n    Blockly.unbindEvent_(this.contextMenuBlockEventBindData_);\n    this.contextMenuBlockEventBindData_ = null;\n  }\n\n  this.target_ = null;\n};\n\n/**\n * Binds temporary mousemove and mouseup handlers against window,\n * so that drag behavior and ending the drag work no matter where the cursor\n * goes after the initial mousedown.\n * @private\n */\nBlockly.PanDragHandler.prototype.bindDuringPanDragHandlers_ = function () {\n  this.unbindDuringPanDragHandlers_();\n\n  // We bind against \"capture\" (instead of the default \"bubble\") so that we\n  // receive the event before the actual event target - pan-drag mode should\n  // pretty much override everything.\n  var onCapture = true;\n  this.mouseMoveEventBindData_ = Blockly.bindEvent_(\n      window, 'mousemove', this, this.onPanDragMouseMove_, onCapture);\n  this.mouseUpEventBindData_ = Blockly.bindEvent_(\n      window, 'mouseup', this, this.onPanDragMouseUp_, onCapture);\n};\n\n/**\n * Unbinds mousemove and mouseup handlers that only apply during pan-drag mode.\n * @private\n */\nBlockly.PanDragHandler.prototype.unbindDuringPanDragHandlers_ = function () {\n  if (this.mouseMoveEventBindData_) {\n    Blockly.unbindEvent_(this.mouseMoveEventBindData_);\n    this.mouseMoveEventBindData_ = null;\n  }\n\n  if (this.mouseUpEventBindData_) {\n    Blockly.unbindEvent_(this.mouseUpEventBindData_);\n    this.mouseUpEventBindData_ = null;\n  }\n};\n\n/**\n * When a mousedown event occurs over the pan-drag target, deselect blocks\n * and decide whether we can actually begin pan-drag mode.\n * @param {!Event} e\n * @private\n */\nBlockly.PanDragHandler.prototype.onPanDragTargetMouseDown_ = function (e) {\n  if (this.onTargetMouseDown_) {\n    this.onTargetMouseDown_();\n  }\n\n  var clickIsOnTarget = e.target && e.target === this.target_;\n\n  // Clicking on the flyout background clears the global selection\n  if (Blockly.selected && !this.blockSpace_.isReadOnly() && clickIsOnTarget) {\n    Blockly.selected.unselect();\n  }\n\n  var blockNonInteractive = Blockly.selected && !Blockly.selected.isMovable() &&\n      !Blockly.selected.isEditable();\n\n  // On left-click on scrollable area, begin scroll-drag\n  // In readonly mode, we scroll-drag when clicking through a block, too.\n  var shouldDrag = clickIsOnTarget || blockNonInteractive || this.blockSpace_.isReadOnly();\n  var isLeftClick = !Blockly.isRightButton(e);\n\n  if (this.blockSpace_.scrollbarPair && isLeftClick && shouldDrag) {\n    this.beginDragScroll_(e);\n\n    // Don't click through to the workspace drag handler, or the browser\n    // default drag/scroll handlers\n    e.stopPropagation();\n    e.preventDefault();\n  }\n};\n\n/**\n * Actually begin pan-drag mode.\n * @param {!Event} e\n * @private\n */\nBlockly.PanDragHandler.prototype.beginDragScroll_ = function (e) {\n  // Record the current mouse position.\n  this.startMouseX_ = e.clientX;\n  this.startMouseY_ = e.clientY;\n  this.startScrollX_ = this.blockSpace_.getScrollOffsetX();\n  this.startScrollY_ = this.blockSpace_.getScrollOffsetY();\n\n  this.bindDuringPanDragHandlers_();\n};\n\n/**\n * Mouse-move handler that is only bound and active during pan-drag mode\n * for this blockspace.  Causes scroll and stops the event.\n * @param {!Event} e\n * @private\n */\nBlockly.PanDragHandler.prototype.onPanDragMouseMove_ = function (e) {\n  // Prevent text selection on page\n  Blockly.removeAllRanges();\n\n  var mouseDx = e.clientX - this.startMouseX_; // + if mouse right\n  var mouseDy = e.clientY - this.startMouseY_; // + if mouse down\n\n  // to pan, scroll opposite direction of drag\n  var scrollDx = -mouseDx; // scroll - (down) if mouse up\n  var scrollDy = -mouseDy; // scroll - (left) if mouse right\n\n  this.blockSpace_.scrollTo(\n    this.startScrollX_ + scrollDx,\n    this.startScrollY_ + scrollDy);\n  e.stopPropagation();\n  e.preventDefault();\n};\n\n/**\n * Mouse-up handler that is only bound and active during pan-drag mode\n * for this flyout.  Ends pan-drag mode.\n * @param {!Event} e\n * @private\n */\nBlockly.PanDragHandler.prototype.onPanDragMouseUp_ = function (e) {\n  this.unbindDuringPanDragHandlers_();\n  e.stopPropagation();\n  e.preventDefault();\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Scroll-BlockSpace-on-mousewheel interaction handler.\n */\n'use strict';\n\ngoog.provide('Blockly.ScrollOnWheelHandler');\n\n/**\n * @param {!Blockly.BlockSpace} blockSpace\n * @constructor\n */\nBlockly.ScrollOnWheelHandler = function (blockSpace) {\n  /**\n   * @private {Blockly.BlockSpace}\n   */\n  this.blockSpace_ = blockSpace;\n\n  /**\n   * @private {BindData}\n   */\n  this.wheelEventBindData_ = null;\n\n  /**\n   * (for Safari)\n   * @private {BindData}\n   */\n  this.mousewheelEventBindData_ = null;\n};\n\n/**\n * Establish a mousewheel handler on the given wheelTarget that will\n * @param {!EventTarget} wheelTarget\n */\nBlockly.ScrollOnWheelHandler.prototype.bindTo = function (wheelTarget) {\n  this.unbindWheelScrollHandler();\n\n  this.wheelEventBindData_ = Blockly.bindEvent_(wheelTarget,\n      'wheel', this, this.onWheel_);\n\n  // Safari uses 'mousewheel'\n  this.mousewheelEventBindData_ = Blockly.bindEvent_(\n      wheelTarget, 'mousewheel', this, this.onWheel_);\n};\n\n/**\n * Unbinds previously bound handler to begin pan-drag.  Safe to call if no\n * such handler is bound.\n */\nBlockly.ScrollOnWheelHandler.prototype.unbindWheelScrollHandler = function () {\n  if (this.wheelEventBindData_) {\n    Blockly.unbindEvent_(this.wheelEventBindData_);\n    this.wheelEventBindData_ = null;\n  }\n\n  if (this.mousewheelEventBindData_) {\n    Blockly.unbindEvent_(this.mousewheelEventBindData_);\n    this.mousewheelEventBindData_ = null;\n  }\n};\n\n/**\n * Scroll the BlockSpace up or down based on wheel scrolling.\n * @param {!Event} e Mouse wheel scroll event.\n * @private\n */\nBlockly.ScrollOnWheelHandler.prototype.onWheel_ = function(e) {\n  if (!this.blockSpace_.scrollbarPair) {\n    return;\n  }\n\n  // + is down\n  var wheelDelta = Blockly.getNormalizedWheelDeltaY(e);\n  if (wheelDelta) {\n    this.blockSpace_.scrollWithAnySelectedBlock(\n      this.blockSpace_.getScrollOffsetX(),\n      this.blockSpace_.getScrollOffsetY() + wheelDelta,\n      e.clientX, e.clientY);\n\n    // Don't scroll the page.\n    e.stopPropagation();\n    e.preventDefault();\n  }\n};\n","// Copyright 2011 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Definition of the disposable interface.  A disposable object\n * has a dispose method to to clean up references and resources.\n * @author nnaze@google.com (Nathan Naze)\n */\n\n\ngoog.provide('goog.disposable.IDisposable');\n\n\n\n/**\n * Interface for a disposable object.  If a instance requires cleanup\n * (references COM objects, DOM nodes, or other disposable objects), it should\n * implement this interface (it may subclass goog.Disposable).\n * @record\n */\ngoog.disposable.IDisposable = function() {};\n\n\n/**\n * Disposes of the object and its resources.\n * @return {void} Nothing.\n */\ngoog.disposable.IDisposable.prototype.dispose = goog.abstractMethod;\n\n\n/**\n * @return {boolean} Whether the object has been disposed of.\n */\ngoog.disposable.IDisposable.prototype.isDisposed = goog.abstractMethod;\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Implements the disposable interface. The dispose method is used\n * to clean up references and resources.\n * @author arv@google.com (Erik Arvidsson)\n */\n\n\ngoog.provide('goog.Disposable');\n/** @suppress {extraProvide} */\ngoog.provide('goog.dispose');\n/** @suppress {extraProvide} */\ngoog.provide('goog.disposeAll');\n\ngoog.require('goog.disposable.IDisposable');\n\n\n\n/**\n * Class that provides the basic implementation for disposable objects. If your\n * class holds one or more references to COM objects, DOM nodes, or other\n * disposable objects, it should extend this class or implement the disposable\n * interface (defined in goog.disposable.IDisposable).\n * @constructor\n * @implements {goog.disposable.IDisposable}\n */\ngoog.Disposable = function() {\n  if (goog.Disposable.MONITORING_MODE != goog.Disposable.MonitoringMode.OFF) {\n    if (goog.Disposable.INCLUDE_STACK_ON_CREATION) {\n      this.creationStack = new Error().stack;\n    }\n    goog.Disposable.instances_[goog.getUid(this)] = this;\n  }\n  // Support sealing\n  this.disposed_ = this.disposed_;\n  this.onDisposeCallbacks_ = this.onDisposeCallbacks_;\n};\n\n\n/**\n * @enum {number} Different monitoring modes for Disposable.\n */\ngoog.Disposable.MonitoringMode = {\n  /**\n   * No monitoring.\n   */\n  OFF: 0,\n  /**\n   * Creating and disposing the goog.Disposable instances is monitored. All\n   * disposable objects need to call the {@code goog.Disposable} base\n   * constructor. The PERMANENT mode must be switched on before creating any\n   * goog.Disposable instances.\n   */\n  PERMANENT: 1,\n  /**\n   * INTERACTIVE mode can be switched on and off on the fly without producing\n   * errors. It also doesn't warn if the disposable objects don't call the\n   * {@code goog.Disposable} base constructor.\n   */\n  INTERACTIVE: 2\n};\n\n\n/**\n * @define {number} The monitoring mode of the goog.Disposable\n *     instances. Default is OFF. Switching on the monitoring is only\n *     recommended for debugging because it has a significant impact on\n *     performance and memory usage. If switched off, the monitoring code\n *     compiles down to 0 bytes.\n */\ngoog.define('goog.Disposable.MONITORING_MODE', 0);\n\n\n/**\n * @define {boolean} Whether to attach creation stack to each created disposable\n *     instance; This is only relevant for when MonitoringMode != OFF.\n */\ngoog.define('goog.Disposable.INCLUDE_STACK_ON_CREATION', true);\n\n\n/**\n * Maps the unique ID of every undisposed {@code goog.Disposable} object to\n * the object itself.\n * @type {!Object<number, !goog.Disposable>}\n * @private\n */\ngoog.Disposable.instances_ = {};\n\n\n/**\n * @return {!Array<!goog.Disposable>} All {@code goog.Disposable} objects that\n *     haven't been disposed of.\n */\ngoog.Disposable.getUndisposedObjects = function() {\n  var ret = [];\n  for (var id in goog.Disposable.instances_) {\n    if (goog.Disposable.instances_.hasOwnProperty(id)) {\n      ret.push(goog.Disposable.instances_[Number(id)]);\n    }\n  }\n  return ret;\n};\n\n\n/**\n * Clears the registry of undisposed objects but doesn't dispose of them.\n */\ngoog.Disposable.clearUndisposedObjects = function() {\n  goog.Disposable.instances_ = {};\n};\n\n\n/**\n * Whether the object has been disposed of.\n * @type {boolean}\n * @private\n */\ngoog.Disposable.prototype.disposed_ = false;\n\n\n/**\n * Callbacks to invoke when this object is disposed.\n * @type {Array<!Function>}\n * @private\n */\ngoog.Disposable.prototype.onDisposeCallbacks_;\n\n\n/**\n * If monitoring the goog.Disposable instances is enabled, stores the creation\n * stack trace of the Disposable instance.\n * @const {string}\n */\ngoog.Disposable.prototype.creationStack;\n\n\n/**\n * @return {boolean} Whether the object has been disposed of.\n * @override\n */\ngoog.Disposable.prototype.isDisposed = function() {\n  return this.disposed_;\n};\n\n\n/**\n * @return {boolean} Whether the object has been disposed of.\n * @deprecated Use {@link #isDisposed} instead.\n */\ngoog.Disposable.prototype.getDisposed = goog.Disposable.prototype.isDisposed;\n\n\n/**\n * Disposes of the object. If the object hasn't already been disposed of, calls\n * {@link #disposeInternal}. Classes that extend {@code goog.Disposable} should\n * override {@link #disposeInternal} in order to delete references to COM\n * objects, DOM nodes, and other disposable objects. Reentrant.\n *\n * @return {void} Nothing.\n * @override\n */\ngoog.Disposable.prototype.dispose = function() {\n  if (!this.disposed_) {\n    // Set disposed_ to true first, in case during the chain of disposal this\n    // gets disposed recursively.\n    this.disposed_ = true;\n    this.disposeInternal();\n    if (goog.Disposable.MONITORING_MODE != goog.Disposable.MonitoringMode.OFF) {\n      var uid = goog.getUid(this);\n      if (goog.Disposable.MONITORING_MODE ==\n              goog.Disposable.MonitoringMode.PERMANENT &&\n          !goog.Disposable.instances_.hasOwnProperty(uid)) {\n        throw Error(\n            this + ' did not call the goog.Disposable base ' +\n            'constructor or was disposed of after a clearUndisposedObjects ' +\n            'call');\n      }\n      delete goog.Disposable.instances_[uid];\n    }\n  }\n};\n\n\n/**\n * Associates a disposable object with this object so that they will be disposed\n * together.\n * @param {goog.disposable.IDisposable} disposable that will be disposed when\n *     this object is disposed.\n */\ngoog.Disposable.prototype.registerDisposable = function(disposable) {\n  this.addOnDisposeCallback(goog.partial(goog.dispose, disposable));\n};\n\n\n/**\n * Invokes a callback function when this object is disposed. Callbacks are\n * invoked in the order in which they were added. If a callback is added to\n * an already disposed Disposable, it will be called immediately.\n * @param {function(this:T):?} callback The callback function.\n * @param {T=} opt_scope An optional scope to call the callback in.\n * @template T\n */\ngoog.Disposable.prototype.addOnDisposeCallback = function(callback, opt_scope) {\n  if (this.disposed_) {\n    goog.isDef(opt_scope) ? callback.call(opt_scope) : callback();\n    return;\n  }\n  if (!this.onDisposeCallbacks_) {\n    this.onDisposeCallbacks_ = [];\n  }\n\n  this.onDisposeCallbacks_.push(\n      goog.isDef(opt_scope) ? goog.bind(callback, opt_scope) : callback);\n};\n\n\n/**\n * Deletes or nulls out any references to COM objects, DOM nodes, or other\n * disposable objects. Classes that extend {@code goog.Disposable} should\n * override this method.\n * Not reentrant. To avoid calling it twice, it must only be called from the\n * subclass' {@code disposeInternal} method. Everywhere else the public\n * {@code dispose} method must be used.\n * For example:\n * <pre>\n *   mypackage.MyClass = function() {\n *     mypackage.MyClass.base(this, 'constructor');\n *     // Constructor logic specific to MyClass.\n *     ...\n *   };\n *   goog.inherits(mypackage.MyClass, goog.Disposable);\n *\n *   mypackage.MyClass.prototype.disposeInternal = function() {\n *     // Dispose logic specific to MyClass.\n *     ...\n *     // Call superclass's disposeInternal at the end of the subclass's, like\n *     // in C++, to avoid hard-to-catch issues.\n *     mypackage.MyClass.base(this, 'disposeInternal');\n *   };\n * </pre>\n * @protected\n */\ngoog.Disposable.prototype.disposeInternal = function() {\n  if (this.onDisposeCallbacks_) {\n    while (this.onDisposeCallbacks_.length) {\n      this.onDisposeCallbacks_.shift()();\n    }\n  }\n};\n\n\n/**\n * Returns True if we can verify the object is disposed.\n * Calls {@code isDisposed} on the argument if it supports it.  If obj\n * is not an object with an isDisposed() method, return false.\n * @param {*} obj The object to investigate.\n * @return {boolean} True if we can verify the object is disposed.\n */\ngoog.Disposable.isDisposed = function(obj) {\n  if (obj && typeof obj.isDisposed == 'function') {\n    return obj.isDisposed();\n  }\n  return false;\n};\n\n\n/**\n * Calls {@code dispose} on the argument if it supports it. If obj is not an\n *     object with a dispose() method, this is a no-op.\n * @param {*} obj The object to dispose of.\n */\ngoog.dispose = function(obj) {\n  if (obj && typeof obj.dispose == 'function') {\n    obj.dispose();\n  }\n};\n\n\n/**\n * Calls {@code dispose} on each member of the list that supports it. (If the\n * member is an ArrayLike, then {@code goog.disposeAll()} will be called\n * recursively on each of its members.) If the member is not an object with a\n * {@code dispose()} method, then it is ignored.\n * @param {...*} var_args The list.\n */\ngoog.disposeAll = function(var_args) {\n  for (var i = 0, len = arguments.length; i < len; ++i) {\n    var disposable = arguments[i];\n    if (goog.isArrayLike(disposable)) {\n      goog.disposeAll.apply(null, disposable);\n    } else {\n      goog.dispose(disposable);\n    }\n  }\n};\n","// Copyright 2010 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A global registry for entry points into a program,\n * so that they can be instrumented. Each module should register their\n * entry points with this registry. Designed to be compiled out\n * if no instrumentation is requested.\n *\n * Entry points may be registered before or after a call to\n * goog.debug.entryPointRegistry.monitorAll. If an entry point is registered\n * later, the existing monitor will instrument the new entry point.\n *\n * @author nicksantos@google.com (Nick Santos)\n */\n\ngoog.provide('goog.debug.EntryPointMonitor');\ngoog.provide('goog.debug.entryPointRegistry');\n\ngoog.require('goog.asserts');\n\n\n\n/**\n * @interface\n */\ngoog.debug.EntryPointMonitor = function() {};\n\n\n/**\n * Instruments a function.\n *\n * @param {!Function} fn A function to instrument.\n * @return {!Function} The instrumented function.\n */\ngoog.debug.EntryPointMonitor.prototype.wrap;\n\n\n/**\n * Try to remove an instrumentation wrapper created by this monitor.\n * If the function passed to unwrap is not a wrapper created by this\n * monitor, then we will do nothing.\n *\n * Notice that some wrappers may not be unwrappable. For example, if other\n * monitors have applied their own wrappers, then it will be impossible to\n * unwrap them because their wrappers will have captured our wrapper.\n *\n * So it is important that entry points are unwrapped in the reverse\n * order that they were wrapped.\n *\n * @param {!Function} fn A function to unwrap.\n * @return {!Function} The unwrapped function, or {@code fn} if it was not\n *     a wrapped function created by this monitor.\n */\ngoog.debug.EntryPointMonitor.prototype.unwrap;\n\n\n/**\n * An array of entry point callbacks.\n * @type {!Array<function(!Function)>}\n * @private\n */\ngoog.debug.entryPointRegistry.refList_ = [];\n\n\n/**\n * Monitors that should wrap all the entry points.\n * @type {!Array<!goog.debug.EntryPointMonitor>}\n * @private\n */\ngoog.debug.entryPointRegistry.monitors_ = [];\n\n\n/**\n * Whether goog.debug.entryPointRegistry.monitorAll has ever been called.\n * Checking this allows the compiler to optimize out the registrations.\n * @type {boolean}\n * @private\n */\ngoog.debug.entryPointRegistry.monitorsMayExist_ = false;\n\n\n/**\n * Register an entry point with this module.\n *\n * The entry point will be instrumented when a monitor is passed to\n * goog.debug.entryPointRegistry.monitorAll. If this has already occurred, the\n * entry point is instrumented immediately.\n *\n * @param {function(!Function)} callback A callback function which is called\n *     with a transforming function to instrument the entry point. The callback\n *     is responsible for wrapping the relevant entry point with the\n *     transforming function.\n */\ngoog.debug.entryPointRegistry.register = function(callback) {\n  // Don't use push(), so that this can be compiled out.\n  goog.debug.entryPointRegistry\n      .refList_[goog.debug.entryPointRegistry.refList_.length] = callback;\n  // If no one calls monitorAll, this can be compiled out.\n  if (goog.debug.entryPointRegistry.monitorsMayExist_) {\n    var monitors = goog.debug.entryPointRegistry.monitors_;\n    for (var i = 0; i < monitors.length; i++) {\n      callback(goog.bind(monitors[i].wrap, monitors[i]));\n    }\n  }\n};\n\n\n/**\n * Configures a monitor to wrap all entry points.\n *\n * Entry points that have already been registered are immediately wrapped by\n * the monitor. When an entry point is registered in the future, it will also\n * be wrapped by the monitor when it is registered.\n *\n * @param {!goog.debug.EntryPointMonitor} monitor An entry point monitor.\n */\ngoog.debug.entryPointRegistry.monitorAll = function(monitor) {\n  goog.debug.entryPointRegistry.monitorsMayExist_ = true;\n  var transformer = goog.bind(monitor.wrap, monitor);\n  for (var i = 0; i < goog.debug.entryPointRegistry.refList_.length; i++) {\n    goog.debug.entryPointRegistry.refList_[i](transformer);\n  }\n  goog.debug.entryPointRegistry.monitors_.push(monitor);\n};\n\n\n/**\n * Try to unmonitor all the entry points that have already been registered. If\n * an entry point is registered in the future, it will not be wrapped by the\n * monitor when it is registered. Note that this may fail if the entry points\n * have additional wrapping.\n *\n * @param {!goog.debug.EntryPointMonitor} monitor The last monitor to wrap\n *     the entry points.\n * @throws {Error} If the monitor is not the most recently configured monitor.\n */\ngoog.debug.entryPointRegistry.unmonitorAllIfPossible = function(monitor) {\n  var monitors = goog.debug.entryPointRegistry.monitors_;\n  goog.asserts.assert(\n      monitor == monitors[monitors.length - 1],\n      'Only the most recent monitor can be unwrapped.');\n  var transformer = goog.bind(monitor.unwrap, monitor);\n  for (var i = 0; i < goog.debug.entryPointRegistry.refList_.length; i++) {\n    goog.debug.entryPointRegistry.refList_[i](transformer);\n  }\n  monitors.length--;\n};\n","// Copyright 2010 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Browser capability checks for the events package.\n *\n */\n\n\ngoog.provide('goog.events.BrowserFeature');\n\ngoog.require('goog.userAgent');\n\n\n/**\n * Enum of browser capabilities.\n * @enum {boolean}\n */\ngoog.events.BrowserFeature = {\n  /**\n   * Whether the button attribute of the event is W3C compliant.  False in\n   * Internet Explorer prior to version 9; document-version dependent.\n   */\n  HAS_W3C_BUTTON:\n      !goog.userAgent.IE || goog.userAgent.isDocumentModeOrHigher(9),\n\n  /**\n   * Whether the browser supports full W3C event model.\n   */\n  HAS_W3C_EVENT_SUPPORT:\n      !goog.userAgent.IE || goog.userAgent.isDocumentModeOrHigher(9),\n\n  /**\n   * To prevent default in IE7-8 for certain keydown events we need set the\n   * keyCode to -1.\n   */\n  SET_KEY_CODE_TO_PREVENT_DEFAULT:\n      goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('9'),\n\n  /**\n   * Whether the {@code navigator.onLine} property is supported.\n   */\n  HAS_NAVIGATOR_ONLINE_PROPERTY:\n      !goog.userAgent.WEBKIT || goog.userAgent.isVersionOrHigher('528'),\n\n  /**\n   * Whether HTML5 network online/offline events are supported.\n   */\n  HAS_HTML5_NETWORK_EVENT_SUPPORT:\n      goog.userAgent.GECKO && goog.userAgent.isVersionOrHigher('1.9b') ||\n      goog.userAgent.IE && goog.userAgent.isVersionOrHigher('8') ||\n      goog.userAgent.OPERA && goog.userAgent.isVersionOrHigher('9.5') ||\n      goog.userAgent.WEBKIT && goog.userAgent.isVersionOrHigher('528'),\n\n  /**\n   * Whether HTML5 network events fire on document.body, or otherwise the\n   * window.\n   */\n  HTML5_NETWORK_EVENTS_FIRE_ON_BODY:\n      goog.userAgent.GECKO && !goog.userAgent.isVersionOrHigher('8') ||\n      goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('9'),\n\n  /**\n   * Whether touch is enabled in the browser.\n   */\n  TOUCH_ENABLED:\n      ('ontouchstart' in goog.global ||\n       !!(goog.global['document'] && document.documentElement &&\n          'ontouchstart' in document.documentElement) ||\n       // IE10 uses non-standard touch events, so it has a different check.\n       !!(goog.global['navigator'] &&\n          goog.global['navigator']['msMaxTouchPoints']))\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\ngoog.provide('goog.events.EventId');\n\n\n\n/**\n * A templated class that is used when registering for events. Typical usage:\n *\n *    /** @type {goog.events.EventId<MyEventObj>} *\\\n *    var myEventId = new goog.events.EventId(\n *        goog.events.getUniqueId(('someEvent'));\n *\n *    // No need to cast or declare here since the compiler knows the\n *    // correct type of 'evt' (MyEventObj).\n *    something.listen(myEventId, function(evt) {});\n *\n * @param {string} eventId\n * @template T\n * @constructor\n * @struct\n * @final\n */\ngoog.events.EventId = function(eventId) {\n  /** @const */ this.id = eventId;\n};\n\n\n/**\n * @override\n */\ngoog.events.EventId.prototype.toString = function() {\n  return this.id;\n};\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A base class for event objects.\n *\n */\n\n\ngoog.provide('goog.events.Event');\ngoog.provide('goog.events.EventLike');\n\n/**\n * goog.events.Event no longer depends on goog.Disposable. Keep requiring\n * goog.Disposable here to not break projects which assume this dependency.\n * @suppress {extraRequire}\n */\ngoog.require('goog.Disposable');\ngoog.require('goog.events.EventId');\n\n\n/**\n * A typedef for event like objects that are dispatchable via the\n * goog.events.dispatchEvent function. strings are treated as the type for a\n * goog.events.Event. Objects are treated as an extension of a new\n * goog.events.Event with the type property of the object being used as the type\n * of the Event.\n * @typedef {string|Object|goog.events.Event|goog.events.EventId}\n */\ngoog.events.EventLike;\n\n\n\n/**\n * A base class for event objects, so that they can support preventDefault and\n * stopPropagation.\n *\n * @suppress {underscore} Several properties on this class are technically\n *     public, but referencing these properties outside this package is strongly\n *     discouraged.\n *\n * @param {string|!goog.events.EventId} type Event Type.\n * @param {Object=} opt_target Reference to the object that is the target of\n *     this event. It has to implement the {@code EventTarget} interface\n *     declared at {@link http://developer.mozilla.org/en/DOM/EventTarget}.\n * @constructor\n */\ngoog.events.Event = function(type, opt_target) {\n  /**\n   * Event type.\n   * @type {string}\n   */\n  this.type = type instanceof goog.events.EventId ? String(type) : type;\n\n  /**\n   * TODO(tbreisacher): The type should probably be\n   * EventTarget|goog.events.EventTarget.\n   *\n   * Target of the event.\n   * @type {Object|undefined}\n   */\n  this.target = opt_target;\n\n  /**\n   * Object that had the listener attached.\n   * @type {Object|undefined}\n   */\n  this.currentTarget = this.target;\n\n  /**\n   * Whether to cancel the event in internal capture/bubble processing for IE.\n   * @type {boolean}\n   * @public\n   */\n  this.propagationStopped_ = false;\n\n  /**\n   * Whether the default action has been prevented.\n   * This is a property to match the W3C specification at\n   * {@link http://www.w3.org/TR/DOM-Level-3-Events/\n   * #events-event-type-defaultPrevented}.\n   * Must be treated as read-only outside the class.\n   * @type {boolean}\n   */\n  this.defaultPrevented = false;\n\n  /**\n   * Return value for in internal capture/bubble processing for IE.\n   * @type {boolean}\n   * @public\n   * @suppress {underscore|visibility} Technically public, but referencing this\n   *     outside this package is strongly discouraged.\n   */\n  this.returnValue_ = true;\n};\n\n\n/**\n * Stops event propagation.\n */\ngoog.events.Event.prototype.stopPropagation = function() {\n  this.propagationStopped_ = true;\n};\n\n\n/**\n * Prevents the default action, for example a link redirecting to a url.\n */\ngoog.events.Event.prototype.preventDefault = function() {\n  this.defaultPrevented = true;\n  this.returnValue_ = false;\n};\n\n\n/**\n * Stops the propagation of the event. It is equivalent to\n * {@code e.stopPropagation()}, but can be used as the callback argument of\n * {@link goog.events.listen} without declaring another function.\n * @param {!goog.events.Event} e An event.\n */\ngoog.events.Event.stopPropagation = function(e) {\n  e.stopPropagation();\n};\n\n\n/**\n * Prevents the default action. It is equivalent to\n * {@code e.preventDefault()}, but can be used as the callback argument of\n * {@link goog.events.listen} without declaring another function.\n * @param {!goog.events.Event} e An event.\n */\ngoog.events.Event.preventDefault = function(e) {\n  e.preventDefault();\n};\n","// Copyright 2010 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Event Types.\n *\n * @author arv@google.com (Erik Arvidsson)\n */\n\n\ngoog.provide('goog.events.EventType');\n\ngoog.require('goog.userAgent');\n\n\n/**\n * Returns a prefixed event name for the current browser.\n * @param {string} eventName The name of the event.\n * @return {string} The prefixed event name.\n * @suppress {missingRequire|missingProvide}\n * @private\n */\ngoog.events.getVendorPrefixedName_ = function(eventName) {\n  return goog.userAgent.WEBKIT ?\n      'webkit' + eventName :\n      (goog.userAgent.OPERA ? 'o' + eventName.toLowerCase() :\n                              eventName.toLowerCase());\n};\n\n\n/**\n * Constants for event names.\n * @enum {string}\n */\ngoog.events.EventType = {\n  // Mouse events\n  CLICK: 'click',\n  RIGHTCLICK: 'rightclick',\n  DBLCLICK: 'dblclick',\n  MOUSEDOWN: 'mousedown',\n  MOUSEUP: 'mouseup',\n  MOUSEOVER: 'mouseover',\n  MOUSEOUT: 'mouseout',\n  MOUSEMOVE: 'mousemove',\n  MOUSEENTER: 'mouseenter',\n  MOUSELEAVE: 'mouseleave',\n\n  // Selection events.\n  // https://www.w3.org/TR/selection-api/\n  SELECTIONCHANGE: 'selectionchange',\n  SELECTSTART: 'selectstart',  // IE, Safari, Chrome\n\n  // Wheel events\n  // http://www.w3.org/TR/DOM-Level-3-Events/#events-wheelevents\n  WHEEL: 'wheel',\n\n  // Key events\n  KEYPRESS: 'keypress',\n  KEYDOWN: 'keydown',\n  KEYUP: 'keyup',\n\n  // Focus\n  BLUR: 'blur',\n  FOCUS: 'focus',\n  DEACTIVATE: 'deactivate',  // IE only\n  // NOTE: The following two events are not stable in cross-browser usage.\n  //     WebKit and Opera implement DOMFocusIn/Out.\n  //     IE implements focusin/out.\n  //     Gecko implements neither see bug at\n  //     https://bugzilla.mozilla.org/show_bug.cgi?id=396927.\n  // The DOM Events Level 3 Draft deprecates DOMFocusIn in favor of focusin:\n  //     http://dev.w3.org/2006/webapi/DOM-Level-3-Events/html/DOM3-Events.html\n  // You can use FOCUS in Capture phase until implementations converge.\n  FOCUSIN: goog.userAgent.IE ? 'focusin' : 'DOMFocusIn',\n  FOCUSOUT: goog.userAgent.IE ? 'focusout' : 'DOMFocusOut',\n\n  // Forms\n  CHANGE: 'change',\n  RESET: 'reset',\n  SELECT: 'select',\n  SUBMIT: 'submit',\n  INPUT: 'input',\n  PROPERTYCHANGE: 'propertychange',  // IE only\n\n  // Drag and drop\n  DRAGSTART: 'dragstart',\n  DRAG: 'drag',\n  DRAGENTER: 'dragenter',\n  DRAGOVER: 'dragover',\n  DRAGLEAVE: 'dragleave',\n  DROP: 'drop',\n  DRAGEND: 'dragend',\n\n  // Touch events\n  // Note that other touch events exist, but we should follow the W3C list here.\n  // http://www.w3.org/TR/touch-events/#list-of-touchevent-types\n  TOUCHSTART: 'touchstart',\n  TOUCHMOVE: 'touchmove',\n  TOUCHEND: 'touchend',\n  TOUCHCANCEL: 'touchcancel',\n\n  // Misc\n  BEFOREUNLOAD: 'beforeunload',\n  CONSOLEMESSAGE: 'consolemessage',\n  CONTEXTMENU: 'contextmenu',\n  DEVICEORIENTATION: 'deviceorientation',\n  DOMCONTENTLOADED: 'DOMContentLoaded',\n  ERROR: 'error',\n  HELP: 'help',\n  LOAD: 'load',\n  LOSECAPTURE: 'losecapture',\n  ORIENTATIONCHANGE: 'orientationchange',\n  READYSTATECHANGE: 'readystatechange',\n  RESIZE: 'resize',\n  SCROLL: 'scroll',\n  UNLOAD: 'unload',\n\n  // Media events\n  CANPLAY: 'canplay',\n  CANPLAYTHROUGH: 'canplaythrough',\n  DURATIONCHANGE: 'durationchange',\n  EMPTIED: 'emptied',\n  ENDED: 'ended',\n  LOADEDDATA: 'loadeddata',\n  LOADEDMETADATA: 'loadedmetadata',\n  PAUSE: 'pause',\n  PLAY: 'play',\n  PLAYING: 'playing',\n  RATECHANGE: 'ratechange',\n  SEEKED: 'seeked',\n  SEEKING: 'seeking',\n  STALLED: 'stalled',\n  SUSPEND: 'suspend',\n  TIMEUPDATE: 'timeupdate',\n  VOLUMECHANGE: 'volumechange',\n  WAITING: 'waiting',\n\n  // HTML 5 History events\n  // See http://www.w3.org/TR/html5/browsers.html#event-definitions-0\n  HASHCHANGE: 'hashchange',\n  PAGEHIDE: 'pagehide',\n  PAGESHOW: 'pageshow',\n  POPSTATE: 'popstate',\n\n  // Copy and Paste\n  // Support is limited. Make sure it works on your favorite browser\n  // before using.\n  // http://www.quirksmode.org/dom/events/cutcopypaste.html\n  COPY: 'copy',\n  PASTE: 'paste',\n  CUT: 'cut',\n  BEFORECOPY: 'beforecopy',\n  BEFORECUT: 'beforecut',\n  BEFOREPASTE: 'beforepaste',\n\n  // HTML5 online/offline events.\n  // http://www.w3.org/TR/offline-webapps/#related\n  ONLINE: 'online',\n  OFFLINE: 'offline',\n\n  // HTML 5 worker events\n  MESSAGE: 'message',\n  CONNECT: 'connect',\n\n  // CSS animation events.\n  /** @suppress {missingRequire} */\n  ANIMATIONSTART: goog.events.getVendorPrefixedName_('AnimationStart'),\n  /** @suppress {missingRequire} */\n  ANIMATIONEND: goog.events.getVendorPrefixedName_('AnimationEnd'),\n  /** @suppress {missingRequire} */\n  ANIMATIONITERATION: goog.events.getVendorPrefixedName_('AnimationIteration'),\n\n  // CSS transition events. Based on the browser support described at:\n  // https://developer.mozilla.org/en/css/css_transitions#Browser_compatibility\n  /** @suppress {missingRequire} */\n  TRANSITIONEND: goog.events.getVendorPrefixedName_('TransitionEnd'),\n\n  // W3C Pointer Events\n  // http://www.w3.org/TR/pointerevents/\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTERCANCEL: 'pointercancel',\n  POINTERMOVE: 'pointermove',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  GOTPOINTERCAPTURE: 'gotpointercapture',\n  LOSTPOINTERCAPTURE: 'lostpointercapture',\n\n  // IE specific events.\n  // See http://msdn.microsoft.com/en-us/library/ie/hh772103(v=vs.85).aspx\n  // Note: these events will be supplanted in IE11.\n  MSGESTURECHANGE: 'MSGestureChange',\n  MSGESTUREEND: 'MSGestureEnd',\n  MSGESTUREHOLD: 'MSGestureHold',\n  MSGESTURESTART: 'MSGestureStart',\n  MSGESTURETAP: 'MSGestureTap',\n  MSGOTPOINTERCAPTURE: 'MSGotPointerCapture',\n  MSINERTIASTART: 'MSInertiaStart',\n  MSLOSTPOINTERCAPTURE: 'MSLostPointerCapture',\n  MSPOINTERCANCEL: 'MSPointerCancel',\n  MSPOINTERDOWN: 'MSPointerDown',\n  MSPOINTERENTER: 'MSPointerEnter',\n  MSPOINTERHOVER: 'MSPointerHover',\n  MSPOINTERLEAVE: 'MSPointerLeave',\n  MSPOINTERMOVE: 'MSPointerMove',\n  MSPOINTEROUT: 'MSPointerOut',\n  MSPOINTEROVER: 'MSPointerOver',\n  MSPOINTERUP: 'MSPointerUp',\n\n  // Native IMEs/input tools events.\n  TEXT: 'text',\n  TEXTINPUT: 'textInput',\n  COMPOSITIONSTART: 'compositionstart',\n  COMPOSITIONUPDATE: 'compositionupdate',\n  COMPOSITIONEND: 'compositionend',\n\n  // Webview tag events\n  // See http://developer.chrome.com/dev/apps/webview_tag.html\n  EXIT: 'exit',\n  LOADABORT: 'loadabort',\n  LOADCOMMIT: 'loadcommit',\n  LOADREDIRECT: 'loadredirect',\n  LOADSTART: 'loadstart',\n  LOADSTOP: 'loadstop',\n  RESPONSIVE: 'responsive',\n  SIZECHANGED: 'sizechanged',\n  UNRESPONSIVE: 'unresponsive',\n\n  // HTML5 Page Visibility API.  See details at\n  // {@code goog.labs.dom.PageVisibilityMonitor}.\n  VISIBILITYCHANGE: 'visibilitychange',\n\n  // LocalStorage event.\n  STORAGE: 'storage',\n\n  // DOM Level 2 mutation events (deprecated).\n  DOMSUBTREEMODIFIED: 'DOMSubtreeModified',\n  DOMNODEINSERTED: 'DOMNodeInserted',\n  DOMNODEREMOVED: 'DOMNodeRemoved',\n  DOMNODEREMOVEDFROMDOCUMENT: 'DOMNodeRemovedFromDocument',\n  DOMNODEINSERTEDINTODOCUMENT: 'DOMNodeInsertedIntoDocument',\n  DOMATTRMODIFIED: 'DOMAttrModified',\n  DOMCHARACTERDATAMODIFIED: 'DOMCharacterDataModified',\n\n  // Print events.\n  BEFOREPRINT: 'beforeprint',\n  AFTERPRINT: 'afterprint'\n};\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A patched, standardized event object for browser events.\n *\n * <pre>\n * The patched event object contains the following members:\n * - type           {string}    Event type, e.g. 'click'\n * - target         {Object}    The element that actually triggered the event\n * - currentTarget  {Object}    The element the listener is attached to\n * - relatedTarget  {Object}    For mouseover and mouseout, the previous object\n * - offsetX        {number}    X-coordinate relative to target\n * - offsetY        {number}    Y-coordinate relative to target\n * - clientX        {number}    X-coordinate relative to viewport\n * - clientY        {number}    Y-coordinate relative to viewport\n * - screenX        {number}    X-coordinate relative to the edge of the screen\n * - screenY        {number}    Y-coordinate relative to the edge of the screen\n * - button         {number}    Mouse button. Use isButton() to test.\n * - keyCode        {number}    Key-code\n * - ctrlKey        {boolean}   Was ctrl key depressed\n * - altKey         {boolean}   Was alt key depressed\n * - shiftKey       {boolean}   Was shift key depressed\n * - metaKey        {boolean}   Was meta key depressed\n * - defaultPrevented {boolean} Whether the default action has been prevented\n * - state          {Object}    History state object\n *\n * NOTE: The keyCode member contains the raw browser keyCode. For normalized\n * key and character code use {@link goog.events.KeyHandler}.\n * </pre>\n *\n * @author arv@google.com (Erik Arvidsson)\n */\n\ngoog.provide('goog.events.BrowserEvent');\ngoog.provide('goog.events.BrowserEvent.MouseButton');\n\ngoog.require('goog.events.BrowserFeature');\ngoog.require('goog.events.Event');\ngoog.require('goog.events.EventType');\ngoog.require('goog.reflect');\ngoog.require('goog.userAgent');\n\n\n\n/**\n * Accepts a browser event object and creates a patched, cross browser event\n * object.\n * The content of this object will not be initialized if no event object is\n * provided. If this is the case, init() needs to be invoked separately.\n * @param {Event=} opt_e Browser event object.\n * @param {EventTarget=} opt_currentTarget Current target for event.\n * @constructor\n * @extends {goog.events.Event}\n */\ngoog.events.BrowserEvent = function(opt_e, opt_currentTarget) {\n  goog.events.BrowserEvent.base(this, 'constructor', opt_e ? opt_e.type : '');\n\n  /**\n   * Target that fired the event.\n   * @override\n   * @type {Node}\n   */\n  this.target = null;\n\n  /**\n   * Node that had the listener attached.\n   * @override\n   * @type {Node|undefined}\n   */\n  this.currentTarget = null;\n\n  /**\n   * For mouseover and mouseout events, the related object for the event.\n   * @type {Node}\n   */\n  this.relatedTarget = null;\n\n  /**\n   * X-coordinate relative to target.\n   * @type {number}\n   */\n  this.offsetX = 0;\n\n  /**\n   * Y-coordinate relative to target.\n   * @type {number}\n   */\n  this.offsetY = 0;\n\n  /**\n   * X-coordinate relative to the window.\n   * @type {number}\n   */\n  this.clientX = 0;\n\n  /**\n   * Y-coordinate relative to the window.\n   * @type {number}\n   */\n  this.clientY = 0;\n\n  /**\n   * X-coordinate relative to the monitor.\n   * @type {number}\n   */\n  this.screenX = 0;\n\n  /**\n   * Y-coordinate relative to the monitor.\n   * @type {number}\n   */\n  this.screenY = 0;\n\n  /**\n   * Which mouse button was pressed.\n   * @type {number}\n   */\n  this.button = 0;\n\n  /**\n   * Keycode of key press.\n   * @type {number}\n   */\n  this.keyCode = 0;\n\n  /**\n   * Keycode of key press.\n   * @type {number}\n   */\n  this.charCode = 0;\n\n  /**\n   * Whether control was pressed at time of event.\n   * @type {boolean}\n   */\n  this.ctrlKey = false;\n\n  /**\n   * Whether alt was pressed at time of event.\n   * @type {boolean}\n   */\n  this.altKey = false;\n\n  /**\n   * Whether shift was pressed at time of event.\n   * @type {boolean}\n   */\n  this.shiftKey = false;\n\n  /**\n   * Whether the meta key was pressed at time of event.\n   * @type {boolean}\n   */\n  this.metaKey = false;\n\n  /**\n   * History state object, only set for PopState events where it's a copy of the\n   * state object provided to pushState or replaceState.\n   * @type {Object}\n   */\n  this.state = null;\n\n  /**\n   * Whether the default platform modifier key was pressed at time of event.\n   * (This is control for all platforms except Mac, where it's Meta.)\n   * @type {boolean}\n   */\n  this.platformModifierKey = false;\n\n  /**\n   * The browser event object.\n   * @private {Event}\n   */\n  this.event_ = null;\n\n  if (opt_e) {\n    this.init(opt_e, opt_currentTarget);\n  }\n};\ngoog.inherits(goog.events.BrowserEvent, goog.events.Event);\n\n\n/**\n * Normalized button constants for the mouse.\n * @enum {number}\n */\ngoog.events.BrowserEvent.MouseButton = {\n  LEFT: 0,\n  MIDDLE: 1,\n  RIGHT: 2\n};\n\n\n/**\n * Static data for mapping mouse buttons.\n * @type {!Array<number>}\n */\ngoog.events.BrowserEvent.IEButtonMap = [\n  1,  // LEFT\n  4,  // MIDDLE\n  2   // RIGHT\n];\n\n\n/**\n * Accepts a browser event object and creates a patched, cross browser event\n * object.\n * @param {Event} e Browser event object.\n * @param {EventTarget=} opt_currentTarget Current target for event.\n */\ngoog.events.BrowserEvent.prototype.init = function(e, opt_currentTarget) {\n  var type = this.type = e.type;\n\n  /**\n   * On touch devices use the first \"changed touch\" as the relevant touch.\n   * @type {Touch}\n   */\n  var relevantTouch = e.changedTouches ? e.changedTouches[0] : null;\n\n  // TODO(nicksantos): Change this.target to type EventTarget.\n  this.target = /** @type {Node} */ (e.target) || e.srcElement;\n\n  // TODO(nicksantos): Change this.currentTarget to type EventTarget.\n  this.currentTarget = /** @type {Node} */ (opt_currentTarget);\n\n  var relatedTarget = /** @type {Node} */ (e.relatedTarget);\n  if (relatedTarget) {\n    // There's a bug in FireFox where sometimes, relatedTarget will be a\n    // chrome element, and accessing any property of it will get a permission\n    // denied exception. See:\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=497780\n    if (goog.userAgent.GECKO) {\n      if (!goog.reflect.canAccessProperty(relatedTarget, 'nodeName')) {\n        relatedTarget = null;\n      }\n    }\n    // TODO(arv): Use goog.events.EventType when it has been refactored into its\n    // own file.\n  } else if (type == goog.events.EventType.MOUSEOVER) {\n    relatedTarget = e.fromElement;\n  } else if (type == goog.events.EventType.MOUSEOUT) {\n    relatedTarget = e.toElement;\n  }\n\n  this.relatedTarget = relatedTarget;\n\n  if (!goog.isNull(relevantTouch)) {\n    this.clientX = relevantTouch.clientX !== undefined ? relevantTouch.clientX :\n                                                         relevantTouch.pageX;\n    this.clientY = relevantTouch.clientY !== undefined ? relevantTouch.clientY :\n                                                         relevantTouch.pageY;\n    this.screenX = relevantTouch.screenX || 0;\n    this.screenY = relevantTouch.screenY || 0;\n  } else {\n    // Webkit emits a lame warning whenever layerX/layerY is accessed.\n    // http://code.google.com/p/chromium/issues/detail?id=101733\n    this.offsetX = (goog.userAgent.WEBKIT || e.offsetX !== undefined) ?\n        e.offsetX :\n        e.layerX;\n    this.offsetY = (goog.userAgent.WEBKIT || e.offsetY !== undefined) ?\n        e.offsetY :\n        e.layerY;\n    this.clientX = e.clientX !== undefined ? e.clientX : e.pageX;\n    this.clientY = e.clientY !== undefined ? e.clientY : e.pageY;\n    this.screenX = e.screenX || 0;\n    this.screenY = e.screenY || 0;\n  }\n\n  this.button = e.button;\n\n  this.keyCode = e.keyCode || 0;\n  this.charCode = e.charCode || (type == 'keypress' ? e.keyCode : 0);\n  this.ctrlKey = e.ctrlKey;\n  this.altKey = e.altKey;\n  this.shiftKey = e.shiftKey;\n  this.metaKey = e.metaKey;\n  this.platformModifierKey = goog.userAgent.MAC ? e.metaKey : e.ctrlKey;\n  this.state = e.state;\n  this.event_ = e;\n  if (e.defaultPrevented) {\n    this.preventDefault();\n  }\n};\n\n\n/**\n * Tests to see which button was pressed during the event. This is really only\n * useful in IE and Gecko browsers. And in IE, it's only useful for\n * mousedown/mouseup events, because click only fires for the left mouse button.\n *\n * Safari 2 only reports the left button being clicked, and uses the value '1'\n * instead of 0. Opera only reports a mousedown event for the middle button, and\n * no mouse events for the right button. Opera has default behavior for left and\n * middle click that can only be overridden via a configuration setting.\n *\n * There's a nice table of this mess at http://www.unixpapa.com/js/mouse.html.\n *\n * @param {goog.events.BrowserEvent.MouseButton} button The button\n *     to test for.\n * @return {boolean} True if button was pressed.\n */\ngoog.events.BrowserEvent.prototype.isButton = function(button) {\n  if (!goog.events.BrowserFeature.HAS_W3C_BUTTON) {\n    if (this.type == 'click') {\n      return button == goog.events.BrowserEvent.MouseButton.LEFT;\n    } else {\n      return !!(\n          this.event_.button & goog.events.BrowserEvent.IEButtonMap[button]);\n    }\n  } else {\n    return this.event_.button == button;\n  }\n};\n\n\n/**\n * Whether this has an \"action\"-producing mouse button.\n *\n * By definition, this includes left-click on windows/linux, and left-click\n * without the ctrl key on Macs.\n *\n * @return {boolean} The result.\n */\ngoog.events.BrowserEvent.prototype.isMouseActionButton = function() {\n  // Webkit does not ctrl+click to be a right-click, so we\n  // normalize it to behave like Gecko and Opera.\n  return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT) &&\n      !(goog.userAgent.WEBKIT && goog.userAgent.MAC && this.ctrlKey);\n};\n\n\n/**\n * @override\n */\ngoog.events.BrowserEvent.prototype.stopPropagation = function() {\n  goog.events.BrowserEvent.superClass_.stopPropagation.call(this);\n  if (this.event_.stopPropagation) {\n    this.event_.stopPropagation();\n  } else {\n    this.event_.cancelBubble = true;\n  }\n};\n\n\n/**\n * @override\n */\ngoog.events.BrowserEvent.prototype.preventDefault = function() {\n  goog.events.BrowserEvent.superClass_.preventDefault.call(this);\n  var be = this.event_;\n  if (!be.preventDefault) {\n    be.returnValue = false;\n    if (goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT) {\n      /** @preserveTry */\n      try {\n        // Most keys can be prevented using returnValue. Some special keys\n        // require setting the keyCode to -1 as well:\n        //\n        // In IE7:\n        // F3, F5, F10, F11, Ctrl+P, Crtl+O, Ctrl+F (these are taken from IE6)\n        //\n        // In IE8:\n        // Ctrl+P, Crtl+O, Ctrl+F (F1-F12 cannot be stopped through the event)\n        //\n        // We therefore do this for all function keys as well as when Ctrl key\n        // is pressed.\n        var VK_F1 = 112;\n        var VK_F12 = 123;\n        if (be.ctrlKey || be.keyCode >= VK_F1 && be.keyCode <= VK_F12) {\n          be.keyCode = -1;\n        }\n      } catch (ex) {\n        // IE throws an 'access denied' exception when trying to change\n        // keyCode in some situations (e.g. srcElement is input[type=file],\n        // or srcElement is an anchor tag rewritten by parent's innerHTML).\n        // Do nothing in this case.\n      }\n    }\n  } else {\n    be.preventDefault();\n  }\n};\n\n\n/**\n * @return {Event} The underlying browser event object.\n */\ngoog.events.BrowserEvent.prototype.getBrowserEvent = function() {\n  return this.event_;\n};\n","// Copyright 2012 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview An interface for a listenable JavaScript object.\n * @author chrishenry@google.com (Chris Henry)\n */\n\ngoog.provide('goog.events.Listenable');\ngoog.provide('goog.events.ListenableKey');\n\n/** @suppress {extraRequire} */\ngoog.require('goog.events.EventId');\n\ngoog.forwardDeclare('goog.events.EventLike');\ngoog.forwardDeclare('goog.events.EventTarget');\n\n\n\n/**\n * A listenable interface. A listenable is an object with the ability\n * to dispatch/broadcast events to \"event listeners\" registered via\n * listen/listenOnce.\n *\n * The interface allows for an event propagation mechanism similar\n * to one offered by native browser event targets, such as\n * capture/bubble mechanism, stopping propagation, and preventing\n * default actions. Capture/bubble mechanism depends on the ancestor\n * tree constructed via {@code #getParentEventTarget}; this tree\n * must be directed acyclic graph. The meaning of default action(s)\n * in preventDefault is specific to a particular use case.\n *\n * Implementations that do not support capture/bubble or can not have\n * a parent listenable can simply not implement any ability to set the\n * parent listenable (and have {@code #getParentEventTarget} return\n * null).\n *\n * Implementation of this class can be used with or independently from\n * goog.events.\n *\n * Implementation must call {@code #addImplementation(implClass)}.\n *\n * @interface\n * @see goog.events\n * @see http://www.w3.org/TR/DOM-Level-2-Events/events.html\n */\ngoog.events.Listenable = function() {};\n\n\n/**\n * An expando property to indicate that an object implements\n * goog.events.Listenable.\n *\n * See addImplementation/isImplementedBy.\n *\n * @type {string}\n * @const\n */\ngoog.events.Listenable.IMPLEMENTED_BY_PROP =\n    'closure_listenable_' + ((Math.random() * 1e6) | 0);\n\n\n/**\n * Marks a given class (constructor) as an implementation of\n * Listenable, do that we can query that fact at runtime. The class\n * must have already implemented the interface.\n * @param {!Function} cls The class constructor. The corresponding\n *     class must have already implemented the interface.\n */\ngoog.events.Listenable.addImplementation = function(cls) {\n  cls.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP] = true;\n};\n\n\n/**\n * @param {Object} obj The object to check.\n * @return {boolean} Whether a given instance implements Listenable. The\n *     class/superclass of the instance must call addImplementation.\n */\ngoog.events.Listenable.isImplementedBy = function(obj) {\n  return !!(obj && obj[goog.events.Listenable.IMPLEMENTED_BY_PROP]);\n};\n\n\n/**\n * Adds an event listener. A listener can only be added once to an\n * object and if it is added again the key for the listener is\n * returned. Note that if the existing listener is a one-off listener\n * (registered via listenOnce), it will no longer be a one-off\n * listener after a call to listen().\n *\n * @param {string|!goog.events.EventId<EVENTOBJ>} type The event type id.\n * @param {function(this:SCOPE, EVENTOBJ):(boolean|undefined)} listener Callback\n *     method.\n * @param {boolean=} opt_useCapture Whether to fire in capture phase\n *     (defaults to false).\n * @param {SCOPE=} opt_listenerScope Object in whose scope to call the\n *     listener.\n * @return {!goog.events.ListenableKey} Unique key for the listener.\n * @template SCOPE,EVENTOBJ\n */\ngoog.events.Listenable.prototype.listen;\n\n\n/**\n * Adds an event listener that is removed automatically after the\n * listener fired once.\n *\n * If an existing listener already exists, listenOnce will do\n * nothing. In particular, if the listener was previously registered\n * via listen(), listenOnce() will not turn the listener into a\n * one-off listener. Similarly, if there is already an existing\n * one-off listener, listenOnce does not modify the listeners (it is\n * still a once listener).\n *\n * @param {string|!goog.events.EventId<EVENTOBJ>} type The event type id.\n * @param {function(this:SCOPE, EVENTOBJ):(boolean|undefined)} listener Callback\n *     method.\n * @param {boolean=} opt_useCapture Whether to fire in capture phase\n *     (defaults to false).\n * @param {SCOPE=} opt_listenerScope Object in whose scope to call the\n *     listener.\n * @return {!goog.events.ListenableKey} Unique key for the listener.\n * @template SCOPE,EVENTOBJ\n */\ngoog.events.Listenable.prototype.listenOnce;\n\n\n/**\n * Removes an event listener which was added with listen() or listenOnce().\n *\n * @param {string|!goog.events.EventId<EVENTOBJ>} type The event type id.\n * @param {function(this:SCOPE, EVENTOBJ):(boolean|undefined)} listener Callback\n *     method.\n * @param {boolean=} opt_useCapture Whether to fire in capture phase\n *     (defaults to false).\n * @param {SCOPE=} opt_listenerScope Object in whose scope to call\n *     the listener.\n * @return {boolean} Whether any listener was removed.\n * @template SCOPE,EVENTOBJ\n */\ngoog.events.Listenable.prototype.unlisten;\n\n\n/**\n * Removes an event listener which was added with listen() by the key\n * returned by listen().\n *\n * @param {!goog.events.ListenableKey} key The key returned by\n *     listen() or listenOnce().\n * @return {boolean} Whether any listener was removed.\n */\ngoog.events.Listenable.prototype.unlistenByKey;\n\n\n/**\n * Dispatches an event (or event like object) and calls all listeners\n * listening for events of this type. The type of the event is decided by the\n * type property on the event object.\n *\n * If any of the listeners returns false OR calls preventDefault then this\n * function will return false.  If one of the capture listeners calls\n * stopPropagation, then the bubble listeners won't fire.\n *\n * @param {goog.events.EventLike} e Event object.\n * @return {boolean} If anyone called preventDefault on the event object (or\n *     if any of the listeners returns false) this will also return false.\n */\ngoog.events.Listenable.prototype.dispatchEvent;\n\n\n/**\n * Removes all listeners from this listenable. If type is specified,\n * it will only remove listeners of the particular type. otherwise all\n * registered listeners will be removed.\n *\n * @param {string=} opt_type Type of event to remove, default is to\n *     remove all types.\n * @return {number} Number of listeners removed.\n */\ngoog.events.Listenable.prototype.removeAllListeners;\n\n\n/**\n * Returns the parent of this event target to use for capture/bubble\n * mechanism.\n *\n * NOTE(chrishenry): The name reflects the original implementation of\n * custom event target ({@code goog.events.EventTarget}). We decided\n * that changing the name is not worth it.\n *\n * @return {goog.events.Listenable} The parent EventTarget or null if\n *     there is no parent.\n */\ngoog.events.Listenable.prototype.getParentEventTarget;\n\n\n/**\n * Fires all registered listeners in this listenable for the given\n * type and capture mode, passing them the given eventObject. This\n * does not perform actual capture/bubble. Only implementors of the\n * interface should be using this.\n *\n * @param {string|!goog.events.EventId<EVENTOBJ>} type The type of the\n *     listeners to fire.\n * @param {boolean} capture The capture mode of the listeners to fire.\n * @param {EVENTOBJ} eventObject The event object to fire.\n * @return {boolean} Whether all listeners succeeded without\n *     attempting to prevent default behavior. If any listener returns\n *     false or called goog.events.Event#preventDefault, this returns\n *     false.\n * @template EVENTOBJ\n */\ngoog.events.Listenable.prototype.fireListeners;\n\n\n/**\n * Gets all listeners in this listenable for the given type and\n * capture mode.\n *\n * @param {string|!goog.events.EventId} type The type of the listeners to fire.\n * @param {boolean} capture The capture mode of the listeners to fire.\n * @return {!Array<!goog.events.ListenableKey>} An array of registered\n *     listeners.\n * @template EVENTOBJ\n */\ngoog.events.Listenable.prototype.getListeners;\n\n\n/**\n * Gets the goog.events.ListenableKey for the event or null if no such\n * listener is in use.\n *\n * @param {string|!goog.events.EventId<EVENTOBJ>} type The name of the event\n *     without the 'on' prefix.\n * @param {function(this:SCOPE, EVENTOBJ):(boolean|undefined)} listener The\n *     listener function to get.\n * @param {boolean} capture Whether the listener is a capturing listener.\n * @param {SCOPE=} opt_listenerScope Object in whose scope to call the\n *     listener.\n * @return {goog.events.ListenableKey} the found listener or null if not found.\n * @template SCOPE,EVENTOBJ\n */\ngoog.events.Listenable.prototype.getListener;\n\n\n/**\n * Whether there is any active listeners matching the specified\n * signature. If either the type or capture parameters are\n * unspecified, the function will match on the remaining criteria.\n *\n * @param {string|!goog.events.EventId<EVENTOBJ>=} opt_type Event type.\n * @param {boolean=} opt_capture Whether to check for capture or bubble\n *     listeners.\n * @return {boolean} Whether there is any active listeners matching\n *     the requested type and/or capture phase.\n * @template EVENTOBJ\n */\ngoog.events.Listenable.prototype.hasListener;\n\n\n\n/**\n * An interface that describes a single registered listener.\n * @interface\n */\ngoog.events.ListenableKey = function() {};\n\n\n/**\n * Counter used to create a unique key\n * @type {number}\n * @private\n */\ngoog.events.ListenableKey.counter_ = 0;\n\n\n/**\n * Reserves a key to be used for ListenableKey#key field.\n * @return {number} A number to be used to fill ListenableKey#key\n *     field.\n */\ngoog.events.ListenableKey.reserveKey = function() {\n  return ++goog.events.ListenableKey.counter_;\n};\n\n\n/**\n * The source event target.\n * @type {Object|goog.events.Listenable|goog.events.EventTarget}\n */\ngoog.events.ListenableKey.prototype.src;\n\n\n/**\n * The event type the listener is listening to.\n * @type {string}\n */\ngoog.events.ListenableKey.prototype.type;\n\n\n/**\n * The listener function.\n * @type {function(?):?|{handleEvent:function(?):?}|null}\n */\ngoog.events.ListenableKey.prototype.listener;\n\n\n/**\n * Whether the listener works on capture phase.\n * @type {boolean}\n */\ngoog.events.ListenableKey.prototype.capture;\n\n\n/**\n * The 'this' object for the listener function's scope.\n * @type {Object|undefined}\n */\ngoog.events.ListenableKey.prototype.handler;\n\n\n/**\n * A globally unique number to identify the key.\n * @type {number}\n */\ngoog.events.ListenableKey.prototype.key;\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Listener object.\n * @see ../demos/events.html\n */\n\ngoog.provide('goog.events.Listener');\n\ngoog.require('goog.events.ListenableKey');\n\n\n\n/**\n * Simple class that stores information about a listener\n * @param {function(?):?} listener Callback function.\n * @param {Function} proxy Wrapper for the listener that patches the event.\n * @param {EventTarget|goog.events.Listenable} src Source object for\n *     the event.\n * @param {string} type Event type.\n * @param {boolean} capture Whether in capture or bubble phase.\n * @param {Object=} opt_handler Object in whose context to execute the callback.\n * @implements {goog.events.ListenableKey}\n * @constructor\n */\ngoog.events.Listener = function(\n    listener, proxy, src, type, capture, opt_handler) {\n  if (goog.events.Listener.ENABLE_MONITORING) {\n    this.creationStack = new Error().stack;\n  }\n\n  /** @override */\n  this.listener = listener;\n\n  /**\n   * A wrapper over the original listener. This is used solely to\n   * handle native browser events (it is used to simulate the capture\n   * phase and to patch the event object).\n   * @type {Function}\n   */\n  this.proxy = proxy;\n\n  /**\n   * Object or node that callback is listening to\n   * @type {EventTarget|goog.events.Listenable}\n   */\n  this.src = src;\n\n  /**\n   * The event type.\n   * @const {string}\n   */\n  this.type = type;\n\n  /**\n   * Whether the listener is being called in the capture or bubble phase\n   * @const {boolean}\n   */\n  this.capture = !!capture;\n\n  /**\n   * Optional object whose context to execute the listener in\n   * @type {Object|undefined}\n   */\n  this.handler = opt_handler;\n\n  /**\n   * The key of the listener.\n   * @const {number}\n   * @override\n   */\n  this.key = goog.events.ListenableKey.reserveKey();\n\n  /**\n   * Whether to remove the listener after it has been called.\n   * @type {boolean}\n   */\n  this.callOnce = false;\n\n  /**\n   * Whether the listener has been removed.\n   * @type {boolean}\n   */\n  this.removed = false;\n};\n\n\n/**\n * @define {boolean} Whether to enable the monitoring of the\n *     goog.events.Listener instances. Switching on the monitoring is only\n *     recommended for debugging because it has a significant impact on\n *     performance and memory usage. If switched off, the monitoring code\n *     compiles down to 0 bytes.\n */\ngoog.define('goog.events.Listener.ENABLE_MONITORING', false);\n\n\n/**\n * If monitoring the goog.events.Listener instances is enabled, stores the\n * creation stack trace of the Disposable instance.\n * @type {string}\n */\ngoog.events.Listener.prototype.creationStack;\n\n\n/**\n * Marks this listener as removed. This also remove references held by\n * this listener object (such as listener and event source).\n */\ngoog.events.Listener.prototype.markAsRemoved = function() {\n  this.removed = true;\n  this.listener = null;\n  this.proxy = null;\n  this.src = null;\n  this.handler = null;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A map of listeners that provides utility functions to\n * deal with listeners on an event target. Used by\n * {@code goog.events.EventTarget}.\n *\n * WARNING: Do not use this class from outside goog.events package.\n *\n * @visibility {//closure/goog/bin/sizetests:__pkg__}\n * @visibility {//closure/goog:__pkg__}\n * @visibility {//closure/goog/events:__pkg__}\n * @visibility {//closure/goog/labs/events:__pkg__}\n */\n\ngoog.provide('goog.events.ListenerMap');\n\ngoog.require('goog.array');\ngoog.require('goog.events.Listener');\ngoog.require('goog.object');\n\n\n\n/**\n * Creates a new listener map.\n * @param {EventTarget|goog.events.Listenable} src The src object.\n * @constructor\n * @final\n */\ngoog.events.ListenerMap = function(src) {\n  /** @type {EventTarget|goog.events.Listenable} */\n  this.src = src;\n\n  /**\n   * Maps of event type to an array of listeners.\n   * @type {!Object<string, !Array<!goog.events.Listener>>}\n   */\n  this.listeners = {};\n\n  /**\n   * The count of types in this map that have registered listeners.\n   * @private {number}\n   */\n  this.typeCount_ = 0;\n};\n\n\n/**\n * @return {number} The count of event types in this map that actually\n *     have registered listeners.\n */\ngoog.events.ListenerMap.prototype.getTypeCount = function() {\n  return this.typeCount_;\n};\n\n\n/**\n * @return {number} Total number of registered listeners.\n */\ngoog.events.ListenerMap.prototype.getListenerCount = function() {\n  var count = 0;\n  for (var type in this.listeners) {\n    count += this.listeners[type].length;\n  }\n  return count;\n};\n\n\n/**\n * Adds an event listener. A listener can only be added once to an\n * object and if it is added again the key for the listener is\n * returned.\n *\n * Note that a one-off listener will not change an existing listener,\n * if any. On the other hand a normal listener will change existing\n * one-off listener to become a normal listener.\n *\n * @param {string|!goog.events.EventId} type The listener event type.\n * @param {!Function} listener This listener callback method.\n * @param {boolean} callOnce Whether the listener is a one-off\n *     listener.\n * @param {boolean=} opt_useCapture The capture mode of the listener.\n * @param {Object=} opt_listenerScope Object in whose scope to call the\n *     listener.\n * @return {!goog.events.ListenableKey} Unique key for the listener.\n */\ngoog.events.ListenerMap.prototype.add = function(\n    type, listener, callOnce, opt_useCapture, opt_listenerScope) {\n  var typeStr = type.toString();\n  var listenerArray = this.listeners[typeStr];\n  if (!listenerArray) {\n    listenerArray = this.listeners[typeStr] = [];\n    this.typeCount_++;\n  }\n\n  var listenerObj;\n  var index = goog.events.ListenerMap.findListenerIndex_(\n      listenerArray, listener, opt_useCapture, opt_listenerScope);\n  if (index > -1) {\n    listenerObj = listenerArray[index];\n    if (!callOnce) {\n      // Ensure that, if there is an existing callOnce listener, it is no\n      // longer a callOnce listener.\n      listenerObj.callOnce = false;\n    }\n  } else {\n    listenerObj = new goog.events.Listener(\n        listener, null, this.src, typeStr, !!opt_useCapture, opt_listenerScope);\n    listenerObj.callOnce = callOnce;\n    listenerArray.push(listenerObj);\n  }\n  return listenerObj;\n};\n\n\n/**\n * Removes a matching listener.\n * @param {string|!goog.events.EventId} type The listener event type.\n * @param {!Function} listener This listener callback method.\n * @param {boolean=} opt_useCapture The capture mode of the listener.\n * @param {Object=} opt_listenerScope Object in whose scope to call the\n *     listener.\n * @return {boolean} Whether any listener was removed.\n */\ngoog.events.ListenerMap.prototype.remove = function(\n    type, listener, opt_useCapture, opt_listenerScope) {\n  var typeStr = type.toString();\n  if (!(typeStr in this.listeners)) {\n    return false;\n  }\n\n  var listenerArray = this.listeners[typeStr];\n  var index = goog.events.ListenerMap.findListenerIndex_(\n      listenerArray, listener, opt_useCapture, opt_listenerScope);\n  if (index > -1) {\n    var listenerObj = listenerArray[index];\n    listenerObj.markAsRemoved();\n    goog.array.removeAt(listenerArray, index);\n    if (listenerArray.length == 0) {\n      delete this.listeners[typeStr];\n      this.typeCount_--;\n    }\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Removes the given listener object.\n * @param {!goog.events.ListenableKey} listener The listener to remove.\n * @return {boolean} Whether the listener is removed.\n */\ngoog.events.ListenerMap.prototype.removeByKey = function(listener) {\n  var type = listener.type;\n  if (!(type in this.listeners)) {\n    return false;\n  }\n\n  var removed = goog.array.remove(this.listeners[type], listener);\n  if (removed) {\n    /** @type {!goog.events.Listener} */ (listener).markAsRemoved();\n    if (this.listeners[type].length == 0) {\n      delete this.listeners[type];\n      this.typeCount_--;\n    }\n  }\n  return removed;\n};\n\n\n/**\n * Removes all listeners from this map. If opt_type is provided, only\n * listeners that match the given type are removed.\n * @param {string|!goog.events.EventId=} opt_type Type of event to remove.\n * @return {number} Number of listeners removed.\n */\ngoog.events.ListenerMap.prototype.removeAll = function(opt_type) {\n  var typeStr = opt_type && opt_type.toString();\n  var count = 0;\n  for (var type in this.listeners) {\n    if (!typeStr || type == typeStr) {\n      var listenerArray = this.listeners[type];\n      for (var i = 0; i < listenerArray.length; i++) {\n        ++count;\n        listenerArray[i].markAsRemoved();\n      }\n      delete this.listeners[type];\n      this.typeCount_--;\n    }\n  }\n  return count;\n};\n\n\n/**\n * Gets all listeners that match the given type and capture mode. The\n * returned array is a copy (but the listener objects are not).\n * @param {string|!goog.events.EventId} type The type of the listeners\n *     to retrieve.\n * @param {boolean} capture The capture mode of the listeners to retrieve.\n * @return {!Array<!goog.events.ListenableKey>} An array of matching\n *     listeners.\n */\ngoog.events.ListenerMap.prototype.getListeners = function(type, capture) {\n  var listenerArray = this.listeners[type.toString()];\n  var rv = [];\n  if (listenerArray) {\n    for (var i = 0; i < listenerArray.length; ++i) {\n      var listenerObj = listenerArray[i];\n      if (listenerObj.capture == capture) {\n        rv.push(listenerObj);\n      }\n    }\n  }\n  return rv;\n};\n\n\n/**\n * Gets the goog.events.ListenableKey for the event or null if no such\n * listener is in use.\n *\n * @param {string|!goog.events.EventId} type The type of the listener\n *     to retrieve.\n * @param {!Function} listener The listener function to get.\n * @param {boolean} capture Whether the listener is a capturing listener.\n * @param {Object=} opt_listenerScope Object in whose scope to call the\n *     listener.\n * @return {goog.events.ListenableKey} the found listener or null if not found.\n */\ngoog.events.ListenerMap.prototype.getListener = function(\n    type, listener, capture, opt_listenerScope) {\n  var listenerArray = this.listeners[type.toString()];\n  var i = -1;\n  if (listenerArray) {\n    i = goog.events.ListenerMap.findListenerIndex_(\n        listenerArray, listener, capture, opt_listenerScope);\n  }\n  return i > -1 ? listenerArray[i] : null;\n};\n\n\n/**\n * Whether there is a matching listener. If either the type or capture\n * parameters are unspecified, the function will match on the\n * remaining criteria.\n *\n * @param {string|!goog.events.EventId=} opt_type The type of the listener.\n * @param {boolean=} opt_capture The capture mode of the listener.\n * @return {boolean} Whether there is an active listener matching\n *     the requested type and/or capture phase.\n */\ngoog.events.ListenerMap.prototype.hasListener = function(\n    opt_type, opt_capture) {\n  var hasType = goog.isDef(opt_type);\n  var typeStr = hasType ? opt_type.toString() : '';\n  var hasCapture = goog.isDef(opt_capture);\n\n  return goog.object.some(this.listeners, function(listenerArray, type) {\n    for (var i = 0; i < listenerArray.length; ++i) {\n      if ((!hasType || listenerArray[i].type == typeStr) &&\n          (!hasCapture || listenerArray[i].capture == opt_capture)) {\n        return true;\n      }\n    }\n\n    return false;\n  });\n};\n\n\n/**\n * Finds the index of a matching goog.events.Listener in the given\n * listenerArray.\n * @param {!Array<!goog.events.Listener>} listenerArray Array of listener.\n * @param {!Function} listener The listener function.\n * @param {boolean=} opt_useCapture The capture flag for the listener.\n * @param {Object=} opt_listenerScope The listener scope.\n * @return {number} The index of the matching listener within the\n *     listenerArray.\n * @private\n */\ngoog.events.ListenerMap.findListenerIndex_ = function(\n    listenerArray, listener, opt_useCapture, opt_listenerScope) {\n  for (var i = 0; i < listenerArray.length; ++i) {\n    var listenerObj = listenerArray[i];\n    if (!listenerObj.removed && listenerObj.listener == listener &&\n        listenerObj.capture == !!opt_useCapture &&\n        listenerObj.handler == opt_listenerScope) {\n      return i;\n    }\n  }\n  return -1;\n};\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview An event manager for both native browser event\n * targets and custom JavaScript event targets\n * ({@code goog.events.Listenable}). This provides an abstraction\n * over browsers' event systems.\n *\n * It also provides a simulation of W3C event model's capture phase in\n * Internet Explorer (IE 8 and below). Caveat: the simulation does not\n * interact well with listeners registered directly on the elements\n * (bypassing goog.events) or even with listeners registered via\n * goog.events in a separate JS binary. In these cases, we provide\n * no ordering guarantees.\n *\n * The listeners will receive a \"patched\" event object. Such event object\n * contains normalized values for certain event properties that differs in\n * different browsers.\n *\n * Example usage:\n * <pre>\n * goog.events.listen(myNode, 'click', function(e) { alert('woo') });\n * goog.events.listen(myNode, 'mouseover', mouseHandler, true);\n * goog.events.unlisten(myNode, 'mouseover', mouseHandler, true);\n * goog.events.removeAll(myNode);\n * </pre>\n *\n *                                            in IE and event object patching]\n * @author arv@google.com (Erik Arvidsson)\n *\n * @see ../demos/events.html\n * @see ../demos/event-propagation.html\n * @see ../demos/stopevent.html\n */\n\n// IMPLEMENTATION NOTES:\n// goog.events stores an auxiliary data structure on each EventTarget\n// source being listened on. This allows us to take advantage of GC,\n// having the data structure GC'd when the EventTarget is GC'd. This\n// GC behavior is equivalent to using W3C DOM Events directly.\n\ngoog.provide('goog.events');\ngoog.provide('goog.events.CaptureSimulationMode');\ngoog.provide('goog.events.Key');\ngoog.provide('goog.events.ListenableType');\n\ngoog.require('goog.asserts');\ngoog.require('goog.debug.entryPointRegistry');\ngoog.require('goog.events.BrowserEvent');\ngoog.require('goog.events.BrowserFeature');\ngoog.require('goog.events.Listenable');\ngoog.require('goog.events.ListenerMap');\n\ngoog.forwardDeclare('goog.debug.ErrorHandler');\ngoog.forwardDeclare('goog.events.EventWrapper');\n\n\n/**\n * @typedef {number|goog.events.ListenableKey}\n */\ngoog.events.Key;\n\n\n/**\n * @typedef {EventTarget|goog.events.Listenable}\n */\ngoog.events.ListenableType;\n\n\n/**\n * Property name on a native event target for the listener map\n * associated with the event target.\n * @private @const {string}\n */\ngoog.events.LISTENER_MAP_PROP_ = 'closure_lm_' + ((Math.random() * 1e6) | 0);\n\n\n/**\n * String used to prepend to IE event types.\n * @const\n * @private\n */\ngoog.events.onString_ = 'on';\n\n\n/**\n * Map of computed \"on<eventname>\" strings for IE event types. Caching\n * this removes an extra object allocation in goog.events.listen which\n * improves IE6 performance.\n * @const\n * @dict\n * @private\n */\ngoog.events.onStringMap_ = {};\n\n\n/**\n * @enum {number} Different capture simulation mode for IE8-.\n */\ngoog.events.CaptureSimulationMode = {\n  /**\n   * Does not perform capture simulation. Will asserts in IE8- when you\n   * add capture listeners.\n   */\n  OFF_AND_FAIL: 0,\n\n  /**\n   * Does not perform capture simulation, silently ignore capture\n   * listeners.\n   */\n  OFF_AND_SILENT: 1,\n\n  /**\n   * Performs capture simulation.\n   */\n  ON: 2\n};\n\n\n/**\n * @define {number} The capture simulation mode for IE8-. By default,\n *     this is ON.\n */\ngoog.define('goog.events.CAPTURE_SIMULATION_MODE', 2);\n\n\n/**\n * Estimated count of total native listeners.\n * @private {number}\n */\ngoog.events.listenerCountEstimate_ = 0;\n\n\n/**\n * Adds an event listener for a specific event on a native event\n * target (such as a DOM element) or an object that has implemented\n * {@link goog.events.Listenable}. A listener can only be added once\n * to an object and if it is added again the key for the listener is\n * returned. Note that if the existing listener is a one-off listener\n * (registered via listenOnce), it will no longer be a one-off\n * listener after a call to listen().\n *\n * @param {EventTarget|goog.events.Listenable} src The node to listen\n *     to events on.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type or array of event types.\n * @param {function(this:T, EVENTOBJ):?|{handleEvent:function(?):?}|null}\n *     listener Callback method, or an object with a handleEvent function.\n *     WARNING: passing an Object is now softly deprecated.\n * @param {boolean=} opt_capt Whether to fire in capture phase (defaults to\n *     false).\n * @param {T=} opt_handler Element in whose scope to call the listener.\n * @return {goog.events.Key} Unique key for the listener.\n * @template T,EVENTOBJ\n */\ngoog.events.listen = function(src, type, listener, opt_capt, opt_handler) {\n  if (goog.isArray(type)) {\n    for (var i = 0; i < type.length; i++) {\n      goog.events.listen(src, type[i], listener, opt_capt, opt_handler);\n    }\n    return null;\n  }\n\n  listener = goog.events.wrapListener(listener);\n  if (goog.events.Listenable.isImplementedBy(src)) {\n    return src.listen(\n        /** @type {string|!goog.events.EventId} */ (type), listener, opt_capt,\n        opt_handler);\n  } else {\n    return goog.events.listen_(\n        /** @type {!EventTarget} */ (src),\n        /** @type {string|!goog.events.EventId} */ (type), listener,\n        /* callOnce */ false, opt_capt, opt_handler);\n  }\n};\n\n\n/**\n * Adds an event listener for a specific event on a native event\n * target. A listener can only be added once to an object and if it\n * is added again the key for the listener is returned.\n *\n * Note that a one-off listener will not change an existing listener,\n * if any. On the other hand a normal listener will change existing\n * one-off listener to become a normal listener.\n *\n * @param {EventTarget} src The node to listen to events on.\n * @param {string|!goog.events.EventId} type Event type.\n * @param {!Function} listener Callback function.\n * @param {boolean} callOnce Whether the listener is a one-off\n *     listener or otherwise.\n * @param {boolean=} opt_capt Whether to fire in capture phase (defaults to\n *     false).\n * @param {Object=} opt_handler Element in whose scope to call the listener.\n * @return {goog.events.ListenableKey} Unique key for the listener.\n * @private\n */\ngoog.events.listen_ = function(\n    src, type, listener, callOnce, opt_capt, opt_handler) {\n  if (!type) {\n    throw Error('Invalid event type');\n  }\n\n  var capture = !!opt_capt;\n  if (capture && !goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT) {\n    if (goog.events.CAPTURE_SIMULATION_MODE ==\n        goog.events.CaptureSimulationMode.OFF_AND_FAIL) {\n      goog.asserts.fail('Can not register capture listener in IE8-.');\n      return null;\n    } else if (\n        goog.events.CAPTURE_SIMULATION_MODE ==\n        goog.events.CaptureSimulationMode.OFF_AND_SILENT) {\n      return null;\n    }\n  }\n\n  var listenerMap = goog.events.getListenerMap_(src);\n  if (!listenerMap) {\n    src[goog.events.LISTENER_MAP_PROP_] = listenerMap =\n        new goog.events.ListenerMap(src);\n  }\n\n  var listenerObj = /** @type {goog.events.Listener} */ (\n      listenerMap.add(type, listener, callOnce, opt_capt, opt_handler));\n\n  // If the listenerObj already has a proxy, it has been set up\n  // previously. We simply return.\n  if (listenerObj.proxy) {\n    return listenerObj;\n  }\n\n  var proxy = goog.events.getProxy();\n  listenerObj.proxy = proxy;\n\n  proxy.src = src;\n  proxy.listener = listenerObj;\n\n  // Attach the proxy through the browser's API\n  if (src.addEventListener) {\n    src.addEventListener(type.toString(), proxy, capture);\n  } else if (src.attachEvent) {\n    // The else if above used to be an unconditional else. It would call\n    // exception on IE11, spoiling the day of some callers. The previous\n    // incarnation of this code, from 2007, indicates that it replaced an\n    // earlier still version that caused excess allocations on IE6.\n    src.attachEvent(goog.events.getOnString_(type.toString()), proxy);\n  } else {\n    throw Error('addEventListener and attachEvent are unavailable.');\n  }\n\n  goog.events.listenerCountEstimate_++;\n  return listenerObj;\n};\n\n\n/**\n * Helper function for returning a proxy function.\n * @return {!Function} A new or reused function object.\n */\ngoog.events.getProxy = function() {\n  var proxyCallbackFunction = goog.events.handleBrowserEvent_;\n  // Use a local var f to prevent one allocation.\n  var f =\n      goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT ? function(eventObject) {\n        return proxyCallbackFunction.call(f.src, f.listener, eventObject);\n      } : function(eventObject) {\n        var v = proxyCallbackFunction.call(f.src, f.listener, eventObject);\n        // NOTE(chrishenry): In IE, we hack in a capture phase. However, if\n        // there is inline event handler which tries to prevent default (for\n        // example <a href=\"...\" onclick=\"return false\">...</a>) in a\n        // descendant element, the prevent default will be overridden\n        // by this listener if this listener were to return true. Hence, we\n        // return undefined.\n        if (!v) return v;\n      };\n  return f;\n};\n\n\n/**\n * Adds an event listener for a specific event on a native event\n * target (such as a DOM element) or an object that has implemented\n * {@link goog.events.Listenable}. After the event has fired the event\n * listener is removed from the target.\n *\n * If an existing listener already exists, listenOnce will do\n * nothing. In particular, if the listener was previously registered\n * via listen(), listenOnce() will not turn the listener into a\n * one-off listener. Similarly, if there is already an existing\n * one-off listener, listenOnce does not modify the listeners (it is\n * still a once listener).\n *\n * @param {EventTarget|goog.events.Listenable} src The node to listen\n *     to events on.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type or array of event types.\n * @param {function(this:T, EVENTOBJ):?|{handleEvent:function(?):?}|null}\n *     listener Callback method.\n * @param {boolean=} opt_capt Fire in capture phase?.\n * @param {T=} opt_handler Element in whose scope to call the listener.\n * @return {goog.events.Key} Unique key for the listener.\n * @template T,EVENTOBJ\n */\ngoog.events.listenOnce = function(src, type, listener, opt_capt, opt_handler) {\n  if (goog.isArray(type)) {\n    for (var i = 0; i < type.length; i++) {\n      goog.events.listenOnce(src, type[i], listener, opt_capt, opt_handler);\n    }\n    return null;\n  }\n\n  listener = goog.events.wrapListener(listener);\n  if (goog.events.Listenable.isImplementedBy(src)) {\n    return src.listenOnce(\n        /** @type {string|!goog.events.EventId} */ (type), listener, opt_capt,\n        opt_handler);\n  } else {\n    return goog.events.listen_(\n        /** @type {!EventTarget} */ (src),\n        /** @type {string|!goog.events.EventId} */ (type), listener,\n        /* callOnce */ true, opt_capt, opt_handler);\n  }\n};\n\n\n/**\n * Adds an event listener with a specific event wrapper on a DOM Node or an\n * object that has implemented {@link goog.events.Listenable}. A listener can\n * only be added once to an object.\n *\n * @param {EventTarget|goog.events.Listenable} src The target to\n *     listen to events on.\n * @param {goog.events.EventWrapper} wrapper Event wrapper to use.\n * @param {function(this:T, ?):?|{handleEvent:function(?):?}|null} listener\n *     Callback method, or an object with a handleEvent function.\n * @param {boolean=} opt_capt Whether to fire in capture phase (defaults to\n *     false).\n * @param {T=} opt_handler Element in whose scope to call the listener.\n * @template T\n */\ngoog.events.listenWithWrapper = function(\n    src, wrapper, listener, opt_capt, opt_handler) {\n  wrapper.listen(src, listener, opt_capt, opt_handler);\n};\n\n\n/**\n * Removes an event listener which was added with listen().\n *\n * @param {EventTarget|goog.events.Listenable} src The target to stop\n *     listening to events on.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type or array of event types to unlisten to.\n * @param {function(?):?|{handleEvent:function(?):?}|null} listener The\n *     listener function to remove.\n * @param {boolean=} opt_capt In DOM-compliant browsers, this determines\n *     whether the listener is fired during the capture or bubble phase of the\n *     event.\n * @param {Object=} opt_handler Element in whose scope to call the listener.\n * @return {?boolean} indicating whether the listener was there to remove.\n * @template EVENTOBJ\n */\ngoog.events.unlisten = function(src, type, listener, opt_capt, opt_handler) {\n  if (goog.isArray(type)) {\n    for (var i = 0; i < type.length; i++) {\n      goog.events.unlisten(src, type[i], listener, opt_capt, opt_handler);\n    }\n    return null;\n  }\n\n  listener = goog.events.wrapListener(listener);\n  if (goog.events.Listenable.isImplementedBy(src)) {\n    return src.unlisten(\n        /** @type {string|!goog.events.EventId} */ (type), listener, opt_capt,\n        opt_handler);\n  }\n\n  if (!src) {\n    // TODO(chrishenry): We should tighten the API to only accept\n    // non-null objects, or add an assertion here.\n    return false;\n  }\n\n  var capture = !!opt_capt;\n  var listenerMap = goog.events.getListenerMap_(\n      /** @type {!EventTarget} */ (src));\n  if (listenerMap) {\n    var listenerObj = listenerMap.getListener(\n        /** @type {string|!goog.events.EventId} */ (type), listener, capture,\n        opt_handler);\n    if (listenerObj) {\n      return goog.events.unlistenByKey(listenerObj);\n    }\n  }\n\n  return false;\n};\n\n\n/**\n * Removes an event listener which was added with listen() by the key\n * returned by listen().\n *\n * @param {goog.events.Key} key The key returned by listen() for this\n *     event listener.\n * @return {boolean} indicating whether the listener was there to remove.\n */\ngoog.events.unlistenByKey = function(key) {\n  // TODO(chrishenry): Remove this check when tests that rely on this\n  // are fixed.\n  if (goog.isNumber(key)) {\n    return false;\n  }\n\n  var listener = key;\n  if (!listener || listener.removed) {\n    return false;\n  }\n\n  var src = listener.src;\n  if (goog.events.Listenable.isImplementedBy(src)) {\n    return /** @type {!goog.events.Listenable} */ (src).unlistenByKey(listener);\n  }\n\n  var type = listener.type;\n  var proxy = listener.proxy;\n  if (src.removeEventListener) {\n    src.removeEventListener(type, proxy, listener.capture);\n  } else if (src.detachEvent) {\n    src.detachEvent(goog.events.getOnString_(type), proxy);\n  }\n  goog.events.listenerCountEstimate_--;\n\n  var listenerMap = goog.events.getListenerMap_(\n      /** @type {!EventTarget} */ (src));\n  // TODO(chrishenry): Try to remove this conditional and execute the\n  // first branch always. This should be safe.\n  if (listenerMap) {\n    listenerMap.removeByKey(listener);\n    if (listenerMap.getTypeCount() == 0) {\n      // Null the src, just because this is simple to do (and useful\n      // for IE <= 7).\n      listenerMap.src = null;\n      // We don't use delete here because IE does not allow delete\n      // on a window object.\n      src[goog.events.LISTENER_MAP_PROP_] = null;\n    }\n  } else {\n    /** @type {!goog.events.Listener} */ (listener).markAsRemoved();\n  }\n\n  return true;\n};\n\n\n/**\n * Removes an event listener which was added with listenWithWrapper().\n *\n * @param {EventTarget|goog.events.Listenable} src The target to stop\n *     listening to events on.\n * @param {goog.events.EventWrapper} wrapper Event wrapper to use.\n * @param {function(?):?|{handleEvent:function(?):?}|null} listener The\n *     listener function to remove.\n * @param {boolean=} opt_capt In DOM-compliant browsers, this determines\n *     whether the listener is fired during the capture or bubble phase of the\n *     event.\n * @param {Object=} opt_handler Element in whose scope to call the listener.\n */\ngoog.events.unlistenWithWrapper = function(\n    src, wrapper, listener, opt_capt, opt_handler) {\n  wrapper.unlisten(src, listener, opt_capt, opt_handler);\n};\n\n\n/**\n * Removes all listeners from an object. You can also optionally\n * remove listeners of a particular type.\n *\n * @param {Object|undefined} obj Object to remove listeners from. Must be an\n *     EventTarget or a goog.events.Listenable.\n * @param {string|!goog.events.EventId=} opt_type Type of event to remove.\n *     Default is all types.\n * @return {number} Number of listeners removed.\n */\ngoog.events.removeAll = function(obj, opt_type) {\n  // TODO(chrishenry): Change the type of obj to\n  // (!EventTarget|!goog.events.Listenable).\n\n  if (!obj) {\n    return 0;\n  }\n\n  if (goog.events.Listenable.isImplementedBy(obj)) {\n    return /** @type {?} */ (obj).removeAllListeners(opt_type);\n  }\n\n  var listenerMap = goog.events.getListenerMap_(\n      /** @type {!EventTarget} */ (obj));\n  if (!listenerMap) {\n    return 0;\n  }\n\n  var count = 0;\n  var typeStr = opt_type && opt_type.toString();\n  for (var type in listenerMap.listeners) {\n    if (!typeStr || type == typeStr) {\n      // Clone so that we don't need to worry about unlistenByKey\n      // changing the content of the ListenerMap.\n      var listeners = listenerMap.listeners[type].concat();\n      for (var i = 0; i < listeners.length; ++i) {\n        if (goog.events.unlistenByKey(listeners[i])) {\n          ++count;\n        }\n      }\n    }\n  }\n  return count;\n};\n\n\n/**\n * Gets the listeners for a given object, type and capture phase.\n *\n * @param {Object} obj Object to get listeners for.\n * @param {string|!goog.events.EventId} type Event type.\n * @param {boolean} capture Capture phase?.\n * @return {Array<!goog.events.Listener>} Array of listener objects.\n */\ngoog.events.getListeners = function(obj, type, capture) {\n  if (goog.events.Listenable.isImplementedBy(obj)) {\n    return /** @type {!goog.events.Listenable} */ (obj).getListeners(\n        type, capture);\n  } else {\n    if (!obj) {\n      // TODO(chrishenry): We should tighten the API to accept\n      // !EventTarget|goog.events.Listenable, and add an assertion here.\n      return [];\n    }\n\n    var listenerMap = goog.events.getListenerMap_(\n        /** @type {!EventTarget} */ (obj));\n    return listenerMap ? listenerMap.getListeners(type, capture) : [];\n  }\n};\n\n\n/**\n * Gets the goog.events.Listener for the event or null if no such listener is\n * in use.\n *\n * @param {EventTarget|goog.events.Listenable} src The target from\n *     which to get listeners.\n * @param {?string|!goog.events.EventId<EVENTOBJ>} type The type of the event.\n * @param {function(EVENTOBJ):?|{handleEvent:function(?):?}|null} listener The\n *     listener function to get.\n * @param {boolean=} opt_capt In DOM-compliant browsers, this determines\n *                            whether the listener is fired during the\n *                            capture or bubble phase of the event.\n * @param {Object=} opt_handler Element in whose scope to call the listener.\n * @return {goog.events.ListenableKey} the found listener or null if not found.\n * @template EVENTOBJ\n */\ngoog.events.getListener = function(src, type, listener, opt_capt, opt_handler) {\n  // TODO(chrishenry): Change type from ?string to string, or add assertion.\n  type = /** @type {string} */ (type);\n  listener = goog.events.wrapListener(listener);\n  var capture = !!opt_capt;\n  if (goog.events.Listenable.isImplementedBy(src)) {\n    return src.getListener(type, listener, capture, opt_handler);\n  }\n\n  if (!src) {\n    // TODO(chrishenry): We should tighten the API to only accept\n    // non-null objects, or add an assertion here.\n    return null;\n  }\n\n  var listenerMap = goog.events.getListenerMap_(\n      /** @type {!EventTarget} */ (src));\n  if (listenerMap) {\n    return listenerMap.getListener(type, listener, capture, opt_handler);\n  }\n  return null;\n};\n\n\n/**\n * Returns whether an event target has any active listeners matching the\n * specified signature. If either the type or capture parameters are\n * unspecified, the function will match on the remaining criteria.\n *\n * @param {EventTarget|goog.events.Listenable} obj Target to get\n *     listeners for.\n * @param {string|!goog.events.EventId=} opt_type Event type.\n * @param {boolean=} opt_capture Whether to check for capture or bubble-phase\n *     listeners.\n * @return {boolean} Whether an event target has one or more listeners matching\n *     the requested type and/or capture phase.\n */\ngoog.events.hasListener = function(obj, opt_type, opt_capture) {\n  if (goog.events.Listenable.isImplementedBy(obj)) {\n    return obj.hasListener(opt_type, opt_capture);\n  }\n\n  var listenerMap = goog.events.getListenerMap_(\n      /** @type {!EventTarget} */ (obj));\n  return !!listenerMap && listenerMap.hasListener(opt_type, opt_capture);\n};\n\n\n/**\n * Provides a nice string showing the normalized event objects public members\n * @param {Object} e Event Object.\n * @return {string} String of the public members of the normalized event object.\n */\ngoog.events.expose = function(e) {\n  var str = [];\n  for (var key in e) {\n    if (e[key] && e[key].id) {\n      str.push(key + ' = ' + e[key] + ' (' + e[key].id + ')');\n    } else {\n      str.push(key + ' = ' + e[key]);\n    }\n  }\n  return str.join('\\n');\n};\n\n\n/**\n * Returns a string with on prepended to the specified type. This is used for IE\n * which expects \"on\" to be prepended. This function caches the string in order\n * to avoid extra allocations in steady state.\n * @param {string} type Event type.\n * @return {string} The type string with 'on' prepended.\n * @private\n */\ngoog.events.getOnString_ = function(type) {\n  if (type in goog.events.onStringMap_) {\n    return goog.events.onStringMap_[type];\n  }\n  return goog.events.onStringMap_[type] = goog.events.onString_ + type;\n};\n\n\n/**\n * Fires an object's listeners of a particular type and phase\n *\n * @param {Object} obj Object whose listeners to call.\n * @param {string|!goog.events.EventId} type Event type.\n * @param {boolean} capture Which event phase.\n * @param {Object} eventObject Event object to be passed to listener.\n * @return {boolean} True if all listeners returned true else false.\n */\ngoog.events.fireListeners = function(obj, type, capture, eventObject) {\n  if (goog.events.Listenable.isImplementedBy(obj)) {\n    return /** @type {!goog.events.Listenable} */ (obj).fireListeners(\n        type, capture, eventObject);\n  }\n\n  return goog.events.fireListeners_(obj, type, capture, eventObject);\n};\n\n\n/**\n * Fires an object's listeners of a particular type and phase.\n * @param {Object} obj Object whose listeners to call.\n * @param {string|!goog.events.EventId} type Event type.\n * @param {boolean} capture Which event phase.\n * @param {Object} eventObject Event object to be passed to listener.\n * @return {boolean} True if all listeners returned true else false.\n * @private\n */\ngoog.events.fireListeners_ = function(obj, type, capture, eventObject) {\n  /** @type {boolean} */\n  var retval = true;\n\n  var listenerMap = goog.events.getListenerMap_(\n      /** @type {EventTarget} */ (obj));\n  if (listenerMap) {\n    // TODO(chrishenry): Original code avoids array creation when there\n    // is no listener, so we do the same. If this optimization turns\n    // out to be not required, we can replace this with\n    // listenerMap.getListeners(type, capture) instead, which is simpler.\n    var listenerArray = listenerMap.listeners[type.toString()];\n    if (listenerArray) {\n      listenerArray = listenerArray.concat();\n      for (var i = 0; i < listenerArray.length; i++) {\n        var listener = listenerArray[i];\n        // We might not have a listener if the listener was removed.\n        if (listener && listener.capture == capture && !listener.removed) {\n          var result = goog.events.fireListener(listener, eventObject);\n          retval = retval && (result !== false);\n        }\n      }\n    }\n  }\n  return retval;\n};\n\n\n/**\n * Fires a listener with a set of arguments\n *\n * @param {goog.events.Listener} listener The listener object to call.\n * @param {Object} eventObject The event object to pass to the listener.\n * @return {*} Result of listener.\n */\ngoog.events.fireListener = function(listener, eventObject) {\n  var listenerFn = listener.listener;\n  var listenerHandler = listener.handler || listener.src;\n\n  if (listener.callOnce) {\n    goog.events.unlistenByKey(listener);\n  }\n  return listenerFn.call(listenerHandler, eventObject);\n};\n\n\n/**\n * Gets the total number of listeners currently in the system.\n * @return {number} Number of listeners.\n * @deprecated This returns estimated count, now that Closure no longer\n * stores a central listener registry. We still return an estimation\n * to keep existing listener-related tests passing. In the near future,\n * this function will be removed.\n */\ngoog.events.getTotalListenerCount = function() {\n  return goog.events.listenerCountEstimate_;\n};\n\n\n/**\n * Dispatches an event (or event like object) and calls all listeners\n * listening for events of this type. The type of the event is decided by the\n * type property on the event object.\n *\n * If any of the listeners returns false OR calls preventDefault then this\n * function will return false.  If one of the capture listeners calls\n * stopPropagation, then the bubble listeners won't fire.\n *\n * @param {goog.events.Listenable} src The event target.\n * @param {goog.events.EventLike} e Event object.\n * @return {boolean} If anyone called preventDefault on the event object (or\n *     if any of the handlers returns false) this will also return false.\n *     If there are no handlers, or if all handlers return true, this returns\n *     true.\n */\ngoog.events.dispatchEvent = function(src, e) {\n  goog.asserts.assert(\n      goog.events.Listenable.isImplementedBy(src),\n      'Can not use goog.events.dispatchEvent with ' +\n          'non-goog.events.Listenable instance.');\n  return src.dispatchEvent(e);\n};\n\n\n/**\n * Installs exception protection for the browser event entry point using the\n * given error handler.\n *\n * @param {goog.debug.ErrorHandler} errorHandler Error handler with which to\n *     protect the entry point.\n */\ngoog.events.protectBrowserEventEntryPoint = function(errorHandler) {\n  goog.events.handleBrowserEvent_ =\n      errorHandler.protectEntryPoint(goog.events.handleBrowserEvent_);\n};\n\n\n/**\n * Handles an event and dispatches it to the correct listeners. This\n * function is a proxy for the real listener the user specified.\n *\n * @param {goog.events.Listener} listener The listener object.\n * @param {Event=} opt_evt Optional event object that gets passed in via the\n *     native event handlers.\n * @return {*} Result of the event handler.\n * @this {EventTarget} The object or Element that fired the event.\n * @private\n */\ngoog.events.handleBrowserEvent_ = function(listener, opt_evt) {\n  if (listener.removed) {\n    return true;\n  }\n\n  // Synthesize event propagation if the browser does not support W3C\n  // event model.\n  if (!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT) {\n    var ieEvent = opt_evt ||\n        /** @type {Event} */ (goog.getObjectByName('window.event'));\n    var evt = new goog.events.BrowserEvent(ieEvent, this);\n    /** @type {*} */\n    var retval = true;\n\n    if (goog.events.CAPTURE_SIMULATION_MODE ==\n        goog.events.CaptureSimulationMode.ON) {\n      // If we have not marked this event yet, we should perform capture\n      // simulation.\n      if (!goog.events.isMarkedIeEvent_(ieEvent)) {\n        goog.events.markIeEvent_(ieEvent);\n\n        var ancestors = [];\n        for (var parent = evt.currentTarget; parent;\n             parent = parent.parentNode) {\n          ancestors.push(parent);\n        }\n\n        // Fire capture listeners.\n        var type = listener.type;\n        for (var i = ancestors.length - 1; !evt.propagationStopped_ && i >= 0;\n             i--) {\n          evt.currentTarget = ancestors[i];\n          var result =\n              goog.events.fireListeners_(ancestors[i], type, true, evt);\n          retval = retval && result;\n        }\n\n        // Fire bubble listeners.\n        //\n        // We can technically rely on IE to perform bubble event\n        // propagation. However, it turns out that IE fires events in\n        // opposite order of attachEvent registration, which broke\n        // some code and tests that rely on the order. (While W3C DOM\n        // Level 2 Events TR leaves the event ordering unspecified,\n        // modern browsers and W3C DOM Level 3 Events Working Draft\n        // actually specify the order as the registration order.)\n        for (var i = 0; !evt.propagationStopped_ && i < ancestors.length; i++) {\n          evt.currentTarget = ancestors[i];\n          var result =\n              goog.events.fireListeners_(ancestors[i], type, false, evt);\n          retval = retval && result;\n        }\n      }\n    } else {\n      retval = goog.events.fireListener(listener, evt);\n    }\n    return retval;\n  }\n\n  // Otherwise, simply fire the listener.\n  return goog.events.fireListener(\n      listener, new goog.events.BrowserEvent(opt_evt, this));\n};\n\n\n/**\n * This is used to mark the IE event object so we do not do the Closure pass\n * twice for a bubbling event.\n * @param {Event} e The IE browser event.\n * @private\n */\ngoog.events.markIeEvent_ = function(e) {\n  // Only the keyCode and the returnValue can be changed. We use keyCode for\n  // non keyboard events.\n  // event.returnValue is a bit more tricky. It is undefined by default. A\n  // boolean false prevents the default action. In a window.onbeforeunload and\n  // the returnValue is non undefined it will be alerted. However, we will only\n  // modify the returnValue for keyboard events. We can get a problem if non\n  // closure events sets the keyCode or the returnValue\n\n  var useReturnValue = false;\n\n  if (e.keyCode == 0) {\n    // We cannot change the keyCode in case that srcElement is input[type=file].\n    // We could test that that is the case but that would allocate 3 objects.\n    // If we use try/catch we will only allocate extra objects in the case of a\n    // failure.\n    /** @preserveTry */\n    try {\n      e.keyCode = -1;\n      return;\n    } catch (ex) {\n      useReturnValue = true;\n    }\n  }\n\n  if (useReturnValue ||\n      /** @type {boolean|undefined} */ (e.returnValue) == undefined) {\n    e.returnValue = true;\n  }\n};\n\n\n/**\n * This is used to check if an IE event has already been handled by the Closure\n * system so we do not do the Closure pass twice for a bubbling event.\n * @param {Event} e  The IE browser event.\n * @return {boolean} True if the event object has been marked.\n * @private\n */\ngoog.events.isMarkedIeEvent_ = function(e) {\n  return e.keyCode < 0 || e.returnValue != undefined;\n};\n\n\n/**\n * Counter to create unique event ids.\n * @private {number}\n */\ngoog.events.uniqueIdCounter_ = 0;\n\n\n/**\n * Creates a unique event id.\n *\n * @param {string} identifier The identifier.\n * @return {string} A unique identifier.\n * @idGenerator {unique}\n */\ngoog.events.getUniqueId = function(identifier) {\n  return identifier + '_' + goog.events.uniqueIdCounter_++;\n};\n\n\n/**\n * @param {EventTarget} src The source object.\n * @return {goog.events.ListenerMap} A listener map for the given\n *     source object, or null if none exists.\n * @private\n */\ngoog.events.getListenerMap_ = function(src) {\n  var listenerMap = src[goog.events.LISTENER_MAP_PROP_];\n  // IE serializes the property as well (e.g. when serializing outer\n  // HTML). So we must check that the value is of the correct type.\n  return listenerMap instanceof goog.events.ListenerMap ? listenerMap : null;\n};\n\n\n/**\n * Expando property for listener function wrapper for Object with\n * handleEvent.\n * @private @const {string}\n */\ngoog.events.LISTENER_WRAPPER_PROP_ =\n    '__closure_events_fn_' + ((Math.random() * 1e9) >>> 0);\n\n\n/**\n * @param {Object|Function} listener The listener function or an\n *     object that contains handleEvent method.\n * @return {!Function} Either the original function or a function that\n *     calls obj.handleEvent. If the same listener is passed to this\n *     function more than once, the same function is guaranteed to be\n *     returned.\n */\ngoog.events.wrapListener = function(listener) {\n  goog.asserts.assert(listener, 'Listener can not be null.');\n\n  if (goog.isFunction(listener)) {\n    return listener;\n  }\n\n  goog.asserts.assert(\n      listener.handleEvent, 'An object listener must have handleEvent method.');\n  if (!listener[goog.events.LISTENER_WRAPPER_PROP_]) {\n    listener[goog.events.LISTENER_WRAPPER_PROP_] = function(e) {\n      return /** @type {?} */ (listener).handleEvent(e);\n    };\n  }\n  return listener[goog.events.LISTENER_WRAPPER_PROP_];\n};\n\n\n// Register the browser event handler as an entry point, so that\n// it can be monitored for exception handling, etc.\ngoog.debug.entryPointRegistry.register(\n    /**\n     * @param {function(!Function): !Function} transformer The transforming\n     *     function.\n     */\n    function(transformer) {\n      goog.events.handleBrowserEvent_ =\n          transformer(goog.events.handleBrowserEvent_);\n    });\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for creating functions. Loosely inspired by the\n * java classes: http://goo.gl/GM0Hmu and http://goo.gl/6k7nI8.\n *\n * @author nicksantos@google.com (Nick Santos)\n */\n\n\ngoog.provide('goog.functions');\n\n\n/**\n * Creates a function that always returns the same value.\n * @param {T} retValue The value to return.\n * @return {function():T} The new function.\n * @template T\n */\ngoog.functions.constant = function(retValue) {\n  return function() { return retValue; };\n};\n\n\n/**\n * Always returns false.\n * @type {function(...): boolean}\n */\ngoog.functions.FALSE = goog.functions.constant(false);\n\n\n/**\n * Always returns true.\n * @type {function(...): boolean}\n */\ngoog.functions.TRUE = goog.functions.constant(true);\n\n\n/**\n * Always returns NULL.\n * @type {function(...): null}\n */\ngoog.functions.NULL = goog.functions.constant(null);\n\n\n/**\n * A simple function that returns the first argument of whatever is passed\n * into it.\n * @param {T=} opt_returnValue The single value that will be returned.\n * @param {...*} var_args Optional trailing arguments. These are ignored.\n * @return {T} The first argument passed in, or undefined if nothing was passed.\n * @template T\n */\ngoog.functions.identity = function(opt_returnValue, var_args) {\n  return opt_returnValue;\n};\n\n\n/**\n * Creates a function that always throws an error with the given message.\n * @param {string} message The error message.\n * @return {!Function} The error-throwing function.\n */\ngoog.functions.error = function(message) {\n  return function() { throw Error(message); };\n};\n\n\n/**\n * Creates a function that throws the given object.\n * @param {*} err An object to be thrown.\n * @return {!Function} The error-throwing function.\n */\ngoog.functions.fail = function(err) {\n  return function() { throw err; };\n};\n\n\n/**\n * Given a function, create a function that keeps opt_numArgs arguments and\n * silently discards all additional arguments.\n * @param {Function} f The original function.\n * @param {number=} opt_numArgs The number of arguments to keep. Defaults to 0.\n * @return {!Function} A version of f that only keeps the first opt_numArgs\n *     arguments.\n */\ngoog.functions.lock = function(f, opt_numArgs) {\n  opt_numArgs = opt_numArgs || 0;\n  return function() {\n    return f.apply(this, Array.prototype.slice.call(arguments, 0, opt_numArgs));\n  };\n};\n\n\n/**\n * Creates a function that returns its nth argument.\n * @param {number} n The position of the return argument.\n * @return {!Function} A new function.\n */\ngoog.functions.nth = function(n) {\n  return function() { return arguments[n]; };\n};\n\n\n/**\n * Like goog.partial(), except that arguments are added after arguments to the\n * returned function.\n *\n * Usage:\n * function f(arg1, arg2, arg3, arg4) { ... }\n * var g = goog.functions.partialRight(f, arg3, arg4);\n * g(arg1, arg2);\n *\n * @param {!Function} fn A function to partially apply.\n * @param {...*} var_args Additional arguments that are partially applied to fn\n *     at the end.\n * @return {!Function} A partially-applied form of the function goog.partial()\n *     was invoked as a method of.\n */\ngoog.functions.partialRight = function(fn, var_args) {\n  var rightArgs = Array.prototype.slice.call(arguments, 1);\n  return function() {\n    var newArgs = Array.prototype.slice.call(arguments);\n    newArgs.push.apply(newArgs, rightArgs);\n    return fn.apply(this, newArgs);\n  };\n};\n\n\n/**\n * Given a function, create a new function that swallows its return value\n * and replaces it with a new one.\n * @param {Function} f A function.\n * @param {T} retValue A new return value.\n * @return {function(...?):T} A new function.\n * @template T\n */\ngoog.functions.withReturnValue = function(f, retValue) {\n  return goog.functions.sequence(f, goog.functions.constant(retValue));\n};\n\n\n/**\n * Creates a function that returns whether its argument equals the given value.\n *\n * Example:\n * var key = goog.object.findKey(obj, goog.functions.equalTo('needle'));\n *\n * @param {*} value The value to compare to.\n * @param {boolean=} opt_useLooseComparison Whether to use a loose (==)\n *     comparison rather than a strict (===) one. Defaults to false.\n * @return {function(*):boolean} The new function.\n */\ngoog.functions.equalTo = function(value, opt_useLooseComparison) {\n  return function(other) {\n    return opt_useLooseComparison ? (value == other) : (value === other);\n  };\n};\n\n\n/**\n * Creates the composition of the functions passed in.\n * For example, (goog.functions.compose(f, g))(a) is equivalent to f(g(a)).\n * @param {function(...?):T} fn The final function.\n * @param {...Function} var_args A list of functions.\n * @return {function(...?):T} The composition of all inputs.\n * @template T\n */\ngoog.functions.compose = function(fn, var_args) {\n  var functions = arguments;\n  var length = functions.length;\n  return function() {\n    var result;\n    if (length) {\n      result = functions[length - 1].apply(this, arguments);\n    }\n\n    for (var i = length - 2; i >= 0; i--) {\n      result = functions[i].call(this, result);\n    }\n    return result;\n  };\n};\n\n\n/**\n * Creates a function that calls the functions passed in in sequence, and\n * returns the value of the last function. For example,\n * (goog.functions.sequence(f, g))(x) is equivalent to f(x),g(x).\n * @param {...Function} var_args A list of functions.\n * @return {!Function} A function that calls all inputs in sequence.\n */\ngoog.functions.sequence = function(var_args) {\n  var functions = arguments;\n  var length = functions.length;\n  return function() {\n    var result;\n    for (var i = 0; i < length; i++) {\n      result = functions[i].apply(this, arguments);\n    }\n    return result;\n  };\n};\n\n\n/**\n * Creates a function that returns true if each of its components evaluates\n * to true. The components are evaluated in order, and the evaluation will be\n * short-circuited as soon as a function returns false.\n * For example, (goog.functions.and(f, g))(x) is equivalent to f(x) && g(x).\n * @param {...Function} var_args A list of functions.\n * @return {function(...?):boolean} A function that ANDs its component\n *      functions.\n */\ngoog.functions.and = function(var_args) {\n  var functions = arguments;\n  var length = functions.length;\n  return function() {\n    for (var i = 0; i < length; i++) {\n      if (!functions[i].apply(this, arguments)) {\n        return false;\n      }\n    }\n    return true;\n  };\n};\n\n\n/**\n * Creates a function that returns true if any of its components evaluates\n * to true. The components are evaluated in order, and the evaluation will be\n * short-circuited as soon as a function returns true.\n * For example, (goog.functions.or(f, g))(x) is equivalent to f(x) || g(x).\n * @param {...Function} var_args A list of functions.\n * @return {function(...?):boolean} A function that ORs its component\n *    functions.\n */\ngoog.functions.or = function(var_args) {\n  var functions = arguments;\n  var length = functions.length;\n  return function() {\n    for (var i = 0; i < length; i++) {\n      if (functions[i].apply(this, arguments)) {\n        return true;\n      }\n    }\n    return false;\n  };\n};\n\n\n/**\n * Creates a function that returns the Boolean opposite of a provided function.\n * For example, (goog.functions.not(f))(x) is equivalent to !f(x).\n * @param {!Function} f The original function.\n * @return {function(...?):boolean} A function that delegates to f and returns\n * opposite.\n */\ngoog.functions.not = function(f) {\n  return function() { return !f.apply(this, arguments); };\n};\n\n\n/**\n * Generic factory function to construct an object given the constructor\n * and the arguments. Intended to be bound to create object factories.\n *\n * Example:\n *\n * var factory = goog.partial(goog.functions.create, Class);\n *\n * @param {function(new:T, ...)} constructor The constructor for the Object.\n * @param {...*} var_args The arguments to be passed to the constructor.\n * @return {T} A new instance of the class given in {@code constructor}.\n * @template T\n */\ngoog.functions.create = function(constructor, var_args) {\n  /**\n   * @constructor\n   * @final\n   */\n  var temp = function() {};\n  temp.prototype = constructor.prototype;\n\n  // obj will have constructor's prototype in its chain and\n  // 'obj instanceof constructor' will be true.\n  var obj = new temp();\n\n  // obj is initialized by constructor.\n  // arguments is only array-like so lacks shift(), but can be used with\n  // the Array prototype function.\n  constructor.apply(obj, Array.prototype.slice.call(arguments, 1));\n  return obj;\n};\n\n\n/**\n * @define {boolean} Whether the return value cache should be used.\n *    This should only be used to disable caches when testing.\n */\ngoog.define('goog.functions.CACHE_RETURN_VALUE', true);\n\n\n/**\n * Gives a wrapper function that caches the return value of a parameterless\n * function when first called.\n *\n * When called for the first time, the given function is called and its\n * return value is cached (thus this is only appropriate for idempotent\n * functions).  Subsequent calls will return the cached return value. This\n * allows the evaluation of expensive functions to be delayed until first used.\n *\n * To cache the return values of functions with parameters, see goog.memoize.\n *\n * @param {function():T} fn A function to lazily evaluate.\n * @return {function():T} A wrapped version the function.\n * @template T\n */\ngoog.functions.cacheReturnValue = function(fn) {\n  var called = false;\n  var value;\n\n  return function() {\n    if (!goog.functions.CACHE_RETURN_VALUE) {\n      return fn();\n    }\n\n    if (!called) {\n      value = fn();\n      called = true;\n    }\n\n    return value;\n  };\n};\n\n\n/**\n * Wraps a function to allow it to be called, at most, once. All\n * additional calls are no-ops.\n *\n * This is particularly useful for initialization functions\n * that should be called, at most, once.\n *\n * @param {function():*} f Function to call.\n * @return {function():undefined} Wrapped function.\n */\ngoog.functions.once = function(f) {\n  // Keep a reference to the function that we null out when we're done with\n  // it -- that way, the function can be GC'd when we're done with it.\n  var inner = f;\n  return function() {\n    if (inner) {\n      var tmp = inner;\n      inner = null;\n      tmp();\n    }\n  };\n};\n\n\n/**\n * Wraps a function to allow it to be called, at most, once per interval\n * (specified in milliseconds). If the wrapper function is called N times within\n * that interval, only the Nth call will go through.\n *\n * This is particularly useful for batching up repeated actions where the\n * last action should win. This can be used, for example, for refreshing an\n * autocomplete pop-up every so often rather than updating with every keystroke,\n * since the final text typed by the user is the one that should produce the\n * final autocomplete results. For more stateful debouncing with support for\n * pausing, resuming, and canceling debounced actions, use {@code\n * goog.async.Debouncer}.\n *\n * @param {function(this:SCOPE, ...?)} f Function to call.\n * @param {number} interval Interval over which to debounce. The function will\n *     only be called after the full interval has elapsed since the last call.\n * @param {SCOPE=} opt_scope Object in whose scope to call the function.\n * @return {function(...?): undefined} Wrapped function.\n * @template SCOPE\n */\ngoog.functions.debounce = function(f, interval, opt_scope) {\n  var timeout = 0;\n  return /** @type {function(...?)} */ (function(var_args) {\n    goog.global.clearTimeout(timeout);\n    var args = arguments;\n    timeout = goog.global.setTimeout(function() {\n      f.apply(opt_scope, args);\n    }, interval);\n  });\n};\n\n\n/**\n * Wraps a function to allow it to be called, at most, once per interval\n * (specified in milliseconds). If the wrapper function is called N times in\n * that interval, both the 1st and the Nth calls will go through.\n *\n * This is particularly useful for limiting repeated user requests where the\n * the last action should win, but you also don't want to wait until the end of\n * the interval before sending a request out, as it leads to a perception of\n * slowness for the user.\n *\n * @param {function(this:SCOPE, ...?)} f Function to call.\n * @param {number} interval Interval over which to throttle. The function can\n *     only be called once per interval.\n * @param {SCOPE=} opt_scope Object in whose scope to call the function.\n * @return {function(...?): undefined} Wrapped function.\n * @template SCOPE\n */\ngoog.functions.throttle = function(f, interval, opt_scope) {\n  var timeout = 0;\n  var shouldFire = false;\n  var args = [];\n\n  var handleTimeout = function() {\n    timeout = 0;\n    if (shouldFire) {\n      shouldFire = false;\n      fire();\n    }\n  };\n\n  var fire = function() {\n    timeout = goog.global.setTimeout(handleTimeout, interval);\n    f.apply(opt_scope, args);\n  };\n\n  return /** @type {function(...?)} */ (function(var_args) {\n    args = arguments;\n    if (!timeout) {\n      fire();\n    } else {\n      shouldFire = true;\n    }\n  });\n};\n\n\n/**\n * Wraps a function to allow it to be called, at most, once per interval\n * (specified in milliseconds). If the wrapper function is called N times within\n * that interval, only the 1st call will go through.\n *\n * This is particularly useful for limiting repeated user requests where the\n * first request is guaranteed to have all the data required to perform the\n * final action, so there's no need to wait until the end of the interval before\n * sending the request out.\n *\n * @param {function(this:SCOPE, ...?)} f Function to call.\n * @param {number} interval Interval over which to rate-limit. The function will\n *     only be called once per interval, and ignored for the remainer of the\n *     interval.\n * @param {SCOPE=} opt_scope Object in whose scope to call the function.\n * @return {function(...?): undefined} Wrapped function.\n * @template SCOPE\n */\ngoog.functions.rateLimit = function(f, interval, opt_scope) {\n  var timeout = 0;\n\n  var handleTimeout = function() {\n    timeout = 0;\n  };\n\n  return /** @type {function(...?)} */ (function(var_args) {\n    if (!timeout) {\n      timeout = goog.global.setTimeout(handleTimeout, interval);\n      f.apply(opt_scope, arguments);\n    }\n  });\n};\n","// Copyright 2012 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A delayed callback that pegs to the next animation frame\n * instead of a user-configurable timeout.\n *\n * @author nicksantos@google.com (Nick Santos)\n */\n\ngoog.provide('goog.async.AnimationDelay');\n\ngoog.require('goog.Disposable');\ngoog.require('goog.events');\ngoog.require('goog.functions');\n\n\n\n// TODO(nicksantos): Should we factor out the common code between this and\n// goog.async.Delay? I'm not sure if there's enough code for this to really\n// make sense. Subclassing seems like the wrong approach for a variety of\n// reasons. Maybe there should be a common interface?\n\n\n\n/**\n * A delayed callback that pegs to the next animation frame\n * instead of a user configurable timeout. By design, this should have\n * the same interface as goog.async.Delay.\n *\n * Uses requestAnimationFrame and friends when available, but falls\n * back to a timeout of goog.async.AnimationDelay.TIMEOUT.\n *\n * For more on requestAnimationFrame and how you can use it to create smoother\n * animations, see:\n * @see http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n *\n * @param {function(this:THIS, number)} listener Function to call\n *     when the delay completes. Will be passed the timestamp when it's called,\n *     in unix ms.\n * @param {Window=} opt_window The window object to execute the delay in.\n *     Defaults to the global object.\n * @param {THIS=} opt_handler The object scope to invoke the function in.\n * @template THIS\n * @constructor\n * @struct\n * @extends {goog.Disposable}\n * @final\n */\ngoog.async.AnimationDelay = function(listener, opt_window, opt_handler) {\n  goog.async.AnimationDelay.base(this, 'constructor');\n\n  /**\n   * Identifier of the active delay timeout, or event listener,\n   * or null when inactive.\n   * @private {goog.events.Key|number}\n   */\n  this.id_ = null;\n\n  /**\n   * If we're using dom listeners.\n   * @private {?boolean}\n   */\n  this.usingListeners_ = false;\n\n  /**\n   * The function that will be invoked after a delay.\n   * @const\n   * @private\n   */\n  this.listener_ = listener;\n\n  /**\n   * The object context to invoke the callback in.\n   * @const\n   * @private {(THIS|undefined)}\n   */\n  this.handler_ = opt_handler;\n\n  /**\n   * @private {Window}\n   */\n  this.win_ = opt_window || window;\n\n  /**\n   * Cached callback function invoked when the delay finishes.\n   * @private {function()}\n   */\n  this.callback_ = goog.bind(this.doAction_, this);\n};\ngoog.inherits(goog.async.AnimationDelay, goog.Disposable);\n\n\n/**\n * Default wait timeout for animations (in milliseconds).  Only used for timed\n * animation, which uses a timer (setTimeout) to schedule animation.\n *\n * @type {number}\n * @const\n */\ngoog.async.AnimationDelay.TIMEOUT = 20;\n\n\n/**\n * Name of event received from the requestAnimationFrame in Firefox.\n *\n * @type {string}\n * @const\n * @private\n */\ngoog.async.AnimationDelay.MOZ_BEFORE_PAINT_EVENT_ = 'MozBeforePaint';\n\n\n/**\n * Starts the delay timer. The provided listener function will be called\n * before the next animation frame.\n */\ngoog.async.AnimationDelay.prototype.start = function() {\n  this.stop();\n  this.usingListeners_ = false;\n\n  var raf = this.getRaf_();\n  var cancelRaf = this.getCancelRaf_();\n  if (raf && !cancelRaf && this.win_.mozRequestAnimationFrame) {\n    // Because Firefox (Gecko) runs animation in separate threads, it also saves\n    // time by running the requestAnimationFrame callbacks in that same thread.\n    // Sadly this breaks the assumption of implicit thread-safety in JS, and can\n    // thus create thread-based inconsistencies on counters etc.\n    //\n    // Calling cycleAnimations_ using the MozBeforePaint event instead of as\n    // callback fixes this.\n    //\n    // Trigger this condition only if the mozRequestAnimationFrame is available,\n    // but not the W3C requestAnimationFrame function (as in draft) or the\n    // equivalent cancel functions.\n    this.id_ = goog.events.listen(\n        this.win_, goog.async.AnimationDelay.MOZ_BEFORE_PAINT_EVENT_,\n        this.callback_);\n    this.win_.mozRequestAnimationFrame(null);\n    this.usingListeners_ = true;\n  } else if (raf && cancelRaf) {\n    this.id_ = raf.call(this.win_, this.callback_);\n  } else {\n    this.id_ = this.win_.setTimeout(\n        // Prior to Firefox 13, Gecko passed a non-standard parameter\n        // to the callback that we want to ignore.\n        goog.functions.lock(this.callback_), goog.async.AnimationDelay.TIMEOUT);\n  }\n};\n\n\n/**\n * Stops the delay timer if it is active. No action is taken if the timer is not\n * in use.\n */\ngoog.async.AnimationDelay.prototype.stop = function() {\n  if (this.isActive()) {\n    var raf = this.getRaf_();\n    var cancelRaf = this.getCancelRaf_();\n    if (raf && !cancelRaf && this.win_.mozRequestAnimationFrame) {\n      goog.events.unlistenByKey(this.id_);\n    } else if (raf && cancelRaf) {\n      cancelRaf.call(this.win_, /** @type {number} */ (this.id_));\n    } else {\n      this.win_.clearTimeout(/** @type {number} */ (this.id_));\n    }\n  }\n  this.id_ = null;\n};\n\n\n/**\n * Fires delay's action even if timer has already gone off or has not been\n * started yet; guarantees action firing. Stops the delay timer.\n */\ngoog.async.AnimationDelay.prototype.fire = function() {\n  this.stop();\n  this.doAction_();\n};\n\n\n/**\n * Fires delay's action only if timer is currently active. Stops the delay\n * timer.\n */\ngoog.async.AnimationDelay.prototype.fireIfActive = function() {\n  if (this.isActive()) {\n    this.fire();\n  }\n};\n\n\n/**\n * @return {boolean} True if the delay is currently active, false otherwise.\n */\ngoog.async.AnimationDelay.prototype.isActive = function() {\n  return this.id_ != null;\n};\n\n\n/**\n * Invokes the callback function after the delay successfully completes.\n * @private\n */\ngoog.async.AnimationDelay.prototype.doAction_ = function() {\n  if (this.usingListeners_ && this.id_) {\n    goog.events.unlistenByKey(this.id_);\n  }\n  this.id_ = null;\n\n  // We are not using the timestamp returned by requestAnimationFrame\n  // because it may be either a Date.now-style time or a\n  // high-resolution time (depending on browser implementation). Using\n  // goog.now() will ensure that the timestamp used is consistent and\n  // compatible with goog.fx.Animation.\n  this.listener_.call(this.handler_, goog.now());\n};\n\n\n/** @override */\ngoog.async.AnimationDelay.prototype.disposeInternal = function() {\n  this.stop();\n  goog.async.AnimationDelay.base(this, 'disposeInternal');\n};\n\n\n/**\n * @return {?function(function(number)): number} The requestAnimationFrame\n *     function, or null if not available on this browser.\n * @private\n */\ngoog.async.AnimationDelay.prototype.getRaf_ = function() {\n  var win = this.win_;\n  return win.requestAnimationFrame || win.webkitRequestAnimationFrame ||\n      win.mozRequestAnimationFrame || win.oRequestAnimationFrame ||\n      win.msRequestAnimationFrame || null;\n};\n\n\n/**\n * @return {?function(number): undefined} The cancelAnimationFrame function,\n *     or null if not available on this browser.\n * @private\n */\ngoog.async.AnimationDelay.prototype.getCancelRaf_ = function() {\n  var win = this.win_;\n  return win.cancelAnimationFrame || win.cancelRequestAnimationFrame ||\n      win.webkitCancelRequestAnimationFrame ||\n      win.mozCancelRequestAnimationFrame || win.oCancelRequestAnimationFrame ||\n      win.msCancelRequestAnimationFrame || null;\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Represents an active, update-able automatic scroll behavior.\n */\n'use strict';\n\ngoog.provide('Blockly.AutoScroll');\n\ngoog.require('goog.async.AnimationDelay');\n\n/**\n * @param {!Blockly.BlockSpace} blockSpace - blockspace to scroll\n * @param {!goog.math.Vec2} startPanVector - pan vector to begin with, pixels\n *        per second in each direction\n * @constructor\n */\nBlockly.AutoScroll = function (blockSpace, startPanVector) {\n  /**\n   * BlockSpace to scroll\n   * @private {!Blockly.BlockSpace}\n   */\n  this.blockSpace_ = blockSpace;\n\n  /**\n   * Current active auto-pan vector in x/y pixels per millisecond\n   * @private {goog.math.Vec2}\n   */\n  this.activePanVector_ = startPanVector;\n\n  /**\n   * ID of active window.startInterval callback key\n   * @type {number}\n   * @private\n   */\n  this.animationDelay_ = new goog.async.AnimationDelay(\n    this.handleAnimationDelay_.bind(this), window);\n  this.lastTime_ = Date.now();\n  this.animationDelay_.start();\n};\n\nBlockly.AutoScroll.prototype.stopAndDestroy = function () {\n  this.activePanVector_ = null;\n  this.animationDelay_.dispose();\n  this.lastMouseX_ = null;\n  this.lastMouseY_ = null;\n};\n\n/**\n * AnimationDelay listener. Ticks scrolling behavior and triggers another\n * frame request.\n * @param {number} now - current time in ms\n * @private\n */\nBlockly.AutoScroll.prototype.handleAnimationDelay_ = function (now) {\n  var dt = now - this.lastTime_;\n  this.lastTime_ = now;\n  this.scrollTick_(dt);\n  this.animationDelay_.start();\n};\n\n/**\n * Perform scroll given time passed\n * @param msPassed\n * @private\n */\nBlockly.AutoScroll.prototype.scrollTick_ = function (msPassed) {\n  var scrollDx = this.activePanVector_.x * msPassed;\n  var scrollDy = this.activePanVector_.y * msPassed;\n  this.blockSpace_.scrollDeltaWithAnySelectedBlock(scrollDx, scrollDy,\n    this.lastMouseX_, this.lastMouseY_);\n};\n\n/**\n * Updates properties of the current scroll, e.g. changing movement vector\n * or updating mouse position.\n * @param {goog.math.Vec2} scrollVector\n * @param {number} mouseClientX\n * @param {number} mouseClientY\n */\nBlockly.AutoScroll.prototype.updateProperties = function (scrollVector,\n                                                          mouseClientX,\n                                                          mouseClientY) {\n  this.activePanVector_ = scrollVector;\n  this.lastMouseX_ = mouseClientX;\n  this.lastMouseY_ = mouseClientY;\n};\n\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Defines a 2-element vector class that can be used for\n * coordinate math, useful for animation systems and point manipulation.\n *\n * Vec2 objects inherit from goog.math.Coordinate and may be used wherever a\n * Coordinate is required. Where appropriate, Vec2 functions accept both Vec2\n * and Coordinate objects as input.\n *\n * @author brenneman@google.com (Shawn Brenneman)\n */\n\ngoog.provide('goog.math.Vec2');\n\ngoog.require('goog.math');\ngoog.require('goog.math.Coordinate');\n\n\n\n/**\n * Class for a two-dimensional vector object and assorted functions useful for\n * manipulating points.\n *\n * @param {number} x The x coordinate for the vector.\n * @param {number} y The y coordinate for the vector.\n * @struct\n * @constructor\n * @extends {goog.math.Coordinate}\n */\ngoog.math.Vec2 = function(x, y) {\n  /**\n   * X-value\n   * @type {number}\n   */\n  this.x = x;\n\n  /**\n   * Y-value\n   * @type {number}\n   */\n  this.y = y;\n};\ngoog.inherits(goog.math.Vec2, goog.math.Coordinate);\n\n\n/**\n * @return {!goog.math.Vec2} A random unit-length vector.\n */\ngoog.math.Vec2.randomUnit = function() {\n  var angle = Math.random() * Math.PI * 2;\n  return new goog.math.Vec2(Math.cos(angle), Math.sin(angle));\n};\n\n\n/**\n * @return {!goog.math.Vec2} A random vector inside the unit-disc.\n */\ngoog.math.Vec2.random = function() {\n  var mag = Math.sqrt(Math.random());\n  var angle = Math.random() * Math.PI * 2;\n\n  return new goog.math.Vec2(Math.cos(angle) * mag, Math.sin(angle) * mag);\n};\n\n\n/**\n * Returns a new Vec2 object from a given coordinate.\n * @param {!goog.math.Coordinate} a The coordinate.\n * @return {!goog.math.Vec2} A new vector object.\n */\ngoog.math.Vec2.fromCoordinate = function(a) {\n  return new goog.math.Vec2(a.x, a.y);\n};\n\n\n/**\n * @return {!goog.math.Vec2} A new vector with the same coordinates as this one.\n * @override\n */\ngoog.math.Vec2.prototype.clone = function() {\n  return new goog.math.Vec2(this.x, this.y);\n};\n\n\n/**\n * Returns the magnitude of the vector measured from the origin.\n * @return {number} The length of the vector.\n */\ngoog.math.Vec2.prototype.magnitude = function() {\n  return Math.sqrt(this.x * this.x + this.y * this.y);\n};\n\n\n/**\n * Returns the squared magnitude of the vector measured from the origin.\n * NOTE(brenneman): Leaving out the square root is not a significant\n * optimization in JavaScript.\n * @return {number} The length of the vector, squared.\n */\ngoog.math.Vec2.prototype.squaredMagnitude = function() {\n  return this.x * this.x + this.y * this.y;\n};\n\n\n/**\n * @return {!goog.math.Vec2} This coordinate after scaling.\n * @override\n */\ngoog.math.Vec2.prototype.scale =\n    /** @type {function(number, number=):!goog.math.Vec2} */\n    (goog.math.Coordinate.prototype.scale);\n\n\n/**\n * Reverses the sign of the vector. Equivalent to scaling the vector by -1.\n * @return {!goog.math.Vec2} The inverted vector.\n */\ngoog.math.Vec2.prototype.invert = function() {\n  this.x = -this.x;\n  this.y = -this.y;\n  return this;\n};\n\n\n/**\n * Normalizes the current vector to have a magnitude of 1.\n * @return {!goog.math.Vec2} The normalized vector.\n */\ngoog.math.Vec2.prototype.normalize = function() {\n  return this.scale(1 / this.magnitude());\n};\n\n\n/**\n * Adds another vector to this vector in-place.\n * @param {!goog.math.Coordinate} b The vector to add.\n * @return {!goog.math.Vec2}  This vector with {@code b} added.\n */\ngoog.math.Vec2.prototype.add = function(b) {\n  this.x += b.x;\n  this.y += b.y;\n  return this;\n};\n\n\n/**\n * Subtracts another vector from this vector in-place.\n * @param {!goog.math.Coordinate} b The vector to subtract.\n * @return {!goog.math.Vec2} This vector with {@code b} subtracted.\n */\ngoog.math.Vec2.prototype.subtract = function(b) {\n  this.x -= b.x;\n  this.y -= b.y;\n  return this;\n};\n\n\n/**\n * Rotates this vector in-place by a given angle, specified in radians.\n * @param {number} angle The angle, in radians.\n * @return {!goog.math.Vec2} This vector rotated {@code angle} radians.\n */\ngoog.math.Vec2.prototype.rotate = function(angle) {\n  var cos = Math.cos(angle);\n  var sin = Math.sin(angle);\n  var newX = this.x * cos - this.y * sin;\n  var newY = this.y * cos + this.x * sin;\n  this.x = newX;\n  this.y = newY;\n  return this;\n};\n\n\n/**\n * Rotates a vector by a given angle, specified in radians, relative to a given\n * axis rotation point. The returned vector is a newly created instance - no\n * in-place changes are done.\n * @param {!goog.math.Vec2} v A vector.\n * @param {!goog.math.Vec2} axisPoint The rotation axis point.\n * @param {number} angle The angle, in radians.\n * @return {!goog.math.Vec2} The rotated vector in a newly created instance.\n */\ngoog.math.Vec2.rotateAroundPoint = function(v, axisPoint, angle) {\n  var res = v.clone();\n  return res.subtract(axisPoint).rotate(angle).add(axisPoint);\n};\n\n\n/** @override */\ngoog.math.Vec2.prototype.equals = function(b) {\n  if (this == b) {\n    return true;\n  }\n  return b instanceof goog.math.Vec2 && !!b && this.x == b.x && this.y == b.y;\n};\n\n\n/**\n * Returns the distance between two vectors.\n * @param {!goog.math.Coordinate} a The first vector.\n * @param {!goog.math.Coordinate} b The second vector.\n * @return {number} The distance.\n */\ngoog.math.Vec2.distance = goog.math.Coordinate.distance;\n\n\n/**\n * Returns the squared distance between two vectors.\n * @param {!goog.math.Coordinate} a The first vector.\n * @param {!goog.math.Coordinate} b The second vector.\n * @return {number} The squared distance.\n */\ngoog.math.Vec2.squaredDistance = goog.math.Coordinate.squaredDistance;\n\n\n/**\n * Compares vectors for equality.\n * @param {!goog.math.Coordinate} a The first vector.\n * @param {!goog.math.Coordinate} b The second vector.\n * @return {boolean} Whether the vectors have the same x and y coordinates.\n */\ngoog.math.Vec2.equals = goog.math.Coordinate.equals;\n\n\n/**\n * Returns the sum of two vectors as a new Vec2.\n * @param {!goog.math.Coordinate} a The first vector.\n * @param {!goog.math.Coordinate} b The second vector.\n * @return {!goog.math.Vec2} The sum vector.\n */\ngoog.math.Vec2.sum = function(a, b) {\n  return new goog.math.Vec2(a.x + b.x, a.y + b.y);\n};\n\n\n/**\n * Returns the difference between two vectors as a new Vec2.\n * @param {!goog.math.Coordinate} a The first vector.\n * @param {!goog.math.Coordinate} b The second vector.\n * @return {!goog.math.Vec2} The difference vector.\n */\ngoog.math.Vec2.difference = function(a, b) {\n  return new goog.math.Vec2(a.x - b.x, a.y - b.y);\n};\n\n\n/**\n * Returns the dot-product of two vectors.\n * @param {!goog.math.Coordinate} a The first vector.\n * @param {!goog.math.Coordinate} b The second vector.\n * @return {number} The dot-product of the two vectors.\n */\ngoog.math.Vec2.dot = function(a, b) {\n  return a.x * b.x + a.y * b.y;\n};\n\n\n/**\n * Returns the determinant of two vectors.\n * @param {!goog.math.Vec2} a The first vector.\n * @param {!goog.math.Vec2} b The second vector.\n * @return {number} The determinant of the two vectors.\n */\ngoog.math.Vec2.determinant = function(a, b) {\n  return a.x * b.y - a.y * b.x;\n};\n\n\n/**\n * Returns a new Vec2 that is the linear interpolant between vectors a and b at\n * scale-value x.\n * @param {!goog.math.Coordinate} a Vector a.\n * @param {!goog.math.Coordinate} b Vector b.\n * @param {number} x The proportion between a and b.\n * @return {!goog.math.Vec2} The interpolated vector.\n */\ngoog.math.Vec2.lerp = function(a, b, x) {\n  return new goog.math.Vec2(\n      goog.math.lerp(a.x, b.x, x), goog.math.lerp(a.y, b.y, x));\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Scrolling-on-block-drag interaction handler\n */\n'use strict';\n\ngoog.provide('Blockly.ScrollOnBlockDragHandler');\n\ngoog.require('Blockly.AutoScroll');\ngoog.require('goog.math.Vec2');\n\n/**\n * @param {!Blockly.BlockSpace} blockSpace\n * @constructor\n */\nBlockly.ScrollOnBlockDragHandler = function (blockSpace) {\n  /**\n   * BlockSpace to scroll\n   * @private {Blockly.BlockSpace}\n   */\n  this.blockSpace_ = blockSpace;\n\n  /**\n   * Direction names to Vec2 1/-1 representations\n   * @type {{top: goog.math.Vec2, bottom: goog.math.Vec2,\n   *         left: goog.math.Vec2, right: goog.math.Vec2}}\n   */\n  this.SCROLL_DIRECTION_VECTORS = {\n    top: new goog.math.Vec2(0, -1),\n    bottom: new goog.math.Vec2(0, 1),\n    left: new goog.math.Vec2(-1, 0),\n    right: new goog.math.Vec2(1, 0)\n  };\n};\n\nBlockly.ScrollOnBlockDragHandler.prototype.stopAutoScrolling = function () {\n  if (this.activeAutoScroll_) {\n    this.activeAutoScroll_.stopAndDestroy();\n  }\n  this.activeAutoScroll_ = null;\n};\n\nvar MS_PER_SEC = 1000;\n\n/**\n * Pixels-per-millisecond scrolling speeds for mouse-location triggered scrolling\n * @type {number}\n */\nvar MOUSE_SPEED_SLOW = .5;\nvar MOUSE_SPEED_FAST = 1.6;\n\n/**\n * Pixels-per-millisecond scrolling speeds for block-location triggered scrolling\n * @type {number}\n */\nvar BLOCK_SPEED_SLOW = .28;\nvar BLOCK_SPEED_FAST = 1.4;\n\n/**\n * Mouse distance from side when to start slow scrolling\n * @type {number}\n */\nvar MOUSE_START_DISTANCE = 0;\n/**\n * Mouse distance outside of viewport side when to start fast scrolling\n * @type {number}\n */\nvar MOUSE_START_FAST_DISTANCE = 35;\n\n/**\n * Distance from block edge to side when to start slow scrolling\n * @type {number}\n */\nvar BLOCK_START_DISTANCE = 0;\n/**\n * Distance from block edge to side when to start fast scrolling\n * @type {number}\n */\nvar BLOCK_START_FAST_DISTANCE = 50;\n\n/**\n * A block is considered 'oversized' on a given dimension if it takes up more\n * than this percentage of the viewport size.\n * @type {number}\n */\nvar OVERSIZE_BLOCK_THRESHOLD = 0.85;\n\n/**\n * Drag 'margin' around cursor to use instead of block bounds when the dragged\n * block is oversized. Given in block space units.\n * @type {number}\n */\nvar FALLBACK_DRAG_MARGIN = 15;\n\n/**\n * Enables debug drawing of various block drag scrolling operations\n * @type {boolean}\n */\nBlockly.ScrollOnBlockDragHandler.DEBUG = false;\n\n/**\n * Pans the blockspace in the direction of a block if it's hanging off the\n * edge of the blockspace.\n *\n * - Will only expand the blockspace vertically if vertical scrollbars are\n * enabled\n * - Will only expand the blockspace horizontally if horizontal scrollbars are\n * enabled\n *\n * @see Scrolling behavior inspiration:\n *      {@url http://ux.stackexchange.com/a/73902}\n *\n * @param {Blockly.Block} block\n * @param {number} mouseClientX\n * @param {number} mouseClientY\n */\nBlockly.ScrollOnBlockDragHandler.prototype.panIfOverEdge = function (block,\n                                                                     mouseClientX,\n                                                                     mouseClientY) {\n  if (!this.blockSpace_.currentlyScrollable()) {\n    // Don't perform potentially expensive panning calculations if not currently\n    // scrollable\n    return;\n  }\n\n  var SCROLLABLE_DIRECTIONS = [];\n\n  if (this.blockSpace_.scrollbarPair &&\n    this.blockSpace_.scrollbarPair.canScrollHorizontally()) {\n    SCROLLABLE_DIRECTIONS.push('left', 'right');\n  }\n\n  if (this.blockSpace_.scrollbarPair &&\n    this.blockSpace_.scrollbarPair.canScrollVertically()) {\n    SCROLLABLE_DIRECTIONS.push('top', 'bottom');\n  }\n\n  if (SCROLLABLE_DIRECTIONS.length === 0) {\n    return;\n  }\n\n  var mouseSvg = Blockly.mouseCoordinatesToSvg(\n    mouseClientX, mouseClientY, this.blockSpace_.blockSpaceEditor.svg_);\n  var mouseViewport = Blockly.svgCoordinatesToViewport(\n    new goog.math.Coordinate(mouseSvg.x, mouseSvg.y), this.blockSpace_);\n  var mouseBlockSpace = Blockly.viewportCoordinateToBlockSpace(\n    mouseViewport, this.blockSpace_);\n\n  var viewportBox = this.blockSpace_.getViewportBox();\n  var blockBox = block.getBox();\n\n  // When dragged block is almost as tall as the viewport, use a small bounding\n  // region around the cursor instead of the whole block bounding box to trigger\n  // autoscrolling.\n  var blockHeight = Blockly.getBoxHeight(blockBox);\n  var viewportHeight = Blockly.getBoxHeight(viewportBox);\n  if (blockHeight > viewportHeight * OVERSIZE_BLOCK_THRESHOLD) {\n    // Center box around cursor with fallback radius\n    blockBox.top = Math.max(blockBox.top, mouseBlockSpace.y - FALLBACK_DRAG_MARGIN);\n    blockBox.bottom = Math.min(blockBox.bottom, mouseBlockSpace.y + FALLBACK_DRAG_MARGIN);\n  }\n\n  // Same rule, but horizontal\n  var blockWidth = Blockly.getBoxWidth(blockBox);\n  var viewportWidth = Blockly.getBoxWidth(viewportBox);\n  if (blockWidth > viewportWidth * OVERSIZE_BLOCK_THRESHOLD) {\n    // Center box around cursor with fallback radius\n    blockBox.left = Math.max(blockBox.left, mouseBlockSpace.x - FALLBACK_DRAG_MARGIN);\n    blockBox.right = Math.min(blockBox.right, mouseBlockSpace.x + FALLBACK_DRAG_MARGIN);\n  }\n\n  // Calculate how far out-of-bounds the dragged block/cursor is.\n  var blockOverflows = Blockly.getBoxOverflow(viewportBox, blockBox);\n  var mouseOverflows = Blockly.getPointBoxOverflow(viewportBox,\n    new goog.math.Coordinate(mouseBlockSpace.x, mouseBlockSpace.y));\n\n  if (Blockly.ScrollOnBlockDragHandler.DEBUG) {\n    this.blockSpace_.drawDebugCircle(\"mouse circle\",\n      new goog.math.Coordinate(mouseBlockSpace.x, mouseBlockSpace.y),\n      \"orange\");\n    this.blockSpace_.drawDebugBox(\"block box\" + block.id, blockBox, \"purple\");\n    this.blockSpace_.drawDebugBox(\"block space box\", viewportBox, \"blue\");\n  }\n\n  var overallScrollVector = new goog.math.Vec2(0, 0);\n\n  SCROLLABLE_DIRECTIONS.forEach(function (direction) {\n    var mouseOverflow = mouseOverflows[direction];\n    var blockOverflow = blockOverflows[direction];\n    var scrollVector = this.SCROLL_DIRECTION_VECTORS[direction];\n\n    var candidateScrolls = [];\n\n    if (Blockly.numberWithin(blockOverflow,\n        BLOCK_START_DISTANCE, BLOCK_START_FAST_DISTANCE, false)) {\n      candidateScrolls.push(scrollVector.clone().scale(BLOCK_SPEED_SLOW));\n    }\n\n    if (blockOverflow > BLOCK_START_FAST_DISTANCE) {\n      candidateScrolls.push(scrollVector.clone().scale(BLOCK_SPEED_FAST));\n    }\n\n    if (Blockly.numberWithin(mouseOverflow,\n        MOUSE_START_DISTANCE, MOUSE_START_FAST_DISTANCE, false)) {\n      candidateScrolls.push(scrollVector.clone().scale(MOUSE_SPEED_SLOW));\n    }\n\n    if (mouseOverflow > MOUSE_START_FAST_DISTANCE) {\n      candidateScrolls.push(scrollVector.clone().scale(MOUSE_SPEED_FAST));\n    }\n\n    var greatestScrollVector = candidateScrolls.reduce(\n      function (fastestScroll, candidateScroll) {\n        if (!fastestScroll) {\n          return candidateScroll;\n        }\n\n        return fastestScroll.magnitude() > candidateScroll.magnitude() ?\n          fastestScroll : candidateScroll;\n      }, null\n    );\n\n    if (greatestScrollVector) {\n      overallScrollVector =\n        goog.math.Vec2.sum(overallScrollVector, greatestScrollVector);\n    }\n  }, this);\n\n  if (overallScrollVector.equals(new goog.math.Vec2(0, 0))) {\n    this.stopAutoScrolling();\n    return;\n  }\n\n  this.activeAutoScroll_ = this.activeAutoScroll_ ||\n    new Blockly.AutoScroll(this.blockSpace_, overallScrollVector);\n\n  this.activeAutoScroll_.updateProperties(overallScrollVector, mouseClientX,\n    mouseClientY);\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* global Blockly, goog */\n\n/**\n * @fileoverview XML reader and writer.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Xml');\n\n// TODO(scr): Fix circular dependencies\n// goog.require('Blockly.Block');\n\n\n/**\n * Encode a block tree as XML.\n * @param {!Object} blockSpace The SVG blockSpace.\n * @return {!Element} XML document.\n */\nBlockly.Xml.blockSpaceToDom = function(blockSpace) {\n  var xml = Blockly.isMsie() ? document.createElementNS(null, 'xml') :\n                               document.createElement(\"xml\");\n  var blocks = blockSpace.getTopBlocks(true);\n  for (var i = 0, block; i < blocks.length; i++) {\n    block = blocks[i];\n    var element = Blockly.Xml.blockToDom(block);\n    xml.appendChild(element);\n  }\n  return xml;\n};\n\n/**\n * Encode a block subtree as XML.\n * @param {!Blockly.Block} block The root block to encode.\n * @param {boolean} ignoreChildBlocks If true, will not encode any child\n *  statements or connected blocks.  Will still encode value blocks\n * @return {!Element} Tree of XML elements.\n */\nBlockly.Xml.blockToDom = function(block, ignoreChildBlocks) {\n  var element = goog.dom.createDom('block');\n\n  var container;\n  var x, y, i, input, title;\n\n  element.setAttribute('type', block.type);\n  if (block.mutationToDom) {\n    // Custom data for an advanced block.\n    var mutation = block.mutationToDom();\n    if (mutation) {\n      element.appendChild(mutation);\n    }\n  }\n  function titleToDom(title) {\n    if (title.name && title.EDITABLE) {\n      var container = goog.dom.createDom('title', null, title.getValue());\n      container.setAttribute('name', title.name);\n      if (title.config) {\n        container.setAttribute('config', title.config);\n      }\n      element.appendChild(container);\n    }\n  }\n  for (x = 0; x < block.inputList.length; x++) {\n    input = block.inputList[x];\n    for (y = 0; y < input.titleRow.length; y++) {\n      title = input.titleRow[y];\n      titleToDom(title);\n    }\n  }\n\n  for (i = 0; i < block.inputList.length; i++) {\n    input = block.inputList[i];\n    var empty = true;\n    if (input.type == Blockly.DUMMY_INPUT) {\n      continue;\n    } else {\n      var ignoreChild = false;\n      var childBlock = input.connection.targetBlock();\n      if (input.type === Blockly.INPUT_VALUE) {\n        container = goog.dom.createDom('value');\n      } else if (input.type === Blockly.NEXT_STATEMENT) {\n        container = goog.dom.createDom('statement');\n        ignoreChild = ignoreChildBlocks;\n      } else if (input.type === Blockly.FUNCTIONAL_INPUT) {\n        container = goog.dom.createDom('functional_input');\n        ignoreChild = ignoreChildBlocks;\n      }\n      if (childBlock && !ignoreChild) {\n        container.appendChild(Blockly.Xml.blockToDom(childBlock));\n        empty = false;\n      }\n    }\n    container.setAttribute('name', input.name);\n    if (!empty) {\n      element.appendChild(container);\n    }\n  }\n  if (block.isCollapsed()) {\n    element.setAttribute('collapsed', true);\n  }\n  if (block.disabled) {\n    element.setAttribute('disabled', true);\n  }\n  if (!block.isDeletable()) {\n    element.setAttribute('deletable', false);\n  }\n  if (!block.isMovable()) {\n    element.setAttribute('movable', false);\n  }\n  if (!block.isEditable()) {\n    element.setAttribute('editable', false);\n  }\n  if (!block.isUserVisible()) {\n    element.setAttribute('uservisible', false);\n  }\n  if (block.inputCount) {\n    element.setAttribute('inputcount', String(block.inputCount));\n  }\n  if (block.isNextConnectionDisabled()) {\n    element.setAttribute('next_connection_disabled', true);\n  }\n  if (!block.canDisconnectFromParent()) {\n    element.setAttribute('can_disconnect_from_parent', false);\n  }\n  if (block.isFunctionDefinition() && block.userCreated) {\n    element.setAttribute('usercreated', true);\n  }\n\n  if (Blockly.editBlocks) {\n    var limit = block.blockSpace.blockSpaceEditor.blockLimits.getLimit(block.type);\n    if (limit) {\n      element.setAttribute('limit', limit);\n    }\n  }\n  if (block.htmlId) {\n    element.setAttribute('id', block.htmlId);\n  }\n\n  // Don't follow connections if we're ignoring child blocks\n  if (block.nextConnection && !ignoreChildBlocks) {\n    var nextBlock = block.nextConnection.targetBlock();\n    if (nextBlock) {\n      container = goog.dom.createDom('next', null,\n          Blockly.Xml.blockToDom(nextBlock));\n      element.appendChild(container);\n    }\n  }\n\n  return element;\n};\n\n/**\n * Converts a DOM structure into plain text.\n * Currently the text format is fairly ugly: all one line with no whitespace.\n * @param {!Element} dom A tree of XML elements.\n * @return {string} Text representation.\n */\nBlockly.Xml.domToText = function(dom) {\n  var oSerializer = new XMLSerializer();\n  var text = oSerializer.serializeToString(dom);\n  var re = new RegExp(\" xmlns=\\\"http://www.w3.org/1999/xhtml\\\"\", 'g');\n  return text.replace(re, '');\n};\n\n/**\n * Converts a DOM structure into properly indented text.\n * @param {!Element} dom A tree of XML elements.\n * @return {string} Text representation.\n */\nBlockly.Xml.domToPrettyText = function(dom) {\n  // This function is not guaranteed to be correct for all XML.\n  // But it handles the XML that Blockly generates.\n  var blob = Blockly.Xml.domToText(dom);\n  // Place every open and close tag on its own line.\n  var lines = blob.split('<');\n  // Indent every line.\n  var indent = '';\n  for (var x = 1; x < lines.length; x++) {\n    var line = lines[x];\n    if (line[0] == '/') {\n      indent = indent.substring(2);\n    }\n    lines[x] = indent + '<' + line;\n    if (line[0] != '/' && line.slice(-2) != '/>') {\n      indent += '  ';\n    }\n  }\n  // Pull simple tags back together.\n  // E.g. <foo></foo>\n  var text = lines.join('\\n');\n  text = text.replace(/(<(\\w+)\\b[^>]*>[^\\n]*)\\n *<\\/\\2>/g, '$1</$2>');\n  // Trim leading blank line.\n  return text.replace(/^\\n/, '');\n};\n\n/**\n * Converts plain text into a DOM structure.\n * Throws an error if XML doesn't parse.\n * @param {string} text Text representation.\n * @return {!Element} A tree of XML elements.\n */\nBlockly.Xml.textToDom = function(text) {\n  var oParser = new DOMParser();\n  var dom = oParser.parseFromString(text, 'text/xml');\n  // The DOM should have one and only one top-level node, an XML tag.\n  if (!dom || !dom.firstChild ||\n      dom.firstChild.nodeName.toLowerCase() != 'xml') {\n    // Whatever we got back from the parser is not XML.\n    throw 'Blockly.Xml.textToDom did not obtain a valid XML tree.';\n  }\n  return dom.firstChild;\n};\n\n/**\n * Decode an XML DOM and create blocks on the blockSpace.\n * @param {!Blockly.BlockSpace} blockSpace The SVG blockSpace.\n * @param {!Element} xml XML DOM.\n */\nBlockly.Xml.domToBlockSpace = function(blockSpace, xml) {\n  var metrics = blockSpace.getMetrics();\n  var width = metrics ? metrics.viewWidth : 0;\n\n  var paddingLeft = blockSpace.blockSpaceEditor.shouldHavePadding()\n    ? Blockly.BlockSpace.AUTO_LAYOUT_PADDING_LEFT\n    : 0;\n  var paddingTop = blockSpace.blockSpaceEditor.shouldHavePadding()\n    ? Blockly.BlockSpace.AUTO_LAYOUT_PADDING_TOP\n    : 0;\n\n  // Block positioning rules are simple:\n  //  if the block has been given an absolute X coordinate, use it\n  //  (taking into account that RTL languages position from the left)\n  //  if the block has been given an absolute Y coordinate, use it\n  //  otherwise, the block \"flows\" with the other blocks from top to\n  //  bottom. Any block positioned absolutely with Y does not influence\n  //  the flow of the other blocks.\n  var cursor = {\n    x: Blockly.RTL ? width - paddingLeft : paddingLeft,\n    y: paddingTop,\n  };\n\n  var positionBlock = function (block) {\n    var padding = block.blockly_block.getSvgPadding() ||\n        {top: 0, right: 0, bottom: 0, left: 0};\n\n    var heightWidth = block.blockly_block.getHeightWidth();\n\n    if (isNaN(block.x)) {\n      block.x = cursor.x;\n      block.x += Blockly.RTL ? -padding.right : padding.left;\n    } else {\n      block.x = Blockly.RTL ? width - block.x : block.x;\n    }\n\n    if (isNaN(block.y)) {\n      block.y = cursor.y + padding.top;\n      cursor.y += heightWidth.height +\n          Blockly.BlockSvg.SEP_SPACE_Y +\n          padding.bottom +\n          padding.top;\n    }\n\n    block.blockly_block.moveTo(block.x, block.y);\n  };\n\n  // To position the blocks, we first render them all to the Block Space\n  //  and parse any X or Y coordinates set in the XML. Then, we store\n  //  the rendered blocks and the coordinates in an array so that we can\n  //  position them in two passes.\n  //  In the first pass, we position the visible blocks. In the second\n  //  pass, we position the invisible blocks. We do this so that\n  //  invisible blocks don't cause the visible blocks to flow\n  //  differently, which could leave gaps between the visible blocks.\n  var blocks = [];\n  for (var i = 0, xmlChild; (xmlChild = xml.childNodes[i]); i++) {\n    if (xmlChild.nodeName.toLowerCase() === 'block') {\n      var blockly_block = Blockly.Xml.domToBlock(blockSpace, xmlChild);\n      var x = parseInt(xmlChild.getAttribute('x'), 10);\n      var y = parseInt(xmlChild.getAttribute('y'), 10);\n      blocks.push({\n        blockly_block: blockly_block,\n        x: x,\n        y: y\n      });\n    }\n  }\n\n  blocks.filter(function (block) {\n    return block.blockly_block.isVisible();\n  }).forEach(positionBlock);\n\n  blocks.filter(function (block) {\n    return !block.blockly_block.isVisible();\n  }).forEach(positionBlock);\n\n  if (Blockly.topLevelProcedureAutopopulate) {\n    blockSpace.blockSpaceEditor.updateFlyout();\n  }\n\n  blockSpace.events.dispatchEvent(Blockly.BlockSpace.EVENTS.EVENT_BLOCKS_IMPORTED);\n  return blocks;\n};\n\n/**\n * Decode an XML block tag and create a block (and possibly sub blocks) on the\n * blockSpace.\n * @param {!Blockly.BlockSpace} blockSpace The blockSpace.\n * @param {!Element} xmlBlock XML block element.\n * @return {!Blockly.Block} The root block created.\n */\nBlockly.Xml.domToBlock = function(blockSpace, xmlBlock) {\n  var prototypeName = xmlBlock.getAttribute('type');\n  var id = xmlBlock.getAttribute('id');\n  var block = new Blockly.Block(blockSpace, prototypeName, id);\n  block.initSvg();\n\n  var collapsed = xmlBlock.getAttribute('collapsed');\n  if (collapsed) {\n    block.setCollapsed(collapsed === 'true');\n  }\n  var disabled = xmlBlock.getAttribute('disabled');\n  if (disabled && !block.unknownBlock) {\n    block.setDisabled(disabled === 'true');\n  }\n  var deletable = xmlBlock.getAttribute('deletable');\n  if (deletable && !block.unknownBlock) {\n    block.setDeletable(deletable === 'true');\n  }\n  var movable = xmlBlock.getAttribute('movable');\n  if (movable && !block.unknownBlock) {\n    block.setMovable(movable === 'true');\n  }\n  var editable = xmlBlock.getAttribute('editable');\n  if (editable) {\n    block.setEditable(editable === 'true');\n  }\n  if (block.unknownBlock) {\n    block.setEditable(false);\n  }\n  var next_connection_disabled = xmlBlock.getAttribute('next_connection_disabled');\n  if (next_connection_disabled) {\n    block.setNextConnectionDisabled(next_connection_disabled === 'true');\n  }\n  var can_disconnect_from_parent = xmlBlock.getAttribute('can_disconnect_from_parent');\n  if (can_disconnect_from_parent) {\n    block.setCanDisconnectFromParent(can_disconnect_from_parent === 'true');\n  }\n  var userVisible = xmlBlock.getAttribute('uservisible');\n  if (userVisible) {\n    block.setUserVisible(userVisible === 'true');\n  }\n  var userCreated = xmlBlock.getAttribute('usercreated');\n  if (userCreated) {\n    block.userCreated = (userCreated === 'true');\n  }\n  var inputCount = xmlBlock.getAttribute('inputcount');\n  if (inputCount) {\n    block.setInputCount(inputCount);\n  }\n  var limit = xmlBlock.getAttribute('limit');\n  var shouldShowLimits = Blockly.editBlocks ? !blockSpace.isFlyout : blockSpace.isFlyout;\n  if (limit && shouldShowLimits) {\n    blockSpace.blockSpaceEditor.blockLimits.setLimit(block.type, parseInt(limit));\n  }\n\n  var blockChild = null;\n  for (var x = 0, xmlChild; x < xmlBlock.childNodes.length; x++) {\n    xmlChild = xmlBlock.childNodes[x];\n    if (xmlChild.nodeType == 3 && xmlChild.data.match(/^\\s*$/)) {\n      // Extra whitespace between tags does not concern us.\n      continue;\n    }\n\n    // Find the first 'real' grandchild node (that isn't whitespace).\n    var firstRealGrandchild = null;\n    for (var y = 0, grandchildNode; y < xmlChild.childNodes.length; y++) {\n      grandchildNode = xmlChild.childNodes[y];\n      if (grandchildNode.nodeType != 3 || !grandchildNode.data.match(/^\\s*$/)) {\n        firstRealGrandchild = grandchildNode;\n      }\n    }\n\n    var name = xmlChild.getAttribute('name');\n    var input = block.getInput(name);\n    switch (xmlChild.nodeName.toLowerCase()) {\n      case 'mutation':\n        // Custom data for an advanced block.\n        if (block.domToMutation) {\n          block.domToMutation(xmlChild);\n        }\n        break;\n      case 'title':\n        /**\n         * XML example:\n         * <block type=\"draw_move_by_constant\">\n         *   <title name=\"DIR\">moveForward</title>\n         *   <title name=\"VALUE\" config=\"1,3,5-10\">10</title>\n         * </block>\n         */\n        var config = xmlChild.getAttribute('config');\n        if (config) {\n          block.setFieldConfig(name, config);\n        }\n        block.setTitleValue(xmlChild.textContent, name);\n        break;\n      case 'value':\n        if (!input) {\n          input = block.appendValueInput(name);\n          console.warn('Unknown block input: \"' + name + '\" not found.');\n        }\n        // Fall through.\n      case 'statement':\n        if (!input) {\n          input = block.appendStatementInput(name);\n          console.warn('Unknown statement: \"' + name + '\" not found.');\n        }\n        // Fall through.\n      case 'functional_input':\n        if (!input) {\n          input = block.appendFunctionalInput(name);\n          console.warn('Unknown functional input: \"' + name + '\" not found.');\n        }\n        if (firstRealGrandchild &&\n            firstRealGrandchild.nodeName.toLowerCase() == 'block') {\n          blockChild = Blockly.Xml.domToBlock(blockSpace, firstRealGrandchild);\n          if (block.unknownBlock) {\n            // Any blocks connected to an `unknown` block should be movable, so\n            // they can be disconnected.\n            blockChild.setMovable(true);\n          }\n          if (blockChild.unknownBlock) {\n            switch (input.connection.type) {\n              case Blockly.NEXT_STATEMENT:\n                blockChild.setPreviousStatement(true);\n                break;\n              case Blockly.INPUT_VALUE:\n                blockChild.setOutput(true);\n                break;\n              default:\n                throw 'Unable to infer connection type for unknown block.';\n            }\n          }\n          if (blockChild.outputConnection) {\n            input.connection.connect(blockChild.outputConnection);\n          } else if (blockChild.previousConnection) {\n            input.connection.connect(blockChild.previousConnection);\n          } else {\n            throw 'Child block does not have output or previous statement.';\n          }\n        }\n        break;\n      case 'next':\n        if (firstRealGrandchild &&\n            firstRealGrandchild.nodeName.toLowerCase() == 'block') {\n          if (!block.nextConnection) {\n            if (block.unknownBlock) {\n              block.setNextStatement(true);\n            } else {\n              throw 'Next statement does not exist.';\n            }\n          } else if (block.nextConnection.targetConnection) {\n            // This could happen if there is more than one XML 'next' tag.\n            throw 'Next statement is already connected.';\n          }\n          blockChild = Blockly.Xml.domToBlock(blockSpace, firstRealGrandchild);\n          if (block.unknownBlock) {\n            // Any blocks connected to an `unknown` block should be movable, so\n            // they can be disconnected.\n            blockChild.setMovable(true);\n          }\n          if (blockChild.unknownBlock) {\n            blockChild.setPreviousStatement(true);\n          }\n          if (!blockChild.previousConnection) {\n            throw 'Next block does not have previous statement.';\n          }\n          block.nextConnection.connect(blockChild.previousConnection);\n        }\n        break;\n      default:\n        // Unknown tag; ignore.  Same principle as HTML parsers.\n    }\n  }\n\n  var next = block.nextConnection && block.nextConnection.targetBlock();\n  if (next) {\n    // Next block in a stack needs to square off its corners.\n    next.render(true);\n    block.render(true);\n  } else {\n    block.render(true);\n  }\n  return block;\n};\n\n/**\n * Remove any 'next' block (statements in a stack).\n * @param {!Element} xmlBlock XML block element.\n */\nBlockly.Xml.deleteNext = function(xmlBlock) {\n  for (var x = 0, child; x < xmlBlock.childNodes.length; x++) {\n    child = xmlBlock.childNodes[x];\n    if (child.nodeName.toLowerCase() == 'next') {\n      xmlBlock.removeChild(child);\n      break;\n    }\n  }\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* global Blockly, goog */\n\n/**\n * @fileoverview Object representing a block blockSpace.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.BlockSpace');\n\n// TODO(scr): Fix circular dependencies\n// goog.require('Blockly.Block');\ngoog.require('Blockly.ScrollbarPair');\ngoog.require('Blockly.Trashcan');\ngoog.require('Blockly.PanDragHandler');\ngoog.require('Blockly.ScrollOnWheelHandler');\ngoog.require('Blockly.ScrollOnBlockDragHandler');\ngoog.require('Blockly.Xml');\ngoog.require('goog.array');\ngoog.require('goog.math.Coordinate');\ngoog.require('goog.math');\n\n/**\n * Class for a BlockSpace.\n * @param {BlockSpaceEditor} blockSpaceEditor parent BlockSpaceEditor for this BlockSpace\n * @param {Function} getMetrics A function that returns size/scrolling metrics.\n * @param {Function} setMetrics A function that sets size/scrolling metrics.\n * @constructor\n */\nBlockly.BlockSpace = function(blockSpaceEditor, getMetrics, setMetrics) {\n  this.blockSpaceEditor = blockSpaceEditor;\n  this.getMetrics = getMetrics;\n  this.setMetrics = function (ratio) {\n    setMetrics(ratio);\n    Blockly.fireUiEvent(window, 'block_space_metrics_set');\n  };\n\n  /** @type {boolean} */\n  this.isFlyout = false;\n  /**\n   * @type {!Array.<!Blockly.Block>}\n   * @private\n   */\n  this.topBlocks_ = [];\n\n  /**\n   * @type {!Array.<!goog.math.Rect>}\n   * @private\n   */\n  this.deleteAreas_ = [];\n\n  /**\n   * The original position of the currently being dragged block.\n   * Used to avoid changing scroll size until block is dropped.\n   * @private {goog.math.Rect}\n   */\n  this.pickedUpBlockOrigin_ = null;\n\n  /** @type {number} */\n  this.maxBlocks = Infinity;\n\n  /** @type {goog.events.EventTarget} */\n  this.events = new goog.events.EventTarget();\n\n  /**\n   * Encapsulates state used to make pan-drag work.\n   * @private {Blockly.PanDragHandler}\n   */\n  this.panDragHandler_ = new Blockly.PanDragHandler(this);\n\n  /**\n   * Encapsulates state used to make scroll-on-mousewheel work.\n   * @private {Blockly.ScrollOnWheelHandler}\n   */\n  this.scrollOnWheelHandler_ = new Blockly.ScrollOnWheelHandler(this);\n\n  /**\n   * Encapsulates state used to make scroll-on-block-drag work.\n   * @type {Blockly.ScrollOnBlockDragHandler}\n   * @private\n   */\n  this.scrollOnBlockDragHandler_ = new Blockly.ScrollOnBlockDragHandler(this);\n\n  Blockly.ConnectionDB.init(this);\n  if (Blockly.BlockSpace.DEBUG_EVENTS) {\n    this.debugLogOnEvents();\n  }\n\n  this.events.listen(Blockly.BlockSpace.EVENTS.EVENT_BLOCKS_IMPORTED,\n      this.updateScrollableSize.bind(this));\n};\n\nBlockly.BlockSpace.DEBUG_EVENTS = false;\n\nBlockly.BlockSpace.EVENTS = {};\n\n/**\n * Called after the mainBlockSpace has been initialized and assigned to\n * the Blockly.mainBlockSpace global attribute, used by\n * onMainBlockSpaceCreated\n * @type {string}\n */\nBlockly.BlockSpace.EVENTS.MAIN_BLOCK_SPACE_CREATED = 'mainBlockSpaceCreated';\n\n/**\n * Called after a blockspace has been populated with a set of blocks\n * (e.g. when using domToBlockSpace)\n * @type {string}\n */\nBlockly.BlockSpace.EVENTS.EVENT_BLOCKS_IMPORTED = 'blocksImported';\n\n/**\n * Fired whenever blocklyBlockSpaceChange normally gets fired\n * @type {string}\n */\nBlockly.BlockSpace.EVENTS.BLOCK_SPACE_CHANGE = 'blockSpaceChange';\nBlockly.BlockSpace.EVENTS.BLOCK_SPACE_SCROLLED = 'blockSpaceScrolled';\n\n/**\n * Fired by Code Studio when the run button is clicked.\n * @type {string}\n */\nBlockly.BlockSpace.EVENTS.RUN_BUTTON_CLICKED = \"runButtonClicked\";\n\n/**\n * Angle away from the horizontal to sweep for blocks.  Order of execution is\n * generally top to bottom, but a small angle changes the scan to give a bit of\n * a left to right bias (reversed in RTL).  Units are in degrees.\n * See: http://tvtropes.org/pmwiki/pmwiki.php/Main/DiagonalBilling.\n */\nBlockly.BlockSpace.SCAN_ANGLE = 3;\n\n/**\n * Offset (in pixels) from top to use when automatically positioning new\n * blocks. Currently is only used by Blockly.Xml.domToBlockSpace\n * @type {number}\n */\nBlockly.BlockSpace.AUTO_LAYOUT_PADDING_TOP = 16;\n\n/**\n * Offset (in pixels) from left to use when automatically positioning\n * new blocks. Currently is only used by Blockly.Xml.domToBlockSpace\n * @type {number}\n */\nBlockly.BlockSpace.AUTO_LAYOUT_PADDING_LEFT = 16;\n\n/**\n * Margin (in pixels) to over-scroll when auto-panning viewport after a block\n * is dragged out of view.\n * @type {number}\n */\nBlockly.BlockSpace.DROPPED_BLOCK_PAN_MARGIN = 25;\n\n/**\n * Pixel padding to maintain below the lowest block in the blockspace.\n * @type {number}\n * @const\n */\nBlockly.BlockSpace.SCROLLABLE_MARGIN_BELOW_BOTTOM = 100;\n\n/**\n * Creates a read-only BlockSpace inside the given container, containing\n * the given XML. Used to display single blocks in feedback dialogs.\n * @param {!Element} container HTML Element into which to render\n * @param {!Element} xml XML block\n * @param {Object} opt_options optional options\n * @param {boolean} opt_options.noScrolling whether or not to disable\n *        scrolling\n * @param {boolean} opt_options.inline whether or not this blockspace should be\n *        treated as an inline element, as opposed to a block element\n * @param {boolean} opt_options.disableEventBindings whether or not to skip\n *        setting up dom event handlers for this blockspace\n * @returns {Blockly.BlockSpace}\n */\nBlockly.BlockSpace.createReadOnlyBlockSpace = function (container, xml, opt_options) {\n  opt_options = opt_options || {};\n\n  var blockSpaceEditor = new Blockly.BlockSpaceEditor(container, {\n    getMetrics: function () {\n      var metrics = Blockly.BlockSpaceEditor.prototype.getBlockSpaceMetrics_.call(this);\n      if (!metrics) {\n        return null;\n      }\n      // Expand the view so we don't see scrollbars\n      metrics.viewHeight += Blockly.BlockSpace.SCROLLABLE_MARGIN_BELOW_BOTTOM;\n      return metrics;\n    },\n    setMetrics: function (xyRatio) {\n      Blockly.BlockSpaceEditor.prototype.setBlockSpaceMetrics_.call(this, xyRatio);\n    },\n    hideTrashRect: true,\n    readOnly: true,\n    disableTooltip: true,\n    noScrolling: opt_options.noScrolling,\n    inline: opt_options.inline,\n    disableEventBindings: opt_options.disableEventBindings,\n  });\n\n  var blockSpace = blockSpaceEditor.blockSpace;\n\n  Blockly.Xml.domToBlockSpace(blockSpace, xml);\n  return blockSpace;\n};\n\n/**\n * Simple helper for situations where we depend on the mainBlockSpace\n * having already been created; most useful for delaying components that\n * want to make their own one-off blockspaces to ensure that they're\n * preserving initialization order.\n * @param {function} callback - callback to be called when\n *     mainBlockSpace is created, or immediately if it already exists\n */\nBlockly.BlockSpace.onMainBlockSpaceCreated = function (callback) {\n  if (Blockly.mainBlockSpace) {\n    callback();\n  } else {\n    document.addEventListener(Blockly.BlockSpace.EVENTS.MAIN_BLOCK_SPACE_CREATED, callback);\n  }\n};\n\n/**\n * Current horizontal scrolling offset.\n * @type {number}\n */\nBlockly.BlockSpace.prototype.xOffsetFromView = 0;\n\n/**\n * Current vertical scrolling offset.\n * @type {number}\n */\nBlockly.BlockSpace.prototype.yOffsetFromView = 0;\n\n/**\n * The blockSpace's trashcan (if any).\n * @type {Blockly.Trashcan}\n */\nBlockly.BlockSpace.prototype.trashcan = null;\n\n/**\n * PID of upcoming firing of a blockSpace change event.  Used to fire only one\n * event after multiple changes.\n * @type {?number}\n * @private\n */\nBlockly.BlockSpace.prototype.fireChangeEventPid_ = null;\n\n/**\n * PID of upcoming firing of a global change event.  Used to fire only one event\n * after multiple changes.\n * @type {?number}\n * @private\n */\nvar fireGlobalChangeEventPid_ = null;\n\n/**\n * This blockSpace's scrollbars, if they exist.\n * @type {Blockly.ScrollbarPair}\n */\nBlockly.BlockSpace.prototype.scrollbarPair = null;\n\n/**\n * @returns {boolean}\n */\nBlockly.BlockSpace.prototype.isReadOnly = function() {\n  return (Blockly.readOnly || this.blockSpaceEditor.isReadOnly());\n};\n\nBlockly.BlockSpace.prototype.isMovementLocked = function() {\n  return this.blockSpaceEditor.isMovementLocked();\n};\n\n/**\n * Sets up debug console logging for events\n */\nBlockly.BlockSpace.prototype.debugLogOnEvents = function() {\n  goog.object.forEach(Blockly.BlockSpace.EVENTS, function(eventIdentifier, eventConstant) {\n    this.events.listen(eventIdentifier, function(eventObject) {\n      console.log(eventObject);\n      console.log(eventConstant);\n      console.log(eventIdentifier);\n    }, false, this);\n  }, this);\n};\n\nBlockly.BlockSpace.prototype.findFunction = function(functionName) {\n  return goog.array.find(this.getTopBlocks(), function(block) {\n    return goog.array.contains(Blockly.Procedures.DEFINITION_BLOCK_TYPES, block.type) &&\n      Blockly.Names.equals(functionName, block.getTitleValue('NAME'));\n  });\n};\n\n/**\n * @param {string} [functionName] If provided, only return examples for the\n *   given function.\n */\nBlockly.BlockSpace.prototype.findFunctionExamples = function(functionName) {\n  return goog.array.filter(this.getTopBlocks(), function(block) {\n    if (Blockly.ContractEditor.EXAMPLE_BLOCK_TYPE === block.type) {\n      var actualBlock = block.getInputTargetBlock(Blockly.ContractEditor.EXAMPLE_BLOCK_ACTUAL_INPUT_NAME);\n      return actualBlock && (!functionName ||\n        Blockly.Names.equals(functionName, actualBlock.getTitleValue('NAME')));\n    }\n    return false;\n  });\n};\n\n/**\n * Create the trash can elements.\n * @return {!Element} The blockSpace's SVG group.\n */\nBlockly.BlockSpace.prototype.createDom = function() {\n  /*\n  <g>\n    [Trashcan may go here]\n    <g></g>\n    <g></g>\n  </g>\n  */\n  this.svgGroup_ = Blockly.createSvgElement('g', {'class': 'svgGroup'}, null);\n  this.clippingGroup_ = Blockly.createSvgElement('g', {'class': 'svgClippingGroup'}, this.svgGroup_);\n  this.svgBlockCanvas_ = Blockly.createSvgElement('g', {'class': 'svgBlockCanvas'}, this.clippingGroup_);\n  this.svgBubbleCanvas_ = Blockly.createSvgElement('g', {'class': 'svgBubbleCanvas'}, this.svgGroup_);\n  this.svgDebugCanvas_ = Blockly.createSvgElement('g', {'class': 'svgDebugCanvas'}, this.svgGroup_);\n\n  // Create a separate SVG to contain blocks while dragging.\n  if (!Blockly.dragSvg) {\n    Blockly.dragSvg = Blockly.createSvgElement('svg', {\n      id: 'blocklyDragCanvas',\n      width: '100%',\n      height: '100%',\n    }, document.body);\n  }\n  this.svgDragCanvas_ = Blockly.createSvgElement('g', {'class': 'svgDragCanvas'}, Blockly.dragSvg);\n\n  Blockly.bindEvent_(this.svgBlockCanvas_, Blockly.BlockSpace.EVENTS.RUN_BUTTON_CLICKED, this, function () {\n    this.getTopBlocks().forEach(function (block) {\n      if (block.isUnused()) {\n        block.getSvgRenderer().addUnusedFrame();\n      }\n    });\n  });\n  \n  if (Blockly.isPortrait){\n    this.trashcan = new Blockly.Trashcan(this);\n    this.svgTrashcan_ = this.trashcan.createDom();\n    this.svgTrashcan_.setAttribute(\"style\", \"display: none; pointer-events: none\");\n    // this.svgTrashcan_.setAttribute(\"transform\", \"translate(\"+0+\", 20)\");\n    this.svgGroup_.appendChild(this.svgTrashcan_);\n  }\n\n  this.fireChangeEvent();\n  return this.svgGroup_;\n};\n\n/**\n * Moves element currently in this BlockSpace to the drag canvas group\n * @param {Element} blockSVGElement svg element to move to the drag group\n */\nBlockly.BlockSpace.prototype.moveElementToDragCanvas = function(blockSVGElement) {\n  this.getDragCanvas().appendChild(blockSVGElement);\n  Blockly.addClass_(Blockly.dragSvg, 'isDragging');\n};\n\n/**\n * Moves element currently in this BlockSpace drag canvas back to the main canvas\n * @param {Element} blockSVGElement svg element to move to the main canvas\n */\nBlockly.BlockSpace.prototype.moveElementToMainCanvas = function(blockSVGElement) {\n  this.getCanvas().appendChild(blockSVGElement);\n  Blockly.removeClass_(Blockly.dragSvg, 'isDragging');\n};\n\n/**\n * Dispose of this blockSpace.\n * Unlink from all DOM elements to prevent memory leaks.\n */\nBlockly.BlockSpace.prototype.dispose = function() {\n  if (this.svgGroup_) {\n    goog.dom.removeNode(this.svgGroup_);\n    this.svgGroup_ = null;\n  }\n  if (this.svgDragCanvas_) {\n    goog.dom.removeNode(this.svgDragCanvas_);\n  }\n  this.svgBlockCanvas_ = null;\n  this.svgDragCanvas_ = null;\n  this.svgDebugCanvas_ = null;\n  this.svgBubbleCanvas_ = null;\n  if (this.flyout_) {\n    this.flyout_.dispose();\n    this.flyout_ = null;\n  }\n  if (this.trashcan) {\n    this.trashcan.dispose();\n    this.trashcan = null;\n  }\n  if (this.scrollbarPair) {\n    this.scrollbarPair.dispose();\n    this.scrollbarPair = null;\n  }\n};\n\n/**\n * Add a trashcan.\n */\nBlockly.BlockSpace.prototype.addTrashcan = function() {\n  if (Blockly.hasTrashcan && !this.isReadOnly()) {\n    this.trashcan = new Blockly.Trashcan(this);\n    var svgTrashcan = this.trashcan.createDom();\n    this.svgBlockCanvas_.appendChild(svgTrashcan);\n    this.trashcan.init();\n  }\n};\n\nBlockly.BlockSpace.prototype.setTrashcan = function(trashcan) {\n  this.trashcan = trashcan;\n};\n\n/**\n * Get the SVG element that wraps groups that should clip at the\n * blockspace view bounds.\n * @return {!SVGGElement} SVG element.\n */\nBlockly.BlockSpace.prototype.getClippingGroup = function() {\n  return this.clippingGroup_;\n};\n\n/**\n * Get the SVG element that forms the drawing surface.\n * @return {!SVGGElement} SVG element.\n */\nBlockly.BlockSpace.prototype.getCanvas = function() {\n  return this.svgBlockCanvas_;\n};\n\n/**\n * Get the SVG element that forms the drawing surface for dragged elements\n * @return {!SVGGElement} SVG element.\n */\nBlockly.BlockSpace.prototype.getDragCanvas = function () {\n  return this.svgDragCanvas_;\n};\n\n/**\n * Get the SVG element that forms the bubble surface.\n * @return {!SVGGElement} SVG element.\n */\nBlockly.BlockSpace.prototype.getBubbleCanvas = function() {\n  return this.svgBubbleCanvas_;\n};\n\nBlockly.BlockSpace.prototype.getTrashCan = function() {\n  return this.svgTrashcan_;\n};\n\n/**\n * Add a block to the list of top blocks.\n * @param {!Blockly.Block} block Block to remove.\n */\nBlockly.BlockSpace.prototype.addTopBlock = function(block) {\n  this.topBlocks_.push(block);\n  this.fireChangeEvent();\n};\n\n/**\n * Checks to see if the given block is in the list of top blocks\n * @param {!Blockly.Block} block\n * @return {boolean}\n */\nBlockly.BlockSpace.prototype.isTopBlock = function (block) {\n  return this.topBlocks_.indexOf(block) > -1;\n};\n\n/**\n * Remove a block from the list of top blocks.\n * @param {!Blockly.Block} block Block to remove.\n */\nBlockly.BlockSpace.prototype.removeTopBlock = function(block) {\n  var found = false;\n  for (var child, x = 0; x < this.topBlocks_.length; x++) {\n    child = this.topBlocks_[x];\n    if (child == block) {\n      this.topBlocks_.splice(x, 1);\n      found = true;\n      break;\n    }\n  }\n  if (!found) {\n    throw 'Block not present this blockSpace\\'s list of top-most blocks.';\n  }\n  this.fireChangeEvent();\n};\n\n/**\n * Finds the top-level blocks and returns them.  Blocks are optionally sorted\n * by position; top to bottom (with slight LTR or RTL bias).\n * @param {boolean} [ordered=false] Sort the list if true.\n * @param {boolean} [shareMainModal=true] Collate main/modal blockSpaces.\n * @return {!Array.<!Blockly.Block>} The top-level block objects.\n */\nBlockly.BlockSpace.prototype.getTopBlocks = function(ordered, shareMainModal) {\n  if (ordered === undefined ) {\n    ordered = false;\n  }\n  if (shareMainModal === undefined ) {\n    shareMainModal = true;\n  }\n\n  var blocks = [];\n  if (shareMainModal && (this === Blockly.mainBlockSpace ||\n      this === Blockly.modalBlockSpace)) {\n    // Main + modal blockspaces share top blocks\n    blocks = blocks.concat(Blockly.mainBlockSpace.topBlocks_)\n      .concat(Blockly.modalBlockSpace ? Blockly.modalBlockSpace.topBlocks_ : []);\n  } else {\n    // Copy the topBlocks_ list.\n    blocks = blocks.concat(this.topBlocks_);\n  }\n  if (ordered && blocks.length > 1) {\n    var offset = Math.sin(Blockly.BlockSpace.SCAN_ANGLE / 180 * Math.PI);\n    if (Blockly.RTL) {\n      offset *= -1;\n    }\n    blocks.sort(function(a, b) {\n      var aXY = a.getRelativeToSurfaceXY();\n      var bXY = b.getRelativeToSurfaceXY();\n      return (aXY.y + offset * aXY.x) - (bXY.y + offset * bXY.x);\n    });\n  }\n  return blocks;\n};\n\n/**\n * Find all visible blocks in this blockSpace.  No particular order.\n * Filters out blocks rendering in other workspaces and currently invisible\n * @return {!Array.<!Blockly.Block>} Array of blocks.\n */\nBlockly.BlockSpace.prototype.getAllVisibleBlocks = function() {\n  return goog.array.filter(this.getAllBlocks(), function(block) {\n    return block.isUserVisible();\n  });\n};\n\n/**\n * Find all used blocks in this blockSpace.  No particular order.\n * Filters out \"unused\" (unattached) blocks\n * @return {!Array.<!Blockly.Block>} Array of blocks.\n */\nBlockly.BlockSpace.prototype.getAllUsedBlocks = function() {\n  return goog.array.filter(this.getAllBlocks(), function(block) {\n    return !block.getRootBlock().isUnused();\n  });\n};\n\n/**\n * Finds the top-level attached blocks\n * @see BlockSpace.prototype.getTopBlocks\n * @return {!Array.<!Blockly.Block>} The top-level attached block objects.\n */\nBlockly.BlockSpace.prototype.getTopUsedBlocks = function() {\n  return goog.array.filter(this.getTopBlocks(), function(block) {\n    return !block.isUnused();\n  });\n};\n\n/**\n * Find all blocks in this blockSpace.  No particular order.\n * @param {object} options\n * @param {boolean?} [options.shareMainModal]\n * @return {!Array.<!Blockly.Block>} Array of blocks.\n */\nBlockly.BlockSpace.prototype.getAllBlocks = function(options) {\n  options = options || {};\n  var blocks = this.getTopBlocks(false, options.shareMainModal);\n  for (var x = 0; x < blocks.length; x++) {\n    blocks = blocks.concat(blocks[x].getChildren());\n  }\n  return blocks;\n};\n\n/**\n * Find all blocks this blockSpace.  No particular order.\n * @return {Number} Count of blocks.\n */\nBlockly.BlockSpace.prototype.getBlockCount = function() {\n  return this.getAllVisibleBlocks().length;\n};\n\n/**\n * Dispose of all blocks this blockSpace.\n */\nBlockly.BlockSpace.prototype.clear = function() {\n  this.blockSpaceEditor.hideChaff();\n  while (this.topBlocks_.length) {\n    this.topBlocks_[0].dispose();\n  }\n};\n\n/**\n * Render all blocks this blockSpace.\n */\nBlockly.BlockSpace.prototype.render = function() {\n  var renderList = this.getAllBlocks();\n  for (var x = 0, block; x < renderList.length; x++) {\n    block = renderList[x];\n    if (!block.getChildren().length) {\n      block.render();\n    }\n  }\n};\n\n/**\n * Finds the block with the specified ID in this blockSpace.\n * @param {string} id ID of block to find.\n * @return {Blockly.Block} The matching block, or null if not found.\n */\nBlockly.BlockSpace.prototype.getBlockById = function(id) {\n  // If this O(n) function fails to scale well, maintain a hash table of IDs.\n  var blocks = this.getAllBlocks();\n  for (var x = 0, block; x < blocks.length; x++) {\n    block = blocks[x];\n    if (block.id == id) {\n      return block;\n    }\n  }\n  return null;\n};\n\n/**\n * Turn the visual trace functionality on or off.\n * @param {boolean} armed True if the trace should be on.\n */\nBlockly.BlockSpace.prototype.traceOn = function(armed) {\n  this.traceOn_ = armed;\n  if (this.traceWrapper_) {\n    Blockly.unbindEvent_(this.traceWrapper_);\n    this.traceWrapper_ = null;\n  }\n  if (armed) {\n    this.traceWrapper_ = Blockly.bindEvent_(this.svgBlockCanvas_,\n        'blocklySelectChange', this, function () {\n          this.traceOn_ = false;\n        });\n  }\n};\n\n/**\n * Highlight a block in the blockSpace.\n * @param {?string} id ID of block to find.\n */\nBlockly.BlockSpace.prototype.highlightBlock = function(id, spotlight) {\n  if (!this.traceOn_ || Blockly.Block.isDragging()) {\n    return;\n  }\n  var block = null;\n  if (id) {\n    block = this.getBlockById(id);\n    if (!block) {\n      return;\n    }\n  }\n  // Temporary turn off the listener for selection changes, so that we don't\n  // trip the monitor for detecting user activity.\n  this.traceOn(false);\n  // Select the current block.\n  if (block) {\n    block.select(spotlight);\n  } else if (Blockly.selected) {\n    Blockly.selected.unselect();\n  }\n  // Restore the monitor for user activity.\n  this.traceOn(true);\n};\n\n/**\n * Fire a change event for this blockSpace.  Changes include new block, dropdown\n * edits, mutations, connections, etc.  Groups of simultaneous changes (e.g.\n * a tree of blocks being deleted) are merged into one event.\n * Applications may hook blockSpace changes by listening for\n * 'blocklyBlockSpaceChange' on Blockly.mainBlockSpace.getCanvas().  To hook\n * changes across all blockSpaces, listen for 'workspaceChange' on window.\n */\nBlockly.BlockSpace.prototype.fireChangeEvent = function() {\n  if (this.fireChangeEventPid_) {\n    window.clearTimeout(this.fireChangeEventPid_);\n  }\n  var canvas = this.svgBlockCanvas_;\n  if (canvas) {\n    var self = this;\n    this.fireChangeEventPid_ = window.setTimeout(function() {\n      self.events.dispatchEvent(Blockly.BlockSpace.EVENTS.BLOCK_SPACE_CHANGE);\n      Blockly.fireUiEvent(canvas, 'blocklyBlockSpaceChange');\n    }, 0);\n  }\n\n  if (fireGlobalChangeEventPid_) {\n    window.clearTimeout(fireGlobalChangeEventPid_);\n  }\n  fireGlobalChangeEventPid_ = window.setTimeout(function () {\n    Blockly.fireUiEvent(window, 'workspaceChange');\n  }, 0);\n};\n\n/**\n * Paste the provided block onto the blockSpace.\n * @param {!Element} xml XML blocks.\n */\nBlockly.BlockSpace.prototype.paste = function(xml) {\n  // When pasting into the main block space, remove parameter blocks\n  if (this === Blockly.mainBlockSpace) {\n    goog.array.forEach(xml.querySelectorAll('block[type=parameters_get]'), function(block) {\n      goog.dom.removeNode(block);\n    });\n  }\n  if (xml.getElementsByTagName('block').length >=\n      this.remainingCapacity()) {\n    return;\n  }\n  var blocks = Blockly.Xml.domToBlockSpace(this, xml);\n\n  blocks.forEach(function(b) {\n    b.blockly_block.bumpNeighbours();\n  });\n  blocks[0].blockly_block.select();\n};\n\n/**\n * The number of blocks that may be added to the blockSpace before reaching\n *     the maxBlocks.\n * @return {number} Number of blocks left.\n */\nBlockly.BlockSpace.prototype.remainingCapacity = function() {\n  if (this.maxBlocks == Infinity) {\n    return Infinity;\n  }\n  return this.maxBlocks - this.getAllBlocks().length;\n};\n\n/**\n * Records the bounding box of the currently dragged block to avoid changing\n * scrolling size until drop.\n */\nBlockly.BlockSpace.prototype.recordPickedUpBlockOrigin = function() {\n  var canvasBBox = this.blockSpaceEditor.getCanvasBBox(this.getDragCanvas());\n  this.pickedUpBlockOrigin_ = Blockly.svgRectToRect(canvasBBox);\n};\n\nBlockly.BlockSpace.prototype.clearPickedUpBlockOrigin = function() {\n  this.pickedUpBlockOrigin_ = null;\n};\n\n/**\n* Make a list of all the delete areas for this blockSpace.\n*/\nBlockly.BlockSpace.prototype.recordDeleteAreas = function() {\n  this.deleteAreas_ = [];\n\n  if (this.trashcan) {\n    goog.array.extend(this.deleteAreas_, this.trashcan.getRect());\n    this.deleteAreaTrash_ = this.trashcan.getRect();\n  } else {\n    this.deleteAreaTrash_ = null;\n  }\n\n  if (!Blockly.isPortrait && this.flyout_) {\n    goog.array.extend(this.deleteAreas_, this.flyout_.getRect());\n  }\n\n  if (!Blockly.isPortrait && this.blockSpaceEditor) {\n    goog.array.extend(this.deleteAreas_,\n        this.blockSpaceEditor.getDeleteAreas());\n  }\n};\n\n/**\n* Is the mouse event over a delete area?\n* Shows the trash zone as a side effect.\n* @param {number} mouseX mouse clientX\n* @param {number} mouseY mouse clientY\n* @param {number} startDragX The x coordinate of the drag start.\n* @param {boolean} undeletable\n* @return {boolean} True if event is in a delete area.\n*/\nBlockly.BlockSpace.prototype.isDeleteArea = function(mouseX, mouseY, startDragX, undeletable) {\n  // If there is no toolbox and no flyout then there is no trash area.\n  if (!Blockly.languageTree) {\n    return false;\n  }\n\n  var mouseXY = Blockly.mouseCoordinatesToSvg(\n    mouseX, mouseY, this.blockSpaceEditor.svg_);\n  var xy = new goog.math.Coordinate(mouseXY.x, mouseXY.y);\n\n  var mouseDragStartXY = Blockly.mouseCoordinatesToSvg(\n    startDragX, 0, this.blockSpaceEditor.svg_);\n  var dragStartXY = new goog.math.Coordinate(\n    mouseDragStartXY.x, mouseDragStartXY.x);\n\n  // Update trash can visual state\n  // Might be nice to do this side-effect elsewhere.\n  if (this.deleteAreaTrash_) {\n    if (this.deleteAreaTrash_.contains(xy)) {\n      this.trashcan.setOpen_(true);\n    } else {\n      this.trashcan.setOpen_(false);\n    }\n  }\n\n  this.drawTrashZone(xy.x, dragStartXY.x, undeletable);\n\n  // Check against all delete areas\n  for (var i = 0, area; i < this.deleteAreas_.length; i++) {\n    area = this.deleteAreas_[i];\n    if (area.contains(xy)) {\n      return true;\n    }\n  }\n\n  this.blockSpaceEditor.setCursor(Blockly.Css.Cursor.CLOSED);\n\n  return false;\n};\n\n/**\n* Called when a drag event ends, to hide any delete UI.\n*/\nBlockly.BlockSpace.prototype.hideDelete = function() {\n  var veryDistantX = Blockly.RTL ? -10000 : 10000;\n  this.drawTrashZone(veryDistantX, 0);\n};\n\n/**\n* Draws the trash zone over the toolbox/flyout, as the user drags an\n* item towards it.\n* @param {!Event} e Mouse move event.\n* @param {integer} startDragX The x coordinate of the drag start.\n* @return {boolean} True if event is in a delete area.\n*/\nBlockly.BlockSpace.prototype.drawTrashZone = function(x, startDragX, undeletable) {\n  if (Blockly.isPortrait) {\n    return;\n  }\n\n  var background;\n  var blockGroup;\n  var trashcan;\n  var trashcanElement;\n  var blockGroupForeground = null;\n\n  // When in the function editor, we will rely on the grey rectangle and\n  // trashcan image provided by the main blockspace underneath.\n  var blockSpaceEditor = this.blockSpaceEditor.hideTrashRect_ ?\n    Blockly.mainBlockSpaceEditor : this.blockSpaceEditor;\n\n  if (this.blockSpaceEditor.toolbox) {\n    var toolbox = blockSpaceEditor.toolbox;\n    background = blockSpaceEditor.svgBackground_;\n    blockGroup = toolbox.tree_.element_;\n    trashcan = toolbox.trashcan;\n    trashcanElement = toolbox.trashcanHolder;\n\n    // When in the function editor there is a second copy of the\n    // toolbox category names shown simultaneously.  It's in the foreground\n    // and owned by the function editor's blockspace.  We'll fade that one too.\n    if (this.blockSpaceEditor.hideTrashRect_) {\n      blockGroupForeground = this.blockSpaceEditor.toolbox.tree_.element_;\n    }\n  } else {\n    var flyout = blockSpaceEditor.flyout_;\n    background = flyout.svgBackground_;\n    blockGroup = flyout.blockSpace_.svgGroup_;\n    trashcan = flyout.trashcan;\n    trashcanElement = trashcan.svgGroup_;\n\n    if (this.blockSpaceEditor.hideTrashRect_) {\n      blockGroupForeground = this.blockSpaceEditor.flyout_.svgGroup_;\n    }\n  }\n\n  var toolbarWidth = background.getBoundingClientRect().width;\n\n  // The user can drag towards the trash zone a little bit before the zone\n  // starts fading in.\n  var dragBuffer = 10;\n\n  // Has the user dragged the block a certain amount towards the trash zone?\n  var pastThreshold = false;\n\n  var xDifference;\n  var trashZoneWidth;\n\n  if (Blockly.RTL) {\n    pastThreshold = x > startDragX + dragBuffer;\n    var editorWidth = blockSpaceEditor.svg_.getBoundingClientRect().width;\n    var canvasAreaWidth = editorWidth - toolbarWidth;\n    xDifference = canvasAreaWidth - x;\n    trashZoneWidth = canvasAreaWidth - startDragX - dragBuffer;\n  } else {\n    pastThreshold = x < startDragX - dragBuffer;\n    xDifference = x - toolbarWidth;\n    trashZoneWidth = startDragX - toolbarWidth - dragBuffer;\n  }\n\n  var normalIntensity = 1;\n\n  // When dragging within this distance, we directly fade in the trash can.\n  // When dragging from beyond this distance, we fade a little until we reach\n  // this distance, and then we fade in the rest of the way from there.\n  var INNER_TRASH_DISTANCE = 100;\n\n  // The intensity when at the INNER_TRASH_DISTANCE during a long drag.\n  var INNER_TRASH_NORMAL_INTENSITY = 0.8;\n  var INNER_TRASH_TRASHCAN_INTENSITY = 1 - INNER_TRASH_NORMAL_INTENSITY;\n\n  if (undeletable) {\n    trashcan.setDisabled(true);\n  } else {\n    trashcan.setDisabled(false);\n  }\n\n  if (pastThreshold) {\n    if (xDifference <= 0) {\n      normalIntensity = 0;\n      if (!undeletable) {\n        trashcan.setOpen_(true);\n      }\n    } else {\n      trashcan.setOpen_(false);\n      if (xDifference >= trashZoneWidth) {\n        normalIntensity = 1;\n      } else if (trashZoneWidth < INNER_TRASH_DISTANCE) {\n        // Short drag, just do a regular scale.\n        normalIntensity = xDifference / trashZoneWidth;\n      } else {\n        // Long drag...\n        if (xDifference < INNER_TRASH_DISTANCE)\n        {\n          // Last part of the drag:\n          // fade normal blocks from mostly-visible to invisible.\n          normalIntensity = xDifference / INNER_TRASH_DISTANCE *\n            INNER_TRASH_NORMAL_INTENSITY;\n        }\n        else\n        {\n          // Initial part of the drag:\n          // fade normal blocks from fully-visible to mostly-visible.\n          normalIntensity = INNER_TRASH_NORMAL_INTENSITY +\n            (xDifference - INNER_TRASH_DISTANCE) /\n            (trashZoneWidth - INNER_TRASH_DISTANCE) *\n            INNER_TRASH_TRASHCAN_INTENSITY;\n        }\n      }\n    }\n  }\n\n  var trashIntensity = 1 - normalIntensity;\n\n  var REGULAR_GREY = 0xdd;\n  var TRASH_GREY = 0xaa;\n\n  var r = Math.floor(trashIntensity * TRASH_GREY + normalIntensity * REGULAR_GREY);\n  var g = Math.floor(trashIntensity * TRASH_GREY + normalIntensity * REGULAR_GREY);\n  var b = Math.floor(trashIntensity * TRASH_GREY + normalIntensity * REGULAR_GREY);\n  var rgbString = \"rgb(\" + r + \", \" + g + \", \" + b + \")\";\n\n  // Fade towards the new backround color.\n  background.style.fill = rgbString;\n\n  // Fade out the blocks in the flyout area.\n  blockGroup.style.opacity = normalIntensity;\n\n  if (blockGroupForeground) {\n    blockGroupForeground.style.opacity = normalIntensity;\n  }\n\n  // Fade in the trash can.\n  var trashcanDisplay = trashIntensity === 0 ? \"none\" : \"block\";\n  trashcanElement.style.opacity = trashIntensity;\n  trashcanElement.style.display = trashcanDisplay;\n};\n\n/**\n * Gives the logical size of the blockly workspace, currently defined as the\n * distance from the block-space origin to the far edge of the farthest block\n * in each scrollable direction (the workspace expands down and/or right to\n * accommodate content), never to be smaller than the blockspace viewport size.\n *\n * Gets used in calculations for scrolling and block bumping.\n *\n * @param {Object} metrics object with information about view and content\n *        dimensions, e.g. output of\n *        Blockly.BlockSpaceEditor.prototype.getBlockSpaceMetrics_\n * @param {number} metrics.contentLeft - distance from x=0 to left edge of\n *        bounding box around all blocks in the blockspace.\n * @param {number} metrics.contentWidth - width of the bounding box around all\n *        blocks in the blockspace.\n * @param {number} metrics.viewWidth - amount of horizontal blockspace that can\n *        be displayed at once.\n * @param {number} metrics.contentTop - distance from y=0 to top edge of bounding\n *        box around all blocks in the blockspace.\n * @param {number} metrics.contentHeight - height of the bounding box around all\n *        blocks in the blockspace.\n * @param {number} metrics.viewHeight - amount of vertical blockspace that can be\n *        displayed at once.\n * @returns {{width: number, height: number}}\n */\nBlockly.BlockSpace.prototype.getScrollableSize = function(metrics) {\n  var scrollbarPair = this.scrollbarPair;\n  var canScrollHorizontally = scrollbarPair && scrollbarPair.canScrollHorizontally();\n  var canScrollVertically = scrollbarPair && scrollbarPair.canScrollVertically();\n\n  var extraVerticalSpace = this.isFlyout ? 0 :\n      Blockly.BlockSpace.SCROLLABLE_MARGIN_BELOW_BOTTOM;\n\n  return {\n    width: canScrollHorizontally ?\n        Math.max(metrics.contentLeft + metrics.contentWidth, metrics.viewWidth) :\n        metrics.viewWidth,\n    height: canScrollVertically ?\n        Math.max(metrics.contentTop + metrics.contentHeight + extraVerticalSpace,\n            metrics.viewHeight) : metrics.viewHeight\n  };\n};\n\n/**\n * Returns a box representing the size of the underlying editable canvas\n * @returns {goog.math.Box}\n */\nBlockly.BlockSpace.prototype.getScrollableBox = function() {\n  var scrollableSize = this.getScrollableSize(this.getMetrics());\n  return new goog.math.Box(0, scrollableSize.width, scrollableSize.height, 0);\n};\n\n/**\n * Returns a box representing the position of the viewport in the coordinate\n * space of the underlying canvas.\n * @returns {goog.math.Box}\n */\nBlockly.BlockSpace.prototype.getViewportBox = function() {\n  var metrics = this.getMetrics();\n  return new goog.math.Box(\n    this.getScrollOffsetY(),\n    this.getScrollOffsetX() + metrics.viewWidth,\n    this.getScrollOffsetY() + metrics.viewHeight,\n    this.getScrollOffsetX());\n};\n\nBlockly.BlockSpace.prototype.panIfOverEdge = function (block, mouseX, mouseY) {\n  this.scrollOnBlockDragHandler_.panIfOverEdge(block, mouseX, mouseY);\n};\n\nBlockly.BlockSpace.prototype.stopAutoScrolling = function () {\n  this.scrollOnBlockDragHandler_.stopAutoScrolling();\n};\n\n/**\n * Given a block, scrolls the viewport to contain the block (plus a small\n * margin).\n * @param {Blockly.Block} block\n */\nBlockly.BlockSpace.prototype.scrollIntoView = function (block) {\n  var blockBox = block.getBox();\n  var currentView = this.getViewportBox();\n\n  var boxOverflows = Blockly.getBoxOverflow(currentView, blockBox);\n  Blockly.addToNonZeroSides(boxOverflows,\n    Blockly.BlockSpace.DROPPED_BLOCK_PAN_MARGIN);\n\n  var isOversizedX = Blockly.isBoxWiderThan(blockBox, currentView);\n  var isOversizedY = Blockly.isBoxTallerThan(blockBox, currentView);\n  var isAlreadyInView = (isOversizedX || isOversizedY) ?\n      goog.math.Box.intersects(blockBox, currentView) : false;\n\n  // If block is bigger than viewport, only scroll if it's not in view at all.\n  var horizontalDelta = (isOversizedX && isAlreadyInView) ?\n      0 : boxOverflows.right - boxOverflows.left;\n  var verticalDelta = (isOversizedY && isAlreadyInView) ?\n      0 : boxOverflows.bottom - boxOverflows.top;\n  this.scrollToDelta(horizontalDelta, verticalDelta);\n};\n\n/**\n * Relative version of {@link Blockly.BlockSpace#scrollWithAnySelectedBlock}\n * @param {number} scrollDx delta amount to pan-right (+)\n * @param {number} scrollDy delta amount to pan-down (+)\n * @param {number} mouseX clientX position of mouse\n * @param {number} mouseY clientY position of mouse\n */\nBlockly.BlockSpace.prototype.scrollDeltaWithAnySelectedBlock = function (scrollDx, scrollDy,\n  mouseX, mouseY) {\n  this.scrollWithAnySelectedBlock(\n    this.getScrollOffsetX() + scrollDx,\n    this.getScrollOffsetY() + scrollDy,\n    mouseX,\n    mouseY);\n};\n\n\n/**\n * Given desired new scrollX and scrollY positions, scroll to position,\n * clamping to within allowable scroll boundaries.\n *\n * If a block is selected, this will also move it to stay under the current\n * mouse position after scroll (otherwise it would appear to scroll with the\n * entire blockspace).\n * @param {number} newScrollX new target pan-right (+) offset\n * @param {number} newScrollY new target pan-down (+) offset\n * @param {number} mouseX current mouse clientX position (used for\n *        currently-dragged block movement syncing)\n * @param {number} mouseY current mouse clientY position\n */\nBlockly.BlockSpace.prototype.scrollWithAnySelectedBlock = function (newScrollX,\n                                                                    newScrollY,\n                                                                    mouseX,\n                                                                    mouseY) {\n  /** @type {goog.math.Vec2} */\n  var offsetBefore = this.getScrollOffset();\n\n  this.scrollTo(newScrollX, newScrollY);\n\n  /**\n   * If dragging a block too, move the \"mouse start position\" as if it\n   * had scrolled along with any blockspace scrolling, and add the scroll event\n   * delta to the block's movement.\n   */\n  if (Blockly.Block.isFreelyDragging() && Blockly.selected) {\n    var scrolledAmount = this.getScrollOffset().subtract(offsetBefore);\n    Blockly.selected.startDragMouseX -= scrolledAmount.x;\n    Blockly.selected.startDragMouseY -= scrolledAmount.y;\n    // Moves block to stay under cursor's clientX/clientY\n    Blockly.selected.moveBlockBeingDragged_(mouseX, mouseY);\n  }\n};\n\n/**\n * Scrolls to given delta coordinates\n * @param {number} scrollDx pixels to pan-right (+)\n * @param {number} scrollDy pixels to pan-down (+)\n */\nBlockly.BlockSpace.prototype.scrollToDelta = function (scrollDx, scrollDy) {\n  this.scrollTo(this.getScrollOffsetX() + scrollDx,\n    this.getScrollOffsetY() + scrollDy);\n};\n\n/**\n * If possible, scrolls scrollbars to given offset coordinates.\n * Clamps desired values between zero and max scroll values.\n * @param {number} newScrollX new pan-right (+) offset\n * @param {number} newScrollY new pan-down (+) offset\n */\nBlockly.BlockSpace.prototype.scrollTo = function (newScrollX, newScrollY) {\n  if (!this.scrollbarPair) {\n    return;\n  }\n\n  var maxScrollOffsets = this.getMaxScrollOffsets();\n\n  newScrollX = goog.math.clamp(newScrollX, 0, maxScrollOffsets.x);\n  newScrollY = goog.math.clamp(newScrollY, 0, maxScrollOffsets.y);\n\n  // Set the scrollbar position, which will auto-scroll the canvas\n  this.scrollbarPair.set(newScrollX, newScrollY);\n  this.events.dispatchEvent(Blockly.BlockSpace.EVENTS.BLOCK_SPACE_SCROLLED);\n};\n\n/**\n * Returns whether there any scrolling is currently possible on the BlockSpace\n * (i.e., scrollbars should be visible, panning/dragging should have an effect).\n * @returns {boolean} true if the BlockSpace can currently be scrolled.\n */\nBlockly.BlockSpace.prototype.currentlyScrollable = function() {\n  var maxOffsets = this.getMaxScrollOffsets();\n  return maxOffsets.x > 0 || maxOffsets.y > 0;\n};\n\n/**\n * Returns the maximum possible scrolling offsets (+x right, +y down) for\n * this blockspace.\n * @returns {{x: number, y: number}}\n */\nBlockly.BlockSpace.prototype.getMaxScrollOffsets = function() {\n  var metrics = this.getMetrics();\n  var blockSpaceSize = this.getScrollableSize(metrics);\n  return {\n    x: blockSpaceSize.width - metrics.viewWidth,\n    y: blockSpaceSize.height - metrics.viewHeight\n  };\n};\n\n/**\n * @returns {goog.math.Vec2} scroll offsets\n */\nBlockly.BlockSpace.prototype.getScrollOffset = function() {\n  return new goog.math.Vec2(this.getScrollOffsetX(), this.getScrollOffsetY());\n};\n\n/**\n * @returns {number} current scroll X offset, + is right\n */\nBlockly.BlockSpace.prototype.getScrollOffsetX = function() {\n  return -this.xOffsetFromView;\n};\n\n/**\n * @returns {number} current scroll Y offset, + is down\n */\nBlockly.BlockSpace.prototype.getScrollOffsetY = function() {\n  return -this.yOffsetFromView;\n};\n\n/**\n * Can be called to force an update of scrollbar height/position and usable\n * blockspace size according to the current content.\n */\nBlockly.BlockSpace.prototype.updateScrollableSize = function () {\n  if (this.scrollbarPair) {\n    this.scrollbarPair.resize();\n  }\n};\n\n/**\n * Establish a mousedown handler on the given dragTarget that will put the\n * blockspace into a pan-drag mode as long as the mouse is down.\n * @param {!EventTarget} target - Element which initiates pan-drag mode when\n *        clicked directly.\n * @param {function} [onDragTargetMouseDown] - optional function called when\n *        click on the drag target begins (used for hideChaff by BSE)\n */\nBlockly.BlockSpace.prototype.bindBeginPanDragHandler = function (target,\n                                                                 onDragTargetMouseDown) {\n  this.panDragHandler_.bindBeginPanDragHandler(target, onDragTargetMouseDown);\n};\n\n/**\n * @param {!EventTarget} target - Element which initiates pan-drag mode when\n *        clicked directly.\n */\nBlockly.BlockSpace.prototype.bindScrollOnWheelHandler = function (target) {\n  this.scrollOnWheelHandler_.bindTo(target);\n};\n\n/**\n * Unbinds previously bound handler to begin pan-drag.  Safe to call if no\n * such handler is bound.\n */\nBlockly.BlockSpace.prototype.unbindBeginPanDragHandler = function () {\n  this.panDragHandler_.unbindBeginPanDragHandler();\n};\n\n/**\n * Cached set of debug rectangles.\n * @type {{key: string, svgRect: SVGRect}}\n * @private\n */\nBlockly.BlockSpace.prototype.debugRects_ = {};\n\n/**\n * Draws a debug box in the coordindates of this blockspace, in the same\n * group as blocks are placed. Will re-use boxes based on given key.\n * @param {string} key - unique key for box\n * @param {goog.math.Box} box - box definition w.r.t. blockspace coordinates\n * @param {string} color - color for box outline\n */\nBlockly.BlockSpace.prototype.drawDebugBox = function (key, box, color) {\n  var rect = goog.math.Rect.createFromBox(box);\n  if (!this.debugRects_[key]) {\n    this.debugRects_[key] = Blockly.createSvgElement('rect', {\n      fill: 'none',\n      style: 'pointer-events: none'\n    }, this.svgDebugCanvas_);\n  }\n  this.svgDebugCanvas_.setAttribute('transform', this.svgBlockCanvas_.getAttribute('transform'));\n  var debugSvgRect = this.debugRects_[key];\n  debugSvgRect.setAttribute('x', rect.left);\n  debugSvgRect.setAttribute('y', rect.top);\n  debugSvgRect.setAttribute('width', rect.width);\n  debugSvgRect.setAttribute('height', rect.height);\n  debugSvgRect.setAttribute('stroke', color);\n  debugSvgRect.setAttribute('stroke-width', 3);\n};\n\n/**\n * Cached set of debug circles.\n * @type {{key: string, svgRect: SVGRect}}\n * @private\n */\nBlockly.BlockSpace.prototype.debugCircles_ = {};\n\n/**\n * Draws a debug circle in the coordindates of this blockspace, in the same\n * group as blocks are placed. Will re-use circles based on given key.\n * @param {string} key\n * @param {goog.math.Coordinate} coordinate\n * @param {string} color\n */\nBlockly.BlockSpace.prototype.drawDebugCircle = function (key, coordinate, color) {\n  var radius = 10;\n  if (!this.debugCircles_[key]) {\n   this.debugCircles_[key] = Blockly.createSvgElement('circle', {\n     cx: \"50\",\n     cy: \"50\",\n     r: \"50\",\n     style: 'pointer-events: none'\n   }, this.svgDebugCanvas_);\n  }\n  this.svgDebugCanvas_.setAttribute('transform', this.svgBlockCanvas_.getAttribute('transform'));\n  var debugSvgRect = this.debugCircles_[key];\n  debugSvgRect.setAttribute('cx', ''+coordinate.x);\n  debugSvgRect.setAttribute('cy', ''+coordinate.y);\n  debugSvgRect.setAttribute('r', radius);\n  debugSvgRect.setAttribute('fill', color);\n};\n\n/**\n * Removes and clears list of debug drawings\n */\nBlockly.BlockSpace.prototype.clearDebugDrawings = function () {\n  [this.debugCircles_, this.debugRects_].forEach(function (debugDict) {\n    for (var key in debugDict) {\n      var svg = debugDict[key];\n      goog.dom.removeNode(svg);\n    }\n  });\n  this.debugCircles_ = {};\n  this.debugRects_ = {};\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Components for creating connections between blocks.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Connection');\ngoog.provide('Blockly.ConnectionDB');\n\ngoog.require('Blockly.BlockSpace');\ngoog.require('goog.array');\ngoog.require('goog.string');\n\n/**\n * SVG paths for drawing next/previous notch from left to right, left to right\n * with highlighting, and right to left. In both cases, there's currently\n * assumption that NOTCH_WIDTH and NOTCH_PATH_WIDTH (which are defined on\n * BlockSvg) are the same.\n */\nvar ROUNDED_NOTCH_PATHS = {\n  left: 'l 6,4 3,0 6,-4',\n  leftHighlight: 'l 6.5,4 2,0 6.5,-4',\n  right: 'l -6,4 -3,0 -6,-4'\n};\n\nvar SQUARE_NOTCH_PATHS = {\n  left: 'l 0,5 15,0 0,-5',\n  leftHighlight: 'l 0,5 15,0 0,-5',\n  right: 'l 0,5 -15,0 0,-5'\n};\n\n/**\n * Class for a connection between blocks.\n * @param {!Blockly.Block} source The block establishing this connection.\n * @param {number} type The type of the connection.\n * @constructor\n */\nBlockly.Connection = function(source, type) {\n  this.sourceBlock_ = source;\n  this.targetConnection = null;\n  /**\n   * Type of connection. Constant values defined in blockly.js\n   * e.g. Blockly.INPUT_VALUE, Blockly.OUTPUT_VALUE\n   * @type {number}\n   */\n  this.type = type;\n  /**\n   * Absolute x coordinate of connection\n   * @type {number}\n   * @private\n   */\n  this.x_ = 0;\n  /**\n   * Absolute y coordinate of connection\n   * @type {number}\n   * @private\n   */\n  this.y_ = 0;\n  this.inDB_ = false;\n  // Shortcut for the databases for this connection's blockSpace.\n  this.dbList_ = this.sourceBlock_.blockSpace.connectionDBList;\n\n  /**\n   * Compatible type check\n   * @type {?Array.<Blockly.BlockValueType>} array of valid connection types\n   * @private\n   */\n  this.check_ = null;\n\n  /**\n   * Enabled field helpers for this connection and their associated options\n   * @private\n   */\n  this.fieldHelpers_ = {};\n};\n\n/**\n * Possible input/output tab shapes\n */\nBlockly.Connection.Shapes = {\n  STANDARD: 'standard',\n  ANGLE: 'angle',\n  SQUARE: 'square',\n  ROUNDED: 'rounded'\n};\n\n/**\n * Is this connection currently connected to another connection.\n */\nBlockly.Connection.prototype.isConnected = function () {\n  return this.targetConnection !== null;\n};\n\n/**\n * Sever all links to this connection (not including from the source object).\n */\nBlockly.Connection.prototype.dispose = function() {\n  if (this.isConnected()) {\n    throw 'Disconnect connection before disposing of it.';\n  }\n  if (this.inDB_) {\n    this.dbList_[this.type].removeConnection_(this);\n  }\n  this.inDB_ = false;\n  if (Blockly.highlightedConnection_ == this) {\n    Blockly.highlightedConnection_ = null;\n  }\n  if (Blockly.localConnection_ == this) {\n    Blockly.localConnection_ = null;\n  }\n};\n\n/**\n * Does the connection belong to a superior block (higher in the source stack)?\n * @return {boolean} True if connection faces down or right.\n */\nBlockly.Connection.prototype.isSuperior = function() {\n  return this.type === Blockly.INPUT_VALUE ||\n    this.type === Blockly.NEXT_STATEMENT ||\n    this.type === Blockly.FUNCTIONAL_INPUT;\n};\n\n/**\n * Connect this connection to another connection.\n * @param {!Blockly.Connection} connectTo Connection to connect to.\n */\nBlockly.Connection.prototype.connect = function(connectTo) {\n  if (this.sourceBlock_ == connectTo.sourceBlock_) {\n    throw 'Attempted to connect a block to itself.';\n  }\n  if (this.sourceBlock_.blockSpace !== connectTo.sourceBlock_.blockSpace) {\n    throw 'Blocks are on different blockSpaces.';\n  }\n  if (Blockly.OPPOSITE_TYPE[this.type] != connectTo.type) {\n    throw 'Attempt to connect incompatible types.';\n  }\n  if (this.isConnected()) {\n    throw 'Source connection already connected.';\n  }\n\n  if (connectTo.targetConnection) {\n    this.handleOrphan_(connectTo);\n  }\n\n  // Determine which block is superior (higher in the source stack).\n  var parentBlock, childBlock;\n  if (this.isSuperior()) {\n    // Superior block.\n    parentBlock = this.sourceBlock_;\n    childBlock = connectTo.sourceBlock_;\n  } else {\n    // Inferior block.\n    parentBlock = connectTo.sourceBlock_;\n    childBlock = this.sourceBlock_;\n  }\n\n  // Establish the connections.\n  this.targetConnection = connectTo;\n  connectTo.targetConnection = this;\n\n  // Demote the inferior block so that one is a child of the superior one.\n  childBlock.setParent(parentBlock);\n\n  if (parentBlock.rendered) {\n    parentBlock.getSvgRenderer().updateDisabled();\n  }\n  if (childBlock.rendered) {\n    childBlock.getSvgRenderer().updateDisabled();\n  }\n  if (parentBlock.rendered && childBlock.rendered) {\n    if (this.type == Blockly.NEXT_STATEMENT ||\n        this.type == Blockly.PREVIOUS_STATEMENT) {\n      // Child block may need to square off its corners if it is in a stack.\n      // Rendering a child will render its parent.\n      childBlock.render();\n    } else {\n      // Child block does not change shape.  Rendering the parent node will\n      // move its connected children into position.\n      parentBlock.render();\n    }\n  }\n\n  // Mark as userHidden if the parent is userHidden\n  if (!this.sourceBlock_.isUserVisible()) {\n    this.sourceBlock_.setUserVisible(false);\n  }\n};\n\n/**\n * Handle the orphaned block of existingConnection when connecting this to\n * existingConnection. This consists of detaching the orphan, and then depending\n * on its type, potentially trying to reattach it elsewhere.\n */\nBlockly.Connection.prototype.handleOrphan_ = function (existingConnection) {\n  var orphanBlock = existingConnection.targetBlock();\n  orphanBlock.setParent(null);\n  orphanBlock.setUserVisible(true);\n\n  if (this.type === Blockly.INPUT_VALUE || this.type === Blockly.OUTPUT_VALUE) {\n    if (!orphanBlock.outputConnection) {\n      throw 'Orphan block does not have an output connection.';\n    }\n\n    // Attempt to reattach the orphan at the end of the newly inserted\n    // block.  Since this block may be a row, walk down to the end.\n    var newBlock = this.sourceBlock_;\n    var connection;\n    while (connection = Blockly.Connection.singleConnection_(newBlock,\n      orphanBlock)) {\n      // '=' is intentional in line above.\n      if (connection.targetBlock()) {\n        newBlock = connection.targetBlock();\n      } else {\n        connection.connect(orphanBlock.outputConnection);\n        orphanBlock = null;\n        break;\n      }\n    }\n\n    // if we didn't find a new location for our orphan, bump it away\n    if (orphanBlock) {\n      window.setTimeout(function() {\n        orphanBlock.outputConnection.bumpAwayFrom_(existingConnection);\n      }, Blockly.BUMP_DELAY);\n    }\n  } else if (this.type === Blockly.FUNCTIONAL_INPUT\n      || this.type === Blockly.FUNCTIONAL_OUTPUT) {\n    if (!orphanBlock.previousConnection) {\n      throw 'Orphan block does not have a previous connection.';\n    }\n    // bump away the orphaned block\n    window.setTimeout(function() {\n      orphanBlock.previousConnection.bumpAwayFrom_(existingConnection);\n    }, Blockly.BUMP_DELAY);\n  } else {\n    // Statement blocks may be inserted into the middle of a stack, which case\n    // we want to attach the orphan to the end of the inserted blocks\n    if (this.type != Blockly.PREVIOUS_STATEMENT) {\n      throw 'Can only do a mid-stack connection with the top of a block.';\n    }\n\n    if (!orphanBlock.previousConnection) {\n      throw 'Orphan block does not have a previous connection.';\n    }\n    // Attempt to reattach the orphan at the bottom of the newly inserted\n    // block.  Since this block may be a stack, walk down to the end.\n    var newBlock = this.sourceBlock_;\n    while (newBlock.nextConnection) {\n      if (newBlock.nextConnection.targetConnection) {\n        newBlock = newBlock.nextConnection.targetBlock();\n      } else {\n        newBlock.nextConnection.connect(orphanBlock.previousConnection);\n        orphanBlock = null;\n        break;\n      }\n    }\n    if (orphanBlock) {\n      // Unable to reattach orphan.  Bump it off to the side.\n      window.setTimeout(function() {\n        orphanBlock.previousConnection.bumpAwayFrom_(existingConnection);\n      }, Blockly.BUMP_DELAY);\n    }\n  }\n}\n\n/**\n * Does the given block have one and only one connection point that will accept\n * the orphaned block?\n * @param {!Blockly.Block} block The superior block.\n * @param {!Blockly.Block} orphanBlock The inferior block.\n * @return {Blockly.Connection} The suitable connection point on 'block',\n *     or null.\n * @private\n */\nBlockly.Connection.singleConnection_ = function(block, orphanBlock) {\n  var connection = false;\n  for (var x = 0; x < block.inputList.length; x++) {\n    var thisConnection = block.inputList[x].connection;\n    if (thisConnection && thisConnection.type == Blockly.INPUT_VALUE &&\n        orphanBlock.outputConnection.checkAllowedConnectionType_(thisConnection)) {\n      if (connection) {\n        return null;  // More than one connection.\n      }\n      connection = thisConnection;\n    }\n  }\n  return connection;\n};\n\n/**\n * Disconnect this connection.\n */\nBlockly.Connection.prototype.disconnect = function() {\n  var otherConnection = this.targetConnection;\n  if (!otherConnection) {\n    throw 'Source connection not connected.';\n  } else if (otherConnection.targetConnection != this) {\n    throw 'Target connection not connected to source connection.';\n  }\n  otherConnection.targetConnection = null;\n  this.targetConnection = null;\n  this.sourceBlock_.setUserVisible(true);\n\n  // Rerender the parent so that it may reflow.\n  var parentBlock, childBlock;\n  if (this.isSuperior()) {\n    // Superior block.\n    parentBlock = this.sourceBlock_;\n    childBlock = otherConnection.sourceBlock_;\n  } else {\n    // Inferior block.\n    parentBlock = otherConnection.sourceBlock_;\n    childBlock = this.sourceBlock_;\n  }\n  if (parentBlock.rendered) {\n    parentBlock.render();\n  }\n  if (childBlock.rendered) {\n    childBlock.getSvgRenderer().updateDisabled();\n    childBlock.render();\n  }\n};\n\n/**\n * Returns the block that this connection connects to.\n * @return {Blockly.Block} The connected block or null if none is connected.\n */\nBlockly.Connection.prototype.targetBlock = function() {\n  if (this.targetConnection) {\n    return this.targetConnection.sourceBlock_;\n  }\n  return null;\n};\n\n/**\n * Move the block(s) belonging to the connection to a point where they don't\n * visually interfere with the specified connection.\n * @param {!Blockly.Connection} staticConnection The connection to move away\n *     from.\n * @private\n */\nBlockly.Connection.prototype.bumpAwayFrom_ = function(staticConnection) {\n  if (Blockly.Block.isDragging()) {\n    // Don't move blocks around while the user is doing the same.\n    return;\n  }\n  // Move the root block.\n  var rootBlock = this.sourceBlock_.getRootBlock();\n  if (rootBlock.isInFlyout) {\n    // Don't move blocks around in a flyout.\n    return;\n  }\n  var reverse = false;\n  if (!rootBlock.isMovable()) {\n    // Can't bump an uneditable block away.\n    // Check to see if the other block is movable.\n    rootBlock = staticConnection.sourceBlock_.getRootBlock();\n    if (!rootBlock.isMovable()) {\n      return;\n    }\n    // Swap the connections and move the 'static' connection instead.\n    staticConnection = this;\n    reverse = true;\n  }\n  // Raise it to the top for extra visibility.\n  rootBlock.getSvgRoot().parentNode.appendChild(rootBlock.getSvgRoot());\n  var dx = (staticConnection.x_ + Blockly.SNAP_RADIUS) - this.x_;\n  var dy = (staticConnection.y_ + Blockly.SNAP_RADIUS * 2) - this.y_;\n  if (reverse) {\n    // When reversing a bump due to an uneditable block, bump up.\n    dy = -dy;\n  }\n  if (Blockly.RTL) {\n    dx = -dx;\n  }\n  rootBlock.moveBy(dx, dy);\n  rootBlock.bumpNeighbours();\n};\n\n/**\n * Change the connection's coordinates.\n * @param {number} x New absolute x coordinate.\n * @param {number} y New absolute y coordinate.\n */\nBlockly.Connection.prototype.moveTo = function(x, y) {\n  // Remove it from its old location in the database (if already present)\n  if (this.inDB_) {\n    this.dbList_[this.type].removeConnection_(this);\n  }\n  this.x_ = x;\n  this.y_ = y;\n  // Insert it into its new location in the database.\n  this.dbList_[this.type].addConnection_(this);\n};\n\n/**\n * Change the connection's coordinates.\n * @param {number} dx Change to x coordinate.\n * @param {number} dy Change to y coordinate.\n */\nBlockly.Connection.prototype.moveBy = function(dx, dy) {\n  this.moveTo(this.x_ + dx, this.y_ + dy);\n};\n\n/**\n * Get the hint type color for a given set of strict checks.\n */\nBlockly.Connection.prototype.colorForType = function(checks) {\n  if (!checks || checks.length > 1) {\n    return;\n  }\n  switch (checks[0]) {\n    case 'String':\n      return [160, 0.45, 0.65];\n    case 'Number':\n      return [258, 0.35, 0.62];\n    case 'Boolean':\n      return [196, 1.0, 0.79];\n    case 'Array':\n      return [40, 1.0, 0.99];\n    case 'Colour':\n      return [196, 1.0, 0.79];\n    case 'Sprite':\n      return [355, 0.70, 0.70];\n    case 'Behavior':\n      return [136, 0.84, 0.80];\n    case 'Location':\n      return [52, 0.70, 0.92];\n    default:\n      return;\n  }\n};\n\n/**\n * Calculate the path to highlight this connection.\n */\nBlockly.Connection.prototype.getPathInfo = function() {\n  var steps;\n  if (this.type === Blockly.INPUT_VALUE || this.type === Blockly.OUTPUT_VALUE) {\n    var path = Blockly.BlockSvg\n      .TAB_PATHS_BY_SHAPE[this.getTabShape()]\n      .TAB_PATH_DOWN;\n    steps = 'm 0,0 ' + path + ' v 5';\n  } else {\n    var moveWidth = 5 + Blockly.BlockSvg.NOTCH_PATH_WIDTH;\n    var notchPaths = this.getNotchPaths();\n    steps = 'm -' + moveWidth + ',0 h 5 ' + notchPaths.left + ' h 5';\n  }\n  var xy = this.sourceBlock_.getRelativeToSurfaceXY();\n  var x = this.x_ - xy.x;\n  var y = this.y_ - xy.y;\n  var transform = 'translate(' + x + ', ' + y + ')';\n  if (Blockly.RTL) {\n    transform += ' scale(-1, 1)';\n  }\n  return {\n    steps: steps,\n    transform: transform,\n    color: this.colorForType(this.check_)\n  };\n};\n\n/**\n * Add highlighting around this connection.\n */\nBlockly.Connection.prototype.highlight = function() {\n  var steps;\n  if (this.type === Blockly.INPUT_VALUE || this.type === Blockly.OUTPUT_VALUE) {\n    var tabWidth = Blockly.RTL ? -Blockly.BlockSvg.TAB_WIDTH :\n                                 Blockly.BlockSvg.TAB_WIDTH;\n    steps = 'm 0,0 v 5 c 0,10 ' + -tabWidth + ',-8 ' + -tabWidth + ',7.5 s ' +\n            tabWidth + ',-2.5 ' + tabWidth + ',7.5 v 5';\n  } else {\n    var moveWidth = 5 + Blockly.BlockSvg.NOTCH_PATH_WIDTH;\n    var notchPaths = this.getNotchPaths();\n    if (Blockly.RTL) {\n      steps = 'm ' + moveWidth + ',0 h -5 ' + notchPaths.right + ' h -5';\n    } else {\n      steps = 'm -' + moveWidth + ',0 h 5 ' + notchPaths.left + ' h 5';\n    }\n  }\n  var xy = this.sourceBlock_.getRelativeToSurfaceXY();\n  var x = this.x_ - xy.x;\n  var y = this.y_ - xy.y;\n  Blockly.Connection.highlightedPath_ = Blockly.createSvgElement('path',\n      {'class': 'blocklyHighlightedConnectionPath',\n       'd': steps,\n       transform: 'translate(' + x + ', ' + y + ')'},\n      this.sourceBlock_.getSvgRoot());\n};\n\n/**\n * Remove the highlighting around this connection.\n */\nBlockly.Connection.prototype.unhighlight = function() {\n  goog.dom.removeNode(Blockly.Connection.highlightedPath_);\n  delete Blockly.Connection.highlightedPath_;\n};\n\n/**\n *\n */\nBlockly.Connection.prototype.getNotchPaths = function () {\n  if (Blockly.Connection.NOTCH_PATHS_OVERRIDE) {\n    return Blockly.Connection.NOTCH_PATHS_OVERRIDE;\n  }\n\n  var constraints = this && this.check_ || [];\n  if (constraints.length === 1 && constraints[0] === Blockly.BlockValueType.FUNCTION) {\n    return SQUARE_NOTCH_PATHS;\n  }\n  return ROUNDED_NOTCH_PATHS;\n};\n\n/**\n * Return the tab shape for this input or output connection\n */\nBlockly.Connection.prototype.getTabShape = function () {\n  if (this.type !== Blockly.INPUT_VALUE && this.type !== Blockly.OUTPUT_VALUE) {\n    return null;\n  }\n  if (!this.strictType_ || !Blockly.valueTypeTabShapeMap) {\n    return Blockly.Connection.Shapes.STANDARD;\n  }\n  var type = this.check_[0];\n  if (!type) {\n    throw 'strict connections require a type';\n  }\n  return Blockly.valueTypeTabShapeMap[type] ||\n    Blockly.Connection.Shapes.STANDARD;\n};\n\n\n/**\n * Move the blocks on either side of this connection right next to each other.\n * @private\n */\nBlockly.Connection.prototype.tighten_ = function() {\n  var dx = Math.round(this.targetConnection.x_ - this.x_);\n  var dy = Math.round(this.targetConnection.y_ - this.y_);\n  if (dx != 0 || dy != 0) {\n    var block = this.targetBlock();\n    var svgRoot = block.getSvgRoot();\n    if (!svgRoot) {\n      throw 'block is not rendered.';\n    }\n    var xy = Blockly.getRelativeXY(svgRoot);\n    block.getSvgRoot().setAttribute('transform',\n        'translate(' + (xy.x - dx) + ', ' + (xy.y - dy) + ')');\n    block.moveConnections_(-dx, -dy);\n  }\n};\n\n/**\n * Find the closest compatible connection to this connection.\n * @param {number} maxLimit The maximum radius to another connection.\n * @param {number} dx Horizontal offset between this connection's location\n *     in the database and the current location (as a result of dragging).\n * @param {number} dy Vertical offset between this connection's location\n *     in the database and the current location (as a result of dragging).\n * @return {!Object} Contains two properties: 'connection' which is either\n *     another connection or null, and 'radius' which is the distance.\n */\nBlockly.Connection.prototype.closest = function(maxLimit, dx, dy) {\n  if (this.isConnected()) {\n    // Don't offer to connect to a connection that's already connected.\n    return {connection: null, radius: maxLimit};\n  }\n  // Determine the opposite type of connection.\n  var oppositeType = Blockly.OPPOSITE_TYPE[this.type];\n  var db = this.dbList_[oppositeType];\n\n  // Since this connection is probably being dragged, add the delta.\n  var currentX = this.x_ + dx;\n  var currentY = this.y_ + dy;\n\n  // Binary search to find the closest y location.\n  var pointerMin = 0;\n  var pointerMax = db.length - 2;\n  var pointerMid = pointerMax;\n  while (pointerMin < pointerMid) {\n    if (db[pointerMid].y_ < currentY) {\n      pointerMin = pointerMid;\n    } else {\n      pointerMax = pointerMid;\n    }\n    pointerMid = Math.floor((pointerMin + pointerMax) / 2);\n  }\n\n  // Walk forward and back on the y axis looking for the closest x,y point.\n  pointerMin = pointerMid;\n  pointerMax = pointerMid;\n  var closestConnection = null;\n  var sourceBlock = this.sourceBlock_;\n  var thisConnection = this;\n  if (db.length) {\n    while (pointerMin >= 0 && checkConnection_(pointerMin)) {\n      pointerMin--;\n    }\n    do {\n      pointerMax++;\n    } while (pointerMax < db.length && checkConnection_(pointerMax));\n  }\n\n  /**\n   * Computes if the current connection is within the allowed radius of another\n   * connection.\n   * This function is a closure and has access to outside variables.\n   * @param {number} yIndex The other connection's index in the database.\n   * @return {boolean} True if the search needs to continue: either the current\n   *     connection's vertical distance from the other connection is less than\n   *     the allowed radius, or if the connection is not compatible.\n   */\n  function checkConnection_(yIndex) {\n    var connection = db[yIndex];\n    var targetSourceBlock = connection.sourceBlock_;\n\n    // Don't offer to connect to hidden blocks\n    if (!targetSourceBlock.isVisible()) {\n      return true;\n    }\n\n    if (connection.type === Blockly.OUTPUT_VALUE ||\n        connection.type === Blockly.FUNCTIONAL_OUTPUT ||\n        connection.type === Blockly.PREVIOUS_STATEMENT) {\n      // Don't offer to connect an already connected left (male) value plug to\n      // an available right (female) value plug.  Don't offer to connect the\n      // bottom of a statement block to one that's already connected.\n      if (connection.targetConnection) {\n        return true;\n      }\n    }\n\n    // Don't offer to connect if the target is immovable\n    if (connection.targetConnection && !connection.targetBlock().isMovable()) {\n      return true;\n    }\n\n    // Don't offer to connect if the target can't disconnect from parent\n    if (connection.targetConnection &&\n        !connection.targetBlock().canDisconnectFromParent()) {\n      return true;\n    }\n\n    // Offering to connect the top of a statement block to an already connected\n    // connection is ok, we'll just insert it into the stack.\n    // Offering to connect the left (male) of a value block to an already\n    // connected value pair is ok, we'll splice it in.\n\n    // Do type checking.\n    if (!thisConnection.checkAllowedConnectionType_(connection)) {\n      return true;\n    }\n\n    // Don't let blocks try to connect to themselves or ones they nest.\n    do {\n      if (sourceBlock == targetSourceBlock) {\n        return true;\n      }\n      targetSourceBlock = targetSourceBlock.getParent();\n    } while (targetSourceBlock);\n\n    // IF connections are part of dragged group, update with dx/dy.\n    var connectionX = connection.x_;\n    var connectionY = connection.y_;\n    if (connection.sourceBlock_.getDragging()) {\n      connectionX += dx;\n      connectionY += dy;\n    }\n\n    var distX = currentX - connectionX;\n    var distY = currentY - connectionY;\n    var r = Math.sqrt(distX * distX + distY * distY);\n    if (r <= maxLimit) {\n      closestConnection = db[yIndex];\n      maxLimit = r;\n    }\n    return distY < maxLimit;\n  }\n  return {connection: closestConnection, radius: maxLimit};\n};\n\n/**\n * Is this connection compatible with another connection with respect to the\n * value type system.  E.g. square_root(\"Hello\") is not compatible.\n * @param {!Blockly.Connection} otherConnection Connection to compare against.\n * @return {boolean} True if the connections share a type.\n * @private\n */\nBlockly.Connection.prototype.checkAllowedConnectionType_ = function(otherConnection) {\n  if (!this.strictCheck() && !otherConnection.strictCheck() &&\n    (this.acceptsAnyType() || otherConnection.acceptsAnyType())) {\n    // One or both sides are promiscuous enough that anything will fit.\n    return true;\n  }\n  if ((this.strictCheck() && otherConnection.acceptsAnyType()) ||\n    (this.acceptsAnyType() && otherConnection.strictCheck())) {\n    // One side is stict but the other doesn't specify a type\n    return false;\n  }\n  // Find any intersection in the check lists.\n  for (var x = 0; x < this.check_.length; x++) {\n    if (otherConnection.acceptsType(this.check_[x])) {\n      return true;\n    }\n  }\n  // No intersection.\n  return false;\n};\n\n/**\n * Returns whether this connection strictly checks connection types\n * @returns {boolean}\n */\nBlockly.Connection.prototype.strictCheck = function() {\n  return this.strictType_;\n}\n\n/**\n * Returns whether this connection is compatible with any/every type\n * @returns {boolean}\n */\nBlockly.Connection.prototype.acceptsAnyType = function() {\n  return !this.check_ || this.acceptsType(Blockly.BlockValueType.NONE);\n};\n\n/**\n * Returns whether this connection is compatible with a given type\n * @param type\n * @returns {boolean}\n */\nBlockly.Connection.prototype.acceptsType = function(type) {\n  return !this.check_ || goog.array.contains(this.check_, type);\n};\n\n/**\n * Change a connection's compatibility, with strict enforcement.\n * @param {*} check Compatible value type or list of value types.\n * @return {!Blockly.Connection} The connection being modified\n *     (to allow chaining).\n */\nBlockly.Connection.prototype.setStrictCheck = function(check) {\n  return this.setCheck(check, true);\n}\n\n/**\n * Change a connection's compatibility.\n * @param {*} check Compatible value type or list of value types.\n *     Null if all types are compatible.\n * @param {boolean} opt_strict Set this check as strict, i.e. only accept\n *     connections of the exact same type.\n * @return {!Blockly.Connection} The connection being modified\n *     (to allow chaining).\n */\nBlockly.Connection.prototype.setCheck = function(check, opt_strict) {\n  if (check && check !== Blockly.BlockValueType.NONE) {\n    // Ensure that check is in an array.\n    if (!(check instanceof Array)) {\n      check = [check];\n    }\n\n    this.check_ = check;\n    this.strictType_ = !!opt_strict;\n    if (this.strictType_ && !this.check_) {\n      throw 'Strict connections must specify a type';\n    }\n\n    // The new value type may not be compatible with the existing connection.\n    if (this.targetConnection && !this.checkAllowedConnectionType_(this.targetConnection)) {\n      if (this.isSuperior()) {\n        this.targetBlock().setParent(null);\n      } else {\n        this.sourceBlock_.setParent(null);\n      }\n      // Bump away.\n      this.sourceBlock_.bumpNeighbours();\n    }\n\n    // If the setting an output check, and the block has no color, make the\n    // block the default color for the given output type.\n    if (this.type === Blockly.OUTPUT_VALUE && !this.sourceBlock_.getColour()) {\n      this.sourceBlock_.setHSV.apply(this.sourceBlock_, this.colorForType(check));\n    }\n  } else {\n    this.check_ = null;\n  }\n  return this;\n};\n\n/**\n * Enable the specified field helper with the specified options for this\n * connection\n * @param {string} fieldHelper the field helper to retrieve. One of\n *        Blockly.BlockFieldHelper\n * @param {*} options for this helper\n * @return {!Blockly.Connection} The connection being modified\n *     (to allow chaining).\n */\nBlockly.Connection.prototype.addFieldHelper = function (fieldHelper, options) {\n  this.fieldHelpers_[fieldHelper] = options;\n\n  return this;\n}\n\n/**\n * Retrieve the options for the specified field helper if it has been enabled\n * @param {string} fieldHelper the field helper to retrieve. One of\n *        Blockly.BlockFieldHelper\n */\nBlockly.Connection.prototype.getFieldHelperOptions = function (fieldHelper) {\n  return this.fieldHelpers_ && this.fieldHelpers_[fieldHelper];\n}\n\n/**\n * @returns {?Array.<Blockly.BlockValueType>}\n */\nBlockly.Connection.prototype.getCheck = function () {\n  return this.check_;\n};\n\n/**\n * Find all nearby compatible connections to this connection.\n * Type checking does not apply, since this function is used for bumping.\n * @param {number} maxLimit The maximum radius to another connection.\n * @return {!Array.<Blockly.Connection>} List of connections.\n * @private\n */\nBlockly.Connection.prototype.neighbours_ = function(maxLimit) {\n  // Determine the opposite type of connection.\n  var oppositeType = Blockly.OPPOSITE_TYPE[this.type];\n  var db1 = this.dbList_[this.type];\n  var db2 = this.dbList_[oppositeType];\n\n  // Construct a new connection DB, with matching and opposing connections.\n  var db = [];\n  var a = 0, b = 0, connection;\n  while (a < db1.length || b < db2.length) {\n    if (!db2[b] || (db1[a] && db1[a].y_ < db2[b].y_)) {\n      connection = db1[a];\n      if (connection !== this) {\n        db.push(connection)\n      }\n      a++;\n    } else {\n      connection = db2[b];\n      if (connection !== this) {\n        db.push(connection)\n      }\n      b++;\n    }\n  }\n\n  var currentX = this.x_;\n  var currentY = this.y_;\n\n  // Binary search to find the closest y location.\n  var pointerMin = 0;\n  var pointerMax = db.length - 2;\n  var pointerMid = pointerMax;\n  while (pointerMin < pointerMid) {\n    if (db[pointerMid].y_ < currentY) {\n      pointerMin = pointerMid;\n    } else {\n      pointerMax = pointerMid;\n    }\n    pointerMid = Math.floor((pointerMin + pointerMax) / 2);\n  }\n\n  // Walk forward and back on the y axis looking for the closest x,y point.\n  pointerMin = pointerMid;\n  pointerMax = pointerMid;\n  var neighbours = [];\n  var sourceBlock = this.sourceBlock_;\n  if (db.length) {\n    while (pointerMin >= 0 && checkConnection_(pointerMin)) {\n      pointerMin--;\n    }\n    do {\n      pointerMax++;\n    } while (pointerMax < db.length && checkConnection_(pointerMax));\n  }\n\n  /**\n   * Computes if the current connection is within the allowed radius of another\n   * connection.\n   * This function is a closure and has access to outside variables.\n   * @param {number} yIndex The other connection's index in the database.\n   * @return {boolean} True if the current connection's vertical distance from\n   *     the other connection is less than the allowed radius.\n   */\n  function checkConnection_(yIndex) {\n    var connection = db[yIndex];\n    var targetSourceBlock = connection.sourceBlock_;\n\n    // Don't include invisible blocks unless we're in edit mode\n    if (!Blockly.editBlocks && !targetSourceBlock.isVisible()) {\n      return true;\n    }\n\n    var dx = currentX - connection.x_;\n    var dy = currentY - connection.y_;\n    var r = Math.sqrt(dx * dx + dy * dy);\n    if (r <= maxLimit) {\n      neighbours.push(db[yIndex]);\n    }\n    return dy < maxLimit;\n  }\n  return neighbours;\n};\n\n/**\n * Hide this connection, as well as all down-stream connections on any block\n * attached to this connection.  This happens when a block is collapsed.\n */\nBlockly.Connection.prototype.hideAll = function() {\n  if (this.inDB_) {\n    this.dbList_[this.type].removeConnection_(this);\n  }\n  if (this.isConnected()) {\n    var blocks = this.targetBlock().getDescendants();\n    for (var b = 0; b < blocks.length; b++) {\n      var block = blocks[b];\n      // Hide all connections of all children.\n      var connections = block.getConnections_(true);\n      for (var c = 0; c < connections.length; c++) {\n        var connection = connections[c];\n        if (connection.inDB_) {\n          this.dbList_[connection.type].removeConnection_(connection);\n        }\n      }\n      // Close all bubbles of all children.\n      var icons = block.getIcons();\n      for (var x = 0; x < icons.length; x++) {\n        icons[x].setVisible(false);\n      }\n    }\n  }\n};\n\n/**\n * Unhide this connection, as well as all down-stream connections on any block\n * attached to this connection.  This happens when a block is expanded.\n * @return {!Array.<!Blockly.Block>} List of blocks to render.\n */\nBlockly.Connection.prototype.unhideAll = function() {\n  if (!this.inDB_) {\n    this.dbList_[this.type].addConnection_(this);\n  }\n  // All blocks that need unhiding must be unhidden before any rendering takes\n  // place, since rendering requires knowing the dimensions of lower blocks.\n  // Also, since rendering a block renders all its parents, we only need to\n  // render the leaf nodes.\n  var renderList = [];\n  if (this.type != Blockly.INPUT_VALUE && this.type != Blockly.NEXT_STATEMENT) {\n    // Only spider down.\n    return renderList;\n  }\n  var block = this.targetBlock();\n  if (block) {\n    var connections;\n    if (block.isCollapsed()) {\n      // This block should only be partially revealed since it is collapsed.\n      connections = [];\n      block.outputConnection && connections.push(block.outputConnection);\n      block.nextConnection && connections.push(block.nextConnection);\n      block.previousConnection && connections.push(block.previousConnection);\n    } else {\n      // Show all connections of this block.\n      connections = block.getConnections_(true);\n    }\n    for (var c = 0; c < connections.length; c++) {\n      renderList = renderList.concat(connections[c].unhideAll());\n    }\n    if (renderList.length == 0) {\n      // Leaf block.\n      renderList[0] = block;\n    }\n  }\n  return renderList;\n};\n\n/**\n * Database of connections.\n * Connections are stored in order of their vertical component.  This way\n * connections in an area may be looked up quickly using a binary search.\n * @constructor\n */\nBlockly.ConnectionDB = function() {\n};\n\nBlockly.ConnectionDB.prototype = new Array();\n/**\n * Don't inherit the constructor from Array.\n * @type {!Function}\n */\nBlockly.ConnectionDB.constructor = Blockly.ConnectionDB;\n\n/**\n * Add a connection to the database.  Must not already exist in DB.\n * @param {!Blockly.Connection} connection The connection to be added.\n * @private\n */\nBlockly.ConnectionDB.prototype.addConnection_ = function(connection) {\n  if (connection.inDB_) {\n    throw 'Connection already in database.';\n  }\n  // Insert connection using binary search.\n  var pointerMin = 0;\n  var pointerMax = this.length;\n  while (pointerMin < pointerMax) {\n    var pointerMid = Math.floor((pointerMin + pointerMax) / 2);\n    if (this[pointerMid].y_ < connection.y_) {\n      pointerMin = pointerMid + 1;\n    } else if (this[pointerMid].y_ > connection.y_) {\n      pointerMax = pointerMid;\n    } else {\n      pointerMin = pointerMid;\n      break;\n    }\n  }\n  this.splice(pointerMin, 0, connection);\n  connection.inDB_ = true;\n};\n\n/**\n * Remove a connection from the database.  Must already exist in DB.\n * @param {!Blockly.Connection} connection The connection to be removed.\n * @private\n */\nBlockly.ConnectionDB.prototype.removeConnection_ = function(connection) {\n  if (!connection.inDB_) {\n    throw 'Connection not in database.';\n  }\n  connection.inDB_ = false;\n  // Find the connection using a binary search.\n  var pointerMin = 0;\n  var pointerMax = this.length - 2;\n  var pointerMid = pointerMax;\n  while (pointerMin < pointerMid) {\n    if (this[pointerMid].y_ < connection.y_) {\n      pointerMin = pointerMid;\n    } else {\n      pointerMax = pointerMid;\n    }\n    pointerMid = Math.floor((pointerMin + pointerMax) / 2);\n  }\n\n  // Walk forward and back on the y axis looking for the connection.\n  // When found, splice it out of the array.\n  pointerMin = pointerMid;\n  pointerMax = pointerMid;\n  while (pointerMin >= 0 && this[pointerMin].y_ == connection.y_) {\n    if (this[pointerMin] == connection) {\n      this.splice(pointerMin, 1);\n      return;\n    }\n    pointerMin--;\n  }\n  do {\n    if (this[pointerMax] == connection) {\n      this.splice(pointerMax, 1);\n      return;\n    }\n    pointerMax++;\n  } while (pointerMax < this.length &&\n           this[pointerMax].y_ == connection.y_);\n  throw 'Unable to find connection in connectionDB.';\n};\n\n/**\n * Initialize a set of connection DBs for a specified blockSpace.\n * @param {!Blockly.BlockSpace} blockSpace The blockSpace this DB is for.\n */\nBlockly.ConnectionDB.init = function(blockSpace) {\n  // Create four databases, one for each connection type.\n  var dbList = [];\n  dbList[Blockly.INPUT_VALUE] = new Blockly.ConnectionDB();\n  dbList[Blockly.OUTPUT_VALUE] = new Blockly.ConnectionDB();\n  dbList[Blockly.NEXT_STATEMENT] = new Blockly.ConnectionDB();\n  dbList[Blockly.PREVIOUS_STATEMENT] = new Blockly.ConnectionDB();\n  dbList[Blockly.FUNCTIONAL_INPUT] = new Blockly.ConnectionDB();\n  dbList[Blockly.FUNCTIONAL_OUTPUT] = new Blockly.ConnectionDB();\n\n  blockSpace.connectionDBList = dbList;\n};\n","// Copyright 2010 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Browser capability checks for the dom package.\n *\n */\n\n\ngoog.provide('goog.dom.BrowserFeature');\n\ngoog.require('goog.userAgent');\n\n\n/**\n * Enum of browser capabilities.\n * @enum {boolean}\n */\ngoog.dom.BrowserFeature = {\n  /**\n   * Whether attributes 'name' and 'type' can be added to an element after it's\n   * created. False in Internet Explorer prior to version 9.\n   */\n  CAN_ADD_NAME_OR_TYPE_ATTRIBUTES:\n      !goog.userAgent.IE || goog.userAgent.isDocumentModeOrHigher(9),\n\n  /**\n   * Whether we can use element.children to access an element's Element\n   * children. Available since Gecko 1.9.1, IE 9. (IE<9 also includes comment\n   * nodes in the collection.)\n   */\n  CAN_USE_CHILDREN_ATTRIBUTE: !goog.userAgent.GECKO && !goog.userAgent.IE ||\n      goog.userAgent.IE && goog.userAgent.isDocumentModeOrHigher(9) ||\n      goog.userAgent.GECKO && goog.userAgent.isVersionOrHigher('1.9.1'),\n\n  /**\n   * Opera, Safari 3, and Internet Explorer 9 all support innerText but they\n   * include text nodes in script and style tags. Not document-mode-dependent.\n   */\n  CAN_USE_INNER_TEXT:\n      (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('9')),\n\n  /**\n   * MSIE, Opera, and Safari>=4 support element.parentElement to access an\n   * element's parent if it is an Element.\n   */\n  CAN_USE_PARENT_ELEMENT_PROPERTY:\n      goog.userAgent.IE || goog.userAgent.OPERA || goog.userAgent.WEBKIT,\n\n  /**\n   * Whether NoScope elements need a scoped element written before them in\n   * innerHTML.\n   * MSDN: http://msdn.microsoft.com/en-us/library/ms533897(VS.85).aspx#1\n   */\n  INNER_HTML_NEEDS_SCOPED_ELEMENT: goog.userAgent.IE,\n\n  /**\n   * Whether we use legacy IE range API.\n   */\n  LEGACY_IE_RANGES:\n      goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(9)\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Defines the goog.dom.TagName class. Its constants enumerate\n * all HTML tag names specified in either the the W3C HTML 4.01 index of\n * elements or the HTML5 draft specification.\n *\n * References:\n * http://www.w3.org/TR/html401/index/elements.html\n * http://dev.w3.org/html5/spec/section-index.html\n */\ngoog.provide('goog.dom.TagName');\n\n\n/**\n * A tag name with the type of the element stored in the generic.\n * @param {string} tagName\n * @constructor\n * @template T\n */\ngoog.dom.TagName = function(tagName) {\n  /** @private {string} */\n  this.tagName_ = tagName;\n};\n\n\n/**\n * Returns the tag name.\n * @return {string}\n * @override\n */\ngoog.dom.TagName.prototype.toString = function() {\n  return this.tagName_;\n};\n\n\n// Closure Compiler unconditionally converts the following constants to their\n// string value (goog.dom.TagName.A -> 'A'). These are the consequences:\n// 1. Don't add any members or static members to goog.dom.TagName as they\n//    couldn't be accessed after this optimization.\n// 2. Keep the constant name and its string value the same:\n//    goog.dom.TagName.X = new goog.dom.TagName('Y');\n//    is converted to 'X', not 'Y'.\n\n\n/** @type {!goog.dom.TagName<!HTMLAnchorElement>} */\ngoog.dom.TagName.A = new goog.dom.TagName('A');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.ABBR = new goog.dom.TagName('ABBR');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.ACRONYM = new goog.dom.TagName('ACRONYM');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.ADDRESS = new goog.dom.TagName('ADDRESS');\n\n\n/** @type {!goog.dom.TagName<!HTMLAppletElement>} */\ngoog.dom.TagName.APPLET = new goog.dom.TagName('APPLET');\n\n\n/** @type {!goog.dom.TagName<!HTMLAreaElement>} */\ngoog.dom.TagName.AREA = new goog.dom.TagName('AREA');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.ARTICLE = new goog.dom.TagName('ARTICLE');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.ASIDE = new goog.dom.TagName('ASIDE');\n\n\n/** @type {!goog.dom.TagName<!HTMLAudioElement>} */\ngoog.dom.TagName.AUDIO = new goog.dom.TagName('AUDIO');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.B = new goog.dom.TagName('B');\n\n\n/** @type {!goog.dom.TagName<!HTMLBaseElement>} */\ngoog.dom.TagName.BASE = new goog.dom.TagName('BASE');\n\n\n/** @type {!goog.dom.TagName<!HTMLBaseFontElement>} */\ngoog.dom.TagName.BASEFONT = new goog.dom.TagName('BASEFONT');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.BDI = new goog.dom.TagName('BDI');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.BDO = new goog.dom.TagName('BDO');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.BIG = new goog.dom.TagName('BIG');\n\n\n/** @type {!goog.dom.TagName<!HTMLQuoteElement>} */\ngoog.dom.TagName.BLOCKQUOTE = new goog.dom.TagName('BLOCKQUOTE');\n\n\n/** @type {!goog.dom.TagName<!HTMLBodyElement>} */\ngoog.dom.TagName.BODY = new goog.dom.TagName('BODY');\n\n\n/** @type {!goog.dom.TagName<!HTMLBRElement>} */\ngoog.dom.TagName.BR = new goog.dom.TagName('BR');\n\n\n/** @type {!goog.dom.TagName<!HTMLButtonElement>} */\ngoog.dom.TagName.BUTTON = new goog.dom.TagName('BUTTON');\n\n\n/** @type {!goog.dom.TagName<!HTMLCanvasElement>} */\ngoog.dom.TagName.CANVAS = new goog.dom.TagName('CANVAS');\n\n\n/** @type {!goog.dom.TagName<!HTMLTableCaptionElement>} */\ngoog.dom.TagName.CAPTION = new goog.dom.TagName('CAPTION');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.CENTER = new goog.dom.TagName('CENTER');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.CITE = new goog.dom.TagName('CITE');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.CODE = new goog.dom.TagName('CODE');\n\n\n/** @type {!goog.dom.TagName<!HTMLTableColElement>} */\ngoog.dom.TagName.COL = new goog.dom.TagName('COL');\n\n\n/** @type {!goog.dom.TagName<!HTMLTableColElement>} */\ngoog.dom.TagName.COLGROUP = new goog.dom.TagName('COLGROUP');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.COMMAND = new goog.dom.TagName('COMMAND');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.DATA = new goog.dom.TagName('DATA');\n\n\n/** @type {!goog.dom.TagName<!HTMLDataListElement>} */\ngoog.dom.TagName.DATALIST = new goog.dom.TagName('DATALIST');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.DD = new goog.dom.TagName('DD');\n\n\n/** @type {!goog.dom.TagName<!HTMLModElement>} */\ngoog.dom.TagName.DEL = new goog.dom.TagName('DEL');\n\n\n/** @type {!goog.dom.TagName<!HTMLDetailsElement>} */\ngoog.dom.TagName.DETAILS = new goog.dom.TagName('DETAILS');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.DFN = new goog.dom.TagName('DFN');\n\n\n/** @type {!goog.dom.TagName<!HTMLDialogElement>} */\ngoog.dom.TagName.DIALOG = new goog.dom.TagName('DIALOG');\n\n\n/** @type {!goog.dom.TagName<!HTMLDirectoryElement>} */\ngoog.dom.TagName.DIR = new goog.dom.TagName('DIR');\n\n\n/** @type {!goog.dom.TagName<!HTMLDivElement>} */\ngoog.dom.TagName.DIV = new goog.dom.TagName('DIV');\n\n\n/** @type {!goog.dom.TagName<!HTMLDListElement>} */\ngoog.dom.TagName.DL = new goog.dom.TagName('DL');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.DT = new goog.dom.TagName('DT');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.EM = new goog.dom.TagName('EM');\n\n\n/** @type {!goog.dom.TagName<!HTMLEmbedElement>} */\ngoog.dom.TagName.EMBED = new goog.dom.TagName('EMBED');\n\n\n/** @type {!goog.dom.TagName<!HTMLFieldSetElement>} */\ngoog.dom.TagName.FIELDSET = new goog.dom.TagName('FIELDSET');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.FIGCAPTION = new goog.dom.TagName('FIGCAPTION');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.FIGURE = new goog.dom.TagName('FIGURE');\n\n\n/** @type {!goog.dom.TagName<!HTMLFontElement>} */\ngoog.dom.TagName.FONT = new goog.dom.TagName('FONT');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.FOOTER = new goog.dom.TagName('FOOTER');\n\n\n/** @type {!goog.dom.TagName<!HTMLFormElement>} */\ngoog.dom.TagName.FORM = new goog.dom.TagName('FORM');\n\n\n/** @type {!goog.dom.TagName<!HTMLFrameElement>} */\ngoog.dom.TagName.FRAME = new goog.dom.TagName('FRAME');\n\n\n/** @type {!goog.dom.TagName<!HTMLFrameSetElement>} */\ngoog.dom.TagName.FRAMESET = new goog.dom.TagName('FRAMESET');\n\n\n/** @type {!goog.dom.TagName<!HTMLHeadingElement>} */\ngoog.dom.TagName.H1 = new goog.dom.TagName('H1');\n\n\n/** @type {!goog.dom.TagName<!HTMLHeadingElement>} */\ngoog.dom.TagName.H2 = new goog.dom.TagName('H2');\n\n\n/** @type {!goog.dom.TagName<!HTMLHeadingElement>} */\ngoog.dom.TagName.H3 = new goog.dom.TagName('H3');\n\n\n/** @type {!goog.dom.TagName<!HTMLHeadingElement>} */\ngoog.dom.TagName.H4 = new goog.dom.TagName('H4');\n\n\n/** @type {!goog.dom.TagName<!HTMLHeadingElement>} */\ngoog.dom.TagName.H5 = new goog.dom.TagName('H5');\n\n\n/** @type {!goog.dom.TagName<!HTMLHeadingElement>} */\ngoog.dom.TagName.H6 = new goog.dom.TagName('H6');\n\n\n/** @type {!goog.dom.TagName<!HTMLHeadElement>} */\ngoog.dom.TagName.HEAD = new goog.dom.TagName('HEAD');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.HEADER = new goog.dom.TagName('HEADER');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.HGROUP = new goog.dom.TagName('HGROUP');\n\n\n/** @type {!goog.dom.TagName<!HTMLHRElement>} */\ngoog.dom.TagName.HR = new goog.dom.TagName('HR');\n\n\n/** @type {!goog.dom.TagName<!HTMLHtmlElement>} */\ngoog.dom.TagName.HTML = new goog.dom.TagName('HTML');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.I = new goog.dom.TagName('I');\n\n\n/** @type {!goog.dom.TagName<!HTMLIFrameElement>} */\ngoog.dom.TagName.IFRAME = new goog.dom.TagName('IFRAME');\n\n\n/** @type {!goog.dom.TagName<!HTMLImageElement>} */\ngoog.dom.TagName.IMG = new goog.dom.TagName('IMG');\n\n\n/** @type {!goog.dom.TagName<!HTMLInputElement>} */\ngoog.dom.TagName.INPUT = new goog.dom.TagName('INPUT');\n\n\n/** @type {!goog.dom.TagName<!HTMLModElement>} */\ngoog.dom.TagName.INS = new goog.dom.TagName('INS');\n\n\n/** @type {!goog.dom.TagName<!HTMLIsIndexElement>} */\ngoog.dom.TagName.ISINDEX = new goog.dom.TagName('ISINDEX');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.KBD = new goog.dom.TagName('KBD');\n\n\n// HTMLKeygenElement is deprecated.\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.KEYGEN = new goog.dom.TagName('KEYGEN');\n\n\n/** @type {!goog.dom.TagName<!HTMLLabelElement>} */\ngoog.dom.TagName.LABEL = new goog.dom.TagName('LABEL');\n\n\n/** @type {!goog.dom.TagName<!HTMLLegendElement>} */\ngoog.dom.TagName.LEGEND = new goog.dom.TagName('LEGEND');\n\n\n/** @type {!goog.dom.TagName<!HTMLLIElement>} */\ngoog.dom.TagName.LI = new goog.dom.TagName('LI');\n\n\n/** @type {!goog.dom.TagName<!HTMLLinkElement>} */\ngoog.dom.TagName.LINK = new goog.dom.TagName('LINK');\n\n\n/** @type {!goog.dom.TagName<!HTMLMapElement>} */\ngoog.dom.TagName.MAP = new goog.dom.TagName('MAP');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.MARK = new goog.dom.TagName('MARK');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.MATH = new goog.dom.TagName('MATH');\n\n\n/** @type {!goog.dom.TagName<!HTMLMenuElement>} */\ngoog.dom.TagName.MENU = new goog.dom.TagName('MENU');\n\n\n/** @type {!goog.dom.TagName<!HTMLMetaElement>} */\ngoog.dom.TagName.META = new goog.dom.TagName('META');\n\n\n/** @type {!goog.dom.TagName<!HTMLMeterElement>} */\ngoog.dom.TagName.METER = new goog.dom.TagName('METER');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.NAV = new goog.dom.TagName('NAV');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.NOFRAMES = new goog.dom.TagName('NOFRAMES');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.NOSCRIPT = new goog.dom.TagName('NOSCRIPT');\n\n\n/** @type {!goog.dom.TagName<!HTMLObjectElement>} */\ngoog.dom.TagName.OBJECT = new goog.dom.TagName('OBJECT');\n\n\n/** @type {!goog.dom.TagName<!HTMLOListElement>} */\ngoog.dom.TagName.OL = new goog.dom.TagName('OL');\n\n\n/** @type {!goog.dom.TagName<!HTMLOptGroupElement>} */\ngoog.dom.TagName.OPTGROUP = new goog.dom.TagName('OPTGROUP');\n\n\n/** @type {!goog.dom.TagName<!HTMLOptionElement>} */\ngoog.dom.TagName.OPTION = new goog.dom.TagName('OPTION');\n\n\n/** @type {!goog.dom.TagName<!HTMLOutputElement>} */\ngoog.dom.TagName.OUTPUT = new goog.dom.TagName('OUTPUT');\n\n\n/** @type {!goog.dom.TagName<!HTMLParagraphElement>} */\ngoog.dom.TagName.P = new goog.dom.TagName('P');\n\n\n/** @type {!goog.dom.TagName<!HTMLParamElement>} */\ngoog.dom.TagName.PARAM = new goog.dom.TagName('PARAM');\n\n\n/** @type {!goog.dom.TagName<!HTMLPreElement>} */\ngoog.dom.TagName.PRE = new goog.dom.TagName('PRE');\n\n\n/** @type {!goog.dom.TagName<!HTMLProgressElement>} */\ngoog.dom.TagName.PROGRESS = new goog.dom.TagName('PROGRESS');\n\n\n/** @type {!goog.dom.TagName<!HTMLQuoteElement>} */\ngoog.dom.TagName.Q = new goog.dom.TagName('Q');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.RP = new goog.dom.TagName('RP');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.RT = new goog.dom.TagName('RT');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.RUBY = new goog.dom.TagName('RUBY');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.S = new goog.dom.TagName('S');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.SAMP = new goog.dom.TagName('SAMP');\n\n\n/** @type {!goog.dom.TagName<!HTMLScriptElement>} */\ngoog.dom.TagName.SCRIPT = new goog.dom.TagName('SCRIPT');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.SECTION = new goog.dom.TagName('SECTION');\n\n\n/** @type {!goog.dom.TagName<!HTMLSelectElement>} */\ngoog.dom.TagName.SELECT = new goog.dom.TagName('SELECT');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.SMALL = new goog.dom.TagName('SMALL');\n\n\n/** @type {!goog.dom.TagName<!HTMLSourceElement>} */\ngoog.dom.TagName.SOURCE = new goog.dom.TagName('SOURCE');\n\n\n/** @type {!goog.dom.TagName<!HTMLSpanElement>} */\ngoog.dom.TagName.SPAN = new goog.dom.TagName('SPAN');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.STRIKE = new goog.dom.TagName('STRIKE');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.STRONG = new goog.dom.TagName('STRONG');\n\n\n/** @type {!goog.dom.TagName<!HTMLStyleElement>} */\ngoog.dom.TagName.STYLE = new goog.dom.TagName('STYLE');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.SUB = new goog.dom.TagName('SUB');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.SUMMARY = new goog.dom.TagName('SUMMARY');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.SUP = new goog.dom.TagName('SUP');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.SVG = new goog.dom.TagName('SVG');\n\n\n/** @type {!goog.dom.TagName<!HTMLTableElement>} */\ngoog.dom.TagName.TABLE = new goog.dom.TagName('TABLE');\n\n\n/** @type {!goog.dom.TagName<!HTMLTableSectionElement>} */\ngoog.dom.TagName.TBODY = new goog.dom.TagName('TBODY');\n\n\n/** @type {!goog.dom.TagName<!HTMLTableCellElement>} */\ngoog.dom.TagName.TD = new goog.dom.TagName('TD');\n\n\n/** @type {!goog.dom.TagName<!HTMLTemplateElement>} */\ngoog.dom.TagName.TEMPLATE = new goog.dom.TagName('TEMPLATE');\n\n\n/** @type {!goog.dom.TagName<!HTMLTextAreaElement>} */\ngoog.dom.TagName.TEXTAREA = new goog.dom.TagName('TEXTAREA');\n\n\n/** @type {!goog.dom.TagName<!HTMLTableSectionElement>} */\ngoog.dom.TagName.TFOOT = new goog.dom.TagName('TFOOT');\n\n\n/** @type {!goog.dom.TagName<!HTMLTableCellElement>} */\ngoog.dom.TagName.TH = new goog.dom.TagName('TH');\n\n\n/** @type {!goog.dom.TagName<!HTMLTableSectionElement>} */\ngoog.dom.TagName.THEAD = new goog.dom.TagName('THEAD');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.TIME = new goog.dom.TagName('TIME');\n\n\n/** @type {!goog.dom.TagName<!HTMLTitleElement>} */\ngoog.dom.TagName.TITLE = new goog.dom.TagName('TITLE');\n\n\n/** @type {!goog.dom.TagName<!HTMLTableRowElement>} */\ngoog.dom.TagName.TR = new goog.dom.TagName('TR');\n\n\n/** @type {!goog.dom.TagName<!HTMLTrackElement>} */\ngoog.dom.TagName.TRACK = new goog.dom.TagName('TRACK');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.TT = new goog.dom.TagName('TT');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.U = new goog.dom.TagName('U');\n\n\n/** @type {!goog.dom.TagName<!HTMLUListElement>} */\ngoog.dom.TagName.UL = new goog.dom.TagName('UL');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.VAR = new goog.dom.TagName('VAR');\n\n\n/** @type {!goog.dom.TagName<!HTMLVideoElement>} */\ngoog.dom.TagName.VIDEO = new goog.dom.TagName('VIDEO');\n\n\n/** @type {!goog.dom.TagName<!HTMLElement>} */\ngoog.dom.TagName.WBR = new goog.dom.TagName('WBR');\n","// Copyright 2014 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for HTML element tag names.\n */\ngoog.provide('goog.dom.tags');\n\ngoog.require('goog.object');\n\n\n/**\n * The void elements specified by\n * http://www.w3.org/TR/html-markup/syntax.html#void-elements.\n * @const @private {!Object<string, boolean>}\n */\ngoog.dom.tags.VOID_TAGS_ = goog.object.createSet(\n    'area', 'base', 'br', 'col', 'command', 'embed', 'hr', 'img', 'input',\n    'keygen', 'link', 'meta', 'param', 'source', 'track', 'wbr');\n\n\n/**\n * Checks whether the tag is void (with no contents allowed and no legal end\n * tag), for example 'br'.\n * @param {string} tagName The tag name in lower case.\n * @return {boolean}\n */\ngoog.dom.tags.isVoidTag = function(tagName) {\n  return goog.dom.tags.VOID_TAGS_[tagName] === true;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\ngoog.provide('goog.string.TypedString');\n\n\n\n/**\n * Wrapper for strings that conform to a data type or language.\n *\n * Implementations of this interface are wrappers for strings, and typically\n * associate a type contract with the wrapped string.  Concrete implementations\n * of this interface may choose to implement additional run-time type checking,\n * see for example {@code goog.html.SafeHtml}. If available, client code that\n * needs to ensure type membership of an object should use the type's function\n * to assert type membership, such as {@code goog.html.SafeHtml.unwrap}.\n * @interface\n */\ngoog.string.TypedString = function() {};\n\n\n/**\n * Interface marker of the TypedString interface.\n *\n * This property can be used to determine at runtime whether or not an object\n * implements this interface.  All implementations of this interface set this\n * property to {@code true}.\n * @type {boolean}\n */\ngoog.string.TypedString.prototype.implementsGoogStringTypedString;\n\n\n/**\n * Retrieves this wrapped string's value.\n * @return {string} The wrapped string's value.\n */\ngoog.string.TypedString.prototype.getTypedStringValue;\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\ngoog.provide('goog.string.Const');\n\ngoog.require('goog.asserts');\ngoog.require('goog.string.TypedString');\n\n\n\n/**\n * Wrapper for compile-time-constant strings.\n *\n * Const is a wrapper for strings that can only be created from program\n * constants (i.e., string literals).  This property relies on a custom Closure\n * compiler check that {@code goog.string.Const.from} is only invoked on\n * compile-time-constant expressions.\n *\n * Const is useful in APIs whose correct and secure use requires that certain\n * arguments are not attacker controlled: Compile-time constants are inherently\n * under the control of the application and not under control of external\n * attackers, and hence are safe to use in such contexts.\n *\n * Instances of this type must be created via its factory method\n * {@code goog.string.Const.from} and not by invoking its constructor.  The\n * constructor intentionally takes no parameters and the type is immutable;\n * hence only a default instance corresponding to the empty string can be\n * obtained via constructor invocation.\n *\n * @see goog.string.Const#from\n * @constructor\n * @final\n * @struct\n * @implements {goog.string.TypedString}\n */\ngoog.string.Const = function() {\n  /**\n   * The wrapped value of this Const object.  The field has a purposely ugly\n   * name to make (non-compiled) code that attempts to directly access this\n   * field stand out.\n   * @private {string}\n   */\n  this.stringConstValueWithSecurityContract__googStringSecurityPrivate_ = '';\n\n  /**\n   * A type marker used to implement additional run-time type checking.\n   * @see goog.string.Const#unwrap\n   * @const {!Object}\n   * @private\n   */\n  this.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_ =\n      goog.string.Const.TYPE_MARKER_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.string.Const.prototype.implementsGoogStringTypedString = true;\n\n\n/**\n * Returns this Const's value a string.\n *\n * IMPORTANT: In code where it is security-relevant that an object's type is\n * indeed {@code goog.string.Const}, use {@code goog.string.Const.unwrap}\n * instead of this method.\n *\n * @see goog.string.Const#unwrap\n * @override\n */\ngoog.string.Const.prototype.getTypedStringValue = function() {\n  return this.stringConstValueWithSecurityContract__googStringSecurityPrivate_;\n};\n\n\n/**\n * Returns a debug-string representation of this value.\n *\n * To obtain the actual string value wrapped inside an object of this type,\n * use {@code goog.string.Const.unwrap}.\n *\n * @see goog.string.Const#unwrap\n * @override\n */\ngoog.string.Const.prototype.toString = function() {\n  return 'Const{' +\n      this.stringConstValueWithSecurityContract__googStringSecurityPrivate_ +\n      '}';\n};\n\n\n/**\n * Performs a runtime check that the provided object is indeed an instance\n * of {@code goog.string.Const}, and returns its value.\n * @param {!goog.string.Const} stringConst The object to extract from.\n * @return {string} The Const object's contained string, unless the run-time\n *     type check fails. In that case, {@code unwrap} returns an innocuous\n *     string, or, if assertions are enabled, throws\n *     {@code goog.asserts.AssertionError}.\n */\ngoog.string.Const.unwrap = function(stringConst) {\n  // Perform additional run-time type-checking to ensure that stringConst is\n  // indeed an instance of the expected type.  This provides some additional\n  // protection against security bugs due to application code that disables type\n  // checks.\n  if (stringConst instanceof goog.string.Const &&\n      stringConst.constructor === goog.string.Const &&\n      stringConst.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_ ===\n          goog.string.Const.TYPE_MARKER_) {\n    return stringConst\n        .stringConstValueWithSecurityContract__googStringSecurityPrivate_;\n  } else {\n    goog.asserts.fail(\n        'expected object of type Const, got \\'' + stringConst + '\\'');\n    return 'type_error:Const';\n  }\n};\n\n\n/**\n * Creates a Const object from a compile-time constant string.\n *\n * It is illegal to invoke this function on an expression whose\n * compile-time-contant value cannot be determined by the Closure compiler.\n *\n * Correct invocations include,\n * <pre>\n *   var s = goog.string.Const.from('hello');\n *   var t = goog.string.Const.from('hello' + 'world');\n * </pre>\n *\n * In contrast, the following are illegal:\n * <pre>\n *   var s = goog.string.Const.from(getHello());\n *   var t = goog.string.Const.from('hello' + world);\n * </pre>\n *\n * @param {string} s A constant string from which to create a Const.\n * @return {!goog.string.Const} A Const object initialized to stringConst.\n */\ngoog.string.Const.from = function(s) {\n  return goog.string.Const.create__googStringSecurityPrivate_(s);\n};\n\n\n/**\n * Type marker for the Const type, used to implement additional run-time\n * type checking.\n * @const {!Object}\n * @private\n */\ngoog.string.Const.TYPE_MARKER_ = {};\n\n\n/**\n * Utility method to create Const instances.\n * @param {string} s The string to initialize the Const object with.\n * @return {!goog.string.Const} The initialized Const object.\n * @private\n */\ngoog.string.Const.create__googStringSecurityPrivate_ = function(s) {\n  var stringConst = new goog.string.Const();\n  stringConst.stringConstValueWithSecurityContract__googStringSecurityPrivate_ =\n      s;\n  return stringConst;\n};\n\n\n/**\n * A Const instance wrapping the empty string.\n * @const {!goog.string.Const}\n */\ngoog.string.Const.EMPTY = goog.string.Const.from('');\n","// Copyright 2014 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview The SafeScript type and its builders.\n *\n * TODO(xtof): Link to document stating type contract.\n */\n\ngoog.provide('goog.html.SafeScript');\n\ngoog.require('goog.asserts');\ngoog.require('goog.string.Const');\ngoog.require('goog.string.TypedString');\n\n\n\n/**\n * A string-like object which represents JavaScript code and that carries the\n * security type contract that its value, as a string, will not cause execution\n * of unconstrained attacker controlled code (XSS) when evaluated as JavaScript\n * in a browser.\n *\n * Instances of this type must be created via the factory method\n * {@code goog.html.SafeScript.fromConstant} and not by invoking its\n * constructor. The constructor intentionally takes no parameters and the type\n * is immutable; hence only a default instance corresponding to the empty string\n * can be obtained via constructor invocation.\n *\n * A SafeScript's string representation can safely be interpolated as the\n * content of a script element within HTML. The SafeScript string should not be\n * escaped before interpolation.\n *\n * Note that the SafeScript might contain text that is attacker-controlled but\n * that text should have been interpolated with appropriate escaping,\n * sanitization and/or validation into the right location in the script, such\n * that it is highly constrained in its effect (for example, it had to match a\n * set of whitelisted words).\n *\n * A SafeScript can be constructed via security-reviewed unchecked\n * conversions. In this case producers of SafeScript must ensure themselves that\n * the SafeScript does not contain unsafe script. Note in particular that\n * {@code &lt;} is dangerous, even when inside JavaScript strings, and so should\n * always be forbidden or JavaScript escaped in user controlled input. For\n * example, if {@code &lt;/script&gt;&lt;script&gt;evil&lt;/script&gt;\"} were\n * interpolated inside a JavaScript string, it would break out of the context\n * of the original script element and {@code evil} would execute. Also note\n * that within an HTML script (raw text) element, HTML character references,\n * such as \"&lt;\" are not allowed. See\n * http://www.w3.org/TR/html5/scripting-1.html#restrictions-for-contents-of-script-elements.\n *\n * @see goog.html.SafeScript#fromConstant\n * @constructor\n * @final\n * @struct\n * @implements {goog.string.TypedString}\n */\ngoog.html.SafeScript = function() {\n  /**\n   * The contained value of this SafeScript.  The field has a purposely\n   * ugly name to make (non-compiled) code that attempts to directly access this\n   * field stand out.\n   * @private {string}\n   */\n  this.privateDoNotAccessOrElseSafeScriptWrappedValue_ = '';\n\n  /**\n   * A type marker used to implement additional run-time type checking.\n   * @see goog.html.SafeScript#unwrap\n   * @const {!Object}\n   * @private\n   */\n  this.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ =\n      goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.SafeScript.prototype.implementsGoogStringTypedString = true;\n\n\n/**\n * Type marker for the SafeScript type, used to implement additional\n * run-time type checking.\n * @const {!Object}\n * @private\n */\ngoog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ = {};\n\n\n/**\n * Creates a SafeScript object from a compile-time constant string.\n *\n * @param {!goog.string.Const} script A compile-time-constant string from which\n *     to create a SafeScript.\n * @return {!goog.html.SafeScript} A SafeScript object initialized to\n *     {@code script}.\n */\ngoog.html.SafeScript.fromConstant = function(script) {\n  var scriptString = goog.string.Const.unwrap(script);\n  if (scriptString.length === 0) {\n    return goog.html.SafeScript.EMPTY;\n  }\n  return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(\n      scriptString);\n};\n\n\n/**\n * Returns this SafeScript's value as a string.\n *\n * IMPORTANT: In code where it is security relevant that an object's type is\n * indeed {@code SafeScript}, use {@code goog.html.SafeScript.unwrap} instead of\n * this method. If in doubt, assume that it's security relevant. In particular,\n * note that goog.html functions which return a goog.html type do not guarantee\n * the returned instance is of the right type. For example:\n *\n * <pre>\n * var fakeSafeHtml = new String('fake');\n * fakeSafeHtml.__proto__ = goog.html.SafeHtml.prototype;\n * var newSafeHtml = goog.html.SafeHtml.htmlEscape(fakeSafeHtml);\n * // newSafeHtml is just an alias for fakeSafeHtml, it's passed through by\n * // goog.html.SafeHtml.htmlEscape() as fakeSafeHtml\n * // instanceof goog.html.SafeHtml.\n * </pre>\n *\n * @see goog.html.SafeScript#unwrap\n * @override\n */\ngoog.html.SafeScript.prototype.getTypedStringValue = function() {\n  return this.privateDoNotAccessOrElseSafeScriptWrappedValue_;\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a debug string-representation of this value.\n   *\n   * To obtain the actual string value wrapped in a SafeScript, use\n   * {@code goog.html.SafeScript.unwrap}.\n   *\n   * @see goog.html.SafeScript#unwrap\n   * @override\n   */\n  goog.html.SafeScript.prototype.toString = function() {\n    return 'SafeScript{' +\n        this.privateDoNotAccessOrElseSafeScriptWrappedValue_ + '}';\n  };\n}\n\n\n/**\n * Performs a runtime check that the provided object is indeed a\n * SafeScript object, and returns its value.\n *\n * @param {!goog.html.SafeScript} safeScript The object to extract from.\n * @return {string} The safeScript object's contained string, unless\n *     the run-time type check fails. In that case, {@code unwrap} returns an\n *     innocuous string, or, if assertions are enabled, throws\n *     {@code goog.asserts.AssertionError}.\n */\ngoog.html.SafeScript.unwrap = function(safeScript) {\n  // Perform additional Run-time type-checking to ensure that\n  // safeScript is indeed an instance of the expected type.  This\n  // provides some additional protection against security bugs due to\n  // application code that disables type checks.\n  // Specifically, the following checks are performed:\n  // 1. The object is an instance of the expected type.\n  // 2. The object is not an instance of a subclass.\n  // 3. The object carries a type marker for the expected type. \"Faking\" an\n  // object requires a reference to the type marker, which has names intended\n  // to stand out in code reviews.\n  if (safeScript instanceof goog.html.SafeScript &&\n      safeScript.constructor === goog.html.SafeScript &&\n      safeScript.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ ===\n          goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_) {\n    return safeScript.privateDoNotAccessOrElseSafeScriptWrappedValue_;\n  } else {\n    goog.asserts.fail('expected object of type SafeScript, got \\'' +\n        safeScript + '\\' of type ' + goog.typeOf(safeScript));\n    return 'type_error:SafeScript';\n  }\n};\n\n\n/**\n * Package-internal utility method to create SafeScript instances.\n *\n * @param {string} script The string to initialize the SafeScript object with.\n * @return {!goog.html.SafeScript} The initialized SafeScript object.\n * @package\n */\ngoog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse =\n    function(script) {\n  return new goog.html.SafeScript().initSecurityPrivateDoNotAccessOrElse_(\n      script);\n};\n\n\n/**\n * Called from createSafeScriptSecurityPrivateDoNotAccessOrElse(). This\n * method exists only so that the compiler can dead code eliminate static\n * fields (like EMPTY) when they're not accessed.\n * @param {string} script\n * @return {!goog.html.SafeScript}\n * @private\n */\ngoog.html.SafeScript.prototype.initSecurityPrivateDoNotAccessOrElse_ = function(\n    script) {\n  this.privateDoNotAccessOrElseSafeScriptWrappedValue_ = script;\n  return this;\n};\n\n\n/**\n * A SafeScript instance corresponding to the empty string.\n * @const {!goog.html.SafeScript}\n */\ngoog.html.SafeScript.EMPTY =\n    goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse('');\n","// Copyright 2014 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview The SafeStyle type and its builders.\n *\n * TODO(xtof): Link to document stating type contract.\n */\n\ngoog.provide('goog.html.SafeStyle');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.string');\ngoog.require('goog.string.Const');\ngoog.require('goog.string.TypedString');\n\n\n\n/**\n * A string-like object which represents a sequence of CSS declarations\n * ({@code propertyName1: propertyvalue1; propertyName2: propertyValue2; ...})\n * and that carries the security type contract that its value, as a string,\n * will not cause untrusted script execution (XSS) when evaluated as CSS in a\n * browser.\n *\n * Instances of this type must be created via the factory methods\n * ({@code goog.html.SafeStyle.create} or\n * {@code goog.html.SafeStyle.fromConstant}) and not by invoking its\n * constructor. The constructor intentionally takes no parameters and the type\n * is immutable; hence only a default instance corresponding to the empty string\n * can be obtained via constructor invocation.\n *\n * A SafeStyle's string representation ({@link #getTypedStringValue()}) can\n * safely:\n * <ul>\n *   <li>Be interpolated as the entire content of a *quoted* HTML style\n *       attribute, or before already existing properties. The SafeStyle string\n *       *must be HTML-attribute-escaped* (where \" and ' are escaped) before\n *       interpolation.\n *   <li>Be interpolated as the entire content of a {}-wrapped block within a\n *       stylesheet, or before already existing properties. The SafeStyle string\n *       should not be escaped before interpolation. SafeStyle's contract also\n *       guarantees that the string will not be able to introduce new properties\n *       or elide existing ones.\n *   <li>Be assigned to the style property of a DOM node. The SafeStyle string\n *       should not be escaped before being assigned to the property.\n * </ul>\n *\n * A SafeStyle may never contain literal angle brackets. Otherwise, it could\n * be unsafe to place a SafeStyle into a &lt;style&gt; tag (where it can't\n * be HTML escaped). For example, if the SafeStyle containing\n * \"{@code font: 'foo &lt;style/&gt;&lt;script&gt;evil&lt;/script&gt;'}\" were\n * interpolated within a &lt;style&gt; tag, this would then break out of the\n * style context into HTML.\n *\n * A SafeStyle may contain literal single or double quotes, and as such the\n * entire style string must be escaped when used in a style attribute (if\n * this were not the case, the string could contain a matching quote that\n * would escape from the style attribute).\n *\n * Values of this type must be composable, i.e. for any two values\n * {@code style1} and {@code style2} of this type,\n * {@code goog.html.SafeStyle.unwrap(style1) +\n * goog.html.SafeStyle.unwrap(style2)} must itself be a value that satisfies\n * the SafeStyle type constraint. This requirement implies that for any value\n * {@code style} of this type, {@code goog.html.SafeStyle.unwrap(style)} must\n * not end in a \"property value\" or \"property name\" context. For example,\n * a value of {@code background:url(\"} or {@code font-} would not satisfy the\n * SafeStyle contract. This is because concatenating such strings with a\n * second value that itself does not contain unsafe CSS can result in an\n * overall string that does. For example, if {@code javascript:evil())\"} is\n * appended to {@code background:url(\"}, the resulting string may result in\n * the execution of a malicious script.\n *\n * TODO(mlourenco): Consider whether we should implement UTF-8 interchange\n * validity checks and blacklisting of newlines (including Unicode ones) and\n * other whitespace characters (\\t, \\f). Document here if so and also update\n * SafeStyle.fromConstant().\n *\n * The following example values comply with this type's contract:\n * <ul>\n *   <li><pre>width: 1em;</pre>\n *   <li><pre>height:1em;</pre>\n *   <li><pre>width: 1em;height: 1em;</pre>\n *   <li><pre>background:url('http://url');</pre>\n * </ul>\n * In addition, the empty string is safe for use in a CSS attribute.\n *\n * The following example values do NOT comply with this type's contract:\n * <ul>\n *   <li><pre>background: red</pre> (missing a trailing semi-colon)\n *   <li><pre>background:</pre> (missing a value and a trailing semi-colon)\n *   <li><pre>1em</pre> (missing an attribute name, which provides context for\n *       the value)\n * </ul>\n *\n * @see goog.html.SafeStyle#create\n * @see goog.html.SafeStyle#fromConstant\n * @see http://www.w3.org/TR/css3-syntax/\n * @constructor\n * @final\n * @struct\n * @implements {goog.string.TypedString}\n */\ngoog.html.SafeStyle = function() {\n  /**\n   * The contained value of this SafeStyle.  The field has a purposely\n   * ugly name to make (non-compiled) code that attempts to directly access this\n   * field stand out.\n   * @private {string}\n   */\n  this.privateDoNotAccessOrElseSafeStyleWrappedValue_ = '';\n\n  /**\n   * A type marker used to implement additional run-time type checking.\n   * @see goog.html.SafeStyle#unwrap\n   * @const {!Object}\n   * @private\n   */\n  this.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ =\n      goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.SafeStyle.prototype.implementsGoogStringTypedString = true;\n\n\n/**\n * Type marker for the SafeStyle type, used to implement additional\n * run-time type checking.\n * @const {!Object}\n * @private\n */\ngoog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ = {};\n\n\n/**\n * Creates a SafeStyle object from a compile-time constant string.\n *\n * {@code style} should be in the format\n * {@code name: value; [name: value; ...]} and must not have any < or >\n * characters in it. This is so that SafeStyle's contract is preserved,\n * allowing the SafeStyle to correctly be interpreted as a sequence of CSS\n * declarations and without affecting the syntactic structure of any\n * surrounding CSS and HTML.\n *\n * This method performs basic sanity checks on the format of {@code style}\n * but does not constrain the format of {@code name} and {@code value}, except\n * for disallowing tag characters.\n *\n * @param {!goog.string.Const} style A compile-time-constant string from which\n *     to create a SafeStyle.\n * @return {!goog.html.SafeStyle} A SafeStyle object initialized to\n *     {@code style}.\n */\ngoog.html.SafeStyle.fromConstant = function(style) {\n  var styleString = goog.string.Const.unwrap(style);\n  if (styleString.length === 0) {\n    return goog.html.SafeStyle.EMPTY;\n  }\n  goog.html.SafeStyle.checkStyle_(styleString);\n  goog.asserts.assert(\n      goog.string.endsWith(styleString, ';'),\n      'Last character of style string is not \\';\\': ' + styleString);\n  goog.asserts.assert(\n      goog.string.contains(styleString, ':'),\n      'Style string must contain at least one \\':\\', to ' +\n          'specify a \"name: value\" pair: ' + styleString);\n  return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(\n      styleString);\n};\n\n\n/**\n * Checks if the style definition is valid.\n * @param {string} style\n * @private\n */\ngoog.html.SafeStyle.checkStyle_ = function(style) {\n  goog.asserts.assert(\n      !/[<>]/.test(style), 'Forbidden characters in style string: ' + style);\n};\n\n\n/**\n * Returns this SafeStyle's value as a string.\n *\n * IMPORTANT: In code where it is security relevant that an object's type is\n * indeed {@code SafeStyle}, use {@code goog.html.SafeStyle.unwrap} instead of\n * this method. If in doubt, assume that it's security relevant. In particular,\n * note that goog.html functions which return a goog.html type do not guarantee\n * the returned instance is of the right type. For example:\n *\n * <pre>\n * var fakeSafeHtml = new String('fake');\n * fakeSafeHtml.__proto__ = goog.html.SafeHtml.prototype;\n * var newSafeHtml = goog.html.SafeHtml.htmlEscape(fakeSafeHtml);\n * // newSafeHtml is just an alias for fakeSafeHtml, it's passed through by\n * // goog.html.SafeHtml.htmlEscape() as fakeSafeHtml\n * // instanceof goog.html.SafeHtml.\n * </pre>\n *\n * @see goog.html.SafeStyle#unwrap\n * @override\n */\ngoog.html.SafeStyle.prototype.getTypedStringValue = function() {\n  return this.privateDoNotAccessOrElseSafeStyleWrappedValue_;\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a debug string-representation of this value.\n   *\n   * To obtain the actual string value wrapped in a SafeStyle, use\n   * {@code goog.html.SafeStyle.unwrap}.\n   *\n   * @see goog.html.SafeStyle#unwrap\n   * @override\n   */\n  goog.html.SafeStyle.prototype.toString = function() {\n    return 'SafeStyle{' + this.privateDoNotAccessOrElseSafeStyleWrappedValue_ +\n        '}';\n  };\n}\n\n\n/**\n * Performs a runtime check that the provided object is indeed a\n * SafeStyle object, and returns its value.\n *\n * @param {!goog.html.SafeStyle} safeStyle The object to extract from.\n * @return {string} The safeStyle object's contained string, unless\n *     the run-time type check fails. In that case, {@code unwrap} returns an\n *     innocuous string, or, if assertions are enabled, throws\n *     {@code goog.asserts.AssertionError}.\n */\ngoog.html.SafeStyle.unwrap = function(safeStyle) {\n  // Perform additional Run-time type-checking to ensure that\n  // safeStyle is indeed an instance of the expected type.  This\n  // provides some additional protection against security bugs due to\n  // application code that disables type checks.\n  // Specifically, the following checks are performed:\n  // 1. The object is an instance of the expected type.\n  // 2. The object is not an instance of a subclass.\n  // 3. The object carries a type marker for the expected type. \"Faking\" an\n  // object requires a reference to the type marker, which has names intended\n  // to stand out in code reviews.\n  if (safeStyle instanceof goog.html.SafeStyle &&\n      safeStyle.constructor === goog.html.SafeStyle &&\n      safeStyle.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ ===\n          goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_) {\n    return safeStyle.privateDoNotAccessOrElseSafeStyleWrappedValue_;\n  } else {\n    goog.asserts.fail('expected object of type SafeStyle, got \\'' +\n        safeStyle + '\\' of type ' + goog.typeOf(safeStyle));\n    return 'type_error:SafeStyle';\n  }\n};\n\n\n/**\n * Package-internal utility method to create SafeStyle instances.\n *\n * @param {string} style The string to initialize the SafeStyle object with.\n * @return {!goog.html.SafeStyle} The initialized SafeStyle object.\n * @package\n */\ngoog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse = function(\n    style) {\n  return new goog.html.SafeStyle().initSecurityPrivateDoNotAccessOrElse_(style);\n};\n\n\n/**\n * Called from createSafeStyleSecurityPrivateDoNotAccessOrElse(). This\n * method exists only so that the compiler can dead code eliminate static\n * fields (like EMPTY) when they're not accessed.\n * @param {string} style\n * @return {!goog.html.SafeStyle}\n * @private\n */\ngoog.html.SafeStyle.prototype.initSecurityPrivateDoNotAccessOrElse_ = function(\n    style) {\n  this.privateDoNotAccessOrElseSafeStyleWrappedValue_ = style;\n  return this;\n};\n\n\n/**\n * A SafeStyle instance corresponding to the empty string.\n * @const {!goog.html.SafeStyle}\n */\ngoog.html.SafeStyle.EMPTY =\n    goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse('');\n\n\n/**\n * The innocuous string generated by goog.html.SafeUrl.create when passed\n * an unsafe value.\n * @const {string}\n */\ngoog.html.SafeStyle.INNOCUOUS_STRING = 'zClosurez';\n\n\n/**\n * Mapping of property names to their values.\n * @typedef {!Object<string, goog.string.Const|string>}\n */\ngoog.html.SafeStyle.PropertyMap;\n\n\n/**\n * Creates a new SafeStyle object from the properties specified in the map.\n * @param {goog.html.SafeStyle.PropertyMap} map Mapping of property names to\n *     their values, for example {'margin': '1px'}. Names must consist of\n *     [-_a-zA-Z0-9]. Values might be strings consisting of\n *     [-,.'\"%_!# a-zA-Z0-9], where \" and ' must be properly balanced.\n *     Other values must be wrapped in goog.string.Const. Null value causes\n *     skipping the property.\n * @return {!goog.html.SafeStyle}\n * @throws {Error} If invalid name is provided.\n * @throws {goog.asserts.AssertionError} If invalid value is provided. With\n *     disabled assertions, invalid value is replaced by\n *     goog.html.SafeStyle.INNOCUOUS_STRING.\n */\ngoog.html.SafeStyle.create = function(map) {\n  var style = '';\n  for (var name in map) {\n    if (!/^[-_a-zA-Z0-9]+$/.test(name)) {\n      throw Error('Name allows only [-_a-zA-Z0-9], got: ' + name);\n    }\n    var value = map[name];\n    if (value == null) {\n      continue;\n    }\n    if (value instanceof goog.string.Const) {\n      value = goog.string.Const.unwrap(value);\n      // These characters can be used to change context and we don't want that\n      // even with const values.\n      goog.asserts.assert(!/[{;}]/.test(value), 'Value does not allow [{;}].');\n    } else if (!goog.html.SafeStyle.VALUE_RE_.test(value)) {\n      goog.asserts.fail(\n          'String value allows only [-,.\"\\'%_!# a-zA-Z0-9], rgb() and ' +\n          'rgba(), got: ' + value);\n      value = goog.html.SafeStyle.INNOCUOUS_STRING;\n    } else if (!goog.html.SafeStyle.hasBalancedQuotes_(value)) {\n      goog.asserts.fail('String value requires balanced quotes, got: ' + value);\n      value = goog.html.SafeStyle.INNOCUOUS_STRING;\n    }\n    style += name + ':' + value + ';';\n  }\n  if (!style) {\n    return goog.html.SafeStyle.EMPTY;\n  }\n  goog.html.SafeStyle.checkStyle_(style);\n  return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(\n      style);\n};\n\n\n/**\n * Checks that quotes (\" and ') are properly balanced inside a string. Assumes\n * that neither escape (\\) nor any other character that could result in\n * breaking out of a string parsing context are allowed;\n * see http://www.w3.org/TR/css3-syntax/#string-token-diagram.\n * @param {string} value Untrusted CSS property value.\n * @return {boolean} True if property value is safe with respect to quote\n *     balancedness.\n * @private\n */\ngoog.html.SafeStyle.hasBalancedQuotes_ = function(value) {\n  var outsideSingle = true;\n  var outsideDouble = true;\n  for (var i = 0; i < value.length; i++) {\n    var c = value.charAt(i);\n    if (c == \"'\" && outsideDouble) {\n      outsideSingle = !outsideSingle;\n    } else if (c == '\"' && outsideSingle) {\n      outsideDouble = !outsideDouble;\n    }\n  }\n  return outsideSingle && outsideDouble;\n};\n\n\n// Keep in sync with the error string in create().\n/**\n * Regular expression for safe values.\n *\n * Quotes (\" and ') are allowed, but a check must be done elsewhere to ensure\n * they're balanced.\n *\n * ',' allows multiple values to be assigned to the same property\n * (e.g. background-attachment or font-family) and hence could allow\n * multiple values to get injected, but that should pose no risk of XSS.\n *\n * The rgb() and rgba() expression checks only for XSS safety, not for CSS\n * validity.\n * @const {!RegExp}\n * @private\n */\ngoog.html.SafeStyle.VALUE_RE_ =\n    /^([-,.\"'%_!# a-zA-Z0-9]+|(?:rgb|hsl)a?\\([0-9.%, ]+\\))$/;\n\n\n/**\n * Creates a new SafeStyle object by concatenating the values.\n * @param {...(!goog.html.SafeStyle|!Array<!goog.html.SafeStyle>)} var_args\n *     SafeStyles to concatenate.\n * @return {!goog.html.SafeStyle}\n */\ngoog.html.SafeStyle.concat = function(var_args) {\n  var style = '';\n\n  /**\n   * @param {!goog.html.SafeStyle|!Array<!goog.html.SafeStyle>} argument\n   */\n  var addArgument = function(argument) {\n    if (goog.isArray(argument)) {\n      goog.array.forEach(argument, addArgument);\n    } else {\n      style += goog.html.SafeStyle.unwrap(argument);\n    }\n  };\n\n  goog.array.forEach(arguments, addArgument);\n  if (!style) {\n    return goog.html.SafeStyle.EMPTY;\n  }\n  return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(\n      style);\n};\n","// Copyright 2014 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview The SafeStyleSheet type and its builders.\n *\n * TODO(xtof): Link to document stating type contract.\n */\n\ngoog.provide('goog.html.SafeStyleSheet');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.string');\ngoog.require('goog.string.Const');\ngoog.require('goog.string.TypedString');\n\n\n\n/**\n * A string-like object which represents a CSS style sheet and that carries the\n * security type contract that its value, as a string, will not cause untrusted\n * script execution (XSS) when evaluated as CSS in a browser.\n *\n * Instances of this type must be created via the factory method\n * {@code goog.html.SafeStyleSheet.fromConstant} and not by invoking its\n * constructor. The constructor intentionally takes no parameters and the type\n * is immutable; hence only a default instance corresponding to the empty string\n * can be obtained via constructor invocation.\n *\n * A SafeStyleSheet's string representation can safely be interpolated as the\n * content of a style element within HTML. The SafeStyleSheet string should\n * not be escaped before interpolation.\n *\n * Values of this type must be composable, i.e. for any two values\n * {@code styleSheet1} and {@code styleSheet2} of this type,\n * {@code goog.html.SafeStyleSheet.unwrap(styleSheet1) +\n * goog.html.SafeStyleSheet.unwrap(styleSheet2)} must itself be a value that\n * satisfies the SafeStyleSheet type constraint. This requirement implies that\n * for any value {@code styleSheet} of this type,\n * {@code goog.html.SafeStyleSheet.unwrap(styleSheet1)} must end in\n * \"beginning of rule\" context.\n\n * A SafeStyleSheet can be constructed via security-reviewed unchecked\n * conversions. In this case producers of SafeStyleSheet must ensure themselves\n * that the SafeStyleSheet does not contain unsafe script. Note in particular\n * that {@code &lt;} is dangerous, even when inside CSS strings, and so should\n * always be forbidden or CSS-escaped in user controlled input. For example, if\n * {@code &lt;/style&gt;&lt;script&gt;evil&lt;/script&gt;\"} were interpolated\n * inside a CSS string, it would break out of the context of the original\n * style element and {@code evil} would execute. Also note that within an HTML\n * style (raw text) element, HTML character references, such as\n * {@code &amp;lt;}, are not allowed. See\n *\n http://www.w3.org/TR/html5/scripting-1.html#restrictions-for-contents-of-script-elements\n * (similar considerations apply to the style element).\n *\n * @see goog.html.SafeStyleSheet#fromConstant\n * @constructor\n * @final\n * @struct\n * @implements {goog.string.TypedString}\n */\ngoog.html.SafeStyleSheet = function() {\n  /**\n   * The contained value of this SafeStyleSheet.  The field has a purposely\n   * ugly name to make (non-compiled) code that attempts to directly access this\n   * field stand out.\n   * @private {string}\n   */\n  this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_ = '';\n\n  /**\n   * A type marker used to implement additional run-time type checking.\n   * @see goog.html.SafeStyleSheet#unwrap\n   * @const {!Object}\n   * @private\n   */\n  this.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ =\n      goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.SafeStyleSheet.prototype.implementsGoogStringTypedString = true;\n\n\n/**\n * Type marker for the SafeStyleSheet type, used to implement additional\n * run-time type checking.\n * @const {!Object}\n * @private\n */\ngoog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ = {};\n\n\n/**\n * Creates a new SafeStyleSheet object by concatenating values.\n * @param {...(!goog.html.SafeStyleSheet|!Array<!goog.html.SafeStyleSheet>)}\n *     var_args Values to concatenate.\n * @return {!goog.html.SafeStyleSheet}\n */\ngoog.html.SafeStyleSheet.concat = function(var_args) {\n  var result = '';\n\n  /**\n   * @param {!goog.html.SafeStyleSheet|!Array<!goog.html.SafeStyleSheet>}\n   *     argument\n   */\n  var addArgument = function(argument) {\n    if (goog.isArray(argument)) {\n      goog.array.forEach(argument, addArgument);\n    } else {\n      result += goog.html.SafeStyleSheet.unwrap(argument);\n    }\n  };\n\n  goog.array.forEach(arguments, addArgument);\n  return goog.html.SafeStyleSheet\n      .createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(result);\n};\n\n\n/**\n * Creates a SafeStyleSheet object from a compile-time constant string.\n *\n * {@code styleSheet} must not have any &lt; characters in it, so that\n * the syntactic structure of the surrounding HTML is not affected.\n *\n * @param {!goog.string.Const} styleSheet A compile-time-constant string from\n *     which to create a SafeStyleSheet.\n * @return {!goog.html.SafeStyleSheet} A SafeStyleSheet object initialized to\n *     {@code styleSheet}.\n */\ngoog.html.SafeStyleSheet.fromConstant = function(styleSheet) {\n  var styleSheetString = goog.string.Const.unwrap(styleSheet);\n  if (styleSheetString.length === 0) {\n    return goog.html.SafeStyleSheet.EMPTY;\n  }\n  // > is a valid character in CSS selectors and there's no strict need to\n  // block it if we already block <.\n  goog.asserts.assert(\n      !goog.string.contains(styleSheetString, '<'),\n      \"Forbidden '<' character in style sheet string: \" + styleSheetString);\n  return goog.html.SafeStyleSheet\n      .createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(styleSheetString);\n};\n\n\n/**\n * Returns this SafeStyleSheet's value as a string.\n *\n * IMPORTANT: In code where it is security relevant that an object's type is\n * indeed {@code SafeStyleSheet}, use {@code goog.html.SafeStyleSheet.unwrap}\n * instead of this method. If in doubt, assume that it's security relevant. In\n * particular, note that goog.html functions which return a goog.html type do\n * not guarantee the returned instance is of the right type. For example:\n *\n * <pre>\n * var fakeSafeHtml = new String('fake');\n * fakeSafeHtml.__proto__ = goog.html.SafeHtml.prototype;\n * var newSafeHtml = goog.html.SafeHtml.htmlEscape(fakeSafeHtml);\n * // newSafeHtml is just an alias for fakeSafeHtml, it's passed through by\n * // goog.html.SafeHtml.htmlEscape() as fakeSafeHtml\n * // instanceof goog.html.SafeHtml.\n * </pre>\n *\n * @see goog.html.SafeStyleSheet#unwrap\n * @override\n */\ngoog.html.SafeStyleSheet.prototype.getTypedStringValue = function() {\n  return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_;\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a debug string-representation of this value.\n   *\n   * To obtain the actual string value wrapped in a SafeStyleSheet, use\n   * {@code goog.html.SafeStyleSheet.unwrap}.\n   *\n   * @see goog.html.SafeStyleSheet#unwrap\n   * @override\n   */\n  goog.html.SafeStyleSheet.prototype.toString = function() {\n    return 'SafeStyleSheet{' +\n        this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_ + '}';\n  };\n}\n\n\n/**\n * Performs a runtime check that the provided object is indeed a\n * SafeStyleSheet object, and returns its value.\n *\n * @param {!goog.html.SafeStyleSheet} safeStyleSheet The object to extract from.\n * @return {string} The safeStyleSheet object's contained string, unless\n *     the run-time type check fails. In that case, {@code unwrap} returns an\n *     innocuous string, or, if assertions are enabled, throws\n *     {@code goog.asserts.AssertionError}.\n */\ngoog.html.SafeStyleSheet.unwrap = function(safeStyleSheet) {\n  // Perform additional Run-time type-checking to ensure that\n  // safeStyleSheet is indeed an instance of the expected type.  This\n  // provides some additional protection against security bugs due to\n  // application code that disables type checks.\n  // Specifically, the following checks are performed:\n  // 1. The object is an instance of the expected type.\n  // 2. The object is not an instance of a subclass.\n  // 3. The object carries a type marker for the expected type. \"Faking\" an\n  // object requires a reference to the type marker, which has names intended\n  // to stand out in code reviews.\n  if (safeStyleSheet instanceof goog.html.SafeStyleSheet &&\n      safeStyleSheet.constructor === goog.html.SafeStyleSheet &&\n      safeStyleSheet\n              .SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ ===\n          goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_) {\n    return safeStyleSheet.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_;\n  } else {\n    goog.asserts.fail('expected object of type SafeStyleSheet, got \\'' +\n        safeStyleSheet + '\\' of type ' + goog.typeOf(safeStyleSheet));\n    return 'type_error:SafeStyleSheet';\n  }\n};\n\n\n/**\n * Package-internal utility method to create SafeStyleSheet instances.\n *\n * @param {string} styleSheet The string to initialize the SafeStyleSheet\n *     object with.\n * @return {!goog.html.SafeStyleSheet} The initialized SafeStyleSheet object.\n * @package\n */\ngoog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse =\n    function(styleSheet) {\n  return new goog.html.SafeStyleSheet().initSecurityPrivateDoNotAccessOrElse_(\n      styleSheet);\n};\n\n\n/**\n * Called from createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(). This\n * method exists only so that the compiler can dead code eliminate static\n * fields (like EMPTY) when they're not accessed.\n * @param {string} styleSheet\n * @return {!goog.html.SafeStyleSheet}\n * @private\n */\ngoog.html.SafeStyleSheet.prototype.initSecurityPrivateDoNotAccessOrElse_ =\n    function(styleSheet) {\n  this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_ = styleSheet;\n  return this;\n};\n\n\n/**\n * A SafeStyleSheet instance corresponding to the empty string.\n * @const {!goog.html.SafeStyleSheet}\n */\ngoog.html.SafeStyleSheet.EMPTY =\n    goog.html.SafeStyleSheet\n        .createSafeStyleSheetSecurityPrivateDoNotAccessOrElse('');\n","// Copyright 2015 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Wrapper for URL and its createObjectUrl and revokeObjectUrl\n * methods that are part of the HTML5 File API.\n */\n\ngoog.provide('goog.fs.url');\n\n\n/**\n * Creates a blob URL for a blob object.\n * Throws an error if the browser does not support Object Urls.\n *\n * @param {!Blob} blob The object for which to create the URL.\n * @return {string} The URL for the object.\n */\ngoog.fs.url.createObjectUrl = function(blob) {\n  return goog.fs.url.getUrlObject_().createObjectURL(blob);\n};\n\n\n/**\n * Revokes a URL created by {@link goog.fs.url.createObjectUrl}.\n * Throws an error if the browser does not support Object Urls.\n *\n * @param {string} url The URL to revoke.\n */\ngoog.fs.url.revokeObjectUrl = function(url) {\n  goog.fs.url.getUrlObject_().revokeObjectURL(url);\n};\n\n\n/**\n * @typedef {{createObjectURL: (function(!Blob): string),\n *            revokeObjectURL: function(string): void}}\n */\ngoog.fs.url.UrlObject_;\n\n\n/**\n * Get the object that has the createObjectURL and revokeObjectURL functions for\n * this browser.\n *\n * @return {goog.fs.url.UrlObject_} The object for this browser.\n * @private\n */\ngoog.fs.url.getUrlObject_ = function() {\n  var urlObject = goog.fs.url.findUrlObject_();\n  if (urlObject != null) {\n    return urlObject;\n  } else {\n    throw Error('This browser doesn\\'t seem to support blob URLs');\n  }\n};\n\n\n/**\n * Finds the object that has the createObjectURL and revokeObjectURL functions\n * for this browser.\n *\n * @return {?goog.fs.url.UrlObject_} The object for this browser or null if the\n *     browser does not support Object Urls.\n * @private\n */\ngoog.fs.url.findUrlObject_ = function() {\n  // This is what the spec says to do\n  // http://dev.w3.org/2006/webapi/FileAPI/#dfn-createObjectURL\n  if (goog.isDef(goog.global.URL) &&\n      goog.isDef(goog.global.URL.createObjectURL)) {\n    return /** @type {goog.fs.url.UrlObject_} */ (goog.global.URL);\n    // This is what Chrome does (as of 10.0.648.6 dev)\n  } else if (\n      goog.isDef(goog.global.webkitURL) &&\n      goog.isDef(goog.global.webkitURL.createObjectURL)) {\n    return /** @type {goog.fs.url.UrlObject_} */ (goog.global.webkitURL);\n    // This is what the spec used to say to do\n  } else if (goog.isDef(goog.global.createObjectURL)) {\n    return /** @type {goog.fs.url.UrlObject_} */ (goog.global);\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * Checks whether this browser supports Object Urls. If not, calls to\n * createObjectUrl and revokeObjectUrl will result in an error.\n *\n * @return {boolean} True if this browser supports Object Urls.\n */\ngoog.fs.url.browserSupportsObjectUrls = function() {\n  return goog.fs.url.findUrlObject_() != null;\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utility functions for supporting Bidi issues.\n */\n\n\n/**\n * Namespace for bidi supporting functions.\n */\ngoog.provide('goog.i18n.bidi');\ngoog.provide('goog.i18n.bidi.Dir');\ngoog.provide('goog.i18n.bidi.DirectionalString');\ngoog.provide('goog.i18n.bidi.Format');\n\n\n/**\n * @define {boolean} FORCE_RTL forces the {@link goog.i18n.bidi.IS_RTL} constant\n * to say that the current locale is a RTL locale.  This should only be used\n * if you want to override the default behavior for deciding whether the\n * current locale is RTL or not.\n *\n * {@see goog.i18n.bidi.IS_RTL}\n */\ngoog.define('goog.i18n.bidi.FORCE_RTL', false);\n\n\n/**\n * Constant that defines whether or not the current locale is a RTL locale.\n * If {@link goog.i18n.bidi.FORCE_RTL} is not true, this constant will default\n * to check that {@link goog.LOCALE} is one of a few major RTL locales.\n *\n * <p>This is designed to be a maximally efficient compile-time constant. For\n * example, for the default goog.LOCALE, compiling\n * \"if (goog.i18n.bidi.IS_RTL) alert('rtl') else {}\" should produce no code. It\n * is this design consideration that limits the implementation to only\n * supporting a few major RTL locales, as opposed to the broader repertoire of\n * something like goog.i18n.bidi.isRtlLanguage.\n *\n * <p>Since this constant refers to the directionality of the locale, it is up\n * to the caller to determine if this constant should also be used for the\n * direction of the UI.\n *\n * {@see goog.LOCALE}\n *\n * @type {boolean}\n *\n * TODO(user): write a test that checks that this is a compile-time constant.\n */\ngoog.i18n.bidi.IS_RTL = goog.i18n.bidi.FORCE_RTL ||\n    ((goog.LOCALE.substring(0, 2).toLowerCase() == 'ar' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'fa' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'he' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'iw' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'ps' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'sd' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'ug' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'ur' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'yi') &&\n     (goog.LOCALE.length == 2 || goog.LOCALE.substring(2, 3) == '-' ||\n      goog.LOCALE.substring(2, 3) == '_')) ||\n    (goog.LOCALE.length >= 3 &&\n     goog.LOCALE.substring(0, 3).toLowerCase() == 'ckb' &&\n     (goog.LOCALE.length == 3 || goog.LOCALE.substring(3, 4) == '-' ||\n      goog.LOCALE.substring(3, 4) == '_'));\n\n\n/**\n * Unicode formatting characters and directionality string constants.\n * @enum {string}\n */\ngoog.i18n.bidi.Format = {\n  /** Unicode \"Left-To-Right Embedding\" (LRE) character. */\n  LRE: '\\u202A',\n  /** Unicode \"Right-To-Left Embedding\" (RLE) character. */\n  RLE: '\\u202B',\n  /** Unicode \"Pop Directional Formatting\" (PDF) character. */\n  PDF: '\\u202C',\n  /** Unicode \"Left-To-Right Mark\" (LRM) character. */\n  LRM: '\\u200E',\n  /** Unicode \"Right-To-Left Mark\" (RLM) character. */\n  RLM: '\\u200F'\n};\n\n\n/**\n * Directionality enum.\n * @enum {number}\n */\ngoog.i18n.bidi.Dir = {\n  /**\n   * Left-to-right.\n   */\n  LTR: 1,\n\n  /**\n   * Right-to-left.\n   */\n  RTL: -1,\n\n  /**\n   * Neither left-to-right nor right-to-left.\n   */\n  NEUTRAL: 0\n};\n\n\n/**\n * 'right' string constant.\n * @type {string}\n */\ngoog.i18n.bidi.RIGHT = 'right';\n\n\n/**\n * 'left' string constant.\n * @type {string}\n */\ngoog.i18n.bidi.LEFT = 'left';\n\n\n/**\n * 'left' if locale is RTL, 'right' if not.\n * @type {string}\n */\ngoog.i18n.bidi.I18N_RIGHT =\n    goog.i18n.bidi.IS_RTL ? goog.i18n.bidi.LEFT : goog.i18n.bidi.RIGHT;\n\n\n/**\n * 'right' if locale is RTL, 'left' if not.\n * @type {string}\n */\ngoog.i18n.bidi.I18N_LEFT =\n    goog.i18n.bidi.IS_RTL ? goog.i18n.bidi.RIGHT : goog.i18n.bidi.LEFT;\n\n\n/**\n * Convert a directionality given in various formats to a goog.i18n.bidi.Dir\n * constant. Useful for interaction with different standards of directionality\n * representation.\n *\n * @param {goog.i18n.bidi.Dir|number|boolean|null} givenDir Directionality given\n *     in one of the following formats:\n *     1. A goog.i18n.bidi.Dir constant.\n *     2. A number (positive = LTR, negative = RTL, 0 = neutral).\n *     3. A boolean (true = RTL, false = LTR).\n *     4. A null for unknown directionality.\n * @param {boolean=} opt_noNeutral Whether a givenDir of zero or\n *     goog.i18n.bidi.Dir.NEUTRAL should be treated as null, i.e. unknown, in\n *     order to preserve legacy behavior.\n * @return {?goog.i18n.bidi.Dir} A goog.i18n.bidi.Dir constant matching the\n *     given directionality. If given null, returns null (i.e. unknown).\n */\ngoog.i18n.bidi.toDir = function(givenDir, opt_noNeutral) {\n  if (typeof givenDir == 'number') {\n    // This includes the non-null goog.i18n.bidi.Dir case.\n    return givenDir > 0 ? goog.i18n.bidi.Dir.LTR : givenDir < 0 ?\n                          goog.i18n.bidi.Dir.RTL :\n                          opt_noNeutral ? null : goog.i18n.bidi.Dir.NEUTRAL;\n  } else if (givenDir == null) {\n    return null;\n  } else {\n    // Must be typeof givenDir == 'boolean'.\n    return givenDir ? goog.i18n.bidi.Dir.RTL : goog.i18n.bidi.Dir.LTR;\n  }\n};\n\n\n/**\n * A practical pattern to identify strong LTR characters. This pattern is not\n * theoretically correct according to the Unicode standard. It is simplified for\n * performance and small code size.\n * @type {string}\n * @private\n */\ngoog.i18n.bidi.ltrChars_ =\n    'A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02B8\\u0300-\\u0590\\u0800-\\u1FFF' +\n    '\\u200E\\u2C00-\\uFB1C\\uFE00-\\uFE6F\\uFEFD-\\uFFFF';\n\n\n/**\n * A practical pattern to identify strong RTL character. This pattern is not\n * theoretically correct according to the Unicode standard. It is simplified\n * for performance and small code size.\n * @type {string}\n * @private\n */\ngoog.i18n.bidi.rtlChars_ =\n    '\\u0591-\\u06EF\\u06FA-\\u07FF\\u200F\\uFB1D-\\uFDFF\\uFE70-\\uFEFC';\n\n\n/**\n * Simplified regular expression for an HTML tag (opening or closing) or an HTML\n * escape. We might want to skip over such expressions when estimating the text\n * directionality.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.htmlSkipReg_ = /<[^>]*>|&[^;]+;/g;\n\n\n/**\n * Returns the input text with spaces instead of HTML tags or HTML escapes, if\n * opt_isStripNeeded is true. Else returns the input as is.\n * Useful for text directionality estimation.\n * Note: the function should not be used in other contexts; it is not 100%\n * correct, but rather a good-enough implementation for directionality\n * estimation purposes.\n * @param {string} str The given string.\n * @param {boolean=} opt_isStripNeeded Whether to perform the stripping.\n *     Default: false (to retain consistency with calling functions).\n * @return {string} The given string cleaned of HTML tags / escapes.\n * @private\n */\ngoog.i18n.bidi.stripHtmlIfNeeded_ = function(str, opt_isStripNeeded) {\n  return opt_isStripNeeded ? str.replace(goog.i18n.bidi.htmlSkipReg_, '') : str;\n};\n\n\n/**\n * Regular expression to check for RTL characters.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.rtlCharReg_ = new RegExp('[' + goog.i18n.bidi.rtlChars_ + ']');\n\n\n/**\n * Regular expression to check for LTR characters.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.ltrCharReg_ = new RegExp('[' + goog.i18n.bidi.ltrChars_ + ']');\n\n\n/**\n * Test whether the given string has any RTL characters in it.\n * @param {string} str The given string that need to be tested.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether the string contains RTL characters.\n */\ngoog.i18n.bidi.hasAnyRtl = function(str, opt_isHtml) {\n  return goog.i18n.bidi.rtlCharReg_.test(\n      goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml));\n};\n\n\n/**\n * Test whether the given string has any RTL characters in it.\n * @param {string} str The given string that need to be tested.\n * @return {boolean} Whether the string contains RTL characters.\n * @deprecated Use hasAnyRtl.\n */\ngoog.i18n.bidi.hasRtlChar = goog.i18n.bidi.hasAnyRtl;\n\n\n/**\n * Test whether the given string has any LTR characters in it.\n * @param {string} str The given string that need to be tested.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether the string contains LTR characters.\n */\ngoog.i18n.bidi.hasAnyLtr = function(str, opt_isHtml) {\n  return goog.i18n.bidi.ltrCharReg_.test(\n      goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml));\n};\n\n\n/**\n * Regular expression pattern to check if the first character in the string\n * is LTR.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.ltrRe_ = new RegExp('^[' + goog.i18n.bidi.ltrChars_ + ']');\n\n\n/**\n * Regular expression pattern to check if the first character in the string\n * is RTL.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.rtlRe_ = new RegExp('^[' + goog.i18n.bidi.rtlChars_ + ']');\n\n\n/**\n * Check if the first character in the string is RTL or not.\n * @param {string} str The given string that need to be tested.\n * @return {boolean} Whether the first character in str is an RTL char.\n */\ngoog.i18n.bidi.isRtlChar = function(str) {\n  return goog.i18n.bidi.rtlRe_.test(str);\n};\n\n\n/**\n * Check if the first character in the string is LTR or not.\n * @param {string} str The given string that need to be tested.\n * @return {boolean} Whether the first character in str is an LTR char.\n */\ngoog.i18n.bidi.isLtrChar = function(str) {\n  return goog.i18n.bidi.ltrRe_.test(str);\n};\n\n\n/**\n * Check if the first character in the string is neutral or not.\n * @param {string} str The given string that need to be tested.\n * @return {boolean} Whether the first character in str is a neutral char.\n */\ngoog.i18n.bidi.isNeutralChar = function(str) {\n  return !goog.i18n.bidi.isLtrChar(str) && !goog.i18n.bidi.isRtlChar(str);\n};\n\n\n/**\n * Regular expressions to check if a piece of text is of LTR directionality\n * on first character with strong directionality.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.ltrDirCheckRe_ = new RegExp(\n    '^[^' + goog.i18n.bidi.rtlChars_ + ']*[' + goog.i18n.bidi.ltrChars_ + ']');\n\n\n/**\n * Regular expressions to check if a piece of text is of RTL directionality\n * on first character with strong directionality.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.rtlDirCheckRe_ = new RegExp(\n    '^[^' + goog.i18n.bidi.ltrChars_ + ']*[' + goog.i18n.bidi.rtlChars_ + ']');\n\n\n/**\n * Check whether the first strongly directional character (if any) is RTL.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether RTL directionality is detected using the first\n *     strongly-directional character method.\n */\ngoog.i18n.bidi.startsWithRtl = function(str, opt_isHtml) {\n  return goog.i18n.bidi.rtlDirCheckRe_.test(\n      goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml));\n};\n\n\n/**\n * Check whether the first strongly directional character (if any) is RTL.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether RTL directionality is detected using the first\n *     strongly-directional character method.\n * @deprecated Use startsWithRtl.\n */\ngoog.i18n.bidi.isRtlText = goog.i18n.bidi.startsWithRtl;\n\n\n/**\n * Check whether the first strongly directional character (if any) is LTR.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether LTR directionality is detected using the first\n *     strongly-directional character method.\n */\ngoog.i18n.bidi.startsWithLtr = function(str, opt_isHtml) {\n  return goog.i18n.bidi.ltrDirCheckRe_.test(\n      goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml));\n};\n\n\n/**\n * Check whether the first strongly directional character (if any) is LTR.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether LTR directionality is detected using the first\n *     strongly-directional character method.\n * @deprecated Use startsWithLtr.\n */\ngoog.i18n.bidi.isLtrText = goog.i18n.bidi.startsWithLtr;\n\n\n/**\n * Regular expression to check if a string looks like something that must\n * always be LTR even in RTL text, e.g. a URL. When estimating the\n * directionality of text containing these, we treat these as weakly LTR,\n * like numbers.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.isRequiredLtrRe_ = /^http:\\/\\/.*/;\n\n\n/**\n * Check whether the input string either contains no strongly directional\n * characters or looks like a url.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether neutral directionality is detected.\n */\ngoog.i18n.bidi.isNeutralText = function(str, opt_isHtml) {\n  str = goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml);\n  return goog.i18n.bidi.isRequiredLtrRe_.test(str) ||\n      !goog.i18n.bidi.hasAnyLtr(str) && !goog.i18n.bidi.hasAnyRtl(str);\n};\n\n\n/**\n * Regular expressions to check if the last strongly-directional character in a\n * piece of text is LTR.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.ltrExitDirCheckRe_ = new RegExp(\n    '[' + goog.i18n.bidi.ltrChars_ + '][^' + goog.i18n.bidi.rtlChars_ + ']*$');\n\n\n/**\n * Regular expressions to check if the last strongly-directional character in a\n * piece of text is RTL.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.rtlExitDirCheckRe_ = new RegExp(\n    '[' + goog.i18n.bidi.rtlChars_ + '][^' + goog.i18n.bidi.ltrChars_ + ']*$');\n\n\n/**\n * Check if the exit directionality a piece of text is LTR, i.e. if the last\n * strongly-directional character in the string is LTR.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether LTR exit directionality was detected.\n */\ngoog.i18n.bidi.endsWithLtr = function(str, opt_isHtml) {\n  return goog.i18n.bidi.ltrExitDirCheckRe_.test(\n      goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml));\n};\n\n\n/**\n * Check if the exit directionality a piece of text is LTR, i.e. if the last\n * strongly-directional character in the string is LTR.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether LTR exit directionality was detected.\n * @deprecated Use endsWithLtr.\n */\ngoog.i18n.bidi.isLtrExitText = goog.i18n.bidi.endsWithLtr;\n\n\n/**\n * Check if the exit directionality a piece of text is RTL, i.e. if the last\n * strongly-directional character in the string is RTL.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether RTL exit directionality was detected.\n */\ngoog.i18n.bidi.endsWithRtl = function(str, opt_isHtml) {\n  return goog.i18n.bidi.rtlExitDirCheckRe_.test(\n      goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml));\n};\n\n\n/**\n * Check if the exit directionality a piece of text is RTL, i.e. if the last\n * strongly-directional character in the string is RTL.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether RTL exit directionality was detected.\n * @deprecated Use endsWithRtl.\n */\ngoog.i18n.bidi.isRtlExitText = goog.i18n.bidi.endsWithRtl;\n\n\n/**\n * A regular expression for matching right-to-left language codes.\n * See {@link #isRtlLanguage} for the design.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.rtlLocalesRe_ = new RegExp(\n    '^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|' +\n        '.*[-_](Arab|Hebr|Thaa|Nkoo|Tfng))' +\n        '(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)',\n    'i');\n\n\n/**\n * Check if a BCP 47 / III language code indicates an RTL language, i.e. either:\n * - a language code explicitly specifying one of the right-to-left scripts,\n *   e.g. \"az-Arab\", or<p>\n * - a language code specifying one of the languages normally written in a\n *   right-to-left script, e.g. \"fa\" (Farsi), except ones explicitly specifying\n *   Latin or Cyrillic script (which are the usual LTR alternatives).<p>\n * The list of right-to-left scripts appears in the 100-199 range in\n * http://www.unicode.org/iso15924/iso15924-num.html, of which Arabic and\n * Hebrew are by far the most widely used. We also recognize Thaana, N'Ko, and\n * Tifinagh, which also have significant modern usage. The rest (Syriac,\n * Samaritan, Mandaic, etc.) seem to have extremely limited or no modern usage\n * and are not recognized to save on code size.\n * The languages usually written in a right-to-left script are taken as those\n * with Suppress-Script: Hebr|Arab|Thaa|Nkoo|Tfng  in\n * http://www.iana.org/assignments/language-subtag-registry,\n * as well as Central (or Sorani) Kurdish (ckb), Sindhi (sd) and Uyghur (ug).\n * Other subtags of the language code, e.g. regions like EG (Egypt), are\n * ignored.\n * @param {string} lang BCP 47 (a.k.a III) language code.\n * @return {boolean} Whether the language code is an RTL language.\n */\ngoog.i18n.bidi.isRtlLanguage = function(lang) {\n  return goog.i18n.bidi.rtlLocalesRe_.test(lang);\n};\n\n\n/**\n * Regular expression for bracket guard replacement in text.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.bracketGuardTextRe_ =\n    /(\\(.*?\\)+)|(\\[.*?\\]+)|(\\{.*?\\}+)|(<.*?>+)/g;\n\n\n/**\n * Apply bracket guard using LRM and RLM. This is to address the problem of\n * messy bracket display frequently happens in RTL layout.\n * This function works for plain text, not for HTML. In HTML, the opening\n * bracket might be in a different context than the closing bracket (such as\n * an attribute value).\n * @param {string} s The string that need to be processed.\n * @param {boolean=} opt_isRtlContext specifies default direction (usually\n *     direction of the UI).\n * @return {string} The processed string, with all bracket guarded.\n */\ngoog.i18n.bidi.guardBracketInText = function(s, opt_isRtlContext) {\n  var useRtl = opt_isRtlContext === undefined ? goog.i18n.bidi.hasAnyRtl(s) :\n                                                opt_isRtlContext;\n  var mark = useRtl ? goog.i18n.bidi.Format.RLM : goog.i18n.bidi.Format.LRM;\n  return s.replace(goog.i18n.bidi.bracketGuardTextRe_, mark + '$&' + mark);\n};\n\n\n/**\n * Enforce the html snippet in RTL directionality regardless overall context.\n * If the html piece was enclosed by tag, dir will be applied to existing\n * tag, otherwise a span tag will be added as wrapper. For this reason, if\n * html snippet start with with tag, this tag must enclose the whole piece. If\n * the tag already has a dir specified, this new one will override existing\n * one in behavior (tested on FF and IE).\n * @param {string} html The string that need to be processed.\n * @return {string} The processed string, with directionality enforced to RTL.\n */\ngoog.i18n.bidi.enforceRtlInHtml = function(html) {\n  if (html.charAt(0) == '<') {\n    return html.replace(/<\\w+/, '$& dir=rtl');\n  }\n  // '\\n' is important for FF so that it won't incorrectly merge span groups\n  return '\\n<span dir=rtl>' + html + '</span>';\n};\n\n\n/**\n * Enforce RTL on both end of the given text piece using unicode BiDi formatting\n * characters RLE and PDF.\n * @param {string} text The piece of text that need to be wrapped.\n * @return {string} The wrapped string after process.\n */\ngoog.i18n.bidi.enforceRtlInText = function(text) {\n  return goog.i18n.bidi.Format.RLE + text + goog.i18n.bidi.Format.PDF;\n};\n\n\n/**\n * Enforce the html snippet in RTL directionality regardless overall context.\n * If the html piece was enclosed by tag, dir will be applied to existing\n * tag, otherwise a span tag will be added as wrapper. For this reason, if\n * html snippet start with with tag, this tag must enclose the whole piece. If\n * the tag already has a dir specified, this new one will override existing\n * one in behavior (tested on FF and IE).\n * @param {string} html The string that need to be processed.\n * @return {string} The processed string, with directionality enforced to RTL.\n */\ngoog.i18n.bidi.enforceLtrInHtml = function(html) {\n  if (html.charAt(0) == '<') {\n    return html.replace(/<\\w+/, '$& dir=ltr');\n  }\n  // '\\n' is important for FF so that it won't incorrectly merge span groups\n  return '\\n<span dir=ltr>' + html + '</span>';\n};\n\n\n/**\n * Enforce LTR on both end of the given text piece using unicode BiDi formatting\n * characters LRE and PDF.\n * @param {string} text The piece of text that need to be wrapped.\n * @return {string} The wrapped string after process.\n */\ngoog.i18n.bidi.enforceLtrInText = function(text) {\n  return goog.i18n.bidi.Format.LRE + text + goog.i18n.bidi.Format.PDF;\n};\n\n\n/**\n * Regular expression to find dimensions such as \"padding: .3 0.4ex 5px 6;\"\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.dimensionsRe_ =\n    /:\\s*([.\\d][.\\w]*)\\s+([.\\d][.\\w]*)\\s+([.\\d][.\\w]*)\\s+([.\\d][.\\w]*)/g;\n\n\n/**\n * Regular expression for left.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.leftRe_ = /left/gi;\n\n\n/**\n * Regular expression for right.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.rightRe_ = /right/gi;\n\n\n/**\n * Placeholder regular expression for swapping.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.tempRe_ = /%%%%/g;\n\n\n/**\n * Swap location parameters and 'left'/'right' in CSS specification. The\n * processed string will be suited for RTL layout. Though this function can\n * cover most cases, there are always exceptions. It is suggested to put\n * those exceptions in separate group of CSS string.\n * @param {string} cssStr CSS spefication string.\n * @return {string} Processed CSS specification string.\n */\ngoog.i18n.bidi.mirrorCSS = function(cssStr) {\n  return cssStr\n      .\n      // reverse dimensions\n      replace(goog.i18n.bidi.dimensionsRe_, ':$1 $4 $3 $2')\n      .replace(goog.i18n.bidi.leftRe_, '%%%%')\n      .  // swap left and right\n      replace(goog.i18n.bidi.rightRe_, goog.i18n.bidi.LEFT)\n      .replace(goog.i18n.bidi.tempRe_, goog.i18n.bidi.RIGHT);\n};\n\n\n/**\n * Regular expression for hebrew double quote substitution, finding quote\n * directly after hebrew characters.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.doubleQuoteSubstituteRe_ = /([\\u0591-\\u05f2])\"/g;\n\n\n/**\n * Regular expression for hebrew single quote substitution, finding quote\n * directly after hebrew characters.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.singleQuoteSubstituteRe_ = /([\\u0591-\\u05f2])'/g;\n\n\n/**\n * Replace the double and single quote directly after a Hebrew character with\n * GERESH and GERSHAYIM. In such case, most likely that's user intention.\n * @param {string} str String that need to be processed.\n * @return {string} Processed string with double/single quote replaced.\n */\ngoog.i18n.bidi.normalizeHebrewQuote = function(str) {\n  return str.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_, '$1\\u05f4')\n      .replace(goog.i18n.bidi.singleQuoteSubstituteRe_, '$1\\u05f3');\n};\n\n\n/**\n * Regular expression to split a string into \"words\" for directionality\n * estimation based on relative word counts.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.wordSeparatorRe_ = /\\s+/;\n\n\n/**\n * Regular expression to check if a string contains any numerals. Used to\n * differentiate between completely neutral strings and those containing\n * numbers, which are weakly LTR.\n *\n * Native Arabic digits (\\u0660 - \\u0669) are not included because although they\n * do flow left-to-right inside a number, this is the case even if the  overall\n * directionality is RTL, and a mathematical expression using these digits is\n * supposed to flow right-to-left overall, including unary plus and minus\n * appearing to the right of a number, and this does depend on the overall\n * directionality being RTL. The digits used in Farsi (\\u06F0 - \\u06F9), on the\n * other hand, are included, since Farsi math (including unary plus and minus)\n * does flow left-to-right.\n *\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.hasNumeralsRe_ = /[\\d\\u06f0-\\u06f9]/;\n\n\n/**\n * This constant controls threshold of RTL directionality.\n * @type {number}\n * @private\n */\ngoog.i18n.bidi.rtlDetectionThreshold_ = 0.40;\n\n\n/**\n * Estimates the directionality of a string based on relative word counts.\n * If the number of RTL words is above a certain percentage of the total number\n * of strongly directional words, returns RTL.\n * Otherwise, if any words are strongly or weakly LTR, returns LTR.\n * Otherwise, returns UNKNOWN, which is used to mean \"neutral\".\n * Numbers are counted as weakly LTR.\n * @param {string} str The string to be checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {goog.i18n.bidi.Dir} Estimated overall directionality of {@code str}.\n */\ngoog.i18n.bidi.estimateDirection = function(str, opt_isHtml) {\n  var rtlCount = 0;\n  var totalCount = 0;\n  var hasWeaklyLtr = false;\n  var tokens = goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml)\n                   .split(goog.i18n.bidi.wordSeparatorRe_);\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n    if (goog.i18n.bidi.startsWithRtl(token)) {\n      rtlCount++;\n      totalCount++;\n    } else if (goog.i18n.bidi.isRequiredLtrRe_.test(token)) {\n      hasWeaklyLtr = true;\n    } else if (goog.i18n.bidi.hasAnyLtr(token)) {\n      totalCount++;\n    } else if (goog.i18n.bidi.hasNumeralsRe_.test(token)) {\n      hasWeaklyLtr = true;\n    }\n  }\n\n  return totalCount == 0 ?\n      (hasWeaklyLtr ? goog.i18n.bidi.Dir.LTR : goog.i18n.bidi.Dir.NEUTRAL) :\n      (rtlCount / totalCount > goog.i18n.bidi.rtlDetectionThreshold_ ?\n           goog.i18n.bidi.Dir.RTL :\n           goog.i18n.bidi.Dir.LTR);\n};\n\n\n/**\n * Check the directionality of a piece of text, return true if the piece of\n * text should be laid out in RTL direction.\n * @param {string} str The piece of text that need to be detected.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether this piece of text should be laid out in RTL.\n */\ngoog.i18n.bidi.detectRtlDirectionality = function(str, opt_isHtml) {\n  return goog.i18n.bidi.estimateDirection(str, opt_isHtml) ==\n      goog.i18n.bidi.Dir.RTL;\n};\n\n\n/**\n * Sets text input element's directionality and text alignment based on a\n * given directionality. Does nothing if the given directionality is unknown or\n * neutral.\n * @param {Element} element Input field element to set directionality to.\n * @param {goog.i18n.bidi.Dir|number|boolean|null} dir Desired directionality,\n *     given in one of the following formats:\n *     1. A goog.i18n.bidi.Dir constant.\n *     2. A number (positive = LRT, negative = RTL, 0 = neutral).\n *     3. A boolean (true = RTL, false = LTR).\n *     4. A null for unknown directionality.\n */\ngoog.i18n.bidi.setElementDirAndAlign = function(element, dir) {\n  if (element) {\n    dir = goog.i18n.bidi.toDir(dir);\n    if (dir) {\n      element.style.textAlign = dir == goog.i18n.bidi.Dir.RTL ?\n          goog.i18n.bidi.RIGHT :\n          goog.i18n.bidi.LEFT;\n      element.dir = dir == goog.i18n.bidi.Dir.RTL ? 'rtl' : 'ltr';\n    }\n  }\n};\n\n\n/**\n * Sets element dir based on estimated directionality of the given text.\n * @param {!Element} element\n * @param {string} text\n */\ngoog.i18n.bidi.setElementDirByTextDirectionality = function(element, text) {\n  switch (goog.i18n.bidi.estimateDirection(text)) {\n    case (goog.i18n.bidi.Dir.LTR):\n      element.dir = 'ltr';\n      break;\n    case (goog.i18n.bidi.Dir.RTL):\n      element.dir = 'rtl';\n      break;\n    default:\n      // Default for no direction, inherit from document.\n      element.removeAttribute('dir');\n  }\n};\n\n\n\n/**\n * Strings that have an (optional) known direction.\n *\n * Implementations of this interface are string-like objects that carry an\n * attached direction, if known.\n * @interface\n */\ngoog.i18n.bidi.DirectionalString = function() {};\n\n\n/**\n * Interface marker of the DirectionalString interface.\n *\n * This property can be used to determine at runtime whether or not an object\n * implements this interface.  All implementations of this interface set this\n * property to {@code true}.\n * @type {boolean}\n */\ngoog.i18n.bidi.DirectionalString.prototype\n    .implementsGoogI18nBidiDirectionalString;\n\n\n/**\n * Retrieves this object's known direction (if any).\n * @return {?goog.i18n.bidi.Dir} The known direction. Null if unknown.\n */\ngoog.i18n.bidi.DirectionalString.prototype.getDirection;\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview The SafeUrl type and its builders.\n *\n * TODO(xtof): Link to document stating type contract.\n */\n\ngoog.provide('goog.html.SafeUrl');\n\ngoog.require('goog.asserts');\ngoog.require('goog.fs.url');\ngoog.require('goog.i18n.bidi.Dir');\ngoog.require('goog.i18n.bidi.DirectionalString');\ngoog.require('goog.string');\ngoog.require('goog.string.Const');\ngoog.require('goog.string.TypedString');\n\n\n\n/**\n * A string that is safe to use in URL context in DOM APIs and HTML documents.\n *\n * A SafeUrl is a string-like object that carries the security type contract\n * that its value as a string will not cause untrusted script execution\n * when evaluated as a hyperlink URL in a browser.\n *\n * Values of this type are guaranteed to be safe to use in URL/hyperlink\n * contexts, such as, assignment to URL-valued DOM properties, or\n * interpolation into a HTML template in URL context (e.g., inside a href\n * attribute), in the sense that the use will not result in a\n * Cross-Site-Scripting vulnerability.\n *\n * Note that, as documented in {@code goog.html.SafeUrl.unwrap}, this type's\n * contract does not guarantee that instances are safe to interpolate into HTML\n * without appropriate escaping.\n *\n * Note also that this type's contract does not imply any guarantees regarding\n * the resource the URL refers to.  In particular, SafeUrls are <b>not</b>\n * safe to use in a context where the referred-to resource is interpreted as\n * trusted code, e.g., as the src of a script tag.\n *\n * Instances of this type must be created via the factory methods\n * ({@code goog.html.SafeUrl.fromConstant}, {@code goog.html.SafeUrl.sanitize}),\n * etc and not by invoking its constructor.  The constructor intentionally\n * takes no parameters and the type is immutable; hence only a default instance\n * corresponding to the empty string can be obtained via constructor invocation.\n *\n * @see goog.html.SafeUrl#fromConstant\n * @see goog.html.SafeUrl#from\n * @see goog.html.SafeUrl#sanitize\n * @constructor\n * @final\n * @struct\n * @implements {goog.i18n.bidi.DirectionalString}\n * @implements {goog.string.TypedString}\n */\ngoog.html.SafeUrl = function() {\n  /**\n   * The contained value of this SafeUrl.  The field has a purposely ugly\n   * name to make (non-compiled) code that attempts to directly access this\n   * field stand out.\n   * @private {string}\n   */\n  this.privateDoNotAccessOrElseSafeHtmlWrappedValue_ = '';\n\n  /**\n   * A type marker used to implement additional run-time type checking.\n   * @see goog.html.SafeUrl#unwrap\n   * @const {!Object}\n   * @private\n   */\n  this.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ =\n      goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;\n};\n\n\n/**\n * The innocuous string generated by goog.html.SafeUrl.sanitize when passed\n * an unsafe URL.\n *\n * about:invalid is registered in\n * http://www.w3.org/TR/css3-values/#about-invalid.\n * http://tools.ietf.org/html/rfc6694#section-2.2.1 permits about URLs to\n * contain a fragment, which is not to be considered when determining if an\n * about URL is well-known.\n *\n * Using about:invalid seems preferable to using a fixed data URL, since\n * browsers might choose to not report CSP violations on it, as legitimate\n * CSS function calls to attr() can result in this URL being produced. It is\n * also a standard URL which matches exactly the semantics we need:\n * \"The about:invalid URI references a non-existent document with a generic\n * error condition. It can be used when a URI is necessary, but the default\n * value shouldn't be resolveable as any type of document\".\n *\n * @const {string}\n */\ngoog.html.SafeUrl.INNOCUOUS_STRING = 'about:invalid#zClosurez';\n\n\n/**\n * @override\n * @const\n */\ngoog.html.SafeUrl.prototype.implementsGoogStringTypedString = true;\n\n\n/**\n * Returns this SafeUrl's value a string.\n *\n * IMPORTANT: In code where it is security relevant that an object's type is\n * indeed {@code SafeUrl}, use {@code goog.html.SafeUrl.unwrap} instead of this\n * method. If in doubt, assume that it's security relevant. In particular, note\n * that goog.html functions which return a goog.html type do not guarantee that\n * the returned instance is of the right type. For example:\n *\n * <pre>\n * var fakeSafeHtml = new String('fake');\n * fakeSafeHtml.__proto__ = goog.html.SafeHtml.prototype;\n * var newSafeHtml = goog.html.SafeHtml.htmlEscape(fakeSafeHtml);\n * // newSafeHtml is just an alias for fakeSafeHtml, it's passed through by\n * // goog.html.SafeHtml.htmlEscape() as fakeSafeHtml instanceof\n * // goog.html.SafeHtml.\n * </pre>\n *\n * IMPORTANT: The guarantees of the SafeUrl type contract only extend to the\n * behavior of browsers when interpreting URLs. Values of SafeUrl objects MUST\n * be appropriately escaped before embedding in a HTML document. Note that the\n * required escaping is context-sensitive (e.g. a different escaping is\n * required for embedding a URL in a style property within a style\n * attribute, as opposed to embedding in a href attribute).\n *\n * @see goog.html.SafeUrl#unwrap\n * @override\n */\ngoog.html.SafeUrl.prototype.getTypedStringValue = function() {\n  return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.SafeUrl.prototype.implementsGoogI18nBidiDirectionalString = true;\n\n\n/**\n * Returns this URLs directionality, which is always {@code LTR}.\n * @override\n */\ngoog.html.SafeUrl.prototype.getDirection = function() {\n  return goog.i18n.bidi.Dir.LTR;\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a debug string-representation of this value.\n   *\n   * To obtain the actual string value wrapped in a SafeUrl, use\n   * {@code goog.html.SafeUrl.unwrap}.\n   *\n   * @see goog.html.SafeUrl#unwrap\n   * @override\n   */\n  goog.html.SafeUrl.prototype.toString = function() {\n    return 'SafeUrl{' + this.privateDoNotAccessOrElseSafeHtmlWrappedValue_ +\n        '}';\n  };\n}\n\n\n/**\n * Performs a runtime check that the provided object is indeed a SafeUrl\n * object, and returns its value.\n *\n * IMPORTANT: The guarantees of the SafeUrl type contract only extend to the\n * behavior of  browsers when interpreting URLs. Values of SafeUrl objects MUST\n * be appropriately escaped before embedding in a HTML document. Note that the\n * required escaping is context-sensitive (e.g. a different escaping is\n * required for embedding a URL in a style property within a style\n * attribute, as opposed to embedding in a href attribute).\n *\n * @param {!goog.html.SafeUrl} safeUrl The object to extract from.\n * @return {string} The SafeUrl object's contained string, unless the run-time\n *     type check fails. In that case, {@code unwrap} returns an innocuous\n *     string, or, if assertions are enabled, throws\n *     {@code goog.asserts.AssertionError}.\n */\ngoog.html.SafeUrl.unwrap = function(safeUrl) {\n  // Perform additional Run-time type-checking to ensure that safeUrl is indeed\n  // an instance of the expected type.  This provides some additional protection\n  // against security bugs due to application code that disables type checks.\n  // Specifically, the following checks are performed:\n  // 1. The object is an instance of the expected type.\n  // 2. The object is not an instance of a subclass.\n  // 3. The object carries a type marker for the expected type. \"Faking\" an\n  // object requires a reference to the type marker, which has names intended\n  // to stand out in code reviews.\n  if (safeUrl instanceof goog.html.SafeUrl &&\n      safeUrl.constructor === goog.html.SafeUrl &&\n      safeUrl.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ ===\n          goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_) {\n    return safeUrl.privateDoNotAccessOrElseSafeHtmlWrappedValue_;\n  } else {\n    goog.asserts.fail('expected object of type SafeUrl, got \\'' +\n        safeUrl + '\\' of type ' + goog.typeOf(safeUrl));\n    return 'type_error:SafeUrl';\n  }\n};\n\n\n/**\n * Creates a SafeUrl object from a compile-time constant string.\n *\n * Compile-time constant strings are inherently program-controlled and hence\n * trusted.\n *\n * @param {!goog.string.Const} url A compile-time-constant string from which to\n *         create a SafeUrl.\n * @return {!goog.html.SafeUrl} A SafeUrl object initialized to {@code url}.\n */\ngoog.html.SafeUrl.fromConstant = function(url) {\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(\n      goog.string.Const.unwrap(url));\n};\n\n\n/**\n * A pattern that matches Blob or data types that can have SafeUrls created\n * from URL.createObjectURL(blob) or via a data: URI.  Only matches image and\n * video types, currently.\n * @const\n * @private\n */\ngoog.html.SAFE_MIME_TYPE_PATTERN_ =\n    /^(?:image\\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\\/(?:mpeg|mp4|ogg|webm))$/i;\n\n\n/**\n * Creates a SafeUrl wrapping a blob URL for the given {@code blob}.\n *\n * The blob URL is created with {@code URL.createObjectURL}. If the MIME type\n * for {@code blob} is not of a known safe image or video MIME type, then the\n * SafeUrl will wrap {@link #INNOCUOUS_STRING}.\n *\n * @see http://www.w3.org/TR/FileAPI/#url\n * @param {!Blob} blob\n * @return {!goog.html.SafeUrl} The blob URL, or an innocuous string wrapped\n *   as a SafeUrl.\n */\ngoog.html.SafeUrl.fromBlob = function(blob) {\n  var url = goog.html.SAFE_MIME_TYPE_PATTERN_.test(blob.type) ?\n      goog.fs.url.createObjectUrl(blob) :\n      goog.html.SafeUrl.INNOCUOUS_STRING;\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url);\n};\n\n\n/**\n * Matches a base-64 data URL, with the first match group being the MIME type.\n * @const\n * @private\n */\ngoog.html.DATA_URL_PATTERN_ = /^data:([^;,]*);base64,[a-z0-9+\\/]+=*$/i;\n\n\n/**\n * Creates a SafeUrl wrapping a data: URL, after validating it matches a\n * known-safe image or video MIME type.\n *\n * @param {string} dataUrl A valid base64 data URL with one of the whitelisted\n *     image or video MIME types.\n * @return {!goog.html.SafeUrl} A matching safe URL, or {@link INNOCUOUS_STRING}\n *     wrapped as a SafeUrl if it does not pass.\n */\ngoog.html.SafeUrl.fromDataUrl = function(dataUrl) {\n  // There's a slight risk here that a browser sniffs the content type if it\n  // doesn't know the MIME type and executes HTML within the data: URL. For this\n  // to cause XSS it would also have to execute the HTML in the same origin\n  // of the page with the link. It seems unlikely that both of these will\n  // happen, particularly in not really old IEs.\n  var match = dataUrl.match(goog.html.DATA_URL_PATTERN_);\n  var valid = match && goog.html.SAFE_MIME_TYPE_PATTERN_.test(match[1]);\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(\n      valid ? dataUrl : goog.html.SafeUrl.INNOCUOUS_STRING);\n};\n\n\n/**\n * Creates a SafeUrl wrapping a tel: URL.\n *\n * @param {string} telUrl A tel URL.\n * @return {!goog.html.SafeUrl} A matching safe URL, or {@link INNOCUOUS_STRING}\n *     wrapped as a SafeUrl if it does not pass.\n */\ngoog.html.SafeUrl.fromTelUrl = function(telUrl) {\n  // There's a risk that a tel: URL could immediately place a call once\n  // clicked, without requiring user confirmation. For that reason it is\n  // handled in this separate function.\n  if (!goog.string.caseInsensitiveStartsWith(telUrl, 'tel:')) {\n    telUrl = goog.html.SafeUrl.INNOCUOUS_STRING;\n  }\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(\n      telUrl);\n};\n\n\n/**\n * A pattern that recognizes a commonly useful subset of URLs that satisfy\n * the SafeUrl contract.\n *\n * This regular expression matches a subset of URLs that will not cause script\n * execution if used in URL context within a HTML document. Specifically, this\n * regular expression matches if (comment from here on and regex copied from\n * Soy's EscapingConventions):\n * (1) Either a protocol in a whitelist (http, https, mailto or ftp).\n * (2) or no protocol.  A protocol must be followed by a colon. The below\n *     allows that by allowing colons only after one of the characters [/?#].\n *     A colon after a hash (#) must be in the fragment.\n *     Otherwise, a colon after a (?) must be in a query.\n *     Otherwise, a colon after a single solidus (/) must be in a path.\n *     Otherwise, a colon after a double solidus (//) must be in the authority\n *     (before port).\n *\n * The pattern disallows &, used in HTML entity declarations before\n * one of the characters in [/?#]. This disallows HTML entities used in the\n * protocol name, which should never happen, e.g. \"h&#116;tp\" for \"http\".\n * It also disallows HTML entities in the first path part of a relative path,\n * e.g. \"foo&lt;bar/baz\".  Our existing escaping functions should not produce\n * that. More importantly, it disallows masking of a colon,\n * e.g. \"javascript&#58;...\".\n *\n * @private\n * @const {!RegExp}\n */\ngoog.html.SAFE_URL_PATTERN_ =\n    /^(?:(?:https?|mailto|ftp):|[^&:/?#]*(?:[/?#]|$))/i;\n\n\n/**\n * Creates a SafeUrl object from {@code url}. If {@code url} is a\n * goog.html.SafeUrl then it is simply returned. Otherwise the input string is\n * validated to match a pattern of commonly used safe URLs.\n *\n * {@code url} may be a URL with the http, https, mailto or ftp scheme,\n * or a relative URL (i.e., a URL without a scheme; specifically, a\n * scheme-relative, absolute-path-relative, or path-relative URL).\n *\n * @see http://url.spec.whatwg.org/#concept-relative-url\n * @param {string|!goog.string.TypedString} url The URL to validate.\n * @return {!goog.html.SafeUrl} The validated URL, wrapped as a SafeUrl.\n */\ngoog.html.SafeUrl.sanitize = function(url) {\n  if (url instanceof goog.html.SafeUrl) {\n    return url;\n  } else if (url.implementsGoogStringTypedString) {\n    url = url.getTypedStringValue();\n  } else {\n    url = String(url);\n  }\n  if (!goog.html.SAFE_URL_PATTERN_.test(url)) {\n    url = goog.html.SafeUrl.INNOCUOUS_STRING;\n  }\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url);\n};\n\n\n/**\n * Type marker for the SafeUrl type, used to implement additional run-time\n * type checking.\n * @const {!Object}\n * @private\n */\ngoog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ = {};\n\n\n/**\n * Package-internal utility method to create SafeUrl instances.\n *\n * @param {string} url The string to initialize the SafeUrl object with.\n * @return {!goog.html.SafeUrl} The initialized SafeUrl object.\n * @package\n */\ngoog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse = function(\n    url) {\n  var safeUrl = new goog.html.SafeUrl();\n  safeUrl.privateDoNotAccessOrElseSafeHtmlWrappedValue_ = url;\n  return safeUrl;\n};\n\n\n/**\n * A SafeUrl corresponding to the special about:blank url.\n * @const {!goog.html.SafeUrl}\n */\ngoog.html.SafeUrl.ABOUT_BLANK =\n    goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(\n        'about:blank');\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview The TrustedResourceUrl type and its builders.\n *\n * TODO(xtof): Link to document stating type contract.\n */\n\ngoog.provide('goog.html.TrustedResourceUrl');\n\ngoog.require('goog.asserts');\ngoog.require('goog.i18n.bidi.Dir');\ngoog.require('goog.i18n.bidi.DirectionalString');\ngoog.require('goog.string.Const');\ngoog.require('goog.string.TypedString');\n\n\n\n/**\n * A URL which is under application control and from which script, CSS, and\n * other resources that represent executable code, can be fetched.\n *\n * Given that the URL can only be constructed from strings under application\n * control and is used to load resources, bugs resulting in a malformed URL\n * should not have a security impact and are likely to be easily detectable\n * during testing. Given the wide number of non-RFC compliant URLs in use,\n * stricter validation could prevent some applications from being able to use\n * this type.\n *\n * Instances of this type must be created via the factory method,\n * ({@code goog.html.TrustedResourceUrl.fromConstant}), and not by invoking its\n * constructor. The constructor intentionally takes no parameters and the type\n * is immutable; hence only a default instance corresponding to the empty\n * string can be obtained via constructor invocation.\n *\n * @see goog.html.TrustedResourceUrl#fromConstant\n * @constructor\n * @final\n * @struct\n * @implements {goog.i18n.bidi.DirectionalString}\n * @implements {goog.string.TypedString}\n */\ngoog.html.TrustedResourceUrl = function() {\n  /**\n   * The contained value of this TrustedResourceUrl.  The field has a purposely\n   * ugly name to make (non-compiled) code that attempts to directly access this\n   * field stand out.\n   * @private {string}\n   */\n  this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_ = '';\n\n  /**\n   * A type marker used to implement additional run-time type checking.\n   * @see goog.html.TrustedResourceUrl#unwrap\n   * @const {!Object}\n   * @private\n   */\n  this.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ =\n      goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.TrustedResourceUrl.prototype.implementsGoogStringTypedString = true;\n\n\n/**\n * Returns this TrustedResourceUrl's value as a string.\n *\n * IMPORTANT: In code where it is security relevant that an object's type is\n * indeed {@code TrustedResourceUrl}, use\n * {@code goog.html.TrustedResourceUrl.unwrap} instead of this method. If in\n * doubt, assume that it's security relevant. In particular, note that\n * goog.html functions which return a goog.html type do not guarantee that\n * the returned instance is of the right type. For example:\n *\n * <pre>\n * var fakeSafeHtml = new String('fake');\n * fakeSafeHtml.__proto__ = goog.html.SafeHtml.prototype;\n * var newSafeHtml = goog.html.SafeHtml.htmlEscape(fakeSafeHtml);\n * // newSafeHtml is just an alias for fakeSafeHtml, it's passed through by\n * // goog.html.SafeHtml.htmlEscape() as fakeSafeHtml instanceof\n * // goog.html.SafeHtml.\n * </pre>\n *\n * @see goog.html.TrustedResourceUrl#unwrap\n * @override\n */\ngoog.html.TrustedResourceUrl.prototype.getTypedStringValue = function() {\n  return this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.TrustedResourceUrl.prototype.implementsGoogI18nBidiDirectionalString =\n    true;\n\n\n/**\n * Returns this URLs directionality, which is always {@code LTR}.\n * @override\n */\ngoog.html.TrustedResourceUrl.prototype.getDirection = function() {\n  return goog.i18n.bidi.Dir.LTR;\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a debug string-representation of this value.\n   *\n   * To obtain the actual string value wrapped in a TrustedResourceUrl, use\n   * {@code goog.html.TrustedResourceUrl.unwrap}.\n   *\n   * @see goog.html.TrustedResourceUrl#unwrap\n   * @override\n   */\n  goog.html.TrustedResourceUrl.prototype.toString = function() {\n    return 'TrustedResourceUrl{' +\n        this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_ + '}';\n  };\n}\n\n\n/**\n * Performs a runtime check that the provided object is indeed a\n * TrustedResourceUrl object, and returns its value.\n *\n * @param {!goog.html.TrustedResourceUrl} trustedResourceUrl The object to\n *     extract from.\n * @return {string} The trustedResourceUrl object's contained string, unless\n *     the run-time type check fails. In that case, {@code unwrap} returns an\n *     innocuous string, or, if assertions are enabled, throws\n *     {@code goog.asserts.AssertionError}.\n */\ngoog.html.TrustedResourceUrl.unwrap = function(trustedResourceUrl) {\n  // Perform additional Run-time type-checking to ensure that\n  // trustedResourceUrl is indeed an instance of the expected type.  This\n  // provides some additional protection against security bugs due to\n  // application code that disables type checks.\n  // Specifically, the following checks are performed:\n  // 1. The object is an instance of the expected type.\n  // 2. The object is not an instance of a subclass.\n  // 3. The object carries a type marker for the expected type. \"Faking\" an\n  // object requires a reference to the type marker, which has names intended\n  // to stand out in code reviews.\n  if (trustedResourceUrl instanceof goog.html.TrustedResourceUrl &&\n      trustedResourceUrl.constructor === goog.html.TrustedResourceUrl &&\n      trustedResourceUrl\n              .TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ ===\n          goog.html.TrustedResourceUrl\n              .TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_) {\n    return trustedResourceUrl\n        .privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_;\n  } else {\n    goog.asserts.fail('expected object of type TrustedResourceUrl, got \\'' +\n        trustedResourceUrl + '\\' of type ' + goog.typeOf(trustedResourceUrl));\n    return 'type_error:TrustedResourceUrl';\n  }\n};\n\n\n/**\n * Creates a TrustedResourceUrl from a format string and arguments.\n *\n * The arguments for interpolation into the format string map labels to values.\n * Values of type `goog.string.Const` are interpolated without modifcation.\n * Values of other types are cast to string and encoded with\n * encodeURIComponent.\n *\n * `%{<label>}` markers are used in the format string to indicate locations\n * to be interpolated with the valued mapped to the given label. `<label>`\n * must contain only alphanumeric and `_` characters.\n *\n * The format string must start with one of the following:\n * - `https://<origin>/`\n * - `//<origin>/`\n * - `/<pathStart>`\n *\n * `<origin>` must contain only alphanumeric or any of the following: `-.:[]`.\n * `<pathStart>` is any character except `/` and `\\`.\n *\n * Example usage:\n *\n *    var url = goog.html.TrustedResourceUrl.format(goog.string.Const.from(\n *        'https://www.google.com/search?q=%{query}), {query: searchTerm});\n *\n *    var url = goog.html.TrustedResourceUrl.format(goog.string.Const.from(\n *        '//www.youtube.com/v/%{videoId}?hl=en&fs=1%{autoplay}'), {\n *        'videoId': videoId,\n *        'autoplay': opt_autoplay ?\n *            goog.string.Const.EMPTY : goog.string.Const.from('autoplay=1')\n *    });\n *\n * While this function can be used to create a TrustedResourceUrl from only\n * constants, fromConstant() and fromConstants() are generally preferable for\n * that purpose.\n *\n * @param {!goog.string.Const} format The format string.\n * @param {!Object<string, (string|number|!goog.string.Const)>} args Mapping\n *     of labels to values to be interpolated into the format string.\n *     goog.string.Const values are interpolated without encoding.\n * @return {!goog.html.TrustedResourceUrl}\n * @throws {!Error} On an invalid format string or if a label used in the\n *     the format string is not present in args.\n *\n */\ngoog.html.TrustedResourceUrl.format = function(format, args) {\n  var formatStr = goog.string.Const.unwrap(format);\n  if (!goog.html.TrustedResourceUrl.BASE_URL_.test(formatStr)) {\n    throw new Error('Invalid TrustedResourceUrl format: ' + formatStr);\n  }\n  var result = formatStr.replace(\n      goog.html.TrustedResourceUrl.FORMAT_MARKER_, function(match, id) {\n        if (!Object.prototype.hasOwnProperty.call(args, id)) {\n          throw new Error(\n              'Found marker, \"' + id + '\", in format string, \"' + formatStr +\n              '\", but no valid label mapping found ' +\n              'in args: ' + JSON.stringify(args));\n        }\n        var arg = args[id];\n        if (arg instanceof goog.string.Const) {\n          return goog.string.Const.unwrap(arg);\n        } else {\n          return encodeURIComponent(String(arg));\n        }\n      });\n  return goog.html.TrustedResourceUrl\n      .createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(result);\n};\n\n\n/**\n * @private @const {!RegExp}\n */\ngoog.html.TrustedResourceUrl.FORMAT_MARKER_ = /%{(\\w+)}/g;\n\n\n/**\n * The URL must be absolute, scheme-relative or path-absolute. So it must\n * start with:\n * - https:// followed by allowed origin characters.\n * - // followed by allowed origin characters.\n * - / not followed by / or \\. There will only be an absolute path.\n *\n * Based on\n * https://url.spec.whatwg.org/commit-snapshots/56b74ce7cca8883eab62e9a12666e2fac665d03d/#url-parsing\n * an initial / which is not followed by another / or \\ will end up in the \"path\n * state\" and from there it can only go to \"fragment state\" and \"query state\".\n *\n * We don't enforce a well-formed domain name. So '.' or '1.2' are valid.\n * That's ok because the origin comes from a compile-time constant.\n *\n * A regular expression is used instead of goog.uri for several reasons:\n * - Strictness. E.g. we don't want any userinfo component and we don't\n *   want '/./, nor \\' in the first path component.\n * - Small trusted base. goog.uri is generic and might need to change,\n *   reasoning about all the ways it can parse a URL now and in the future\n *   is error-prone.\n * - Code size. We expect many calls to .format(), many of which might\n *   not be using goog.uri.\n * - Simplicity. Using goog.uri would likely not result in simpler nor shorter\n *   code.\n * @private @const {!RegExp}\n */\ngoog.html.TrustedResourceUrl.BASE_URL_ =\n    /^(?:https:)?\\/\\/[0-9a-z.:[\\]-]+\\/|^\\/[^\\/\\\\]/i;\n\n\n/**\n * Creates a TrustedResourceUrl object from a compile-time constant string.\n *\n * Compile-time constant strings are inherently program-controlled and hence\n * trusted.\n *\n * @param {!goog.string.Const} url A compile-time-constant string from which to\n *     create a TrustedResourceUrl.\n * @return {!goog.html.TrustedResourceUrl} A TrustedResourceUrl object\n *     initialized to {@code url}.\n */\ngoog.html.TrustedResourceUrl.fromConstant = function(url) {\n  return goog.html.TrustedResourceUrl\n      .createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(\n          goog.string.Const.unwrap(url));\n};\n\n\n/**\n * Creates a TrustedResourceUrl object from a compile-time constant strings.\n *\n * Compile-time constant strings are inherently program-controlled and hence\n * trusted.\n *\n * @param {!Array<!goog.string.Const>} parts Compile-time-constant strings from\n *     which to create a TrustedResourceUrl.\n * @return {!goog.html.TrustedResourceUrl} A TrustedResourceUrl object\n *     initialized to concatenation of {@code parts}.\n */\ngoog.html.TrustedResourceUrl.fromConstants = function(parts) {\n  var unwrapped = '';\n  for (var i = 0; i < parts.length; i++) {\n    unwrapped += goog.string.Const.unwrap(parts[i]);\n  }\n  return goog.html.TrustedResourceUrl\n      .createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(unwrapped);\n};\n\n\n/**\n * Type marker for the TrustedResourceUrl type, used to implement additional\n * run-time type checking.\n * @const {!Object}\n * @private\n */\ngoog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ = {};\n\n\n/**\n * Package-internal utility method to create TrustedResourceUrl instances.\n *\n * @param {string} url The string to initialize the TrustedResourceUrl object\n *     with.\n * @return {!goog.html.TrustedResourceUrl} The initialized TrustedResourceUrl\n *     object.\n * @package\n */\ngoog.html.TrustedResourceUrl\n    .createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse = function(url) {\n  var trustedResourceUrl = new goog.html.TrustedResourceUrl();\n  trustedResourceUrl.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_ =\n      url;\n  return trustedResourceUrl;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/**\n * @fileoverview The SafeHtml type and its builders.\n *\n * TODO(xtof): Link to document stating type contract.\n */\n\ngoog.provide('goog.html.SafeHtml');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.tags');\ngoog.require('goog.html.SafeScript');\ngoog.require('goog.html.SafeStyle');\ngoog.require('goog.html.SafeStyleSheet');\ngoog.require('goog.html.SafeUrl');\ngoog.require('goog.html.TrustedResourceUrl');\ngoog.require('goog.i18n.bidi.Dir');\ngoog.require('goog.i18n.bidi.DirectionalString');\ngoog.require('goog.labs.userAgent.browser');\ngoog.require('goog.object');\ngoog.require('goog.string');\ngoog.require('goog.string.Const');\ngoog.require('goog.string.TypedString');\n\n\n\n/**\n * A string that is safe to use in HTML context in DOM APIs and HTML documents.\n *\n * A SafeHtml is a string-like object that carries the security type contract\n * that its value as a string will not cause untrusted script execution when\n * evaluated as HTML in a browser.\n *\n * Values of this type are guaranteed to be safe to use in HTML contexts,\n * such as, assignment to the innerHTML DOM property, or interpolation into\n * a HTML template in HTML PC_DATA context, in the sense that the use will not\n * result in a Cross-Site-Scripting vulnerability.\n *\n * Instances of this type must be created via the factory methods\n * ({@code goog.html.SafeHtml.create}, {@code goog.html.SafeHtml.htmlEscape}),\n * etc and not by invoking its constructor.  The constructor intentionally\n * takes no parameters and the type is immutable; hence only a default instance\n * corresponding to the empty string can be obtained via constructor invocation.\n *\n * @see goog.html.SafeHtml#create\n * @see goog.html.SafeHtml#htmlEscape\n * @constructor\n * @final\n * @struct\n * @implements {goog.i18n.bidi.DirectionalString}\n * @implements {goog.string.TypedString}\n */\ngoog.html.SafeHtml = function() {\n  /**\n   * The contained value of this SafeHtml.  The field has a purposely ugly\n   * name to make (non-compiled) code that attempts to directly access this\n   * field stand out.\n   * @private {string}\n   */\n  this.privateDoNotAccessOrElseSafeHtmlWrappedValue_ = '';\n\n  /**\n   * A type marker used to implement additional run-time type checking.\n   * @see goog.html.SafeHtml#unwrap\n   * @const {!Object}\n   * @private\n   */\n  this.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ =\n      goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;\n\n  /**\n   * This SafeHtml's directionality, or null if unknown.\n   * @private {?goog.i18n.bidi.Dir}\n   */\n  this.dir_ = null;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.SafeHtml.prototype.implementsGoogI18nBidiDirectionalString = true;\n\n\n/** @override */\ngoog.html.SafeHtml.prototype.getDirection = function() {\n  return this.dir_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.SafeHtml.prototype.implementsGoogStringTypedString = true;\n\n\n/**\n * Returns this SafeHtml's value as string.\n *\n * IMPORTANT: In code where it is security relevant that an object's type is\n * indeed {@code SafeHtml}, use {@code goog.html.SafeHtml.unwrap} instead of\n * this method. If in doubt, assume that it's security relevant. In particular,\n * note that goog.html functions which return a goog.html type do not guarantee\n * that the returned instance is of the right type. For example:\n *\n * <pre>\n * var fakeSafeHtml = new String('fake');\n * fakeSafeHtml.__proto__ = goog.html.SafeHtml.prototype;\n * var newSafeHtml = goog.html.SafeHtml.htmlEscape(fakeSafeHtml);\n * // newSafeHtml is just an alias for fakeSafeHtml, it's passed through by\n * // goog.html.SafeHtml.htmlEscape() as fakeSafeHtml\n * // instanceof goog.html.SafeHtml.\n * </pre>\n *\n * @see goog.html.SafeHtml#unwrap\n * @override\n */\ngoog.html.SafeHtml.prototype.getTypedStringValue = function() {\n  return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_;\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a debug string-representation of this value.\n   *\n   * To obtain the actual string value wrapped in a SafeHtml, use\n   * {@code goog.html.SafeHtml.unwrap}.\n   *\n   * @see goog.html.SafeHtml#unwrap\n   * @override\n   */\n  goog.html.SafeHtml.prototype.toString = function() {\n    return 'SafeHtml{' + this.privateDoNotAccessOrElseSafeHtmlWrappedValue_ +\n        '}';\n  };\n}\n\n\n/**\n * Performs a runtime check that the provided object is indeed a SafeHtml\n * object, and returns its value.\n * @param {!goog.html.SafeHtml} safeHtml The object to extract from.\n * @return {string} The SafeHtml object's contained string, unless the run-time\n *     type check fails. In that case, {@code unwrap} returns an innocuous\n *     string, or, if assertions are enabled, throws\n *     {@code goog.asserts.AssertionError}.\n */\ngoog.html.SafeHtml.unwrap = function(safeHtml) {\n  // Perform additional run-time type-checking to ensure that safeHtml is indeed\n  // an instance of the expected type.  This provides some additional protection\n  // against security bugs due to application code that disables type checks.\n  // Specifically, the following checks are performed:\n  // 1. The object is an instance of the expected type.\n  // 2. The object is not an instance of a subclass.\n  // 3. The object carries a type marker for the expected type. \"Faking\" an\n  // object requires a reference to the type marker, which has names intended\n  // to stand out in code reviews.\n  if (safeHtml instanceof goog.html.SafeHtml &&\n      safeHtml.constructor === goog.html.SafeHtml &&\n      safeHtml.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ ===\n          goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_) {\n    return safeHtml.privateDoNotAccessOrElseSafeHtmlWrappedValue_;\n  } else {\n    goog.asserts.fail('expected object of type SafeHtml, got \\'' +\n        safeHtml + '\\' of type ' + goog.typeOf(safeHtml));\n    return 'type_error:SafeHtml';\n  }\n};\n\n\n/**\n * Shorthand for union of types that can sensibly be converted to strings\n * or might already be SafeHtml (as SafeHtml is a goog.string.TypedString).\n * @private\n * @typedef {string|number|boolean|!goog.string.TypedString|\n *           !goog.i18n.bidi.DirectionalString}\n */\ngoog.html.SafeHtml.TextOrHtml_;\n\n\n/**\n * Returns HTML-escaped text as a SafeHtml object.\n *\n * If text is of a type that implements\n * {@code goog.i18n.bidi.DirectionalString}, the directionality of the new\n * {@code SafeHtml} object is set to {@code text}'s directionality, if known.\n * Otherwise, the directionality of the resulting SafeHtml is unknown (i.e.,\n * {@code null}).\n *\n * @param {!goog.html.SafeHtml.TextOrHtml_} textOrHtml The text to escape. If\n *     the parameter is of type SafeHtml it is returned directly (no escaping\n *     is done).\n * @return {!goog.html.SafeHtml} The escaped text, wrapped as a SafeHtml.\n */\ngoog.html.SafeHtml.htmlEscape = function(textOrHtml) {\n  if (textOrHtml instanceof goog.html.SafeHtml) {\n    return textOrHtml;\n  }\n  var dir = null;\n  if (textOrHtml.implementsGoogI18nBidiDirectionalString) {\n    dir = textOrHtml.getDirection();\n  }\n  var textAsString;\n  if (textOrHtml.implementsGoogStringTypedString) {\n    textAsString = textOrHtml.getTypedStringValue();\n  } else {\n    textAsString = String(textOrHtml);\n  }\n  return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n      goog.string.htmlEscape(textAsString), dir);\n};\n\n\n/**\n * Returns HTML-escaped text as a SafeHtml object, with newlines changed to\n * &lt;br&gt;.\n * @param {!goog.html.SafeHtml.TextOrHtml_} textOrHtml The text to escape. If\n *     the parameter is of type SafeHtml it is returned directly (no escaping\n *     is done).\n * @return {!goog.html.SafeHtml} The escaped text, wrapped as a SafeHtml.\n */\ngoog.html.SafeHtml.htmlEscapePreservingNewlines = function(textOrHtml) {\n  if (textOrHtml instanceof goog.html.SafeHtml) {\n    return textOrHtml;\n  }\n  var html = goog.html.SafeHtml.htmlEscape(textOrHtml);\n  return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n      goog.string.newLineToBr(goog.html.SafeHtml.unwrap(html)),\n      html.getDirection());\n};\n\n\n/**\n * Returns HTML-escaped text as a SafeHtml object, with newlines changed to\n * &lt;br&gt; and escaping whitespace to preserve spatial formatting. Character\n * entity #160 is used to make it safer for XML.\n * @param {!goog.html.SafeHtml.TextOrHtml_} textOrHtml The text to escape. If\n *     the parameter is of type SafeHtml it is returned directly (no escaping\n *     is done).\n * @return {!goog.html.SafeHtml} The escaped text, wrapped as a SafeHtml.\n */\ngoog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces = function(\n    textOrHtml) {\n  if (textOrHtml instanceof goog.html.SafeHtml) {\n    return textOrHtml;\n  }\n  var html = goog.html.SafeHtml.htmlEscape(textOrHtml);\n  return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n      goog.string.whitespaceEscape(goog.html.SafeHtml.unwrap(html)),\n      html.getDirection());\n};\n\n\n/**\n * Coerces an arbitrary object into a SafeHtml object.\n *\n * If {@code textOrHtml} is already of type {@code goog.html.SafeHtml}, the same\n * object is returned. Otherwise, {@code textOrHtml} is coerced to string, and\n * HTML-escaped. If {@code textOrHtml} is of a type that implements\n * {@code goog.i18n.bidi.DirectionalString}, its directionality, if known, is\n * preserved.\n *\n * @param {!goog.html.SafeHtml.TextOrHtml_} textOrHtml The text or SafeHtml to\n *     coerce.\n * @return {!goog.html.SafeHtml} The resulting SafeHtml object.\n * @deprecated Use goog.html.SafeHtml.htmlEscape.\n */\ngoog.html.SafeHtml.from = goog.html.SafeHtml.htmlEscape;\n\n\n/**\n * @const\n * @private\n */\ngoog.html.SafeHtml.VALID_NAMES_IN_TAG_ = /^[a-zA-Z0-9-]+$/;\n\n\n/**\n * Set of attributes containing URL as defined at\n * http://www.w3.org/TR/html5/index.html#attributes-1.\n * @private @const {!Object<string,boolean>}\n */\ngoog.html.SafeHtml.URL_ATTRIBUTES_ = goog.object.createSet(\n    'action', 'cite', 'data', 'formaction', 'href', 'manifest', 'poster',\n    'src');\n\n\n/**\n * Tags which are unsupported via create(). They might be supported via a\n * tag-specific create method. These are tags which might require a\n * TrustedResourceUrl in one of their attributes or a restricted type for\n * their content.\n * @private @const {!Object<string,boolean>}\n */\ngoog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_ = goog.object.createSet(\n    goog.dom.TagName.APPLET, goog.dom.TagName.BASE, goog.dom.TagName.EMBED,\n    goog.dom.TagName.IFRAME, goog.dom.TagName.LINK, goog.dom.TagName.MATH,\n    goog.dom.TagName.META, goog.dom.TagName.OBJECT, goog.dom.TagName.SCRIPT,\n    goog.dom.TagName.STYLE, goog.dom.TagName.SVG, goog.dom.TagName.TEMPLATE);\n\n\n/**\n * @typedef {string|number|goog.string.TypedString|\n *     goog.html.SafeStyle.PropertyMap}\n */\ngoog.html.SafeHtml.AttributeValue;\n\n\n/**\n * Creates a SafeHtml content consisting of a tag with optional attributes and\n * optional content.\n *\n * For convenience tag names and attribute names are accepted as regular\n * strings, instead of goog.string.Const. Nevertheless, you should not pass\n * user-controlled values to these parameters. Note that these parameters are\n * syntactically validated at runtime, and invalid values will result in\n * an exception.\n *\n * Example usage:\n *\n * goog.html.SafeHtml.create('br');\n * goog.html.SafeHtml.create('div', {'class': 'a'});\n * goog.html.SafeHtml.create('p', {}, 'a');\n * goog.html.SafeHtml.create('p', {}, goog.html.SafeHtml.create('br'));\n *\n * goog.html.SafeHtml.create('span', {\n *   'style': {'margin': '0'}\n * });\n *\n * To guarantee SafeHtml's type contract is upheld there are restrictions on\n * attribute values and tag names.\n *\n * - For attributes which contain script code (on*), a goog.string.Const is\n *   required.\n * - For attributes which contain style (style), a goog.html.SafeStyle or a\n *   goog.html.SafeStyle.PropertyMap is required.\n * - For attributes which are interpreted as URLs (e.g. src, href) a\n *   goog.html.SafeUrl, goog.string.Const or string is required. If a string\n *   is passed, it will be sanitized with SafeUrl.sanitize().\n * - For tags which can load code or set security relevant page metadata,\n *   more specific goog.html.SafeHtml.create*() functions must be used. Tags\n *   which are not supported by this function are applet, base, embed, iframe,\n *   link, math, object, script, style, svg, and template.\n *\n * @param {!goog.dom.TagName|string} tagName The name of the tag. Only tag names\n *     consisting of [a-zA-Z0-9-] are allowed. Tag names documented above are\n *     disallowed.\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n *     Mapping from attribute names to their values. Only attribute names\n *     consisting of [a-zA-Z0-9-] are allowed. Value of null or undefined causes\n *     the attribute to be omitted.\n * @param {!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>=} opt_content Content to\n *     HTML-escape and put inside the tag. This must be empty for void tags\n *     like <br>. Array elements are concatenated.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n * @throws {Error} If invalid tag name, attribute name, or attribute value is\n *     provided.\n * @throws {goog.asserts.AssertionError} If content for void tag is provided.\n */\ngoog.html.SafeHtml.create = function(tagName, opt_attributes, opt_content) {\n  goog.html.SafeHtml.verifyTagName(String(tagName));\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      String(tagName), opt_attributes, opt_content);\n};\n\n\n/**\n * Verifies if the tag name is valid and if it doesn't change the context.\n * E.g. STRONG is fine but SCRIPT throws because it changes context. See\n * goog.html.SafeHtml.create for an explanation of allowed tags.\n * @param {string} tagName\n * @throws {Error} If invalid tag name is provided.\n * @package\n */\ngoog.html.SafeHtml.verifyTagName = function(tagName) {\n  if (!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(tagName)) {\n    throw Error('Invalid tag name <' + tagName + '>.');\n  }\n  if (tagName.toUpperCase() in goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_) {\n    throw Error('Tag name <' + tagName + '> is not allowed for SafeHtml.');\n  }\n};\n\n\n/**\n * Creates a SafeHtml representing an iframe tag.\n *\n * This by default restricts the iframe as much as possible by setting the\n * sandbox attribute to the empty string. If the iframe requires less\n * restrictions, set the sandbox attribute as tight as possible, but do not rely\n * on the sandbox as a security feature because it is not supported by older\n * browsers. If a sandbox is essential to security (e.g. for third-party\n * frames), use createSandboxIframe which checks for browser support.\n *\n * @see https://developer.mozilla.org/en/docs/Web/HTML/Element/iframe#attr-sandbox\n *\n * @param {?goog.html.TrustedResourceUrl=} opt_src The value of the src\n *     attribute. If null or undefined src will not be set.\n * @param {?goog.html.SafeHtml=} opt_srcdoc The value of the srcdoc attribute.\n *     If null or undefined srcdoc will not be set.\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n *     Mapping from attribute names to their values. Only attribute names\n *     consisting of [a-zA-Z0-9-] are allowed. Value of null or undefined causes\n *     the attribute to be omitted.\n * @param {!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>=} opt_content Content to\n *     HTML-escape and put inside the tag. Array elements are concatenated.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n * @throws {Error} If invalid tag name, attribute name, or attribute value is\n *     provided. If opt_attributes contains the src or srcdoc attributes.\n */\ngoog.html.SafeHtml.createIframe = function(\n    opt_src, opt_srcdoc, opt_attributes, opt_content) {\n  if (opt_src) {\n    // Check whether this is really TrustedResourceUrl.\n    goog.html.TrustedResourceUrl.unwrap(opt_src);\n  }\n\n  var fixedAttributes = {};\n  fixedAttributes['src'] = opt_src || null;\n  fixedAttributes['srcdoc'] =\n      opt_srcdoc && goog.html.SafeHtml.unwrap(opt_srcdoc);\n  var defaultAttributes = {'sandbox': ''};\n  var attributes = goog.html.SafeHtml.combineAttributes(\n      fixedAttributes, defaultAttributes, opt_attributes);\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      'iframe', attributes, opt_content);\n};\n\n\n/**\n * Creates a SafeHtml representing a sandboxed iframe tag.\n *\n * The sandbox attribute is enforced in its most restrictive mode, an empty\n * string. Consequently, the security requirements for the src and srcdoc\n * attributes are relaxed compared to SafeHtml.createIframe. This function\n * will throw on browsers that do not support the sandbox attribute, as\n * determined by SafeHtml.canUseSandboxIframe.\n *\n * The SafeHtml returned by this function can trigger downloads with no\n * user interaction on Chrome (though only a few, further attempts are blocked).\n * Firefox and IE will block all downloads from the sandbox.\n *\n * @see https://developer.mozilla.org/en/docs/Web/HTML/Element/iframe#attr-sandbox\n * @see https://lists.w3.org/Archives/Public/public-whatwg-archive/2013Feb/0112.html\n *\n * @param {string|!goog.html.SafeUrl=} opt_src The value of the src\n *     attribute. If null or undefined src will not be set.\n * @param {string=} opt_srcdoc The value of the srcdoc attribute.\n *     If null or undefined srcdoc will not be set. Will not be sanitized.\n * @param {!Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n *     Mapping from attribute names to their values. Only attribute names\n *     consisting of [a-zA-Z0-9-] are allowed. Value of null or undefined causes\n *     the attribute to be omitted.\n * @param {!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>=} opt_content Content to\n *     HTML-escape and put inside the tag. Array elements are concatenated.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n * @throws {Error} If invalid tag name, attribute name, or attribute value is\n *     provided. If opt_attributes contains the src, srcdoc or sandbox\n *     attributes. If browser does not support the sandbox attribute on iframe.\n */\ngoog.html.SafeHtml.createSandboxIframe = function(\n    opt_src, opt_srcdoc, opt_attributes, opt_content) {\n  if (!goog.html.SafeHtml.canUseSandboxIframe()) {\n    throw new Error('The browser does not support sandboxed iframes.');\n  }\n\n  var fixedAttributes = {};\n  if (opt_src) {\n    // Note that sanitize is a no-op on SafeUrl.\n    fixedAttributes['src'] =\n        goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(opt_src));\n  } else {\n    fixedAttributes['src'] = null;\n  }\n  fixedAttributes['srcdoc'] = opt_srcdoc || null;\n  fixedAttributes['sandbox'] = '';\n  var attributes =\n      goog.html.SafeHtml.combineAttributes(fixedAttributes, {}, opt_attributes);\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      'iframe', attributes, opt_content);\n};\n\n\n/**\n * Checks if the user agent supports sandboxed iframes.\n * @return {boolean}\n */\ngoog.html.SafeHtml.canUseSandboxIframe = function() {\n  return goog.global['HTMLIFrameElement'] &&\n      ('sandbox' in goog.global['HTMLIFrameElement'].prototype);\n};\n\n\n/**\n * Creates a SafeHtml representing a script tag with the src attribute.\n * @param {!goog.html.TrustedResourceUrl} src The value of the src\n * attribute.\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=}\n * opt_attributes\n *     Mapping from attribute names to their values. Only attribute names\n *     consisting of [a-zA-Z0-9-] are allowed. Value of null or undefined\n *     causes the attribute to be omitted.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n * @throws {Error} If invalid attribute name or value is provided. If\n *     opt_attributes contains the src attribute.\n */\ngoog.html.SafeHtml.createScriptSrc = function(src, opt_attributes) {\n  // TODO(mlourenco): The charset attribute should probably be blocked. If\n  // its value is attacker controlled, the script contains attacker controlled\n  // sub-strings (even if properly escaped) and the server does not set charset\n  // then XSS is likely possible.\n  // https://html.spec.whatwg.org/multipage/scripting.html#dom-script-charset\n\n  // Check whether this is really TrustedResourceUrl.\n  goog.html.TrustedResourceUrl.unwrap(src);\n\n  var fixedAttributes = {'src': src};\n  var defaultAttributes = {};\n  var attributes = goog.html.SafeHtml.combineAttributes(\n      fixedAttributes, defaultAttributes, opt_attributes);\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      'script', attributes);\n};\n\n\n/**\n * Creates a SafeHtml representing a script tag. Does not allow the language,\n * src, text or type attributes to be set.\n * @param {!goog.html.SafeScript|!Array<!goog.html.SafeScript>}\n *     script Content to put inside the tag. Array elements are\n *     concatenated.\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n *     Mapping from attribute names to their values. Only attribute names\n *     consisting of [a-zA-Z0-9-] are allowed. Value of null or undefined causes\n *     the attribute to be omitted.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n * @throws {Error} If invalid attribute name or attribute value is provided. If\n *     opt_attributes contains the language, src, text or type attribute.\n */\ngoog.html.SafeHtml.createScript = function(script, opt_attributes) {\n  for (var attr in opt_attributes) {\n    var attrLower = attr.toLowerCase();\n    if (attrLower == 'language' || attrLower == 'src' || attrLower == 'text' ||\n        attrLower == 'type') {\n      throw Error('Cannot set \"' + attrLower + '\" attribute');\n    }\n  }\n\n  var content = '';\n  script = goog.array.concat(script);\n  for (var i = 0; i < script.length; i++) {\n    content += goog.html.SafeScript.unwrap(script[i]);\n  }\n  // Convert to SafeHtml so that it's not HTML-escaped. This is safe because\n  // as part of its contract, SafeScript should have no dangerous '<'.\n  var htmlContent =\n      goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n          content, goog.i18n.bidi.Dir.NEUTRAL);\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      'script', opt_attributes, htmlContent);\n};\n\n\n/**\n * Creates a SafeHtml representing a style tag. The type attribute is set\n * to \"text/css\".\n * @param {!goog.html.SafeStyleSheet|!Array<!goog.html.SafeStyleSheet>}\n *     styleSheet Content to put inside the tag. Array elements are\n *     concatenated.\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n *     Mapping from attribute names to their values. Only attribute names\n *     consisting of [a-zA-Z0-9-] are allowed. Value of null or undefined causes\n *     the attribute to be omitted.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n * @throws {Error} If invalid attribute name or attribute value is provided. If\n *     opt_attributes contains the type attribute.\n */\ngoog.html.SafeHtml.createStyle = function(styleSheet, opt_attributes) {\n  var fixedAttributes = {'type': 'text/css'};\n  var defaultAttributes = {};\n  var attributes = goog.html.SafeHtml.combineAttributes(\n      fixedAttributes, defaultAttributes, opt_attributes);\n\n  var content = '';\n  styleSheet = goog.array.concat(styleSheet);\n  for (var i = 0; i < styleSheet.length; i++) {\n    content += goog.html.SafeStyleSheet.unwrap(styleSheet[i]);\n  }\n  // Convert to SafeHtml so that it's not HTML-escaped. This is safe because\n  // as part of its contract, SafeStyleSheet should have no dangerous '<'.\n  var htmlContent =\n      goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n          content, goog.i18n.bidi.Dir.NEUTRAL);\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      'style', attributes, htmlContent);\n};\n\n\n/**\n * Creates a SafeHtml representing a meta refresh tag.\n * @param {!goog.html.SafeUrl|string} url Where to redirect. If a string is\n *     passed, it will be sanitized with SafeUrl.sanitize().\n * @param {number=} opt_secs Number of seconds until the page should be\n *     reloaded. Will be set to 0 if unspecified.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n */\ngoog.html.SafeHtml.createMetaRefresh = function(url, opt_secs) {\n\n  // Note that sanitize is a no-op on SafeUrl.\n  var unwrappedUrl = goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(url));\n\n  if (goog.labs.userAgent.browser.isIE() ||\n      goog.labs.userAgent.browser.isEdge()) {\n    // IE/EDGE can't parse the content attribute if the url contains a\n    // semicolon. We can fix this by adding quotes around the url, but then we\n    // can't parse quotes in the URL correctly. Also, it seems that IE/EDGE\n    // did not unescape semicolons in these URLs at some point in the past. We\n    // take a best-effort approach.\n    //\n    // If the URL has semicolons (which may happen in some cases, see\n    // http://www.w3.org/TR/1999/REC-html401-19991224/appendix/notes.html#h-B.2\n    // for instance), wrap it in single quotes to protect the semicolons.\n    // If the URL has semicolons and single quotes, url-encode the single quotes\n    // as well.\n    //\n    // This is imperfect. Notice that both ' and ; are reserved characters in\n    // URIs, so this could do the wrong thing, but at least it will do the wrong\n    // thing in only rare cases.\n    if (goog.string.contains(unwrappedUrl, ';')) {\n      unwrappedUrl = \"'\" + unwrappedUrl.replace(/'/g, '%27') + \"'\";\n    }\n  }\n  var attributes = {\n    'http-equiv': 'refresh',\n    'content': (opt_secs || 0) + '; url=' + unwrappedUrl\n  };\n\n  // This function will handle the HTML escaping for attributes.\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      'meta', attributes);\n};\n\n\n/**\n * @param {string} tagName The tag name.\n * @param {string} name The attribute name.\n * @param {!goog.html.SafeHtml.AttributeValue} value The attribute value.\n * @return {string} A \"name=value\" string.\n * @throws {Error} If attribute value is unsafe for the given tag and attribute.\n * @private\n */\ngoog.html.SafeHtml.getAttrNameAndValue_ = function(tagName, name, value) {\n  // If it's goog.string.Const, allow any valid attribute name.\n  if (value instanceof goog.string.Const) {\n    value = goog.string.Const.unwrap(value);\n  } else if (name.toLowerCase() == 'style') {\n    value = goog.html.SafeHtml.getStyleValue_(value);\n  } else if (/^on/i.test(name)) {\n    // TODO(jakubvrana): Disallow more attributes with a special meaning.\n    throw Error(\n        'Attribute \"' + name + '\" requires goog.string.Const value, \"' + value +\n        '\" given.');\n    // URL attributes handled differently according to tag.\n  } else if (name.toLowerCase() in goog.html.SafeHtml.URL_ATTRIBUTES_) {\n    if (value instanceof goog.html.TrustedResourceUrl) {\n      value = goog.html.TrustedResourceUrl.unwrap(value);\n    } else if (value instanceof goog.html.SafeUrl) {\n      value = goog.html.SafeUrl.unwrap(value);\n    } else if (goog.isString(value)) {\n      value = goog.html.SafeUrl.sanitize(value).getTypedStringValue();\n    } else {\n      throw Error(\n          'Attribute \"' + name + '\" on tag \"' + tagName +\n          '\" requires goog.html.SafeUrl, goog.string.Const, or string,' +\n          ' value \"' + value + '\" given.');\n    }\n  }\n\n  // Accept SafeUrl, TrustedResourceUrl, etc. for attributes which only require\n  // HTML-escaping.\n  if (value.implementsGoogStringTypedString) {\n    // Ok to call getTypedStringValue() since there's no reliance on the type\n    // contract for security here.\n    value = value.getTypedStringValue();\n  }\n\n  goog.asserts.assert(\n      goog.isString(value) || goog.isNumber(value),\n      'String or number value expected, got ' + (typeof value) +\n          ' with value: ' + value);\n  return name + '=\"' + goog.string.htmlEscape(String(value)) + '\"';\n};\n\n\n/**\n * Gets value allowed in \"style\" attribute.\n * @param {!goog.html.SafeHtml.AttributeValue} value It could be SafeStyle or a\n *     map which will be passed to goog.html.SafeStyle.create.\n * @return {string} Unwrapped value.\n * @throws {Error} If string value is given.\n * @private\n */\ngoog.html.SafeHtml.getStyleValue_ = function(value) {\n  if (!goog.isObject(value)) {\n    throw Error(\n        'The \"style\" attribute requires goog.html.SafeStyle or map ' +\n        'of style properties, ' + (typeof value) + ' given: ' + value);\n  }\n  if (!(value instanceof goog.html.SafeStyle)) {\n    // Process the property bag into a style object.\n    value = goog.html.SafeStyle.create(value);\n  }\n  return goog.html.SafeStyle.unwrap(value);\n};\n\n\n/**\n * Creates a SafeHtml content with known directionality consisting of a tag with\n * optional attributes and optional content.\n * @param {!goog.i18n.bidi.Dir} dir Directionality.\n * @param {string} tagName\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n * @param {!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>=} opt_content\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n */\ngoog.html.SafeHtml.createWithDir = function(\n    dir, tagName, opt_attributes, opt_content) {\n  var html = goog.html.SafeHtml.create(tagName, opt_attributes, opt_content);\n  html.dir_ = dir;\n  return html;\n};\n\n\n/**\n * Creates a new SafeHtml object by concatenating values.\n * @param {...(!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>)} var_args Values to concatenate.\n * @return {!goog.html.SafeHtml}\n */\ngoog.html.SafeHtml.concat = function(var_args) {\n  var dir = goog.i18n.bidi.Dir.NEUTRAL;\n  var content = '';\n\n  /**\n   * @param {!goog.html.SafeHtml.TextOrHtml_|\n   *     !Array<!goog.html.SafeHtml.TextOrHtml_>} argument\n   */\n  var addArgument = function(argument) {\n    if (goog.isArray(argument)) {\n      goog.array.forEach(argument, addArgument);\n    } else {\n      var html = goog.html.SafeHtml.htmlEscape(argument);\n      content += goog.html.SafeHtml.unwrap(html);\n      var htmlDir = html.getDirection();\n      if (dir == goog.i18n.bidi.Dir.NEUTRAL) {\n        dir = htmlDir;\n      } else if (htmlDir != goog.i18n.bidi.Dir.NEUTRAL && dir != htmlDir) {\n        dir = null;\n      }\n    }\n  };\n\n  goog.array.forEach(arguments, addArgument);\n  return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n      content, dir);\n};\n\n\n/**\n * Creates a new SafeHtml object with known directionality by concatenating the\n * values.\n * @param {!goog.i18n.bidi.Dir} dir Directionality.\n * @param {...(!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>)} var_args Elements of array\n *     arguments would be processed recursively.\n * @return {!goog.html.SafeHtml}\n */\ngoog.html.SafeHtml.concatWithDir = function(dir, var_args) {\n  var html = goog.html.SafeHtml.concat(goog.array.slice(arguments, 1));\n  html.dir_ = dir;\n  return html;\n};\n\n\n/**\n * Type marker for the SafeHtml type, used to implement additional run-time\n * type checking.\n * @const {!Object}\n * @private\n */\ngoog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ = {};\n\n\n/**\n * Package-internal utility method to create SafeHtml instances.\n *\n * @param {string} html The string to initialize the SafeHtml object with.\n * @param {?goog.i18n.bidi.Dir} dir The directionality of the SafeHtml to be\n *     constructed, or null if unknown.\n * @return {!goog.html.SafeHtml} The initialized SafeHtml object.\n * @package\n */\ngoog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse = function(\n    html, dir) {\n  return new goog.html.SafeHtml().initSecurityPrivateDoNotAccessOrElse_(\n      html, dir);\n};\n\n\n/**\n * Called from createSafeHtmlSecurityPrivateDoNotAccessOrElse(). This\n * method exists only so that the compiler can dead code eliminate static\n * fields (like EMPTY) when they're not accessed.\n * @param {string} html\n * @param {?goog.i18n.bidi.Dir} dir\n * @return {!goog.html.SafeHtml}\n * @private\n */\ngoog.html.SafeHtml.prototype.initSecurityPrivateDoNotAccessOrElse_ = function(\n    html, dir) {\n  this.privateDoNotAccessOrElseSafeHtmlWrappedValue_ = html;\n  this.dir_ = dir;\n  return this;\n};\n\n\n/**\n * Like create() but does not restrict which tags can be constructed.\n *\n * @param {string} tagName Tag name. Set or validated by caller.\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n * @param {(!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>)=} opt_content\n * @return {!goog.html.SafeHtml}\n * @throws {Error} If invalid or unsafe attribute name or value is provided.\n * @throws {goog.asserts.AssertionError} If content for void tag is provided.\n * @package\n */\ngoog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse = function(\n    tagName, opt_attributes, opt_content) {\n  var dir = null;\n  var result = '<' + tagName;\n  result += goog.html.SafeHtml.stringifyAttributes(tagName, opt_attributes);\n\n  var content = opt_content;\n  if (!goog.isDefAndNotNull(content)) {\n    content = [];\n  } else if (!goog.isArray(content)) {\n    content = [content];\n  }\n\n  if (goog.dom.tags.isVoidTag(tagName.toLowerCase())) {\n    goog.asserts.assert(\n        !content.length, 'Void tag <' + tagName + '> does not allow content.');\n    result += '>';\n  } else {\n    var html = goog.html.SafeHtml.concat(content);\n    result += '>' + goog.html.SafeHtml.unwrap(html) + '</' + tagName + '>';\n    dir = html.getDirection();\n  }\n\n  var dirAttribute = opt_attributes && opt_attributes['dir'];\n  if (dirAttribute) {\n    if (/^(ltr|rtl|auto)$/i.test(dirAttribute)) {\n      // If the tag has the \"dir\" attribute specified then its direction is\n      // neutral because it can be safely used in any context.\n      dir = goog.i18n.bidi.Dir.NEUTRAL;\n    } else {\n      dir = null;\n    }\n  }\n\n  return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n      result, dir);\n};\n\n\n/**\n * Creates a string with attributes to insert after tagName.\n * @param {string} tagName\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n * @return {string} Returns an empty string if there are no attributes, returns\n *     a string starting with a space otherwise.\n * @throws {Error} If attribute value is unsafe for the given tag and attribute.\n * @package\n */\ngoog.html.SafeHtml.stringifyAttributes = function(tagName, opt_attributes) {\n  var result = '';\n  if (opt_attributes) {\n    for (var name in opt_attributes) {\n      if (!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(name)) {\n        throw Error('Invalid attribute name \"' + name + '\".');\n      }\n      var value = opt_attributes[name];\n      if (!goog.isDefAndNotNull(value)) {\n        continue;\n      }\n      result +=\n          ' ' + goog.html.SafeHtml.getAttrNameAndValue_(tagName, name, value);\n    }\n  }\n  return result;\n};\n\n\n/**\n * @param {!Object<string, string>} fixedAttributes\n * @param {!Object<string, string>} defaultAttributes\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n *     Optional attributes passed to create*().\n * @return {!Object<string, ?goog.html.SafeHtml.AttributeValue>}\n * @throws {Error} If opt_attributes contains an attribute with the same name\n *     as an attribute in fixedAttributes.\n * @package\n */\ngoog.html.SafeHtml.combineAttributes = function(\n    fixedAttributes, defaultAttributes, opt_attributes) {\n  var combinedAttributes = {};\n  var name;\n\n  for (name in fixedAttributes) {\n    goog.asserts.assert(name.toLowerCase() == name, 'Must be lower case');\n    combinedAttributes[name] = fixedAttributes[name];\n  }\n  for (name in defaultAttributes) {\n    goog.asserts.assert(name.toLowerCase() == name, 'Must be lower case');\n    combinedAttributes[name] = defaultAttributes[name];\n  }\n\n  for (name in opt_attributes) {\n    var nameLower = name.toLowerCase();\n    if (nameLower in fixedAttributes) {\n      throw Error(\n          'Cannot override \"' + nameLower + '\" attribute, got \"' + name +\n          '\" with value \"' + opt_attributes[name] + '\"');\n    }\n    if (nameLower in defaultAttributes) {\n      delete combinedAttributes[nameLower];\n    }\n    combinedAttributes[name] = opt_attributes[name];\n  }\n\n  return combinedAttributes;\n};\n\n\n/**\n * A SafeHtml instance corresponding to the HTML doctype: \"<!DOCTYPE html>\".\n * @const {!goog.html.SafeHtml}\n */\ngoog.html.SafeHtml.DOCTYPE_HTML =\n    goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n        '<!DOCTYPE html>', goog.i18n.bidi.Dir.NEUTRAL);\n\n\n/**\n * A SafeHtml instance corresponding to the empty string.\n * @const {!goog.html.SafeHtml}\n */\ngoog.html.SafeHtml.EMPTY =\n    goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n        '', goog.i18n.bidi.Dir.NEUTRAL);\n\n\n/**\n * A SafeHtml instance corresponding to the <br> tag.\n * @const {!goog.html.SafeHtml}\n */\ngoog.html.SafeHtml.BR =\n    goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n        '<br>', goog.i18n.bidi.Dir.NEUTRAL);\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Type-safe wrappers for unsafe DOM APIs.\n *\n * This file provides type-safe wrappers for DOM APIs that can result in\n * cross-site scripting (XSS) vulnerabilities, if the API is supplied with\n * untrusted (attacker-controlled) input.  Instead of plain strings, the type\n * safe wrappers consume values of types from the goog.html package whose\n * contract promises that values are safe to use in the corresponding context.\n *\n * Hence, a program that exclusively uses the wrappers in this file (i.e., whose\n * only reference to security-sensitive raw DOM APIs are in this file) is\n * guaranteed to be free of XSS due to incorrect use of such DOM APIs (modulo\n * correctness of code that produces values of the respective goog.html types,\n * and absent code that violates type safety).\n *\n * For example, assigning to an element's .innerHTML property a string that is\n * derived (even partially) from untrusted input typically results in an XSS\n * vulnerability. The type-safe wrapper goog.dom.safe.setInnerHtml consumes a\n * value of type goog.html.SafeHtml, whose contract states that using its values\n * in a HTML context will not result in XSS. Hence a program that is free of\n * direct assignments to any element's innerHTML property (with the exception of\n * the assignment to .innerHTML in this file) is guaranteed to be free of XSS\n * due to assignment of untrusted strings to the innerHTML property.\n */\n\ngoog.provide('goog.dom.safe');\ngoog.provide('goog.dom.safe.InsertAdjacentHtmlPosition');\n\ngoog.require('goog.asserts');\ngoog.require('goog.html.SafeHtml');\ngoog.require('goog.html.SafeStyle');\ngoog.require('goog.html.SafeUrl');\ngoog.require('goog.html.TrustedResourceUrl');\ngoog.require('goog.string');\ngoog.require('goog.string.Const');\n\n\n/** @enum {string} */\ngoog.dom.safe.InsertAdjacentHtmlPosition = {\n  AFTERBEGIN: 'afterbegin',\n  AFTEREND: 'afterend',\n  BEFOREBEGIN: 'beforebegin',\n  BEFOREEND: 'beforeend'\n};\n\n\n/**\n * Inserts known-safe HTML into a Node, at the specified position.\n * @param {!Node} node The node on which to call insertAdjacentHTML.\n * @param {!goog.dom.safe.InsertAdjacentHtmlPosition} position Position where\n *     to insert the HTML.\n * @param {!goog.html.SafeHtml} html The known-safe HTML to insert.\n */\ngoog.dom.safe.insertAdjacentHtml = function(node, position, html) {\n  node.insertAdjacentHTML(position, goog.html.SafeHtml.unwrap(html));\n};\n\n\n/**\n * Tags not allowed in goog.dom.safe.setInnerHtml.\n * @private @const {!Object<string, boolean>}\n */\ngoog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_ = {\n  'MATH': true,\n  'SCRIPT': true,\n  'STYLE': true,\n  'SVG': true,\n  'TEMPLATE': true\n};\n\n\n/**\n * Assigns known-safe HTML to an element's innerHTML property.\n * @param {!Element} elem The element whose innerHTML is to be assigned to.\n * @param {!goog.html.SafeHtml} html The known-safe HTML to assign.\n * @throws {Error} If called with one of these tags: math, script, style, svg,\n *     template.\n */\ngoog.dom.safe.setInnerHtml = function(elem, html) {\n  if (goog.asserts.ENABLE_ASSERTS) {\n    var tagName = elem.tagName.toUpperCase();\n    if (goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_[tagName]) {\n      throw Error(\n          'goog.dom.safe.setInnerHtml cannot be used to set content of ' +\n          elem.tagName + '.');\n    }\n  }\n  elem.innerHTML = goog.html.SafeHtml.unwrap(html);\n};\n\n\n/**\n * Assigns known-safe HTML to an element's outerHTML property.\n * @param {!Element} elem The element whose outerHTML is to be assigned to.\n * @param {!goog.html.SafeHtml} html The known-safe HTML to assign.\n */\ngoog.dom.safe.setOuterHtml = function(elem, html) {\n  elem.outerHTML = goog.html.SafeHtml.unwrap(html);\n};\n\n\n/**\n * Sets the given element's style property to the contents of the provided\n * SafeStyle object.\n * @param {!Element} elem\n * @param {!goog.html.SafeStyle} style\n */\ngoog.dom.safe.setStyle = function(elem, style) {\n  elem.style.cssText = goog.html.SafeStyle.unwrap(style);\n};\n\n\n/**\n * Writes known-safe HTML to a document.\n * @param {!Document} doc The document to be written to.\n * @param {!goog.html.SafeHtml} html The known-safe HTML to assign.\n */\ngoog.dom.safe.documentWrite = function(doc, html) {\n  doc.write(goog.html.SafeHtml.unwrap(html));\n};\n\n\n/**\n * Safely assigns a URL to an anchor element's href property.\n *\n * If url is of type goog.html.SafeUrl, its value is unwrapped and assigned to\n * anchor's href property.  If url is of type string however, it is first\n * sanitized using goog.html.SafeUrl.sanitize.\n *\n * Example usage:\n *   goog.dom.safe.setAnchorHref(anchorEl, url);\n * which is a safe alternative to\n *   anchorEl.href = url;\n * The latter can result in XSS vulnerabilities if url is a\n * user-/attacker-controlled value.\n *\n * @param {!HTMLAnchorElement} anchor The anchor element whose href property\n *     is to be assigned to.\n * @param {string|!goog.html.SafeUrl} url The URL to assign.\n * @see goog.html.SafeUrl#sanitize\n */\ngoog.dom.safe.setAnchorHref = function(anchor, url) {\n  goog.dom.safe.assertIsHTMLAnchorElement_(anchor);\n  /** @type {!goog.html.SafeUrl} */\n  var safeUrl;\n  if (url instanceof goog.html.SafeUrl) {\n    safeUrl = url;\n  } else {\n    safeUrl = goog.html.SafeUrl.sanitize(url);\n  }\n  anchor.href = goog.html.SafeUrl.unwrap(safeUrl);\n};\n\n\n/**\n * Safely assigns a URL to an image element's src property.\n *\n * If url is of type goog.html.SafeUrl, its value is unwrapped and assigned to\n * image's src property.  If url is of type string however, it is first\n * sanitized using goog.html.SafeUrl.sanitize.\n *\n * @param {!HTMLImageElement} imageElement The image element whose src property\n *     is to be assigned to.\n * @param {string|!goog.html.SafeUrl} url The URL to assign.\n * @see goog.html.SafeUrl#sanitize\n */\ngoog.dom.safe.setImageSrc = function(imageElement, url) {\n  goog.dom.safe.assertIsHTMLImageElement_(imageElement);\n  /** @type {!goog.html.SafeUrl} */\n  var safeUrl;\n  if (url instanceof goog.html.SafeUrl) {\n    safeUrl = url;\n  } else {\n    safeUrl = goog.html.SafeUrl.sanitize(url);\n  }\n  imageElement.src = goog.html.SafeUrl.unwrap(safeUrl);\n};\n\n\n/**\n * Safely assigns a URL to an embed element's src property.\n *\n * Example usage:\n *   goog.dom.safe.setEmbedSrc(embedEl, url);\n * which is a safe alternative to\n *   embedEl.src = url;\n * The latter can result in loading untrusted code unless it is ensured that\n * the URL refers to a trustworthy resource.\n *\n * @param {!HTMLEmbedElement} embed The embed element whose src property\n *     is to be assigned to.\n * @param {!goog.html.TrustedResourceUrl} url The URL to assign.\n */\ngoog.dom.safe.setEmbedSrc = function(embed, url) {\n  goog.dom.safe.assertIsHTMLEmbedElement_(embed);\n  embed.src = goog.html.TrustedResourceUrl.unwrap(url);\n};\n\n\n/**\n * Safely assigns a URL to a frame element's src property.\n *\n * Example usage:\n *   goog.dom.safe.setFrameSrc(frameEl, url);\n * which is a safe alternative to\n *   frameEl.src = url;\n * The latter can result in loading untrusted code unless it is ensured that\n * the URL refers to a trustworthy resource.\n *\n * @param {!HTMLFrameElement} frame The frame element whose src property\n *     is to be assigned to.\n * @param {!goog.html.TrustedResourceUrl} url The URL to assign.\n */\ngoog.dom.safe.setFrameSrc = function(frame, url) {\n  goog.dom.safe.assertIsHTMLFrameElement_(frame);\n  frame.src = goog.html.TrustedResourceUrl.unwrap(url);\n};\n\n\n/**\n * Safely assigns a URL to an iframe element's src property.\n *\n * Example usage:\n *   goog.dom.safe.setIframeSrc(iframeEl, url);\n * which is a safe alternative to\n *   iframeEl.src = url;\n * The latter can result in loading untrusted code unless it is ensured that\n * the URL refers to a trustworthy resource.\n *\n * @param {!HTMLIFrameElement} iframe The iframe element whose src property\n *     is to be assigned to.\n * @param {!goog.html.TrustedResourceUrl} url The URL to assign.\n */\ngoog.dom.safe.setIframeSrc = function(iframe, url) {\n  goog.dom.safe.assertIsHTMLIFrameElement_(iframe);\n  iframe.src = goog.html.TrustedResourceUrl.unwrap(url);\n};\n\n\n/**\n * Safely assigns HTML to an iframe element's srcdoc property.\n *\n * Example usage:\n *   goog.dom.safe.setIframeSrcdoc(iframeEl, safeHtml);\n * which is a safe alternative to\n *   iframeEl.srcdoc = html;\n * The latter can result in loading untrusted code.\n *\n * @param {!HTMLIFrameElement} iframe The iframe element whose srcdoc property\n *     is to be assigned to.\n * @param {!goog.html.SafeHtml} html The HTML to assign.\n */\ngoog.dom.safe.setIframeSrcdoc = function(iframe, html) {\n  goog.dom.safe.assertIsHTMLIFrameElement_(iframe);\n  iframe.srcdoc = goog.html.SafeHtml.unwrap(html);\n};\n\n\n/**\n * Safely sets a link element's href and rel properties. Whether or not\n * the URL assigned to href has to be a goog.html.TrustedResourceUrl\n * depends on the value of the rel property. If rel contains \"stylesheet\"\n * then a TrustedResourceUrl is required.\n *\n * Example usage:\n *   goog.dom.safe.setLinkHrefAndRel(linkEl, url, 'stylesheet');\n * which is a safe alternative to\n *   linkEl.rel = 'stylesheet';\n *   linkEl.href = url;\n * The latter can result in loading untrusted code unless it is ensured that\n * the URL refers to a trustworthy resource.\n *\n * @param {!HTMLLinkElement} link The link element whose href property\n *     is to be assigned to.\n * @param {string|!goog.html.SafeUrl|!goog.html.TrustedResourceUrl} url The URL\n *     to assign to the href property. Must be a TrustedResourceUrl if the\n *     value assigned to rel contains \"stylesheet\". A string value is\n *     sanitized with goog.html.SafeUrl.sanitize.\n * @param {string} rel The value to assign to the rel property.\n * @throws {Error} if rel contains \"stylesheet\" and url is not a\n *     TrustedResourceUrl\n * @see goog.html.SafeUrl#sanitize\n */\ngoog.dom.safe.setLinkHrefAndRel = function(link, url, rel) {\n  goog.dom.safe.assertIsHTMLLinkElement_(link);\n  link.rel = rel;\n  if (goog.string.caseInsensitiveContains(rel, 'stylesheet')) {\n    goog.asserts.assert(\n        url instanceof goog.html.TrustedResourceUrl,\n        'URL must be TrustedResourceUrl because \"rel\" contains \"stylesheet\"');\n    link.href = goog.html.TrustedResourceUrl.unwrap(url);\n  } else if (url instanceof goog.html.TrustedResourceUrl) {\n    link.href = goog.html.TrustedResourceUrl.unwrap(url);\n  } else if (url instanceof goog.html.SafeUrl) {\n    link.href = goog.html.SafeUrl.unwrap(url);\n  } else {  // string\n    // SafeUrl.sanitize must return legitimate SafeUrl when passed a string.\n    link.href = goog.html.SafeUrl.sanitize(url).getTypedStringValue();\n  }\n};\n\n\n/**\n * Safely assigns a URL to an object element's data property.\n *\n * Example usage:\n *   goog.dom.safe.setObjectData(objectEl, url);\n * which is a safe alternative to\n *   objectEl.data = url;\n * The latter can result in loading untrusted code unless setit is ensured that\n * the URL refers to a trustworthy resource.\n *\n * @param {!HTMLObjectElement} object The object element whose data property\n *     is to be assigned to.\n * @param {!goog.html.TrustedResourceUrl} url The URL to assign.\n */\ngoog.dom.safe.setObjectData = function(object, url) {\n  goog.dom.safe.assertIsHTMLObjectElement_(object);\n  object.data = goog.html.TrustedResourceUrl.unwrap(url);\n};\n\n\n/**\n * Safely assigns a URL to an script element's src property.\n *\n * Example usage:\n *   goog.dom.safe.setScriptSrc(scriptEl, url);\n * which is a safe alternative to\n *   scriptEl.src = url;\n * The latter can result in loading untrusted code unless it is ensured that\n * the URL refers to a trustworthy resource.\n *\n * @param {!HTMLScriptElement} script The script element whose src property\n *     is to be assigned to.\n * @param {!goog.html.TrustedResourceUrl} url The URL to assign.\n */\ngoog.dom.safe.setScriptSrc = function(script, url) {\n  goog.dom.safe.assertIsHTMLScriptElement_(script);\n  script.src = goog.html.TrustedResourceUrl.unwrap(url);\n};\n\n\n/**\n * Safely assigns a URL to a Location object's href property.\n *\n * If url is of type goog.html.SafeUrl, its value is unwrapped and assigned to\n * loc's href property.  If url is of type string however, it is first sanitized\n * using goog.html.SafeUrl.sanitize.\n *\n * Example usage:\n *   goog.dom.safe.setLocationHref(document.location, redirectUrl);\n * which is a safe alternative to\n *   document.location.href = redirectUrl;\n * The latter can result in XSS vulnerabilities if redirectUrl is a\n * user-/attacker-controlled value.\n *\n * @param {!Location} loc The Location object whose href property is to be\n *     assigned to.\n * @param {string|!goog.html.SafeUrl} url The URL to assign.\n * @see goog.html.SafeUrl#sanitize\n */\ngoog.dom.safe.setLocationHref = function(loc, url) {\n  goog.dom.safe.assertIsLocation_(loc);\n  /** @type {!goog.html.SafeUrl} */\n  var safeUrl;\n  if (url instanceof goog.html.SafeUrl) {\n    safeUrl = url;\n  } else {\n    safeUrl = goog.html.SafeUrl.sanitize(url);\n  }\n  loc.href = goog.html.SafeUrl.unwrap(safeUrl);\n};\n\n\n/**\n * Safely opens a URL in a new window (via window.open).\n *\n * If url is of type goog.html.SafeUrl, its value is unwrapped and passed in to\n * window.open.  If url is of type string however, it is first sanitized\n * using goog.html.SafeUrl.sanitize.\n *\n * Note that this function does not prevent leakages via the referer that is\n * sent by window.open. It is advised to only use this to open 1st party URLs.\n *\n * Example usage:\n *   goog.dom.safe.openInWindow(url);\n * which is a safe alternative to\n *   window.open(url);\n * The latter can result in XSS vulnerabilities if redirectUrl is a\n * user-/attacker-controlled value.\n *\n * @param {string|!goog.html.SafeUrl} url The URL to open.\n * @param {Window=} opt_openerWin Window of which to call the .open() method.\n *     Defaults to the global window.\n * @param {!goog.string.Const=} opt_name Name of the window to open in. Can be\n *     _top, etc as allowed by window.open().\n * @param {string=} opt_specs Comma-separated list of specifications, same as\n *     in window.open().\n * @param {boolean=} opt_replace Whether to replace the current entry in browser\n *     history, same as in window.open().\n * @return {Window} Window the url was opened in.\n */\ngoog.dom.safe.openInWindow = function(\n    url, opt_openerWin, opt_name, opt_specs, opt_replace) {\n  /** @type {!goog.html.SafeUrl} */\n  var safeUrl;\n  if (url instanceof goog.html.SafeUrl) {\n    safeUrl = url;\n  } else {\n    safeUrl = goog.html.SafeUrl.sanitize(url);\n  }\n  var win = opt_openerWin || window;\n  return win.open(\n      goog.html.SafeUrl.unwrap(safeUrl),\n      // If opt_name is undefined, simply passing that in to open() causes IE to\n      // reuse the current window instead of opening a new one. Thus we pass ''\n      // in instead, which according to spec opens a new window. See\n      // https://html.spec.whatwg.org/multipage/browsers.html#dom-open .\n      opt_name ? goog.string.Const.unwrap(opt_name) : '', opt_specs,\n      opt_replace);\n};\n\n\n/*\n * Custom assertions for use in the above wrapper methods to ensure that they\n * are indeed invoked on an element of the appropriate type.\n *\n * Using a goog.dom.safe wrapper on an object on the incorrect type (via an\n * incorrect static type cast) can result in security bugs: For instance,\n * g.d.s.setAnchorHref ensures that the URL assigned to the .href attribute\n * satisfies the SafeUrl contract, i.e., is safe to dereference as a hyperlink.\n * However, the value assigned to a HTMLLinkElement's .href property requires\n * the stronger TrustedResourceUrl contract, since it can refer to a stylesheet.\n * Thus, using g.d.s.setAnchorHref on an (incorrectly statically typed) object\n * of type HTMLLinkElement can result in a security vulnerability.\n * Assertions of the correct run-time type help prevent such incorrect use.\n *\n * In some cases, code using the DOM API is tested using mock objects (e.g., a\n * plain object such as {'href': url} instead of an actual Location object).\n * To allow such mocking, the assertions permit objects of types that are not\n * relevant DOM API objects at all (for instance, not Element or Location).\n *\n * Note that instanceof checks don't work straightforwardly in older versions of\n * IE, or across frames (see,\n * http://stackoverflow.com/questions/384286/javascript-isdom-how-do-you-check-if-a-javascript-object-is-a-dom-object,\n * http://stackoverflow.com/questions/26248599/instanceof-htmlelement-in-iframe-is-not-element-or-object).\n *\n * Hence, these assertions may pass vacuously in such scenarios. The resulting\n * risk of security bugs is limited by the following factors:\n *  - A bug can only arise in scenarios involving incorrect static typing (the\n *    wrapper methods are statically typed to demand objects of the appropriate,\n *    precise type).\n *  - Operations on elements across frames are relatively rare.\n *  - Typically, code is tested and exercised in multiple browsers.\n */\n\n/**\n * Asserts that a given object is a Location.\n *\n * To permit this assertion to pass in the context of tests where DOM APIs might\n * be mocked, also accepts any other type except for subtypes of {!Element}.\n * This is to ensure that, for instance, HTMLLinkElement is not being used in\n * place of a Location, since this could result in security bugs due to stronger\n * contracts required for assignments to the href property of the latter.\n *\n * @param {?Object} o The object whose type to assert.\n * @return {!Location}\n * @private\n */\ngoog.dom.safe.assertIsLocation_ = function(o) {\n  if (goog.asserts.ENABLE_ASSERTS && typeof Location != 'undefined' &&\n      typeof Element != 'undefined') {\n    goog.asserts.assert(\n        o && (o instanceof Location || !(o instanceof Element)),\n        'Argument is not a Location (or a non-Element mock); got: %s',\n        goog.dom.safe.debugStringForType_(o));\n  }\n  return /** @type {!Location} */ (o);\n};\n\n/**\n * Asserts that a given object is a HTMLAnchorElement.\n *\n * To permit this assertion to pass in the context of tests where elements might\n * be mocked, also accepts objects that are not of type Location nor a subtype\n * of Element.\n *\n * @param {?Object} o The object whose type to assert.\n * @return {!HTMLAnchorElement}\n * @private\n */\ngoog.dom.safe.assertIsHTMLAnchorElement_ = function(o) {\n  if (goog.asserts.ENABLE_ASSERTS && typeof HTMLAnchorElement != 'undefined' &&\n      typeof Location != 'undefined' && typeof Element != 'undefined') {\n    goog.asserts.assert(\n        o && (o instanceof HTMLAnchorElement ||\n              !((o instanceof Location) || (o instanceof Element))),\n        'Argument is not a HTMLAnchorElement (or a non-Element mock); got: %s',\n        goog.dom.safe.debugStringForType_(o));\n  }\n  return /** @type {!HTMLAnchorElement} */ (o);\n};\n\n/**\n * Asserts that a given object is a HTMLLinkElement.\n *\n * To permit this assertion to pass in the context of tests where elements might\n * be mocked, also accepts objects that are not a subtype of Element.\n *\n * @param {?Object} o The object whose type to assert.\n * @return {!HTMLLinkElement}\n * @private\n */\ngoog.dom.safe.assertIsHTMLLinkElement_ = function(o) {\n  if (goog.asserts.ENABLE_ASSERTS && typeof HTMLLinkElement != 'undefined' &&\n      typeof Location != 'undefined' && typeof Element != 'undefined') {\n    goog.asserts.assert(\n        o && (o instanceof HTMLLinkElement ||\n              !((o instanceof Location) || (o instanceof Element))),\n        'Argument is not a HTMLLinkElement (or a non-Element mock); got: %s',\n        goog.dom.safe.debugStringForType_(o));\n  }\n  return /** @type {!HTMLLinkElement} */ (o);\n};\n\n/**\n * Asserts that a given object is a HTMLImageElement.\n *\n * To permit this assertion to pass in the context of tests where elements might\n * be mocked, also accepts objects that are not a subtype of Element.\n *\n * @param {?Object} o The object whose type to assert.\n * @return {!HTMLImageElement}\n * @private\n */\ngoog.dom.safe.assertIsHTMLImageElement_ = function(o) {\n  if (goog.asserts.ENABLE_ASSERTS && typeof HTMLImageElement != 'undefined' &&\n      typeof Element != 'undefined') {\n    goog.asserts.assert(\n        o && (o instanceof HTMLImageElement || !(o instanceof Element)),\n        'Argument is not a HTMLImageElement (or a non-Element mock); got: %s',\n        goog.dom.safe.debugStringForType_(o));\n  }\n  return /** @type {!HTMLImageElement} */ (o);\n};\n\n/**\n * Asserts that a given object is a HTMLEmbedElement.\n *\n * To permit this assertion to pass in the context of tests where elements might\n * be mocked, also accepts objects that are not a subtype of Element.\n *\n * @param {?Object} o The object whose type to assert.\n * @return {!HTMLEmbedElement}\n * @private\n */\ngoog.dom.safe.assertIsHTMLEmbedElement_ = function(o) {\n  if (goog.asserts.ENABLE_ASSERTS && typeof HTMLEmbedElement != 'undefined' &&\n      typeof Element != 'undefined') {\n    goog.asserts.assert(\n        o && (o instanceof HTMLEmbedElement || !(o instanceof Element)),\n        'Argument is not a HTMLEmbedElement (or a non-Element mock); got: %s',\n        goog.dom.safe.debugStringForType_(o));\n  }\n  return /** @type {!HTMLEmbedElement} */ (o);\n};\n\n/**\n * Asserts that a given object is a HTMLFrameElement.\n *\n * To permit this assertion to pass in the context of tests where elements might\n * be mocked, also accepts objects that are not a subtype of Element.\n *\n * @param {?Object} o The object whose type to assert.\n * @return {!HTMLFrameElement}\n * @private\n */\ngoog.dom.safe.assertIsHTMLFrameElement_ = function(o) {\n  if (goog.asserts.ENABLE_ASSERTS && typeof HTMLFrameElement != 'undefined' &&\n      typeof Element != 'undefined') {\n    goog.asserts.assert(\n        o && (o instanceof HTMLFrameElement || !(o instanceof Element)),\n        'Argument is not a HTMLFrameElement (or a non-Element mock); got: %s',\n        goog.dom.safe.debugStringForType_(o));\n  }\n  return /** @type {!HTMLFrameElement} */ (o);\n};\n\n/**\n * Asserts that a given object is a HTMLIFrameElement.\n *\n * To permit this assertion to pass in the context of tests where elements might\n * be mocked, also accepts objects that are not a subtype of Element.\n *\n * @param {?Object} o The object whose type to assert.\n * @return {!HTMLIFrameElement}\n * @private\n */\ngoog.dom.safe.assertIsHTMLIFrameElement_ = function(o) {\n  if (goog.asserts.ENABLE_ASSERTS && typeof HTMLIFrameElement != 'undefined' &&\n      typeof Element != 'undefined') {\n    goog.asserts.assert(\n        o && (o instanceof HTMLIFrameElement || !(o instanceof Element)),\n        'Argument is not a HTMLIFrameElement (or a non-Element mock); got: %s',\n        goog.dom.safe.debugStringForType_(o));\n  }\n  return /** @type {!HTMLIFrameElement} */ (o);\n};\n\n/**\n * Asserts that a given object is a HTMLObjectElement.\n *\n * To permit this assertion to pass in the context of tests where elements might\n * be mocked, also accepts objects that are not a subtype of Element.\n *\n * @param {?Object} o The object whose type to assert.\n * @return {!HTMLObjectElement}\n * @private\n */\ngoog.dom.safe.assertIsHTMLObjectElement_ = function(o) {\n  if (goog.asserts.ENABLE_ASSERTS && typeof HTMLObjectElement != 'undefined' &&\n      typeof Element != 'undefined') {\n    goog.asserts.assert(\n        o && (o instanceof HTMLObjectElement || !(o instanceof Element)),\n        'Argument is not a HTMLObjectElement (or a non-Element mock); got: %s',\n        goog.dom.safe.debugStringForType_(o));\n  }\n  return /** @type {!HTMLObjectElement} */ (o);\n};\n\n/**\n * Asserts that a given object is a HTMLScriptElement.\n *\n * To permit this assertion to pass in the context of tests where elements might\n * be mocked, also accepts objects that are not a subtype of Element.\n *\n * @param {?Object} o The object whose type to assert.\n * @return {!HTMLScriptElement}\n * @private\n */\ngoog.dom.safe.assertIsHTMLScriptElement_ = function(o) {\n  if (goog.asserts.ENABLE_ASSERTS && typeof HTMLScriptElement != 'undefined' &&\n      typeof Element != 'undefined') {\n    goog.asserts.assert(\n        o && (o instanceof HTMLScriptElement || !(o instanceof Element)),\n        'Argument is not a HTMLScriptElement (or a non-Element mock); got: %s',\n        goog.dom.safe.debugStringForType_(o));\n  }\n  return /** @type {!HTMLScriptElement} */ (o);\n};\n\n/**\n * Returns a string representation of a value's type.\n *\n * @param {*} value An object, or primitive.\n * @return {string} The best display name for the value.\n * @private\n */\ngoog.dom.safe.debugStringForType_ = function(value) {\n  if (goog.isObject(value)) {\n    return value.constructor.displayName || value.constructor.name ||\n        Object.prototype.toString.call(value);\n  } else {\n    return value === undefined ? 'undefined' :\n                                 value === null ? 'null' : typeof value;\n  }\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Unchecked conversions to create values of goog.html types from\n * plain strings.  Use of these functions could potentially result in instances\n * of goog.html types that violate their type contracts, and hence result in\n * security vulnerabilties.\n *\n * Therefore, all uses of the methods herein must be carefully security\n * reviewed.  Avoid use of the methods in this file whenever possible; instead\n * prefer to create instances of goog.html types using inherently safe builders\n * or template systems.\n *\n *\n *\n * @visibility {//closure/goog/html:approved_for_unchecked_conversion}\n * @visibility {//closure/goog/bin/sizetests:__pkg__}\n */\n\n\ngoog.provide('goog.html.uncheckedconversions');\n\ngoog.require('goog.asserts');\ngoog.require('goog.html.SafeHtml');\ngoog.require('goog.html.SafeScript');\ngoog.require('goog.html.SafeStyle');\ngoog.require('goog.html.SafeStyleSheet');\ngoog.require('goog.html.SafeUrl');\ngoog.require('goog.html.TrustedResourceUrl');\ngoog.require('goog.string');\ngoog.require('goog.string.Const');\n\n\n/**\n * Performs an \"unchecked conversion\" to SafeHtml from a plain string that is\n * known to satisfy the SafeHtml type contract.\n *\n * IMPORTANT: Uses of this method must be carefully security-reviewed to ensure\n * that the value of {@code html} satisfies the SafeHtml type contract in all\n * possible program states.\n *\n *\n * @param {!goog.string.Const} justification A constant string explaining why\n *     this use of this method is safe. May include a security review ticket\n *     number.\n * @param {string} html A string that is claimed to adhere to the SafeHtml\n *     contract.\n * @param {?goog.i18n.bidi.Dir=} opt_dir The optional directionality of the\n *     SafeHtml to be constructed. A null or undefined value signifies an\n *     unknown directionality.\n * @return {!goog.html.SafeHtml} The value of html, wrapped in a SafeHtml\n *     object.\n */\ngoog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract =\n    function(justification, html, opt_dir) {\n  // unwrap() called inside an assert so that justification can be optimized\n  // away in production code.\n  goog.asserts.assertString(\n      goog.string.Const.unwrap(justification), 'must provide justification');\n  goog.asserts.assert(\n      !goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(justification)),\n      'must provide non-empty justification');\n  return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n      html, opt_dir || null);\n};\n\n\n/**\n * Performs an \"unchecked conversion\" to SafeScript from a plain string that is\n * known to satisfy the SafeScript type contract.\n *\n * IMPORTANT: Uses of this method must be carefully security-reviewed to ensure\n * that the value of {@code script} satisfies the SafeScript type contract in\n * all possible program states.\n *\n *\n * @param {!goog.string.Const} justification A constant string explaining why\n *     this use of this method is safe. May include a security review ticket\n *     number.\n * @param {string} script The string to wrap as a SafeScript.\n * @return {!goog.html.SafeScript} The value of {@code script}, wrapped in a\n *     SafeScript object.\n */\ngoog.html.uncheckedconversions.safeScriptFromStringKnownToSatisfyTypeContract =\n    function(justification, script) {\n  // unwrap() called inside an assert so that justification can be optimized\n  // away in production code.\n  goog.asserts.assertString(\n      goog.string.Const.unwrap(justification), 'must provide justification');\n  goog.asserts.assert(\n      !goog.string.isEmpty(goog.string.Const.unwrap(justification)),\n      'must provide non-empty justification');\n  return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(\n      script);\n};\n\n\n/**\n * Performs an \"unchecked conversion\" to SafeStyle from a plain string that is\n * known to satisfy the SafeStyle type contract.\n *\n * IMPORTANT: Uses of this method must be carefully security-reviewed to ensure\n * that the value of {@code style} satisfies the SafeUrl type contract in all\n * possible program states.\n *\n *\n * @param {!goog.string.Const} justification A constant string explaining why\n *     this use of this method is safe. May include a security review ticket\n *     number.\n * @param {string} style The string to wrap as a SafeStyle.\n * @return {!goog.html.SafeStyle} The value of {@code style}, wrapped in a\n *     SafeStyle object.\n */\ngoog.html.uncheckedconversions.safeStyleFromStringKnownToSatisfyTypeContract =\n    function(justification, style) {\n  // unwrap() called inside an assert so that justification can be optimized\n  // away in production code.\n  goog.asserts.assertString(\n      goog.string.Const.unwrap(justification), 'must provide justification');\n  goog.asserts.assert(\n      !goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(justification)),\n      'must provide non-empty justification');\n  return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(\n      style);\n};\n\n\n/**\n * Performs an \"unchecked conversion\" to SafeStyleSheet from a plain string\n * that is known to satisfy the SafeStyleSheet type contract.\n *\n * IMPORTANT: Uses of this method must be carefully security-reviewed to ensure\n * that the value of {@code styleSheet} satisfies the SafeUrl type contract in\n * all possible program states.\n *\n *\n * @param {!goog.string.Const} justification A constant string explaining why\n *     this use of this method is safe. May include a security review ticket\n *     number.\n * @param {string} styleSheet The string to wrap as a SafeStyleSheet.\n * @return {!goog.html.SafeStyleSheet} The value of {@code styleSheet}, wrapped\n *     in a SafeStyleSheet object.\n */\ngoog.html.uncheckedconversions\n    .safeStyleSheetFromStringKnownToSatisfyTypeContract = function(\n    justification, styleSheet) {\n  // unwrap() called inside an assert so that justification can be optimized\n  // away in production code.\n  goog.asserts.assertString(\n      goog.string.Const.unwrap(justification), 'must provide justification');\n  goog.asserts.assert(\n      !goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(justification)),\n      'must provide non-empty justification');\n  return goog.html.SafeStyleSheet\n      .createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(styleSheet);\n};\n\n\n/**\n * Performs an \"unchecked conversion\" to SafeUrl from a plain string that is\n * known to satisfy the SafeUrl type contract.\n *\n * IMPORTANT: Uses of this method must be carefully security-reviewed to ensure\n * that the value of {@code url} satisfies the SafeUrl type contract in all\n * possible program states.\n *\n *\n * @param {!goog.string.Const} justification A constant string explaining why\n *     this use of this method is safe. May include a security review ticket\n *     number.\n * @param {string} url The string to wrap as a SafeUrl.\n * @return {!goog.html.SafeUrl} The value of {@code url}, wrapped in a SafeUrl\n *     object.\n */\ngoog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract =\n    function(justification, url) {\n  // unwrap() called inside an assert so that justification can be optimized\n  // away in production code.\n  goog.asserts.assertString(\n      goog.string.Const.unwrap(justification), 'must provide justification');\n  goog.asserts.assert(\n      !goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(justification)),\n      'must provide non-empty justification');\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url);\n};\n\n\n/**\n * Performs an \"unchecked conversion\" to TrustedResourceUrl from a plain string\n * that is known to satisfy the TrustedResourceUrl type contract.\n *\n * IMPORTANT: Uses of this method must be carefully security-reviewed to ensure\n * that the value of {@code url} satisfies the TrustedResourceUrl type contract\n * in all possible program states.\n *\n *\n * @param {!goog.string.Const} justification A constant string explaining why\n *     this use of this method is safe. May include a security review ticket\n *     number.\n * @param {string} url The string to wrap as a TrustedResourceUrl.\n * @return {!goog.html.TrustedResourceUrl} The value of {@code url}, wrapped in\n *     a TrustedResourceUrl object.\n */\ngoog.html.uncheckedconversions\n    .trustedResourceUrlFromStringKnownToSatisfyTypeContract = function(\n    justification, url) {\n  // unwrap() called inside an assert so that justification can be optimized\n  // away in production code.\n  goog.asserts.assertString(\n      goog.string.Const.unwrap(justification), 'must provide justification');\n  goog.asserts.assert(\n      !goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(justification)),\n      'must provide non-empty justification');\n  return goog.html.TrustedResourceUrl\n      .createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(url);\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for manipulating the browser's Document Object Model\n * Inspiration taken *heavily* from mochikit (http://mochikit.com/).\n *\n * You can use {@link goog.dom.DomHelper} to create new dom helpers that refer\n * to a different document object.  This is useful if you are working with\n * frames or multiple windows.\n *\n * @author arv@google.com (Erik Arvidsson)\n */\n\n\n// TODO(arv): Rename/refactor getTextContent and getRawTextContent. The problem\n// is that getTextContent should mimic the DOM3 textContent. We should add a\n// getInnerText (or getText) which tries to return the visible text, innerText.\n\n\ngoog.provide('goog.dom');\ngoog.provide('goog.dom.Appendable');\ngoog.provide('goog.dom.DomHelper');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom.BrowserFeature');\ngoog.require('goog.dom.NodeType');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.safe');\ngoog.require('goog.html.SafeHtml');\ngoog.require('goog.html.uncheckedconversions');\ngoog.require('goog.math.Coordinate');\ngoog.require('goog.math.Size');\ngoog.require('goog.object');\ngoog.require('goog.string');\ngoog.require('goog.string.Unicode');\ngoog.require('goog.userAgent');\n\n\n/**\n * @define {boolean} Whether we know at compile time that the browser is in\n * quirks mode.\n */\ngoog.define('goog.dom.ASSUME_QUIRKS_MODE', false);\n\n\n/**\n * @define {boolean} Whether we know at compile time that the browser is in\n * standards compliance mode.\n */\ngoog.define('goog.dom.ASSUME_STANDARDS_MODE', false);\n\n\n/**\n * Whether we know the compatibility mode at compile time.\n * @type {boolean}\n * @private\n */\ngoog.dom.COMPAT_MODE_KNOWN_ =\n    goog.dom.ASSUME_QUIRKS_MODE || goog.dom.ASSUME_STANDARDS_MODE;\n\n\n/**\n * Gets the DomHelper object for the document where the element resides.\n * @param {(Node|Window)=} opt_element If present, gets the DomHelper for this\n *     element.\n * @return {!goog.dom.DomHelper} The DomHelper.\n */\ngoog.dom.getDomHelper = function(opt_element) {\n  return opt_element ?\n      new goog.dom.DomHelper(goog.dom.getOwnerDocument(opt_element)) :\n      (goog.dom.defaultDomHelper_ ||\n       (goog.dom.defaultDomHelper_ = new goog.dom.DomHelper()));\n};\n\n\n/**\n * Cached default DOM helper.\n * @type {!goog.dom.DomHelper|undefined}\n * @private\n */\ngoog.dom.defaultDomHelper_;\n\n\n/**\n * Gets the document object being used by the dom library.\n * @return {!Document} Document object.\n */\ngoog.dom.getDocument = function() {\n  return document;\n};\n\n\n/**\n * Gets an element from the current document by element id.\n *\n * If an Element is passed in, it is returned.\n *\n * @param {string|Element} element Element ID or a DOM node.\n * @return {Element} The element with the given ID, or the node passed in.\n */\ngoog.dom.getElement = function(element) {\n  return goog.dom.getElementHelper_(document, element);\n};\n\n\n/**\n * Gets an element by id from the given document (if present).\n * If an element is given, it is returned.\n * @param {!Document} doc\n * @param {string|Element} element Element ID or a DOM node.\n * @return {Element} The resulting element.\n * @private\n */\ngoog.dom.getElementHelper_ = function(doc, element) {\n  return goog.isString(element) ? doc.getElementById(element) : element;\n};\n\n\n/**\n * Gets an element by id, asserting that the element is found.\n *\n * This is used when an element is expected to exist, and should fail with\n * an assertion error if it does not (if assertions are enabled).\n *\n * @param {string} id Element ID.\n * @return {!Element} The element with the given ID, if it exists.\n */\ngoog.dom.getRequiredElement = function(id) {\n  return goog.dom.getRequiredElementHelper_(document, id);\n};\n\n\n/**\n * Helper function for getRequiredElementHelper functions, both static and\n * on DomHelper.  Asserts the element with the given id exists.\n * @param {!Document} doc\n * @param {string} id\n * @return {!Element} The element with the given ID, if it exists.\n * @private\n */\ngoog.dom.getRequiredElementHelper_ = function(doc, id) {\n  // To prevent users passing in Elements as is permitted in getElement().\n  goog.asserts.assertString(id);\n  var element = goog.dom.getElementHelper_(doc, id);\n  element =\n      goog.asserts.assertElement(element, 'No element found with id: ' + id);\n  return element;\n};\n\n\n/**\n * Alias for getElement.\n * @param {string|Element} element Element ID or a DOM node.\n * @return {Element} The element with the given ID, or the node passed in.\n * @deprecated Use {@link goog.dom.getElement} instead.\n */\ngoog.dom.$ = goog.dom.getElement;\n\n\n/**\n * Gets elements by tag name.\n * @param {!goog.dom.TagName<T>} tagName\n * @param {(!Document|!Element)=} opt_parent Parent element or document where to\n *     look for elements. Defaults to document.\n * @return {!NodeList<R>} List of elements. The members of the list are\n *     {!Element} if tagName is not a member of goog.dom.TagName or more\n *     specific types if it is (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.getElementsByTagName = function(tagName, opt_parent) {\n  var parent = opt_parent || document;\n  return parent.getElementsByTagName(String(tagName));\n};\n\n\n/**\n * Looks up elements by both tag and class name, using browser native functions\n * ({@code querySelectorAll}, {@code getElementsByTagName} or\n * {@code getElementsByClassName}) where possible. This function\n * is a useful, if limited, way of collecting a list of DOM elements\n * with certain characteristics.  {@code goog.dom.query} offers a\n * more powerful and general solution which allows matching on CSS3\n * selector expressions, but at increased cost in code size. If all you\n * need is particular tags belonging to a single class, this function\n * is fast and sleek.\n *\n * Note that tag names are case sensitive in the SVG namespace, and this\n * function converts opt_tag to uppercase for comparisons. For queries in the\n * SVG namespace you should use querySelector or querySelectorAll instead.\n * https://bugzilla.mozilla.org/show_bug.cgi?id=963870\n * https://bugs.webkit.org/show_bug.cgi?id=83438\n *\n * @see {goog.dom.query}\n *\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name.\n * @param {?string=} opt_class Optional class name.\n * @param {(Document|Element)=} opt_el Optional element to look in.\n * @return {!IArrayLike<R>} Array-like list of elements (only a length property\n *     and numerical indices are guaranteed to exist). The members of the array\n *     are {!Element} if opt_tag is not a member of goog.dom.TagName or more\n *     specific types if it is (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.getElementsByTagNameAndClass = function(opt_tag, opt_class, opt_el) {\n  return goog.dom.getElementsByTagNameAndClass_(\n      document, opt_tag, opt_class, opt_el);\n};\n\n\n/**\n * Returns a static, array-like list of the elements with the provided\n * className.\n * @see {goog.dom.query}\n * @param {string} className the name of the class to look for.\n * @param {(Document|Element)=} opt_el Optional element to look in.\n * @return {!IArrayLike<!Element>} The items found with the class name provided.\n */\ngoog.dom.getElementsByClass = function(className, opt_el) {\n  var parent = opt_el || document;\n  if (goog.dom.canUseQuerySelector_(parent)) {\n    return parent.querySelectorAll('.' + className);\n  }\n  return goog.dom.getElementsByTagNameAndClass_(\n      document, '*', className, opt_el);\n};\n\n\n/**\n * Returns the first element with the provided className.\n * @see {goog.dom.query}\n * @param {string} className the name of the class to look for.\n * @param {Element|Document=} opt_el Optional element to look in.\n * @return {Element} The first item with the class name provided.\n */\ngoog.dom.getElementByClass = function(className, opt_el) {\n  var parent = opt_el || document;\n  var retVal = null;\n  if (parent.getElementsByClassName) {\n    retVal = parent.getElementsByClassName(className)[0];\n  } else if (goog.dom.canUseQuerySelector_(parent)) {\n    retVal = parent.querySelector('.' + className);\n  } else {\n    retVal = goog.dom.getElementsByTagNameAndClass_(\n        document, '*', className, opt_el)[0];\n  }\n  return retVal || null;\n};\n\n\n/**\n * Ensures an element with the given className exists, and then returns the\n * first element with the provided className.\n * @see {goog.dom.query}\n * @param {string} className the name of the class to look for.\n * @param {!Element|!Document=} opt_root Optional element or document to look\n *     in.\n * @return {!Element} The first item with the class name provided.\n * @throws {goog.asserts.AssertionError} Thrown if no element is found.\n */\ngoog.dom.getRequiredElementByClass = function(className, opt_root) {\n  var retValue = goog.dom.getElementByClass(className, opt_root);\n  return goog.asserts.assert(\n      retValue, 'No element found with className: ' + className);\n};\n\n\n/**\n * Prefer the standardized (http://www.w3.org/TR/selectors-api/), native and\n * fast W3C Selectors API.\n * @param {!(Element|Document)} parent The parent document object.\n * @return {boolean} whether or not we can use parent.querySelector* APIs.\n * @private\n */\ngoog.dom.canUseQuerySelector_ = function(parent) {\n  return !!(parent.querySelectorAll && parent.querySelector);\n};\n\n\n/**\n * Helper for {@code getElementsByTagNameAndClass}.\n * @param {!Document} doc The document to get the elements in.\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name.\n * @param {?string=} opt_class Optional class name.\n * @param {(Document|Element)=} opt_el Optional element to look in.\n * @return {!IArrayLike<R>} Array-like list of elements (only a length property\n *     and numerical indices are guaranteed to exist). The members of the array\n *     are {!Element} if opt_tag is not a member of goog.dom.TagName or more\n *     specific types if it is (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n * @private\n */\ngoog.dom.getElementsByTagNameAndClass_ = function(\n    doc, opt_tag, opt_class, opt_el) {\n  var parent = opt_el || doc;\n  var tagName =\n      (opt_tag && opt_tag != '*') ? String(opt_tag).toUpperCase() : '';\n\n  if (goog.dom.canUseQuerySelector_(parent) && (tagName || opt_class)) {\n    var query = tagName + (opt_class ? '.' + opt_class : '');\n    return parent.querySelectorAll(query);\n  }\n\n  // Use the native getElementsByClassName if available, under the assumption\n  // that even when the tag name is specified, there will be fewer elements to\n  // filter through when going by class than by tag name\n  if (opt_class && parent.getElementsByClassName) {\n    var els = parent.getElementsByClassName(opt_class);\n\n    if (tagName) {\n      var arrayLike = {};\n      var len = 0;\n\n      // Filter for specific tags if requested.\n      for (var i = 0, el; el = els[i]; i++) {\n        if (tagName == el.nodeName) {\n          arrayLike[len++] = el;\n        }\n      }\n      arrayLike.length = len;\n\n      return /** @type {!IArrayLike<!Element>} */ (arrayLike);\n    } else {\n      return els;\n    }\n  }\n\n  var els = parent.getElementsByTagName(tagName || '*');\n\n  if (opt_class) {\n    var arrayLike = {};\n    var len = 0;\n    for (var i = 0, el; el = els[i]; i++) {\n      var className = el.className;\n      // Check if className has a split function since SVG className does not.\n      if (typeof className.split == 'function' &&\n          goog.array.contains(className.split(/\\s+/), opt_class)) {\n        arrayLike[len++] = el;\n      }\n    }\n    arrayLike.length = len;\n    return /** @type {!IArrayLike<!Element>} */ (arrayLike);\n  } else {\n    return els;\n  }\n};\n\n\n/**\n * Alias for {@code getElementsByTagNameAndClass}.\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name.\n * @param {?string=} opt_class Optional class name.\n * @param {Element=} opt_el Optional element to look in.\n * @return {!IArrayLike<R>} Array-like list of elements (only a length property\n *     and numerical indices are guaranteed to exist). The members of the array\n *     are {!Element} if opt_tag is not a member of goog.dom.TagName or more\n *     specific types if it is (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n * @deprecated Use {@link goog.dom.getElementsByTagNameAndClass} instead.\n */\ngoog.dom.$$ = goog.dom.getElementsByTagNameAndClass;\n\n\n/**\n * Sets multiple properties, and sometimes attributes, on an element. Note that\n * properties are simply object properties on the element instance, while\n * attributes are visible in the DOM. Many properties map to attributes with the\n * same names, some with different names, and there are also unmappable cases.\n *\n * This method sets properties by default (which means that custom attributes\n * are not supported). These are the exeptions (some of which is legacy):\n * - \"style\": Even though this is an attribute name, it is translated to a\n *   property, \"style.cssText\". Note that this property sanitizes and formats\n *   its value, unlike the attribute.\n * - \"class\": This is an attribute name, it is translated to the \"className\"\n *   property.\n * - \"for\": This is an attribute name, it is translated to the \"htmlFor\"\n *   property.\n * - Entries in {@see goog.dom.DIRECT_ATTRIBUTE_MAP_} are set as attributes,\n *   this is probably due to browser quirks.\n * - \"aria-*\", \"data-*\": Always set as attributes, they have no property\n *   counterparts.\n *\n * @param {Element} element DOM node to set properties on.\n * @param {Object} properties Hash of property:value pairs.\n */\ngoog.dom.setProperties = function(element, properties) {\n  goog.object.forEach(properties, function(val, key) {\n    if (key == 'style') {\n      element.style.cssText = val;\n    } else if (key == 'class') {\n      element.className = val;\n    } else if (key == 'for') {\n      element.htmlFor = val;\n    } else if (goog.dom.DIRECT_ATTRIBUTE_MAP_.hasOwnProperty(key)) {\n      element.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[key], val);\n    } else if (\n        goog.string.startsWith(key, 'aria-') ||\n        goog.string.startsWith(key, 'data-')) {\n      element.setAttribute(key, val);\n    } else {\n      element[key] = val;\n    }\n  });\n};\n\n\n/**\n * Map of attributes that should be set using\n * element.setAttribute(key, val) instead of element[key] = val.  Used\n * by goog.dom.setProperties.\n *\n * @private {!Object<string, string>}\n * @const\n */\ngoog.dom.DIRECT_ATTRIBUTE_MAP_ = {\n  'cellpadding': 'cellPadding',\n  'cellspacing': 'cellSpacing',\n  'colspan': 'colSpan',\n  'frameborder': 'frameBorder',\n  'height': 'height',\n  'maxlength': 'maxLength',\n  'nonce': 'nonce',\n  'role': 'role',\n  'rowspan': 'rowSpan',\n  'type': 'type',\n  'usemap': 'useMap',\n  'valign': 'vAlign',\n  'width': 'width'\n};\n\n\n/**\n * Gets the dimensions of the viewport.\n *\n * Gecko Standards mode:\n * docEl.clientWidth  Width of viewport excluding scrollbar.\n * win.innerWidth     Width of viewport including scrollbar.\n * body.clientWidth   Width of body element.\n *\n * docEl.clientHeight Height of viewport excluding scrollbar.\n * win.innerHeight    Height of viewport including scrollbar.\n * body.clientHeight  Height of document.\n *\n * Gecko Backwards compatible mode:\n * docEl.clientWidth  Width of viewport excluding scrollbar.\n * win.innerWidth     Width of viewport including scrollbar.\n * body.clientWidth   Width of viewport excluding scrollbar.\n *\n * docEl.clientHeight Height of document.\n * win.innerHeight    Height of viewport including scrollbar.\n * body.clientHeight  Height of viewport excluding scrollbar.\n *\n * IE6/7 Standards mode:\n * docEl.clientWidth  Width of viewport excluding scrollbar.\n * win.innerWidth     Undefined.\n * body.clientWidth   Width of body element.\n *\n * docEl.clientHeight Height of viewport excluding scrollbar.\n * win.innerHeight    Undefined.\n * body.clientHeight  Height of document element.\n *\n * IE5 + IE6/7 Backwards compatible mode:\n * docEl.clientWidth  0.\n * win.innerWidth     Undefined.\n * body.clientWidth   Width of viewport excluding scrollbar.\n *\n * docEl.clientHeight 0.\n * win.innerHeight    Undefined.\n * body.clientHeight  Height of viewport excluding scrollbar.\n *\n * Opera 9 Standards and backwards compatible mode:\n * docEl.clientWidth  Width of viewport excluding scrollbar.\n * win.innerWidth     Width of viewport including scrollbar.\n * body.clientWidth   Width of viewport excluding scrollbar.\n *\n * docEl.clientHeight Height of document.\n * win.innerHeight    Height of viewport including scrollbar.\n * body.clientHeight  Height of viewport excluding scrollbar.\n *\n * WebKit:\n * Safari 2\n * docEl.clientHeight Same as scrollHeight.\n * docEl.clientWidth  Same as innerWidth.\n * win.innerWidth     Width of viewport excluding scrollbar.\n * win.innerHeight    Height of the viewport including scrollbar.\n * frame.innerHeight  Height of the viewport exluding scrollbar.\n *\n * Safari 3 (tested in 522)\n *\n * docEl.clientWidth  Width of viewport excluding scrollbar.\n * docEl.clientHeight Height of viewport excluding scrollbar in strict mode.\n * body.clientHeight  Height of viewport excluding scrollbar in quirks mode.\n *\n * @param {Window=} opt_window Optional window element to test.\n * @return {!goog.math.Size} Object with values 'width' and 'height'.\n */\ngoog.dom.getViewportSize = function(opt_window) {\n  // TODO(arv): This should not take an argument\n  return goog.dom.getViewportSize_(opt_window || window);\n};\n\n\n/**\n * Helper for {@code getViewportSize}.\n * @param {Window} win The window to get the view port size for.\n * @return {!goog.math.Size} Object with values 'width' and 'height'.\n * @private\n */\ngoog.dom.getViewportSize_ = function(win) {\n  var doc = win.document;\n  var el = goog.dom.isCss1CompatMode_(doc) ? doc.documentElement : doc.body;\n  return new goog.math.Size(el.clientWidth, el.clientHeight);\n};\n\n\n/**\n * Calculates the height of the document.\n *\n * @return {number} The height of the current document.\n */\ngoog.dom.getDocumentHeight = function() {\n  return goog.dom.getDocumentHeight_(window);\n};\n\n/**\n * Calculates the height of the document of the given window.\n *\n * @param {!Window} win The window whose document height to retrieve.\n * @return {number} The height of the document of the given window.\n */\ngoog.dom.getDocumentHeightForWindow = function(win) {\n  return goog.dom.getDocumentHeight_(win);\n};\n\n/**\n * Calculates the height of the document of the given window.\n *\n * Function code copied from the opensocial gadget api:\n *   gadgets.window.adjustHeight(opt_height)\n *\n * @private\n * @param {!Window} win The window whose document height to retrieve.\n * @return {number} The height of the document of the given window.\n */\ngoog.dom.getDocumentHeight_ = function(win) {\n  // NOTE(eae): This method will return the window size rather than the document\n  // size in webkit quirks mode.\n  var doc = win.document;\n  var height = 0;\n\n  if (doc) {\n    // Calculating inner content height is hard and different between\n    // browsers rendering in Strict vs. Quirks mode.  We use a combination of\n    // three properties within document.body and document.documentElement:\n    // - scrollHeight\n    // - offsetHeight\n    // - clientHeight\n    // These values differ significantly between browsers and rendering modes.\n    // But there are patterns.  It just takes a lot of time and persistence\n    // to figure out.\n\n    var body = doc.body;\n    var docEl = /** @type {!HTMLElement} */ (doc.documentElement);\n    if (!(docEl && body)) {\n      return 0;\n    }\n\n    // Get the height of the viewport\n    var vh = goog.dom.getViewportSize_(win).height;\n    if (goog.dom.isCss1CompatMode_(doc) && docEl.scrollHeight) {\n      // In Strict mode:\n      // The inner content height is contained in either:\n      //    document.documentElement.scrollHeight\n      //    document.documentElement.offsetHeight\n      // Based on studying the values output by different browsers,\n      // use the value that's NOT equal to the viewport height found above.\n      height =\n          docEl.scrollHeight != vh ? docEl.scrollHeight : docEl.offsetHeight;\n    } else {\n      // In Quirks mode:\n      // documentElement.clientHeight is equal to documentElement.offsetHeight\n      // except in IE.  In most browsers, document.documentElement can be used\n      // to calculate the inner content height.\n      // However, in other browsers (e.g. IE), document.body must be used\n      // instead.  How do we know which one to use?\n      // If document.documentElement.clientHeight does NOT equal\n      // document.documentElement.offsetHeight, then use document.body.\n      var sh = docEl.scrollHeight;\n      var oh = docEl.offsetHeight;\n      if (docEl.clientHeight != oh) {\n        sh = body.scrollHeight;\n        oh = body.offsetHeight;\n      }\n\n      // Detect whether the inner content height is bigger or smaller\n      // than the bounding box (viewport).  If bigger, take the larger\n      // value.  If smaller, take the smaller value.\n      if (sh > vh) {\n        // Content is larger\n        height = sh > oh ? sh : oh;\n      } else {\n        // Content is smaller\n        height = sh < oh ? sh : oh;\n      }\n    }\n  }\n\n  return height;\n};\n\n\n/**\n * Gets the page scroll distance as a coordinate object.\n *\n * @param {Window=} opt_window Optional window element to test.\n * @return {!goog.math.Coordinate} Object with values 'x' and 'y'.\n * @deprecated Use {@link goog.dom.getDocumentScroll} instead.\n */\ngoog.dom.getPageScroll = function(opt_window) {\n  var win = opt_window || goog.global || window;\n  return goog.dom.getDomHelper(win.document).getDocumentScroll();\n};\n\n\n/**\n * Gets the document scroll distance as a coordinate object.\n *\n * @return {!goog.math.Coordinate} Object with values 'x' and 'y'.\n */\ngoog.dom.getDocumentScroll = function() {\n  return goog.dom.getDocumentScroll_(document);\n};\n\n\n/**\n * Helper for {@code getDocumentScroll}.\n *\n * @param {!Document} doc The document to get the scroll for.\n * @return {!goog.math.Coordinate} Object with values 'x' and 'y'.\n * @private\n */\ngoog.dom.getDocumentScroll_ = function(doc) {\n  var el = goog.dom.getDocumentScrollElement_(doc);\n  var win = goog.dom.getWindow_(doc);\n  if (goog.userAgent.IE && goog.userAgent.isVersionOrHigher('10') &&\n      win.pageYOffset != el.scrollTop) {\n    // The keyboard on IE10 touch devices shifts the page using the pageYOffset\n    // without modifying scrollTop. For this case, we want the body scroll\n    // offsets.\n    return new goog.math.Coordinate(el.scrollLeft, el.scrollTop);\n  }\n  return new goog.math.Coordinate(\n      win.pageXOffset || el.scrollLeft, win.pageYOffset || el.scrollTop);\n};\n\n\n/**\n * Gets the document scroll element.\n * @return {!Element} Scrolling element.\n */\ngoog.dom.getDocumentScrollElement = function() {\n  return goog.dom.getDocumentScrollElement_(document);\n};\n\n\n/**\n * Helper for {@code getDocumentScrollElement}.\n * @param {!Document} doc The document to get the scroll element for.\n * @return {!Element} Scrolling element.\n * @private\n */\ngoog.dom.getDocumentScrollElement_ = function(doc) {\n  // Old WebKit needs body.scrollLeft in both quirks mode and strict mode. We\n  // also default to the documentElement if the document does not have a body\n  // (e.g. a SVG document).\n  // Uses http://dev.w3.org/csswg/cssom-view/#dom-document-scrollingelement to\n  // avoid trying to guess about browser behavior from the UA string.\n  if (doc.scrollingElement) {\n    return doc.scrollingElement;\n  }\n  if (!goog.userAgent.WEBKIT && goog.dom.isCss1CompatMode_(doc)) {\n    return doc.documentElement;\n  }\n  return doc.body || doc.documentElement;\n};\n\n\n/**\n * Gets the window object associated with the given document.\n *\n * @param {Document=} opt_doc  Document object to get window for.\n * @return {!Window} The window associated with the given document.\n */\ngoog.dom.getWindow = function(opt_doc) {\n  // TODO(arv): This should not take an argument.\n  return opt_doc ? goog.dom.getWindow_(opt_doc) : window;\n};\n\n\n/**\n * Helper for {@code getWindow}.\n *\n * @param {!Document} doc  Document object to get window for.\n * @return {!Window} The window associated with the given document.\n * @private\n */\ngoog.dom.getWindow_ = function(doc) {\n  return doc.parentWindow || doc.defaultView;\n};\n\n\n/**\n * Returns a dom node with a set of attributes.  This function accepts varargs\n * for subsequent nodes to be added.  Subsequent nodes will be added to the\n * first node as childNodes.\n *\n * So:\n * <code>createDom(goog.dom.TagName.DIV, null, createDom(goog.dom.TagName.P), createDom(goog.dom.TagName.P));</code>\n * would return a div with two child paragraphs\n *\n * For passing properties, please see {@link goog.dom.setProperties} for more\n * information.\n *\n * @param {string|!goog.dom.TagName<T>} tagName Tag to create.\n * @param {(Object|Array<string>|string)=} opt_properties If object, then a map\n *     of name-value pairs for properties. If a string, then this is the\n *     className of the new element. If an array, the elements will be joined\n *     together as the className of the new element.\n * @param {...(Object|string|Array|NodeList)} var_args Further DOM nodes or\n *     strings for text nodes. If one of the var_args is an array or NodeList,\n *     its elements will be added as childNodes instead.\n * @return {R} Reference to a DOM node. The return type is {!Element} if tagName\n *     is a string or a more specific type if it is a member of\n *     goog.dom.TagName (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.createDom = function(tagName, opt_properties, var_args) {\n  return goog.dom.createDom_(document, arguments);\n};\n\n\n/**\n * Helper for {@code createDom}.\n * @param {!Document} doc The document to create the DOM in.\n * @param {!Arguments} args Argument object passed from the callers. See\n *     {@code goog.dom.createDom} for details.\n * @return {!Element} Reference to a DOM node.\n * @private\n */\ngoog.dom.createDom_ = function(doc, args) {\n  var tagName = String(args[0]);\n  var attributes = args[1];\n\n  // Internet Explorer is dumb:\n  // name: https://msdn.microsoft.com/en-us/library/ms534184(v=vs.85).aspx\n  // type: https://msdn.microsoft.com/en-us/library/ms534700(v=vs.85).aspx\n  // Also does not allow setting of 'type' attribute on 'input' or 'button'.\n  if (!goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES && attributes &&\n      (attributes.name || attributes.type)) {\n    var tagNameArr = ['<', tagName];\n    if (attributes.name) {\n      tagNameArr.push(' name=\"', goog.string.htmlEscape(attributes.name), '\"');\n    }\n    if (attributes.type) {\n      tagNameArr.push(' type=\"', goog.string.htmlEscape(attributes.type), '\"');\n\n      // Clone attributes map to remove 'type' without mutating the input.\n      var clone = {};\n      goog.object.extend(clone, attributes);\n\n      // JSCompiler can't see how goog.object.extend added this property,\n      // because it was essentially added by reflection.\n      // So it needs to be quoted.\n      delete clone['type'];\n\n      attributes = clone;\n    }\n    tagNameArr.push('>');\n    tagName = tagNameArr.join('');\n  }\n\n  var element = doc.createElement(tagName);\n\n  if (attributes) {\n    if (goog.isString(attributes)) {\n      element.className = attributes;\n    } else if (goog.isArray(attributes)) {\n      element.className = attributes.join(' ');\n    } else {\n      goog.dom.setProperties(element, attributes);\n    }\n  }\n\n  if (args.length > 2) {\n    goog.dom.append_(doc, element, args, 2);\n  }\n\n  return element;\n};\n\n\n/**\n * Appends a node with text or other nodes.\n * @param {!Document} doc The document to create new nodes in.\n * @param {!Node} parent The node to append nodes to.\n * @param {!Arguments} args The values to add. See {@code goog.dom.append}.\n * @param {number} startIndex The index of the array to start from.\n * @private\n */\ngoog.dom.append_ = function(doc, parent, args, startIndex) {\n  function childHandler(child) {\n    // TODO(user): More coercion, ala MochiKit?\n    if (child) {\n      parent.appendChild(\n          goog.isString(child) ? doc.createTextNode(child) : child);\n    }\n  }\n\n  for (var i = startIndex; i < args.length; i++) {\n    var arg = args[i];\n    // TODO(attila): Fix isArrayLike to return false for a text node.\n    if (goog.isArrayLike(arg) && !goog.dom.isNodeLike(arg)) {\n      // If the argument is a node list, not a real array, use a clone,\n      // because forEach can't be used to mutate a NodeList.\n      goog.array.forEach(\n          goog.dom.isNodeList(arg) ? goog.array.toArray(arg) : arg,\n          childHandler);\n    } else {\n      childHandler(arg);\n    }\n  }\n};\n\n\n/**\n * Alias for {@code createDom}.\n * @param {string|!goog.dom.TagName<T>} tagName Tag to create.\n * @param {(string|Object)=} opt_properties If object, then a map of name-value\n *     pairs for properties. If a string, then this is the className of the new\n *     element.\n * @param {...(Object|string|Array|NodeList)} var_args Further DOM nodes or\n *     strings for text nodes. If one of the var_args is an array, its\n *     children will be added as childNodes instead.\n * @return {R} Reference to a DOM node. The return type is {!Element} if tagName\n *     is a string or a more specific type if it is a member of\n *     goog.dom.TagName (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n * @deprecated Use {@link goog.dom.createDom} instead.\n */\ngoog.dom.$dom = goog.dom.createDom;\n\n\n/**\n * Creates a new element.\n * @param {string|!goog.dom.TagName<T>} name Tag to create.\n * @return {R} The new element. The return type is {!Element} if name is\n *     a string or a more specific type if it is a member of goog.dom.TagName\n *     (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.createElement = function(name) {\n  return goog.dom.createElement_(document, name);\n};\n\n\n/**\n * Creates a new element.\n * @param {!Document} doc The document to create the element in.\n * @param {string|!goog.dom.TagName<T>} name Tag to create.\n * @return {R} The new element. The return type is {!Element} if name is\n *     a string or a more specific type if it is a member of goog.dom.TagName\n *     (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n * @private\n */\ngoog.dom.createElement_ = function(doc, name) {\n  return doc.createElement(String(name));\n};\n\n\n/**\n * Creates a new text node.\n * @param {number|string} content Content.\n * @return {!Text} The new text node.\n */\ngoog.dom.createTextNode = function(content) {\n  return document.createTextNode(String(content));\n};\n\n\n/**\n * Create a table.\n * @param {number} rows The number of rows in the table.  Must be >= 1.\n * @param {number} columns The number of columns in the table.  Must be >= 1.\n * @param {boolean=} opt_fillWithNbsp If true, fills table entries with\n *     {@code goog.string.Unicode.NBSP} characters.\n * @return {!Element} The created table.\n */\ngoog.dom.createTable = function(rows, columns, opt_fillWithNbsp) {\n  // TODO(mlourenco): Return HTMLTableElement, also in prototype function.\n  // Callers need to be updated to e.g. not assign numbers to table.cellSpacing.\n  return goog.dom.createTable_(document, rows, columns, !!opt_fillWithNbsp);\n};\n\n\n/**\n * Create a table.\n * @param {!Document} doc Document object to use to create the table.\n * @param {number} rows The number of rows in the table.  Must be >= 1.\n * @param {number} columns The number of columns in the table.  Must be >= 1.\n * @param {boolean} fillWithNbsp If true, fills table entries with\n *     {@code goog.string.Unicode.NBSP} characters.\n * @return {!HTMLTableElement} The created table.\n * @private\n */\ngoog.dom.createTable_ = function(doc, rows, columns, fillWithNbsp) {\n  var table = goog.dom.createElement_(doc, goog.dom.TagName.TABLE);\n  var tbody =\n      table.appendChild(goog.dom.createElement_(doc, goog.dom.TagName.TBODY));\n  for (var i = 0; i < rows; i++) {\n    var tr = goog.dom.createElement_(doc, goog.dom.TagName.TR);\n    for (var j = 0; j < columns; j++) {\n      var td = goog.dom.createElement_(doc, goog.dom.TagName.TD);\n      // IE <= 9 will create a text node if we set text content to the empty\n      // string, so we avoid doing it unless necessary. This ensures that the\n      // same DOM tree is returned on all browsers.\n      if (fillWithNbsp) {\n        goog.dom.setTextContent(td, goog.string.Unicode.NBSP);\n      }\n      tr.appendChild(td);\n    }\n    tbody.appendChild(tr);\n  }\n  return table;\n};\n\n\n\n/**\n * Creates a new Node from constant strings of HTML markup.\n * @param {...!goog.string.Const} var_args The HTML strings to concatenate then\n *     convert into a node.\n * @return {!Node}\n */\ngoog.dom.constHtmlToNode = function(var_args) {\n  var stringArray = goog.array.map(arguments, goog.string.Const.unwrap);\n  var safeHtml =\n      goog.html.uncheckedconversions\n          .safeHtmlFromStringKnownToSatisfyTypeContract(\n              goog.string.Const.from(\n                  'Constant HTML string, that gets turned into a ' +\n                  'Node later, so it will be automatically balanced.'),\n              stringArray.join(''));\n  return goog.dom.safeHtmlToNode(safeHtml);\n};\n\n\n/**\n * Converts HTML markup into a node. This is a safe version of\n * {@code goog.dom.htmlToDocumentFragment} which is now deleted.\n * @param {!goog.html.SafeHtml} html The HTML markup to convert.\n * @return {!Node} The resulting node.\n */\ngoog.dom.safeHtmlToNode = function(html) {\n  return goog.dom.safeHtmlToNode_(document, html);\n};\n\n\n/**\n * Helper for {@code safeHtmlToNode}.\n * @param {!Document} doc The document.\n * @param {!goog.html.SafeHtml} html The HTML markup to convert.\n * @return {!Node} The resulting node.\n * @private\n */\ngoog.dom.safeHtmlToNode_ = function(doc, html) {\n  var tempDiv = goog.dom.createElement_(doc, goog.dom.TagName.DIV);\n  if (goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT) {\n    goog.dom.safe.setInnerHtml(\n        tempDiv, goog.html.SafeHtml.concat(goog.html.SafeHtml.BR, html));\n    tempDiv.removeChild(tempDiv.firstChild);\n  } else {\n    goog.dom.safe.setInnerHtml(tempDiv, html);\n  }\n  return goog.dom.childrenToNode_(doc, tempDiv);\n};\n\n\n/**\n * Helper for {@code safeHtmlToNode_}.\n * @param {!Document} doc The document.\n * @param {!Node} tempDiv The input node.\n * @return {!Node} The resulting node.\n * @private\n */\ngoog.dom.childrenToNode_ = function(doc, tempDiv) {\n  if (tempDiv.childNodes.length == 1) {\n    return tempDiv.removeChild(tempDiv.firstChild);\n  } else {\n    var fragment = doc.createDocumentFragment();\n    while (tempDiv.firstChild) {\n      fragment.appendChild(tempDiv.firstChild);\n    }\n    return fragment;\n  }\n};\n\n\n/**\n * Returns true if the browser is in \"CSS1-compatible\" (standards-compliant)\n * mode, false otherwise.\n * @return {boolean} True if in CSS1-compatible mode.\n */\ngoog.dom.isCss1CompatMode = function() {\n  return goog.dom.isCss1CompatMode_(document);\n};\n\n\n/**\n * Returns true if the browser is in \"CSS1-compatible\" (standards-compliant)\n * mode, false otherwise.\n * @param {!Document} doc The document to check.\n * @return {boolean} True if in CSS1-compatible mode.\n * @private\n */\ngoog.dom.isCss1CompatMode_ = function(doc) {\n  if (goog.dom.COMPAT_MODE_KNOWN_) {\n    return goog.dom.ASSUME_STANDARDS_MODE;\n  }\n\n  return doc.compatMode == 'CSS1Compat';\n};\n\n\n/**\n * Determines if the given node can contain children, intended to be used for\n * HTML generation.\n *\n * IE natively supports node.canHaveChildren but has inconsistent behavior.\n * Prior to IE8 the base tag allows children and in IE9 all nodes return true\n * for canHaveChildren.\n *\n * In practice all non-IE browsers allow you to add children to any node, but\n * the behavior is inconsistent:\n *\n * <pre>\n *   var a = goog.dom.createElement(goog.dom.TagName.BR);\n *   a.appendChild(document.createTextNode('foo'));\n *   a.appendChild(document.createTextNode('bar'));\n *   console.log(a.childNodes.length);  // 2\n *   console.log(a.innerHTML);  // Chrome: \"\", IE9: \"foobar\", FF3.5: \"foobar\"\n * </pre>\n *\n * For more information, see:\n * http://dev.w3.org/html5/markup/syntax.html#syntax-elements\n *\n * TODO(user): Rename shouldAllowChildren() ?\n *\n * @param {Node} node The node to check.\n * @return {boolean} Whether the node can contain children.\n */\ngoog.dom.canHaveChildren = function(node) {\n  if (node.nodeType != goog.dom.NodeType.ELEMENT) {\n    return false;\n  }\n  switch (/** @type {!Element} */ (node).tagName) {\n    case String(goog.dom.TagName.APPLET):\n    case String(goog.dom.TagName.AREA):\n    case String(goog.dom.TagName.BASE):\n    case String(goog.dom.TagName.BR):\n    case String(goog.dom.TagName.COL):\n    case String(goog.dom.TagName.COMMAND):\n    case String(goog.dom.TagName.EMBED):\n    case String(goog.dom.TagName.FRAME):\n    case String(goog.dom.TagName.HR):\n    case String(goog.dom.TagName.IMG):\n    case String(goog.dom.TagName.INPUT):\n    case String(goog.dom.TagName.IFRAME):\n    case String(goog.dom.TagName.ISINDEX):\n    case String(goog.dom.TagName.KEYGEN):\n    case String(goog.dom.TagName.LINK):\n    case String(goog.dom.TagName.NOFRAMES):\n    case String(goog.dom.TagName.NOSCRIPT):\n    case String(goog.dom.TagName.META):\n    case String(goog.dom.TagName.OBJECT):\n    case String(goog.dom.TagName.PARAM):\n    case String(goog.dom.TagName.SCRIPT):\n    case String(goog.dom.TagName.SOURCE):\n    case String(goog.dom.TagName.STYLE):\n    case String(goog.dom.TagName.TRACK):\n    case String(goog.dom.TagName.WBR):\n      return false;\n  }\n  return true;\n};\n\n\n/**\n * Appends a child to a node.\n * @param {Node} parent Parent.\n * @param {Node} child Child.\n */\ngoog.dom.appendChild = function(parent, child) {\n  parent.appendChild(child);\n};\n\n\n/**\n * Appends a node with text or other nodes.\n * @param {!Node} parent The node to append nodes to.\n * @param {...goog.dom.Appendable} var_args The things to append to the node.\n *     If this is a Node it is appended as is.\n *     If this is a string then a text node is appended.\n *     If this is an array like object then fields 0 to length - 1 are appended.\n */\ngoog.dom.append = function(parent, var_args) {\n  goog.dom.append_(goog.dom.getOwnerDocument(parent), parent, arguments, 1);\n};\n\n\n/**\n * Removes all the child nodes on a DOM node.\n * @param {Node} node Node to remove children from.\n */\ngoog.dom.removeChildren = function(node) {\n  // Note: Iterations over live collections can be slow, this is the fastest\n  // we could find. The double parenthesis are used to prevent JsCompiler and\n  // strict warnings.\n  var child;\n  while ((child = node.firstChild)) {\n    node.removeChild(child);\n  }\n};\n\n\n/**\n * Inserts a new node before an existing reference node (i.e. as the previous\n * sibling). If the reference node has no parent, then does nothing.\n * @param {Node} newNode Node to insert.\n * @param {Node} refNode Reference node to insert before.\n */\ngoog.dom.insertSiblingBefore = function(newNode, refNode) {\n  if (refNode.parentNode) {\n    refNode.parentNode.insertBefore(newNode, refNode);\n  }\n};\n\n\n/**\n * Inserts a new node after an existing reference node (i.e. as the next\n * sibling). If the reference node has no parent, then does nothing.\n * @param {Node} newNode Node to insert.\n * @param {Node} refNode Reference node to insert after.\n */\ngoog.dom.insertSiblingAfter = function(newNode, refNode) {\n  if (refNode.parentNode) {\n    refNode.parentNode.insertBefore(newNode, refNode.nextSibling);\n  }\n};\n\n\n/**\n * Insert a child at a given index. If index is larger than the number of child\n * nodes that the parent currently has, the node is inserted as the last child\n * node.\n * @param {Element} parent The element into which to insert the child.\n * @param {Node} child The element to insert.\n * @param {number} index The index at which to insert the new child node. Must\n *     not be negative.\n */\ngoog.dom.insertChildAt = function(parent, child, index) {\n  // Note that if the second argument is null, insertBefore\n  // will append the child at the end of the list of children.\n  parent.insertBefore(child, parent.childNodes[index] || null);\n};\n\n\n/**\n * Removes a node from its parent.\n * @param {Node} node The node to remove.\n * @return {Node} The node removed if removed; else, null.\n */\ngoog.dom.removeNode = function(node) {\n  return node && node.parentNode ? node.parentNode.removeChild(node) : null;\n};\n\n\n/**\n * Replaces a node in the DOM tree. Will do nothing if {@code oldNode} has no\n * parent.\n * @param {Node} newNode Node to insert.\n * @param {Node} oldNode Node to replace.\n */\ngoog.dom.replaceNode = function(newNode, oldNode) {\n  var parent = oldNode.parentNode;\n  if (parent) {\n    parent.replaceChild(newNode, oldNode);\n  }\n};\n\n\n/**\n * Flattens an element. That is, removes it and replace it with its children.\n * Does nothing if the element is not in the document.\n * @param {Element} element The element to flatten.\n * @return {Element|undefined} The original element, detached from the document\n *     tree, sans children; or undefined, if the element was not in the document\n *     to begin with.\n */\ngoog.dom.flattenElement = function(element) {\n  var child, parent = element.parentNode;\n  if (parent && parent.nodeType != goog.dom.NodeType.DOCUMENT_FRAGMENT) {\n    // Use IE DOM method (supported by Opera too) if available\n    if (element.removeNode) {\n      return /** @type {Element} */ (element.removeNode(false));\n    } else {\n      // Move all children of the original node up one level.\n      while ((child = element.firstChild)) {\n        parent.insertBefore(child, element);\n      }\n\n      // Detach the original element.\n      return /** @type {Element} */ (goog.dom.removeNode(element));\n    }\n  }\n};\n\n\n/**\n * Returns an array containing just the element children of the given element.\n * @param {Element} element The element whose element children we want.\n * @return {!(Array<!Element>|NodeList<!Element>)} An array or array-like list\n *     of just the element children of the given element.\n */\ngoog.dom.getChildren = function(element) {\n  // We check if the children attribute is supported for child elements\n  // since IE8 misuses the attribute by also including comments.\n  if (goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE &&\n      element.children != undefined) {\n    return element.children;\n  }\n  // Fall back to manually filtering the element's child nodes.\n  return goog.array.filter(element.childNodes, function(node) {\n    return node.nodeType == goog.dom.NodeType.ELEMENT;\n  });\n};\n\n\n/**\n * Returns the first child node that is an element.\n * @param {Node} node The node to get the first child element of.\n * @return {Element} The first child node of {@code node} that is an element.\n */\ngoog.dom.getFirstElementChild = function(node) {\n  if (goog.isDef(node.firstElementChild)) {\n    return /** @type {!Element} */ (node).firstElementChild;\n  }\n  return goog.dom.getNextElementNode_(node.firstChild, true);\n};\n\n\n/**\n * Returns the last child node that is an element.\n * @param {Node} node The node to get the last child element of.\n * @return {Element} The last child node of {@code node} that is an element.\n */\ngoog.dom.getLastElementChild = function(node) {\n  if (goog.isDef(node.lastElementChild)) {\n    return /** @type {!Element} */ (node).lastElementChild;\n  }\n  return goog.dom.getNextElementNode_(node.lastChild, false);\n};\n\n\n/**\n * Returns the first next sibling that is an element.\n * @param {Node} node The node to get the next sibling element of.\n * @return {Element} The next sibling of {@code node} that is an element.\n */\ngoog.dom.getNextElementSibling = function(node) {\n  if (goog.isDef(node.nextElementSibling)) {\n    return /** @type {!Element} */ (node).nextElementSibling;\n  }\n  return goog.dom.getNextElementNode_(node.nextSibling, true);\n};\n\n\n/**\n * Returns the first previous sibling that is an element.\n * @param {Node} node The node to get the previous sibling element of.\n * @return {Element} The first previous sibling of {@code node} that is\n *     an element.\n */\ngoog.dom.getPreviousElementSibling = function(node) {\n  if (goog.isDef(node.previousElementSibling)) {\n    return /** @type {!Element} */ (node).previousElementSibling;\n  }\n  return goog.dom.getNextElementNode_(node.previousSibling, false);\n};\n\n\n/**\n * Returns the first node that is an element in the specified direction,\n * starting with {@code node}.\n * @param {Node} node The node to get the next element from.\n * @param {boolean} forward Whether to look forwards or backwards.\n * @return {Element} The first element.\n * @private\n */\ngoog.dom.getNextElementNode_ = function(node, forward) {\n  while (node && node.nodeType != goog.dom.NodeType.ELEMENT) {\n    node = forward ? node.nextSibling : node.previousSibling;\n  }\n\n  return /** @type {Element} */ (node);\n};\n\n\n/**\n * Returns the next node in source order from the given node.\n * @param {Node} node The node.\n * @return {Node} The next node in the DOM tree, or null if this was the last\n *     node.\n */\ngoog.dom.getNextNode = function(node) {\n  if (!node) {\n    return null;\n  }\n\n  if (node.firstChild) {\n    return node.firstChild;\n  }\n\n  while (node && !node.nextSibling) {\n    node = node.parentNode;\n  }\n\n  return node ? node.nextSibling : null;\n};\n\n\n/**\n * Returns the previous node in source order from the given node.\n * @param {Node} node The node.\n * @return {Node} The previous node in the DOM tree, or null if this was the\n *     first node.\n */\ngoog.dom.getPreviousNode = function(node) {\n  if (!node) {\n    return null;\n  }\n\n  if (!node.previousSibling) {\n    return node.parentNode;\n  }\n\n  node = node.previousSibling;\n  while (node && node.lastChild) {\n    node = node.lastChild;\n  }\n\n  return node;\n};\n\n\n/**\n * Whether the object looks like a DOM node.\n * @param {?} obj The object being tested for node likeness.\n * @return {boolean} Whether the object looks like a DOM node.\n */\ngoog.dom.isNodeLike = function(obj) {\n  return goog.isObject(obj) && obj.nodeType > 0;\n};\n\n\n/**\n * Whether the object looks like an Element.\n * @param {?} obj The object being tested for Element likeness.\n * @return {boolean} Whether the object looks like an Element.\n */\ngoog.dom.isElement = function(obj) {\n  return goog.isObject(obj) && obj.nodeType == goog.dom.NodeType.ELEMENT;\n};\n\n\n/**\n * Returns true if the specified value is a Window object. This includes the\n * global window for HTML pages, and iframe windows.\n * @param {?} obj Variable to test.\n * @return {boolean} Whether the variable is a window.\n */\ngoog.dom.isWindow = function(obj) {\n  return goog.isObject(obj) && obj['window'] == obj;\n};\n\n\n/**\n * Returns an element's parent, if it's an Element.\n * @param {Element} element The DOM element.\n * @return {Element} The parent, or null if not an Element.\n */\ngoog.dom.getParentElement = function(element) {\n  var parent;\n  if (goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY) {\n    var isIe9 = goog.userAgent.IE && goog.userAgent.isVersionOrHigher('9') &&\n        !goog.userAgent.isVersionOrHigher('10');\n    // SVG elements in IE9 can't use the parentElement property.\n    // goog.global['SVGElement'] is not defined in IE9 quirks mode.\n    if (!(isIe9 && goog.global['SVGElement'] &&\n          element instanceof goog.global['SVGElement'])) {\n      parent = element.parentElement;\n      if (parent) {\n        return parent;\n      }\n    }\n  }\n  parent = element.parentNode;\n  return goog.dom.isElement(parent) ? /** @type {!Element} */ (parent) : null;\n};\n\n\n/**\n * Whether a node contains another node.\n * @param {?Node} parent The node that should contain the other node.\n * @param {?Node} descendant The node to test presence of.\n * @return {boolean} Whether the parent node contains the descendent node.\n */\ngoog.dom.contains = function(parent, descendant) {\n  if (!parent || !descendant) {\n    return false;\n  }\n  // We use browser specific methods for this if available since it is faster\n  // that way.\n\n  // IE DOM\n  if (parent.contains && descendant.nodeType == goog.dom.NodeType.ELEMENT) {\n    return parent == descendant || parent.contains(descendant);\n  }\n\n  // W3C DOM Level 3\n  if (typeof parent.compareDocumentPosition != 'undefined') {\n    return parent == descendant ||\n        Boolean(parent.compareDocumentPosition(descendant) & 16);\n  }\n\n  // W3C DOM Level 1\n  while (descendant && parent != descendant) {\n    descendant = descendant.parentNode;\n  }\n  return descendant == parent;\n};\n\n\n/**\n * Compares the document order of two nodes, returning 0 if they are the same\n * node, a negative number if node1 is before node2, and a positive number if\n * node2 is before node1.  Note that we compare the order the tags appear in the\n * document so in the tree <b><i>text</i></b> the B node is considered to be\n * before the I node.\n *\n * @param {Node} node1 The first node to compare.\n * @param {Node} node2 The second node to compare.\n * @return {number} 0 if the nodes are the same node, a negative number if node1\n *     is before node2, and a positive number if node2 is before node1.\n */\ngoog.dom.compareNodeOrder = function(node1, node2) {\n  // Fall out quickly for equality.\n  if (node1 == node2) {\n    return 0;\n  }\n\n  // Use compareDocumentPosition where available\n  if (node1.compareDocumentPosition) {\n    // 4 is the bitmask for FOLLOWS.\n    return node1.compareDocumentPosition(node2) & 2 ? 1 : -1;\n  }\n\n  // Special case for document nodes on IE 7 and 8.\n  if (goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(9)) {\n    if (node1.nodeType == goog.dom.NodeType.DOCUMENT) {\n      return -1;\n    }\n    if (node2.nodeType == goog.dom.NodeType.DOCUMENT) {\n      return 1;\n    }\n  }\n\n  // Process in IE using sourceIndex - we check to see if the first node has\n  // a source index or if its parent has one.\n  if ('sourceIndex' in node1 ||\n      (node1.parentNode && 'sourceIndex' in node1.parentNode)) {\n    var isElement1 = node1.nodeType == goog.dom.NodeType.ELEMENT;\n    var isElement2 = node2.nodeType == goog.dom.NodeType.ELEMENT;\n\n    if (isElement1 && isElement2) {\n      return node1.sourceIndex - node2.sourceIndex;\n    } else {\n      var parent1 = node1.parentNode;\n      var parent2 = node2.parentNode;\n\n      if (parent1 == parent2) {\n        return goog.dom.compareSiblingOrder_(node1, node2);\n      }\n\n      if (!isElement1 && goog.dom.contains(parent1, node2)) {\n        return -1 * goog.dom.compareParentsDescendantNodeIe_(node1, node2);\n      }\n\n\n      if (!isElement2 && goog.dom.contains(parent2, node1)) {\n        return goog.dom.compareParentsDescendantNodeIe_(node2, node1);\n      }\n\n      return (isElement1 ? node1.sourceIndex : parent1.sourceIndex) -\n          (isElement2 ? node2.sourceIndex : parent2.sourceIndex);\n    }\n  }\n\n  // For Safari, we compare ranges.\n  var doc = goog.dom.getOwnerDocument(node1);\n\n  var range1, range2;\n  range1 = doc.createRange();\n  range1.selectNode(node1);\n  range1.collapse(true);\n\n  range2 = doc.createRange();\n  range2.selectNode(node2);\n  range2.collapse(true);\n\n  return range1.compareBoundaryPoints(\n      goog.global['Range'].START_TO_END, range2);\n};\n\n\n/**\n * Utility function to compare the position of two nodes, when\n * {@code textNode}'s parent is an ancestor of {@code node}.  If this entry\n * condition is not met, this function will attempt to reference a null object.\n * @param {!Node} textNode The textNode to compare.\n * @param {Node} node The node to compare.\n * @return {number} -1 if node is before textNode, +1 otherwise.\n * @private\n */\ngoog.dom.compareParentsDescendantNodeIe_ = function(textNode, node) {\n  var parent = textNode.parentNode;\n  if (parent == node) {\n    // If textNode is a child of node, then node comes first.\n    return -1;\n  }\n  var sibling = node;\n  while (sibling.parentNode != parent) {\n    sibling = sibling.parentNode;\n  }\n  return goog.dom.compareSiblingOrder_(sibling, textNode);\n};\n\n\n/**\n * Utility function to compare the position of two nodes known to be non-equal\n * siblings.\n * @param {Node} node1 The first node to compare.\n * @param {!Node} node2 The second node to compare.\n * @return {number} -1 if node1 is before node2, +1 otherwise.\n * @private\n */\ngoog.dom.compareSiblingOrder_ = function(node1, node2) {\n  var s = node2;\n  while ((s = s.previousSibling)) {\n    if (s == node1) {\n      // We just found node1 before node2.\n      return -1;\n    }\n  }\n\n  // Since we didn't find it, node1 must be after node2.\n  return 1;\n};\n\n\n/**\n * Find the deepest common ancestor of the given nodes.\n * @param {...Node} var_args The nodes to find a common ancestor of.\n * @return {Node} The common ancestor of the nodes, or null if there is none.\n *     null will only be returned if two or more of the nodes are from different\n *     documents.\n */\ngoog.dom.findCommonAncestor = function(var_args) {\n  var i, count = arguments.length;\n  if (!count) {\n    return null;\n  } else if (count == 1) {\n    return arguments[0];\n  }\n\n  var paths = [];\n  var minLength = Infinity;\n  for (i = 0; i < count; i++) {\n    // Compute the list of ancestors.\n    var ancestors = [];\n    var node = arguments[i];\n    while (node) {\n      ancestors.unshift(node);\n      node = node.parentNode;\n    }\n\n    // Save the list for comparison.\n    paths.push(ancestors);\n    minLength = Math.min(minLength, ancestors.length);\n  }\n  var output = null;\n  for (i = 0; i < minLength; i++) {\n    var first = paths[0][i];\n    for (var j = 1; j < count; j++) {\n      if (first != paths[j][i]) {\n        return output;\n      }\n    }\n    output = first;\n  }\n  return output;\n};\n\n\n/**\n * Returns the owner document for a node.\n * @param {Node|Window} node The node to get the document for.\n * @return {!Document} The document owning the node.\n */\ngoog.dom.getOwnerDocument = function(node) {\n  // TODO(nnaze): Update param signature to be non-nullable.\n  goog.asserts.assert(node, 'Node cannot be null or undefined.');\n  return /** @type {!Document} */ (\n      node.nodeType == goog.dom.NodeType.DOCUMENT ? node : node.ownerDocument ||\n              node.document);\n};\n\n\n/**\n * Cross-browser function for getting the document element of a frame or iframe.\n * @param {Element} frame Frame element.\n * @return {!Document} The frame content document.\n */\ngoog.dom.getFrameContentDocument = function(frame) {\n  return frame.contentDocument ||\n      /** @type {!HTMLFrameElement} */ (frame).contentWindow.document;\n};\n\n\n/**\n * Cross-browser function for getting the window of a frame or iframe.\n * @param {Element} frame Frame element.\n * @return {Window} The window associated with the given frame, or null if none\n *     exists.\n */\ngoog.dom.getFrameContentWindow = function(frame) {\n  try {\n    return frame.contentWindow ||\n        (frame.contentDocument ? goog.dom.getWindow(frame.contentDocument) :\n                                 null);\n  } catch (e) {\n    // NOTE(user): In IE8, checking the contentWindow or contentDocument\n    // properties will throw a \"Unspecified Error\" exception if the iframe is\n    // not inserted in the DOM. If we get this we can be sure that no window\n    // exists, so return null.\n  }\n  return null;\n};\n\n\n/**\n * Sets the text content of a node, with cross-browser support.\n * @param {Node} node The node to change the text content of.\n * @param {string|number} text The value that should replace the node's content.\n */\ngoog.dom.setTextContent = function(node, text) {\n  goog.asserts.assert(\n      node != null,\n      'goog.dom.setTextContent expects a non-null value for node');\n\n  if ('textContent' in node) {\n    node.textContent = text;\n  } else if (node.nodeType == goog.dom.NodeType.TEXT) {\n    node.data = text;\n  } else if (\n      node.firstChild && node.firstChild.nodeType == goog.dom.NodeType.TEXT) {\n    // If the first child is a text node we just change its data and remove the\n    // rest of the children.\n    while (node.lastChild != node.firstChild) {\n      node.removeChild(node.lastChild);\n    }\n    node.firstChild.data = text;\n  } else {\n    goog.dom.removeChildren(node);\n    var doc = goog.dom.getOwnerDocument(node);\n    node.appendChild(doc.createTextNode(String(text)));\n  }\n};\n\n\n/**\n * Gets the outerHTML of a node, which islike innerHTML, except that it\n * actually contains the HTML of the node itself.\n * @param {Element} element The element to get the HTML of.\n * @return {string} The outerHTML of the given element.\n */\ngoog.dom.getOuterHtml = function(element) {\n  goog.asserts.assert(\n      element !== null,\n      'goog.dom.getOuterHtml expects a non-null value for element');\n  // IE, Opera and WebKit all have outerHTML.\n  if ('outerHTML' in element) {\n    return element.outerHTML;\n  } else {\n    var doc = goog.dom.getOwnerDocument(element);\n    var div = goog.dom.createElement_(doc, goog.dom.TagName.DIV);\n    div.appendChild(element.cloneNode(true));\n    return div.innerHTML;\n  }\n};\n\n\n/**\n * Finds the first descendant node that matches the filter function, using\n * a depth first search. This function offers the most general purpose way\n * of finding a matching element. You may also wish to consider\n * {@code goog.dom.query} which can express many matching criteria using\n * CSS selector expressions. These expressions often result in a more\n * compact representation of the desired result.\n * @see goog.dom.query\n *\n * @param {Node} root The root of the tree to search.\n * @param {function(Node) : boolean} p The filter function.\n * @return {Node|undefined} The found node or undefined if none is found.\n */\ngoog.dom.findNode = function(root, p) {\n  var rv = [];\n  var found = goog.dom.findNodes_(root, p, rv, true);\n  return found ? rv[0] : undefined;\n};\n\n\n/**\n * Finds all the descendant nodes that match the filter function, using a\n * a depth first search. This function offers the most general-purpose way\n * of finding a set of matching elements. You may also wish to consider\n * {@code goog.dom.query} which can express many matching criteria using\n * CSS selector expressions. These expressions often result in a more\n * compact representation of the desired result.\n\n * @param {Node} root The root of the tree to search.\n * @param {function(Node) : boolean} p The filter function.\n * @return {!Array<!Node>} The found nodes or an empty array if none are found.\n */\ngoog.dom.findNodes = function(root, p) {\n  var rv = [];\n  goog.dom.findNodes_(root, p, rv, false);\n  return rv;\n};\n\n\n/**\n * Finds the first or all the descendant nodes that match the filter function,\n * using a depth first search.\n * @param {Node} root The root of the tree to search.\n * @param {function(Node) : boolean} p The filter function.\n * @param {!Array<!Node>} rv The found nodes are added to this array.\n * @param {boolean} findOne If true we exit after the first found node.\n * @return {boolean} Whether the search is complete or not. True in case findOne\n *     is true and the node is found. False otherwise.\n * @private\n */\ngoog.dom.findNodes_ = function(root, p, rv, findOne) {\n  if (root != null) {\n    var child = root.firstChild;\n    while (child) {\n      if (p(child)) {\n        rv.push(child);\n        if (findOne) {\n          return true;\n        }\n      }\n      if (goog.dom.findNodes_(child, p, rv, findOne)) {\n        return true;\n      }\n      child = child.nextSibling;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Map of tags whose content to ignore when calculating text length.\n * @private {!Object<string, number>}\n * @const\n */\ngoog.dom.TAGS_TO_IGNORE_ = {\n  'SCRIPT': 1,\n  'STYLE': 1,\n  'HEAD': 1,\n  'IFRAME': 1,\n  'OBJECT': 1\n};\n\n\n/**\n * Map of tags which have predefined values with regard to whitespace.\n * @private {!Object<string, string>}\n * @const\n */\ngoog.dom.PREDEFINED_TAG_VALUES_ = {\n  'IMG': ' ',\n  'BR': '\\n'\n};\n\n\n/**\n * Returns true if the element has a tab index that allows it to receive\n * keyboard focus (tabIndex >= 0), false otherwise.  Note that some elements\n * natively support keyboard focus, even if they have no tab index.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element has a tab index that allows keyboard\n *     focus.\n */\ngoog.dom.isFocusableTabIndex = function(element) {\n  return goog.dom.hasSpecifiedTabIndex_(element) &&\n      goog.dom.isTabIndexFocusable_(element);\n};\n\n\n/**\n * Enables or disables keyboard focus support on the element via its tab index.\n * Only elements for which {@link goog.dom.isFocusableTabIndex} returns true\n * (or elements that natively support keyboard focus, like form elements) can\n * receive keyboard focus.  See http://go/tabindex for more info.\n * @param {Element} element Element whose tab index is to be changed.\n * @param {boolean} enable Whether to set or remove a tab index on the element\n *     that supports keyboard focus.\n */\ngoog.dom.setFocusableTabIndex = function(element, enable) {\n  if (enable) {\n    element.tabIndex = 0;\n  } else {\n    // Set tabIndex to -1 first, then remove it. This is a workaround for\n    // Safari (confirmed in version 4 on Windows). When removing the attribute\n    // without setting it to -1 first, the element remains keyboard focusable\n    // despite not having a tabIndex attribute anymore.\n    element.tabIndex = -1;\n    element.removeAttribute('tabIndex');  // Must be camelCase!\n  }\n};\n\n\n/**\n * Returns true if the element can be focused, i.e. it has a tab index that\n * allows it to receive keyboard focus (tabIndex >= 0), or it is an element\n * that natively supports keyboard focus.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element allows keyboard focus.\n */\ngoog.dom.isFocusable = function(element) {\n  var focusable;\n  // Some elements can have unspecified tab index and still receive focus.\n  if (goog.dom.nativelySupportsFocus_(element)) {\n    // Make sure the element is not disabled ...\n    focusable = !element.disabled &&\n        // ... and if a tab index is specified, it allows focus.\n        (!goog.dom.hasSpecifiedTabIndex_(element) ||\n         goog.dom.isTabIndexFocusable_(element));\n  } else {\n    focusable = goog.dom.isFocusableTabIndex(element);\n  }\n\n  // IE requires elements to be visible in order to focus them.\n  return focusable && goog.userAgent.IE ?\n      goog.dom.hasNonZeroBoundingRect_(/** @type {!HTMLElement} */ (element)) :\n      focusable;\n};\n\n\n/**\n * Returns true if the element has a specified tab index.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element has a specified tab index.\n * @private\n */\ngoog.dom.hasSpecifiedTabIndex_ = function(element) {\n  // IE8 and below don't support hasAttribute(), instead check whether the\n  // 'tabindex' attributeNode is specified. Otherwise check hasAttribute().\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('9')) {\n    var attrNode = element.getAttributeNode('tabindex');  // Must be lowercase!\n    return goog.isDefAndNotNull(attrNode) && attrNode.specified;\n  } else {\n    return element.hasAttribute('tabindex');\n  }\n};\n\n\n/**\n * Returns true if the element's tab index allows the element to be focused.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element's tab index allows focus.\n * @private\n */\ngoog.dom.isTabIndexFocusable_ = function(element) {\n  var index = /** @type {!HTMLElement} */ (element).tabIndex;\n  // NOTE: IE9 puts tabIndex in 16-bit int, e.g. -2 is 65534.\n  return goog.isNumber(index) && index >= 0 && index < 32768;\n};\n\n\n/**\n * Returns true if the element is focusable even when tabIndex is not set.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element natively supports focus.\n * @private\n */\ngoog.dom.nativelySupportsFocus_ = function(element) {\n  return element.tagName == goog.dom.TagName.A ||\n      element.tagName == goog.dom.TagName.INPUT ||\n      element.tagName == goog.dom.TagName.TEXTAREA ||\n      element.tagName == goog.dom.TagName.SELECT ||\n      element.tagName == goog.dom.TagName.BUTTON;\n};\n\n\n/**\n * Returns true if the element has a bounding rectangle that would be visible\n * (i.e. its width and height are greater than zero).\n * @param {!HTMLElement} element Element to check.\n * @return {boolean} Whether the element has a non-zero bounding rectangle.\n * @private\n */\ngoog.dom.hasNonZeroBoundingRect_ = function(element) {\n  var rect;\n  if (!goog.isFunction(element['getBoundingClientRect']) ||\n      // In IE, getBoundingClientRect throws on detached nodes.\n      (goog.userAgent.IE && element.parentElement == null)) {\n    rect = {'height': element.offsetHeight, 'width': element.offsetWidth};\n  } else {\n    rect = element.getBoundingClientRect();\n  }\n  return goog.isDefAndNotNull(rect) && rect.height > 0 && rect.width > 0;\n};\n\n\n/**\n * Returns the text content of the current node, without markup and invisible\n * symbols. New lines are stripped and whitespace is collapsed,\n * such that each character would be visible.\n *\n * In browsers that support it, innerText is used.  Other browsers attempt to\n * simulate it via node traversal.  Line breaks are canonicalized in IE.\n *\n * @param {Node} node The node from which we are getting content.\n * @return {string} The text content.\n */\ngoog.dom.getTextContent = function(node) {\n  var textContent;\n  // Note(arv): IE9, Opera, and Safari 3 support innerText but they include\n  // text nodes in script tags. So we revert to use a user agent test here.\n  if (goog.dom.BrowserFeature.CAN_USE_INNER_TEXT && node !== null &&\n      ('innerText' in node)) {\n    textContent = goog.string.canonicalizeNewlines(node.innerText);\n    // Unfortunately .innerText() returns text with &shy; symbols\n    // We need to filter it out and then remove duplicate whitespaces\n  } else {\n    var buf = [];\n    goog.dom.getTextContent_(node, buf, true);\n    textContent = buf.join('');\n  }\n\n  // Strip &shy; entities. goog.format.insertWordBreaks inserts them in Opera.\n  textContent = textContent.replace(/ \\xAD /g, ' ').replace(/\\xAD/g, '');\n  // Strip &#8203; entities. goog.format.insertWordBreaks inserts them in IE8.\n  textContent = textContent.replace(/\\u200B/g, '');\n\n  // Skip this replacement on old browsers with working innerText, which\n  // automatically turns &nbsp; into ' ' and / +/ into ' ' when reading\n  // innerText.\n  if (!goog.dom.BrowserFeature.CAN_USE_INNER_TEXT) {\n    textContent = textContent.replace(/ +/g, ' ');\n  }\n  if (textContent != ' ') {\n    textContent = textContent.replace(/^\\s*/, '');\n  }\n\n  return textContent;\n};\n\n\n/**\n * Returns the text content of the current node, without markup.\n *\n * Unlike {@code getTextContent} this method does not collapse whitespaces\n * or normalize lines breaks.\n *\n * @param {Node} node The node from which we are getting content.\n * @return {string} The raw text content.\n */\ngoog.dom.getRawTextContent = function(node) {\n  var buf = [];\n  goog.dom.getTextContent_(node, buf, false);\n\n  return buf.join('');\n};\n\n\n/**\n * Recursive support function for text content retrieval.\n *\n * @param {Node} node The node from which we are getting content.\n * @param {Array<string>} buf string buffer.\n * @param {boolean} normalizeWhitespace Whether to normalize whitespace.\n * @private\n */\ngoog.dom.getTextContent_ = function(node, buf, normalizeWhitespace) {\n  if (node.nodeName in goog.dom.TAGS_TO_IGNORE_) {\n    // ignore certain tags\n  } else if (node.nodeType == goog.dom.NodeType.TEXT) {\n    if (normalizeWhitespace) {\n      buf.push(String(node.nodeValue).replace(/(\\r\\n|\\r|\\n)/g, ''));\n    } else {\n      buf.push(node.nodeValue);\n    }\n  } else if (node.nodeName in goog.dom.PREDEFINED_TAG_VALUES_) {\n    buf.push(goog.dom.PREDEFINED_TAG_VALUES_[node.nodeName]);\n  } else {\n    var child = node.firstChild;\n    while (child) {\n      goog.dom.getTextContent_(child, buf, normalizeWhitespace);\n      child = child.nextSibling;\n    }\n  }\n};\n\n\n/**\n * Returns the text length of the text contained in a node, without markup. This\n * is equivalent to the selection length if the node was selected, or the number\n * of cursor movements to traverse the node. Images & BRs take one space.  New\n * lines are ignored.\n *\n * @param {Node} node The node whose text content length is being calculated.\n * @return {number} The length of {@code node}'s text content.\n */\ngoog.dom.getNodeTextLength = function(node) {\n  return goog.dom.getTextContent(node).length;\n};\n\n\n/**\n * Returns the text offset of a node relative to one of its ancestors. The text\n * length is the same as the length calculated by goog.dom.getNodeTextLength.\n *\n * @param {Node} node The node whose offset is being calculated.\n * @param {Node=} opt_offsetParent The node relative to which the offset will\n *     be calculated. Defaults to the node's owner document's body.\n * @return {number} The text offset.\n */\ngoog.dom.getNodeTextOffset = function(node, opt_offsetParent) {\n  var root = opt_offsetParent || goog.dom.getOwnerDocument(node).body;\n  var buf = [];\n  while (node && node != root) {\n    var cur = node;\n    while ((cur = cur.previousSibling)) {\n      buf.unshift(goog.dom.getTextContent(cur));\n    }\n    node = node.parentNode;\n  }\n  // Trim left to deal with FF cases when there might be line breaks and empty\n  // nodes at the front of the text\n  return goog.string.trimLeft(buf.join('')).replace(/ +/g, ' ').length;\n};\n\n\n/**\n * Returns the node at a given offset in a parent node.  If an object is\n * provided for the optional third parameter, the node and the remainder of the\n * offset will stored as properties of this object.\n * @param {Node} parent The parent node.\n * @param {number} offset The offset into the parent node.\n * @param {Object=} opt_result Object to be used to store the return value. The\n *     return value will be stored in the form {node: Node, remainder: number}\n *     if this object is provided.\n * @return {Node} The node at the given offset.\n */\ngoog.dom.getNodeAtOffset = function(parent, offset, opt_result) {\n  var stack = [parent], pos = 0, cur = null;\n  while (stack.length > 0 && pos < offset) {\n    cur = stack.pop();\n    if (cur.nodeName in goog.dom.TAGS_TO_IGNORE_) {\n      // ignore certain tags\n    } else if (cur.nodeType == goog.dom.NodeType.TEXT) {\n      var text = cur.nodeValue.replace(/(\\r\\n|\\r|\\n)/g, '').replace(/ +/g, ' ');\n      pos += text.length;\n    } else if (cur.nodeName in goog.dom.PREDEFINED_TAG_VALUES_) {\n      pos += goog.dom.PREDEFINED_TAG_VALUES_[cur.nodeName].length;\n    } else {\n      for (var i = cur.childNodes.length - 1; i >= 0; i--) {\n        stack.push(cur.childNodes[i]);\n      }\n    }\n  }\n  if (goog.isObject(opt_result)) {\n    opt_result.remainder = cur ? cur.nodeValue.length + offset - pos - 1 : 0;\n    opt_result.node = cur;\n  }\n\n  return cur;\n};\n\n\n/**\n * Returns true if the object is a {@code NodeList}.  To qualify as a NodeList,\n * the object must have a numeric length property and an item function (which\n * has type 'string' on IE for some reason).\n * @param {Object} val Object to test.\n * @return {boolean} Whether the object is a NodeList.\n */\ngoog.dom.isNodeList = function(val) {\n  // TODO(attila): Now the isNodeList is part of goog.dom we can use\n  // goog.userAgent to make this simpler.\n  // A NodeList must have a length property of type 'number' on all platforms.\n  if (val && typeof val.length == 'number') {\n    // A NodeList is an object everywhere except Safari, where it's a function.\n    if (goog.isObject(val)) {\n      // A NodeList must have an item function (on non-IE platforms) or an item\n      // property of type 'string' (on IE).\n      return typeof val.item == 'function' || typeof val.item == 'string';\n    } else if (goog.isFunction(val)) {\n      // On Safari, a NodeList is a function with an item property that is also\n      // a function.\n      return typeof val.item == 'function';\n    }\n  }\n\n  // Not a NodeList.\n  return false;\n};\n\n\n/**\n * Walks up the DOM hierarchy returning the first ancestor that has the passed\n * tag name and/or class name. If the passed element matches the specified\n * criteria, the element itself is returned.\n * @param {Node} element The DOM node to start with.\n * @param {?(goog.dom.TagName<T>|string)=} opt_tag The tag name to match (or\n *     null/undefined to match only based on class name).\n * @param {?string=} opt_class The class name to match (or null/undefined to\n *     match only based on tag name).\n * @param {number=} opt_maxSearchSteps Maximum number of levels to search up the\n *     dom.\n * @return {?R} The first ancestor that matches the passed criteria, or\n *     null if no match is found. The return type is {?Element} if opt_tag is\n *     not a member of goog.dom.TagName or a more specific type if it is (e.g.\n *     {?HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.getAncestorByTagNameAndClass = function(\n    element, opt_tag, opt_class, opt_maxSearchSteps) {\n  if (!opt_tag && !opt_class) {\n    return null;\n  }\n  var tagName = opt_tag ? String(opt_tag).toUpperCase() : null;\n  return /** @type {Element} */ (goog.dom.getAncestor(element, function(node) {\n    return (!tagName || node.nodeName == tagName) &&\n        (!opt_class ||\n         goog.isString(node.className) &&\n             goog.array.contains(node.className.split(/\\s+/), opt_class));\n  }, true, opt_maxSearchSteps));\n};\n\n\n/**\n * Walks up the DOM hierarchy returning the first ancestor that has the passed\n * class name. If the passed element matches the specified criteria, the\n * element itself is returned.\n * @param {Node} element The DOM node to start with.\n * @param {string} className The class name to match.\n * @param {number=} opt_maxSearchSteps Maximum number of levels to search up the\n *     dom.\n * @return {Element} The first ancestor that matches the passed criteria, or\n *     null if none match.\n */\ngoog.dom.getAncestorByClass = function(element, className, opt_maxSearchSteps) {\n  return goog.dom.getAncestorByTagNameAndClass(\n      element, null, className, opt_maxSearchSteps);\n};\n\n\n/**\n * Walks up the DOM hierarchy returning the first ancestor that passes the\n * matcher function.\n * @param {Node} element The DOM node to start with.\n * @param {function(Node) : boolean} matcher A function that returns true if the\n *     passed node matches the desired criteria.\n * @param {boolean=} opt_includeNode If true, the node itself is included in\n *     the search (the first call to the matcher will pass startElement as\n *     the node to test).\n * @param {number=} opt_maxSearchSteps Maximum number of levels to search up the\n *     dom.\n * @return {Node} DOM node that matched the matcher, or null if there was\n *     no match.\n */\ngoog.dom.getAncestor = function(\n    element, matcher, opt_includeNode, opt_maxSearchSteps) {\n  if (element && !opt_includeNode) {\n    element = element.parentNode;\n  }\n  var steps = 0;\n  while (element &&\n         (opt_maxSearchSteps == null || steps <= opt_maxSearchSteps)) {\n    goog.asserts.assert(element.name != 'parentNode');\n    if (matcher(element)) {\n      return element;\n    }\n    element = element.parentNode;\n    steps++;\n  }\n  // Reached the root of the DOM without a match\n  return null;\n};\n\n\n/**\n * Determines the active element in the given document.\n * @param {Document} doc The document to look in.\n * @return {Element} The active element.\n */\ngoog.dom.getActiveElement = function(doc) {\n  try {\n    return doc && doc.activeElement;\n  } catch (e) {\n    // NOTE(nicksantos): Sometimes, evaluating document.activeElement in IE\n    // throws an exception. I'm not 100% sure why, but I suspect it chokes\n    // on document.activeElement if the activeElement has been recently\n    // removed from the DOM by a JS operation.\n    //\n    // We assume that an exception here simply means\n    // \"there is no active element.\"\n  }\n\n  return null;\n};\n\n\n/**\n * Gives the current devicePixelRatio.\n *\n * By default, this is the value of window.devicePixelRatio (which should be\n * preferred if present).\n *\n * If window.devicePixelRatio is not present, the ratio is calculated with\n * window.matchMedia, if present. Otherwise, gives 1.0.\n *\n * Some browsers (including Chrome) consider the browser zoom level in the pixel\n * ratio, so the value may change across multiple calls.\n *\n * @return {number} The number of actual pixels per virtual pixel.\n */\ngoog.dom.getPixelRatio = function() {\n  var win = goog.dom.getWindow();\n  if (goog.isDef(win.devicePixelRatio)) {\n    return win.devicePixelRatio;\n  } else if (win.matchMedia) {\n    // Should be for IE10 and FF6-17 (this basically clamps to lower)\n    // Note that the order of these statements is important\n    return goog.dom.matchesPixelRatio_(3) || goog.dom.matchesPixelRatio_(2) ||\n           goog.dom.matchesPixelRatio_(1.5) || goog.dom.matchesPixelRatio_(1) ||\n           .75;\n  }\n  return 1;\n};\n\n\n/**\n * Calculates a mediaQuery to check if the current device supports the\n * given actual to virtual pixel ratio.\n * @param {number} pixelRatio The ratio of actual pixels to virtual pixels.\n * @return {number} pixelRatio if applicable, otherwise 0.\n * @private\n */\ngoog.dom.matchesPixelRatio_ = function(pixelRatio) {\n  var win = goog.dom.getWindow();\n  /**\n   * Due to the 1:96 fixed ratio of CSS in to CSS px, 1dppx is equivalent to\n   * 96dpi.\n   * @const {number}\n   */\n  var dpiPerDppx = 96;\n  var query =\n      // FF16-17\n      '(min-resolution: ' + pixelRatio + 'dppx),' +\n      // FF6-15\n      '(min--moz-device-pixel-ratio: ' + pixelRatio + '),' +\n      // IE10 (this works for the two browsers above too but I don't want to\n      // trust the 1:96 fixed ratio magic)\n      '(min-resolution: ' + (pixelRatio * dpiPerDppx) + 'dpi)';\n  return win.matchMedia(query).matches ? pixelRatio : 0;\n};\n\n\n/**\n * Gets '2d' context of a canvas. Shortcut for canvas.getContext('2d') with a\n * type information.\n * @param {!HTMLCanvasElement} canvas\n * @return {!CanvasRenderingContext2D}\n */\ngoog.dom.getCanvasContext2D = function(canvas) {\n  return /** @type {!CanvasRenderingContext2D} */ (canvas.getContext('2d'));\n};\n\n\n\n/**\n * Create an instance of a DOM helper with a new document object.\n * @param {Document=} opt_document Document object to associate with this\n *     DOM helper.\n * @constructor\n */\ngoog.dom.DomHelper = function(opt_document) {\n  /**\n   * Reference to the document object to use\n   * @type {!Document}\n   * @private\n   */\n  this.document_ = opt_document || goog.global.document || document;\n};\n\n\n/**\n * Gets the dom helper object for the document where the element resides.\n * @param {Node=} opt_node If present, gets the DomHelper for this node.\n * @return {!goog.dom.DomHelper} The DomHelper.\n */\ngoog.dom.DomHelper.prototype.getDomHelper = goog.dom.getDomHelper;\n\n\n/**\n * Sets the document object.\n * @param {!Document} document Document object.\n */\ngoog.dom.DomHelper.prototype.setDocument = function(document) {\n  this.document_ = document;\n};\n\n\n/**\n * Gets the document object being used by the dom library.\n * @return {!Document} Document object.\n */\ngoog.dom.DomHelper.prototype.getDocument = function() {\n  return this.document_;\n};\n\n\n/**\n * Alias for {@code getElementById}. If a DOM node is passed in then we just\n * return that.\n * @param {string|Element} element Element ID or a DOM node.\n * @return {Element} The element with the given ID, or the node passed in.\n */\ngoog.dom.DomHelper.prototype.getElement = function(element) {\n  return goog.dom.getElementHelper_(this.document_, element);\n};\n\n\n/**\n * Gets an element by id, asserting that the element is found.\n *\n * This is used when an element is expected to exist, and should fail with\n * an assertion error if it does not (if assertions are enabled).\n *\n * @param {string} id Element ID.\n * @return {!Element} The element with the given ID, if it exists.\n */\ngoog.dom.DomHelper.prototype.getRequiredElement = function(id) {\n  return goog.dom.getRequiredElementHelper_(this.document_, id);\n};\n\n\n/**\n * Alias for {@code getElement}.\n * @param {string|Element} element Element ID or a DOM node.\n * @return {Element} The element with the given ID, or the node passed in.\n * @deprecated Use {@link goog.dom.DomHelper.prototype.getElement} instead.\n */\ngoog.dom.DomHelper.prototype.$ = goog.dom.DomHelper.prototype.getElement;\n\n\n/**\n * Gets elements by tag name.\n * @param {!goog.dom.TagName<T>} tagName\n * @param {(!Document|!Element)=} opt_parent Parent element or document where to\n *     look for elements. Defaults to document of this DomHelper.\n * @return {!NodeList<R>} List of elements. The members of the list are\n *     {!Element} if tagName is not a member of goog.dom.TagName or more\n *     specific types if it is (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.getElementsByTagName =\n    function(tagName, opt_parent) {\n  var parent = opt_parent || this.document_;\n  return parent.getElementsByTagName(String(tagName));\n};\n\n\n/**\n * Looks up elements by both tag and class name, using browser native functions\n * ({@code querySelectorAll}, {@code getElementsByTagName} or\n * {@code getElementsByClassName}) where possible. The returned array is a live\n * NodeList or a static list depending on the code path taken.\n *\n * @see goog.dom.query\n *\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name or * for all\n *     tags.\n * @param {?string=} opt_class Optional class name.\n * @param {(Document|Element)=} opt_el Optional element to look in.\n * @return {!IArrayLike<R>} Array-like list of elements (only a length property\n *     and numerical indices are guaranteed to exist). The members of the array\n *     are {!Element} if opt_tag is not a member of goog.dom.TagName or more\n *     specific types if it is (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.getElementsByTagNameAndClass = function(\n    opt_tag, opt_class, opt_el) {\n  return goog.dom.getElementsByTagNameAndClass_(\n      this.document_, opt_tag, opt_class, opt_el);\n};\n\n\n/**\n * Returns an array of all the elements with the provided className.\n * @see {goog.dom.query}\n * @param {string} className the name of the class to look for.\n * @param {Element|Document=} opt_el Optional element to look in.\n * @return {!IArrayLike<!Element>} The items found with the class name provided.\n */\ngoog.dom.DomHelper.prototype.getElementsByClass = function(className, opt_el) {\n  var doc = opt_el || this.document_;\n  return goog.dom.getElementsByClass(className, doc);\n};\n\n\n/**\n * Returns the first element we find matching the provided class name.\n * @see {goog.dom.query}\n * @param {string} className the name of the class to look for.\n * @param {(Element|Document)=} opt_el Optional element to look in.\n * @return {Element} The first item found with the class name provided.\n */\ngoog.dom.DomHelper.prototype.getElementByClass = function(className, opt_el) {\n  var doc = opt_el || this.document_;\n  return goog.dom.getElementByClass(className, doc);\n};\n\n\n/**\n * Ensures an element with the given className exists, and then returns the\n * first element with the provided className.\n * @see {goog.dom.query}\n * @param {string} className the name of the class to look for.\n * @param {(!Element|!Document)=} opt_root Optional element or document to look\n *     in.\n * @return {!Element} The first item found with the class name provided.\n * @throws {goog.asserts.AssertionError} Thrown if no element is found.\n */\ngoog.dom.DomHelper.prototype.getRequiredElementByClass = function(\n    className, opt_root) {\n  var root = opt_root || this.document_;\n  return goog.dom.getRequiredElementByClass(className, root);\n};\n\n\n/**\n * Alias for {@code getElementsByTagNameAndClass}.\n * @deprecated Use DomHelper getElementsByTagNameAndClass.\n * @see goog.dom.query\n *\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name.\n * @param {?string=} opt_class Optional class name.\n * @param {Element=} opt_el Optional element to look in.\n * @return {!IArrayLike<R>} Array-like list of elements (only a length property\n *     and numerical indices are guaranteed to exist). The members of the array\n *     are {!Element} if opt_tag is a string or more specific types if it is\n *     a member of goog.dom.TagName (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.$$ =\n    goog.dom.DomHelper.prototype.getElementsByTagNameAndClass;\n\n\n/**\n * Sets a number of properties on a node.\n * @param {Element} element DOM node to set properties on.\n * @param {Object} properties Hash of property:value pairs.\n */\ngoog.dom.DomHelper.prototype.setProperties = goog.dom.setProperties;\n\n\n/**\n * Gets the dimensions of the viewport.\n * @param {Window=} opt_window Optional window element to test. Defaults to\n *     the window of the Dom Helper.\n * @return {!goog.math.Size} Object with values 'width' and 'height'.\n */\ngoog.dom.DomHelper.prototype.getViewportSize = function(opt_window) {\n  // TODO(arv): This should not take an argument. That breaks the rule of a\n  // a DomHelper representing a single frame/window/document.\n  return goog.dom.getViewportSize(opt_window || this.getWindow());\n};\n\n\n/**\n * Calculates the height of the document.\n *\n * @return {number} The height of the document.\n */\ngoog.dom.DomHelper.prototype.getDocumentHeight = function() {\n  return goog.dom.getDocumentHeight_(this.getWindow());\n};\n\n\n/**\n * Typedef for use with goog.dom.createDom and goog.dom.append.\n * @typedef {Object|string|Array|NodeList}\n */\ngoog.dom.Appendable;\n\n\n/**\n * Returns a dom node with a set of attributes.  This function accepts varargs\n * for subsequent nodes to be added.  Subsequent nodes will be added to the\n * first node as childNodes.\n *\n * So:\n * <code>createDom(goog.dom.TagName.DIV, null, createDom(goog.dom.TagName.P), createDom(goog.dom.TagName.P));</code>\n * would return a div with two child paragraphs\n *\n * An easy way to move all child nodes of an existing element to a new parent\n * element is:\n * <code>createDom(goog.dom.TagName.DIV, null, oldElement.childNodes);</code>\n * which will remove all child nodes from the old element and add them as\n * child nodes of the new DIV.\n *\n * @param {string|!goog.dom.TagName<T>} tagName Tag to create.\n * @param {Object|string=} opt_attributes If object, then a map of name-value\n *     pairs for attributes. If a string, then this is the className of the new\n *     element.\n * @param {...goog.dom.Appendable} var_args Further DOM nodes or\n *     strings for text nodes. If one of the var_args is an array or\n *     NodeList, its elements will be added as childNodes instead.\n * @return {R} Reference to a DOM node. The return type is {!Element} if tagName\n *     is a string or a more specific type if it is a member of\n *     goog.dom.TagName (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.createDom = function(\n    tagName, opt_attributes, var_args) {\n  return goog.dom.createDom_(this.document_, arguments);\n};\n\n\n/**\n * Alias for {@code createDom}.\n * @param {string|!goog.dom.TagName<T>} tagName Tag to create.\n * @param {(Object|string)=} opt_attributes If object, then a map of name-value\n *     pairs for attributes. If a string, then this is the className of the new\n *     element.\n * @param {...goog.dom.Appendable} var_args Further DOM nodes or strings for\n *     text nodes.  If one of the var_args is an array, its children will be\n *     added as childNodes instead.\n * @return {R} Reference to a DOM node. The return type is {!Element} if tagName\n *     is a string or a more specific type if it is a member of\n *     goog.dom.TagName (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n * @deprecated Use {@link goog.dom.DomHelper.prototype.createDom} instead.\n */\ngoog.dom.DomHelper.prototype.$dom = goog.dom.DomHelper.prototype.createDom;\n\n\n/**\n * Creates a new element.\n * @param {string|!goog.dom.TagName<T>} name Tag to create.\n * @return {R} The new element. The return type is {!Element} if name is\n *     a string or a more specific type if it is a member of goog.dom.TagName\n *     (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.createElement = function(name) {\n  return goog.dom.createElement_(this.document_, name);\n};\n\n\n/**\n * Creates a new text node.\n * @param {number|string} content Content.\n * @return {!Text} The new text node.\n */\ngoog.dom.DomHelper.prototype.createTextNode = function(content) {\n  return this.document_.createTextNode(String(content));\n};\n\n\n/**\n * Create a table.\n * @param {number} rows The number of rows in the table.  Must be >= 1.\n * @param {number} columns The number of columns in the table.  Must be >= 1.\n * @param {boolean=} opt_fillWithNbsp If true, fills table entries with\n *     {@code goog.string.Unicode.NBSP} characters.\n * @return {!HTMLElement} The created table.\n */\ngoog.dom.DomHelper.prototype.createTable = function(\n    rows, columns, opt_fillWithNbsp) {\n  return goog.dom.createTable_(\n      this.document_, rows, columns, !!opt_fillWithNbsp);\n};\n\n\n/**\n * Converts an HTML into a node or a document fragment. A single Node is used if\n * {@code html} only generates a single node. If {@code html} generates multiple\n * nodes then these are put inside a {@code DocumentFragment}. This is a safe\n * version of {@code goog.dom.DomHelper#htmlToDocumentFragment} which is now\n * deleted.\n * @param {!goog.html.SafeHtml} html The HTML markup to convert.\n * @return {!Node} The resulting node.\n */\ngoog.dom.DomHelper.prototype.safeHtmlToNode = function(html) {\n  return goog.dom.safeHtmlToNode_(this.document_, html);\n};\n\n\n/**\n * Returns true if the browser is in \"CSS1-compatible\" (standards-compliant)\n * mode, false otherwise.\n * @return {boolean} True if in CSS1-compatible mode.\n */\ngoog.dom.DomHelper.prototype.isCss1CompatMode = function() {\n  return goog.dom.isCss1CompatMode_(this.document_);\n};\n\n\n/**\n * Gets the window object associated with the document.\n * @return {!Window} The window associated with the given document.\n */\ngoog.dom.DomHelper.prototype.getWindow = function() {\n  return goog.dom.getWindow_(this.document_);\n};\n\n\n/**\n * Gets the document scroll element.\n * @return {!Element} Scrolling element.\n */\ngoog.dom.DomHelper.prototype.getDocumentScrollElement = function() {\n  return goog.dom.getDocumentScrollElement_(this.document_);\n};\n\n\n/**\n * Gets the document scroll distance as a coordinate object.\n * @return {!goog.math.Coordinate} Object with properties 'x' and 'y'.\n */\ngoog.dom.DomHelper.prototype.getDocumentScroll = function() {\n  return goog.dom.getDocumentScroll_(this.document_);\n};\n\n\n/**\n * Determines the active element in the given document.\n * @param {Document=} opt_doc The document to look in.\n * @return {Element} The active element.\n */\ngoog.dom.DomHelper.prototype.getActiveElement = function(opt_doc) {\n  return goog.dom.getActiveElement(opt_doc || this.document_);\n};\n\n\n/**\n * Appends a child to a node.\n * @param {Node} parent Parent.\n * @param {Node} child Child.\n */\ngoog.dom.DomHelper.prototype.appendChild = goog.dom.appendChild;\n\n\n/**\n * Appends a node with text or other nodes.\n * @param {!Node} parent The node to append nodes to.\n * @param {...goog.dom.Appendable} var_args The things to append to the node.\n *     If this is a Node it is appended as is.\n *     If this is a string then a text node is appended.\n *     If this is an array like object then fields 0 to length - 1 are appended.\n */\ngoog.dom.DomHelper.prototype.append = goog.dom.append;\n\n\n/**\n * Determines if the given node can contain children, intended to be used for\n * HTML generation.\n *\n * @param {Node} node The node to check.\n * @return {boolean} Whether the node can contain children.\n */\ngoog.dom.DomHelper.prototype.canHaveChildren = goog.dom.canHaveChildren;\n\n\n/**\n * Removes all the child nodes on a DOM node.\n * @param {Node} node Node to remove children from.\n */\ngoog.dom.DomHelper.prototype.removeChildren = goog.dom.removeChildren;\n\n\n/**\n * Inserts a new node before an existing reference node (i.e., as the previous\n * sibling). If the reference node has no parent, then does nothing.\n * @param {Node} newNode Node to insert.\n * @param {Node} refNode Reference node to insert before.\n */\ngoog.dom.DomHelper.prototype.insertSiblingBefore = goog.dom.insertSiblingBefore;\n\n\n/**\n * Inserts a new node after an existing reference node (i.e., as the next\n * sibling). If the reference node has no parent, then does nothing.\n * @param {Node} newNode Node to insert.\n * @param {Node} refNode Reference node to insert after.\n */\ngoog.dom.DomHelper.prototype.insertSiblingAfter = goog.dom.insertSiblingAfter;\n\n\n/**\n * Insert a child at a given index. If index is larger than the number of child\n * nodes that the parent currently has, the node is inserted as the last child\n * node.\n * @param {Element} parent The element into which to insert the child.\n * @param {Node} child The element to insert.\n * @param {number} index The index at which to insert the new child node. Must\n *     not be negative.\n */\ngoog.dom.DomHelper.prototype.insertChildAt = goog.dom.insertChildAt;\n\n\n/**\n * Removes a node from its parent.\n * @param {Node} node The node to remove.\n * @return {Node} The node removed if removed; else, null.\n */\ngoog.dom.DomHelper.prototype.removeNode = goog.dom.removeNode;\n\n\n/**\n * Replaces a node in the DOM tree. Will do nothing if {@code oldNode} has no\n * parent.\n * @param {Node} newNode Node to insert.\n * @param {Node} oldNode Node to replace.\n */\ngoog.dom.DomHelper.prototype.replaceNode = goog.dom.replaceNode;\n\n\n/**\n * Flattens an element. That is, removes it and replace it with its children.\n * @param {Element} element The element to flatten.\n * @return {Element|undefined} The original element, detached from the document\n *     tree, sans children, or undefined if the element was already not in the\n *     document.\n */\ngoog.dom.DomHelper.prototype.flattenElement = goog.dom.flattenElement;\n\n\n/**\n * Returns an array containing just the element children of the given element.\n * @param {Element} element The element whose element children we want.\n * @return {!(Array<!Element>|NodeList<!Element>)} An array or array-like list\n *     of just the element children of the given element.\n */\ngoog.dom.DomHelper.prototype.getChildren = goog.dom.getChildren;\n\n\n/**\n * Returns the first child node that is an element.\n * @param {Node} node The node to get the first child element of.\n * @return {Element} The first child node of {@code node} that is an element.\n */\ngoog.dom.DomHelper.prototype.getFirstElementChild =\n    goog.dom.getFirstElementChild;\n\n\n/**\n * Returns the last child node that is an element.\n * @param {Node} node The node to get the last child element of.\n * @return {Element} The last child node of {@code node} that is an element.\n */\ngoog.dom.DomHelper.prototype.getLastElementChild = goog.dom.getLastElementChild;\n\n\n/**\n * Returns the first next sibling that is an element.\n * @param {Node} node The node to get the next sibling element of.\n * @return {Element} The next sibling of {@code node} that is an element.\n */\ngoog.dom.DomHelper.prototype.getNextElementSibling =\n    goog.dom.getNextElementSibling;\n\n\n/**\n * Returns the first previous sibling that is an element.\n * @param {Node} node The node to get the previous sibling element of.\n * @return {Element} The first previous sibling of {@code node} that is\n *     an element.\n */\ngoog.dom.DomHelper.prototype.getPreviousElementSibling =\n    goog.dom.getPreviousElementSibling;\n\n\n/**\n * Returns the next node in source order from the given node.\n * @param {Node} node The node.\n * @return {Node} The next node in the DOM tree, or null if this was the last\n *     node.\n */\ngoog.dom.DomHelper.prototype.getNextNode = goog.dom.getNextNode;\n\n\n/**\n * Returns the previous node in source order from the given node.\n * @param {Node} node The node.\n * @return {Node} The previous node in the DOM tree, or null if this was the\n *     first node.\n */\ngoog.dom.DomHelper.prototype.getPreviousNode = goog.dom.getPreviousNode;\n\n\n/**\n * Whether the object looks like a DOM node.\n * @param {?} obj The object being tested for node likeness.\n * @return {boolean} Whether the object looks like a DOM node.\n */\ngoog.dom.DomHelper.prototype.isNodeLike = goog.dom.isNodeLike;\n\n\n/**\n * Whether the object looks like an Element.\n * @param {?} obj The object being tested for Element likeness.\n * @return {boolean} Whether the object looks like an Element.\n */\ngoog.dom.DomHelper.prototype.isElement = goog.dom.isElement;\n\n\n/**\n * Returns true if the specified value is a Window object. This includes the\n * global window for HTML pages, and iframe windows.\n * @param {?} obj Variable to test.\n * @return {boolean} Whether the variable is a window.\n */\ngoog.dom.DomHelper.prototype.isWindow = goog.dom.isWindow;\n\n\n/**\n * Returns an element's parent, if it's an Element.\n * @param {Element} element The DOM element.\n * @return {Element} The parent, or null if not an Element.\n */\ngoog.dom.DomHelper.prototype.getParentElement = goog.dom.getParentElement;\n\n\n/**\n * Whether a node contains another node.\n * @param {Node} parent The node that should contain the other node.\n * @param {Node} descendant The node to test presence of.\n * @return {boolean} Whether the parent node contains the descendent node.\n */\ngoog.dom.DomHelper.prototype.contains = goog.dom.contains;\n\n\n/**\n * Compares the document order of two nodes, returning 0 if they are the same\n * node, a negative number if node1 is before node2, and a positive number if\n * node2 is before node1.  Note that we compare the order the tags appear in the\n * document so in the tree <b><i>text</i></b> the B node is considered to be\n * before the I node.\n *\n * @param {Node} node1 The first node to compare.\n * @param {Node} node2 The second node to compare.\n * @return {number} 0 if the nodes are the same node, a negative number if node1\n *     is before node2, and a positive number if node2 is before node1.\n */\ngoog.dom.DomHelper.prototype.compareNodeOrder = goog.dom.compareNodeOrder;\n\n\n/**\n * Find the deepest common ancestor of the given nodes.\n * @param {...Node} var_args The nodes to find a common ancestor of.\n * @return {Node} The common ancestor of the nodes, or null if there is none.\n *     null will only be returned if two or more of the nodes are from different\n *     documents.\n */\ngoog.dom.DomHelper.prototype.findCommonAncestor = goog.dom.findCommonAncestor;\n\n\n/**\n * Returns the owner document for a node.\n * @param {Node} node The node to get the document for.\n * @return {!Document} The document owning the node.\n */\ngoog.dom.DomHelper.prototype.getOwnerDocument = goog.dom.getOwnerDocument;\n\n\n/**\n * Cross browser function for getting the document element of an iframe.\n * @param {Element} iframe Iframe element.\n * @return {!Document} The frame content document.\n */\ngoog.dom.DomHelper.prototype.getFrameContentDocument =\n    goog.dom.getFrameContentDocument;\n\n\n/**\n * Cross browser function for getting the window of a frame or iframe.\n * @param {Element} frame Frame element.\n * @return {Window} The window associated with the given frame.\n */\ngoog.dom.DomHelper.prototype.getFrameContentWindow =\n    goog.dom.getFrameContentWindow;\n\n\n/**\n * Sets the text content of a node, with cross-browser support.\n * @param {Node} node The node to change the text content of.\n * @param {string|number} text The value that should replace the node's content.\n */\ngoog.dom.DomHelper.prototype.setTextContent = goog.dom.setTextContent;\n\n\n/**\n * Gets the outerHTML of a node, which islike innerHTML, except that it\n * actually contains the HTML of the node itself.\n * @param {Element} element The element to get the HTML of.\n * @return {string} The outerHTML of the given element.\n */\ngoog.dom.DomHelper.prototype.getOuterHtml = goog.dom.getOuterHtml;\n\n\n/**\n * Finds the first descendant node that matches the filter function. This does\n * a depth first search.\n * @param {Node} root The root of the tree to search.\n * @param {function(Node) : boolean} p The filter function.\n * @return {Node|undefined} The found node or undefined if none is found.\n */\ngoog.dom.DomHelper.prototype.findNode = goog.dom.findNode;\n\n\n/**\n * Finds all the descendant nodes that matches the filter function. This does a\n * depth first search.\n * @param {Node} root The root of the tree to search.\n * @param {function(Node) : boolean} p The filter function.\n * @return {Array<Node>} The found nodes or an empty array if none are found.\n */\ngoog.dom.DomHelper.prototype.findNodes = goog.dom.findNodes;\n\n\n/**\n * Returns true if the element has a tab index that allows it to receive\n * keyboard focus (tabIndex >= 0), false otherwise.  Note that some elements\n * natively support keyboard focus, even if they have no tab index.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element has a tab index that allows keyboard\n *     focus.\n */\ngoog.dom.DomHelper.prototype.isFocusableTabIndex = goog.dom.isFocusableTabIndex;\n\n\n/**\n * Enables or disables keyboard focus support on the element via its tab index.\n * Only elements for which {@link goog.dom.isFocusableTabIndex} returns true\n * (or elements that natively support keyboard focus, like form elements) can\n * receive keyboard focus.  See http://go/tabindex for more info.\n * @param {Element} element Element whose tab index is to be changed.\n * @param {boolean} enable Whether to set or remove a tab index on the element\n *     that supports keyboard focus.\n */\ngoog.dom.DomHelper.prototype.setFocusableTabIndex =\n    goog.dom.setFocusableTabIndex;\n\n\n/**\n * Returns true if the element can be focused, i.e. it has a tab index that\n * allows it to receive keyboard focus (tabIndex >= 0), or it is an element\n * that natively supports keyboard focus.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element allows keyboard focus.\n */\ngoog.dom.DomHelper.prototype.isFocusable = goog.dom.isFocusable;\n\n\n/**\n * Returns the text contents of the current node, without markup. New lines are\n * stripped and whitespace is collapsed, such that each character would be\n * visible.\n *\n * In browsers that support it, innerText is used.  Other browsers attempt to\n * simulate it via node traversal.  Line breaks are canonicalized in IE.\n *\n * @param {Node} node The node from which we are getting content.\n * @return {string} The text content.\n */\ngoog.dom.DomHelper.prototype.getTextContent = goog.dom.getTextContent;\n\n\n/**\n * Returns the text length of the text contained in a node, without markup. This\n * is equivalent to the selection length if the node was selected, or the number\n * of cursor movements to traverse the node. Images & BRs take one space.  New\n * lines are ignored.\n *\n * @param {Node} node The node whose text content length is being calculated.\n * @return {number} The length of {@code node}'s text content.\n */\ngoog.dom.DomHelper.prototype.getNodeTextLength = goog.dom.getNodeTextLength;\n\n\n/**\n * Returns the text offset of a node relative to one of its ancestors. The text\n * length is the same as the length calculated by\n * {@code goog.dom.getNodeTextLength}.\n *\n * @param {Node} node The node whose offset is being calculated.\n * @param {Node=} opt_offsetParent Defaults to the node's owner document's body.\n * @return {number} The text offset.\n */\ngoog.dom.DomHelper.prototype.getNodeTextOffset = goog.dom.getNodeTextOffset;\n\n\n/**\n * Returns the node at a given offset in a parent node.  If an object is\n * provided for the optional third parameter, the node and the remainder of the\n * offset will stored as properties of this object.\n * @param {Node} parent The parent node.\n * @param {number} offset The offset into the parent node.\n * @param {Object=} opt_result Object to be used to store the return value. The\n *     return value will be stored in the form {node: Node, remainder: number}\n *     if this object is provided.\n * @return {Node} The node at the given offset.\n */\ngoog.dom.DomHelper.prototype.getNodeAtOffset = goog.dom.getNodeAtOffset;\n\n\n/**\n * Returns true if the object is a {@code NodeList}.  To qualify as a NodeList,\n * the object must have a numeric length property and an item function (which\n * has type 'string' on IE for some reason).\n * @param {Object} val Object to test.\n * @return {boolean} Whether the object is a NodeList.\n */\ngoog.dom.DomHelper.prototype.isNodeList = goog.dom.isNodeList;\n\n\n/**\n * Walks up the DOM hierarchy returning the first ancestor that has the passed\n * tag name and/or class name. If the passed element matches the specified\n * criteria, the element itself is returned.\n * @param {Node} element The DOM node to start with.\n * @param {?(goog.dom.TagName<T>|string)=} opt_tag The tag name to match (or\n *     null/undefined to match only based on class name).\n * @param {?string=} opt_class The class name to match (or null/undefined to\n *     match only based on tag name).\n * @param {number=} opt_maxSearchSteps Maximum number of levels to search up the\n *     dom.\n * @return {?R} The first ancestor that matches the passed criteria, or\n *     null if no match is found. The return type is {?Element} if opt_tag is\n *     not a member of goog.dom.TagName or a more specific type if it is (e.g.\n *     {?HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.getAncestorByTagNameAndClass =\n    goog.dom.getAncestorByTagNameAndClass;\n\n\n/**\n * Walks up the DOM hierarchy returning the first ancestor that has the passed\n * class name. If the passed element matches the specified criteria, the\n * element itself is returned.\n * @param {Node} element The DOM node to start with.\n * @param {string} class The class name to match.\n * @param {number=} opt_maxSearchSteps Maximum number of levels to search up the\n *     dom.\n * @return {Element} The first ancestor that matches the passed criteria, or\n *     null if none match.\n */\ngoog.dom.DomHelper.prototype.getAncestorByClass = goog.dom.getAncestorByClass;\n\n\n/**\n * Walks up the DOM hierarchy returning the first ancestor that passes the\n * matcher function.\n * @param {Node} element The DOM node to start with.\n * @param {function(Node) : boolean} matcher A function that returns true if the\n *     passed node matches the desired criteria.\n * @param {boolean=} opt_includeNode If true, the node itself is included in\n *     the search (the first call to the matcher will pass startElement as\n *     the node to test).\n * @param {number=} opt_maxSearchSteps Maximum number of levels to search up the\n *     dom.\n * @return {Node} DOM node that matched the matcher, or null if there was\n *     no match.\n */\ngoog.dom.DomHelper.prototype.getAncestor = goog.dom.getAncestor;\n\n\n/**\n * Gets '2d' context of a canvas. Shortcut for canvas.getContext('2d') with a\n * type information.\n * @param {!HTMLCanvasElement} canvas\n * @return {!CanvasRenderingContext2D}\n */\ngoog.dom.DomHelper.prototype.getCanvasContext2D = goog.dom.getCanvasContext2D;\n","// Copyright 2012 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Vendor prefix getters.\n */\n\ngoog.provide('goog.dom.vendor');\n\ngoog.require('goog.string');\ngoog.require('goog.userAgent');\n\n\n/**\n * Returns the JS vendor prefix used in CSS properties. Different vendors\n * use different methods of changing the case of the property names.\n *\n * @return {?string} The JS vendor prefix or null if there is none.\n */\ngoog.dom.vendor.getVendorJsPrefix = function() {\n  if (goog.userAgent.WEBKIT) {\n    return 'Webkit';\n  } else if (goog.userAgent.GECKO) {\n    return 'Moz';\n  } else if (goog.userAgent.IE) {\n    return 'ms';\n  } else if (goog.userAgent.OPERA) {\n    return 'O';\n  }\n\n  return null;\n};\n\n\n/**\n * Returns the vendor prefix used in CSS properties.\n *\n * @return {?string} The vendor prefix or null if there is none.\n */\ngoog.dom.vendor.getVendorPrefix = function() {\n  if (goog.userAgent.WEBKIT) {\n    return '-webkit';\n  } else if (goog.userAgent.GECKO) {\n    return '-moz';\n  } else if (goog.userAgent.IE) {\n    return '-ms';\n  } else if (goog.userAgent.OPERA) {\n    return '-o';\n  }\n\n  return null;\n};\n\n\n/**\n * @param {string} propertyName A property name.\n * @param {!Object=} opt_object If provided, we verify if the property exists in\n *     the object.\n * @return {?string} A vendor prefixed property name, or null if it does not\n *     exist.\n */\ngoog.dom.vendor.getPrefixedPropertyName = function(propertyName, opt_object) {\n  // We first check for a non-prefixed property, if available.\n  if (opt_object && propertyName in opt_object) {\n    return propertyName;\n  }\n  var prefix = goog.dom.vendor.getVendorJsPrefix();\n  if (prefix) {\n    prefix = prefix.toLowerCase();\n    var prefixedPropertyName = prefix + goog.string.toTitleCase(propertyName);\n    return (!goog.isDef(opt_object) || prefixedPropertyName in opt_object) ?\n        prefixedPropertyName :\n        null;\n  }\n  return null;\n};\n\n\n/**\n * @param {string} eventType An event type.\n * @return {string} A lower-cased vendor prefixed event type.\n */\ngoog.dom.vendor.getPrefixedEventType = function(eventType) {\n  var prefix = goog.dom.vendor.getVendorJsPrefix() || '';\n  return (prefix + eventType).toLowerCase();\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Transitional utilities to unsafely trust random strings as\n * goog.html types. Intended for temporary use when upgrading a library that\n * used to accept plain strings to use safe types, but where it's not\n * practical to transitively update callers.\n *\n * IMPORTANT: No new code should use the conversion functions in this file,\n * they are intended for refactoring old code to use goog.html types. New code\n * should construct goog.html types via their APIs, template systems or\n * sanitizers. If thats not possible it should use\n * goog.html.uncheckedconversions and undergo security review.\n\n *\n * The semantics of the conversions in goog.html.legacyconversions are very\n * different from the ones provided by goog.html.uncheckedconversions. The\n * latter are for use in code where it has been established through manual\n * security review that the value produced by a piece of code will always\n * satisfy the SafeHtml contract (e.g., the output of a secure HTML sanitizer).\n * In uses of goog.html.legacyconversions, this guarantee is not given -- the\n * value in question originates in unreviewed legacy code and there is no\n * guarantee that it satisfies the SafeHtml contract.\n *\n * There are only three valid uses of legacyconversions:\n *\n * 1. Introducing a goog.html version of a function which currently consumes\n * string and passes that string to a DOM API which can execute script - and\n * hence cause XSS - like innerHTML. For example, Dialog might expose a\n * setContent method which takes a string and sets the innerHTML property of\n * an element with it. In this case a setSafeHtmlContent function could be\n * added, consuming goog.html.SafeHtml instead of string, and using\n * goog.dom.safe.setInnerHtml instead of directly setting innerHTML.\n * setContent could then internally use legacyconversions to create a SafeHtml\n * from string and pass the SafeHtml to setSafeHtmlContent. In this scenario\n * remember to document the use of legacyconversions in the modified setContent\n * and consider deprecating it as well.\n *\n * 2. Automated refactoring of application code which handles HTML as string\n * but needs to call a function which only takes goog.html types. For example,\n * in the Dialog scenario from (1) an alternative option would be to refactor\n * setContent to accept goog.html.SafeHtml instead of string and then refactor\n * all current callers to use legacyconversions to pass SafeHtml. This is\n * generally preferable to (1) because it keeps the library clean of\n * legacyconversions, and makes code sites in application code that are\n * potentially vulnerable to XSS more apparent.\n *\n * 3. Old code which needs to call APIs which consume goog.html types and for\n * which it is prohibitively expensive to refactor to use goog.html types.\n * Generally, this is code where safety from XSS is either hopeless or\n * unimportant.\n *\n * @visibility {//closure/goog/html:approved_for_legacy_conversion}\n * @visibility {//closure/goog/bin/sizetests:__pkg__}\n */\n\n\ngoog.provide('goog.html.legacyconversions');\n\ngoog.require('goog.html.SafeHtml');\ngoog.require('goog.html.SafeStyle');\ngoog.require('goog.html.SafeStyleSheet');\ngoog.require('goog.html.SafeUrl');\ngoog.require('goog.html.TrustedResourceUrl');\n\n\n/**\n * Performs an \"unchecked conversion\" from string to SafeHtml for legacy API\n * purposes.\n *\n * Please read fileoverview documentation before using.\n *\n * @param {string} html A string to be converted to SafeHtml.\n * @return {!goog.html.SafeHtml} The value of html, wrapped in a SafeHtml\n *     object.\n */\ngoog.html.legacyconversions.safeHtmlFromString = function(html) {\n  goog.html.legacyconversions.reportCallback_();\n  return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n      html, null /* dir */);\n};\n\n\n/**\n * Performs an \"unchecked conversion\" from string to SafeStyle for legacy API\n * purposes.\n *\n * Please read fileoverview documentation before using.\n *\n * @param {string} style A string to be converted to SafeStyle.\n * @return {!goog.html.SafeStyle} The value of style, wrapped in a SafeStyle\n *     object.\n */\ngoog.html.legacyconversions.safeStyleFromString = function(style) {\n  goog.html.legacyconversions.reportCallback_();\n  return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(\n      style);\n};\n\n\n/**\n * Performs an \"unchecked conversion\" from string to SafeStyleSheet for legacy\n * API purposes.\n *\n * Please read fileoverview documentation before using.\n *\n * @param {string} styleSheet A string to be converted to SafeStyleSheet.\n * @return {!goog.html.SafeStyleSheet} The value of style sheet, wrapped in\n *     a SafeStyleSheet object.\n */\ngoog.html.legacyconversions.safeStyleSheetFromString = function(styleSheet) {\n  goog.html.legacyconversions.reportCallback_();\n  return goog.html.SafeStyleSheet\n      .createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(styleSheet);\n};\n\n\n/**\n * Performs an \"unchecked conversion\" from string to SafeUrl for legacy API\n * purposes.\n *\n * Please read fileoverview documentation before using.\n *\n * @param {string} url A string to be converted to SafeUrl.\n * @return {!goog.html.SafeUrl} The value of url, wrapped in a SafeUrl\n *     object.\n */\ngoog.html.legacyconversions.safeUrlFromString = function(url) {\n  goog.html.legacyconversions.reportCallback_();\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url);\n};\n\n\n/**\n * Performs an \"unchecked conversion\" from string to TrustedResourceUrl for\n * legacy API purposes.\n *\n * Please read fileoverview documentation before using.\n *\n * @param {string} url A string to be converted to TrustedResourceUrl.\n * @return {!goog.html.TrustedResourceUrl} The value of url, wrapped in a\n *     TrustedResourceUrl object.\n */\ngoog.html.legacyconversions.trustedResourceUrlFromString = function(url) {\n  goog.html.legacyconversions.reportCallback_();\n  return goog.html.TrustedResourceUrl\n      .createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(url);\n};\n\n/**\n * @private {function(): undefined}\n */\ngoog.html.legacyconversions.reportCallback_ = goog.nullFunction;\n\n\n/**\n * Sets a function that will be called every time a legacy conversion is\n * performed. The function is called with no parameters but it can use\n * goog.debug.getStacktrace to get a stacktrace.\n *\n * @param {function(): undefined} callback Error callback as defined above.\n */\ngoog.html.legacyconversions.setReportCallback = function(callback) {\n  goog.html.legacyconversions.reportCallback_ = callback;\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for element styles.\n *\n * @author arv@google.com (Erik Arvidsson)\n * @author eae@google.com (Emil A Eklund)\n * @see ../demos/inline_block_quirks.html\n * @see ../demos/inline_block_standards.html\n * @see ../demos/style_viewport.html\n */\n\ngoog.provide('goog.style');\n\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.dom.NodeType');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.vendor');\ngoog.require('goog.html.SafeStyleSheet');\ngoog.require('goog.html.legacyconversions');\ngoog.require('goog.math.Box');\ngoog.require('goog.math.Coordinate');\ngoog.require('goog.math.Rect');\ngoog.require('goog.math.Size');\ngoog.require('goog.object');\ngoog.require('goog.reflect');\ngoog.require('goog.string');\ngoog.require('goog.userAgent');\n\ngoog.forwardDeclare('goog.events.BrowserEvent');\ngoog.forwardDeclare('goog.events.Event');\n\n\n/**\n * Sets a style value on an element.\n *\n * This function is not indended to patch issues in the browser's style\n * handling, but to allow easy programmatic access to setting dash-separated\n * style properties.  An example is setting a batch of properties from a data\n * object without overwriting old styles.  When possible, use native APIs:\n * elem.style.propertyKey = 'value' or (if obliterating old styles is fine)\n * elem.style.cssText = 'property1: value1; property2: value2'.\n *\n * @param {Element} element The element to change.\n * @param {string|Object} style If a string, a style name. If an object, a hash\n *     of style names to style values.\n * @param {string|number|boolean=} opt_value If style was a string, then this\n *     should be the value.\n */\ngoog.style.setStyle = function(element, style, opt_value) {\n  if (goog.isString(style)) {\n    goog.style.setStyle_(element, opt_value, style);\n  } else {\n    for (var key in style) {\n      goog.style.setStyle_(element, style[key], key);\n    }\n  }\n};\n\n\n/**\n * Sets a style value on an element, with parameters swapped to work with\n * {@code goog.object.forEach()}. Prepends a vendor-specific prefix when\n * necessary.\n * @param {Element} element The element to change.\n * @param {string|number|boolean|undefined} value Style value.\n * @param {string} style Style name.\n * @private\n */\ngoog.style.setStyle_ = function(element, value, style) {\n  var propertyName = goog.style.getVendorJsStyleName_(element, style);\n\n  if (propertyName) {\n    // TODO(johnlenz): coerce to string?\n    element.style[propertyName] = /** @type {?} */ (value);\n  }\n};\n\n\n/**\n * Style name cache that stores previous property name lookups.\n *\n * This is used by setStyle to speed up property lookups, entries look like:\n *   { StyleName: ActualPropertyName }\n *\n * @private {!Object<string, string>}\n */\ngoog.style.styleNameCache_ = {};\n\n\n/**\n * Returns the style property name in camel-case. If it does not exist and a\n * vendor-specific version of the property does exist, then return the vendor-\n * specific property name instead.\n * @param {Element} element The element to change.\n * @param {string} style Style name.\n * @return {string} Vendor-specific style.\n * @private\n */\ngoog.style.getVendorJsStyleName_ = function(element, style) {\n  var propertyName = goog.style.styleNameCache_[style];\n  if (!propertyName) {\n    var camelStyle = goog.string.toCamelCase(style);\n    propertyName = camelStyle;\n\n    if (element.style[camelStyle] === undefined) {\n      var prefixedStyle = goog.dom.vendor.getVendorJsPrefix() +\n          goog.string.toTitleCase(camelStyle);\n\n      if (element.style[prefixedStyle] !== undefined) {\n        propertyName = prefixedStyle;\n      }\n    }\n    goog.style.styleNameCache_[style] = propertyName;\n  }\n\n  return propertyName;\n};\n\n\n/**\n * Returns the style property name in CSS notation. If it does not exist and a\n * vendor-specific version of the property does exist, then return the vendor-\n * specific property name instead.\n * @param {Element} element The element to change.\n * @param {string} style Style name.\n * @return {string} Vendor-specific style.\n * @private\n */\ngoog.style.getVendorStyleName_ = function(element, style) {\n  var camelStyle = goog.string.toCamelCase(style);\n\n  if (element.style[camelStyle] === undefined) {\n    var prefixedStyle = goog.dom.vendor.getVendorJsPrefix() +\n        goog.string.toTitleCase(camelStyle);\n\n    if (element.style[prefixedStyle] !== undefined) {\n      return goog.dom.vendor.getVendorPrefix() + '-' + style;\n    }\n  }\n\n  return style;\n};\n\n\n/**\n * Retrieves an explicitly-set style value of a node. This returns '' if there\n * isn't a style attribute on the element or if this style property has not been\n * explicitly set in script.\n *\n * @param {Element} element Element to get style of.\n * @param {string} property Property to get, css-style (if you have a camel-case\n * property, use element.style[style]).\n * @return {string} Style value.\n */\ngoog.style.getStyle = function(element, property) {\n  // element.style is '' for well-known properties which are unset.\n  // For for browser specific styles as 'filter' is undefined\n  // so we need to return '' explicitly to make it consistent across\n  // browsers.\n  var styleValue = element.style[goog.string.toCamelCase(property)];\n\n  // Using typeof here because of a bug in Safari 5.1, where this value\n  // was undefined, but === undefined returned false.\n  if (typeof(styleValue) !== 'undefined') {\n    return styleValue;\n  }\n\n  return element.style[goog.style.getVendorJsStyleName_(element, property)] ||\n      '';\n};\n\n\n/**\n * Retrieves a computed style value of a node. It returns empty string if the\n * value cannot be computed (which will be the case in Internet Explorer) or\n * \"none\" if the property requested is an SVG one and it has not been\n * explicitly set (firefox and webkit).\n *\n * @param {Element} element Element to get style of.\n * @param {string} property Property to get (camel-case).\n * @return {string} Style value.\n */\ngoog.style.getComputedStyle = function(element, property) {\n  var doc = goog.dom.getOwnerDocument(element);\n  if (doc.defaultView && doc.defaultView.getComputedStyle) {\n    var styles = doc.defaultView.getComputedStyle(element, null);\n    if (styles) {\n      // element.style[..] is undefined for browser specific styles\n      // as 'filter'.\n      return styles[property] || styles.getPropertyValue(property) || '';\n    }\n  }\n\n  return '';\n};\n\n\n/**\n * Gets the cascaded style value of a node, or null if the value cannot be\n * computed (only Internet Explorer can do this).\n *\n * @param {Element} element Element to get style of.\n * @param {string} style Property to get (camel-case).\n * @return {string} Style value.\n */\ngoog.style.getCascadedStyle = function(element, style) {\n  // TODO(nicksantos): This should be documented to return null. #fixTypes\n  return element.currentStyle ? element.currentStyle[style] : null;\n};\n\n\n/**\n * Cross-browser pseudo get computed style. It returns the computed style where\n * available. If not available it tries the cascaded style value (IE\n * currentStyle) and in worst case the inline style value.  It shouldn't be\n * called directly, see http://wiki/Main/ComputedStyleVsCascadedStyle for\n * discussion.\n *\n * @param {Element} element Element to get style of.\n * @param {string} style Property to get (must be camelCase, not css-style.).\n * @return {string} Style value.\n * @private\n */\ngoog.style.getStyle_ = function(element, style) {\n  return goog.style.getComputedStyle(element, style) ||\n      goog.style.getCascadedStyle(element, style) ||\n      (element.style && element.style[style]);\n};\n\n\n/**\n * Retrieves the computed value of the box-sizing CSS attribute.\n * Browser support: http://caniuse.com/css3-boxsizing.\n * @param {!Element} element The element whose box-sizing to get.\n * @return {?string} 'content-box', 'border-box' or 'padding-box'. null if\n *     box-sizing is not supported (IE7 and below).\n */\ngoog.style.getComputedBoxSizing = function(element) {\n  return goog.style.getStyle_(element, 'boxSizing') ||\n      goog.style.getStyle_(element, 'MozBoxSizing') ||\n      goog.style.getStyle_(element, 'WebkitBoxSizing') || null;\n};\n\n\n/**\n * Retrieves the computed value of the position CSS attribute.\n * @param {Element} element The element to get the position of.\n * @return {string} Position value.\n */\ngoog.style.getComputedPosition = function(element) {\n  return goog.style.getStyle_(element, 'position');\n};\n\n\n/**\n * Retrieves the computed background color string for a given element. The\n * string returned is suitable for assigning to another element's\n * background-color, but is not guaranteed to be in any particular string\n * format. Accessing the color in a numeric form may not be possible in all\n * browsers or with all input.\n *\n * If the background color for the element is defined as a hexadecimal value,\n * the resulting string can be parsed by goog.color.parse in all supported\n * browsers.\n *\n * Whether named colors like \"red\" or \"lightblue\" get translated into a\n * format which can be parsed is browser dependent. Calling this function on\n * transparent elements will return \"transparent\" in most browsers or\n * \"rgba(0, 0, 0, 0)\" in WebKit.\n * @param {Element} element The element to get the background color of.\n * @return {string} The computed string value of the background color.\n */\ngoog.style.getBackgroundColor = function(element) {\n  return goog.style.getStyle_(element, 'backgroundColor');\n};\n\n\n/**\n * Retrieves the computed value of the overflow-x CSS attribute.\n * @param {Element} element The element to get the overflow-x of.\n * @return {string} The computed string value of the overflow-x attribute.\n */\ngoog.style.getComputedOverflowX = function(element) {\n  return goog.style.getStyle_(element, 'overflowX');\n};\n\n\n/**\n * Retrieves the computed value of the overflow-y CSS attribute.\n * @param {Element} element The element to get the overflow-y of.\n * @return {string} The computed string value of the overflow-y attribute.\n */\ngoog.style.getComputedOverflowY = function(element) {\n  return goog.style.getStyle_(element, 'overflowY');\n};\n\n\n/**\n * Retrieves the computed value of the z-index CSS attribute.\n * @param {Element} element The element to get the z-index of.\n * @return {string|number} The computed value of the z-index attribute.\n */\ngoog.style.getComputedZIndex = function(element) {\n  return goog.style.getStyle_(element, 'zIndex');\n};\n\n\n/**\n * Retrieves the computed value of the text-align CSS attribute.\n * @param {Element} element The element to get the text-align of.\n * @return {string} The computed string value of the text-align attribute.\n */\ngoog.style.getComputedTextAlign = function(element) {\n  return goog.style.getStyle_(element, 'textAlign');\n};\n\n\n/**\n * Retrieves the computed value of the cursor CSS attribute.\n * @param {Element} element The element to get the cursor of.\n * @return {string} The computed string value of the cursor attribute.\n */\ngoog.style.getComputedCursor = function(element) {\n  return goog.style.getStyle_(element, 'cursor');\n};\n\n\n/**\n * Retrieves the computed value of the CSS transform attribute.\n * @param {Element} element The element to get the transform of.\n * @return {string} The computed string representation of the transform matrix.\n */\ngoog.style.getComputedTransform = function(element) {\n  var property = goog.style.getVendorStyleName_(element, 'transform');\n  return goog.style.getStyle_(element, property) ||\n      goog.style.getStyle_(element, 'transform');\n};\n\n\n/**\n * Sets the top/left values of an element.  If no unit is specified in the\n * argument then it will add px. The second argument is required if the first\n * argument is a string or number and is ignored if the first argument\n * is a coordinate.\n * @param {Element} el Element to move.\n * @param {string|number|goog.math.Coordinate} arg1 Left position or coordinate.\n * @param {string|number=} opt_arg2 Top position.\n */\ngoog.style.setPosition = function(el, arg1, opt_arg2) {\n  var x, y;\n\n  if (arg1 instanceof goog.math.Coordinate) {\n    x = arg1.x;\n    y = arg1.y;\n  } else {\n    x = arg1;\n    y = opt_arg2;\n  }\n\n  el.style.left = goog.style.getPixelStyleValue_(\n      /** @type {number|string} */ (x), false);\n  el.style.top = goog.style.getPixelStyleValue_(\n      /** @type {number|string} */ (y), false);\n};\n\n\n/**\n * Gets the offsetLeft and offsetTop properties of an element and returns them\n * in a Coordinate object\n * @param {Element} element Element.\n * @return {!goog.math.Coordinate} The position.\n */\ngoog.style.getPosition = function(element) {\n  return new goog.math.Coordinate(\n      /** @type {!HTMLElement} */ (element).offsetLeft,\n      /** @type {!HTMLElement} */ (element).offsetTop);\n};\n\n\n/**\n * Returns the viewport element for a particular document\n * @param {Node=} opt_node DOM node (Document is OK) to get the viewport element\n *     of.\n * @return {Element} document.documentElement or document.body.\n */\ngoog.style.getClientViewportElement = function(opt_node) {\n  var doc;\n  if (opt_node) {\n    doc = goog.dom.getOwnerDocument(opt_node);\n  } else {\n    doc = goog.dom.getDocument();\n  }\n\n  // In old IE versions the document.body represented the viewport\n  if (goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(9) &&\n      !goog.dom.getDomHelper(doc).isCss1CompatMode()) {\n    return doc.body;\n  }\n  return doc.documentElement;\n};\n\n\n/**\n * Calculates the viewport coordinates relative to the page/document\n * containing the node. The viewport may be the browser viewport for\n * non-iframe document, or the iframe container for iframe'd document.\n * @param {!Document} doc The document to use as the reference point.\n * @return {!goog.math.Coordinate} The page offset of the viewport.\n */\ngoog.style.getViewportPageOffset = function(doc) {\n  var body = doc.body;\n  var documentElement = doc.documentElement;\n  var scrollLeft = body.scrollLeft || documentElement.scrollLeft;\n  var scrollTop = body.scrollTop || documentElement.scrollTop;\n  return new goog.math.Coordinate(scrollLeft, scrollTop);\n};\n\n\n/**\n * Gets the client rectangle of the DOM element.\n *\n * getBoundingClientRect is part of a new CSS object model draft (with a\n * long-time presence in IE), replacing the error-prone parent offset\n * computation and the now-deprecated Gecko getBoxObjectFor.\n *\n * This utility patches common browser bugs in getBoundingClientRect. It\n * will fail if getBoundingClientRect is unsupported.\n *\n * If the element is not in the DOM, the result is undefined, and an error may\n * be thrown depending on user agent.\n *\n * @param {!Element} el The element whose bounding rectangle is being queried.\n * @return {Object} A native bounding rectangle with numerical left, top,\n *     right, and bottom.  Reported by Firefox to be of object type ClientRect.\n * @private\n */\ngoog.style.getBoundingClientRect_ = function(el) {\n  var rect;\n  try {\n    rect = el.getBoundingClientRect();\n  } catch (e) {\n    // In IE < 9, calling getBoundingClientRect on an orphan element raises an\n    // \"Unspecified Error\". All other browsers return zeros.\n    return {'left': 0, 'top': 0, 'right': 0, 'bottom': 0};\n  }\n\n  // Patch the result in IE only, so that this function can be inlined if\n  // compiled for non-IE.\n  if (goog.userAgent.IE && el.ownerDocument.body) {\n    // In IE, most of the time, 2 extra pixels are added to the top and left\n    // due to the implicit 2-pixel inset border.  In IE6/7 quirks mode and\n    // IE6 standards mode, this border can be overridden by setting the\n    // document element's border to zero -- thus, we cannot rely on the\n    // offset always being 2 pixels.\n\n    // In quirks mode, the offset can be determined by querying the body's\n    // clientLeft/clientTop, but in standards mode, it is found by querying\n    // the document element's clientLeft/clientTop.  Since we already called\n    // getBoundingClientRect we have already forced a reflow, so it is not\n    // too expensive just to query them all.\n\n    // See: http://msdn.microsoft.com/en-us/library/ms536433(VS.85).aspx\n    var doc = el.ownerDocument;\n    rect.left -= doc.documentElement.clientLeft + doc.body.clientLeft;\n    rect.top -= doc.documentElement.clientTop + doc.body.clientTop;\n  }\n  return rect;\n};\n\n\n/**\n * Returns the first parent that could affect the position of a given element.\n * @param {Element} element The element to get the offset parent for.\n * @return {Element} The first offset parent or null if one cannot be found.\n */\ngoog.style.getOffsetParent = function(element) {\n  // element.offsetParent does the right thing in IE7 and below.  In other\n  // browsers it only includes elements with position absolute, relative or\n  // fixed, not elements with overflow set to auto or scroll.\n  if (goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(8)) {\n    goog.asserts.assert(element && 'offsetParent' in element);\n    return element.offsetParent;\n  }\n\n  var doc = goog.dom.getOwnerDocument(element);\n  var positionStyle = goog.style.getStyle_(element, 'position');\n  var skipStatic = positionStyle == 'fixed' || positionStyle == 'absolute';\n  for (var parent = element.parentNode; parent && parent != doc;\n       parent = parent.parentNode) {\n    // Skip shadowDOM roots.\n    if (parent.nodeType == goog.dom.NodeType.DOCUMENT_FRAGMENT && parent.host) {\n      parent = parent.host;\n    }\n    positionStyle =\n        goog.style.getStyle_(/** @type {!Element} */ (parent), 'position');\n    skipStatic = skipStatic && positionStyle == 'static' &&\n        parent != doc.documentElement && parent != doc.body;\n    if (!skipStatic &&\n        (parent.scrollWidth > parent.clientWidth ||\n         parent.scrollHeight > parent.clientHeight ||\n         positionStyle == 'fixed' || positionStyle == 'absolute' ||\n         positionStyle == 'relative')) {\n      return /** @type {!Element} */ (parent);\n    }\n  }\n  return null;\n};\n\n\n/**\n * Calculates and returns the visible rectangle for a given element. Returns a\n * box describing the visible portion of the nearest scrollable offset ancestor.\n * Coordinates are given relative to the document.\n *\n * @param {Element} element Element to get the visible rect for.\n * @return {goog.math.Box} Bounding elementBox describing the visible rect or\n *     null if scrollable ancestor isn't inside the visible viewport.\n */\ngoog.style.getVisibleRectForElement = function(element) {\n  var visibleRect = new goog.math.Box(0, Infinity, Infinity, 0);\n  var dom = goog.dom.getDomHelper(element);\n  var body = dom.getDocument().body;\n  var documentElement = dom.getDocument().documentElement;\n  var scrollEl = dom.getDocumentScrollElement();\n\n  // Determine the size of the visible rect by climbing the dom accounting for\n  // all scrollable containers.\n  for (var el = element; el = goog.style.getOffsetParent(el);) {\n    // clientWidth is zero for inline block elements in IE.\n    // on WEBKIT, body element can have clientHeight = 0 and scrollHeight > 0\n    if ((!goog.userAgent.IE || el.clientWidth != 0) &&\n        (!goog.userAgent.WEBKIT || el.clientHeight != 0 || el != body) &&\n        // body may have overflow set on it, yet we still get the entire\n        // viewport. In some browsers, el.offsetParent may be\n        // document.documentElement, so check for that too.\n        (el != body && el != documentElement &&\n         goog.style.getStyle_(el, 'overflow') != 'visible')) {\n      var pos = goog.style.getPageOffset(el);\n      var client = goog.style.getClientLeftTop(el);\n      pos.x += client.x;\n      pos.y += client.y;\n\n      visibleRect.top = Math.max(visibleRect.top, pos.y);\n      visibleRect.right = Math.min(visibleRect.right, pos.x + el.clientWidth);\n      visibleRect.bottom =\n          Math.min(visibleRect.bottom, pos.y + el.clientHeight);\n      visibleRect.left = Math.max(visibleRect.left, pos.x);\n    }\n  }\n\n  // Clip by window's viewport.\n  var scrollX = scrollEl.scrollLeft, scrollY = scrollEl.scrollTop;\n  visibleRect.left = Math.max(visibleRect.left, scrollX);\n  visibleRect.top = Math.max(visibleRect.top, scrollY);\n  var winSize = dom.getViewportSize();\n  visibleRect.right = Math.min(visibleRect.right, scrollX + winSize.width);\n  visibleRect.bottom = Math.min(visibleRect.bottom, scrollY + winSize.height);\n  return visibleRect.top >= 0 && visibleRect.left >= 0 &&\n          visibleRect.bottom > visibleRect.top &&\n          visibleRect.right > visibleRect.left ?\n      visibleRect :\n      null;\n};\n\n\n/**\n * Calculate the scroll position of {@code container} with the minimum amount so\n * that the content and the borders of the given {@code element} become visible.\n * If the element is bigger than the container, its top left corner will be\n * aligned as close to the container's top left corner as possible.\n *\n * @param {Element} element The element to make visible.\n * @param {Element=} opt_container The container to scroll. If not set, then the\n *     document scroll element will be used.\n * @param {boolean=} opt_center Whether to center the element in the container.\n *     Defaults to false.\n * @return {!goog.math.Coordinate} The new scroll position of the container,\n *     in form of goog.math.Coordinate(scrollLeft, scrollTop).\n */\ngoog.style.getContainerOffsetToScrollInto = function(\n    element, opt_container, opt_center) {\n  var container = opt_container || goog.dom.getDocumentScrollElement();\n  // Absolute position of the element's border's top left corner.\n  var elementPos = goog.style.getPageOffset(element);\n  // Absolute position of the container's border's top left corner.\n  var containerPos = goog.style.getPageOffset(container);\n  var containerBorder = goog.style.getBorderBox(container);\n  if (container == goog.dom.getDocumentScrollElement()) {\n    // The element position is calculated based on the page offset, and the\n    // document scroll element holds the scroll position within the page. We can\n    // use the scroll position to calculate the relative position from the\n    // element.\n    var relX = elementPos.x - container.scrollLeft;\n    var relY = elementPos.y - container.scrollTop;\n    if (goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(10)) {\n      // In older versions of IE getPageOffset(element) does not include the\n      // container border so it has to be added to accommodate.\n      relX += containerBorder.left;\n      relY += containerBorder.top;\n    }\n  } else {\n    // Relative pos. of the element's border box to the container's content box.\n    var relX = elementPos.x - containerPos.x - containerBorder.left;\n    var relY = elementPos.y - containerPos.y - containerBorder.top;\n  }\n  // How much the element can move in the container, i.e. the difference between\n  // the element's bottom-right-most and top-left-most position where it's\n  // fully visible.\n  var elementSize = goog.style.getSizeWithDisplay_(element);\n  var spaceX = container.clientWidth - elementSize.width;\n  var spaceY = container.clientHeight - elementSize.height;\n  var scrollLeft = container.scrollLeft;\n  var scrollTop = container.scrollTop;\n  if (opt_center) {\n    // All browsers round non-integer scroll positions down.\n    scrollLeft += relX - spaceX / 2;\n    scrollTop += relY - spaceY / 2;\n  } else {\n    // This formula was designed to give the correct scroll values in the\n    // following cases:\n    // - element is higher than container (spaceY < 0) => scroll down by relY\n    // - element is not higher that container (spaceY >= 0):\n    //   - it is above container (relY < 0) => scroll up by abs(relY)\n    //   - it is below container (relY > spaceY) => scroll down by relY - spaceY\n    //   - it is in the container => don't scroll\n    scrollLeft += Math.min(relX, Math.max(relX - spaceX, 0));\n    scrollTop += Math.min(relY, Math.max(relY - spaceY, 0));\n  }\n  return new goog.math.Coordinate(scrollLeft, scrollTop);\n};\n\n\n/**\n * Changes the scroll position of {@code container} with the minimum amount so\n * that the content and the borders of the given {@code element} become visible.\n * If the element is bigger than the container, its top left corner will be\n * aligned as close to the container's top left corner as possible.\n *\n * @param {Element} element The element to make visible.\n * @param {Element=} opt_container The container to scroll. If not set, then the\n *     document scroll element will be used.\n * @param {boolean=} opt_center Whether to center the element in the container.\n *     Defaults to false.\n */\ngoog.style.scrollIntoContainerView = function(\n    element, opt_container, opt_center) {\n  var container = opt_container || goog.dom.getDocumentScrollElement();\n  var offset =\n      goog.style.getContainerOffsetToScrollInto(element, container, opt_center);\n  container.scrollLeft = offset.x;\n  container.scrollTop = offset.y;\n};\n\n\n/**\n * Returns clientLeft (width of the left border and, if the directionality is\n * right to left, the vertical scrollbar) and clientTop as a coordinate object.\n *\n * @param {Element} el Element to get clientLeft for.\n * @return {!goog.math.Coordinate} Client left and top.\n */\ngoog.style.getClientLeftTop = function(el) {\n  return new goog.math.Coordinate(el.clientLeft, el.clientTop);\n};\n\n\n/**\n * Returns a Coordinate object relative to the top-left of the HTML document.\n * Implemented as a single function to save having to do two recursive loops in\n * opera and safari just to get both coordinates.  If you just want one value do\n * use goog.style.getPageOffsetLeft() and goog.style.getPageOffsetTop(), but\n * note if you call both those methods the tree will be analysed twice.\n *\n * @param {Element} el Element to get the page offset for.\n * @return {!goog.math.Coordinate} The page offset.\n */\ngoog.style.getPageOffset = function(el) {\n  var doc = goog.dom.getOwnerDocument(el);\n  // TODO(gboyer): Update the jsdoc in a way that doesn't break the universe.\n  goog.asserts.assertObject(el, 'Parameter is required');\n\n  // NOTE(arv): If element is hidden (display none or disconnected or any the\n  // ancestors are hidden) we get (0,0) by default but we still do the\n  // accumulation of scroll position.\n\n  // TODO(arv): Should we check if the node is disconnected and in that case\n  //            return (0,0)?\n\n  var pos = new goog.math.Coordinate(0, 0);\n  var viewportElement = goog.style.getClientViewportElement(doc);\n  if (el == viewportElement) {\n    // viewport is always at 0,0 as that defined the coordinate system for this\n    // function - this avoids special case checks in the code below\n    return pos;\n  }\n\n  var box = goog.style.getBoundingClientRect_(el);\n  // Must add the scroll coordinates in to get the absolute page offset\n  // of element since getBoundingClientRect returns relative coordinates to\n  // the viewport.\n  var scrollCoord = goog.dom.getDomHelper(doc).getDocumentScroll();\n  pos.x = box.left + scrollCoord.x;\n  pos.y = box.top + scrollCoord.y;\n\n  return pos;\n};\n\n\n/**\n * Returns the left coordinate of an element relative to the HTML document\n * @param {Element} el Elements.\n * @return {number} The left coordinate.\n */\ngoog.style.getPageOffsetLeft = function(el) {\n  return goog.style.getPageOffset(el).x;\n};\n\n\n/**\n * Returns the top coordinate of an element relative to the HTML document\n * @param {Element} el Elements.\n * @return {number} The top coordinate.\n */\ngoog.style.getPageOffsetTop = function(el) {\n  return goog.style.getPageOffset(el).y;\n};\n\n\n/**\n * Returns a Coordinate object relative to the top-left of an HTML document\n * in an ancestor frame of this element. Used for measuring the position of\n * an element inside a frame relative to a containing frame.\n *\n * @param {Element} el Element to get the page offset for.\n * @param {Window} relativeWin The window to measure relative to. If relativeWin\n *     is not in the ancestor frame chain of the element, we measure relative to\n *     the top-most window.\n * @return {!goog.math.Coordinate} The page offset.\n */\ngoog.style.getFramedPageOffset = function(el, relativeWin) {\n  var position = new goog.math.Coordinate(0, 0);\n\n  // Iterate up the ancestor frame chain, keeping track of the current window\n  // and the current element in that window.\n  var currentWin = goog.dom.getWindow(goog.dom.getOwnerDocument(el));\n\n  // MS Edge throws when accessing \"parent\" if el's containing iframe has been\n  // deleted.\n  if (!goog.reflect.canAccessProperty(currentWin, 'parent')) {\n    return position;\n  }\n\n  var currentEl = el;\n  do {\n    // if we're at the top window, we want to get the page offset.\n    // if we're at an inner frame, we only want to get the window position\n    // so that we can determine the actual page offset in the context of\n    // the outer window.\n    var offset = currentWin == relativeWin ?\n        goog.style.getPageOffset(currentEl) :\n        goog.style.getClientPositionForElement_(goog.asserts.assert(currentEl));\n\n    position.x += offset.x;\n    position.y += offset.y;\n  } while (currentWin && currentWin != relativeWin &&\n           currentWin != currentWin.parent &&\n           (currentEl = currentWin.frameElement) &&\n           (currentWin = currentWin.parent));\n\n  return position;\n};\n\n\n/**\n * Translates the specified rect relative to origBase page, for newBase page.\n * If origBase and newBase are the same, this function does nothing.\n *\n * @param {goog.math.Rect} rect The source rectangle relative to origBase page,\n *     and it will have the translated result.\n * @param {goog.dom.DomHelper} origBase The DomHelper for the input rectangle.\n * @param {goog.dom.DomHelper} newBase The DomHelper for the resultant\n *     coordinate.  This must be a DOM for an ancestor frame of origBase\n *     or the same as origBase.\n */\ngoog.style.translateRectForAnotherFrame = function(rect, origBase, newBase) {\n  if (origBase.getDocument() != newBase.getDocument()) {\n    var body = origBase.getDocument().body;\n    var pos = goog.style.getFramedPageOffset(body, newBase.getWindow());\n\n    // Adjust Body's margin.\n    pos = goog.math.Coordinate.difference(pos, goog.style.getPageOffset(body));\n\n    if (goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(9) &&\n        !origBase.isCss1CompatMode()) {\n      pos = goog.math.Coordinate.difference(pos, origBase.getDocumentScroll());\n    }\n\n    rect.left += pos.x;\n    rect.top += pos.y;\n  }\n};\n\n\n/**\n * Returns the position of an element relative to another element in the\n * document.  A relative to B\n * @param {Element|Event|goog.events.Event} a Element or mouse event whose\n *     position we're calculating.\n * @param {Element|Event|goog.events.Event} b Element or mouse event position\n *     is relative to.\n * @return {!goog.math.Coordinate} The relative position.\n */\ngoog.style.getRelativePosition = function(a, b) {\n  var ap = goog.style.getClientPosition(a);\n  var bp = goog.style.getClientPosition(b);\n  return new goog.math.Coordinate(ap.x - bp.x, ap.y - bp.y);\n};\n\n\n/**\n * Returns the position of the event or the element's border box relative to\n * the client viewport.\n * @param {!Element} el Element whose position to get.\n * @return {!goog.math.Coordinate} The position.\n * @private\n */\ngoog.style.getClientPositionForElement_ = function(el) {\n  var box = goog.style.getBoundingClientRect_(el);\n  return new goog.math.Coordinate(box.left, box.top);\n};\n\n\n/**\n * Returns the position of the event or the element's border box relative to\n * the client viewport. If an event is passed, and if this event is a \"touch\"\n * event, then the position of the first changedTouches will be returned.\n * @param {Element|Event|goog.events.Event} el Element or a mouse / touch event.\n * @return {!goog.math.Coordinate} The position.\n */\ngoog.style.getClientPosition = function(el) {\n  goog.asserts.assert(el);\n  if (el.nodeType == goog.dom.NodeType.ELEMENT) {\n    return goog.style.getClientPositionForElement_(\n        /** @type {!Element} */ (el));\n  } else {\n    var targetEvent = el.changedTouches ? el.changedTouches[0] : el;\n    return new goog.math.Coordinate(targetEvent.clientX, targetEvent.clientY);\n  }\n};\n\n\n/**\n * Moves an element to the given coordinates relative to the client viewport.\n * @param {Element} el Absolutely positioned element to set page offset for.\n *     It must be in the document.\n * @param {number|goog.math.Coordinate} x Left position of the element's margin\n *     box or a coordinate object.\n * @param {number=} opt_y Top position of the element's margin box.\n */\ngoog.style.setPageOffset = function(el, x, opt_y) {\n  // Get current pageoffset\n  var cur = goog.style.getPageOffset(el);\n\n  if (x instanceof goog.math.Coordinate) {\n    opt_y = x.y;\n    x = x.x;\n  }\n\n  // NOTE(arv): We cannot allow strings for x and y. We could but that would\n  // require us to manually transform between different units\n\n  // Work out deltas\n  var dx = goog.asserts.assertNumber(x) - cur.x;\n  var dy = Number(opt_y) - cur.y;\n\n  // Set position to current left/top + delta\n  goog.style.setPosition(\n      el, /** @type {!HTMLElement} */ (el).offsetLeft + dx,\n      /** @type {!HTMLElement} */ (el).offsetTop + dy);\n};\n\n\n/**\n * Sets the width/height values of an element.  If an argument is numeric,\n * or a goog.math.Size is passed, it is assumed to be pixels and will add\n * 'px' after converting it to an integer in string form. (This just sets the\n * CSS width and height properties so it might set content-box or border-box\n * size depending on the box model the browser is using.)\n *\n * @param {Element} element Element to set the size of.\n * @param {string|number|goog.math.Size} w Width of the element, or a\n *     size object.\n * @param {string|number=} opt_h Height of the element. Required if w is not a\n *     size object.\n */\ngoog.style.setSize = function(element, w, opt_h) {\n  var h;\n  if (w instanceof goog.math.Size) {\n    h = w.height;\n    w = w.width;\n  } else {\n    if (opt_h == undefined) {\n      throw Error('missing height argument');\n    }\n    h = opt_h;\n  }\n\n  goog.style.setWidth(element, /** @type {string|number} */ (w));\n  goog.style.setHeight(element, h);\n};\n\n\n/**\n * Helper function to create a string to be set into a pixel-value style\n * property of an element. Can round to the nearest integer value.\n *\n * @param {string|number} value The style value to be used. If a number,\n *     'px' will be appended, otherwise the value will be applied directly.\n * @param {boolean} round Whether to round the nearest integer (if property\n *     is a number).\n * @return {string} The string value for the property.\n * @private\n */\ngoog.style.getPixelStyleValue_ = function(value, round) {\n  if (typeof value == 'number') {\n    value = (round ? Math.round(value) : value) + 'px';\n  }\n\n  return value;\n};\n\n\n/**\n * Set the height of an element.  Sets the element's style property.\n * @param {Element} element Element to set the height of.\n * @param {string|number} height The height value to set.  If a number, 'px'\n *     will be appended, otherwise the value will be applied directly.\n */\ngoog.style.setHeight = function(element, height) {\n  element.style.height = goog.style.getPixelStyleValue_(height, true);\n};\n\n\n/**\n * Set the width of an element.  Sets the element's style property.\n * @param {Element} element Element to set the width of.\n * @param {string|number} width The width value to set.  If a number, 'px'\n *     will be appended, otherwise the value will be applied directly.\n */\ngoog.style.setWidth = function(element, width) {\n  element.style.width = goog.style.getPixelStyleValue_(width, true);\n};\n\n\n/**\n * Gets the height and width of an element, even if its display is none.\n *\n * Specifically, this returns the height and width of the border box,\n * irrespective of the box model in effect.\n *\n * Note that this function does not take CSS transforms into account. Please see\n * {@code goog.style.getTransformedSize}.\n * @param {Element} element Element to get size of.\n * @return {!goog.math.Size} Object with width/height properties.\n */\ngoog.style.getSize = function(element) {\n  return goog.style.evaluateWithTemporaryDisplay_(\n      goog.style.getSizeWithDisplay_, /** @type {!Element} */ (element));\n};\n\n\n/**\n * Call {@code fn} on {@code element} such that {@code element}'s dimensions are\n * accurate when it's passed to {@code fn}.\n * @param {function(!Element): T} fn Function to call with {@code element} as\n *     an argument after temporarily changing {@code element}'s display such\n *     that its dimensions are accurate.\n * @param {!Element} element Element (which may have display none) to use as\n *     argument to {@code fn}.\n * @return {T} Value returned by calling {@code fn} with {@code element}.\n * @template T\n * @private\n */\ngoog.style.evaluateWithTemporaryDisplay_ = function(fn, element) {\n  if (goog.style.getStyle_(element, 'display') != 'none') {\n    return fn(element);\n  }\n\n  var style = element.style;\n  var originalDisplay = style.display;\n  var originalVisibility = style.visibility;\n  var originalPosition = style.position;\n\n  style.visibility = 'hidden';\n  style.position = 'absolute';\n  style.display = 'inline';\n\n  var retVal = fn(element);\n\n  style.display = originalDisplay;\n  style.position = originalPosition;\n  style.visibility = originalVisibility;\n\n  return retVal;\n};\n\n\n/**\n * Gets the height and width of an element when the display is not none.\n * @param {Element} element Element to get size of.\n * @return {!goog.math.Size} Object with width/height properties.\n * @private\n */\ngoog.style.getSizeWithDisplay_ = function(element) {\n  var offsetWidth = /** @type {!HTMLElement} */ (element).offsetWidth;\n  var offsetHeight = /** @type {!HTMLElement} */ (element).offsetHeight;\n  var webkitOffsetsZero =\n      goog.userAgent.WEBKIT && !offsetWidth && !offsetHeight;\n  if ((!goog.isDef(offsetWidth) || webkitOffsetsZero) &&\n      element.getBoundingClientRect) {\n    // Fall back to calling getBoundingClientRect when offsetWidth or\n    // offsetHeight are not defined, or when they are zero in WebKit browsers.\n    // This makes sure that we return for the correct size for SVG elements, but\n    // will still return 0 on Webkit prior to 534.8, see\n    // http://trac.webkit.org/changeset/67252.\n    var clientRect = goog.style.getBoundingClientRect_(element);\n    return new goog.math.Size(\n        clientRect.right - clientRect.left, clientRect.bottom - clientRect.top);\n  }\n  return new goog.math.Size(offsetWidth, offsetHeight);\n};\n\n\n/**\n * Gets the height and width of an element, post transform, even if its display\n * is none.\n *\n * This is like {@code goog.style.getSize}, except:\n * <ol>\n * <li>Takes webkitTransforms such as rotate and scale into account.\n * <li>Will return null if {@code element} doesn't respond to\n *     {@code getBoundingClientRect}.\n * <li>Currently doesn't make sense on non-WebKit browsers which don't support\n *    webkitTransforms.\n * </ol>\n * @param {!Element} element Element to get size of.\n * @return {goog.math.Size} Object with width/height properties.\n */\ngoog.style.getTransformedSize = function(element) {\n  if (!element.getBoundingClientRect) {\n    return null;\n  }\n\n  var clientRect = goog.style.evaluateWithTemporaryDisplay_(\n      goog.style.getBoundingClientRect_, element);\n  return new goog.math.Size(\n      clientRect.right - clientRect.left, clientRect.bottom - clientRect.top);\n};\n\n\n/**\n * Returns a bounding rectangle for a given element in page space.\n * @param {Element} element Element to get bounds of. Must not be display none.\n * @return {!goog.math.Rect} Bounding rectangle for the element.\n */\ngoog.style.getBounds = function(element) {\n  var o = goog.style.getPageOffset(element);\n  var s = goog.style.getSize(element);\n  return new goog.math.Rect(o.x, o.y, s.width, s.height);\n};\n\n\n/**\n * Converts a CSS selector in the form style-property to styleProperty.\n * @param {*} selector CSS Selector.\n * @return {string} Camel case selector.\n * @deprecated Use goog.string.toCamelCase instead.\n */\ngoog.style.toCamelCase = function(selector) {\n  return goog.string.toCamelCase(String(selector));\n};\n\n\n/**\n * Converts a CSS selector in the form styleProperty to style-property.\n * @param {string} selector Camel case selector.\n * @return {string} Selector cased.\n * @deprecated Use goog.string.toSelectorCase instead.\n */\ngoog.style.toSelectorCase = function(selector) {\n  return goog.string.toSelectorCase(selector);\n};\n\n\n/**\n * Gets the opacity of a node (x-browser). This gets the inline style opacity\n * of the node, and does not take into account the cascaded or the computed\n * style for this node.\n * @param {Element} el Element whose opacity has to be found.\n * @return {number|string} Opacity between 0 and 1 or an empty string {@code ''}\n *     if the opacity is not set.\n */\ngoog.style.getOpacity = function(el) {\n  goog.asserts.assert(el);\n  var style = el.style;\n  var result = '';\n  if ('opacity' in style) {\n    result = style.opacity;\n  } else if ('MozOpacity' in style) {\n    result = style.MozOpacity;\n  } else if ('filter' in style) {\n    var match = style.filter.match(/alpha\\(opacity=([\\d.]+)\\)/);\n    if (match) {\n      result = String(match[1] / 100);\n    }\n  }\n  return result == '' ? result : Number(result);\n};\n\n\n/**\n * Sets the opacity of a node (x-browser).\n * @param {Element} el Elements whose opacity has to be set.\n * @param {number|string} alpha Opacity between 0 and 1 or an empty string\n *     {@code ''} to clear the opacity.\n */\ngoog.style.setOpacity = function(el, alpha) {\n  goog.asserts.assert(el);\n  var style = el.style;\n  if ('opacity' in style) {\n    style.opacity = alpha;\n  } else if ('MozOpacity' in style) {\n    style.MozOpacity = alpha;\n  } else if ('filter' in style) {\n    // TODO(arv): Overwriting the filter might have undesired side effects.\n    if (alpha === '') {\n      style.filter = '';\n    } else {\n      style.filter = 'alpha(opacity=' + (Number(alpha) * 100) + ')';\n    }\n  }\n};\n\n\n/**\n * Sets the background of an element to a transparent image in a browser-\n * independent manner.\n *\n * This function does not support repeating backgrounds or alternate background\n * positions to match the behavior of Internet Explorer. It also does not\n * support sizingMethods other than crop since they cannot be replicated in\n * browsers other than Internet Explorer.\n *\n * @param {Element} el The element to set background on.\n * @param {string} src The image source URL.\n */\ngoog.style.setTransparentBackgroundImage = function(el, src) {\n  var style = el.style;\n  // It is safe to use the style.filter in IE only. In Safari 'filter' is in\n  // style object but access to style.filter causes it to throw an exception.\n  // Note: IE8 supports images with an alpha channel.\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('8')) {\n    // See TODO in setOpacity.\n    style.filter = 'progid:DXImageTransform.Microsoft.AlphaImageLoader(' +\n        'src=\"' + src + '\", sizingMethod=\"crop\")';\n  } else {\n    // Set style properties individually instead of using background shorthand\n    // to prevent overwriting a pre-existing background color.\n    style.backgroundImage = 'url(' + src + ')';\n    style.backgroundPosition = 'top left';\n    style.backgroundRepeat = 'no-repeat';\n  }\n};\n\n\n/**\n * Clears the background image of an element in a browser independent manner.\n * @param {Element} el The element to clear background image for.\n */\ngoog.style.clearTransparentBackgroundImage = function(el) {\n  var style = el.style;\n  if ('filter' in style) {\n    // See TODO in setOpacity.\n    style.filter = '';\n  } else {\n    // Set style properties individually instead of using background shorthand\n    // to prevent overwriting a pre-existing background color.\n    style.backgroundImage = 'none';\n  }\n};\n\n\n/**\n * Shows or hides an element from the page. Hiding the element is done by\n * setting the display property to \"none\", removing the element from the\n * rendering hierarchy so it takes up no space. To show the element, the default\n * inherited display property is restored (defined either in stylesheets or by\n * the browser's default style rules.)\n *\n * Caveat 1: if the inherited display property for the element is set to \"none\"\n * by the stylesheets, that is the property that will be restored by a call to\n * showElement(), effectively toggling the display between \"none\" and \"none\".\n *\n * Caveat 2: if the element display style is set inline (by setting either\n * element.style.display or a style attribute in the HTML), a call to\n * showElement will clear that setting and defer to the inherited style in the\n * stylesheet.\n * @param {Element} el Element to show or hide.\n * @param {*} display True to render the element in its default style,\n *     false to disable rendering the element.\n * @deprecated Use goog.style.setElementShown instead.\n */\ngoog.style.showElement = function(el, display) {\n  goog.style.setElementShown(el, display);\n};\n\n\n/**\n * Shows or hides an element from the page. Hiding the element is done by\n * setting the display property to \"none\", removing the element from the\n * rendering hierarchy so it takes up no space. To show the element, the default\n * inherited display property is restored (defined either in stylesheets or by\n * the browser's default style rules).\n *\n * Caveat 1: if the inherited display property for the element is set to \"none\"\n * by the stylesheets, that is the property that will be restored by a call to\n * setElementShown(), effectively toggling the display between \"none\" and\n * \"none\".\n *\n * Caveat 2: if the element display style is set inline (by setting either\n * element.style.display or a style attribute in the HTML), a call to\n * setElementShown will clear that setting and defer to the inherited style in\n * the stylesheet.\n * @param {Element} el Element to show or hide.\n * @param {*} isShown True to render the element in its default style,\n *     false to disable rendering the element.\n */\ngoog.style.setElementShown = function(el, isShown) {\n  el.style.display = isShown ? '' : 'none';\n};\n\n\n/**\n * Test whether the given element has been shown or hidden via a call to\n * {@link #setElementShown}.\n *\n * Note this is strictly a companion method for a call\n * to {@link #setElementShown} and the same caveats apply; in particular, this\n * method does not guarantee that the return value will be consistent with\n * whether or not the element is actually visible.\n *\n * @param {Element} el The element to test.\n * @return {boolean} Whether the element has been shown.\n * @see #setElementShown\n */\ngoog.style.isElementShown = function(el) {\n  return el.style.display != 'none';\n};\n\n\n/**\n * Installs the styles string into the window that contains opt_node.  If\n * opt_node is null, the main window is used.\n * @param {string} stylesString The style string to install.\n * @param {Node=} opt_node Node whose parent document should have the\n *     styles installed.\n * @return {!Element|!StyleSheet} The style element created.\n * @deprecated Use {@link #installSafeStyleSheet} instead.\n */\ngoog.style.installStyles = function(stylesString, opt_node) {\n  return goog.style.installSafeStyleSheet(\n      goog.html.legacyconversions.safeStyleSheetFromString(stylesString),\n      opt_node);\n};\n\n\n/**\n * Installs the style sheet into the window that contains opt_node.  If\n * opt_node is null, the main window is used.\n * @param {!goog.html.SafeStyleSheet} safeStyleSheet The style sheet to install.\n * @param {?Node=} opt_node Node whose parent document should have the\n *     styles installed.\n * @return {!Element|!StyleSheet} The style element created.\n */\ngoog.style.installSafeStyleSheet = function(safeStyleSheet, opt_node) {\n  var dh = goog.dom.getDomHelper(opt_node);\n  var styleSheet = null;\n\n  // IE < 11 requires createStyleSheet. Note that doc.createStyleSheet will be\n  // undefined as of IE 11.\n  var doc = dh.getDocument();\n  if (goog.userAgent.IE && doc.createStyleSheet) {\n    styleSheet = doc.createStyleSheet();\n    goog.style.setSafeStyleSheet(styleSheet, safeStyleSheet);\n  } else {\n    var head = dh.getElementsByTagNameAndClass(goog.dom.TagName.HEAD)[0];\n\n    // In opera documents are not guaranteed to have a head element, thus we\n    // have to make sure one exists before using it.\n    if (!head) {\n      var body = dh.getElementsByTagNameAndClass(goog.dom.TagName.BODY)[0];\n      head = dh.createDom(goog.dom.TagName.HEAD);\n      body.parentNode.insertBefore(head, body);\n    }\n    styleSheet = dh.createDom(goog.dom.TagName.STYLE);\n    // NOTE(user): Setting styles after the style element has been appended\n    // to the head results in a nasty Webkit bug in certain scenarios. Please\n    // refer to https://bugs.webkit.org/show_bug.cgi?id=26307 for additional\n    // details.\n    goog.style.setSafeStyleSheet(styleSheet, safeStyleSheet);\n    dh.appendChild(head, styleSheet);\n  }\n  return styleSheet;\n};\n\n\n/**\n * Removes the styles added by {@link #installStyles}.\n * @param {Element|StyleSheet} styleSheet The value returned by\n *     {@link #installStyles}.\n */\ngoog.style.uninstallStyles = function(styleSheet) {\n  var node = styleSheet.ownerNode || styleSheet.owningElement ||\n      /** @type {Element} */ (styleSheet);\n  goog.dom.removeNode(node);\n};\n\n\n/**\n * Sets the content of a style element.  The style element can be any valid\n * style element.  This element will have its content completely replaced by\n * the stylesString.\n * @param {Element|StyleSheet} element A stylesheet element as returned by\n *     installStyles.\n * @param {string} stylesString The new content of the stylesheet.\n * @deprecated Use {@link #setSafeStyleSheet} instead.\n */\ngoog.style.setStyles = function(element, stylesString) {\n  goog.style.setSafeStyleSheet(/** @type {!Element|!StyleSheet} */ (element),\n      goog.html.legacyconversions.safeStyleSheetFromString(stylesString));\n};\n\n\n/**\n * Sets the content of a style element.  The style element can be any valid\n * style element.  This element will have its content completely replaced by\n * the safeStyleSheet.\n * @param {!Element|!StyleSheet} element A stylesheet element as returned by\n *     installStyles.\n * @param {!goog.html.SafeStyleSheet} safeStyleSheet The new content of the\n *     stylesheet.\n */\ngoog.style.setSafeStyleSheet = function(element, safeStyleSheet) {\n  var stylesString = goog.html.SafeStyleSheet.unwrap(safeStyleSheet);\n  if (goog.userAgent.IE && goog.isDef(element.cssText)) {\n    // Adding the selectors individually caused the browser to hang if the\n    // selector was invalid or there were CSS comments.  Setting the cssText of\n    // the style node works fine and ignores CSS that IE doesn't understand.\n    // However IE >= 11 doesn't support cssText any more, so we make sure that\n    // cssText is a defined property and otherwise fall back to innerHTML.\n    element.cssText = stylesString;\n  } else {\n    element.innerHTML = stylesString;\n  }\n};\n\n\n/**\n * Sets 'white-space: pre-wrap' for a node (x-browser).\n *\n * There are as many ways of specifying pre-wrap as there are browsers.\n *\n * CSS3/IE8: white-space: pre-wrap;\n * Mozilla:  white-space: -moz-pre-wrap;\n * Opera:    white-space: -o-pre-wrap;\n * IE6/7:    white-space: pre; word-wrap: break-word;\n *\n * @param {Element} el Element to enable pre-wrap for.\n */\ngoog.style.setPreWrap = function(el) {\n  var style = el.style;\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('8')) {\n    style.whiteSpace = 'pre';\n    style.wordWrap = 'break-word';\n  } else if (goog.userAgent.GECKO) {\n    style.whiteSpace = '-moz-pre-wrap';\n  } else {\n    style.whiteSpace = 'pre-wrap';\n  }\n};\n\n\n/**\n * Sets 'display: inline-block' for an element (cross-browser).\n * @param {Element} el Element to which the inline-block display style is to be\n *    applied.\n * @see ../demos/inline_block_quirks.html\n * @see ../demos/inline_block_standards.html\n */\ngoog.style.setInlineBlock = function(el) {\n  var style = el.style;\n  // Without position:relative, weirdness ensues.  Just accept it and move on.\n  style.position = 'relative';\n\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('8')) {\n    // IE8 supports inline-block so fall through to the else\n    // Zoom:1 forces hasLayout, display:inline gives inline behavior.\n    style.zoom = '1';\n    style.display = 'inline';\n  } else {\n    // Opera, Webkit, and Safari seem to do OK with the standard inline-block\n    // style.\n    style.display = 'inline-block';\n  }\n};\n\n\n/**\n * Returns true if the element is using right to left (rtl) direction.\n * @param {Element} el  The element to test.\n * @return {boolean} True for right to left, false for left to right.\n */\ngoog.style.isRightToLeft = function(el) {\n  return 'rtl' == goog.style.getStyle_(el, 'direction');\n};\n\n\n/**\n * The CSS style property corresponding to an element being\n * unselectable on the current browser platform (null if none).\n * Opera and IE instead use a DOM attribute 'unselectable'. MS Edge uses\n * the Webkit prefix.\n * @type {?string}\n * @private\n */\ngoog.style.unselectableStyle_ = goog.userAgent.GECKO ?\n    'MozUserSelect' :\n    goog.userAgent.WEBKIT || goog.userAgent.EDGE ? 'WebkitUserSelect' : null;\n\n\n/**\n * Returns true if the element is set to be unselectable, false otherwise.\n * Note that on some platforms (e.g. Mozilla), even if an element isn't set\n * to be unselectable, it will behave as such if any of its ancestors is\n * unselectable.\n * @param {Element} el  Element to check.\n * @return {boolean}  Whether the element is set to be unselectable.\n */\ngoog.style.isUnselectable = function(el) {\n  if (goog.style.unselectableStyle_) {\n    return el.style[goog.style.unselectableStyle_].toLowerCase() == 'none';\n  } else if (goog.userAgent.IE || goog.userAgent.OPERA) {\n    return el.getAttribute('unselectable') == 'on';\n  }\n  return false;\n};\n\n\n/**\n * Makes the element and its descendants selectable or unselectable.  Note\n * that on some platforms (e.g. Mozilla), even if an element isn't set to\n * be unselectable, it will behave as such if any of its ancestors is\n * unselectable.\n * @param {Element} el  The element to alter.\n * @param {boolean} unselectable  Whether the element and its descendants\n *     should be made unselectable.\n * @param {boolean=} opt_noRecurse  Whether to only alter the element's own\n *     selectable state, and leave its descendants alone; defaults to false.\n */\ngoog.style.setUnselectable = function(el, unselectable, opt_noRecurse) {\n  // TODO(attila): Do we need all of TR_DomUtil.makeUnselectable() in Closure?\n  var descendants = !opt_noRecurse ? el.getElementsByTagName('*') : null;\n  var name = goog.style.unselectableStyle_;\n  if (name) {\n    // Add/remove the appropriate CSS style to/from the element and its\n    // descendants.\n    var value = unselectable ? 'none' : '';\n    // MathML elements do not have a style property. Verify before setting.\n    if (el.style) {\n      el.style[name] = value;\n    }\n    if (descendants) {\n      for (var i = 0, descendant; descendant = descendants[i]; i++) {\n        if (descendant.style) {\n          descendant.style[name] = value;\n        }\n      }\n    }\n  } else if (goog.userAgent.IE || goog.userAgent.OPERA) {\n    // Toggle the 'unselectable' attribute on the element and its descendants.\n    var value = unselectable ? 'on' : '';\n    el.setAttribute('unselectable', value);\n    if (descendants) {\n      for (var i = 0, descendant; descendant = descendants[i]; i++) {\n        descendant.setAttribute('unselectable', value);\n      }\n    }\n  }\n};\n\n\n/**\n * Gets the border box size for an element.\n * @param {Element} element  The element to get the size for.\n * @return {!goog.math.Size} The border box size.\n */\ngoog.style.getBorderBoxSize = function(element) {\n  return new goog.math.Size(\n      /** @type {!HTMLElement} */ (element).offsetWidth,\n      /** @type {!HTMLElement} */ (element).offsetHeight);\n};\n\n\n/**\n * Sets the border box size of an element. This is potentially expensive in IE\n * if the document is CSS1Compat mode\n * @param {Element} element  The element to set the size on.\n * @param {goog.math.Size} size  The new size.\n */\ngoog.style.setBorderBoxSize = function(element, size) {\n  var doc = goog.dom.getOwnerDocument(element);\n  var isCss1CompatMode = goog.dom.getDomHelper(doc).isCss1CompatMode();\n\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('10') &&\n      (!isCss1CompatMode || !goog.userAgent.isVersionOrHigher('8'))) {\n    var style = element.style;\n    if (isCss1CompatMode) {\n      var paddingBox = goog.style.getPaddingBox(element);\n      var borderBox = goog.style.getBorderBox(element);\n      style.pixelWidth = size.width - borderBox.left - paddingBox.left -\n          paddingBox.right - borderBox.right;\n      style.pixelHeight = size.height - borderBox.top - paddingBox.top -\n          paddingBox.bottom - borderBox.bottom;\n    } else {\n      style.pixelWidth = size.width;\n      style.pixelHeight = size.height;\n    }\n  } else {\n    goog.style.setBoxSizingSize_(element, size, 'border-box');\n  }\n};\n\n\n/**\n * Gets the content box size for an element.  This is potentially expensive in\n * all browsers.\n * @param {Element} element  The element to get the size for.\n * @return {!goog.math.Size} The content box size.\n */\ngoog.style.getContentBoxSize = function(element) {\n  var doc = goog.dom.getOwnerDocument(element);\n  var ieCurrentStyle = goog.userAgent.IE && element.currentStyle;\n  if (ieCurrentStyle && goog.dom.getDomHelper(doc).isCss1CompatMode() &&\n      ieCurrentStyle.width != 'auto' && ieCurrentStyle.height != 'auto' &&\n      !ieCurrentStyle.boxSizing) {\n    // If IE in CSS1Compat mode than just use the width and height.\n    // If we have a boxSizing then fall back on measuring the borders etc.\n    var width = goog.style.getIePixelValue_(\n        element, ieCurrentStyle.width, 'width', 'pixelWidth');\n    var height = goog.style.getIePixelValue_(\n        element, ieCurrentStyle.height, 'height', 'pixelHeight');\n    return new goog.math.Size(width, height);\n  } else {\n    var borderBoxSize = goog.style.getBorderBoxSize(element);\n    var paddingBox = goog.style.getPaddingBox(element);\n    var borderBox = goog.style.getBorderBox(element);\n    return new goog.math.Size(\n        borderBoxSize.width - borderBox.left - paddingBox.left -\n            paddingBox.right - borderBox.right,\n        borderBoxSize.height - borderBox.top - paddingBox.top -\n            paddingBox.bottom - borderBox.bottom);\n  }\n};\n\n\n/**\n * Sets the content box size of an element. This is potentially expensive in IE\n * if the document is BackCompat mode.\n * @param {Element} element  The element to set the size on.\n * @param {goog.math.Size} size  The new size.\n */\ngoog.style.setContentBoxSize = function(element, size) {\n  var doc = goog.dom.getOwnerDocument(element);\n  var isCss1CompatMode = goog.dom.getDomHelper(doc).isCss1CompatMode();\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('10') &&\n      (!isCss1CompatMode || !goog.userAgent.isVersionOrHigher('8'))) {\n    var style = element.style;\n    if (isCss1CompatMode) {\n      style.pixelWidth = size.width;\n      style.pixelHeight = size.height;\n    } else {\n      var paddingBox = goog.style.getPaddingBox(element);\n      var borderBox = goog.style.getBorderBox(element);\n      style.pixelWidth = size.width + borderBox.left + paddingBox.left +\n          paddingBox.right + borderBox.right;\n      style.pixelHeight = size.height + borderBox.top + paddingBox.top +\n          paddingBox.bottom + borderBox.bottom;\n    }\n  } else {\n    goog.style.setBoxSizingSize_(element, size, 'content-box');\n  }\n};\n\n\n/**\n * Helper function that sets the box sizing as well as the width and height\n * @param {Element} element  The element to set the size on.\n * @param {goog.math.Size} size  The new size to set.\n * @param {string} boxSizing  The box-sizing value.\n * @private\n */\ngoog.style.setBoxSizingSize_ = function(element, size, boxSizing) {\n  var style = element.style;\n  if (goog.userAgent.GECKO) {\n    style.MozBoxSizing = boxSizing;\n  } else if (goog.userAgent.WEBKIT) {\n    style.WebkitBoxSizing = boxSizing;\n  } else {\n    // Includes IE8 and Opera 9.50+\n    style.boxSizing = boxSizing;\n  }\n\n  // Setting this to a negative value will throw an exception on IE\n  // (and doesn't do anything different than setting it to 0).\n  style.width = Math.max(size.width, 0) + 'px';\n  style.height = Math.max(size.height, 0) + 'px';\n};\n\n\n/**\n * IE specific function that converts a non pixel unit to pixels.\n * @param {Element} element  The element to convert the value for.\n * @param {string} value  The current value as a string. The value must not be\n *     ''.\n * @param {string} name  The CSS property name to use for the converstion. This\n *     should be 'left', 'top', 'width' or 'height'.\n * @param {string} pixelName  The CSS pixel property name to use to get the\n *     value in pixels.\n * @return {number} The value in pixels.\n * @private\n */\ngoog.style.getIePixelValue_ = function(element, value, name, pixelName) {\n  // Try if we already have a pixel value. IE does not do half pixels so we\n  // only check if it matches a number followed by 'px'.\n  if (/^\\d+px?$/.test(value)) {\n    return parseInt(value, 10);\n  } else {\n    var oldStyleValue = element.style[name];\n    var oldRuntimeValue = element.runtimeStyle[name];\n    // set runtime style to prevent changes\n    element.runtimeStyle[name] = element.currentStyle[name];\n    element.style[name] = value;\n    var pixelValue = element.style[pixelName];\n    // restore\n    element.style[name] = oldStyleValue;\n    element.runtimeStyle[name] = oldRuntimeValue;\n    return +pixelValue;\n  }\n};\n\n\n/**\n * Helper function for getting the pixel padding or margin for IE.\n * @param {Element} element  The element to get the padding for.\n * @param {string} propName  The property name.\n * @return {number} The pixel padding.\n * @private\n */\ngoog.style.getIePixelDistance_ = function(element, propName) {\n  var value = goog.style.getCascadedStyle(element, propName);\n  return value ?\n      goog.style.getIePixelValue_(element, value, 'left', 'pixelLeft') :\n      0;\n};\n\n\n/**\n * Gets the computed paddings or margins (on all sides) in pixels.\n * @param {Element} element  The element to get the padding for.\n * @param {string} stylePrefix  Pass 'padding' to retrieve the padding box,\n *     or 'margin' to retrieve the margin box.\n * @return {!goog.math.Box} The computed paddings or margins.\n * @private\n */\ngoog.style.getBox_ = function(element, stylePrefix) {\n  if (goog.userAgent.IE) {\n    var left = goog.style.getIePixelDistance_(element, stylePrefix + 'Left');\n    var right = goog.style.getIePixelDistance_(element, stylePrefix + 'Right');\n    var top = goog.style.getIePixelDistance_(element, stylePrefix + 'Top');\n    var bottom =\n        goog.style.getIePixelDistance_(element, stylePrefix + 'Bottom');\n    return new goog.math.Box(top, right, bottom, left);\n  } else {\n    // On non-IE browsers, getComputedStyle is always non-null.\n    var left = goog.style.getComputedStyle(element, stylePrefix + 'Left');\n    var right = goog.style.getComputedStyle(element, stylePrefix + 'Right');\n    var top = goog.style.getComputedStyle(element, stylePrefix + 'Top');\n    var bottom = goog.style.getComputedStyle(element, stylePrefix + 'Bottom');\n\n    // NOTE(arv): Gecko can return floating point numbers for the computed\n    // style values.\n    return new goog.math.Box(\n        parseFloat(top), parseFloat(right), parseFloat(bottom),\n        parseFloat(left));\n  }\n};\n\n\n/**\n * Gets the computed paddings (on all sides) in pixels.\n * @param {Element} element  The element to get the padding for.\n * @return {!goog.math.Box} The computed paddings.\n */\ngoog.style.getPaddingBox = function(element) {\n  return goog.style.getBox_(element, 'padding');\n};\n\n\n/**\n * Gets the computed margins (on all sides) in pixels.\n * @param {Element} element  The element to get the margins for.\n * @return {!goog.math.Box} The computed margins.\n */\ngoog.style.getMarginBox = function(element) {\n  return goog.style.getBox_(element, 'margin');\n};\n\n\n/**\n * A map used to map the border width keywords to a pixel width.\n * @type {!Object}\n * @private\n */\ngoog.style.ieBorderWidthKeywords_ = {\n  'thin': 2,\n  'medium': 4,\n  'thick': 6\n};\n\n\n/**\n * Helper function for IE to get the pixel border.\n * @param {Element} element  The element to get the pixel border for.\n * @param {string} prop  The part of the property name.\n * @return {number} The value in pixels.\n * @private\n */\ngoog.style.getIePixelBorder_ = function(element, prop) {\n  if (goog.style.getCascadedStyle(element, prop + 'Style') == 'none') {\n    return 0;\n  }\n  var width = goog.style.getCascadedStyle(element, prop + 'Width');\n  if (width in goog.style.ieBorderWidthKeywords_) {\n    return goog.style.ieBorderWidthKeywords_[width];\n  }\n  return goog.style.getIePixelValue_(element, width, 'left', 'pixelLeft');\n};\n\n\n/**\n * Gets the computed border widths (on all sides) in pixels\n * @param {Element} element  The element to get the border widths for.\n * @return {!goog.math.Box} The computed border widths.\n */\ngoog.style.getBorderBox = function(element) {\n  if (goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(9)) {\n    var left = goog.style.getIePixelBorder_(element, 'borderLeft');\n    var right = goog.style.getIePixelBorder_(element, 'borderRight');\n    var top = goog.style.getIePixelBorder_(element, 'borderTop');\n    var bottom = goog.style.getIePixelBorder_(element, 'borderBottom');\n    return new goog.math.Box(top, right, bottom, left);\n  } else {\n    // On non-IE browsers, getComputedStyle is always non-null.\n    var left = goog.style.getComputedStyle(element, 'borderLeftWidth');\n    var right = goog.style.getComputedStyle(element, 'borderRightWidth');\n    var top = goog.style.getComputedStyle(element, 'borderTopWidth');\n    var bottom = goog.style.getComputedStyle(element, 'borderBottomWidth');\n\n    return new goog.math.Box(\n        parseFloat(top), parseFloat(right), parseFloat(bottom),\n        parseFloat(left));\n  }\n};\n\n\n/**\n * Returns the font face applied to a given node. Opera and IE should return\n * the font actually displayed. Firefox returns the author's most-preferred\n * font (whether the browser is capable of displaying it or not.)\n * @param {Element} el  The element whose font family is returned.\n * @return {string} The font family applied to el.\n */\ngoog.style.getFontFamily = function(el) {\n  var doc = goog.dom.getOwnerDocument(el);\n  var font = '';\n  // The moveToElementText method from the TextRange only works if the element\n  // is attached to the owner document.\n  if (doc.body.createTextRange && goog.dom.contains(doc, el)) {\n    var range = doc.body.createTextRange();\n    range.moveToElementText(el);\n    /** @preserveTry */\n    try {\n      font = range.queryCommandValue('FontName');\n    } catch (e) {\n      // This is a workaround for a awkward exception.\n      // On some IE, there is an exception coming from it.\n      // The error description from this exception is:\n      // This window has already been registered as a drop target\n      // This is bogus description, likely due to a bug in ie.\n      font = '';\n    }\n  }\n  if (!font) {\n    // Note if for some reason IE can't derive FontName with a TextRange, we\n    // fallback to using currentStyle\n    font = goog.style.getStyle_(el, 'fontFamily');\n  }\n\n  // Firefox returns the applied font-family string (author's list of\n  // preferred fonts.) We want to return the most-preferred font, in lieu of\n  // the *actually* applied font.\n  var fontsArray = font.split(',');\n  if (fontsArray.length > 1) font = fontsArray[0];\n\n  // Sanitize for x-browser consistency:\n  // Strip quotes because browsers aren't consistent with how they're\n  // applied; Opera always encloses, Firefox sometimes, and IE never.\n  return goog.string.stripQuotes(font, '\"\\'');\n};\n\n\n/**\n * Regular expression used for getLengthUnits.\n * @type {RegExp}\n * @private\n */\ngoog.style.lengthUnitRegex_ = /[^\\d]+$/;\n\n\n/**\n * Returns the units used for a CSS length measurement.\n * @param {string} value  A CSS length quantity.\n * @return {?string} The units of measurement.\n */\ngoog.style.getLengthUnits = function(value) {\n  var units = value.match(goog.style.lengthUnitRegex_);\n  return units && units[0] || null;\n};\n\n\n/**\n * Map of absolute CSS length units\n * @type {!Object}\n * @private\n */\ngoog.style.ABSOLUTE_CSS_LENGTH_UNITS_ = {\n  'cm': 1,\n  'in': 1,\n  'mm': 1,\n  'pc': 1,\n  'pt': 1\n};\n\n\n/**\n * Map of relative CSS length units that can be accurately converted to px\n * font-size values using getIePixelValue_. Only units that are defined in\n * relation to a font size are convertible (%, small, etc. are not).\n * @type {!Object}\n * @private\n */\ngoog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_ = {\n  'em': 1,\n  'ex': 1\n};\n\n\n/**\n * Returns the font size, in pixels, of text in an element.\n * @param {Element} el  The element whose font size is returned.\n * @return {number} The font size (in pixels).\n */\ngoog.style.getFontSize = function(el) {\n  var fontSize = goog.style.getStyle_(el, 'fontSize');\n  var sizeUnits = goog.style.getLengthUnits(fontSize);\n  if (fontSize && 'px' == sizeUnits) {\n    // NOTE(user): This could be parseFloat instead, but IE doesn't return\n    // decimal fractions in getStyle_ and Firefox reports the fractions, but\n    // ignores them when rendering. Interestingly enough, when we force the\n    // issue and size something to e.g., 50% of 25px, the browsers round in\n    // opposite directions with Firefox reporting 12px and IE 13px. I punt.\n    return parseInt(fontSize, 10);\n  }\n\n  // In IE, we can convert absolute length units to a px value using\n  // goog.style.getIePixelValue_. Units defined in relation to a font size\n  // (em, ex) are applied relative to the element's parentNode and can also\n  // be converted.\n  if (goog.userAgent.IE) {\n    if (String(sizeUnits) in goog.style.ABSOLUTE_CSS_LENGTH_UNITS_) {\n      return goog.style.getIePixelValue_(el, fontSize, 'left', 'pixelLeft');\n    } else if (\n        el.parentNode && el.parentNode.nodeType == goog.dom.NodeType.ELEMENT &&\n        String(sizeUnits) in goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_) {\n      // Check the parent size - if it is the same it means the relative size\n      // value is inherited and we therefore don't want to count it twice.  If\n      // it is different, this element either has explicit style or has a CSS\n      // rule applying to it.\n      var parentElement = /** @type {!Element} */ (el.parentNode);\n      var parentSize = goog.style.getStyle_(parentElement, 'fontSize');\n      return goog.style.getIePixelValue_(\n          parentElement, fontSize == parentSize ? '1em' : fontSize, 'left',\n          'pixelLeft');\n    }\n  }\n\n  // Sometimes we can't cleanly find the font size (some units relative to a\n  // node's parent's font size are difficult: %, smaller et al), so we create\n  // an invisible, absolutely-positioned span sized to be the height of an 'M'\n  // rendered in its parent's (i.e., our target element's) font size. This is\n  // the definition of CSS's font size attribute.\n  var sizeElement = goog.dom.createDom(goog.dom.TagName.SPAN, {\n    'style': 'visibility:hidden;position:absolute;' +\n        'line-height:0;padding:0;margin:0;border:0;height:1em;'\n  });\n  goog.dom.appendChild(el, sizeElement);\n  fontSize = sizeElement.offsetHeight;\n  goog.dom.removeNode(sizeElement);\n\n  return fontSize;\n};\n\n\n/**\n * Parses a style attribute value.  Converts CSS property names to camel case.\n * @param {string} value The style attribute value.\n * @return {!Object} Map of CSS properties to string values.\n */\ngoog.style.parseStyleAttribute = function(value) {\n  var result = {};\n  goog.array.forEach(value.split(/\\s*;\\s*/), function(pair) {\n    var keyValue = pair.match(/\\s*([\\w-]+)\\s*\\:(.+)/);\n    if (keyValue) {\n      var styleName = keyValue[1];\n      var styleValue = goog.string.trim(keyValue[2]);\n      result[goog.string.toCamelCase(styleName.toLowerCase())] = styleValue;\n    }\n  });\n  return result;\n};\n\n\n/**\n * Reverse of parseStyleAttribute; that is, takes a style object and returns the\n * corresponding attribute value.  Converts camel case property names to proper\n * CSS selector names.\n * @param {Object} obj Map of CSS properties to values.\n * @return {string} The style attribute value.\n */\ngoog.style.toStyleAttribute = function(obj) {\n  var buffer = [];\n  goog.object.forEach(obj, function(value, key) {\n    buffer.push(goog.string.toSelectorCase(key), ':', value, ';');\n  });\n  return buffer.join('');\n};\n\n\n/**\n * Sets CSS float property on an element.\n * @param {Element} el The element to set float property on.\n * @param {string} value The value of float CSS property to set on this element.\n */\ngoog.style.setFloat = function(el, value) {\n  el.style[goog.userAgent.IE ? 'styleFloat' : 'cssFloat'] = value;\n};\n\n\n/**\n * Gets value of explicitly-set float CSS property on an element.\n * @param {Element} el The element to get float property of.\n * @return {string} The value of explicitly-set float CSS property on this\n *     element.\n */\ngoog.style.getFloat = function(el) {\n  return el.style[goog.userAgent.IE ? 'styleFloat' : 'cssFloat'] || '';\n};\n\n\n/**\n * Returns the scroll bar width (represents the width of both horizontal\n * and vertical scroll).\n *\n * @param {string=} opt_className An optional class name (or names) to apply\n *     to the invisible div created to measure the scrollbar. This is necessary\n *     if some scrollbars are styled differently than others.\n * @return {number} The scroll bar width in px.\n */\ngoog.style.getScrollbarWidth = function(opt_className) {\n  // Add two hidden divs.  The child div is larger than the parent and\n  // forces scrollbars to appear on it.\n  // Using overflow:scroll does not work consistently with scrollbars that\n  // are styled with ::-webkit-scrollbar.\n  var outerDiv = goog.dom.createElement(goog.dom.TagName.DIV);\n  if (opt_className) {\n    outerDiv.className = opt_className;\n  }\n  outerDiv.style.cssText = 'overflow:auto;' +\n      'position:absolute;top:0;width:100px;height:100px';\n  var innerDiv = goog.dom.createElement(goog.dom.TagName.DIV);\n  goog.style.setSize(innerDiv, '200px', '200px');\n  outerDiv.appendChild(innerDiv);\n  goog.dom.appendChild(goog.dom.getDocument().body, outerDiv);\n  var width = outerDiv.offsetWidth - outerDiv.clientWidth;\n  goog.dom.removeNode(outerDiv);\n  return width;\n};\n\n\n/**\n * Regular expression to extract x and y translation components from a CSS\n * transform Matrix representation.\n *\n * @type {!RegExp}\n * @const\n * @private\n */\ngoog.style.MATRIX_TRANSLATION_REGEX_ = new RegExp(\n    'matrix\\\\([0-9\\\\.\\\\-]+, [0-9\\\\.\\\\-]+, ' +\n    '[0-9\\\\.\\\\-]+, [0-9\\\\.\\\\-]+, ' +\n    '([0-9\\\\.\\\\-]+)p?x?, ([0-9\\\\.\\\\-]+)p?x?\\\\)');\n\n\n/**\n * Returns the x,y translation component of any CSS transforms applied to the\n * element, in pixels.\n *\n * @param {!Element} element The element to get the translation of.\n * @return {!goog.math.Coordinate} The CSS translation of the element in px.\n */\ngoog.style.getCssTranslation = function(element) {\n  var transform = goog.style.getComputedTransform(element);\n  if (!transform) {\n    return new goog.math.Coordinate(0, 0);\n  }\n  var matches = transform.match(goog.style.MATRIX_TRANSLATION_REGEX_);\n  if (!matches) {\n    return new goog.math.Coordinate(0, 0);\n  }\n  return new goog.math.Coordinate(\n      parseFloat(matches[1]), parseFloat(matches[2]));\n};\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Class to create objects which want to handle multiple events\n * and have their listeners easily cleaned up via a dispose method.\n *\n * Example:\n * <pre>\n * function Something() {\n *   Something.base(this);\n *\n *   ... set up object ...\n *\n *   // Add event listeners\n *   this.listen(this.starEl, goog.events.EventType.CLICK, this.handleStar);\n *   this.listen(this.headerEl, goog.events.EventType.CLICK, this.expand);\n *   this.listen(this.collapseEl, goog.events.EventType.CLICK, this.collapse);\n *   this.listen(this.infoEl, goog.events.EventType.MOUSEOVER, this.showHover);\n *   this.listen(this.infoEl, goog.events.EventType.MOUSEOUT, this.hideHover);\n * }\n * goog.inherits(Something, goog.events.EventHandler);\n *\n * Something.prototype.disposeInternal = function() {\n *   Something.base(this, 'disposeInternal');\n *   goog.dom.removeNode(this.container);\n * };\n *\n *\n * // Then elsewhere:\n *\n * var activeSomething = null;\n * function openSomething() {\n *   activeSomething = new Something();\n * }\n *\n * function closeSomething() {\n *   if (activeSomething) {\n *     activeSomething.dispose();  // Remove event listeners\n *     activeSomething = null;\n *   }\n * }\n * </pre>\n *\n */\n\ngoog.provide('goog.events.EventHandler');\n\ngoog.require('goog.Disposable');\ngoog.require('goog.events');\ngoog.require('goog.object');\n\ngoog.forwardDeclare('goog.events.EventWrapper');\n\n\n\n/**\n * Super class for objects that want to easily manage a number of event\n * listeners.  It allows a short cut to listen and also provides a quick way\n * to remove all events listeners belonging to this object.\n * @param {SCOPE=} opt_scope Object in whose scope to call the listeners.\n * @constructor\n * @extends {goog.Disposable}\n * @template SCOPE\n */\ngoog.events.EventHandler = function(opt_scope) {\n  goog.Disposable.call(this);\n  // TODO(mknichel): Rename this to this.scope_ and fix the classes in google3\n  // that access this private variable. :(\n  this.handler_ = opt_scope;\n\n  /**\n   * Keys for events that are being listened to.\n   * @type {!Object<!goog.events.Key>}\n   * @private\n   */\n  this.keys_ = {};\n};\ngoog.inherits(goog.events.EventHandler, goog.Disposable);\n\n\n/**\n * Utility array used to unify the cases of listening for an array of types\n * and listening for a single event, without using recursion or allocating\n * an array each time.\n * @type {!Array<string>}\n * @const\n * @private\n */\ngoog.events.EventHandler.typeArray_ = [];\n\n\n/**\n * Listen to an event on a Listenable.  If the function is omitted then the\n * EventHandler's handleEvent method will be used.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type to listen for or array of event types.\n * @param {function(this:SCOPE, EVENTOBJ):?|{handleEvent:function(?):?}|null=}\n *     opt_fn Optional callback function to be used as the listener or an object\n *     with handleEvent function.\n * @param {boolean=} opt_capture Optional whether to use capture phase.\n * @return {!goog.events.EventHandler<SCOPE>} This object, allowing for\n *     chaining of calls.\n * @template EVENTOBJ\n */\ngoog.events.EventHandler.prototype.listen = function(\n    src, type, opt_fn, opt_capture) {\n  return this.listen_(src, type, opt_fn, opt_capture);\n};\n\n\n/**\n * Listen to an event on a Listenable.  If the function is omitted then the\n * EventHandler's handleEvent method will be used.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type to listen for or array of event types.\n * @param {function(this:T, EVENTOBJ):?|{handleEvent:function(this:T, ?):?}|\n *     null|undefined} fn Optional callback function to be used as the\n *     listener or an object with handleEvent function.\n * @param {boolean|undefined} capture Optional whether to use capture phase.\n * @param {T} scope Object in whose scope to call the listener.\n * @return {!goog.events.EventHandler<SCOPE>} This object, allowing for\n *     chaining of calls.\n * @template T,EVENTOBJ\n */\ngoog.events.EventHandler.prototype.listenWithScope = function(\n    src, type, fn, capture, scope) {\n  // TODO(mknichel): Deprecate this function.\n  return this.listen_(src, type, fn, capture, scope);\n};\n\n\n/**\n * Listen to an event on a Listenable.  If the function is omitted then the\n * EventHandler's handleEvent method will be used.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type to listen for or array of event types.\n * @param {function(EVENTOBJ):?|{handleEvent:function(?):?}|null=} opt_fn\n *     Optional callback function to be used as the listener or an object with\n *     handleEvent function.\n * @param {boolean=} opt_capture Optional whether to use capture phase.\n * @param {Object=} opt_scope Object in whose scope to call the listener.\n * @return {!goog.events.EventHandler<SCOPE>} This object, allowing for\n *     chaining of calls.\n * @template EVENTOBJ\n * @private\n */\ngoog.events.EventHandler.prototype.listen_ = function(\n    src, type, opt_fn, opt_capture, opt_scope) {\n  if (!goog.isArray(type)) {\n    if (type) {\n      goog.events.EventHandler.typeArray_[0] = type.toString();\n    }\n    type = goog.events.EventHandler.typeArray_;\n  }\n  for (var i = 0; i < type.length; i++) {\n    var listenerObj = goog.events.listen(\n        src, type[i], opt_fn || this.handleEvent, opt_capture || false,\n        opt_scope || this.handler_ || this);\n\n    if (!listenerObj) {\n      // When goog.events.listen run on OFF_AND_FAIL or OFF_AND_SILENT\n      // (goog.events.CaptureSimulationMode) in IE8-, it will return null\n      // value.\n      return this;\n    }\n\n    var key = listenerObj.key;\n    this.keys_[key] = listenerObj;\n  }\n\n  return this;\n};\n\n\n/**\n * Listen to an event on a Listenable.  If the function is omitted, then the\n * EventHandler's handleEvent method will be used. After the event has fired the\n * event listener is removed from the target. If an array of event types is\n * provided, each event type will be listened to once.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type to listen for or array of event types.\n * @param {function(this:SCOPE, EVENTOBJ):?|{handleEvent:function(?):?}|null=}\n * opt_fn\n *    Optional callback function to be used as the listener or an object with\n *    handleEvent function.\n * @param {boolean=} opt_capture Optional whether to use capture phase.\n * @return {!goog.events.EventHandler<SCOPE>} This object, allowing for\n *     chaining of calls.\n * @template EVENTOBJ\n */\ngoog.events.EventHandler.prototype.listenOnce = function(\n    src, type, opt_fn, opt_capture) {\n  return this.listenOnce_(src, type, opt_fn, opt_capture);\n};\n\n\n/**\n * Listen to an event on a Listenable.  If the function is omitted, then the\n * EventHandler's handleEvent method will be used. After the event has fired the\n * event listener is removed from the target. If an array of event types is\n * provided, each event type will be listened to once.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type to listen for or array of event types.\n * @param {function(this:T, EVENTOBJ):?|{handleEvent:function(this:T, ?):?}|\n *     null|undefined} fn Optional callback function to be used as the\n *     listener or an object with handleEvent function.\n * @param {boolean|undefined} capture Optional whether to use capture phase.\n * @param {T} scope Object in whose scope to call the listener.\n * @return {!goog.events.EventHandler<SCOPE>} This object, allowing for\n *     chaining of calls.\n * @template T,EVENTOBJ\n */\ngoog.events.EventHandler.prototype.listenOnceWithScope = function(\n    src, type, fn, capture, scope) {\n  // TODO(mknichel): Deprecate this function.\n  return this.listenOnce_(src, type, fn, capture, scope);\n};\n\n\n/**\n * Listen to an event on a Listenable.  If the function is omitted, then the\n * EventHandler's handleEvent method will be used. After the event has fired\n * the event listener is removed from the target. If an array of event types is\n * provided, each event type will be listened to once.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type to listen for or array of event types.\n * @param {function(EVENTOBJ):?|{handleEvent:function(?):?}|null=} opt_fn\n *    Optional callback function to be used as the listener or an object with\n *    handleEvent function.\n * @param {boolean=} opt_capture Optional whether to use capture phase.\n * @param {Object=} opt_scope Object in whose scope to call the listener.\n * @return {!goog.events.EventHandler<SCOPE>} This object, allowing for\n *     chaining of calls.\n * @template EVENTOBJ\n * @private\n */\ngoog.events.EventHandler.prototype.listenOnce_ = function(\n    src, type, opt_fn, opt_capture, opt_scope) {\n  if (goog.isArray(type)) {\n    for (var i = 0; i < type.length; i++) {\n      this.listenOnce_(src, type[i], opt_fn, opt_capture, opt_scope);\n    }\n  } else {\n    var listenerObj = goog.events.listenOnce(\n        src, type, opt_fn || this.handleEvent, opt_capture,\n        opt_scope || this.handler_ || this);\n    if (!listenerObj) {\n      // When goog.events.listen run on OFF_AND_FAIL or OFF_AND_SILENT\n      // (goog.events.CaptureSimulationMode) in IE8-, it will return null\n      // value.\n      return this;\n    }\n\n    var key = listenerObj.key;\n    this.keys_[key] = listenerObj;\n  }\n\n  return this;\n};\n\n\n/**\n * Adds an event listener with a specific event wrapper on a DOM Node or an\n * object that has implemented {@link goog.events.EventTarget}. A listener can\n * only be added once to an object.\n *\n * @param {EventTarget|goog.events.EventTarget} src The node to listen to\n *     events on.\n * @param {goog.events.EventWrapper} wrapper Event wrapper to use.\n * @param {function(this:SCOPE, ?):?|{handleEvent:function(?):?}|null} listener\n *     Callback method, or an object with a handleEvent function.\n * @param {boolean=} opt_capt Whether to fire in capture phase (defaults to\n *     false).\n * @return {!goog.events.EventHandler<SCOPE>} This object, allowing for\n *     chaining of calls.\n */\ngoog.events.EventHandler.prototype.listenWithWrapper = function(\n    src, wrapper, listener, opt_capt) {\n  // TODO(mknichel): Remove the opt_scope from this function and then\n  // templatize it.\n  return this.listenWithWrapper_(src, wrapper, listener, opt_capt);\n};\n\n\n/**\n * Adds an event listener with a specific event wrapper on a DOM Node or an\n * object that has implemented {@link goog.events.EventTarget}. A listener can\n * only be added once to an object.\n *\n * @param {EventTarget|goog.events.EventTarget} src The node to listen to\n *     events on.\n * @param {goog.events.EventWrapper} wrapper Event wrapper to use.\n * @param {function(this:T, ?):?|{handleEvent:function(this:T, ?):?}|null}\n *     listener Optional callback function to be used as the\n *     listener or an object with handleEvent function.\n * @param {boolean|undefined} capture Optional whether to use capture phase.\n * @param {T} scope Object in whose scope to call the listener.\n * @return {!goog.events.EventHandler<SCOPE>} This object, allowing for\n *     chaining of calls.\n * @template T\n */\ngoog.events.EventHandler.prototype.listenWithWrapperAndScope = function(\n    src, wrapper, listener, capture, scope) {\n  // TODO(mknichel): Deprecate this function.\n  return this.listenWithWrapper_(src, wrapper, listener, capture, scope);\n};\n\n\n/**\n * Adds an event listener with a specific event wrapper on a DOM Node or an\n * object that has implemented {@link goog.events.EventTarget}. A listener can\n * only be added once to an object.\n *\n * @param {EventTarget|goog.events.EventTarget} src The node to listen to\n *     events on.\n * @param {goog.events.EventWrapper} wrapper Event wrapper to use.\n * @param {function(?):?|{handleEvent:function(?):?}|null} listener Callback\n *     method, or an object with a handleEvent function.\n * @param {boolean=} opt_capt Whether to fire in capture phase (defaults to\n *     false).\n * @param {Object=} opt_scope Element in whose scope to call the listener.\n * @return {!goog.events.EventHandler<SCOPE>} This object, allowing for\n *     chaining of calls.\n * @private\n */\ngoog.events.EventHandler.prototype.listenWithWrapper_ = function(\n    src, wrapper, listener, opt_capt, opt_scope) {\n  wrapper.listen(\n      src, listener, opt_capt, opt_scope || this.handler_ || this, this);\n  return this;\n};\n\n\n/**\n * @return {number} Number of listeners registered by this handler.\n */\ngoog.events.EventHandler.prototype.getListenerCount = function() {\n  var count = 0;\n  for (var key in this.keys_) {\n    if (Object.prototype.hasOwnProperty.call(this.keys_, key)) {\n      count++;\n    }\n  }\n  return count;\n};\n\n\n/**\n * Unlistens on an event.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type or array of event types to unlisten to.\n * @param {function(EVENTOBJ):?|{handleEvent:function(?):?}|null=} opt_fn\n *     Optional callback function to be used as the listener or an object with\n *     handleEvent function.\n * @param {boolean=} opt_capture Optional whether to use capture phase.\n * @param {Object=} opt_scope Object in whose scope to call the listener.\n * @return {!goog.events.EventHandler} This object, allowing for chaining of\n *     calls.\n * @template EVENTOBJ\n */\ngoog.events.EventHandler.prototype.unlisten = function(\n    src, type, opt_fn, opt_capture, opt_scope) {\n  if (goog.isArray(type)) {\n    for (var i = 0; i < type.length; i++) {\n      this.unlisten(src, type[i], opt_fn, opt_capture, opt_scope);\n    }\n  } else {\n    var listener = goog.events.getListener(\n        src, type, opt_fn || this.handleEvent, opt_capture,\n        opt_scope || this.handler_ || this);\n\n    if (listener) {\n      goog.events.unlistenByKey(listener);\n      delete this.keys_[listener.key];\n    }\n  }\n\n  return this;\n};\n\n\n/**\n * Removes an event listener which was added with listenWithWrapper().\n *\n * @param {EventTarget|goog.events.EventTarget} src The target to stop\n *     listening to events on.\n * @param {goog.events.EventWrapper} wrapper Event wrapper to use.\n * @param {function(?):?|{handleEvent:function(?):?}|null} listener The\n *     listener function to remove.\n * @param {boolean=} opt_capt In DOM-compliant browsers, this determines\n *     whether the listener is fired during the capture or bubble phase of the\n *     event.\n * @param {Object=} opt_scope Element in whose scope to call the listener.\n * @return {!goog.events.EventHandler} This object, allowing for chaining of\n *     calls.\n */\ngoog.events.EventHandler.prototype.unlistenWithWrapper = function(\n    src, wrapper, listener, opt_capt, opt_scope) {\n  wrapper.unlisten(\n      src, listener, opt_capt, opt_scope || this.handler_ || this, this);\n  return this;\n};\n\n\n/**\n * Unlistens to all events.\n */\ngoog.events.EventHandler.prototype.removeAll = function() {\n  goog.object.forEach(this.keys_, function(listenerObj, key) {\n    if (this.keys_.hasOwnProperty(key)) {\n      goog.events.unlistenByKey(listenerObj);\n    }\n  }, this);\n\n  this.keys_ = {};\n};\n\n\n/**\n * Disposes of this EventHandler and removes all listeners that it registered.\n * @override\n * @protected\n */\ngoog.events.EventHandler.prototype.disposeInternal = function() {\n  goog.events.EventHandler.superClass_.disposeInternal.call(this);\n  this.removeAll();\n};\n\n\n/**\n * Default event handler\n * @param {goog.events.Event} e Event object.\n */\ngoog.events.EventHandler.prototype.handleEvent = function(e) {\n  throw Error('EventHandler.handleEvent not implemented');\n};\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A disposable implementation of a custom\n * listenable/event target. See also: documentation for\n * {@code goog.events.Listenable}.\n *\n * @author arv@google.com (Erik Arvidsson) [Original implementation]\n * @see ../demos/eventtarget.html\n * @see goog.events.Listenable\n */\n\ngoog.provide('goog.events.EventTarget');\n\ngoog.require('goog.Disposable');\ngoog.require('goog.asserts');\ngoog.require('goog.events');\ngoog.require('goog.events.Event');\ngoog.require('goog.events.Listenable');\ngoog.require('goog.events.ListenerMap');\ngoog.require('goog.object');\n\n\n\n/**\n * An implementation of {@code goog.events.Listenable} with full W3C\n * EventTarget-like support (capture/bubble mechanism, stopping event\n * propagation, preventing default actions).\n *\n * You may subclass this class to turn your class into a Listenable.\n *\n * Unless propagation is stopped, an event dispatched by an\n * EventTarget will bubble to the parent returned by\n * {@code getParentEventTarget}. To set the parent, call\n * {@code setParentEventTarget}. Subclasses that don't support\n * changing the parent can override the setter to throw an error.\n *\n * Example usage:\n * <pre>\n *   var source = new goog.events.EventTarget();\n *   function handleEvent(e) {\n *     alert('Type: ' + e.type + '; Target: ' + e.target);\n *   }\n *   source.listen('foo', handleEvent);\n *   // Or: goog.events.listen(source, 'foo', handleEvent);\n *   ...\n *   source.dispatchEvent('foo');  // will call handleEvent\n *   ...\n *   source.unlisten('foo', handleEvent);\n *   // Or: goog.events.unlisten(source, 'foo', handleEvent);\n * </pre>\n *\n * @constructor\n * @extends {goog.Disposable}\n * @implements {goog.events.Listenable}\n */\ngoog.events.EventTarget = function() {\n  goog.Disposable.call(this);\n\n  /**\n   * Maps of event type to an array of listeners.\n   * @private {!goog.events.ListenerMap}\n   */\n  this.eventTargetListeners_ = new goog.events.ListenerMap(this);\n\n  /**\n   * The object to use for event.target. Useful when mixing in an\n   * EventTarget to another object.\n   * @private {!Object}\n   */\n  this.actualEventTarget_ = this;\n\n  /**\n   * Parent event target, used during event bubbling.\n   *\n   * TODO(chrishenry): Change this to goog.events.Listenable. This\n   * currently breaks people who expect getParentEventTarget to return\n   * goog.events.EventTarget.\n   *\n   * @private {goog.events.EventTarget}\n   */\n  this.parentEventTarget_ = null;\n};\ngoog.inherits(goog.events.EventTarget, goog.Disposable);\ngoog.events.Listenable.addImplementation(goog.events.EventTarget);\n\n\n/**\n * An artificial cap on the number of ancestors you can have. This is mainly\n * for loop detection.\n * @const {number}\n * @private\n */\ngoog.events.EventTarget.MAX_ANCESTORS_ = 1000;\n\n\n/**\n * Returns the parent of this event target to use for bubbling.\n *\n * @return {goog.events.EventTarget} The parent EventTarget or null if\n *     there is no parent.\n * @override\n */\ngoog.events.EventTarget.prototype.getParentEventTarget = function() {\n  return this.parentEventTarget_;\n};\n\n\n/**\n * Sets the parent of this event target to use for capture/bubble\n * mechanism.\n * @param {goog.events.EventTarget} parent Parent listenable (null if none).\n */\ngoog.events.EventTarget.prototype.setParentEventTarget = function(parent) {\n  this.parentEventTarget_ = parent;\n};\n\n\n/**\n * Adds an event listener to the event target. The same handler can only be\n * added once per the type. Even if you add the same handler multiple times\n * using the same type then it will only be called once when the event is\n * dispatched.\n *\n * @param {string} type The type of the event to listen for.\n * @param {function(?):?|{handleEvent:function(?):?}|null} handler The function\n *     to handle the event. The handler can also be an object that implements\n *     the handleEvent method which takes the event object as argument.\n * @param {boolean=} opt_capture In DOM-compliant browsers, this determines\n *     whether the listener is fired during the capture or bubble phase\n *     of the event.\n * @param {Object=} opt_handlerScope Object in whose scope to call\n *     the listener.\n * @deprecated Use {@code #listen} instead, when possible. Otherwise, use\n *     {@code goog.events.listen} if you are passing Object\n *     (instead of Function) as handler.\n */\ngoog.events.EventTarget.prototype.addEventListener = function(\n    type, handler, opt_capture, opt_handlerScope) {\n  goog.events.listen(this, type, handler, opt_capture, opt_handlerScope);\n};\n\n\n/**\n * Removes an event listener from the event target. The handler must be the\n * same object as the one added. If the handler has not been added then\n * nothing is done.\n *\n * @param {string} type The type of the event to listen for.\n * @param {function(?):?|{handleEvent:function(?):?}|null} handler The function\n *     to handle the event. The handler can also be an object that implements\n *     the handleEvent method which takes the event object as argument.\n * @param {boolean=} opt_capture In DOM-compliant browsers, this determines\n *     whether the listener is fired during the capture or bubble phase\n *     of the event.\n * @param {Object=} opt_handlerScope Object in whose scope to call\n *     the listener.\n * @deprecated Use {@code #unlisten} instead, when possible. Otherwise, use\n *     {@code goog.events.unlisten} if you are passing Object\n *     (instead of Function) as handler.\n */\ngoog.events.EventTarget.prototype.removeEventListener = function(\n    type, handler, opt_capture, opt_handlerScope) {\n  goog.events.unlisten(this, type, handler, opt_capture, opt_handlerScope);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.dispatchEvent = function(e) {\n  this.assertInitialized_();\n\n  var ancestorsTree, ancestor = this.getParentEventTarget();\n  if (ancestor) {\n    ancestorsTree = [];\n    var ancestorCount = 1;\n    for (; ancestor; ancestor = ancestor.getParentEventTarget()) {\n      ancestorsTree.push(ancestor);\n      goog.asserts.assert(\n          (++ancestorCount < goog.events.EventTarget.MAX_ANCESTORS_),\n          'infinite loop');\n    }\n  }\n\n  return goog.events.EventTarget.dispatchEventInternal_(\n      this.actualEventTarget_, e, ancestorsTree);\n};\n\n\n/**\n * Removes listeners from this object.  Classes that extend EventTarget may\n * need to override this method in order to remove references to DOM Elements\n * and additional listeners.\n * @override\n */\ngoog.events.EventTarget.prototype.disposeInternal = function() {\n  goog.events.EventTarget.superClass_.disposeInternal.call(this);\n\n  this.removeAllListeners();\n  this.parentEventTarget_ = null;\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.listen = function(\n    type, listener, opt_useCapture, opt_listenerScope) {\n  this.assertInitialized_();\n  return this.eventTargetListeners_.add(\n      String(type), listener, false /* callOnce */, opt_useCapture,\n      opt_listenerScope);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.listenOnce = function(\n    type, listener, opt_useCapture, opt_listenerScope) {\n  return this.eventTargetListeners_.add(\n      String(type), listener, true /* callOnce */, opt_useCapture,\n      opt_listenerScope);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.unlisten = function(\n    type, listener, opt_useCapture, opt_listenerScope) {\n  return this.eventTargetListeners_.remove(\n      String(type), listener, opt_useCapture, opt_listenerScope);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.unlistenByKey = function(key) {\n  return this.eventTargetListeners_.removeByKey(key);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.removeAllListeners = function(opt_type) {\n  // TODO(chrishenry): Previously, removeAllListeners can be called on\n  // uninitialized EventTarget, so we preserve that behavior. We\n  // should remove this when usages that rely on that fact are purged.\n  if (!this.eventTargetListeners_) {\n    return 0;\n  }\n  return this.eventTargetListeners_.removeAll(opt_type);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.fireListeners = function(\n    type, capture, eventObject) {\n  // TODO(chrishenry): Original code avoids array creation when there\n  // is no listener, so we do the same. If this optimization turns\n  // out to be not required, we can replace this with\n  // getListeners(type, capture) instead, which is simpler.\n  var listenerArray = this.eventTargetListeners_.listeners[String(type)];\n  if (!listenerArray) {\n    return true;\n  }\n  listenerArray = listenerArray.concat();\n\n  var rv = true;\n  for (var i = 0; i < listenerArray.length; ++i) {\n    var listener = listenerArray[i];\n    // We might not have a listener if the listener was removed.\n    if (listener && !listener.removed && listener.capture == capture) {\n      var listenerFn = listener.listener;\n      var listenerHandler = listener.handler || listener.src;\n\n      if (listener.callOnce) {\n        this.unlistenByKey(listener);\n      }\n      rv = listenerFn.call(listenerHandler, eventObject) !== false && rv;\n    }\n  }\n\n  return rv && eventObject.returnValue_ != false;\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.getListeners = function(type, capture) {\n  return this.eventTargetListeners_.getListeners(String(type), capture);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.getListener = function(\n    type, listener, capture, opt_listenerScope) {\n  return this.eventTargetListeners_.getListener(\n      String(type), listener, capture, opt_listenerScope);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.hasListener = function(\n    opt_type, opt_capture) {\n  var id = goog.isDef(opt_type) ? String(opt_type) : undefined;\n  return this.eventTargetListeners_.hasListener(id, opt_capture);\n};\n\n\n/**\n * Sets the target to be used for {@code event.target} when firing\n * event. Mainly used for testing. For example, see\n * {@code goog.testing.events.mixinListenable}.\n * @param {!Object} target The target.\n */\ngoog.events.EventTarget.prototype.setTargetForTesting = function(target) {\n  this.actualEventTarget_ = target;\n};\n\n\n/**\n * Asserts that the event target instance is initialized properly.\n * @private\n */\ngoog.events.EventTarget.prototype.assertInitialized_ = function() {\n  goog.asserts.assert(\n      this.eventTargetListeners_,\n      'Event target is not initialized. Did you call the superclass ' +\n          '(goog.events.EventTarget) constructor?');\n};\n\n\n/**\n * Dispatches the given event on the ancestorsTree.\n *\n * @param {!Object} target The target to dispatch on.\n * @param {goog.events.Event|Object|string} e The event object.\n * @param {Array<goog.events.Listenable>=} opt_ancestorsTree The ancestors\n *     tree of the target, in reverse order from the closest ancestor\n *     to the root event target. May be null if the target has no ancestor.\n * @return {boolean} If anyone called preventDefault on the event object (or\n *     if any of the listeners returns false) this will also return false.\n * @private\n */\ngoog.events.EventTarget.dispatchEventInternal_ = function(\n    target, e, opt_ancestorsTree) {\n  var type = e.type || /** @type {string} */ (e);\n\n  // If accepting a string or object, create a custom event object so that\n  // preventDefault and stopPropagation work with the event.\n  if (goog.isString(e)) {\n    e = new goog.events.Event(e, target);\n  } else if (!(e instanceof goog.events.Event)) {\n    var oldEvent = e;\n    e = new goog.events.Event(type, target);\n    goog.object.extend(e, oldEvent);\n  } else {\n    e.target = e.target || target;\n  }\n\n  var rv = true, currentTarget;\n\n  // Executes all capture listeners on the ancestors, if any.\n  if (opt_ancestorsTree) {\n    for (var i = opt_ancestorsTree.length - 1; !e.propagationStopped_ && i >= 0;\n         i--) {\n      currentTarget = e.currentTarget = opt_ancestorsTree[i];\n      rv = currentTarget.fireListeners(type, true, e) && rv;\n    }\n  }\n\n  // Executes capture and bubble listeners on the target.\n  if (!e.propagationStopped_) {\n    currentTarget = /** @type {?} */ (e.currentTarget = target);\n    rv = currentTarget.fireListeners(type, true, e) && rv;\n    if (!e.propagationStopped_) {\n      rv = currentTarget.fireListeners(type, false, e) && rv;\n    }\n  }\n\n  // Executes all bubble listeners on the ancestors, if any.\n  if (opt_ancestorsTree) {\n    for (i = 0; !e.propagationStopped_ && i < opt_ancestorsTree.length; i++) {\n      currentTarget = e.currentTarget = opt_ancestorsTree[i];\n      rv = currentTarget.fireListeners(type, false, e) && rv;\n    }\n  }\n\n  return rv;\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Generator for unique element IDs.\n *\n */\n\ngoog.provide('goog.ui.IdGenerator');\n\n\n\n/**\n * Creates a new id generator.\n * @constructor\n * @final\n */\ngoog.ui.IdGenerator = function() {};\ngoog.addSingletonGetter(goog.ui.IdGenerator);\n\n\n/**\n * Next unique ID to use\n * @type {number}\n * @private\n */\ngoog.ui.IdGenerator.prototype.nextId_ = 0;\n\n\n/**\n * Gets the next unique ID.\n * @return {string} The next unique identifier.\n */\ngoog.ui.IdGenerator.prototype.getNextUniqueId = function() {\n  return ':' + (this.nextId_++).toString(36);\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Abstract class for all UI components. This defines the standard\n * design pattern that all UI components should follow.\n *\n * @author attila@google.com (Attila Bodis)\n * @see ../demos/samplecomponent.html\n * @see http://code.google.com/p/closure-library/wiki/IntroToComponents\n */\n\ngoog.provide('goog.ui.Component');\ngoog.provide('goog.ui.Component.Error');\ngoog.provide('goog.ui.Component.EventType');\ngoog.provide('goog.ui.Component.State');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.dom.NodeType');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.events.EventHandler');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.object');\ngoog.require('goog.style');\ngoog.require('goog.ui.IdGenerator');\n\n\n\n/**\n * Default implementation of UI component.\n *\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper.\n * @constructor\n * @extends {goog.events.EventTarget}\n * @suppress {underscore}\n */\ngoog.ui.Component = function(opt_domHelper) {\n  goog.events.EventTarget.call(this);\n  /**\n   * DomHelper used to interact with the document, allowing components to be\n   * created in a different window.\n   * @protected {!goog.dom.DomHelper}\n   * @suppress {underscore|visibility}\n   */\n  this.dom_ = opt_domHelper || goog.dom.getDomHelper();\n\n  /**\n   * Whether the component is rendered right-to-left.  Right-to-left is set\n   * lazily when {@link #isRightToLeft} is called the first time, unless it has\n   * been set by calling {@link #setRightToLeft} explicitly.\n   * @private {?boolean}\n   */\n  this.rightToLeft_ = goog.ui.Component.defaultRightToLeft_;\n\n  /**\n   * Unique ID of the component, lazily initialized in {@link\n   * goog.ui.Component#getId} if needed.  This property is strictly private and\n   * must not be accessed directly outside of this class!\n   * @private {?string}\n   */\n  this.id_ = null;\n\n  /**\n   * Whether the component is in the document.\n   * @private {boolean}\n   */\n  this.inDocument_ = false;\n\n  // TODO(attila): Stop referring to this private field in subclasses.\n  /**\n   * The DOM element for the component.\n   * @private {Element}\n   */\n  this.element_ = null;\n\n  /**\n   * Event handler.\n   * TODO(user): rename it to handler_ after all component subclasses in\n   * inside Google have been cleaned up.\n   * Code search: http://go/component_code_search\n   * @private {goog.events.EventHandler|undefined}\n   */\n  this.googUiComponentHandler_ = void 0;\n\n  /**\n   * Arbitrary data object associated with the component.  Such as meta-data.\n   * @private {*}\n   */\n  this.model_ = null;\n\n  /**\n   * Parent component to which events will be propagated.  This property is\n   * strictly private and must not be accessed directly outside of this class!\n   * @private {goog.ui.Component?}\n   */\n  this.parent_ = null;\n\n  /**\n   * Array of child components.  Lazily initialized on first use.  Must be kept\n   * in sync with {@code childIndex_}.  This property is strictly private and\n   * must not be accessed directly outside of this class!\n   * @private {Array<goog.ui.Component>?}\n   */\n  this.children_ = null;\n\n  /**\n   * Map of child component IDs to child components.  Used for constant-time\n   * random access to child components by ID.  Lazily initialized on first use.\n   * Must be kept in sync with {@code children_}.  This property is strictly\n   * private and must not be accessed directly outside of this class!\n   *\n   * We use a plain Object, not a {@link goog.structs.Map}, for simplicity.\n   * This means components can't have children with IDs such as 'constructor' or\n   * 'valueOf', but this shouldn't really be an issue in practice, and if it is,\n   * we can always fix it later without changing the API.\n   *\n   * @private {Object}\n   */\n  this.childIndex_ = null;\n\n  /**\n   * Flag used to keep track of whether a component decorated an already\n   * existing element or whether it created the DOM itself.\n   *\n   * If an element is decorated, dispose will leave the node in the document.\n   * It is up to the app to remove the node.\n   *\n   * If an element was rendered, dispose will remove the node automatically.\n   *\n   * @private {boolean}\n   */\n  this.wasDecorated_ = false;\n};\ngoog.inherits(goog.ui.Component, goog.events.EventTarget);\n\n\n/**\n * @define {boolean} Whether to support calling decorate with an element that is\n *     not yet in the document. If true, we check if the element is in the\n *     document, and avoid calling enterDocument if it isn't. If false, we\n *     maintain legacy behavior (always call enterDocument from decorate).\n */\ngoog.define('goog.ui.Component.ALLOW_DETACHED_DECORATION', false);\n\n\n/**\n * Generator for unique IDs.\n * @type {goog.ui.IdGenerator}\n * @private\n */\ngoog.ui.Component.prototype.idGenerator_ = goog.ui.IdGenerator.getInstance();\n\n\n// TODO(gboyer): See if we can remove this and just check goog.i18n.bidi.IS_RTL.\n/**\n * @define {number} Defines the default BIDI directionality.\n *     0: Unknown.\n *     1: Left-to-right.\n *     -1: Right-to-left.\n */\ngoog.define('goog.ui.Component.DEFAULT_BIDI_DIR', 0);\n\n\n/**\n * The default right to left value.\n * @type {?boolean}\n * @private\n */\ngoog.ui.Component.defaultRightToLeft_ =\n    (goog.ui.Component.DEFAULT_BIDI_DIR == 1) ?\n    false :\n    (goog.ui.Component.DEFAULT_BIDI_DIR == -1) ? true : null;\n\n\n/**\n * Common events fired by components so that event propagation is useful.  Not\n * all components are expected to dispatch or listen for all event types.\n * Events dispatched before a state transition should be cancelable to prevent\n * the corresponding state change.\n * @enum {string}\n */\ngoog.ui.Component.EventType = {\n  /** Dispatched before the component becomes visible. */\n  BEFORE_SHOW: 'beforeshow',\n\n  /**\n   * Dispatched after the component becomes visible.\n   * NOTE(user): For goog.ui.Container, this actually fires before containers\n   * are shown.  Use goog.ui.Container.EventType.AFTER_SHOW if you want an event\n   * that fires after a goog.ui.Container is shown.\n   */\n  SHOW: 'show',\n\n  /** Dispatched before the component becomes hidden. */\n  HIDE: 'hide',\n\n  /** Dispatched before the component becomes disabled. */\n  DISABLE: 'disable',\n\n  /** Dispatched before the component becomes enabled. */\n  ENABLE: 'enable',\n\n  /** Dispatched before the component becomes highlighted. */\n  HIGHLIGHT: 'highlight',\n\n  /** Dispatched before the component becomes un-highlighted. */\n  UNHIGHLIGHT: 'unhighlight',\n\n  /** Dispatched before the component becomes activated. */\n  ACTIVATE: 'activate',\n\n  /** Dispatched before the component becomes deactivated. */\n  DEACTIVATE: 'deactivate',\n\n  /** Dispatched before the component becomes selected. */\n  SELECT: 'select',\n\n  /** Dispatched before the component becomes un-selected. */\n  UNSELECT: 'unselect',\n\n  /** Dispatched before a component becomes checked. */\n  CHECK: 'check',\n\n  /** Dispatched before a component becomes un-checked. */\n  UNCHECK: 'uncheck',\n\n  /** Dispatched before a component becomes focused. */\n  FOCUS: 'focus',\n\n  /** Dispatched before a component becomes blurred. */\n  BLUR: 'blur',\n\n  /** Dispatched before a component is opened (expanded). */\n  OPEN: 'open',\n\n  /** Dispatched before a component is closed (collapsed). */\n  CLOSE: 'close',\n\n  /** Dispatched after a component is moused over. */\n  ENTER: 'enter',\n\n  /** Dispatched after a component is moused out of. */\n  LEAVE: 'leave',\n\n  /** Dispatched after the user activates the component. */\n  ACTION: 'action',\n\n  /** Dispatched after the external-facing state of a component is changed. */\n  CHANGE: 'change'\n};\n\n\n/**\n * Errors thrown by the component.\n * @enum {string}\n */\ngoog.ui.Component.Error = {\n  /**\n   * Error when a method is not supported.\n   */\n  NOT_SUPPORTED: 'Method not supported',\n\n  /**\n   * Error when the given element can not be decorated.\n   */\n  DECORATE_INVALID: 'Invalid element to decorate',\n\n  /**\n   * Error when the component is already rendered and another render attempt is\n   * made.\n   */\n  ALREADY_RENDERED: 'Component already rendered',\n\n  /**\n   * Error when an attempt is made to set the parent of a component in a way\n   * that would result in an inconsistent object graph.\n   */\n  PARENT_UNABLE_TO_BE_SET: 'Unable to set parent component',\n\n  /**\n   * Error when an attempt is made to add a child component at an out-of-bounds\n   * index.  We don't support sparse child arrays.\n   */\n  CHILD_INDEX_OUT_OF_BOUNDS: 'Child component index out of bounds',\n\n  /**\n   * Error when an attempt is made to remove a child component from a component\n   * other than its parent.\n   */\n  NOT_OUR_CHILD: 'Child is not in parent component',\n\n  /**\n   * Error when an operation requiring DOM interaction is made when the\n   * component is not in the document\n   */\n  NOT_IN_DOCUMENT: 'Operation not supported while component is not in document',\n\n  /**\n   * Error when an invalid component state is encountered.\n   */\n  STATE_INVALID: 'Invalid component state'\n};\n\n\n/**\n * Common component states.  Components may have distinct appearance depending\n * on what state(s) apply to them.  Not all components are expected to support\n * all states.\n * @enum {number}\n */\ngoog.ui.Component.State = {\n  /**\n   * Union of all supported component states.\n   */\n  ALL: 0xFF,\n\n  /**\n   * Component is disabled.\n   * @see goog.ui.Component.EventType.DISABLE\n   * @see goog.ui.Component.EventType.ENABLE\n   */\n  DISABLED: 0x01,\n\n  /**\n   * Component is highlighted.\n   * @see goog.ui.Component.EventType.HIGHLIGHT\n   * @see goog.ui.Component.EventType.UNHIGHLIGHT\n   */\n  HOVER: 0x02,\n\n  /**\n   * Component is active (or \"pressed\").\n   * @see goog.ui.Component.EventType.ACTIVATE\n   * @see goog.ui.Component.EventType.DEACTIVATE\n   */\n  ACTIVE: 0x04,\n\n  /**\n   * Component is selected.\n   * @see goog.ui.Component.EventType.SELECT\n   * @see goog.ui.Component.EventType.UNSELECT\n   */\n  SELECTED: 0x08,\n\n  /**\n   * Component is checked.\n   * @see goog.ui.Component.EventType.CHECK\n   * @see goog.ui.Component.EventType.UNCHECK\n   */\n  CHECKED: 0x10,\n\n  /**\n   * Component has focus.\n   * @see goog.ui.Component.EventType.FOCUS\n   * @see goog.ui.Component.EventType.BLUR\n   */\n  FOCUSED: 0x20,\n\n  /**\n   * Component is opened (expanded).  Applies to tree nodes, menu buttons,\n   * submenus, zippys (zippies?), etc.\n   * @see goog.ui.Component.EventType.OPEN\n   * @see goog.ui.Component.EventType.CLOSE\n   */\n  OPENED: 0x40\n};\n\n\n/**\n * Static helper method; returns the type of event components are expected to\n * dispatch when transitioning to or from the given state.\n * @param {goog.ui.Component.State} state State to/from which the component\n *     is transitioning.\n * @param {boolean} isEntering Whether the component is entering or leaving the\n *     state.\n * @return {goog.ui.Component.EventType} Event type to dispatch.\n */\ngoog.ui.Component.getStateTransitionEvent = function(state, isEntering) {\n  switch (state) {\n    case goog.ui.Component.State.DISABLED:\n      return isEntering ? goog.ui.Component.EventType.DISABLE :\n                          goog.ui.Component.EventType.ENABLE;\n    case goog.ui.Component.State.HOVER:\n      return isEntering ? goog.ui.Component.EventType.HIGHLIGHT :\n                          goog.ui.Component.EventType.UNHIGHLIGHT;\n    case goog.ui.Component.State.ACTIVE:\n      return isEntering ? goog.ui.Component.EventType.ACTIVATE :\n                          goog.ui.Component.EventType.DEACTIVATE;\n    case goog.ui.Component.State.SELECTED:\n      return isEntering ? goog.ui.Component.EventType.SELECT :\n                          goog.ui.Component.EventType.UNSELECT;\n    case goog.ui.Component.State.CHECKED:\n      return isEntering ? goog.ui.Component.EventType.CHECK :\n                          goog.ui.Component.EventType.UNCHECK;\n    case goog.ui.Component.State.FOCUSED:\n      return isEntering ? goog.ui.Component.EventType.FOCUS :\n                          goog.ui.Component.EventType.BLUR;\n    case goog.ui.Component.State.OPENED:\n      return isEntering ? goog.ui.Component.EventType.OPEN :\n                          goog.ui.Component.EventType.CLOSE;\n    default:\n      // Fall through.\n  }\n\n  // Invalid state.\n  throw Error(goog.ui.Component.Error.STATE_INVALID);\n};\n\n\n/**\n * Set the default right-to-left value. This causes all component's created from\n * this point forward to have the given value. This is useful for cases where\n * a given page is always in one directionality, avoiding unnecessary\n * right to left determinations.\n * @param {?boolean} rightToLeft Whether the components should be rendered\n *     right-to-left. Null iff components should determine their directionality.\n */\ngoog.ui.Component.setDefaultRightToLeft = function(rightToLeft) {\n  goog.ui.Component.defaultRightToLeft_ = rightToLeft;\n};\n\n\n/**\n * Gets the unique ID for the instance of this component.  If the instance\n * doesn't already have an ID, generates one on the fly.\n * @return {string} Unique component ID.\n */\ngoog.ui.Component.prototype.getId = function() {\n  return this.id_ || (this.id_ = this.idGenerator_.getNextUniqueId());\n};\n\n\n/**\n * Assigns an ID to this component instance.  It is the caller's responsibility\n * to guarantee that the ID is unique.  If the component is a child of a parent\n * component, then the parent component's child index is updated to reflect the\n * new ID; this may throw an error if the parent already has a child with an ID\n * that conflicts with the new ID.\n * @param {string} id Unique component ID.\n */\ngoog.ui.Component.prototype.setId = function(id) {\n  if (this.parent_ && this.parent_.childIndex_) {\n    // Update the parent's child index.\n    goog.object.remove(this.parent_.childIndex_, this.id_);\n    goog.object.add(this.parent_.childIndex_, id, this);\n  }\n\n  // Update the component ID.\n  this.id_ = id;\n};\n\n\n/**\n * Gets the component's element.\n * @return {Element} The element for the component.\n */\ngoog.ui.Component.prototype.getElement = function() {\n  return this.element_;\n};\n\n\n/**\n * Gets the component's element. This differs from getElement in that\n * it assumes that the element exists (i.e. the component has been\n * rendered/decorated) and will cause an assertion error otherwise (if\n * assertion is enabled).\n * @return {!Element} The element for the component.\n */\ngoog.ui.Component.prototype.getElementStrict = function() {\n  var el = this.element_;\n  goog.asserts.assert(\n      el, 'Can not call getElementStrict before rendering/decorating.');\n  return el;\n};\n\n\n/**\n * Sets the component's root element to the given element.  Considered\n * protected and final.\n *\n * This should generally only be called during createDom. Setting the element\n * does not actually change which element is rendered, only the element that is\n * associated with this UI component.\n *\n * This should only be used by subclasses and its associated renderers.\n *\n * @param {Element} element Root element for the component.\n */\ngoog.ui.Component.prototype.setElementInternal = function(element) {\n  this.element_ = element;\n};\n\n\n/**\n * Returns an array of all the elements in this component's DOM with the\n * provided className.\n * @param {string} className The name of the class to look for.\n * @return {!IArrayLike<!Element>} The items found with the class name provided.\n */\ngoog.ui.Component.prototype.getElementsByClass = function(className) {\n  return this.element_ ?\n      this.dom_.getElementsByClass(className, this.element_) :\n      [];\n};\n\n\n/**\n * Returns the first element in this component's DOM with the provided\n * className.\n * @param {string} className The name of the class to look for.\n * @return {Element} The first item with the class name provided.\n */\ngoog.ui.Component.prototype.getElementByClass = function(className) {\n  return this.element_ ? this.dom_.getElementByClass(className, this.element_) :\n                         null;\n};\n\n\n/**\n * Similar to {@code getElementByClass} except that it expects the\n * element to be present in the dom thus returning a required value. Otherwise,\n * will assert.\n * @param {string} className The name of the class to look for.\n * @return {!Element} The first item with the class name provided.\n */\ngoog.ui.Component.prototype.getRequiredElementByClass = function(className) {\n  var el = this.getElementByClass(className);\n  goog.asserts.assert(\n      el, 'Expected element in component with class: %s', className);\n  return el;\n};\n\n\n/**\n * Returns the event handler for this component, lazily created the first time\n * this method is called.\n * @return {!goog.events.EventHandler<T>} Event handler for this component.\n * @protected\n * @this {T}\n * @template T\n */\ngoog.ui.Component.prototype.getHandler = function() {\n  // TODO(user): templated \"this\" values currently result in \"this\" being\n  // \"unknown\" in the body of the function.\n  var self = /** @type {goog.ui.Component} */ (this);\n  if (!self.googUiComponentHandler_) {\n    self.googUiComponentHandler_ = new goog.events.EventHandler(self);\n  }\n  return self.googUiComponentHandler_;\n};\n\n\n/**\n * Sets the parent of this component to use for event bubbling.  Throws an error\n * if the component already has a parent or if an attempt is made to add a\n * component to itself as a child.  Callers must use {@code removeChild}\n * or {@code removeChildAt} to remove components from their containers before\n * calling this method.\n * @see goog.ui.Component#removeChild\n * @see goog.ui.Component#removeChildAt\n * @param {goog.ui.Component} parent The parent component.\n */\ngoog.ui.Component.prototype.setParent = function(parent) {\n  if (this == parent) {\n    // Attempting to add a child to itself is an error.\n    throw Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET);\n  }\n\n  if (parent && this.parent_ && this.id_ && this.parent_.getChild(this.id_) &&\n      this.parent_ != parent) {\n    // This component is already the child of some parent, so it should be\n    // removed using removeChild/removeChildAt first.\n    throw Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET);\n  }\n\n  this.parent_ = parent;\n  goog.ui.Component.superClass_.setParentEventTarget.call(this, parent);\n};\n\n\n/**\n * Returns the component's parent, if any.\n * @return {goog.ui.Component?} The parent component.\n */\ngoog.ui.Component.prototype.getParent = function() {\n  return this.parent_;\n};\n\n\n/**\n * Overrides {@link goog.events.EventTarget#setParentEventTarget} to throw an\n * error if the parent component is set, and the argument is not the parent.\n * @override\n */\ngoog.ui.Component.prototype.setParentEventTarget = function(parent) {\n  if (this.parent_ && this.parent_ != parent) {\n    throw Error(goog.ui.Component.Error.NOT_SUPPORTED);\n  }\n  goog.ui.Component.superClass_.setParentEventTarget.call(this, parent);\n};\n\n\n/**\n * Returns the dom helper that is being used on this component.\n * @return {!goog.dom.DomHelper} The dom helper used on this component.\n */\ngoog.ui.Component.prototype.getDomHelper = function() {\n  return this.dom_;\n};\n\n\n/**\n * Determines whether the component has been added to the document.\n * @return {boolean} TRUE if rendered. Otherwise, FALSE.\n */\ngoog.ui.Component.prototype.isInDocument = function() {\n  return this.inDocument_;\n};\n\n\n/**\n * Creates the initial DOM representation for the component.  The default\n * implementation is to set this.element_ = div.\n */\ngoog.ui.Component.prototype.createDom = function() {\n  this.element_ = this.dom_.createElement(goog.dom.TagName.DIV);\n};\n\n\n/**\n * Renders the component.  If a parent element is supplied, the component's\n * element will be appended to it.  If there is no optional parent element and\n * the element doesn't have a parentNode then it will be appended to the\n * document body.\n *\n * If this component has a parent component, and the parent component is\n * not in the document already, then this will not call {@code enterDocument}\n * on this component.\n *\n * Throws an Error if the component is already rendered.\n *\n * @param {Element=} opt_parentElement Optional parent element to render the\n *    component into.\n */\ngoog.ui.Component.prototype.render = function(opt_parentElement) {\n  this.render_(opt_parentElement);\n};\n\n\n/**\n * Renders the component before another element. The other element should be in\n * the document already.\n *\n * Throws an Error if the component is already rendered.\n *\n * @param {Node} sibling Node to render the component before.\n */\ngoog.ui.Component.prototype.renderBefore = function(sibling) {\n  this.render_(/** @type {Element} */ (sibling.parentNode), sibling);\n};\n\n\n/**\n * Renders the component.  If a parent element is supplied, the component's\n * element will be appended to it.  If there is no optional parent element and\n * the element doesn't have a parentNode then it will be appended to the\n * document body.\n *\n * If this component has a parent component, and the parent component is\n * not in the document already, then this will not call {@code enterDocument}\n * on this component.\n *\n * Throws an Error if the component is already rendered.\n *\n * @param {Element=} opt_parentElement Optional parent element to render the\n *    component into.\n * @param {Node=} opt_beforeNode Node before which the component is to\n *    be rendered.  If left out the node is appended to the parent element.\n * @private\n */\ngoog.ui.Component.prototype.render_ = function(\n    opt_parentElement, opt_beforeNode) {\n  if (this.inDocument_) {\n    throw Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  }\n\n  if (!this.element_) {\n    this.createDom();\n  }\n\n  if (opt_parentElement) {\n    opt_parentElement.insertBefore(this.element_, opt_beforeNode || null);\n  } else {\n    this.dom_.getDocument().body.appendChild(this.element_);\n  }\n\n  // If this component has a parent component that isn't in the document yet,\n  // we don't call enterDocument() here.  Instead, when the parent component\n  // enters the document, the enterDocument() call will propagate to its\n  // children, including this one.  If the component doesn't have a parent\n  // or if the parent is already in the document, we call enterDocument().\n  if (!this.parent_ || this.parent_.isInDocument()) {\n    this.enterDocument();\n  }\n};\n\n\n/**\n * Decorates the element for the UI component. If the element is in the\n * document, the enterDocument method will be called.\n *\n * If goog.ui.Component.ALLOW_DETACHED_DECORATION is false, the caller must\n * pass an element that is in the document.\n *\n * @param {Element} element Element to decorate.\n */\ngoog.ui.Component.prototype.decorate = function(element) {\n  if (this.inDocument_) {\n    throw Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  } else if (element && this.canDecorate(element)) {\n    this.wasDecorated_ = true;\n\n    // Set the DOM helper of the component to match the decorated element.\n    var doc = goog.dom.getOwnerDocument(element);\n    if (!this.dom_ || this.dom_.getDocument() != doc) {\n      this.dom_ = goog.dom.getDomHelper(element);\n    }\n\n    // Call specific component decorate logic.\n    this.decorateInternal(element);\n\n    // If supporting detached decoration, check that element is in doc.\n    if (!goog.ui.Component.ALLOW_DETACHED_DECORATION ||\n        goog.dom.contains(doc, element)) {\n      this.enterDocument();\n    }\n  } else {\n    throw Error(goog.ui.Component.Error.DECORATE_INVALID);\n  }\n};\n\n\n/**\n * Determines if a given element can be decorated by this type of component.\n * This method should be overridden by inheriting objects.\n * @param {Element} element Element to decorate.\n * @return {boolean} True if the element can be decorated, false otherwise.\n */\ngoog.ui.Component.prototype.canDecorate = function(element) {\n  return true;\n};\n\n\n/**\n * @return {boolean} Whether the component was decorated.\n */\ngoog.ui.Component.prototype.wasDecorated = function() {\n  return this.wasDecorated_;\n};\n\n\n/**\n * Actually decorates the element. Should be overridden by inheriting objects.\n * This method can assume there are checks to ensure the component has not\n * already been rendered have occurred and that enter document will be called\n * afterwards. This method is considered protected.\n * @param {Element} element Element to decorate.\n * @protected\n */\ngoog.ui.Component.prototype.decorateInternal = function(element) {\n  this.element_ = element;\n};\n\n\n/**\n * Called when the component's element is known to be in the document. Anything\n * using document.getElementById etc. should be done at this stage.\n *\n * If the component contains child components, this call is propagated to its\n * children.\n */\ngoog.ui.Component.prototype.enterDocument = function() {\n  this.inDocument_ = true;\n\n  // Propagate enterDocument to child components that have a DOM, if any.\n  // If a child was decorated before entering the document (permitted when\n  // goog.ui.Component.ALLOW_DETACHED_DECORATION is true), its enterDocument\n  // will be called here.\n  this.forEachChild(function(child) {\n    if (!child.isInDocument() && child.getElement()) {\n      child.enterDocument();\n    }\n  });\n};\n\n\n/**\n * Called by dispose to clean up the elements and listeners created by a\n * component, or by a parent component/application who has removed the\n * component from the document but wants to reuse it later.\n *\n * If the component contains child components, this call is propagated to its\n * children.\n *\n * It should be possible for the component to be rendered again once this method\n * has been called.\n */\ngoog.ui.Component.prototype.exitDocument = function() {\n  // Propagate exitDocument to child components that have been rendered, if any.\n  this.forEachChild(function(child) {\n    if (child.isInDocument()) {\n      child.exitDocument();\n    }\n  });\n\n  if (this.googUiComponentHandler_) {\n    this.googUiComponentHandler_.removeAll();\n  }\n\n  this.inDocument_ = false;\n};\n\n\n/**\n * Disposes of the component.  Calls {@code exitDocument}, which is expected to\n * remove event handlers and clean up the component.  Propagates the call to\n * the component's children, if any. Removes the component's DOM from the\n * document unless it was decorated.\n * @override\n * @protected\n */\ngoog.ui.Component.prototype.disposeInternal = function() {\n  if (this.inDocument_) {\n    this.exitDocument();\n  }\n\n  if (this.googUiComponentHandler_) {\n    this.googUiComponentHandler_.dispose();\n    delete this.googUiComponentHandler_;\n  }\n\n  // Disposes of the component's children, if any.\n  this.forEachChild(function(child) { child.dispose(); });\n\n  // Detach the component's element from the DOM, unless it was decorated.\n  if (!this.wasDecorated_ && this.element_) {\n    goog.dom.removeNode(this.element_);\n  }\n\n  this.children_ = null;\n  this.childIndex_ = null;\n  this.element_ = null;\n  this.model_ = null;\n  this.parent_ = null;\n\n  goog.ui.Component.superClass_.disposeInternal.call(this);\n};\n\n\n/**\n * Helper function for subclasses that gets a unique id for a given fragment,\n * this can be used by components to generate unique string ids for DOM\n * elements.\n * @param {string} idFragment A partial id.\n * @return {string} Unique element id.\n */\ngoog.ui.Component.prototype.makeId = function(idFragment) {\n  return this.getId() + '.' + idFragment;\n};\n\n\n/**\n * Makes a collection of ids.  This is a convenience method for makeId.  The\n * object's values are the id fragments and the new values are the generated\n * ids.  The key will remain the same.\n * @param {Object} object The object that will be used to create the ids.\n * @return {!Object<string, string>} An object of id keys to generated ids.\n */\ngoog.ui.Component.prototype.makeIds = function(object) {\n  var ids = {};\n  for (var key in object) {\n    ids[key] = this.makeId(object[key]);\n  }\n  return ids;\n};\n\n\n/**\n * Returns the model associated with the UI component.\n * @return {*} The model.\n */\ngoog.ui.Component.prototype.getModel = function() {\n  return this.model_;\n};\n\n\n/**\n * Sets the model associated with the UI component.\n * @param {*} obj The model.\n */\ngoog.ui.Component.prototype.setModel = function(obj) {\n  this.model_ = obj;\n};\n\n\n/**\n * Helper function for returning the fragment portion of an id generated using\n * makeId().\n * @param {string} id Id generated with makeId().\n * @return {string} Fragment.\n */\ngoog.ui.Component.prototype.getFragmentFromId = function(id) {\n  return id.substring(this.getId().length + 1);\n};\n\n\n/**\n * Helper function for returning an element in the document with a unique id\n * generated using makeId().\n * @param {string} idFragment The partial id.\n * @return {Element} The element with the unique id, or null if it cannot be\n *     found.\n */\ngoog.ui.Component.prototype.getElementByFragment = function(idFragment) {\n  if (!this.inDocument_) {\n    throw Error(goog.ui.Component.Error.NOT_IN_DOCUMENT);\n  }\n  return this.dom_.getElement(this.makeId(idFragment));\n};\n\n\n/**\n * Adds the specified component as the last child of this component.  See\n * {@link goog.ui.Component#addChildAt} for detailed semantics.\n *\n * @see goog.ui.Component#addChildAt\n * @param {goog.ui.Component} child The new child component.\n * @param {boolean=} opt_render If true, the child component will be rendered\n *    into the parent.\n */\ngoog.ui.Component.prototype.addChild = function(child, opt_render) {\n  // TODO(gboyer): addChildAt(child, this.getChildCount(), false) will\n  // reposition any already-rendered child to the end.  Instead, perhaps\n  // addChild(child, false) should never reposition the child; instead, clients\n  // that need the repositioning will use addChildAt explicitly.  Right now,\n  // clients can get around this by calling addChild before calling decorate.\n  this.addChildAt(child, this.getChildCount(), opt_render);\n};\n\n\n/**\n * Adds the specified component as a child of this component at the given\n * 0-based index.\n *\n * Both {@code addChild} and {@code addChildAt} assume the following contract\n * between parent and child components:\n *  <ul>\n *    <li>the child component's element must be a descendant of the parent\n *        component's element, and\n *    <li>the DOM state of the child component must be consistent with the DOM\n *        state of the parent component (see {@code isInDocument}) in the\n *        steady state -- the exception is to addChildAt(child, i, false) and\n *        then immediately decorate/render the child.\n *  </ul>\n *\n * In particular, {@code parent.addChild(child)} will throw an error if the\n * child component is already in the document, but the parent isn't.\n *\n * Clients of this API may call {@code addChild} and {@code addChildAt} with\n * {@code opt_render} set to true.  If {@code opt_render} is true, calling these\n * methods will automatically render the child component's element into the\n * parent component's element. If the parent does not yet have an element, then\n * {@code createDom} will automatically be invoked on the parent before\n * rendering the child.\n *\n * Invoking {@code parent.addChild(child, true)} will throw an error if the\n * child component is already in the document, regardless of the parent's DOM\n * state.\n *\n * If {@code opt_render} is true and the parent component is not already\n * in the document, {@code enterDocument} will not be called on this component\n * at this point.\n *\n * Finally, this method also throws an error if the new child already has a\n * different parent, or the given index is out of bounds.\n *\n * @see goog.ui.Component#addChild\n * @param {goog.ui.Component} child The new child component.\n * @param {number} index 0-based index at which the new child component is to be\n *    added; must be between 0 and the current child count (inclusive).\n * @param {boolean=} opt_render If true, the child component will be rendered\n *    into the parent.\n * @return {void} Nada.\n */\ngoog.ui.Component.prototype.addChildAt = function(child, index, opt_render) {\n  goog.asserts.assert(!!child, 'Provided element must not be null.');\n\n  if (child.inDocument_ && (opt_render || !this.inDocument_)) {\n    // Adding a child that's already in the document is an error, except if the\n    // parent is also in the document and opt_render is false (e.g. decorate()).\n    throw Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  }\n\n  if (index < 0 || index > this.getChildCount()) {\n    // Allowing sparse child arrays would lead to strange behavior, so we don't.\n    throw Error(goog.ui.Component.Error.CHILD_INDEX_OUT_OF_BOUNDS);\n  }\n\n  // Create the index and the child array on first use.\n  if (!this.childIndex_ || !this.children_) {\n    this.childIndex_ = {};\n    this.children_ = [];\n  }\n\n  // Moving child within component, remove old reference.\n  if (child.getParent() == this) {\n    goog.object.set(this.childIndex_, child.getId(), child);\n    goog.array.remove(this.children_, child);\n\n    // Add the child to this component.  goog.object.add() throws an error if\n    // a child with the same ID already exists.\n  } else {\n    goog.object.add(this.childIndex_, child.getId(), child);\n  }\n\n  // Set the parent of the child to this component.  This throws an error if\n  // the child is already contained by another component.\n  child.setParent(this);\n  goog.array.insertAt(this.children_, child, index);\n\n  if (child.inDocument_ && this.inDocument_ && child.getParent() == this) {\n    // Changing the position of an existing child, move the DOM node (if\n    // necessary).\n    var contentElement = this.getContentElement();\n    var insertBeforeElement = contentElement.childNodes[index] || null;\n    if (insertBeforeElement != child.getElement()) {\n      contentElement.insertBefore(child.getElement(), insertBeforeElement);\n    }\n  } else if (opt_render) {\n    // If this (parent) component doesn't have a DOM yet, call createDom now\n    // to make sure we render the child component's element into the correct\n    // parent element (otherwise render_ with a null first argument would\n    // render the child into the document body, which is almost certainly not\n    // what we want).\n    if (!this.element_) {\n      this.createDom();\n    }\n    // Render the child into the parent at the appropriate location.  Note that\n    // getChildAt(index + 1) returns undefined if inserting at the end.\n    // TODO(attila): We should have a renderer with a renderChildAt API.\n    var sibling = this.getChildAt(index + 1);\n    // render_() calls enterDocument() if the parent is already in the document.\n    child.render_(this.getContentElement(), sibling ? sibling.element_ : null);\n  } else if (\n      this.inDocument_ && !child.inDocument_ && child.element_ &&\n      child.element_.parentNode &&\n      // Under some circumstances, IE8 implicitly creates a Document Fragment\n      // for detached nodes, so ensure the parent is an Element as it should be.\n      child.element_.parentNode.nodeType == goog.dom.NodeType.ELEMENT) {\n    // We don't touch the DOM, but if the parent is in the document, and the\n    // child element is in the document but not marked as such, then we call\n    // enterDocument on the child.\n    // TODO(gboyer): It would be nice to move this condition entirely, but\n    // there's a large risk of breaking existing applications that manually\n    // append the child to the DOM and then call addChild.\n    child.enterDocument();\n  }\n};\n\n\n/**\n * Returns the DOM element into which child components are to be rendered,\n * or null if the component itself hasn't been rendered yet.  This default\n * implementation returns the component's root element.  Subclasses with\n * complex DOM structures must override this method.\n * @return {Element} Element to contain child elements (null if none).\n */\ngoog.ui.Component.prototype.getContentElement = function() {\n  return this.element_;\n};\n\n\n/**\n * Returns true if the component is rendered right-to-left, false otherwise.\n * The first time this function is invoked, the right-to-left rendering property\n * is set if it has not been already.\n * @return {boolean} Whether the control is rendered right-to-left.\n */\ngoog.ui.Component.prototype.isRightToLeft = function() {\n  if (this.rightToLeft_ == null) {\n    this.rightToLeft_ = goog.style.isRightToLeft(\n        this.inDocument_ ? this.element_ : this.dom_.getDocument().body);\n  }\n  return this.rightToLeft_;\n};\n\n\n/**\n * Set is right-to-left. This function should be used if the component needs\n * to know the rendering direction during dom creation (i.e. before\n * {@link #enterDocument} is called and is right-to-left is set).\n * @param {boolean} rightToLeft Whether the component is rendered\n *     right-to-left.\n */\ngoog.ui.Component.prototype.setRightToLeft = function(rightToLeft) {\n  if (this.inDocument_) {\n    throw Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  }\n  this.rightToLeft_ = rightToLeft;\n};\n\n\n/**\n * Returns true if the component has children.\n * @return {boolean} True if the component has children.\n */\ngoog.ui.Component.prototype.hasChildren = function() {\n  return !!this.children_ && this.children_.length != 0;\n};\n\n\n/**\n * Returns the number of children of this component.\n * @return {number} The number of children.\n */\ngoog.ui.Component.prototype.getChildCount = function() {\n  return this.children_ ? this.children_.length : 0;\n};\n\n\n/**\n * Returns an array containing the IDs of the children of this component, or an\n * empty array if the component has no children.\n * @return {!Array<string>} Child component IDs.\n */\ngoog.ui.Component.prototype.getChildIds = function() {\n  var ids = [];\n\n  // We don't use goog.object.getKeys(this.childIndex_) because we want to\n  // return the IDs in the correct order as determined by this.children_.\n  this.forEachChild(function(child) {\n    // addChild()/addChildAt() guarantee that the child array isn't sparse.\n    ids.push(child.getId());\n  });\n\n  return ids;\n};\n\n\n/**\n * Returns the child with the given ID, or null if no such child exists.\n * @param {string} id Child component ID.\n * @return {goog.ui.Component?} The child with the given ID; null if none.\n */\ngoog.ui.Component.prototype.getChild = function(id) {\n  // Use childIndex_ for O(1) access by ID.\n  return (this.childIndex_ && id) ?\n      /** @type {goog.ui.Component} */ (\n          goog.object.get(this.childIndex_, id)) ||\n          null :\n      null;\n};\n\n\n/**\n * Returns the child at the given index, or null if the index is out of bounds.\n * @param {number} index 0-based index.\n * @return {goog.ui.Component?} The child at the given index; null if none.\n */\ngoog.ui.Component.prototype.getChildAt = function(index) {\n  // Use children_ for access by index.\n  return this.children_ ? this.children_[index] || null : null;\n};\n\n\n/**\n * Calls the given function on each of this component's children in order.  If\n * {@code opt_obj} is provided, it will be used as the 'this' object in the\n * function when called.  The function should take two arguments:  the child\n * component and its 0-based index.  The return value is ignored.\n * @param {function(this:T,?,number):?} f The function to call for every\n * child component; should take 2 arguments (the child and its index).\n * @param {T=} opt_obj Used as the 'this' object in f when called.\n * @template T\n */\ngoog.ui.Component.prototype.forEachChild = function(f, opt_obj) {\n  if (this.children_) {\n    goog.array.forEach(this.children_, f, opt_obj);\n  }\n};\n\n\n/**\n * Returns the 0-based index of the given child component, or -1 if no such\n * child is found.\n * @param {goog.ui.Component?} child The child component.\n * @return {number} 0-based index of the child component; -1 if not found.\n */\ngoog.ui.Component.prototype.indexOfChild = function(child) {\n  return (this.children_ && child) ? goog.array.indexOf(this.children_, child) :\n                                     -1;\n};\n\n\n/**\n * Removes the given child from this component, and returns it.  Throws an error\n * if the argument is invalid or if the specified child isn't found in the\n * parent component.  The argument can either be a string (interpreted as the\n * ID of the child component to remove) or the child component itself.\n *\n * If {@code opt_unrender} is true, calls {@link goog.ui.component#exitDocument}\n * on the removed child, and subsequently detaches the child's DOM from the\n * document.  Otherwise it is the caller's responsibility to clean up the child\n * component's DOM.\n *\n * @see goog.ui.Component#removeChildAt\n * @param {string|goog.ui.Component|null} child The ID of the child to remove,\n *    or the child component itself.\n * @param {boolean=} opt_unrender If true, calls {@code exitDocument} on the\n *    removed child component, and detaches its DOM from the document.\n * @return {goog.ui.Component} The removed component, if any.\n */\ngoog.ui.Component.prototype.removeChild = function(child, opt_unrender) {\n  if (child) {\n    // Normalize child to be the object and id to be the ID string.  This also\n    // ensures that the child is really ours.\n    var id = goog.isString(child) ? child : child.getId();\n    child = this.getChild(id);\n\n    if (id && child) {\n      goog.object.remove(this.childIndex_, id);\n      goog.array.remove(this.children_, child);\n\n      if (opt_unrender) {\n        // Remove the child component's DOM from the document.  We have to call\n        // exitDocument first (see documentation).\n        child.exitDocument();\n        if (child.element_) {\n          goog.dom.removeNode(child.element_);\n        }\n      }\n\n      // Child's parent must be set to null after exitDocument is called\n      // so that the child can unlisten to its parent if required.\n      child.setParent(null);\n    }\n  }\n\n  if (!child) {\n    throw Error(goog.ui.Component.Error.NOT_OUR_CHILD);\n  }\n\n  return /** @type {!goog.ui.Component} */ (child);\n};\n\n\n/**\n * Removes the child at the given index from this component, and returns it.\n * Throws an error if the argument is out of bounds, or if the specified child\n * isn't found in the parent.  See {@link goog.ui.Component#removeChild} for\n * detailed semantics.\n *\n * @see goog.ui.Component#removeChild\n * @param {number} index 0-based index of the child to remove.\n * @param {boolean=} opt_unrender If true, calls {@code exitDocument} on the\n *    removed child component, and detaches its DOM from the document.\n * @return {goog.ui.Component} The removed component, if any.\n */\ngoog.ui.Component.prototype.removeChildAt = function(index, opt_unrender) {\n  // removeChild(null) will throw error.\n  return this.removeChild(this.getChildAt(index), opt_unrender);\n};\n\n\n/**\n * Removes every child component attached to this one and returns them.\n *\n * @see goog.ui.Component#removeChild\n * @param {boolean=} opt_unrender If true, calls {@link #exitDocument} on the\n *    removed child components, and detaches their DOM from the document.\n * @return {!Array<goog.ui.Component>} The removed components if any.\n */\ngoog.ui.Component.prototype.removeChildren = function(opt_unrender) {\n  var removedChildren = [];\n  while (this.hasChildren()) {\n    removedChildren.push(this.removeChildAt(0, opt_unrender));\n  }\n  return removedChildren;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/**\n * @fileoverview The file contains generated enumerations for ARIA roles\n * as defined by W3C ARIA standard: http://www.w3.org/TR/wai-aria/.\n *\n * This is auto-generated code. Do not manually edit! For more details\n * about how to edit it via the generator check go/closure-ariagen.\n */\n\ngoog.provide('goog.a11y.aria.Role');\n\n\n/**\n * ARIA role values.\n * @enum {string}\n */\ngoog.a11y.aria.Role = {\n  // ARIA role for an alert element that doesn't need to be explicitly closed.\n  ALERT: 'alert',\n\n  // ARIA role for an alert dialog element that takes focus and must be closed.\n  ALERTDIALOG: 'alertdialog',\n\n  // ARIA role for an application that implements its own keyboard navigation.\n  APPLICATION: 'application',\n\n  // ARIA role for an article.\n  ARTICLE: 'article',\n\n  // ARIA role for a banner containing mostly site content, not page content.\n  BANNER: 'banner',\n\n  // ARIA role for a button element.\n  BUTTON: 'button',\n\n  // ARIA role for a checkbox button element; use with the CHECKED state.\n  CHECKBOX: 'checkbox',\n\n  // ARIA role for a column header of a table or grid.\n  COLUMNHEADER: 'columnheader',\n\n  // ARIA role for a combo box element.\n  COMBOBOX: 'combobox',\n\n  // ARIA role for a supporting section of the document.\n  COMPLEMENTARY: 'complementary',\n\n  // ARIA role for a large perceivable region that contains information\n  // about the parent document.\n  CONTENTINFO: 'contentinfo',\n\n  // ARIA role for a definition of a term or concept.\n  DEFINITION: 'definition',\n\n  // ARIA role for a dialog, some descendant must take initial focus.\n  DIALOG: 'dialog',\n\n  // ARIA role for a directory, like a table of contents.\n  DIRECTORY: 'directory',\n\n  // ARIA role for a part of a page that's a document, not a web application.\n  DOCUMENT: 'document',\n\n  // ARIA role for a landmark region logically considered one form.\n  FORM: 'form',\n\n  // ARIA role for an interactive control of tabular data.\n  GRID: 'grid',\n\n  // ARIA role for a cell in a grid.\n  GRIDCELL: 'gridcell',\n\n  // ARIA role for a group of related elements like tree item siblings.\n  GROUP: 'group',\n\n  // ARIA role for a heading element.\n  HEADING: 'heading',\n\n  // ARIA role for a container of elements that together comprise one image.\n  IMG: 'img',\n\n  // ARIA role for a link.\n  LINK: 'link',\n\n  // ARIA role for a list of non-interactive list items.\n  LIST: 'list',\n\n  // ARIA role for a listbox.\n  LISTBOX: 'listbox',\n\n  // ARIA role for a list item.\n  LISTITEM: 'listitem',\n\n  // ARIA role for a live region where new information is added.\n  LOG: 'log',\n\n  // ARIA landmark role for the main content in a document. Use only once.\n  MAIN: 'main',\n\n  // ARIA role for a live region of non-essential information that changes.\n  MARQUEE: 'marquee',\n\n  // ARIA role for a mathematical expression.\n  MATH: 'math',\n\n  // ARIA role for a popup menu.\n  MENU: 'menu',\n\n  // ARIA role for a menubar element containing menu elements.\n  MENUBAR: 'menubar',\n\n  // ARIA role for menu item elements.\n  MENU_ITEM: 'menuitem',\n\n  // ARIA role for a checkbox box element inside a menu.\n  MENU_ITEM_CHECKBOX: 'menuitemcheckbox',\n\n  // ARIA role for a radio button element inside a menu.\n  MENU_ITEM_RADIO: 'menuitemradio',\n\n  // ARIA landmark role for a collection of navigation links.\n  NAVIGATION: 'navigation',\n\n  // ARIA role for a section ancillary to the main content.\n  NOTE: 'note',\n\n  // ARIA role for option items that are  children of combobox, listbox, menu,\n  // radiogroup, or tree elements.\n  OPTION: 'option',\n\n  // ARIA role for ignorable cosmetic elements with no semantic significance.\n  PRESENTATION: 'presentation',\n\n  // ARIA role for a progress bar element.\n  PROGRESSBAR: 'progressbar',\n\n  // ARIA role for a radio button element.\n  RADIO: 'radio',\n\n  // ARIA role for a group of connected radio button elements.\n  RADIOGROUP: 'radiogroup',\n\n  // ARIA role for an important region of the page.\n  REGION: 'region',\n\n  // ARIA role for a row of cells in a grid.\n  ROW: 'row',\n\n  // ARIA role for a group of one or more rows in a grid.\n  ROWGROUP: 'rowgroup',\n\n  // ARIA role for a row header of a table or grid.\n  ROWHEADER: 'rowheader',\n\n  // ARIA role for a scrollbar element.\n  SCROLLBAR: 'scrollbar',\n\n  // ARIA landmark role for a part of the page providing search functionality.\n  SEARCH: 'search',\n\n  // ARIA role for a menu separator.\n  SEPARATOR: 'separator',\n\n  // ARIA role for a slider.\n  SLIDER: 'slider',\n\n  // ARIA role for a spin button.\n  SPINBUTTON: 'spinbutton',\n\n  // ARIA role for a live region with advisory info less severe than an alert.\n  STATUS: 'status',\n\n  // ARIA role for a tab button.\n  TAB: 'tab',\n\n  // ARIA role for a tab bar (i.e. a list of tab buttons).\n  TAB_LIST: 'tablist',\n\n  // ARIA role for a tab page (i.e. the element holding tab contents).\n  TAB_PANEL: 'tabpanel',\n\n  // ARIA role for a textbox element.\n  TEXTBOX: 'textbox',\n\n  // ARIA role for a textinfo element.\n  TEXTINFO: 'textinfo',\n\n  // ARIA role for an element displaying elapsed time or time remaining.\n  TIMER: 'timer',\n\n  // ARIA role for a toolbar element.\n  TOOLBAR: 'toolbar',\n\n  // ARIA role for a tooltip element.\n  TOOLTIP: 'tooltip',\n\n  // ARIA role for a tree.\n  TREE: 'tree',\n\n  // ARIA role for a grid whose rows can be expanded and collapsed like a tree.\n  TREEGRID: 'treegrid',\n\n  // ARIA role for a tree item that sometimes may be expanded or collapsed.\n  TREEITEM: 'treeitem'\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/**\n * @fileoverview The file contains generated enumerations for ARIA states\n * and properties as defined by W3C ARIA standard:\n * http://www.w3.org/TR/wai-aria/.\n *\n * This is auto-generated code. Do not manually edit! For more details\n * about how to edit it via the generator check go/closure-ariagen.\n */\n\ngoog.provide('goog.a11y.aria.AutoCompleteValues');\ngoog.provide('goog.a11y.aria.CheckedValues');\ngoog.provide('goog.a11y.aria.DropEffectValues');\ngoog.provide('goog.a11y.aria.ExpandedValues');\ngoog.provide('goog.a11y.aria.GrabbedValues');\ngoog.provide('goog.a11y.aria.InvalidValues');\ngoog.provide('goog.a11y.aria.LivePriority');\ngoog.provide('goog.a11y.aria.OrientationValues');\ngoog.provide('goog.a11y.aria.PressedValues');\ngoog.provide('goog.a11y.aria.RelevantValues');\ngoog.provide('goog.a11y.aria.SelectedValues');\ngoog.provide('goog.a11y.aria.SortValues');\ngoog.provide('goog.a11y.aria.State');\n\n\n/**\n * ARIA states and properties.\n * @enum {string}\n */\ngoog.a11y.aria.State = {\n  // ARIA property for setting the currently active descendant of an element,\n  // for example the selected item in a list box. Value: ID of an element.\n  ACTIVEDESCENDANT: 'activedescendant',\n\n  // ARIA property that, if true, indicates that all of a changed region should\n  // be presented, instead of only parts. Value: one of {true, false}.\n  ATOMIC: 'atomic',\n\n  // ARIA property to specify that input completion is provided. Value:\n  // one of {'inline', 'list', 'both', 'none'}.\n  AUTOCOMPLETE: 'autocomplete',\n\n  // ARIA state to indicate that an element and its subtree are being updated.\n  // Value: one of {true, false}.\n  BUSY: 'busy',\n\n  // ARIA state for a checked item. Value: one of {'true', 'false', 'mixed',\n  // undefined}.\n  CHECKED: 'checked',\n\n  // ARIA property that identifies the element or elements whose contents or\n  // presence are controlled by this element.\n  // Value: space-separated IDs of other elements.\n  CONTROLS: 'controls',\n\n  // ARIA property that identifies the element or elements that describe\n  // this element. Value: space-separated IDs of other elements.\n  DESCRIBEDBY: 'describedby',\n\n  // ARIA state for a disabled item. Value: one of {true, false}.\n  DISABLED: 'disabled',\n\n  // ARIA property that indicates what functions can be performed when a\n  // dragged object is released on the drop target.  Value: one of\n  // {'copy', 'move', 'link', 'execute', 'popup', 'none'}.\n  DROPEFFECT: 'dropeffect',\n\n  // ARIA state for setting whether the element like a tree node is expanded.\n  // Value: one of {true, false, undefined}.\n  EXPANDED: 'expanded',\n\n  // ARIA property that identifies the next element (or elements) in the\n  // recommended reading order of content. Value: space-separated ids of\n  // elements to flow to.\n  FLOWTO: 'flowto',\n\n  // ARIA state that indicates an element's \"grabbed\" state in drag-and-drop.\n  // Value: one of {true, false, undefined}.\n  GRABBED: 'grabbed',\n\n  // ARIA property indicating whether the element has a popup.\n  // Value: one of {true, false}.\n  HASPOPUP: 'haspopup',\n\n  // ARIA state indicating that the element is not visible or perceivable\n  // to any user. Value: one of {true, false}.\n  HIDDEN: 'hidden',\n\n  // ARIA state indicating that the entered value does not conform. Value:\n  // one of {false, true, 'grammar', 'spelling'}\n  INVALID: 'invalid',\n\n  // ARIA property that provides a label to override any other text, value, or\n  // contents used to describe this element. Value: string.\n  LABEL: 'label',\n\n  // ARIA property for setting the element which labels another element.\n  // Value: space-separated IDs of elements.\n  LABELLEDBY: 'labelledby',\n\n  // ARIA property for setting the level of an element in the hierarchy.\n  // Value: integer.\n  LEVEL: 'level',\n\n  // ARIA property indicating that an element will be updated, and\n  // describes the types of updates the user agents, assistive technologies,\n  // and user can expect from the live region. Value: one of {'off', 'polite',\n  // 'assertive'}.\n  LIVE: 'live',\n\n  // ARIA property indicating whether a text box can accept multiline input.\n  // Value: one of {true, false}.\n  MULTILINE: 'multiline',\n\n  // ARIA property indicating if the user may select more than one item.\n  // Value: one of {true, false}.\n  MULTISELECTABLE: 'multiselectable',\n\n  // ARIA property indicating if the element is horizontal or vertical.\n  // Value: one of {'vertical', 'horizontal'}.\n  ORIENTATION: 'orientation',\n\n  // ARIA property creating a visual, functional, or contextual parent/child\n  // relationship when the DOM hierarchy can't be used to represent it.\n  // Value: Space-separated IDs of elements.\n  OWNS: 'owns',\n\n  // ARIA property that defines an element's number of position in a list.\n  // Value: integer.\n  POSINSET: 'posinset',\n\n  // ARIA state for a pressed item.\n  // Value: one of {true, false, undefined, 'mixed'}.\n  PRESSED: 'pressed',\n\n  // ARIA property indicating that an element is not editable.\n  // Value: one of {true, false}.\n  READONLY: 'readonly',\n\n  // ARIA property indicating that change notifications within this subtree\n  // of a live region should be announced. Value: one of {'additions',\n  // 'removals', 'text', 'all', 'additions text'}.\n  RELEVANT: 'relevant',\n\n  // ARIA property indicating that user input is required on this element\n  // before a form may be submitted. Value: one of {true, false}.\n  REQUIRED: 'required',\n\n  // ARIA state for setting the currently selected item in the list.\n  // Value: one of {true, false, undefined}.\n  SELECTED: 'selected',\n\n  // ARIA property defining the number of items in a list. Value: integer.\n  SETSIZE: 'setsize',\n\n  // ARIA property indicating if items are sorted. Value: one of {'ascending',\n  // 'descending', 'none', 'other'}.\n  SORT: 'sort',\n\n  // ARIA property for slider maximum value. Value: number.\n  VALUEMAX: 'valuemax',\n\n  // ARIA property for slider minimum value. Value: number.\n  VALUEMIN: 'valuemin',\n\n  // ARIA property for slider active value. Value: number.\n  VALUENOW: 'valuenow',\n\n  // ARIA property for slider active value represented as text.\n  // Value: string.\n  VALUETEXT: 'valuetext'\n};\n\n\n/**\n * ARIA state values for AutoCompleteValues.\n * @enum {string}\n */\ngoog.a11y.aria.AutoCompleteValues = {\n  // The system provides text after the caret as a suggestion\n  // for how to complete the field.\n  INLINE: 'inline',\n  // A list of choices appears from which the user can choose,\n  // but the edit box retains focus.\n  LIST: 'list',\n  // A list of choices appears and the currently selected suggestion\n  // also appears inline.\n  BOTH: 'both',\n  // No input completion suggestions are provided.\n  NONE: 'none'\n};\n\n\n/**\n * ARIA state values for DropEffectValues.\n * @enum {string}\n */\ngoog.a11y.aria.DropEffectValues = {\n  // A duplicate of the source object will be dropped into the target.\n  COPY: 'copy',\n  // The source object will be removed from its current location\n  // and dropped into the target.\n  MOVE: 'move',\n  // A reference or shortcut to the dragged object\n  // will be created in the target object.\n  LINK: 'link',\n  // A function supported by the drop target is\n  // executed, using the drag source as an input.\n  EXECUTE: 'execute',\n  // There is a popup menu or dialog that allows the user to choose\n  // one of the drag operations (copy, move, link, execute) and any other\n  // drag functionality, such as cancel.\n  POPUP: 'popup',\n  // No operation can be performed; effectively\n  // cancels the drag operation if an attempt is made to drop on this object.\n  NONE: 'none'\n};\n\n\n/**\n * ARIA state values for LivePriority.\n * @enum {string}\n */\ngoog.a11y.aria.LivePriority = {\n  // Updates to the region will not be presented to the user\n  // unless the assitive technology is currently focused on that region.\n  OFF: 'off',\n  // (Background change) Assistive technologies SHOULD announce\n  // updates at the next graceful opportunity, such as at the end of\n  // speaking the current sentence or when the user pauses typing.\n  POLITE: 'polite',\n  // This information has the highest priority and assistive\n  // technologies SHOULD notify the user immediately.\n  // Because an interruption may disorient users or cause them to not complete\n  // their current task, authors SHOULD NOT use the assertive value unless the\n  // interruption is imperative.\n  ASSERTIVE: 'assertive'\n};\n\n\n/**\n * ARIA state values for OrientationValues.\n * @enum {string}\n */\ngoog.a11y.aria.OrientationValues = {\n  // The element is oriented vertically.\n  VERTICAL: 'vertical',\n  // The element is oriented horizontally.\n  HORIZONTAL: 'horizontal'\n};\n\n\n/**\n * ARIA state values for RelevantValues.\n * @enum {string}\n */\ngoog.a11y.aria.RelevantValues = {\n  // Element nodes are added to the DOM within the live region.\n  ADDITIONS: 'additions',\n  // Text or element nodes within the live region are removed from the DOM.\n  REMOVALS: 'removals',\n  // Text is added to any DOM descendant nodes of the live region.\n  TEXT: 'text',\n  // Equivalent to the combination of all values, \"additions removals text\".\n  ALL: 'all'\n};\n\n\n/**\n * ARIA state values for SortValues.\n * @enum {string}\n */\ngoog.a11y.aria.SortValues = {\n  // Items are sorted in ascending order by this column.\n  ASCENDING: 'ascending',\n  // Items are sorted in descending order by this column.\n  DESCENDING: 'descending',\n  // There is no defined sort applied to the column.\n  NONE: 'none',\n  // A sort algorithm other than ascending or descending has been applied.\n  OTHER: 'other'\n};\n\n\n/**\n * ARIA state values for CheckedValues.\n * @enum {string}\n */\ngoog.a11y.aria.CheckedValues = {\n  // The selectable element is checked.\n  TRUE: 'true',\n  // The selectable element is not checked.\n  FALSE: 'false',\n  // Indicates a mixed mode value for a tri-state\n  // checkbox or menuitemcheckbox.\n  MIXED: 'mixed',\n  // The element does not support being checked.\n  UNDEFINED: 'undefined'\n};\n\n\n/**\n * ARIA state values for ExpandedValues.\n * @enum {string}\n */\ngoog.a11y.aria.ExpandedValues = {\n  // The element, or another grouping element it controls, is expanded.\n  TRUE: 'true',\n  // The element, or another grouping element it controls, is collapsed.\n  FALSE: 'false',\n  // The element, or another grouping element\n  // it controls, is neither expandable nor collapsible; all its\n  // child elements are shown or there are no child elements.\n  UNDEFINED: 'undefined'\n};\n\n\n/**\n * ARIA state values for GrabbedValues.\n * @enum {string}\n */\ngoog.a11y.aria.GrabbedValues = {\n  // Indicates that the element has been \"grabbed\" for dragging.\n  TRUE: 'true',\n  // Indicates that the element supports being dragged.\n  FALSE: 'false',\n  // Indicates that the element does not support being dragged.\n  UNDEFINED: 'undefined'\n};\n\n\n/**\n * ARIA state values for InvalidValues.\n * @enum {string}\n */\ngoog.a11y.aria.InvalidValues = {\n  // There are no detected errors in the value.\n  FALSE: 'false',\n  // The value entered by the user has failed validation.\n  TRUE: 'true',\n  // A grammatical error was detected.\n  GRAMMAR: 'grammar',\n  // A spelling error was detected.\n  SPELLING: 'spelling'\n};\n\n\n/**\n * ARIA state values for PressedValues.\n * @enum {string}\n */\ngoog.a11y.aria.PressedValues = {\n  // The element is pressed.\n  TRUE: 'true',\n  // The element supports being pressed but is not currently pressed.\n  FALSE: 'false',\n  // Indicates a mixed mode value for a tri-state toggle button.\n  MIXED: 'mixed',\n  // The element does not support being pressed.\n  UNDEFINED: 'undefined'\n};\n\n\n/**\n * ARIA state values for SelectedValues.\n * @enum {string}\n */\ngoog.a11y.aria.SelectedValues = {\n  // The selectable element is selected.\n  TRUE: 'true',\n  // The selectable element is not selected.\n  FALSE: 'false',\n  // The element is not selectable.\n  UNDEFINED: 'undefined'\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n/**\n * @fileoverview The file contains data tables generated from the ARIA\n * standard schema http://www.w3.org/TR/wai-aria/.\n *\n * This is auto-generated code. Do not manually edit!\n */\n\ngoog.provide('goog.a11y.aria.datatables');\n\ngoog.require('goog.a11y.aria.State');\ngoog.require('goog.object');\n\n\n/**\n * A map that contains mapping between an ARIA state and the default value\n * for it. Note that not all ARIA states have default values.\n *\n * @type {Object<!(goog.a11y.aria.State|string), (string|boolean|number)>}\n */\ngoog.a11y.aria.DefaultStateValueMap_;\n\n\n/**\n * A method that creates a map that contains mapping between an ARIA state and\n * the default value for it. Note that not all ARIA states have default values.\n *\n * @return {!Object<!(goog.a11y.aria.State|string), (string|boolean|number)>}\n *      The names for each of the notification methods.\n */\ngoog.a11y.aria.datatables.getDefaultValuesMap = function() {\n  if (!goog.a11y.aria.DefaultStateValueMap_) {\n    goog.a11y.aria.DefaultStateValueMap_ = goog.object.create(\n        goog.a11y.aria.State.ATOMIC, false, goog.a11y.aria.State.AUTOCOMPLETE,\n        'none', goog.a11y.aria.State.DROPEFFECT, 'none',\n        goog.a11y.aria.State.HASPOPUP, false, goog.a11y.aria.State.LIVE, 'off',\n        goog.a11y.aria.State.MULTILINE, false,\n        goog.a11y.aria.State.MULTISELECTABLE, false,\n        goog.a11y.aria.State.ORIENTATION, 'vertical',\n        goog.a11y.aria.State.READONLY, false, goog.a11y.aria.State.RELEVANT,\n        'additions text', goog.a11y.aria.State.REQUIRED, false,\n        goog.a11y.aria.State.SORT, 'none', goog.a11y.aria.State.BUSY, false,\n        goog.a11y.aria.State.DISABLED, false, goog.a11y.aria.State.HIDDEN,\n        false, goog.a11y.aria.State.INVALID, 'false');\n  }\n\n  return goog.a11y.aria.DefaultStateValueMap_;\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/**\n * @fileoverview Utilities for adding, removing and setting ARIA roles and\n * states as defined by W3C ARIA standard: http://www.w3.org/TR/wai-aria/\n * All modern browsers have some form of ARIA support, so no browser checks are\n * performed when adding ARIA to components.\n *\n */\n\ngoog.provide('goog.a11y.aria');\n\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.a11y.aria.State');\ngoog.require('goog.a11y.aria.datatables');\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.object');\ngoog.require('goog.string');\n\n\n/**\n * ARIA states/properties prefix.\n * @private\n */\ngoog.a11y.aria.ARIA_PREFIX_ = 'aria-';\n\n\n/**\n * ARIA role attribute.\n * @private\n */\ngoog.a11y.aria.ROLE_ATTRIBUTE_ = 'role';\n\n\n/**\n * A list of tag names for which we don't need to set ARIA role and states\n * because they have well supported semantics for screen readers or because\n * they don't contain content to be made accessible.\n * @private\n */\ngoog.a11y.aria.TAGS_WITH_ASSUMED_ROLES_ = goog.object.createSet([\n  goog.dom.TagName.A, goog.dom.TagName.AREA, goog.dom.TagName.BUTTON,\n  goog.dom.TagName.HEAD, goog.dom.TagName.INPUT, goog.dom.TagName.LINK,\n  goog.dom.TagName.MENU, goog.dom.TagName.META, goog.dom.TagName.OPTGROUP,\n  goog.dom.TagName.OPTION, goog.dom.TagName.PROGRESS, goog.dom.TagName.STYLE,\n  goog.dom.TagName.SELECT, goog.dom.TagName.SOURCE, goog.dom.TagName.TEXTAREA,\n  goog.dom.TagName.TITLE, goog.dom.TagName.TRACK\n]);\n\n\n/**\n * A list of roles which are considered container roles.\n * Container roles are ARIA roles which use the aria-activedescendant property\n * to manage their active descendants or children. See\n * {@link http://www.w3.org/TR/wai-aria/states_and_properties\n * #aria-activedescendant} for more information.\n * @private @const {!Array<goog.a11y.aria.Role>}\n */\ngoog.a11y.aria.CONTAINER_ROLES_ = [\n  goog.a11y.aria.Role.COMBOBOX, goog.a11y.aria.Role.GRID,\n  goog.a11y.aria.Role.GROUP, goog.a11y.aria.Role.LISTBOX,\n  goog.a11y.aria.Role.MENU, goog.a11y.aria.Role.MENUBAR,\n  goog.a11y.aria.Role.RADIOGROUP, goog.a11y.aria.Role.ROW,\n  goog.a11y.aria.Role.ROWGROUP, goog.a11y.aria.Role.TAB_LIST,\n  goog.a11y.aria.Role.TEXTBOX, goog.a11y.aria.Role.TOOLBAR,\n  goog.a11y.aria.Role.TREE, goog.a11y.aria.Role.TREEGRID\n];\n\n\n/**\n * Sets the role of an element. If the roleName is\n * empty string or null, the role for the element is removed.\n * We encourage clients to call the goog.a11y.aria.removeRole\n * method instead of setting null and empty string values.\n * Special handling for this case is added to ensure\n * backword compatibility with existing code.\n *\n * @param {!Element} element DOM node to set role of.\n * @param {!goog.a11y.aria.Role|string} roleName role name(s).\n */\ngoog.a11y.aria.setRole = function(element, roleName) {\n  if (!roleName) {\n    // Setting the ARIA role to empty string is not allowed\n    // by the ARIA standard.\n    goog.a11y.aria.removeRole(element);\n  } else {\n    if (goog.asserts.ENABLE_ASSERTS) {\n      goog.asserts.assert(\n          goog.object.containsValue(goog.a11y.aria.Role, roleName),\n          'No such ARIA role ' + roleName);\n    }\n    element.setAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_, roleName);\n  }\n};\n\n\n/**\n * Gets role of an element.\n * @param {!Element} element DOM element to get role of.\n * @return {goog.a11y.aria.Role} ARIA Role name.\n */\ngoog.a11y.aria.getRole = function(element) {\n  var role = element.getAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_);\n  return /** @type {goog.a11y.aria.Role} */ (role) || null;\n};\n\n\n/**\n * Removes role of an element.\n * @param {!Element} element DOM element to remove the role from.\n */\ngoog.a11y.aria.removeRole = function(element) {\n  element.removeAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_);\n};\n\n\n/**\n * Sets the state or property of an element.\n * @param {!Element} element DOM node where we set state.\n * @param {!(goog.a11y.aria.State|string)} stateName State attribute being set.\n *     Automatically adds prefix 'aria-' to the state name if the attribute is\n *     not an extra attribute.\n * @param {string|boolean|number|!Array<string>} value Value\n * for the state attribute.\n */\ngoog.a11y.aria.setState = function(element, stateName, value) {\n  if (goog.isArray(value)) {\n    value = value.join(' ');\n  }\n  var attrStateName = goog.a11y.aria.getAriaAttributeName_(stateName);\n  if (value === '' || value == undefined) {\n    var defaultValueMap = goog.a11y.aria.datatables.getDefaultValuesMap();\n    // Work around for browsers that don't properly support ARIA.\n    // According to the ARIA W3C standard, user agents should allow\n    // setting empty value which results in setting the default value\n    // for the ARIA state if such exists. The exact text from the ARIA W3C\n    // standard (http://www.w3.org/TR/wai-aria/states_and_properties):\n    // \"When a value is indicated as the default, the user agent\n    // MUST follow the behavior prescribed by this value when the state or\n    // property is empty or undefined.\"\n    // The defaultValueMap contains the default values for the ARIA states\n    // and has as a key the goog.a11y.aria.State constant for the state.\n    if (stateName in defaultValueMap) {\n      element.setAttribute(attrStateName, defaultValueMap[stateName]);\n    } else {\n      element.removeAttribute(attrStateName);\n    }\n  } else {\n    element.setAttribute(attrStateName, value);\n  }\n};\n\n\n/**\n * Toggles the ARIA attribute of an element.\n * Meant for attributes with a true/false value, but works with any attribute.\n * If the attribute does not have a true/false value, the following rules apply:\n * A not empty attribute will be removed.\n * An empty attribute will be set to true.\n * @param {!Element} el DOM node for which to set attribute.\n * @param {!(goog.a11y.aria.State|string)} attr ARIA attribute being set.\n *     Automatically adds prefix 'aria-' to the attribute name if the attribute\n *     is not an extra attribute.\n */\ngoog.a11y.aria.toggleState = function(el, attr) {\n  var val = goog.a11y.aria.getState(el, attr);\n  if (!goog.string.isEmptyOrWhitespace(goog.string.makeSafe(val)) &&\n      !(val == 'true' || val == 'false')) {\n    goog.a11y.aria.removeState(el, /** @type {!goog.a11y.aria.State} */ (attr));\n    return;\n  }\n  goog.a11y.aria.setState(el, attr, val == 'true' ? 'false' : 'true');\n};\n\n\n/**\n * Remove the state or property for the element.\n * @param {!Element} element DOM node where we set state.\n * @param {!goog.a11y.aria.State} stateName State name.\n */\ngoog.a11y.aria.removeState = function(element, stateName) {\n  element.removeAttribute(goog.a11y.aria.getAriaAttributeName_(stateName));\n};\n\n\n/**\n * Gets value of specified state or property.\n * @param {!Element} element DOM node to get state from.\n * @param {!goog.a11y.aria.State|string} stateName State name.\n * @return {string} Value of the state attribute.\n */\ngoog.a11y.aria.getState = function(element, stateName) {\n  // TODO(user): return properly typed value result --\n  // boolean, number, string, null. We should be able to chain\n  // getState(...) and setState(...) methods.\n\n  var attr =\n      /** @type {string|number|boolean} */ (\n          element.getAttribute(\n              goog.a11y.aria.getAriaAttributeName_(stateName)));\n  var isNullOrUndefined = attr == null || attr == undefined;\n  return isNullOrUndefined ? '' : String(attr);\n};\n\n\n/**\n * Returns the activedescendant element for the input element by\n * using the activedescendant ARIA property of the given element.\n * @param {!Element} element DOM node to get activedescendant\n *     element for.\n * @return {?Element} DOM node of the activedescendant, if found.\n */\ngoog.a11y.aria.getActiveDescendant = function(element) {\n  var id =\n      goog.a11y.aria.getState(element, goog.a11y.aria.State.ACTIVEDESCENDANT);\n  return goog.dom.getOwnerDocument(element).getElementById(id);\n};\n\n\n/**\n * Sets the activedescendant ARIA property value for an element.\n * If the activeElement is not null, it should have an id set.\n * @param {!Element} element DOM node to set activedescendant ARIA property to.\n * @param {?Element} activeElement DOM node being set as activedescendant.\n */\ngoog.a11y.aria.setActiveDescendant = function(element, activeElement) {\n  var id = '';\n  if (activeElement) {\n    id = activeElement.id;\n    goog.asserts.assert(id, 'The active element should have an id.');\n  }\n\n  goog.a11y.aria.setState(element, goog.a11y.aria.State.ACTIVEDESCENDANT, id);\n};\n\n\n/**\n * Gets the label of the given element.\n * @param {!Element} element DOM node to get label from.\n * @return {string} label The label.\n */\ngoog.a11y.aria.getLabel = function(element) {\n  return goog.a11y.aria.getState(element, goog.a11y.aria.State.LABEL);\n};\n\n\n/**\n * Sets the label of the given element.\n * @param {!Element} element DOM node to set label to.\n * @param {string} label The label to set.\n */\ngoog.a11y.aria.setLabel = function(element, label) {\n  goog.a11y.aria.setState(element, goog.a11y.aria.State.LABEL, label);\n};\n\n\n/**\n * Asserts that the element has a role set if it's not an HTML element whose\n * semantics is well supported by most screen readers.\n * Only to be used internally by the ARIA library in goog.a11y.aria.*.\n * @param {!Element} element The element to assert an ARIA role set.\n * @param {!IArrayLike<string>} allowedRoles The child roles of\n * the roles.\n */\ngoog.a11y.aria.assertRoleIsSetInternalUtil = function(element, allowedRoles) {\n  if (goog.a11y.aria.TAGS_WITH_ASSUMED_ROLES_[element.tagName]) {\n    return;\n  }\n  var elementRole = /** @type {string}*/ (goog.a11y.aria.getRole(element));\n  goog.asserts.assert(\n      elementRole != null, 'The element ARIA role cannot be null.');\n\n  goog.asserts.assert(\n      goog.array.contains(allowedRoles, elementRole),\n      'Non existing or incorrect role set for element.' +\n          'The role set is \"' + elementRole + '\". The role should be any of \"' +\n          allowedRoles + '\". Check the ARIA specification for more details ' +\n          'http://www.w3.org/TR/wai-aria/roles.');\n};\n\n\n/**\n * Gets the boolean value of an ARIA state/property.\n * @param {!Element} element The element to get the ARIA state for.\n * @param {!goog.a11y.aria.State|string} stateName the ARIA state name.\n * @return {?boolean} Boolean value for the ARIA state value or null if\n *     the state value is not 'true', not 'false', or not set.\n */\ngoog.a11y.aria.getStateBoolean = function(element, stateName) {\n  var attr =\n      /** @type {string|boolean} */ (\n          element.getAttribute(\n              goog.a11y.aria.getAriaAttributeName_(stateName)));\n  goog.asserts.assert(\n      goog.isBoolean(attr) || attr == null || attr == 'true' ||\n      attr == 'false');\n  if (attr == null) {\n    return attr;\n  }\n  return goog.isBoolean(attr) ? attr : attr == 'true';\n};\n\n\n/**\n * Gets the number value of an ARIA state/property.\n * @param {!Element} element The element to get the ARIA state for.\n * @param {!goog.a11y.aria.State|string} stateName the ARIA state name.\n * @return {?number} Number value for the ARIA state value or null if\n *     the state value is not a number or not set.\n */\ngoog.a11y.aria.getStateNumber = function(element, stateName) {\n  var attr =\n      /** @type {string|number} */ (\n          element.getAttribute(\n              goog.a11y.aria.getAriaAttributeName_(stateName)));\n  goog.asserts.assert(\n      (attr == null || !isNaN(Number(attr))) && !goog.isBoolean(attr));\n  return attr == null ? null : Number(attr);\n};\n\n\n/**\n * Gets the string value of an ARIA state/property.\n * @param {!Element} element The element to get the ARIA state for.\n * @param {!goog.a11y.aria.State|string} stateName the ARIA state name.\n * @return {?string} String value for the ARIA state value or null if\n *     the state value is empty string or not set.\n */\ngoog.a11y.aria.getStateString = function(element, stateName) {\n  var attr =\n      element.getAttribute(goog.a11y.aria.getAriaAttributeName_(stateName));\n  goog.asserts.assert(\n      (attr == null || goog.isString(attr)) &&\n      (attr == '' || isNaN(Number(attr))) && attr != 'true' && attr != 'false');\n  return (attr == null || attr == '') ? null : attr;\n};\n\n\n/**\n * Gets array of strings value of the specified state or\n * property for the element.\n * Only to be used internally by the ARIA library in goog.a11y.aria.*.\n * @param {!Element} element DOM node to get state from.\n * @param {!goog.a11y.aria.State} stateName State name.\n * @return {!IArrayLike<string>} string Array\n *     value of the state attribute.\n */\ngoog.a11y.aria.getStringArrayStateInternalUtil = function(element, stateName) {\n  var attrValue =\n      element.getAttribute(goog.a11y.aria.getAriaAttributeName_(stateName));\n  return goog.a11y.aria.splitStringOnWhitespace_(attrValue);\n};\n\n\n/**\n * Returns true if element has an ARIA state/property, false otherwise.\n * @param {!Element} element The element to get the ARIA state for.\n * @param {!goog.a11y.aria.State|string} stateName the ARIA state name.\n * @return {boolean}\n */\ngoog.a11y.aria.hasState = function(element, stateName) {\n  return element.hasAttribute(goog.a11y.aria.getAriaAttributeName_(stateName));\n};\n\n\n/**\n * Returns whether the element has a container ARIA role.\n * Container roles are ARIA roles that use the aria-activedescendant property\n * to manage their active descendants or children. See\n * {@link http://www.w3.org/TR/wai-aria/states_and_properties\n * #aria-activedescendant} for more information.\n * @param {!Element} element\n * @return {boolean}\n */\ngoog.a11y.aria.isContainerRole = function(element) {\n  var role = goog.a11y.aria.getRole(element);\n  return goog.array.contains(goog.a11y.aria.CONTAINER_ROLES_, role);\n};\n\n\n/**\n * Splits the input stringValue on whitespace.\n * @param {string} stringValue The value of the string to split.\n * @return {!IArrayLike<string>} string Array\n *     value as result of the split.\n * @private\n */\ngoog.a11y.aria.splitStringOnWhitespace_ = function(stringValue) {\n  return stringValue ? stringValue.split(/\\s+/) : [];\n};\n\n\n/**\n * Adds the 'aria-' prefix to ariaName.\n * @param {string} ariaName ARIA state/property name.\n * @private\n * @return {string} The ARIA attribute name with added 'aria-' prefix.\n * @throws {Error} If no such attribute exists.\n */\ngoog.a11y.aria.getAriaAttributeName_ = function(ariaName) {\n  if (goog.asserts.ENABLE_ASSERTS) {\n    goog.asserts.assert(ariaName, 'ARIA attribute cannot be empty.');\n    goog.asserts.assert(\n        goog.object.containsValue(goog.a11y.aria.State, ariaName),\n        'No such ARIA attribute ' + ariaName);\n  }\n  return goog.a11y.aria.ARIA_PREFIX_ + ariaName;\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Constant declarations for common key codes.\n *\n * @author eae@google.com (Emil A Eklund)\n * @see ../demos/keyhandler.html\n */\n\ngoog.provide('goog.events.KeyCodes');\n\ngoog.require('goog.userAgent');\n\ngoog.forwardDeclare('goog.events.BrowserEvent');\n\n\n/**\n * Key codes for common characters.\n *\n * This list is not localized and therefore some of the key codes are not\n * correct for non US keyboard layouts. See comments below.\n *\n * @enum {number}\n */\ngoog.events.KeyCodes = {\n  WIN_KEY_FF_LINUX: 0,\n  MAC_ENTER: 3,\n  BACKSPACE: 8,\n  TAB: 9,\n  NUM_CENTER: 12,  // NUMLOCK on FF/Safari Mac\n  ENTER: 13,\n  SHIFT: 16,\n  CTRL: 17,\n  ALT: 18,\n  PAUSE: 19,\n  CAPS_LOCK: 20,\n  ESC: 27,\n  SPACE: 32,\n  PAGE_UP: 33,    // also NUM_NORTH_EAST\n  PAGE_DOWN: 34,  // also NUM_SOUTH_EAST\n  END: 35,        // also NUM_SOUTH_WEST\n  HOME: 36,       // also NUM_NORTH_WEST\n  LEFT: 37,       // also NUM_WEST\n  UP: 38,         // also NUM_NORTH\n  RIGHT: 39,      // also NUM_EAST\n  DOWN: 40,       // also NUM_SOUTH\n  PLUS_SIGN: 43,  // NOT numpad plus\n  PRINT_SCREEN: 44,\n  INSERT: 45,  // also NUM_INSERT\n  DELETE: 46,  // also NUM_DELETE\n  ZERO: 48,\n  ONE: 49,\n  TWO: 50,\n  THREE: 51,\n  FOUR: 52,\n  FIVE: 53,\n  SIX: 54,\n  SEVEN: 55,\n  EIGHT: 56,\n  NINE: 57,\n  FF_SEMICOLON: 59,   // Firefox (Gecko) fires this for semicolon instead of 186\n  FF_EQUALS: 61,      // Firefox (Gecko) fires this for equals instead of 187\n  FF_DASH: 173,       // Firefox (Gecko) fires this for dash instead of 189\n  QUESTION_MARK: 63,  // needs localization\n  AT_SIGN: 64,\n  A: 65,\n  B: 66,\n  C: 67,\n  D: 68,\n  E: 69,\n  F: 70,\n  G: 71,\n  H: 72,\n  I: 73,\n  J: 74,\n  K: 75,\n  L: 76,\n  M: 77,\n  N: 78,\n  O: 79,\n  P: 80,\n  Q: 81,\n  R: 82,\n  S: 83,\n  T: 84,\n  U: 85,\n  V: 86,\n  W: 87,\n  X: 88,\n  Y: 89,\n  Z: 90,\n  META: 91,  // WIN_KEY_LEFT\n  WIN_KEY_RIGHT: 92,\n  CONTEXT_MENU: 93,\n  NUM_ZERO: 96,\n  NUM_ONE: 97,\n  NUM_TWO: 98,\n  NUM_THREE: 99,\n  NUM_FOUR: 100,\n  NUM_FIVE: 101,\n  NUM_SIX: 102,\n  NUM_SEVEN: 103,\n  NUM_EIGHT: 104,\n  NUM_NINE: 105,\n  NUM_MULTIPLY: 106,\n  NUM_PLUS: 107,\n  NUM_MINUS: 109,\n  NUM_PERIOD: 110,\n  NUM_DIVISION: 111,\n  F1: 112,\n  F2: 113,\n  F3: 114,\n  F4: 115,\n  F5: 116,\n  F6: 117,\n  F7: 118,\n  F8: 119,\n  F9: 120,\n  F10: 121,\n  F11: 122,\n  F12: 123,\n  NUMLOCK: 144,\n  SCROLL_LOCK: 145,\n\n  // OS-specific media keys like volume controls and browser controls.\n  FIRST_MEDIA_KEY: 166,\n  LAST_MEDIA_KEY: 183,\n\n  SEMICOLON: 186,             // needs localization\n  DASH: 189,                  // needs localization\n  EQUALS: 187,                // needs localization\n  COMMA: 188,                 // needs localization\n  PERIOD: 190,                // needs localization\n  SLASH: 191,                 // needs localization\n  APOSTROPHE: 192,            // needs localization\n  TILDE: 192,                 // needs localization\n  SINGLE_QUOTE: 222,          // needs localization\n  OPEN_SQUARE_BRACKET: 219,   // needs localization\n  BACKSLASH: 220,             // needs localization\n  CLOSE_SQUARE_BRACKET: 221,  // needs localization\n  WIN_KEY: 224,\n  MAC_FF_META:\n      224,  // Firefox (Gecko) fires this for the meta key instead of 91\n  MAC_WK_CMD_LEFT: 91,   // WebKit Left Command key fired, same as META\n  MAC_WK_CMD_RIGHT: 93,  // WebKit Right Command key fired, different from META\n  WIN_IME: 229,\n\n  // \"Reserved for future use\". Some programs (e.g. the SlingPlayer 2.4 ActiveX\n  // control) fire this as a hacky way to disable screensavers.\n  VK_NONAME: 252,\n\n  // We've seen users whose machines fire this keycode at regular one\n  // second intervals. The common thread among these users is that\n  // they're all using Dell Inspiron laptops, so we suspect that this\n  // indicates a hardware/bios problem.\n  // http://en.community.dell.com/support-forums/laptop/f/3518/p/19285957/19523128.aspx\n  PHANTOM: 255\n};\n\n\n/**\n * Returns true if the event contains a text modifying key.\n * @param {goog.events.BrowserEvent} e A key event.\n * @return {boolean} Whether it's a text modifying key.\n */\ngoog.events.KeyCodes.isTextModifyingKeyEvent = function(e) {\n  if (e.altKey && !e.ctrlKey || e.metaKey ||\n      // Function keys don't generate text\n      e.keyCode >= goog.events.KeyCodes.F1 &&\n          e.keyCode <= goog.events.KeyCodes.F12) {\n    return false;\n  }\n\n  // The following keys are quite harmless, even in combination with\n  // CTRL, ALT or SHIFT.\n  switch (e.keyCode) {\n    case goog.events.KeyCodes.ALT:\n    case goog.events.KeyCodes.CAPS_LOCK:\n    case goog.events.KeyCodes.CONTEXT_MENU:\n    case goog.events.KeyCodes.CTRL:\n    case goog.events.KeyCodes.DOWN:\n    case goog.events.KeyCodes.END:\n    case goog.events.KeyCodes.ESC:\n    case goog.events.KeyCodes.HOME:\n    case goog.events.KeyCodes.INSERT:\n    case goog.events.KeyCodes.LEFT:\n    case goog.events.KeyCodes.MAC_FF_META:\n    case goog.events.KeyCodes.META:\n    case goog.events.KeyCodes.NUMLOCK:\n    case goog.events.KeyCodes.NUM_CENTER:\n    case goog.events.KeyCodes.PAGE_DOWN:\n    case goog.events.KeyCodes.PAGE_UP:\n    case goog.events.KeyCodes.PAUSE:\n    case goog.events.KeyCodes.PHANTOM:\n    case goog.events.KeyCodes.PRINT_SCREEN:\n    case goog.events.KeyCodes.RIGHT:\n    case goog.events.KeyCodes.SCROLL_LOCK:\n    case goog.events.KeyCodes.SHIFT:\n    case goog.events.KeyCodes.UP:\n    case goog.events.KeyCodes.VK_NONAME:\n    case goog.events.KeyCodes.WIN_KEY:\n    case goog.events.KeyCodes.WIN_KEY_RIGHT:\n      return false;\n    case goog.events.KeyCodes.WIN_KEY_FF_LINUX:\n      return !goog.userAgent.GECKO;\n    default:\n      return e.keyCode < goog.events.KeyCodes.FIRST_MEDIA_KEY ||\n          e.keyCode > goog.events.KeyCodes.LAST_MEDIA_KEY;\n  }\n};\n\n\n/**\n * Returns true if the key fires a keypress event in the current browser.\n *\n * Accoridng to MSDN [1] IE only fires keypress events for the following keys:\n * - Letters: A - Z (uppercase and lowercase)\n * - Numerals: 0 - 9\n * - Symbols: ! @ # $ % ^ & * ( ) _ - + = < [ ] { } , . / ? \\ | ' ` \" ~\n * - System: ESC, SPACEBAR, ENTER\n *\n * That's not entirely correct though, for instance there's no distinction\n * between upper and lower case letters.\n *\n * [1] http://msdn2.microsoft.com/en-us/library/ms536939(VS.85).aspx)\n *\n * Safari is similar to IE, but does not fire keypress for ESC.\n *\n * Additionally, IE6 does not fire keydown or keypress events for letters when\n * the control or alt keys are held down and the shift key is not. IE7 does\n * fire keydown in these cases, though, but not keypress.\n *\n * @param {number} keyCode A key code.\n * @param {number=} opt_heldKeyCode Key code of a currently-held key.\n * @param {boolean=} opt_shiftKey Whether the shift key is held down.\n * @param {boolean=} opt_ctrlKey Whether the control key is held down.\n * @param {boolean=} opt_altKey Whether the alt key is held down.\n * @param {boolean=} opt_metaKey Whether the meta key is held down.\n * @return {boolean} Whether it's a key that fires a keypress event.\n */\ngoog.events.KeyCodes.firesKeyPressEvent = function(\n    keyCode, opt_heldKeyCode, opt_shiftKey, opt_ctrlKey, opt_altKey,\n    opt_metaKey) {\n  if (!goog.userAgent.IE && !goog.userAgent.EDGE &&\n      !(goog.userAgent.WEBKIT && goog.userAgent.isVersionOrHigher('525'))) {\n    return true;\n  }\n\n  if (goog.userAgent.MAC && opt_altKey) {\n    return goog.events.KeyCodes.isCharacterKey(keyCode);\n  }\n\n  // Alt but not AltGr which is represented as Alt+Ctrl.\n  if (opt_altKey && !opt_ctrlKey) {\n    return false;\n  }\n\n  // Saves Ctrl or Alt + key for IE and WebKit 525+, which won't fire keypress.\n  // Non-IE browsers and WebKit prior to 525 won't get this far so no need to\n  // check the user agent.\n  if (goog.isNumber(opt_heldKeyCode)) {\n    opt_heldKeyCode = goog.events.KeyCodes.normalizeKeyCode(opt_heldKeyCode);\n  }\n  var heldKeyIsModifier = opt_heldKeyCode == goog.events.KeyCodes.CTRL ||\n      opt_heldKeyCode == goog.events.KeyCodes.ALT ||\n      goog.userAgent.MAC && opt_heldKeyCode == goog.events.KeyCodes.META;\n  // The Shift key blocks keypresses on Mac iff accompanied by another modifier.\n  var modifiedShiftKey = opt_heldKeyCode == goog.events.KeyCodes.SHIFT &&\n      (opt_ctrlKey || opt_metaKey);\n  if ((!opt_shiftKey || goog.userAgent.MAC) && heldKeyIsModifier ||\n      goog.userAgent.MAC && modifiedShiftKey) {\n    return false;\n  }\n\n  // Some keys with Ctrl/Shift do not issue keypress in WEBKIT.\n  if ((goog.userAgent.WEBKIT || goog.userAgent.EDGE) && opt_ctrlKey &&\n      opt_shiftKey) {\n    switch (keyCode) {\n      case goog.events.KeyCodes.BACKSLASH:\n      case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:\n      case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:\n      case goog.events.KeyCodes.TILDE:\n      case goog.events.KeyCodes.SEMICOLON:\n      case goog.events.KeyCodes.DASH:\n      case goog.events.KeyCodes.EQUALS:\n      case goog.events.KeyCodes.COMMA:\n      case goog.events.KeyCodes.PERIOD:\n      case goog.events.KeyCodes.SLASH:\n      case goog.events.KeyCodes.APOSTROPHE:\n      case goog.events.KeyCodes.SINGLE_QUOTE:\n        return false;\n    }\n  }\n\n  // When Ctrl+<somekey> is held in IE, it only fires a keypress once, but it\n  // continues to fire keydown events as the event repeats.\n  if (goog.userAgent.IE && opt_ctrlKey && opt_heldKeyCode == keyCode) {\n    return false;\n  }\n\n  switch (keyCode) {\n    case goog.events.KeyCodes.ENTER:\n      return true;\n    case goog.events.KeyCodes.ESC:\n      return !(goog.userAgent.WEBKIT || goog.userAgent.EDGE);\n  }\n\n  return goog.events.KeyCodes.isCharacterKey(keyCode);\n};\n\n\n/**\n * Returns true if the key produces a character.\n * This does not cover characters on non-US keyboards (Russian, Hebrew, etc.).\n *\n * @param {number} keyCode A key code.\n * @return {boolean} Whether it's a character key.\n */\ngoog.events.KeyCodes.isCharacterKey = function(keyCode) {\n  if (keyCode >= goog.events.KeyCodes.ZERO &&\n      keyCode <= goog.events.KeyCodes.NINE) {\n    return true;\n  }\n\n  if (keyCode >= goog.events.KeyCodes.NUM_ZERO &&\n      keyCode <= goog.events.KeyCodes.NUM_MULTIPLY) {\n    return true;\n  }\n\n  if (keyCode >= goog.events.KeyCodes.A && keyCode <= goog.events.KeyCodes.Z) {\n    return true;\n  }\n\n  // Safari sends zero key code for non-latin characters.\n  if ((goog.userAgent.WEBKIT || goog.userAgent.EDGE) && keyCode == 0) {\n    return true;\n  }\n\n  switch (keyCode) {\n    case goog.events.KeyCodes.SPACE:\n    case goog.events.KeyCodes.PLUS_SIGN:\n    case goog.events.KeyCodes.QUESTION_MARK:\n    case goog.events.KeyCodes.AT_SIGN:\n    case goog.events.KeyCodes.NUM_PLUS:\n    case goog.events.KeyCodes.NUM_MINUS:\n    case goog.events.KeyCodes.NUM_PERIOD:\n    case goog.events.KeyCodes.NUM_DIVISION:\n    case goog.events.KeyCodes.SEMICOLON:\n    case goog.events.KeyCodes.FF_SEMICOLON:\n    case goog.events.KeyCodes.DASH:\n    case goog.events.KeyCodes.EQUALS:\n    case goog.events.KeyCodes.FF_EQUALS:\n    case goog.events.KeyCodes.COMMA:\n    case goog.events.KeyCodes.PERIOD:\n    case goog.events.KeyCodes.SLASH:\n    case goog.events.KeyCodes.APOSTROPHE:\n    case goog.events.KeyCodes.SINGLE_QUOTE:\n    case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:\n    case goog.events.KeyCodes.BACKSLASH:\n    case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:\n      return true;\n    default:\n      return false;\n  }\n};\n\n\n/**\n * Normalizes key codes from OS/Browser-specific value to the general one.\n * @param {number} keyCode The native key code.\n * @return {number} The normalized key code.\n */\ngoog.events.KeyCodes.normalizeKeyCode = function(keyCode) {\n  if (goog.userAgent.GECKO) {\n    return goog.events.KeyCodes.normalizeGeckoKeyCode(keyCode);\n  } else if (goog.userAgent.MAC && goog.userAgent.WEBKIT) {\n    return goog.events.KeyCodes.normalizeMacWebKitKeyCode(keyCode);\n  } else {\n    return keyCode;\n  }\n};\n\n\n/**\n * Normalizes key codes from their Gecko-specific value to the general one.\n * @param {number} keyCode The native key code.\n * @return {number} The normalized key code.\n */\ngoog.events.KeyCodes.normalizeGeckoKeyCode = function(keyCode) {\n  switch (keyCode) {\n    case goog.events.KeyCodes.FF_EQUALS:\n      return goog.events.KeyCodes.EQUALS;\n    case goog.events.KeyCodes.FF_SEMICOLON:\n      return goog.events.KeyCodes.SEMICOLON;\n    case goog.events.KeyCodes.FF_DASH:\n      return goog.events.KeyCodes.DASH;\n    case goog.events.KeyCodes.MAC_FF_META:\n      return goog.events.KeyCodes.META;\n    case goog.events.KeyCodes.WIN_KEY_FF_LINUX:\n      return goog.events.KeyCodes.WIN_KEY;\n    default:\n      return keyCode;\n  }\n};\n\n\n/**\n * Normalizes key codes from their Mac WebKit-specific value to the general one.\n * @param {number} keyCode The native key code.\n * @return {number} The normalized key code.\n */\ngoog.events.KeyCodes.normalizeMacWebKitKeyCode = function(keyCode) {\n  switch (keyCode) {\n    case goog.events.KeyCodes.MAC_WK_CMD_RIGHT:  // 93\n      return goog.events.KeyCodes.META;          // 91\n    default:\n      return keyCode;\n  }\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview This file contains a class for working with keyboard events\n * that repeat consistently across browsers and platforms. It also unifies the\n * key code so that it is the same in all browsers and platforms.\n *\n * Different web browsers have very different keyboard event handling. Most\n * importantly is that only certain browsers repeat keydown events:\n * IE, Opera, FF/Win32, and Safari 3 repeat keydown events.\n * FF/Mac and Safari 2 do not.\n *\n * For the purposes of this code, \"Safari 3\" means WebKit 525+, when WebKit\n * decided that they should try to match IE's key handling behavior.\n * Safari 3.0.4, which shipped with Leopard (WebKit 523), has the\n * Safari 2 behavior.\n *\n * Firefox, Safari, Opera prevent on keypress\n *\n * IE prevents on keydown\n *\n * Firefox does not fire keypress for shift, ctrl, alt\n * Firefox does fire keydown for shift, ctrl, alt, meta\n * Firefox does not repeat keydown for shift, ctrl, alt, meta\n *\n * Firefox does not fire keypress for up and down in an input\n *\n * Opera fires keypress for shift, ctrl, alt, meta\n * Opera does not repeat keypress for shift, ctrl, alt, meta\n *\n * Safari 2 and 3 do not fire keypress for shift, ctrl, alt\n * Safari 2 does not fire keydown for shift, ctrl, alt\n * Safari 3 *does* fire keydown for shift, ctrl, alt\n *\n * IE provides the keycode for keyup/down events and the charcode (in the\n * keycode field) for keypress.\n *\n * Mozilla provides the keycode for keyup/down and the charcode for keypress\n * unless it's a non text modifying key in which case the keycode is provided.\n *\n * Safari 3 provides the keycode and charcode for all events.\n *\n * Opera provides the keycode for keyup/down event and either the charcode or\n * the keycode (in the keycode field) for keypress events.\n *\n * Firefox x11 doesn't fire keydown events if a another key is already held down\n * until the first key is released. This can cause a key event to be fired with\n * a keyCode for the first key and a charCode for the second key.\n *\n * Safari in keypress\n *\n *        charCode keyCode which\n * ENTER:       13      13    13\n * F1:       63236   63236 63236\n * F8:       63243   63243 63243\n * ...\n * p:          112     112   112\n * P:           80      80    80\n *\n * Firefox, keypress:\n *\n *        charCode keyCode which\n * ENTER:        0      13    13\n * F1:           0     112     0\n * F8:           0     119     0\n * ...\n * p:          112       0   112\n * P:           80       0    80\n *\n * Opera, Mac+Win32, keypress:\n *\n *         charCode keyCode which\n * ENTER: undefined      13    13\n * F1:    undefined     112     0\n * F8:    undefined     119     0\n * ...\n * p:     undefined     112   112\n * P:     undefined      80    80\n *\n * IE7, keydown\n *\n *         charCode keyCode     which\n * ENTER: undefined      13 undefined\n * F1:    undefined     112 undefined\n * F8:    undefined     119 undefined\n * ...\n * p:     undefined      80 undefined\n * P:     undefined      80 undefined\n *\n * @author arv@google.com (Erik Arvidsson)\n * @author eae@google.com (Emil A Eklund)\n * @see ../demos/keyhandler.html\n */\n\ngoog.provide('goog.events.KeyEvent');\ngoog.provide('goog.events.KeyHandler');\ngoog.provide('goog.events.KeyHandler.EventType');\n\ngoog.require('goog.events');\ngoog.require('goog.events.BrowserEvent');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.events.EventType');\ngoog.require('goog.events.KeyCodes');\ngoog.require('goog.userAgent');\n\n\n\n/**\n * A wrapper around an element that you want to listen to keyboard events on.\n * @param {Element|Document=} opt_element The element or document to listen on.\n * @param {boolean=} opt_capture Whether to listen for browser events in\n *     capture phase (defaults to false).\n * @constructor\n * @extends {goog.events.EventTarget}\n * @final\n */\ngoog.events.KeyHandler = function(opt_element, opt_capture) {\n  goog.events.EventTarget.call(this);\n\n  if (opt_element) {\n    this.attach(opt_element, opt_capture);\n  }\n};\ngoog.inherits(goog.events.KeyHandler, goog.events.EventTarget);\n\n\n/**\n * This is the element that we will listen to the real keyboard events on.\n * @type {Element|Document|null}\n * @private\n */\ngoog.events.KeyHandler.prototype.element_ = null;\n\n\n/**\n * The key for the key press listener.\n * @type {goog.events.Key}\n * @private\n */\ngoog.events.KeyHandler.prototype.keyPressKey_ = null;\n\n\n/**\n * The key for the key down listener.\n * @type {goog.events.Key}\n * @private\n */\ngoog.events.KeyHandler.prototype.keyDownKey_ = null;\n\n\n/**\n * The key for the key up listener.\n * @type {goog.events.Key}\n * @private\n */\ngoog.events.KeyHandler.prototype.keyUpKey_ = null;\n\n\n/**\n * Used to detect keyboard repeat events.\n * @private\n * @type {number}\n */\ngoog.events.KeyHandler.prototype.lastKey_ = -1;\n\n\n/**\n * Keycode recorded for key down events. As most browsers don't report the\n * keycode in the key press event we need to record it in the key down phase.\n * @private\n * @type {number}\n */\ngoog.events.KeyHandler.prototype.keyCode_ = -1;\n\n\n/**\n * Alt key recorded for key down events. FF on Mac does not report the alt key\n * flag in the key press event, we need to record it in the key down phase.\n * @type {boolean}\n * @private\n */\ngoog.events.KeyHandler.prototype.altKey_ = false;\n\n\n/**\n * Enum type for the events fired by the key handler\n * @enum {string}\n */\ngoog.events.KeyHandler.EventType = {\n  KEY: 'key'\n};\n\n\n/**\n * An enumeration of key codes that Safari 2 does incorrectly\n * @type {Object}\n * @private\n */\ngoog.events.KeyHandler.safariKey_ = {\n  '3': goog.events.KeyCodes.ENTER,             // 13\n  '12': goog.events.KeyCodes.NUMLOCK,          // 144\n  '63232': goog.events.KeyCodes.UP,            // 38\n  '63233': goog.events.KeyCodes.DOWN,          // 40\n  '63234': goog.events.KeyCodes.LEFT,          // 37\n  '63235': goog.events.KeyCodes.RIGHT,         // 39\n  '63236': goog.events.KeyCodes.F1,            // 112\n  '63237': goog.events.KeyCodes.F2,            // 113\n  '63238': goog.events.KeyCodes.F3,            // 114\n  '63239': goog.events.KeyCodes.F4,            // 115\n  '63240': goog.events.KeyCodes.F5,            // 116\n  '63241': goog.events.KeyCodes.F6,            // 117\n  '63242': goog.events.KeyCodes.F7,            // 118\n  '63243': goog.events.KeyCodes.F8,            // 119\n  '63244': goog.events.KeyCodes.F9,            // 120\n  '63245': goog.events.KeyCodes.F10,           // 121\n  '63246': goog.events.KeyCodes.F11,           // 122\n  '63247': goog.events.KeyCodes.F12,           // 123\n  '63248': goog.events.KeyCodes.PRINT_SCREEN,  // 44\n  '63272': goog.events.KeyCodes.DELETE,        // 46\n  '63273': goog.events.KeyCodes.HOME,          // 36\n  '63275': goog.events.KeyCodes.END,           // 35\n  '63276': goog.events.KeyCodes.PAGE_UP,       // 33\n  '63277': goog.events.KeyCodes.PAGE_DOWN,     // 34\n  '63289': goog.events.KeyCodes.NUMLOCK,       // 144\n  '63302': goog.events.KeyCodes.INSERT         // 45\n};\n\n\n/**\n * An enumeration of key identifiers currently part of the W3C draft for DOM3\n * and their mappings to keyCodes.\n * http://www.w3.org/TR/DOM-Level-3-Events/keyset.html#KeySet-Set\n * This is currently supported in Safari and should be platform independent.\n * @type {Object}\n * @private\n */\ngoog.events.KeyHandler.keyIdentifier_ = {\n  'Up': goog.events.KeyCodes.UP,               // 38\n  'Down': goog.events.KeyCodes.DOWN,           // 40\n  'Left': goog.events.KeyCodes.LEFT,           // 37\n  'Right': goog.events.KeyCodes.RIGHT,         // 39\n  'Enter': goog.events.KeyCodes.ENTER,         // 13\n  'F1': goog.events.KeyCodes.F1,               // 112\n  'F2': goog.events.KeyCodes.F2,               // 113\n  'F3': goog.events.KeyCodes.F3,               // 114\n  'F4': goog.events.KeyCodes.F4,               // 115\n  'F5': goog.events.KeyCodes.F5,               // 116\n  'F6': goog.events.KeyCodes.F6,               // 117\n  'F7': goog.events.KeyCodes.F7,               // 118\n  'F8': goog.events.KeyCodes.F8,               // 119\n  'F9': goog.events.KeyCodes.F9,               // 120\n  'F10': goog.events.KeyCodes.F10,             // 121\n  'F11': goog.events.KeyCodes.F11,             // 122\n  'F12': goog.events.KeyCodes.F12,             // 123\n  'U+007F': goog.events.KeyCodes.DELETE,       // 46\n  'Home': goog.events.KeyCodes.HOME,           // 36\n  'End': goog.events.KeyCodes.END,             // 35\n  'PageUp': goog.events.KeyCodes.PAGE_UP,      // 33\n  'PageDown': goog.events.KeyCodes.PAGE_DOWN,  // 34\n  'Insert': goog.events.KeyCodes.INSERT        // 45\n};\n\n\n/**\n * If true, the KeyEvent fires on keydown. Otherwise, it fires on keypress.\n *\n * @type {boolean}\n * @private\n */\ngoog.events.KeyHandler.USES_KEYDOWN_ = goog.userAgent.IE ||\n    goog.userAgent.EDGE ||\n    goog.userAgent.WEBKIT && goog.userAgent.isVersionOrHigher('525');\n\n\n/**\n * If true, the alt key flag is saved during the key down and reused when\n * handling the key press. FF on Mac does not set the alt flag in the key press\n * event.\n * @type {boolean}\n * @private\n */\ngoog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_ =\n    goog.userAgent.MAC && goog.userAgent.GECKO;\n\n\n/**\n * Records the keycode for browsers that only returns the keycode for key up/\n * down events. For browser/key combinations that doesn't trigger a key pressed\n * event it also fires the patched key event.\n * @param {goog.events.BrowserEvent} e The key down event.\n * @private\n */\ngoog.events.KeyHandler.prototype.handleKeyDown_ = function(e) {\n  // Ctrl-Tab and Alt-Tab can cause the focus to be moved to another window\n  // before we've caught a key-up event.  If the last-key was one of these we\n  // reset the state.\n  if (goog.userAgent.WEBKIT || goog.userAgent.EDGE) {\n    if (this.lastKey_ == goog.events.KeyCodes.CTRL && !e.ctrlKey ||\n        this.lastKey_ == goog.events.KeyCodes.ALT && !e.altKey ||\n        goog.userAgent.MAC && this.lastKey_ == goog.events.KeyCodes.META &&\n            !e.metaKey) {\n      this.resetState();\n    }\n  }\n\n  if (this.lastKey_ == -1) {\n    if (e.ctrlKey && e.keyCode != goog.events.KeyCodes.CTRL) {\n      this.lastKey_ = goog.events.KeyCodes.CTRL;\n    } else if (e.altKey && e.keyCode != goog.events.KeyCodes.ALT) {\n      this.lastKey_ = goog.events.KeyCodes.ALT;\n    } else if (e.metaKey && e.keyCode != goog.events.KeyCodes.META) {\n      this.lastKey_ = goog.events.KeyCodes.META;\n    }\n  }\n\n  if (goog.events.KeyHandler.USES_KEYDOWN_ &&\n      !goog.events.KeyCodes.firesKeyPressEvent(\n          e.keyCode, this.lastKey_, e.shiftKey, e.ctrlKey, e.altKey,\n          e.metaKey)) {\n    this.handleEvent(e);\n  } else {\n    this.keyCode_ = goog.events.KeyCodes.normalizeKeyCode(e.keyCode);\n    if (goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_) {\n      this.altKey_ = e.altKey;\n    }\n  }\n};\n\n\n/**\n * Resets the stored previous values. Needed to be called for webkit which will\n * not generate a key up for meta key operations. This should only be called\n * when having finished with repeat key possibilities.\n */\ngoog.events.KeyHandler.prototype.resetState = function() {\n  this.lastKey_ = -1;\n  this.keyCode_ = -1;\n};\n\n\n/**\n * Clears the stored previous key value, resetting the key repeat status. Uses\n * -1 because the Safari 3 Windows beta reports 0 for certain keys (like Home\n * and End.)\n * @param {goog.events.BrowserEvent} e The keyup event.\n * @private\n */\ngoog.events.KeyHandler.prototype.handleKeyup_ = function(e) {\n  this.resetState();\n  this.altKey_ = e.altKey;\n};\n\n\n/**\n * Handles the events on the element.\n * @param {goog.events.BrowserEvent} e  The keyboard event sent from the\n *     browser.\n */\ngoog.events.KeyHandler.prototype.handleEvent = function(e) {\n  var be = e.getBrowserEvent();\n  var keyCode, charCode;\n  var altKey = be.altKey;\n\n  // IE reports the character code in the keyCode field for keypress events.\n  // There are two exceptions however, Enter and Escape.\n  if (goog.userAgent.IE && e.type == goog.events.EventType.KEYPRESS) {\n    keyCode = this.keyCode_;\n    charCode = keyCode != goog.events.KeyCodes.ENTER &&\n            keyCode != goog.events.KeyCodes.ESC ?\n        be.keyCode :\n        0;\n\n    // Safari reports the character code in the keyCode field for keypress\n    // events but also has a charCode field.\n  } else if (\n      (goog.userAgent.WEBKIT || goog.userAgent.EDGE) &&\n      e.type == goog.events.EventType.KEYPRESS) {\n    keyCode = this.keyCode_;\n    charCode = be.charCode >= 0 && be.charCode < 63232 &&\n            goog.events.KeyCodes.isCharacterKey(keyCode) ?\n        be.charCode :\n        0;\n\n    // Opera reports the keycode or the character code in the keyCode field.\n  } else if (goog.userAgent.OPERA && !goog.userAgent.WEBKIT) {\n    keyCode = this.keyCode_;\n    charCode = goog.events.KeyCodes.isCharacterKey(keyCode) ? be.keyCode : 0;\n\n    // Mozilla reports the character code in the charCode field.\n  } else {\n    keyCode = be.keyCode || this.keyCode_;\n    charCode = be.charCode || 0;\n    if (goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_) {\n      altKey = this.altKey_;\n    }\n    // On the Mac, shift-/ triggers a question mark char code and no key code\n    // (normalized to WIN_KEY), so we synthesize the latter.\n    if (goog.userAgent.MAC && charCode == goog.events.KeyCodes.QUESTION_MARK &&\n        keyCode == goog.events.KeyCodes.WIN_KEY) {\n      keyCode = goog.events.KeyCodes.SLASH;\n    }\n  }\n\n  keyCode = goog.events.KeyCodes.normalizeKeyCode(keyCode);\n  var key = keyCode;\n\n  // Correct the key value for certain browser-specific quirks.\n  if (keyCode) {\n    if (keyCode >= 63232 && keyCode in goog.events.KeyHandler.safariKey_) {\n      // NOTE(nicksantos): Safari 3 has fixed this problem,\n      // this is only needed for Safari 2.\n      key = goog.events.KeyHandler.safariKey_[keyCode];\n    } else {\n      // Safari returns 25 for Shift+Tab instead of 9.\n      if (keyCode == 25 && e.shiftKey) {\n        key = 9;\n      }\n    }\n  } else if (\n      be.keyIdentifier &&\n      be.keyIdentifier in goog.events.KeyHandler.keyIdentifier_) {\n    // This is needed for Safari Windows because it currently doesn't give a\n    // keyCode/which for non printable keys.\n    key = goog.events.KeyHandler.keyIdentifier_[be.keyIdentifier];\n  }\n\n  // If we get the same keycode as a keydown/keypress without having seen a\n  // keyup event, then this event was caused by key repeat.\n  var repeat = key == this.lastKey_;\n  this.lastKey_ = key;\n\n  var event = new goog.events.KeyEvent(key, charCode, repeat, be);\n  event.altKey = altKey;\n  this.dispatchEvent(event);\n};\n\n\n/**\n * Returns the element listened on for the real keyboard events.\n * @return {Element|Document|null} The element listened on for the real\n *     keyboard events.\n */\ngoog.events.KeyHandler.prototype.getElement = function() {\n  return this.element_;\n};\n\n\n/**\n * Adds the proper key event listeners to the element.\n * @param {Element|Document} element The element to listen on.\n * @param {boolean=} opt_capture Whether to listen for browser events in\n *     capture phase (defaults to false).\n */\ngoog.events.KeyHandler.prototype.attach = function(element, opt_capture) {\n  if (this.keyUpKey_) {\n    this.detach();\n  }\n\n  this.element_ = element;\n\n  this.keyPressKey_ = goog.events.listen(\n      this.element_, goog.events.EventType.KEYPRESS, this, opt_capture);\n\n  // Most browsers (Safari 2 being the notable exception) doesn't include the\n  // keyCode in keypress events (IE has the char code in the keyCode field and\n  // Mozilla only included the keyCode if there's no charCode). Thus we have to\n  // listen for keydown to capture the keycode.\n  this.keyDownKey_ = goog.events.listen(\n      this.element_, goog.events.EventType.KEYDOWN, this.handleKeyDown_,\n      opt_capture, this);\n\n\n  this.keyUpKey_ = goog.events.listen(\n      this.element_, goog.events.EventType.KEYUP, this.handleKeyup_,\n      opt_capture, this);\n};\n\n\n/**\n * Removes the listeners that may exist.\n */\ngoog.events.KeyHandler.prototype.detach = function() {\n  if (this.keyPressKey_) {\n    goog.events.unlistenByKey(this.keyPressKey_);\n    goog.events.unlistenByKey(this.keyDownKey_);\n    goog.events.unlistenByKey(this.keyUpKey_);\n    this.keyPressKey_ = null;\n    this.keyDownKey_ = null;\n    this.keyUpKey_ = null;\n  }\n  this.element_ = null;\n  this.lastKey_ = -1;\n  this.keyCode_ = -1;\n};\n\n\n/** @override */\ngoog.events.KeyHandler.prototype.disposeInternal = function() {\n  goog.events.KeyHandler.superClass_.disposeInternal.call(this);\n  this.detach();\n};\n\n\n\n/**\n * This class is used for the goog.events.KeyHandler.EventType.KEY event and\n * it overrides the key code with the fixed key code.\n * @param {number} keyCode The adjusted key code.\n * @param {number} charCode The unicode character code.\n * @param {boolean} repeat Whether this event was generated by keyboard repeat.\n * @param {Event} browserEvent Browser event object.\n * @constructor\n * @extends {goog.events.BrowserEvent}\n * @final\n */\ngoog.events.KeyEvent = function(keyCode, charCode, repeat, browserEvent) {\n  goog.events.BrowserEvent.call(this, browserEvent);\n  this.type = goog.events.KeyHandler.EventType.KEY;\n\n  /**\n   * Keycode of key press.\n   * @type {number}\n   */\n  this.keyCode = keyCode;\n\n  /**\n   * Unicode character code.\n   * @type {number}\n   */\n  this.charCode = charCode;\n\n  /**\n   * True if this event was generated by keyboard auto-repeat (i.e., the user is\n   * holding the key down.)\n   * @type {boolean}\n   */\n  this.repeat = repeat;\n};\ngoog.inherits(goog.events.KeyEvent, goog.events.BrowserEvent);\n","// Copyright 2012 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for detecting, adding and removing classes.  Prefer\n * this over goog.dom.classes for new code since it attempts to use classList\n * (DOMTokenList: http://dom.spec.whatwg.org/#domtokenlist) which is faster\n * and requires less code.\n *\n * Note: these utilities are meant to operate on HTMLElements\n * and may have unexpected behavior on elements with differing interfaces\n * (such as SVGElements).\n */\n\n\ngoog.provide('goog.dom.classlist');\n\ngoog.require('goog.array');\n\n\n/**\n * Override this define at build-time if you know your target supports it.\n * @define {boolean} Whether to use the classList property (DOMTokenList).\n */\ngoog.define('goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST', false);\n\n\n/**\n * Gets an array-like object of class names on an element.\n * @param {Element} element DOM node to get the classes of.\n * @return {!IArrayLike<?>} Class names on {@code element}.\n */\ngoog.dom.classlist.get = function(element) {\n  if (goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST || element.classList) {\n    return element.classList;\n  }\n\n  var className = element.className;\n  // Some types of elements don't have a className in IE (e.g. iframes).\n  // Furthermore, in Firefox, className is not a string when the element is\n  // an SVG element.\n  return goog.isString(className) && className.match(/\\S+/g) || [];\n};\n\n\n/**\n * Sets the entire class name of an element.\n * @param {Element} element DOM node to set class of.\n * @param {string} className Class name(s) to apply to element.\n */\ngoog.dom.classlist.set = function(element, className) {\n  element.className = className;\n};\n\n\n/**\n * Returns true if an element has a class.  This method may throw a DOM\n * exception for an invalid or empty class name if DOMTokenList is used.\n * @param {Element} element DOM node to test.\n * @param {string} className Class name to test for.\n * @return {boolean} Whether element has the class.\n */\ngoog.dom.classlist.contains = function(element, className) {\n  if (goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST || element.classList) {\n    return element.classList.contains(className);\n  }\n  return goog.array.contains(goog.dom.classlist.get(element), className);\n};\n\n\n/**\n * Adds a class to an element.  Does not add multiples of class names.  This\n * method may throw a DOM exception for an invalid or empty class name if\n * DOMTokenList is used.\n * @param {Element} element DOM node to add class to.\n * @param {string} className Class name to add.\n */\ngoog.dom.classlist.add = function(element, className) {\n  if (goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST || element.classList) {\n    element.classList.add(className);\n    return;\n  }\n\n  if (!goog.dom.classlist.contains(element, className)) {\n    // Ensure we add a space if this is not the first class name added.\n    element.className +=\n        element.className.length > 0 ? (' ' + className) : className;\n  }\n};\n\n\n/**\n * Convenience method to add a number of class names at once.\n * @param {Element} element The element to which to add classes.\n * @param {IArrayLike<string>} classesToAdd An array-like object\n * containing a collection of class names to add to the element.\n * This method may throw a DOM exception if classesToAdd contains invalid\n * or empty class names.\n */\ngoog.dom.classlist.addAll = function(element, classesToAdd) {\n  if (goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST || element.classList) {\n    goog.array.forEach(classesToAdd, function(className) {\n      goog.dom.classlist.add(element, className);\n    });\n    return;\n  }\n\n  var classMap = {};\n\n  // Get all current class names into a map.\n  goog.array.forEach(goog.dom.classlist.get(element), function(className) {\n    classMap[className] = true;\n  });\n\n  // Add new class names to the map.\n  goog.array.forEach(\n      classesToAdd, function(className) { classMap[className] = true; });\n\n  // Flatten the keys of the map into the className.\n  element.className = '';\n  for (var className in classMap) {\n    element.className +=\n        element.className.length > 0 ? (' ' + className) : className;\n  }\n};\n\n\n/**\n * Removes a class from an element.  This method may throw a DOM exception\n * for an invalid or empty class name if DOMTokenList is used.\n * @param {Element} element DOM node to remove class from.\n * @param {string} className Class name to remove.\n */\ngoog.dom.classlist.remove = function(element, className) {\n  if (goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST || element.classList) {\n    element.classList.remove(className);\n    return;\n  }\n\n  if (goog.dom.classlist.contains(element, className)) {\n    // Filter out the class name.\n    element.className = goog.array\n                            .filter(\n                                goog.dom.classlist.get(element),\n                                function(c) { return c != className; })\n                            .join(' ');\n  }\n};\n\n\n/**\n * Removes a set of classes from an element.  Prefer this call to\n * repeatedly calling {@code goog.dom.classlist.remove} if you want to remove\n * a large set of class names at once.\n * @param {Element} element The element from which to remove classes.\n * @param {IArrayLike<string>} classesToRemove An array-like object\n * containing a collection of class names to remove from the element.\n * This method may throw a DOM exception if classesToRemove contains invalid\n * or empty class names.\n */\ngoog.dom.classlist.removeAll = function(element, classesToRemove) {\n  if (goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST || element.classList) {\n    goog.array.forEach(classesToRemove, function(className) {\n      goog.dom.classlist.remove(element, className);\n    });\n    return;\n  }\n  // Filter out those classes in classesToRemove.\n  element.className =\n      goog.array\n          .filter(\n              goog.dom.classlist.get(element),\n              function(className) {\n                // If this class is not one we are trying to remove,\n                // add it to the array of new class names.\n                return !goog.array.contains(classesToRemove, className);\n              })\n          .join(' ');\n};\n\n\n/**\n * Adds or removes a class depending on the enabled argument.  This method\n * may throw a DOM exception for an invalid or empty class name if DOMTokenList\n * is used.\n * @param {Element} element DOM node to add or remove the class on.\n * @param {string} className Class name to add or remove.\n * @param {boolean} enabled Whether to add or remove the class (true adds,\n *     false removes).\n */\ngoog.dom.classlist.enable = function(element, className, enabled) {\n  if (enabled) {\n    goog.dom.classlist.add(element, className);\n  } else {\n    goog.dom.classlist.remove(element, className);\n  }\n};\n\n\n/**\n * Adds or removes a set of classes depending on the enabled argument.  This\n * method may throw a DOM exception for an invalid or empty class name if\n * DOMTokenList is used.\n * @param {!Element} element DOM node to add or remove the class on.\n * @param {?IArrayLike<string>} classesToEnable An array-like object\n *     containing a collection of class names to add or remove from the element.\n * @param {boolean} enabled Whether to add or remove the classes (true adds,\n *     false removes).\n */\ngoog.dom.classlist.enableAll = function(element, classesToEnable, enabled) {\n  var f = enabled ? goog.dom.classlist.addAll : goog.dom.classlist.removeAll;\n  f(element, classesToEnable);\n};\n\n\n/**\n * Switches a class on an element from one to another without disturbing other\n * classes. If the fromClass isn't removed, the toClass won't be added.  This\n * method may throw a DOM exception if the class names are empty or invalid.\n * @param {Element} element DOM node to swap classes on.\n * @param {string} fromClass Class to remove.\n * @param {string} toClass Class to add.\n * @return {boolean} Whether classes were switched.\n */\ngoog.dom.classlist.swap = function(element, fromClass, toClass) {\n  if (goog.dom.classlist.contains(element, fromClass)) {\n    goog.dom.classlist.remove(element, fromClass);\n    goog.dom.classlist.add(element, toClass);\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Removes a class if an element has it, and adds it the element doesn't have\n * it.  Won't affect other classes on the node.  This method may throw a DOM\n * exception if the class name is empty or invalid.\n * @param {Element} element DOM node to toggle class on.\n * @param {string} className Class to toggle.\n * @return {boolean} True if class was added, false if it was removed\n *     (in other words, whether element has the class after this function has\n *     been called).\n */\ngoog.dom.classlist.toggle = function(element, className) {\n  var add = !goog.dom.classlist.contains(element, className);\n  goog.dom.classlist.enable(element, className, add);\n  return add;\n};\n\n\n/**\n * Adds and removes a class of an element.  Unlike\n * {@link goog.dom.classlist.swap}, this method adds the classToAdd regardless\n * of whether the classToRemove was present and had been removed.  This method\n * may throw a DOM exception if the class names are empty or invalid.\n *\n * @param {Element} element DOM node to swap classes on.\n * @param {string} classToRemove Class to remove.\n * @param {string} classToAdd Class to add.\n */\ngoog.dom.classlist.addRemove = function(element, classToRemove, classToAdd) {\n  goog.dom.classlist.remove(element, classToRemove);\n  goog.dom.classlist.add(element, classToAdd);\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Global renderer and decorator registry.\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.registry');\n\ngoog.require('goog.asserts');\ngoog.require('goog.dom.classlist');\n\n\n/**\n * Given a {@link goog.ui.Component} constructor, returns an instance of its\n * default renderer.  If the default renderer is a singleton, returns the\n * singleton instance; otherwise returns a new instance of the renderer class.\n * @param {Function} componentCtor Component constructor function (for example\n *     {@code goog.ui.Button}).\n * @return {goog.ui.ControlRenderer?} Renderer instance (for example the\n *     singleton instance of {@code goog.ui.ButtonRenderer}), or null if\n *     no default renderer was found.\n */\ngoog.ui.registry.getDefaultRenderer = function(componentCtor) {\n  // Locate the default renderer based on the constructor's unique ID.  If no\n  // renderer is registered for this class, walk up the superClass_ chain.\n  var key;\n  /** @type {Function|undefined} */ var rendererCtor;\n  while (componentCtor) {\n    key = goog.getUid(componentCtor);\n    if ((rendererCtor = goog.ui.registry.defaultRenderers_[key])) {\n      break;\n    }\n    componentCtor = componentCtor.superClass_ ?\n        componentCtor.superClass_.constructor :\n        null;\n  }\n\n  // If the renderer has a static getInstance method, return the singleton\n  // instance; otherwise create and return a new instance.\n  if (rendererCtor) {\n    return goog.isFunction(rendererCtor.getInstance) ?\n        rendererCtor.getInstance() :\n        new rendererCtor();\n  }\n\n  return null;\n};\n\n\n/**\n * Sets the default renderer for the given {@link goog.ui.Component}\n * constructor.\n * @param {Function} componentCtor Component constructor function (for example\n *     {@code goog.ui.Button}).\n * @param {Function} rendererCtor Renderer constructor function (for example\n *     {@code goog.ui.ButtonRenderer}).\n * @throws {Error} If the arguments aren't functions.\n */\ngoog.ui.registry.setDefaultRenderer = function(componentCtor, rendererCtor) {\n  // In this case, explicit validation has negligible overhead (since each\n  // renderer is only registered once), and helps catch subtle bugs.\n  if (!goog.isFunction(componentCtor)) {\n    throw Error('Invalid component class ' + componentCtor);\n  }\n  if (!goog.isFunction(rendererCtor)) {\n    throw Error('Invalid renderer class ' + rendererCtor);\n  }\n\n  // Map the component constructor's unique ID to the renderer constructor.\n  var key = goog.getUid(componentCtor);\n  goog.ui.registry.defaultRenderers_[key] = rendererCtor;\n};\n\n\n/**\n * Returns the {@link goog.ui.Component} instance created by the decorator\n * factory function registered for the given CSS class name, or null if no\n * decorator factory function was found.\n * @param {string} className CSS class name.\n * @return {goog.ui.Component?} Component instance.\n */\ngoog.ui.registry.getDecoratorByClassName = function(className) {\n  return className in goog.ui.registry.decoratorFunctions_ ?\n      goog.ui.registry.decoratorFunctions_[className]() :\n      null;\n};\n\n\n/**\n * Maps a CSS class name to a function that returns a new instance of\n * {@link goog.ui.Component} or a subclass, suitable to decorate an element\n * that has the specified CSS class.\n * @param {string} className CSS class name.\n * @param {Function} decoratorFn No-argument function that returns a new\n *     instance of a {@link goog.ui.Component} to decorate an element.\n * @throws {Error} If the class name or the decorator function is invalid.\n */\ngoog.ui.registry.setDecoratorByClassName = function(className, decoratorFn) {\n  // In this case, explicit validation has negligible overhead (since each\n  // decorator  is only registered once), and helps catch subtle bugs.\n  if (!className) {\n    throw Error('Invalid class name ' + className);\n  }\n  if (!goog.isFunction(decoratorFn)) {\n    throw Error('Invalid decorator function ' + decoratorFn);\n  }\n\n  goog.ui.registry.decoratorFunctions_[className] = decoratorFn;\n};\n\n\n/**\n * Returns an instance of {@link goog.ui.Component} or a subclass suitable to\n * decorate the given element, based on its CSS class.\n *\n * TODO(nnaze): Type of element should be {!Element}.\n *\n * @param {Element} element Element to decorate.\n * @return {goog.ui.Component?} Component to decorate the element (null if\n *     none).\n */\ngoog.ui.registry.getDecorator = function(element) {\n  var decorator;\n  goog.asserts.assert(element);\n  var classNames = goog.dom.classlist.get(element);\n  for (var i = 0, len = classNames.length; i < len; i++) {\n    if ((decorator = goog.ui.registry.getDecoratorByClassName(classNames[i]))) {\n      return decorator;\n    }\n  }\n  return null;\n};\n\n\n/**\n * Resets the global renderer and decorator registry.\n */\ngoog.ui.registry.reset = function() {\n  goog.ui.registry.defaultRenderers_ = {};\n  goog.ui.registry.decoratorFunctions_ = {};\n};\n\n\n/**\n * Map of {@link goog.ui.Component} constructor unique IDs to the constructors\n * of their default {@link goog.ui.Renderer}s.\n * @type {Object}\n * @private\n */\ngoog.ui.registry.defaultRenderers_ = {};\n\n\n/**\n * Map of CSS class names to registry factory functions.  The keys are\n * class names.  The values are function objects that return new instances\n * of {@link goog.ui.registry} or one of its subclasses, suitable to\n * decorate elements marked with the corresponding CSS class.  Used by\n * containers while decorating their children.\n * @type {Object}\n * @private\n */\ngoog.ui.registry.decoratorFunctions_ = {};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Base class for container renderers.\n *\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.ContainerRenderer');\n\ngoog.require('goog.a11y.aria');\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom.NodeType');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.classlist');\ngoog.require('goog.string');\ngoog.require('goog.style');\ngoog.require('goog.ui.registry');\ngoog.require('goog.userAgent');\n\n\n\n/**\n * Default renderer for {@link goog.ui.Container}.  Can be used as-is, but\n * subclasses of Container will probably want to use renderers specifically\n * tailored for them by extending this class.\n * @param {string=} opt_ariaRole Optional ARIA role used for the element.\n * @constructor\n */\ngoog.ui.ContainerRenderer = function(opt_ariaRole) {\n  // By default, the ARIA role is unspecified.\n  /** @private {string|undefined} */\n  this.ariaRole_ = opt_ariaRole;\n};\ngoog.addSingletonGetter(goog.ui.ContainerRenderer);\n\n\n/**\n * Constructs a new renderer and sets the CSS class that the renderer will use\n * as the base CSS class to apply to all elements rendered by that renderer.\n * An example to use this function using a menu is:\n *\n * <pre>\n * var myCustomRenderer = goog.ui.ContainerRenderer.getCustomRenderer(\n *     goog.ui.MenuRenderer, 'my-special-menu');\n * var newMenu = new goog.ui.Menu(opt_domHelper, myCustomRenderer);\n * </pre>\n *\n * Your styles for the menu can now be:\n * <pre>\n * .my-special-menu { }\n * </pre>\n *\n * <em>instead</em> of\n * <pre>\n * .CSS_MY_SPECIAL_MENU .goog-menu { }\n * </pre>\n *\n * You would want to use this functionality when you want an instance of a\n * component to have specific styles different than the other components of the\n * same type in your application.  This avoids using descendant selectors to\n * apply the specific styles to this component.\n *\n * @param {Function} ctor The constructor of the renderer you want to create.\n * @param {string} cssClassName The name of the CSS class for this renderer.\n * @return {goog.ui.ContainerRenderer} An instance of the desired renderer with\n *     its getCssClass() method overridden to return the supplied custom CSS\n *     class name.\n */\ngoog.ui.ContainerRenderer.getCustomRenderer = function(ctor, cssClassName) {\n  var renderer = new ctor();\n\n  /**\n   * Returns the CSS class to be applied to the root element of components\n   * rendered using this renderer.\n   * @return {string} Renderer-specific CSS class.\n   */\n  renderer.getCssClass = function() { return cssClassName; };\n\n  return renderer;\n};\n\n\n/**\n * Default CSS class to be applied to the root element of containers rendered\n * by this renderer.\n * @type {string}\n */\ngoog.ui.ContainerRenderer.CSS_CLASS = goog.getCssName('goog-container');\n\n\n/**\n * Returns the ARIA role to be applied to the container.\n * See http://wiki/Main/ARIA for more info.\n * @return {undefined|string} ARIA role.\n */\ngoog.ui.ContainerRenderer.prototype.getAriaRole = function() {\n  return this.ariaRole_;\n};\n\n\n/**\n * Enables or disables the tab index of the element.  Only elements with a\n * valid tab index can receive focus.\n * @param {Element} element Element whose tab index is to be changed.\n * @param {boolean} enable Whether to add or remove the element's tab index.\n */\ngoog.ui.ContainerRenderer.prototype.enableTabIndex = function(element, enable) {\n  if (element) {\n    element.tabIndex = enable ? 0 : -1;\n  }\n};\n\n\n/**\n * Creates and returns the container's root element.  The default\n * simply creates a DIV and applies the renderer's own CSS class name to it.\n * To be overridden in subclasses.\n * @param {goog.ui.Container} container Container to render.\n * @return {Element} Root element for the container.\n */\ngoog.ui.ContainerRenderer.prototype.createDom = function(container) {\n  return container.getDomHelper().createDom(\n      goog.dom.TagName.DIV, this.getClassNames(container).join(' '));\n};\n\n\n/**\n * Returns the DOM element into which child components are to be rendered,\n * or null if the container hasn't been rendered yet.\n * @param {Element} element Root element of the container whose content element\n *     is to be returned.\n * @return {Element} Element to contain child elements (null if none).\n */\ngoog.ui.ContainerRenderer.prototype.getContentElement = function(element) {\n  return element;\n};\n\n\n/**\n * Default implementation of {@code canDecorate}; returns true if the element\n * is a DIV, false otherwise.\n * @param {Element} element Element to decorate.\n * @return {boolean} Whether the renderer can decorate the element.\n */\ngoog.ui.ContainerRenderer.prototype.canDecorate = function(element) {\n  return element.tagName == 'DIV';\n};\n\n\n/**\n * Default implementation of {@code decorate} for {@link goog.ui.Container}s.\n * Decorates the element with the container, and attempts to decorate its child\n * elements.  Returns the decorated element.\n * @param {goog.ui.Container} container Container to decorate the element.\n * @param {Element} element Element to decorate.\n * @return {!Element} Decorated element.\n */\ngoog.ui.ContainerRenderer.prototype.decorate = function(container, element) {\n  // Set the container's ID to the decorated element's DOM ID, if any.\n  if (element.id) {\n    container.setId(element.id);\n  }\n\n  // Configure the container's state based on the CSS class names it has.\n  var baseClass = this.getCssClass();\n  var hasBaseClass = false;\n  var classNames = goog.dom.classlist.get(element);\n  if (classNames) {\n    goog.array.forEach(classNames, function(className) {\n      if (className == baseClass) {\n        hasBaseClass = true;\n      } else if (className) {\n        this.setStateFromClassName(container, className, baseClass);\n      }\n    }, this);\n  }\n\n  if (!hasBaseClass) {\n    // Make sure the container's root element has the renderer's own CSS class.\n    goog.dom.classlist.add(element, baseClass);\n  }\n\n  // Decorate the element's children, if applicable.  This should happen after\n  // the container's own state has been initialized, since how children are\n  // decorated may depend on the state of the container.\n  this.decorateChildren(container, this.getContentElement(element));\n\n  return element;\n};\n\n\n/**\n * Sets the container's state based on the given CSS class name, encountered\n * during decoration.  CSS class names that don't represent container states\n * are ignored.  Considered protected; subclasses should override this method\n * to support more states and CSS class names.\n * @param {goog.ui.Container} container Container to update.\n * @param {string} className CSS class name.\n * @param {string} baseClass Base class name used as the root of state-specific\n *     class names (typically the renderer's own class name).\n * @protected\n * @suppress {missingRequire} goog.ui.Container\n */\ngoog.ui.ContainerRenderer.prototype.setStateFromClassName = function(\n    container, className, baseClass) {\n  if (className == goog.getCssName(baseClass, 'disabled')) {\n    container.setEnabled(false);\n  } else if (className == goog.getCssName(baseClass, 'horizontal')) {\n    container.setOrientation(goog.ui.Container.Orientation.HORIZONTAL);\n  } else if (className == goog.getCssName(baseClass, 'vertical')) {\n    container.setOrientation(goog.ui.Container.Orientation.VERTICAL);\n  }\n};\n\n\n/**\n * Takes a container and an element that may contain child elements, decorates\n * the child elements, and adds the corresponding components to the container\n * as child components.  Any non-element child nodes (e.g. empty text nodes\n * introduced by line breaks in the HTML source) are removed from the element.\n * @param {goog.ui.Container} container Container whose children are to be\n *     discovered.\n * @param {Element} element Element whose children are to be decorated.\n * @param {Element=} opt_firstChild the first child to be decorated.\n */\ngoog.ui.ContainerRenderer.prototype.decorateChildren = function(\n    container, element, opt_firstChild) {\n  if (element) {\n    var node = opt_firstChild || element.firstChild, next;\n    // Tag soup HTML may result in a DOM where siblings have different parents.\n    while (node && node.parentNode == element) {\n      // Get the next sibling here, since the node may be replaced or removed.\n      next = node.nextSibling;\n      if (node.nodeType == goog.dom.NodeType.ELEMENT) {\n        // Decorate element node.\n        var child = this.getDecoratorForChild(/** @type {!Element} */ (node));\n        if (child) {\n          // addChild() may need to look at the element.\n          child.setElementInternal(/** @type {!Element} */ (node));\n          // If the container is disabled, mark the child disabled too.  See\n          // bug 1263729.  Note that this must precede the call to addChild().\n          if (!container.isEnabled()) {\n            child.setEnabled(false);\n          }\n          container.addChild(child);\n          child.decorate(/** @type {!Element} */ (node));\n        }\n      } else if (!node.nodeValue || goog.string.trim(node.nodeValue) == '') {\n        // Remove empty text node, otherwise madness ensues (e.g. controls that\n        // use goog-inline-block will flicker and shift on hover on Gecko).\n        element.removeChild(node);\n      }\n      node = next;\n    }\n  }\n};\n\n\n/**\n * Inspects the element, and creates an instance of {@link goog.ui.Control} or\n * an appropriate subclass best suited to decorate it.  Returns the control (or\n * null if no suitable class was found).  This default implementation uses the\n * element's CSS class to find the appropriate control class to instantiate.\n * May be overridden in subclasses.\n * @param {Element} element Element to decorate.\n * @return {goog.ui.Control?} A new control suitable to decorate the element\n *     (null if none).\n */\ngoog.ui.ContainerRenderer.prototype.getDecoratorForChild = function(element) {\n  return /** @type {goog.ui.Control} */ (\n      goog.ui.registry.getDecorator(element));\n};\n\n\n/**\n * Initializes the container's DOM when the container enters the document.\n * Called from {@link goog.ui.Container#enterDocument}.\n * @param {goog.ui.Container} container Container whose DOM is to be initialized\n *     as it enters the document.\n */\ngoog.ui.ContainerRenderer.prototype.initializeDom = function(container) {\n  var elem = container.getElement();\n  goog.asserts.assert(elem, 'The container DOM element cannot be null.');\n  // Make sure the container's element isn't selectable.  On Gecko, recursively\n  // marking each child element unselectable is expensive and unnecessary, so\n  // only mark the root element unselectable.\n  goog.style.setUnselectable(elem, true, goog.userAgent.GECKO);\n\n  // IE doesn't support outline:none, so we have to use the hideFocus property.\n  if (goog.userAgent.IE) {\n    elem.hideFocus = true;\n  }\n\n  // Set the ARIA role.\n  var ariaRole = this.getAriaRole();\n  if (ariaRole) {\n    goog.a11y.aria.setRole(elem, ariaRole);\n  }\n};\n\n\n/**\n * Returns the element within the container's DOM that should receive keyboard\n * focus (null if none).  The default implementation returns the container's\n * root element.\n * @param {goog.ui.Container} container Container whose key event target is\n *     to be returned.\n * @return {Element} Key event target (null if none).\n */\ngoog.ui.ContainerRenderer.prototype.getKeyEventTarget = function(container) {\n  return container.getElement();\n};\n\n\n/**\n * Returns the CSS class to be applied to the root element of containers\n * rendered using this renderer.\n * @return {string} Renderer-specific CSS class.\n */\ngoog.ui.ContainerRenderer.prototype.getCssClass = function() {\n  return goog.ui.ContainerRenderer.CSS_CLASS;\n};\n\n\n/**\n * Returns all CSS class names applicable to the given container, based on its\n * state.  The array of class names returned includes the renderer's own CSS\n * class, followed by a CSS class indicating the container's orientation,\n * followed by any state-specific CSS classes.\n * @param {goog.ui.Container} container Container whose CSS classes are to be\n *     returned.\n * @return {!Array<string>} Array of CSS class names applicable to the\n *     container.\n */\ngoog.ui.ContainerRenderer.prototype.getClassNames = function(container) {\n  var baseClass = this.getCssClass();\n  var isHorizontal =\n      container.getOrientation() == goog.ui.Container.Orientation.HORIZONTAL;\n  var classNames = [\n    baseClass, (isHorizontal ? goog.getCssName(baseClass, 'horizontal') :\n                               goog.getCssName(baseClass, 'vertical'))\n  ];\n  if (!container.isEnabled()) {\n    classNames.push(goog.getCssName(baseClass, 'disabled'));\n  }\n  return classNames;\n};\n\n\n/**\n * Returns the default orientation of containers rendered or decorated by this\n * renderer.  The base class implementation returns {@code VERTICAL}.\n * @return {goog.ui.Container.Orientation} Default orientation for containers\n *     created or decorated by this renderer.\n * @suppress {missingRequire} goog.ui.Container\n */\ngoog.ui.ContainerRenderer.prototype.getDefaultOrientation = function() {\n  return goog.ui.Container.Orientation.VERTICAL;\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Base class for control renderers.\n * TODO(attila):  If the renderer framework works well, pull it into Component.\n *\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.ControlRenderer');\n\ngoog.require('goog.a11y.aria');\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.a11y.aria.State');\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.classlist');\ngoog.require('goog.object');\ngoog.require('goog.string');\ngoog.require('goog.style');\ngoog.require('goog.ui.Component');\ngoog.require('goog.userAgent');\n\n\n\n/**\n * Default renderer for {@link goog.ui.Control}s.  Can be used as-is, but\n * subclasses of Control will probably want to use renderers specifically\n * tailored for them by extending this class.  Controls that use renderers\n * delegate one or more of the following API methods to the renderer:\n * <ul>\n *    <li>{@code createDom} - renders the DOM for the component\n *    <li>{@code canDecorate} - determines whether an element can be decorated\n *        by the component\n *    <li>{@code decorate} - decorates an existing element with the component\n *    <li>{@code setState} - updates the appearance of the component based on\n *        its state\n *    <li>{@code getContent} - returns the component's content\n *    <li>{@code setContent} - sets the component's content\n * </ul>\n * Controls are stateful; renderers, on the other hand, should be stateless and\n * reusable.\n * @constructor\n */\ngoog.ui.ControlRenderer = function() {};\ngoog.addSingletonGetter(goog.ui.ControlRenderer);\ngoog.tagUnsealableClass(goog.ui.ControlRenderer);\n\n\n/**\n * Constructs a new renderer and sets the CSS class that the renderer will use\n * as the base CSS class to apply to all elements rendered by that renderer.\n * An example to use this function using a color palette:\n *\n * <pre>\n * var myCustomRenderer = goog.ui.ControlRenderer.getCustomRenderer(\n *     goog.ui.PaletteRenderer, 'my-special-palette');\n * var newColorPalette = new goog.ui.ColorPalette(\n *     colors, myCustomRenderer, opt_domHelper);\n * </pre>\n *\n * Your CSS can look like this now:\n * <pre>\n * .my-special-palette { }\n * .my-special-palette-table { }\n * .my-special-palette-cell { }\n * etc.\n * </pre>\n *\n * <em>instead</em> of\n * <pre>\n * .CSS_MY_SPECIAL_PALETTE .goog-palette { }\n * .CSS_MY_SPECIAL_PALETTE .goog-palette-table { }\n * .CSS_MY_SPECIAL_PALETTE .goog-palette-cell { }\n * etc.\n * </pre>\n *\n * You would want to use this functionality when you want an instance of a\n * component to have specific styles different than the other components of the\n * same type in your application.  This avoids using descendant selectors to\n * apply the specific styles to this component.\n *\n * @param {Function} ctor The constructor of the renderer you are trying to\n *     create.\n * @param {string} cssClassName The name of the CSS class for this renderer.\n * @return {goog.ui.ControlRenderer} An instance of the desired renderer with\n *     its getCssClass() method overridden to return the supplied custom CSS\n *     class name.\n */\ngoog.ui.ControlRenderer.getCustomRenderer = function(ctor, cssClassName) {\n  var renderer = new ctor();\n\n  /**\n   * Returns the CSS class to be applied to the root element of components\n   * rendered using this renderer.\n   * @return {string} Renderer-specific CSS class.\n   */\n  renderer.getCssClass = function() { return cssClassName; };\n\n  return renderer;\n};\n\n\n/**\n * Default CSS class to be applied to the root element of components rendered\n * by this renderer.\n * @type {string}\n */\ngoog.ui.ControlRenderer.CSS_CLASS = goog.getCssName('goog-control');\n\n\n/**\n * Array of arrays of CSS classes that we want composite classes added and\n * removed for in IE6 and lower as a workaround for lack of multi-class CSS\n * selector support.\n *\n * Subclasses that have accompanying CSS requiring this workaround should define\n * their own static IE6_CLASS_COMBINATIONS constant and override\n * getIe6ClassCombinations to return it.\n *\n * For example, if your stylesheet uses the selector .button.collapse-left\n * (and is compiled to .button_collapse-left for the IE6 version of the\n * stylesheet,) you should include ['button', 'collapse-left'] in this array\n * and the class button_collapse-left will be applied to the root element\n * whenever both button and collapse-left are applied individually.\n *\n * Members of each class name combination will be joined with underscores in the\n * order that they're defined in the array. You should alphabetize them (for\n * compatibility with the CSS compiler) unless you are doing something special.\n * @type {Array<Array<string>>}\n */\ngoog.ui.ControlRenderer.IE6_CLASS_COMBINATIONS = [];\n\n\n/**\n * Map of component states to corresponding ARIA attributes.  Since the mapping\n * of component states to ARIA attributes is neither component- nor\n * renderer-specific, this is a static property of the renderer class, and is\n * initialized on first use.\n * @type {Object<goog.ui.Component.State, goog.a11y.aria.State>}\n * @private\n */\ngoog.ui.ControlRenderer.ariaAttributeMap_;\n\n\n/**\n * Map of certain ARIA states to ARIA roles that support them. Used for checked\n * and selected Component states because they are used on Components with ARIA\n * roles that do not support the corresponding ARIA state.\n * @private {!Object<goog.a11y.aria.Role, goog.a11y.aria.State>}\n * @const\n */\ngoog.ui.ControlRenderer.TOGGLE_ARIA_STATE_MAP_ = goog.object.create(\n    goog.a11y.aria.Role.BUTTON, goog.a11y.aria.State.PRESSED,\n    goog.a11y.aria.Role.CHECKBOX, goog.a11y.aria.State.CHECKED,\n    goog.a11y.aria.Role.MENU_ITEM, goog.a11y.aria.State.SELECTED,\n    goog.a11y.aria.Role.MENU_ITEM_CHECKBOX, goog.a11y.aria.State.CHECKED,\n    goog.a11y.aria.Role.MENU_ITEM_RADIO, goog.a11y.aria.State.CHECKED,\n    goog.a11y.aria.Role.RADIO, goog.a11y.aria.State.CHECKED,\n    goog.a11y.aria.Role.TAB, goog.a11y.aria.State.SELECTED,\n    goog.a11y.aria.Role.TREEITEM, goog.a11y.aria.State.SELECTED);\n\n\n/**\n * Returns the ARIA role to be applied to the control.\n * See http://wiki/Main/ARIA for more info.\n * @return {goog.a11y.aria.Role|undefined} ARIA role.\n */\ngoog.ui.ControlRenderer.prototype.getAriaRole = function() {\n  // By default, the ARIA role is unspecified.\n  return undefined;\n};\n\n\n/**\n * Returns the control's contents wrapped in a DIV, with the renderer's own\n * CSS class and additional state-specific classes applied to it.\n * @param {goog.ui.Control} control Control to render.\n * @return {Element} Root element for the control.\n */\ngoog.ui.ControlRenderer.prototype.createDom = function(control) {\n  // Create and return DIV wrapping contents.\n  var element = control.getDomHelper().createDom(\n      goog.dom.TagName.DIV, this.getClassNames(control).join(' '),\n      control.getContent());\n\n  return element;\n};\n\n\n/**\n * Takes the control's root element and returns the parent element of the\n * control's contents.  Since by default controls are rendered as a single\n * DIV, the default implementation returns the element itself.  Subclasses\n * with more complex DOM structures must override this method as needed.\n * @param {Element} element Root element of the control whose content element\n *     is to be returned.\n * @return {Element} The control's content element.\n */\ngoog.ui.ControlRenderer.prototype.getContentElement = function(element) {\n  return element;\n};\n\n\n/**\n * Updates the control's DOM by adding or removing the specified class name\n * to/from its root element. May add additional combined classes as needed in\n * IE6 and lower. Because of this, subclasses should use this method when\n * modifying class names on the control's root element.\n * @param {goog.ui.Control|Element} control Control instance (or root element)\n *     to be updated.\n * @param {string} className CSS class name to add or remove.\n * @param {boolean} enable Whether to add or remove the class name.\n */\ngoog.ui.ControlRenderer.prototype.enableClassName = function(\n    control, className, enable) {\n  var element = /** @type {Element} */ (\n      control.getElement ? control.getElement() : control);\n  if (element) {\n    var classNames = [className];\n\n    // For IE6, we need to enable any combined classes involving this class\n    // as well.\n    // TODO(user): Remove this as IE6 is no longer in use.\n    if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('7')) {\n      classNames = this.getAppliedCombinedClassNames_(\n          goog.dom.classlist.get(element), className);\n      classNames.push(className);\n    }\n\n    goog.dom.classlist.enableAll(element, classNames, enable);\n  }\n};\n\n\n/**\n * Updates the control's DOM by adding or removing the specified extra class\n * name to/from its element.\n * @param {goog.ui.Control} control Control to be updated.\n * @param {string} className CSS class name to add or remove.\n * @param {boolean} enable Whether to add or remove the class name.\n */\ngoog.ui.ControlRenderer.prototype.enableExtraClassName = function(\n    control, className, enable) {\n  // The base class implementation is trivial; subclasses should override as\n  // needed.\n  this.enableClassName(control, className, enable);\n};\n\n\n/**\n * Returns true if this renderer can decorate the element, false otherwise.\n * The default implementation always returns true.\n * @param {Element} element Element to decorate.\n * @return {boolean} Whether the renderer can decorate the element.\n */\ngoog.ui.ControlRenderer.prototype.canDecorate = function(element) {\n  return true;\n};\n\n\n/**\n * Default implementation of {@code decorate} for {@link goog.ui.Control}s.\n * Initializes the control's ID, content, and state based on the ID of the\n * element, its child nodes, and its CSS classes, respectively.  Returns the\n * element.\n * @param {goog.ui.Control} control Control instance to decorate the element.\n * @param {Element} element Element to decorate.\n * @return {Element} Decorated element.\n */\ngoog.ui.ControlRenderer.prototype.decorate = function(control, element) {\n  // Set the control's ID to the decorated element's DOM ID, if any.\n  if (element.id) {\n    control.setId(element.id);\n  }\n\n  // Set the control's content to the decorated element's content.\n  var contentElem = this.getContentElement(element);\n  if (contentElem && contentElem.firstChild) {\n    control.setContentInternal(\n        contentElem.firstChild.nextSibling ?\n            goog.array.clone(contentElem.childNodes) :\n            contentElem.firstChild);\n  } else {\n    control.setContentInternal(null);\n  }\n\n  // Initialize the control's state based on the decorated element's CSS class.\n  // This implementation is optimized to minimize object allocations, string\n  // comparisons, and DOM access.\n  var state = 0x00;\n  var rendererClassName = this.getCssClass();\n  var structuralClassName = this.getStructuralCssClass();\n  var hasRendererClassName = false;\n  var hasStructuralClassName = false;\n  var hasCombinedClassName = false;\n  var classNames = goog.array.toArray(goog.dom.classlist.get(element));\n  goog.array.forEach(classNames, function(className) {\n    if (!hasRendererClassName && className == rendererClassName) {\n      hasRendererClassName = true;\n      if (structuralClassName == rendererClassName) {\n        hasStructuralClassName = true;\n      }\n    } else if (!hasStructuralClassName && className == structuralClassName) {\n      hasStructuralClassName = true;\n    } else {\n      state |= this.getStateFromClass(className);\n    }\n    if (this.getStateFromClass(className) == goog.ui.Component.State.DISABLED) {\n      goog.asserts.assertElement(contentElem);\n      if (goog.dom.isFocusableTabIndex(contentElem)) {\n        goog.dom.setFocusableTabIndex(contentElem, false);\n      }\n    }\n  }, this);\n  control.setStateInternal(state);\n\n  // Make sure the element has the renderer's CSS classes applied, as well as\n  // any extra class names set on the control.\n  if (!hasRendererClassName) {\n    classNames.push(rendererClassName);\n    if (structuralClassName == rendererClassName) {\n      hasStructuralClassName = true;\n    }\n  }\n  if (!hasStructuralClassName) {\n    classNames.push(structuralClassName);\n  }\n  var extraClassNames = control.getExtraClassNames();\n  if (extraClassNames) {\n    classNames.push.apply(classNames, extraClassNames);\n  }\n\n  // For IE6, rewrite all classes on the decorated element if any combined\n  // classes apply.\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('7')) {\n    var combinedClasses = this.getAppliedCombinedClassNames_(classNames);\n    if (combinedClasses.length > 0) {\n      classNames.push.apply(classNames, combinedClasses);\n      hasCombinedClassName = true;\n    }\n  }\n\n  // Only write to the DOM if new class names had to be added to the element.\n  if (!hasRendererClassName || !hasStructuralClassName || extraClassNames ||\n      hasCombinedClassName) {\n    goog.dom.classlist.set(element, classNames.join(' '));\n  }\n\n  return element;\n};\n\n\n/**\n * Initializes the control's DOM by configuring properties that can only be set\n * after the DOM has entered the document.  This implementation sets up BiDi\n * and keyboard focus.  Called from {@link goog.ui.Control#enterDocument}.\n * @param {goog.ui.Control} control Control whose DOM is to be initialized\n *     as it enters the document.\n */\ngoog.ui.ControlRenderer.prototype.initializeDom = function(control) {\n  // Initialize render direction (BiDi).  We optimize the left-to-right render\n  // direction by assuming that elements are left-to-right by default, and only\n  // updating their styling if they are explicitly set to right-to-left.\n  if (control.isRightToLeft()) {\n    this.setRightToLeft(control.getElement(), true);\n  }\n\n  // Initialize keyboard focusability (tab index).  We assume that components\n  // aren't focusable by default (i.e have no tab index), and only touch the\n  // DOM if the component is focusable, enabled, and visible, and therefore\n  // needs a tab index.\n  if (control.isEnabled()) {\n    this.setFocusable(control, control.isVisible());\n  }\n};\n\n\n/**\n * Sets the element's ARIA role.\n * @param {Element} element Element to update.\n * @param {?goog.a11y.aria.Role=} opt_preferredRole The preferred ARIA role.\n */\ngoog.ui.ControlRenderer.prototype.setAriaRole = function(\n    element, opt_preferredRole) {\n  var ariaRole = opt_preferredRole || this.getAriaRole();\n  if (ariaRole) {\n    goog.asserts.assert(\n        element, 'The element passed as a first parameter cannot be null.');\n    var currentRole = goog.a11y.aria.getRole(element);\n    if (ariaRole == currentRole) {\n      return;\n    }\n    goog.a11y.aria.setRole(element, ariaRole);\n  }\n};\n\n\n/**\n * Sets the element's ARIA attributes, including distinguishing between\n * universally supported ARIA properties and ARIA states that are only\n * supported by certain ARIA roles. Only attributes which are initialized to be\n * true will be set.\n * @param {!goog.ui.Control} control Control whose ARIA state will be updated.\n * @param {!Element} element Element whose ARIA state is to be updated.\n */\ngoog.ui.ControlRenderer.prototype.setAriaStates = function(control, element) {\n  goog.asserts.assert(control);\n  goog.asserts.assert(element);\n\n  var ariaLabel = control.getAriaLabel();\n  if (goog.isDefAndNotNull(ariaLabel)) {\n    this.setAriaLabel(element, ariaLabel);\n  }\n\n  if (!control.isVisible()) {\n    goog.a11y.aria.setState(\n        element, goog.a11y.aria.State.HIDDEN, !control.isVisible());\n  }\n  if (!control.isEnabled()) {\n    this.updateAriaState(\n        element, goog.ui.Component.State.DISABLED, !control.isEnabled());\n  }\n  if (control.isSupportedState(goog.ui.Component.State.SELECTED)) {\n    this.updateAriaState(\n        element, goog.ui.Component.State.SELECTED, control.isSelected());\n  }\n  if (control.isSupportedState(goog.ui.Component.State.CHECKED)) {\n    this.updateAriaState(\n        element, goog.ui.Component.State.CHECKED, control.isChecked());\n  }\n  if (control.isSupportedState(goog.ui.Component.State.OPENED)) {\n    this.updateAriaState(\n        element, goog.ui.Component.State.OPENED, control.isOpen());\n  }\n};\n\n\n/**\n * Sets the element's ARIA label. This should be overriden by subclasses that\n * don't apply the role directly on control.element_.\n * @param {!Element} element Element whose ARIA label is to be updated.\n * @param {string} ariaLabel Label to add to the element.\n */\ngoog.ui.ControlRenderer.prototype.setAriaLabel = function(element, ariaLabel) {\n  goog.a11y.aria.setLabel(element, ariaLabel);\n};\n\n\n/**\n * Allows or disallows text selection within the control's DOM.\n * @param {Element} element The control's root element.\n * @param {boolean} allow Whether the element should allow text selection.\n */\ngoog.ui.ControlRenderer.prototype.setAllowTextSelection = function(\n    element, allow) {\n  // On all browsers other than IE and Opera, it isn't necessary to recursively\n  // apply unselectable styling to the element's children.\n  goog.style.setUnselectable(\n      element, !allow, !goog.userAgent.IE && !goog.userAgent.OPERA);\n};\n\n\n/**\n * Applies special styling to/from the control's element if it is rendered\n * right-to-left, and removes it if it is rendered left-to-right.\n * @param {Element} element The control's root element.\n * @param {boolean} rightToLeft Whether the component is rendered\n *     right-to-left.\n */\ngoog.ui.ControlRenderer.prototype.setRightToLeft = function(\n    element, rightToLeft) {\n  this.enableClassName(\n      element, goog.getCssName(this.getStructuralCssClass(), 'rtl'),\n      rightToLeft);\n};\n\n\n/**\n * Returns true if the control's key event target supports keyboard focus\n * (based on its {@code tabIndex} attribute), false otherwise.\n * @param {goog.ui.Control} control Control whose key event target is to be\n *     checked.\n * @return {boolean} Whether the control's key event target is focusable.\n */\ngoog.ui.ControlRenderer.prototype.isFocusable = function(control) {\n  var keyTarget;\n  if (control.isSupportedState(goog.ui.Component.State.FOCUSED) &&\n      (keyTarget = control.getKeyEventTarget())) {\n    return goog.dom.isFocusableTabIndex(keyTarget);\n  }\n  return false;\n};\n\n\n/**\n * Updates the control's key event target to make it focusable or non-focusable\n * via its {@code tabIndex} attribute.  Does nothing if the control doesn't\n * support the {@code FOCUSED} state, or if it has no key event target.\n * @param {goog.ui.Control} control Control whose key event target is to be\n *     updated.\n * @param {boolean} focusable Whether to enable keyboard focus support on the\n *     control's key event target.\n */\ngoog.ui.ControlRenderer.prototype.setFocusable = function(control, focusable) {\n  var keyTarget;\n  if (control.isSupportedState(goog.ui.Component.State.FOCUSED) &&\n      (keyTarget = control.getKeyEventTarget())) {\n    if (!focusable && control.isFocused()) {\n      // Blur before hiding.  Note that IE calls onblur handlers asynchronously.\n      try {\n        keyTarget.blur();\n      } catch (e) {\n        // TODO(user|user):  Find out why this fails on IE.\n      }\n      // The blur event dispatched by the key event target element when blur()\n      // was called on it should have been handled by the control's handleBlur()\n      // method, so at this point the control should no longer be focused.\n      // However, blur events are unreliable on IE and FF3, so if at this point\n      // the control is still focused, we trigger its handleBlur() method\n      // programmatically.\n      if (control.isFocused()) {\n        control.handleBlur(null);\n      }\n    }\n    // Don't overwrite existing tab index values unless needed.\n    if (goog.dom.isFocusableTabIndex(keyTarget) != focusable) {\n      goog.dom.setFocusableTabIndex(keyTarget, focusable);\n    }\n  }\n};\n\n\n/**\n * Shows or hides the element.\n * @param {Element} element Element to update.\n * @param {boolean} visible Whether to show the element.\n */\ngoog.ui.ControlRenderer.prototype.setVisible = function(element, visible) {\n  // The base class implementation is trivial; subclasses should override as\n  // needed.  It should be possible to do animated reveals, for example.\n  goog.style.setElementShown(element, visible);\n  if (element) {\n    goog.a11y.aria.setState(element, goog.a11y.aria.State.HIDDEN, !visible);\n  }\n};\n\n\n/**\n * Updates the appearance of the control in response to a state change.\n * @param {goog.ui.Control} control Control instance to update.\n * @param {goog.ui.Component.State} state State to enable or disable.\n * @param {boolean} enable Whether the control is entering or exiting the state.\n */\ngoog.ui.ControlRenderer.prototype.setState = function(control, state, enable) {\n  var element = control.getElement();\n  if (element) {\n    var className = this.getClassForState(state);\n    if (className) {\n      this.enableClassName(control, className, enable);\n    }\n    this.updateAriaState(element, state, enable);\n  }\n};\n\n\n/**\n * Updates the element's ARIA (accessibility) attributes , including\n * distinguishing between universally supported ARIA properties and ARIA states\n * that are only supported by certain ARIA roles.\n * @param {Element} element Element whose ARIA state is to be updated.\n * @param {goog.ui.Component.State} state Component state being enabled or\n *     disabled.\n * @param {boolean} enable Whether the state is being enabled or disabled.\n * @protected\n */\ngoog.ui.ControlRenderer.prototype.updateAriaState = function(\n    element, state, enable) {\n  // Ensure the ARIA attribute map exists.\n  if (!goog.ui.ControlRenderer.ariaAttributeMap_) {\n    goog.ui.ControlRenderer.ariaAttributeMap_ = goog.object.create(\n        goog.ui.Component.State.DISABLED, goog.a11y.aria.State.DISABLED,\n        goog.ui.Component.State.SELECTED, goog.a11y.aria.State.SELECTED,\n        goog.ui.Component.State.CHECKED, goog.a11y.aria.State.CHECKED,\n        goog.ui.Component.State.OPENED, goog.a11y.aria.State.EXPANDED);\n  }\n  goog.asserts.assert(\n      element, 'The element passed as a first parameter cannot be null.');\n  var ariaAttr = goog.ui.ControlRenderer.getAriaStateForAriaRole_(\n      element, goog.ui.ControlRenderer.ariaAttributeMap_[state]);\n  if (ariaAttr) {\n    goog.a11y.aria.setState(element, ariaAttr, enable);\n  }\n};\n\n\n/**\n * Returns the appropriate ARIA attribute based on ARIA role if the ARIA\n * attribute is an ARIA state.\n * @param {!Element} element The element from which to get the ARIA role for\n * matching ARIA state.\n * @param {goog.a11y.aria.State} attr The ARIA attribute to check to see if it\n * can be applied to the given ARIA role.\n * @return {goog.a11y.aria.State} An ARIA attribute that can be applied to the\n * given ARIA role.\n * @private\n */\ngoog.ui.ControlRenderer.getAriaStateForAriaRole_ = function(element, attr) {\n  var role = goog.a11y.aria.getRole(element);\n  if (!role) {\n    return attr;\n  }\n  role = /** @type {goog.a11y.aria.Role} */ (role);\n  var matchAttr = goog.ui.ControlRenderer.TOGGLE_ARIA_STATE_MAP_[role] || attr;\n  return goog.ui.ControlRenderer.isAriaState_(attr) ? matchAttr : attr;\n};\n\n\n/**\n * Determines if the given ARIA attribute is an ARIA property or ARIA state.\n * @param {goog.a11y.aria.State} attr The ARIA attribute to classify.\n * @return {boolean} If the ARIA attribute is an ARIA state.\n * @private\n */\ngoog.ui.ControlRenderer.isAriaState_ = function(attr) {\n  return attr == goog.a11y.aria.State.CHECKED ||\n      attr == goog.a11y.aria.State.SELECTED;\n};\n\n\n/**\n * Takes a control's root element, and sets its content to the given text\n * caption or DOM structure.  The default implementation replaces the children\n * of the given element.  Renderers that create more complex DOM structures\n * must override this method accordingly.\n * @param {Element} element The control's root element.\n * @param {goog.ui.ControlContent} content Text caption or DOM structure to be\n *     set as the control's content. The DOM nodes will not be cloned, they\n *     will only moved under the content element of the control.\n */\ngoog.ui.ControlRenderer.prototype.setContent = function(element, content) {\n  var contentElem = this.getContentElement(element);\n  if (contentElem) {\n    goog.dom.removeChildren(contentElem);\n    if (content) {\n      if (goog.isString(content)) {\n        goog.dom.setTextContent(contentElem, content);\n      } else {\n        var childHandler = function(child) {\n          if (child) {\n            var doc = goog.dom.getOwnerDocument(contentElem);\n            contentElem.appendChild(\n                goog.isString(child) ? doc.createTextNode(child) : child);\n          }\n        };\n        if (goog.isArray(content)) {\n          // Array of nodes.\n          goog.array.forEach(content, childHandler);\n        } else if (goog.isArrayLike(content) && !('nodeType' in content)) {\n          // NodeList. The second condition filters out TextNode which also has\n          // length attribute but is not array like. The nodes have to be cloned\n          // because childHandler removes them from the list during iteration.\n          goog.array.forEach(\n              goog.array.clone(/** @type {!NodeList<?>} */ (content)),\n              childHandler);\n        } else {\n          // Node or string.\n          childHandler(content);\n        }\n      }\n    }\n  }\n};\n\n\n/**\n * Returns the element within the component's DOM that should receive keyboard\n * focus (null if none).  The default implementation returns the control's root\n * element.\n * @param {goog.ui.Control} control Control whose key event target is to be\n *     returned.\n * @return {Element} The key event target.\n */\ngoog.ui.ControlRenderer.prototype.getKeyEventTarget = function(control) {\n  return control.getElement();\n};\n\n\n// CSS class name management.\n\n\n/**\n * Returns the CSS class name to be applied to the root element of all\n * components rendered or decorated using this renderer.  The class name\n * is expected to uniquely identify the renderer class, i.e. no two\n * renderer classes are expected to share the same CSS class name.\n * @return {string} Renderer-specific CSS class name.\n */\ngoog.ui.ControlRenderer.prototype.getCssClass = function() {\n  return goog.ui.ControlRenderer.CSS_CLASS;\n};\n\n\n/**\n * Returns an array of combinations of classes to apply combined class names for\n * in IE6 and below. See {@link IE6_CLASS_COMBINATIONS} for more detail. This\n * method doesn't reference {@link IE6_CLASS_COMBINATIONS} so that it can be\n * compiled out, but subclasses should return their IE6_CLASS_COMBINATIONS\n * static constant instead.\n * @return {Array<Array<string>>} Array of class name combinations.\n */\ngoog.ui.ControlRenderer.prototype.getIe6ClassCombinations = function() {\n  return [];\n};\n\n\n/**\n * Returns the name of a DOM structure-specific CSS class to be applied to the\n * root element of all components rendered or decorated using this renderer.\n * Unlike the class name returned by {@link #getCssClass}, the structural class\n * name may be shared among different renderers that generate similar DOM\n * structures.  The structural class name also serves as the basis of derived\n * class names used to identify and style structural elements of the control's\n * DOM, as well as the basis for state-specific class names.  The default\n * implementation returns the same class name as {@link #getCssClass}, but\n * subclasses are expected to override this method as needed.\n * @return {string} DOM structure-specific CSS class name (same as the renderer-\n *     specific CSS class name by default).\n */\ngoog.ui.ControlRenderer.prototype.getStructuralCssClass = function() {\n  return this.getCssClass();\n};\n\n\n/**\n * Returns all CSS class names applicable to the given control, based on its\n * state.  The return value is an array of strings containing\n * <ol>\n *   <li>the renderer-specific CSS class returned by {@link #getCssClass},\n *       followed by\n *   <li>the structural CSS class returned by {@link getStructuralCssClass} (if\n *       different from the renderer-specific CSS class), followed by\n *   <li>any state-specific classes returned by {@link #getClassNamesForState},\n *       followed by\n *   <li>any extra classes returned by the control's {@code getExtraClassNames}\n *       method and\n *   <li>for IE6 and lower, additional combined classes from\n *       {@link getAppliedCombinedClassNames_}.\n * </ol>\n * Since all controls have at least one renderer-specific CSS class name, this\n * method is guaranteed to return an array of at least one element.\n * @param {goog.ui.Control} control Control whose CSS classes are to be\n *     returned.\n * @return {!Array<string>} Array of CSS class names applicable to the control.\n * @protected\n */\ngoog.ui.ControlRenderer.prototype.getClassNames = function(control) {\n  var cssClass = this.getCssClass();\n\n  // Start with the renderer-specific class name.\n  var classNames = [cssClass];\n\n  // Add structural class name, if different.\n  var structuralCssClass = this.getStructuralCssClass();\n  if (structuralCssClass != cssClass) {\n    classNames.push(structuralCssClass);\n  }\n\n  // Add state-specific class names, if any.\n  var classNamesForState = this.getClassNamesForState(control.getState());\n  classNames.push.apply(classNames, classNamesForState);\n\n  // Add extra class names, if any.\n  var extraClassNames = control.getExtraClassNames();\n  if (extraClassNames) {\n    classNames.push.apply(classNames, extraClassNames);\n  }\n\n  // Add composite classes for IE6 support\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('7')) {\n    classNames.push.apply(\n        classNames, this.getAppliedCombinedClassNames_(classNames));\n  }\n\n  return classNames;\n};\n\n\n/**\n * Returns an array of all the combined class names that should be applied based\n * on the given list of classes. Checks the result of\n * {@link getIe6ClassCombinations} for any combinations that have all\n * members contained in classes. If a combination matches, the members are\n * joined with an underscore (in order), and added to the return array.\n *\n * If opt_includedClass is provided, return only the combined classes that have\n * all members contained in classes AND include opt_includedClass as well.\n * opt_includedClass is added to classes as well.\n * @param {IArrayLike<string>} classes Array-like thing of classes to\n *     return matching combined classes for.\n * @param {?string=} opt_includedClass If provided, get only the combined\n *     classes that include this one.\n * @return {!Array<string>} Array of combined class names that should be\n *     applied.\n * @private\n */\ngoog.ui.ControlRenderer.prototype.getAppliedCombinedClassNames_ = function(\n    classes, opt_includedClass) {\n  var toAdd = [];\n  if (opt_includedClass) {\n    classes = goog.array.concat(classes, [opt_includedClass]);\n  }\n  goog.array.forEach(this.getIe6ClassCombinations(), function(combo) {\n    if (goog.array.every(combo, goog.partial(goog.array.contains, classes)) &&\n        (!opt_includedClass || goog.array.contains(combo, opt_includedClass))) {\n      toAdd.push(combo.join('_'));\n    }\n  });\n  return toAdd;\n};\n\n\n/**\n * Takes a bit mask of {@link goog.ui.Component.State}s, and returns an array\n * of the appropriate class names representing the given state, suitable to be\n * applied to the root element of a component rendered using this renderer, or\n * null if no state-specific classes need to be applied.  This default\n * implementation uses the renderer's {@link getClassForState} method to\n * generate each state-specific class.\n * @param {number} state Bit mask of component states.\n * @return {!Array<string>} Array of CSS class names representing the given\n *     state.\n * @protected\n */\ngoog.ui.ControlRenderer.prototype.getClassNamesForState = function(state) {\n  var classNames = [];\n  while (state) {\n    // For each enabled state, push the corresponding CSS class name onto\n    // the classNames array.\n    var mask = state & -state;  // Least significant bit\n    classNames.push(\n        this.getClassForState(\n            /** @type {goog.ui.Component.State} */ (mask)));\n    state &= ~mask;\n  }\n  return classNames;\n};\n\n\n/**\n * Takes a single {@link goog.ui.Component.State}, and returns the\n * corresponding CSS class name (null if none).\n * @param {goog.ui.Component.State} state Component state.\n * @return {string|undefined} CSS class representing the given state (undefined\n *     if none).\n * @protected\n */\ngoog.ui.ControlRenderer.prototype.getClassForState = function(state) {\n  if (!this.classByState_) {\n    this.createClassByStateMap_();\n  }\n  return this.classByState_[state];\n};\n\n\n/**\n * Takes a single CSS class name which may represent a component state, and\n * returns the corresponding component state (0x00 if none).\n * @param {string} className CSS class name, possibly representing a component\n *     state.\n * @return {goog.ui.Component.State} state Component state corresponding\n *     to the given CSS class (0x00 if none).\n * @protected\n */\ngoog.ui.ControlRenderer.prototype.getStateFromClass = function(className) {\n  if (!this.stateByClass_) {\n    this.createStateByClassMap_();\n  }\n  var state = parseInt(this.stateByClass_[className], 10);\n  return /** @type {goog.ui.Component.State} */ (isNaN(state) ? 0x00 : state);\n};\n\n\n/**\n * Creates the lookup table of states to classes, used during state changes.\n * @private\n */\ngoog.ui.ControlRenderer.prototype.createClassByStateMap_ = function() {\n  var baseClass = this.getStructuralCssClass();\n\n  // This ensures space-separated css classnames are not allowed, which some\n  // ControlRenderers had been doing.  See http://b/13694665.\n  var isValidClassName =\n      !goog.string.contains(goog.string.normalizeWhitespace(baseClass), ' ');\n  goog.asserts.assert(\n      isValidClassName,\n      'ControlRenderer has an invalid css class: \\'' + baseClass + '\\'');\n\n  /**\n   * Map of component states to state-specific structural class names,\n   * used when changing the DOM in response to a state change.  Precomputed\n   * and cached on first use to minimize object allocations and string\n   * concatenation.\n   * @type {Object}\n   * @private\n   */\n  this.classByState_ = goog.object.create(\n      goog.ui.Component.State.DISABLED, goog.getCssName(baseClass, 'disabled'),\n      goog.ui.Component.State.HOVER, goog.getCssName(baseClass, 'hover'),\n      goog.ui.Component.State.ACTIVE, goog.getCssName(baseClass, 'active'),\n      goog.ui.Component.State.SELECTED, goog.getCssName(baseClass, 'selected'),\n      goog.ui.Component.State.CHECKED, goog.getCssName(baseClass, 'checked'),\n      goog.ui.Component.State.FOCUSED, goog.getCssName(baseClass, 'focused'),\n      goog.ui.Component.State.OPENED, goog.getCssName(baseClass, 'open'));\n};\n\n\n/**\n * Creates the lookup table of classes to states, used during decoration.\n * @private\n */\ngoog.ui.ControlRenderer.prototype.createStateByClassMap_ = function() {\n  // We need the classByState_ map so we can transpose it.\n  if (!this.classByState_) {\n    this.createClassByStateMap_();\n  }\n\n  /**\n   * Map of state-specific structural class names to component states,\n   * used during element decoration.  Precomputed and cached on first use\n   * to minimize object allocations and string concatenation.\n   * @type {Object}\n   * @private\n   */\n  this.stateByClass_ = goog.object.transpose(this.classByState_);\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Base class for UI controls such as buttons, menus, menu items,\n * toolbar buttons, etc.  The implementation is based on a generalized version\n * of {@link goog.ui.MenuItem}.\n * TODO(attila):  If the renderer framework works well, pull it into Component.\n *\n * @author attila@google.com (Attila Bodis)\n * @see ../demos/control.html\n * @see http://code.google.com/p/closure-library/wiki/IntroToControls\n */\n\ngoog.provide('goog.ui.Control');\n\ngoog.require('goog.Disposable');\ngoog.require('goog.array');\ngoog.require('goog.dom');\ngoog.require('goog.events.BrowserEvent');\ngoog.require('goog.events.Event');\ngoog.require('goog.events.EventHandler');\ngoog.require('goog.events.EventType');\ngoog.require('goog.events.KeyCodes');\ngoog.require('goog.events.KeyHandler');\ngoog.require('goog.string');\ngoog.require('goog.ui.Component');\n/** @suppress {extraRequire} */\ngoog.require('goog.ui.ControlContent');\ngoog.require('goog.ui.ControlRenderer');\ngoog.require('goog.ui.registry');\ngoog.require('goog.userAgent');\n\n\n\n/**\n * Base class for UI controls.  Extends {@link goog.ui.Component} by adding\n * the following:\n *  <ul>\n *    <li>a {@link goog.events.KeyHandler}, to simplify keyboard handling,\n *    <li>a pluggable <em>renderer</em> framework, to simplify the creation of\n *        simple controls without the need to subclass this class,\n *    <li>the notion of component <em>content</em>, like a text caption or DOM\n *        structure displayed in the component (e.g. a button label),\n *    <li>getter and setter for component content, as well as a getter and\n *        setter specifically for caption text (for convenience),\n *    <li>support for hiding/showing the component,\n      <li>fine-grained control over supported states and state transition\n          events, and\n *    <li>default mouse and keyboard event handling.\n *  </ul>\n * This class has sufficient built-in functionality for most simple UI controls.\n * All controls dispatch SHOW, HIDE, ENTER, LEAVE, and ACTION events on show,\n * hide, mouseover, mouseout, and user action, respectively.  Additional states\n * are also supported.  See closure/demos/control.html\n * for example usage.\n * @param {goog.ui.ControlContent=} opt_content Text caption or DOM structure\n *     to display as the content of the control (if any).\n * @param {goog.ui.ControlRenderer=} opt_renderer Renderer used to render or\n *     decorate the component; defaults to {@link goog.ui.ControlRenderer}.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper, used for\n *     document interaction.\n * @constructor\n * @extends {goog.ui.Component}\n */\ngoog.ui.Control = function(opt_content, opt_renderer, opt_domHelper) {\n  goog.ui.Component.call(this, opt_domHelper);\n  this.renderer_ =\n      opt_renderer || goog.ui.registry.getDefaultRenderer(this.constructor);\n  this.setContentInternal(goog.isDef(opt_content) ? opt_content : null);\n\n  /** @private {?string} The control's aria-label. */\n  this.ariaLabel_ = null;\n\n  /** @private {goog.ui.Control.IeMouseEventSequenceSimulator_} */\n  this.ieMouseEventSequenceSimulator_;\n};\ngoog.inherits(goog.ui.Control, goog.ui.Component);\ngoog.tagUnsealableClass(goog.ui.Control);\n\n\n// Renderer registry.\n// TODO(attila): Refactor existing usages inside Google in a follow-up CL.\n\n\n/**\n * Maps a CSS class name to a function that returns a new instance of\n * {@link goog.ui.Control} or a subclass thereof, suitable to decorate\n * an element that has the specified CSS class.  UI components that extend\n * {@link goog.ui.Control} and want {@link goog.ui.Container}s to be able\n * to discover and decorate elements using them should register a factory\n * function via this API.\n * @param {string} className CSS class name.\n * @param {Function} decoratorFunction Function that takes no arguments and\n *     returns a new instance of a control to decorate an element with the\n *     given class.\n * @deprecated Use {@link goog.ui.registry.setDecoratorByClassName} instead.\n */\ngoog.ui.Control.registerDecorator = goog.ui.registry.setDecoratorByClassName;\n\n\n/**\n * Takes an element and returns a new instance of {@link goog.ui.Control}\n * or a subclass, suitable to decorate it (based on the element's CSS class).\n * @param {Element} element Element to decorate.\n * @return {goog.ui.Control?} New control instance to decorate the element\n *     (null if none).\n * @deprecated Use {@link goog.ui.registry.getDecorator} instead.\n */\ngoog.ui.Control.getDecorator =\n    /** @type {function(Element): goog.ui.Control} */ (\n        goog.ui.registry.getDecorator);\n\n\n/**\n * Renderer associated with the component.\n * @type {goog.ui.ControlRenderer|undefined}\n * @private\n */\ngoog.ui.Control.prototype.renderer_;\n\n\n/**\n * Text caption or DOM structure displayed in the component.\n * @type {goog.ui.ControlContent}\n * @private\n */\ngoog.ui.Control.prototype.content_ = null;\n\n\n/**\n * Current component state; a bit mask of {@link goog.ui.Component.State}s.\n * @type {number}\n * @private\n */\ngoog.ui.Control.prototype.state_ = 0x00;\n\n\n/**\n * A bit mask of {@link goog.ui.Component.State}s this component supports.\n * @type {number}\n * @private\n */\ngoog.ui.Control.prototype.supportedStates_ = goog.ui.Component.State.DISABLED |\n    goog.ui.Component.State.HOVER | goog.ui.Component.State.ACTIVE |\n    goog.ui.Component.State.FOCUSED;\n\n\n/**\n * A bit mask of {@link goog.ui.Component.State}s for which this component\n * provides default event handling.  For example, a component that handles\n * the HOVER state automatically will highlight itself on mouseover, whereas\n * a component that doesn't handle HOVER automatically will only dispatch\n * ENTER and LEAVE events but not call {@link setHighlighted} on itself.\n * By default, components provide default event handling for all states.\n * Controls hosted in containers (e.g. menu items in a menu, or buttons in a\n * toolbar) will typically want to have their container manage their highlight\n * state.  Selectable controls managed by a selection model will also typically\n * want their selection state to be managed by the model.\n * @type {number}\n * @private\n */\ngoog.ui.Control.prototype.autoStates_ = goog.ui.Component.State.ALL;\n\n\n/**\n * A bit mask of {@link goog.ui.Component.State}s for which this component\n * dispatches state transition events.  Because events are expensive, the\n * default behavior is to not dispatch any state transition events at all.\n * Use the {@link #setDispatchTransitionEvents} API to request transition\n * events  as needed.  Subclasses may enable transition events by default.\n * Controls hosted in containers or managed by a selection model will typically\n * want to dispatch transition events.\n * @type {number}\n * @private\n */\ngoog.ui.Control.prototype.statesWithTransitionEvents_ = 0x00;\n\n\n/**\n * Component visibility.\n * @type {boolean}\n * @private\n */\ngoog.ui.Control.prototype.visible_ = true;\n\n\n/**\n * Keyboard event handler.\n * @type {goog.events.KeyHandler}\n * @private\n */\ngoog.ui.Control.prototype.keyHandler_;\n\n\n/**\n * Additional class name(s) to apply to the control's root element, if any.\n * @type {Array<string>?}\n * @private\n */\ngoog.ui.Control.prototype.extraClassNames_ = null;\n\n\n/**\n * Whether the control should listen for and handle mouse events; defaults to\n * true.\n * @type {boolean}\n * @private\n */\ngoog.ui.Control.prototype.handleMouseEvents_ = true;\n\n\n/**\n * Whether the control allows text selection within its DOM.  Defaults to false.\n * @type {boolean}\n * @private\n */\ngoog.ui.Control.prototype.allowTextSelection_ = false;\n\n\n/**\n * The control's preferred ARIA role.\n * @type {?goog.a11y.aria.Role}\n * @private\n */\ngoog.ui.Control.prototype.preferredAriaRole_ = null;\n\n\n// Event handler and renderer management.\n\n\n/**\n * Returns true if the control is configured to handle its own mouse events,\n * false otherwise.  Controls not hosted in {@link goog.ui.Container}s have\n * to handle their own mouse events, but controls hosted in containers may\n * allow their parent to handle mouse events on their behalf.  Considered\n * protected; should only be used within this package and by subclasses.\n * @return {boolean} Whether the control handles its own mouse events.\n */\ngoog.ui.Control.prototype.isHandleMouseEvents = function() {\n  return this.handleMouseEvents_;\n};\n\n\n/**\n * Enables or disables mouse event handling for the control.  Containers may\n * use this method to disable mouse event handling in their child controls.\n * Considered protected; should only be used within this package and by\n * subclasses.\n * @param {boolean} enable Whether to enable or disable mouse event handling.\n */\ngoog.ui.Control.prototype.setHandleMouseEvents = function(enable) {\n  if (this.isInDocument() && enable != this.handleMouseEvents_) {\n    // Already in the document; need to update event handler.\n    this.enableMouseEventHandling_(enable);\n  }\n  this.handleMouseEvents_ = enable;\n};\n\n\n/**\n * Returns the DOM element on which the control is listening for keyboard\n * events (null if none).\n * @return {Element} Element on which the control is listening for key\n *     events.\n */\ngoog.ui.Control.prototype.getKeyEventTarget = function() {\n  // Delegate to renderer.\n  return this.renderer_.getKeyEventTarget(this);\n};\n\n\n/**\n * Returns the keyboard event handler for this component, lazily created the\n * first time this method is called.  Considered protected; should only be\n * used within this package and by subclasses.\n * @return {!goog.events.KeyHandler} Keyboard event handler for this component.\n * @protected\n */\ngoog.ui.Control.prototype.getKeyHandler = function() {\n  return this.keyHandler_ || (this.keyHandler_ = new goog.events.KeyHandler());\n};\n\n\n/**\n * Returns the renderer used by this component to render itself or to decorate\n * an existing element.\n * @return {goog.ui.ControlRenderer|undefined} Renderer used by the component\n *     (undefined if none).\n */\ngoog.ui.Control.prototype.getRenderer = function() {\n  return this.renderer_;\n};\n\n\n/**\n * Registers the given renderer with the component.  Changing renderers after\n * the component has entered the document is an error.\n * @param {goog.ui.ControlRenderer} renderer Renderer used by the component.\n * @throws {Error} If the control is already in the document.\n */\ngoog.ui.Control.prototype.setRenderer = function(renderer) {\n  if (this.isInDocument()) {\n    // Too late.\n    throw Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  }\n\n  if (this.getElement()) {\n    // The component has already been rendered, but isn't yet in the document.\n    // Replace the renderer and delete the current DOM, so it can be re-rendered\n    // using the new renderer the next time someone calls render().\n    this.setElementInternal(null);\n  }\n\n  this.renderer_ = renderer;\n};\n\n\n// Support for additional styling.\n\n\n/**\n * Returns any additional class name(s) to be applied to the component's\n * root element, or null if no extra class names are needed.\n * @return {Array<string>?} Additional class names to be applied to\n *     the component's root element (null if none).\n */\ngoog.ui.Control.prototype.getExtraClassNames = function() {\n  return this.extraClassNames_;\n};\n\n\n/**\n * Adds the given class name to the list of classes to be applied to the\n * component's root element.\n * @param {string} className Additional class name to be applied to the\n *     component's root element.\n */\ngoog.ui.Control.prototype.addClassName = function(className) {\n  if (className) {\n    if (this.extraClassNames_) {\n      if (!goog.array.contains(this.extraClassNames_, className)) {\n        this.extraClassNames_.push(className);\n      }\n    } else {\n      this.extraClassNames_ = [className];\n    }\n    this.renderer_.enableExtraClassName(this, className, true);\n  }\n};\n\n\n/**\n * Removes the given class name from the list of classes to be applied to\n * the component's root element.\n * @param {string} className Class name to be removed from the component's root\n *     element.\n */\ngoog.ui.Control.prototype.removeClassName = function(className) {\n  if (className && this.extraClassNames_ &&\n      goog.array.remove(this.extraClassNames_, className)) {\n    if (this.extraClassNames_.length == 0) {\n      this.extraClassNames_ = null;\n    }\n    this.renderer_.enableExtraClassName(this, className, false);\n  }\n};\n\n\n/**\n * Adds or removes the given class name to/from the list of classes to be\n * applied to the component's root element.\n * @param {string} className CSS class name to add or remove.\n * @param {boolean} enable Whether to add or remove the class name.\n */\ngoog.ui.Control.prototype.enableClassName = function(className, enable) {\n  if (enable) {\n    this.addClassName(className);\n  } else {\n    this.removeClassName(className);\n  }\n};\n\n\n// Standard goog.ui.Component implementation.\n\n\n/**\n * Creates the control's DOM.  Overrides {@link goog.ui.Component#createDom} by\n * delegating DOM manipulation to the control's renderer.\n * @override\n */\ngoog.ui.Control.prototype.createDom = function() {\n  var element = this.renderer_.createDom(this);\n  this.setElementInternal(element);\n\n  // Initialize ARIA role.\n  this.renderer_.setAriaRole(element, this.getPreferredAriaRole());\n\n  // Initialize text selection.\n  if (!this.isAllowTextSelection()) {\n    // The renderer is assumed to create selectable elements.  Since making\n    // elements unselectable is expensive, only do it if needed (bug 1037090).\n    this.renderer_.setAllowTextSelection(element, false);\n  }\n\n  // Initialize visibility.\n  if (!this.isVisible()) {\n    // The renderer is assumed to create visible elements. Since hiding\n    // elements can be expensive, only do it if needed (bug 1037105).\n    this.renderer_.setVisible(element, false);\n  }\n};\n\n\n/**\n * Returns the control's preferred ARIA role. This can be used by a control to\n * override the role that would be assigned by the renderer.  This is useful in\n * cases where a different ARIA role is appropriate for a control because of the\n * context in which it's used.  E.g., a {@link goog.ui.MenuButton} added to a\n * {@link goog.ui.Select} should have an ARIA role of LISTBOX and not MENUITEM.\n * @return {?goog.a11y.aria.Role} This control's preferred ARIA role or null if\n *     no preferred ARIA role is set.\n */\ngoog.ui.Control.prototype.getPreferredAriaRole = function() {\n  return this.preferredAriaRole_;\n};\n\n\n/**\n * Sets the control's preferred ARIA role. This can be used to override the role\n * that would be assigned by the renderer.  This is useful in cases where a\n * different ARIA role is appropriate for a control because of the\n * context in which it's used.  E.g., a {@link goog.ui.MenuButton} added to a\n * {@link goog.ui.Select} should have an ARIA role of LISTBOX and not MENUITEM.\n * @param {goog.a11y.aria.Role} role This control's preferred ARIA role.\n */\ngoog.ui.Control.prototype.setPreferredAriaRole = function(role) {\n  this.preferredAriaRole_ = role;\n};\n\n\n/**\n * Gets the control's aria label.\n * @return {?string} This control's aria label.\n */\ngoog.ui.Control.prototype.getAriaLabel = function() {\n  return this.ariaLabel_;\n};\n\n\n/**\n * Sets the control's aria label. This can be used to assign aria label to the\n * element after it is rendered.\n * @param {string} label The string to set as the aria label for this control.\n *     No escaping is done on this value.\n */\ngoog.ui.Control.prototype.setAriaLabel = function(label) {\n  this.ariaLabel_ = label;\n  var element = this.getElement();\n  if (element) {\n    this.renderer_.setAriaLabel(element, label);\n  }\n};\n\n\n/**\n * Returns the DOM element into which child components are to be rendered,\n * or null if the control itself hasn't been rendered yet.  Overrides\n * {@link goog.ui.Component#getContentElement} by delegating to the renderer.\n * @return {Element} Element to contain child elements (null if none).\n * @override\n */\ngoog.ui.Control.prototype.getContentElement = function() {\n  // Delegate to renderer.\n  return this.renderer_.getContentElement(this.getElement());\n};\n\n\n/**\n * Returns true if the given element can be decorated by this component.\n * Overrides {@link goog.ui.Component#canDecorate}.\n * @param {Element} element Element to decorate.\n * @return {boolean} Whether the element can be decorated by this component.\n * @override\n */\ngoog.ui.Control.prototype.canDecorate = function(element) {\n  // Controls support pluggable renderers; delegate to the renderer.\n  return this.renderer_.canDecorate(element);\n};\n\n\n/**\n * Decorates the given element with this component. Overrides {@link\n * goog.ui.Component#decorateInternal} by delegating DOM manipulation\n * to the control's renderer.\n * @param {Element} element Element to decorate.\n * @protected\n * @override\n */\ngoog.ui.Control.prototype.decorateInternal = function(element) {\n  element = this.renderer_.decorate(this, element);\n  this.setElementInternal(element);\n\n  // Initialize ARIA role.\n  this.renderer_.setAriaRole(element, this.getPreferredAriaRole());\n\n  // Initialize text selection.\n  if (!this.isAllowTextSelection()) {\n    // Decorated elements are assumed to be selectable.  Since making elements\n    // unselectable is expensive, only do it if needed (bug 1037090).\n    this.renderer_.setAllowTextSelection(element, false);\n  }\n\n  // Initialize visibility based on the decorated element's styling.\n  this.visible_ = element.style.display != 'none';\n};\n\n\n/**\n * Configures the component after its DOM has been rendered, and sets up event\n * handling.  Overrides {@link goog.ui.Component#enterDocument}.\n * @override\n */\ngoog.ui.Control.prototype.enterDocument = function() {\n  goog.ui.Control.superClass_.enterDocument.call(this);\n\n  // Call the renderer's setAriaStates method to set element's aria attributes.\n  this.renderer_.setAriaStates(this, this.getElementStrict());\n\n  // Call the renderer's initializeDom method to configure properties of the\n  // control's DOM that can only be done once it's in the document.\n  this.renderer_.initializeDom(this);\n\n  // Initialize event handling if at least one state other than DISABLED is\n  // supported.\n  if (this.supportedStates_ & ~goog.ui.Component.State.DISABLED) {\n    // Initialize mouse event handling if the control is configured to handle\n    // its own mouse events.  (Controls hosted in containers don't need to\n    // handle their own mouse events.)\n    if (this.isHandleMouseEvents()) {\n      this.enableMouseEventHandling_(true);\n    }\n\n    // Initialize keyboard event handling if the control is focusable and has\n    // a key event target.  (Controls hosted in containers typically aren't\n    // focusable, allowing their container to handle keyboard events for them.)\n    if (this.isSupportedState(goog.ui.Component.State.FOCUSED)) {\n      var keyTarget = this.getKeyEventTarget();\n      if (keyTarget) {\n        var keyHandler = this.getKeyHandler();\n        keyHandler.attach(keyTarget);\n        this.getHandler()\n            .listen(\n                keyHandler, goog.events.KeyHandler.EventType.KEY,\n                this.handleKeyEvent)\n            .listen(keyTarget, goog.events.EventType.FOCUS, this.handleFocus)\n            .listen(keyTarget, goog.events.EventType.BLUR, this.handleBlur);\n      }\n    }\n  }\n};\n\n\n/**\n * Enables or disables mouse event handling on the control.\n * @param {boolean} enable Whether to enable mouse event handling.\n * @private\n */\ngoog.ui.Control.prototype.enableMouseEventHandling_ = function(enable) {\n  var handler = this.getHandler();\n  var element = this.getElement();\n  if (enable) {\n    handler\n        .listen(element, goog.events.EventType.MOUSEOVER, this.handleMouseOver)\n        .listen(element, goog.events.EventType.MOUSEDOWN, this.handleMouseDown)\n        .listen(element, goog.events.EventType.MOUSEUP, this.handleMouseUp)\n        .listen(element, goog.events.EventType.MOUSEOUT, this.handleMouseOut);\n    if (this.handleContextMenu != goog.nullFunction) {\n      handler.listen(\n          element, goog.events.EventType.CONTEXTMENU, this.handleContextMenu);\n    }\n    if (goog.userAgent.IE) {\n      // Versions of IE before 9 send only one click event followed by a\n      // dblclick, so we must explicitly listen for these. In later versions,\n      // two click events are fired  and so a dblclick listener is unnecessary.\n      if (!goog.userAgent.isVersionOrHigher(9)) {\n        handler.listen(\n            element, goog.events.EventType.DBLCLICK, this.handleDblClick);\n      }\n      if (!this.ieMouseEventSequenceSimulator_) {\n        this.ieMouseEventSequenceSimulator_ =\n            new goog.ui.Control.IeMouseEventSequenceSimulator_(this);\n        this.registerDisposable(this.ieMouseEventSequenceSimulator_);\n      }\n    }\n  } else {\n    handler\n        .unlisten(\n            element, goog.events.EventType.MOUSEOVER, this.handleMouseOver)\n        .unlisten(\n            element, goog.events.EventType.MOUSEDOWN, this.handleMouseDown)\n        .unlisten(element, goog.events.EventType.MOUSEUP, this.handleMouseUp)\n        .unlisten(element, goog.events.EventType.MOUSEOUT, this.handleMouseOut);\n    if (this.handleContextMenu != goog.nullFunction) {\n      handler.unlisten(\n          element, goog.events.EventType.CONTEXTMENU, this.handleContextMenu);\n    }\n    if (goog.userAgent.IE) {\n      if (!goog.userAgent.isVersionOrHigher(9)) {\n        handler.unlisten(\n            element, goog.events.EventType.DBLCLICK, this.handleDblClick);\n      }\n      goog.dispose(this.ieMouseEventSequenceSimulator_);\n      this.ieMouseEventSequenceSimulator_ = null;\n    }\n  }\n};\n\n\n/**\n * Cleans up the component before its DOM is removed from the document, and\n * removes event handlers.  Overrides {@link goog.ui.Component#exitDocument}\n * by making sure that components that are removed from the document aren't\n * focusable (i.e. have no tab index).\n * @override\n */\ngoog.ui.Control.prototype.exitDocument = function() {\n  goog.ui.Control.superClass_.exitDocument.call(this);\n  if (this.keyHandler_) {\n    this.keyHandler_.detach();\n  }\n  if (this.isVisible() && this.isEnabled()) {\n    this.renderer_.setFocusable(this, false);\n  }\n};\n\n\n/** @override */\ngoog.ui.Control.prototype.disposeInternal = function() {\n  goog.ui.Control.superClass_.disposeInternal.call(this);\n  if (this.keyHandler_) {\n    this.keyHandler_.dispose();\n    delete this.keyHandler_;\n  }\n  delete this.renderer_;\n  this.content_ = null;\n  this.extraClassNames_ = null;\n  this.ieMouseEventSequenceSimulator_ = null;\n};\n\n\n// Component content management.\n\n\n/**\n * Returns the text caption or DOM structure displayed in the component.\n * @return {goog.ui.ControlContent} Text caption or DOM structure\n *     comprising the component's contents.\n */\ngoog.ui.Control.prototype.getContent = function() {\n  return this.content_;\n};\n\n\n/**\n * Sets the component's content to the given text caption, element, or array of\n * nodes.  (If the argument is an array of nodes, it must be an actual array,\n * not an array-like object.)\n * @param {goog.ui.ControlContent} content Text caption or DOM\n *     structure to set as the component's contents.\n */\ngoog.ui.Control.prototype.setContent = function(content) {\n  // Controls support pluggable renderers; delegate to the renderer.\n  this.renderer_.setContent(this.getElement(), content);\n\n  // setContentInternal needs to be after the renderer, since the implementation\n  // may depend on the content being in the DOM.\n  this.setContentInternal(content);\n};\n\n\n/**\n * Sets the component's content to the given text caption, element, or array\n * of nodes.  Unlike {@link #setContent}, doesn't modify the component's DOM.\n * Called by renderers during element decoration.\n *\n * This should only be used by subclasses and its associated renderers.\n *\n * @param {goog.ui.ControlContent} content Text caption or DOM structure\n *     to set as the component's contents.\n */\ngoog.ui.Control.prototype.setContentInternal = function(content) {\n  this.content_ = content;\n};\n\n\n/**\n * @return {string} Text caption of the control or empty string if none.\n */\ngoog.ui.Control.prototype.getCaption = function() {\n  var content = this.getContent();\n  if (!content) {\n    return '';\n  }\n  var caption = goog.isString(content) ?\n      content :\n      goog.isArray(content) ?\n      goog.array.map(content, goog.dom.getRawTextContent).join('') :\n      goog.dom.getTextContent(/** @type {!Node} */ (content));\n  return goog.string.collapseBreakingSpaces(caption);\n};\n\n\n/**\n * Sets the text caption of the component.\n * @param {string} caption Text caption of the component.\n */\ngoog.ui.Control.prototype.setCaption = function(caption) {\n  this.setContent(caption);\n};\n\n\n// Component state management.\n\n\n/** @override */\ngoog.ui.Control.prototype.setRightToLeft = function(rightToLeft) {\n  // The superclass implementation ensures the control isn't in the document.\n  goog.ui.Control.superClass_.setRightToLeft.call(this, rightToLeft);\n\n  var element = this.getElement();\n  if (element) {\n    this.renderer_.setRightToLeft(element, rightToLeft);\n  }\n};\n\n\n/**\n * Returns true if the control allows text selection within its DOM, false\n * otherwise.  Controls that disallow text selection have the appropriate\n * unselectable styling applied to their elements.  Note that controls hosted\n * in containers will report that they allow text selection even if their\n * container disallows text selection.\n * @return {boolean} Whether the control allows text selection.\n */\ngoog.ui.Control.prototype.isAllowTextSelection = function() {\n  return this.allowTextSelection_;\n};\n\n\n/**\n * Allows or disallows text selection within the control's DOM.\n * @param {boolean} allow Whether the control should allow text selection.\n */\ngoog.ui.Control.prototype.setAllowTextSelection = function(allow) {\n  this.allowTextSelection_ = allow;\n\n  var element = this.getElement();\n  if (element) {\n    this.renderer_.setAllowTextSelection(element, allow);\n  }\n};\n\n\n/**\n * Returns true if the component's visibility is set to visible, false if\n * it is set to hidden.  A component that is set to hidden is guaranteed\n * to be hidden from the user, but the reverse isn't necessarily true.\n * A component may be set to visible but can otherwise be obscured by another\n * element, rendered off-screen, or hidden using direct CSS manipulation.\n * @return {boolean} Whether the component is visible.\n */\ngoog.ui.Control.prototype.isVisible = function() {\n  return this.visible_;\n};\n\n\n/**\n * Shows or hides the component.  Does nothing if the component already has\n * the requested visibility.  Otherwise, dispatches a SHOW or HIDE event as\n * appropriate, giving listeners a chance to prevent the visibility change.\n * When showing a component that is both enabled and focusable, ensures that\n * its key target has a tab index.  When hiding a component that is enabled\n * and focusable, blurs its key target and removes its tab index.\n * @param {boolean} visible Whether to show or hide the component.\n * @param {boolean=} opt_force If true, doesn't check whether the component\n *     already has the requested visibility, and doesn't dispatch any events.\n * @return {boolean} Whether the visibility was changed.\n */\ngoog.ui.Control.prototype.setVisible = function(visible, opt_force) {\n  if (opt_force || (this.visible_ != visible &&\n                    this.dispatchEvent(\n                        visible ? goog.ui.Component.EventType.SHOW :\n                                  goog.ui.Component.EventType.HIDE))) {\n    var element = this.getElement();\n    if (element) {\n      this.renderer_.setVisible(element, visible);\n    }\n    if (this.isEnabled()) {\n      this.renderer_.setFocusable(this, visible);\n    }\n    this.visible_ = visible;\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Returns true if the component is enabled, false otherwise.\n * @return {boolean} Whether the component is enabled.\n */\ngoog.ui.Control.prototype.isEnabled = function() {\n  return !this.hasState(goog.ui.Component.State.DISABLED);\n};\n\n\n/**\n * Returns true if the control has a parent that is itself disabled, false\n * otherwise.\n * @return {boolean} Whether the component is hosted in a disabled container.\n * @private\n */\ngoog.ui.Control.prototype.isParentDisabled_ = function() {\n  var parent = this.getParent();\n  return !!parent && typeof parent.isEnabled == 'function' &&\n      !parent.isEnabled();\n};\n\n\n/**\n * Enables or disables the component.  Does nothing if this state transition\n * is disallowed.  If the component is both visible and focusable, updates its\n * focused state and tab index as needed.  If the component is being disabled,\n * ensures that it is also deactivated and un-highlighted first.  Note that the\n * component's enabled/disabled state is \"locked\" as long as it is hosted in a\n * {@link goog.ui.Container} that is itself disabled; this is to prevent clients\n * from accidentally re-enabling a control that is in a disabled container.\n * @param {boolean} enable Whether to enable or disable the component.\n * @see #isTransitionAllowed\n */\ngoog.ui.Control.prototype.setEnabled = function(enable) {\n  if (!this.isParentDisabled_() &&\n      this.isTransitionAllowed(goog.ui.Component.State.DISABLED, !enable)) {\n    if (!enable) {\n      this.setActive(false);\n      this.setHighlighted(false);\n    }\n    if (this.isVisible()) {\n      this.renderer_.setFocusable(this, enable);\n    }\n    this.setState(goog.ui.Component.State.DISABLED, !enable, true);\n  }\n};\n\n\n/**\n * Returns true if the component is currently highlighted, false otherwise.\n * @return {boolean} Whether the component is highlighted.\n */\ngoog.ui.Control.prototype.isHighlighted = function() {\n  return this.hasState(goog.ui.Component.State.HOVER);\n};\n\n\n/**\n * Highlights or unhighlights the component.  Does nothing if this state\n * transition is disallowed.\n * @param {boolean} highlight Whether to highlight or unhighlight the component.\n * @see #isTransitionAllowed\n */\ngoog.ui.Control.prototype.setHighlighted = function(highlight) {\n  if (this.isTransitionAllowed(goog.ui.Component.State.HOVER, highlight)) {\n    this.setState(goog.ui.Component.State.HOVER, highlight);\n  }\n};\n\n\n/**\n * Returns true if the component is active (pressed), false otherwise.\n * @return {boolean} Whether the component is active.\n */\ngoog.ui.Control.prototype.isActive = function() {\n  return this.hasState(goog.ui.Component.State.ACTIVE);\n};\n\n\n/**\n * Activates or deactivates the component.  Does nothing if this state\n * transition is disallowed.\n * @param {boolean} active Whether to activate or deactivate the component.\n * @see #isTransitionAllowed\n */\ngoog.ui.Control.prototype.setActive = function(active) {\n  if (this.isTransitionAllowed(goog.ui.Component.State.ACTIVE, active)) {\n    this.setState(goog.ui.Component.State.ACTIVE, active);\n  }\n};\n\n\n/**\n * Returns true if the component is selected, false otherwise.\n * @return {boolean} Whether the component is selected.\n */\ngoog.ui.Control.prototype.isSelected = function() {\n  return this.hasState(goog.ui.Component.State.SELECTED);\n};\n\n\n/**\n * Selects or unselects the component.  Does nothing if this state transition\n * is disallowed.\n * @param {boolean} select Whether to select or unselect the component.\n * @see #isTransitionAllowed\n */\ngoog.ui.Control.prototype.setSelected = function(select) {\n  if (this.isTransitionAllowed(goog.ui.Component.State.SELECTED, select)) {\n    this.setState(goog.ui.Component.State.SELECTED, select);\n  }\n};\n\n\n/**\n * Returns true if the component is checked, false otherwise.\n * @return {boolean} Whether the component is checked.\n */\ngoog.ui.Control.prototype.isChecked = function() {\n  return this.hasState(goog.ui.Component.State.CHECKED);\n};\n\n\n/**\n * Checks or unchecks the component.  Does nothing if this state transition\n * is disallowed.\n * @param {boolean} check Whether to check or uncheck the component.\n * @see #isTransitionAllowed\n */\ngoog.ui.Control.prototype.setChecked = function(check) {\n  if (this.isTransitionAllowed(goog.ui.Component.State.CHECKED, check)) {\n    this.setState(goog.ui.Component.State.CHECKED, check);\n  }\n};\n\n\n/**\n * Returns true if the component is styled to indicate that it has keyboard\n * focus, false otherwise.  Note that {@code isFocused()} returning true\n * doesn't guarantee that the component's key event target has keyborad focus,\n * only that it is styled as such.\n * @return {boolean} Whether the component is styled to indicate as having\n *     keyboard focus.\n */\ngoog.ui.Control.prototype.isFocused = function() {\n  return this.hasState(goog.ui.Component.State.FOCUSED);\n};\n\n\n/**\n * Applies or removes styling indicating that the component has keyboard focus.\n * Note that unlike the other \"set\" methods, this method is called as a result\n * of the component's element having received or lost keyboard focus, not the\n * other way around, so calling {@code setFocused(true)} doesn't guarantee that\n * the component's key event target has keyboard focus, only that it is styled\n * as such.\n * @param {boolean} focused Whether to apply or remove styling to indicate that\n *     the component's element has keyboard focus.\n */\ngoog.ui.Control.prototype.setFocused = function(focused) {\n  if (this.isTransitionAllowed(goog.ui.Component.State.FOCUSED, focused)) {\n    this.setState(goog.ui.Component.State.FOCUSED, focused);\n  }\n};\n\n\n/**\n * Returns true if the component is open (expanded), false otherwise.\n * @return {boolean} Whether the component is open.\n */\ngoog.ui.Control.prototype.isOpen = function() {\n  return this.hasState(goog.ui.Component.State.OPENED);\n};\n\n\n/**\n * Opens (expands) or closes (collapses) the component.  Does nothing if this\n * state transition is disallowed.\n * @param {boolean} open Whether to open or close the component.\n * @see #isTransitionAllowed\n */\ngoog.ui.Control.prototype.setOpen = function(open) {\n  if (this.isTransitionAllowed(goog.ui.Component.State.OPENED, open)) {\n    this.setState(goog.ui.Component.State.OPENED, open);\n  }\n};\n\n\n/**\n * Returns the component's state as a bit mask of {@link\n * goog.ui.Component.State}s.\n * @return {number} Bit mask representing component state.\n */\ngoog.ui.Control.prototype.getState = function() {\n  return this.state_;\n};\n\n\n/**\n * Returns true if the component is in the specified state, false otherwise.\n * @param {goog.ui.Component.State} state State to check.\n * @return {boolean} Whether the component is in the given state.\n */\ngoog.ui.Control.prototype.hasState = function(state) {\n  return !!(this.state_ & state);\n};\n\n\n/**\n * Sets or clears the given state on the component, and updates its styling\n * accordingly.  Does nothing if the component is already in the correct state\n * or if it doesn't support the specified state.  Doesn't dispatch any state\n * transition events; use advisedly.\n * @param {goog.ui.Component.State} state State to set or clear.\n * @param {boolean} enable Whether to set or clear the state (if supported).\n * @param {boolean=} opt_calledFrom Prevents looping with setEnabled.\n */\ngoog.ui.Control.prototype.setState = function(state, enable, opt_calledFrom) {\n  if (!opt_calledFrom && state == goog.ui.Component.State.DISABLED) {\n    this.setEnabled(!enable);\n    return;\n  }\n  if (this.isSupportedState(state) && enable != this.hasState(state)) {\n    // Delegate actual styling to the renderer, since it is DOM-specific.\n    this.renderer_.setState(this, state, enable);\n    this.state_ = enable ? this.state_ | state : this.state_ & ~state;\n  }\n};\n\n\n/**\n * Sets the component's state to the state represented by a bit mask of\n * {@link goog.ui.Component.State}s.  Unlike {@link #setState}, doesn't\n * update the component's styling, and doesn't reject unsupported states.\n * Called by renderers during element decoration.  Considered protected;\n * should only be used within this package and by subclasses.\n *\n * This should only be used by subclasses and its associated renderers.\n *\n * @param {number} state Bit mask representing component state.\n */\ngoog.ui.Control.prototype.setStateInternal = function(state) {\n  this.state_ = state;\n};\n\n\n/**\n * Returns true if the component supports the specified state, false otherwise.\n * @param {goog.ui.Component.State} state State to check.\n * @return {boolean} Whether the component supports the given state.\n */\ngoog.ui.Control.prototype.isSupportedState = function(state) {\n  return !!(this.supportedStates_ & state);\n};\n\n\n/**\n * Enables or disables support for the given state. Disabling support\n * for a state while the component is in that state is an error.\n * @param {goog.ui.Component.State} state State to support or de-support.\n * @param {boolean} support Whether the component should support the state.\n * @throws {Error} If disabling support for a state the control is currently in.\n */\ngoog.ui.Control.prototype.setSupportedState = function(state, support) {\n  if (this.isInDocument() && this.hasState(state) && !support) {\n    // Since we hook up event handlers in enterDocument(), this is an error.\n    throw Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  }\n\n  if (!support && this.hasState(state)) {\n    // We are removing support for a state that the component is currently in.\n    this.setState(state, false);\n  }\n\n  this.supportedStates_ =\n      support ? this.supportedStates_ | state : this.supportedStates_ & ~state;\n};\n\n\n/**\n * Returns true if the component provides default event handling for the state,\n * false otherwise.\n * @param {goog.ui.Component.State} state State to check.\n * @return {boolean} Whether the component provides default event handling for\n *     the state.\n */\ngoog.ui.Control.prototype.isAutoState = function(state) {\n  return !!(this.autoStates_ & state) && this.isSupportedState(state);\n};\n\n\n/**\n * Enables or disables automatic event handling for the given state(s).\n * @param {number} states Bit mask of {@link goog.ui.Component.State}s for which\n *     default event handling is to be enabled or disabled.\n * @param {boolean} enable Whether the component should provide default event\n *     handling for the state(s).\n */\ngoog.ui.Control.prototype.setAutoStates = function(states, enable) {\n  this.autoStates_ =\n      enable ? this.autoStates_ | states : this.autoStates_ & ~states;\n};\n\n\n/**\n * Returns true if the component is set to dispatch transition events for the\n * given state, false otherwise.\n * @param {goog.ui.Component.State} state State to check.\n * @return {boolean} Whether the component dispatches transition events for\n *     the state.\n */\ngoog.ui.Control.prototype.isDispatchTransitionEvents = function(state) {\n  return !!(this.statesWithTransitionEvents_ & state) &&\n      this.isSupportedState(state);\n};\n\n\n/**\n * Enables or disables transition events for the given state(s).  Controls\n * handle state transitions internally by default, and only dispatch state\n * transition events if explicitly requested to do so by calling this method.\n * @param {number} states Bit mask of {@link goog.ui.Component.State}s for\n *     which transition events should be enabled or disabled.\n * @param {boolean} enable Whether transition events should be enabled.\n */\ngoog.ui.Control.prototype.setDispatchTransitionEvents = function(\n    states, enable) {\n  this.statesWithTransitionEvents_ = enable ?\n      this.statesWithTransitionEvents_ | states :\n      this.statesWithTransitionEvents_ & ~states;\n};\n\n\n/**\n * Returns true if the transition into or out of the given state is allowed to\n * proceed, false otherwise.  A state transition is allowed under the following\n * conditions:\n * <ul>\n *   <li>the component supports the state,\n *   <li>the component isn't already in the target state,\n *   <li>either the component is configured not to dispatch events for this\n *       state transition, or a transition event was dispatched and wasn't\n *       canceled by any event listener, and\n *   <li>the component hasn't been disposed of\n * </ul>\n * Considered protected; should only be used within this package and by\n * subclasses.\n * @param {goog.ui.Component.State} state State to/from which the control is\n *     transitioning.\n * @param {boolean} enable Whether the control is entering or leaving the state.\n * @return {boolean} Whether the state transition is allowed to proceed.\n * @protected\n */\ngoog.ui.Control.prototype.isTransitionAllowed = function(state, enable) {\n  return this.isSupportedState(state) && this.hasState(state) != enable &&\n      (!(this.statesWithTransitionEvents_ & state) ||\n       this.dispatchEvent(\n           goog.ui.Component.getStateTransitionEvent(state, enable))) &&\n      !this.isDisposed();\n};\n\n\n// Default event handlers, to be overridden in subclasses.\n\n\n/**\n * Handles mouseover events.  Dispatches an ENTER event; if the event isn't\n * canceled, the component is enabled, and it supports auto-highlighting,\n * highlights the component.  Considered protected; should only be used\n * within this package and by subclasses.\n * @param {goog.events.BrowserEvent} e Mouse event to handle.\n */\ngoog.ui.Control.prototype.handleMouseOver = function(e) {\n  // Ignore mouse moves between descendants.\n  if (!goog.ui.Control.isMouseEventWithinElement_(e, this.getElement()) &&\n      this.dispatchEvent(goog.ui.Component.EventType.ENTER) &&\n      this.isEnabled() && this.isAutoState(goog.ui.Component.State.HOVER)) {\n    this.setHighlighted(true);\n  }\n};\n\n\n/**\n * Handles mouseout events.  Dispatches a LEAVE event; if the event isn't\n * canceled, and the component supports auto-highlighting, deactivates and\n * un-highlights the component.  Considered protected; should only be used\n * within this package and by subclasses.\n * @param {goog.events.BrowserEvent} e Mouse event to handle.\n */\ngoog.ui.Control.prototype.handleMouseOut = function(e) {\n  if (!goog.ui.Control.isMouseEventWithinElement_(e, this.getElement()) &&\n      this.dispatchEvent(goog.ui.Component.EventType.LEAVE)) {\n    if (this.isAutoState(goog.ui.Component.State.ACTIVE)) {\n      // Deactivate on mouseout; otherwise we lose track of the mouse button.\n      this.setActive(false);\n    }\n    if (this.isAutoState(goog.ui.Component.State.HOVER)) {\n      this.setHighlighted(false);\n    }\n  }\n};\n\n\n/**\n * Handles contextmenu events.\n * @param {goog.events.BrowserEvent} e Event to handle.\n */\ngoog.ui.Control.prototype.handleContextMenu = goog.nullFunction;\n\n\n/**\n * Checks if a mouse event (mouseover or mouseout) occurred below an element.\n * @param {goog.events.BrowserEvent} e Mouse event (should be mouseover or\n *     mouseout).\n * @param {Element} elem The ancestor element.\n * @return {boolean} Whether the event has a relatedTarget (the element the\n *     mouse is coming from) and it's a descendent of elem.\n * @private\n */\ngoog.ui.Control.isMouseEventWithinElement_ = function(e, elem) {\n  // If relatedTarget is null, it means there was no previous element (e.g.\n  // the mouse moved out of the window).  Assume this means that the mouse\n  // event was not within the element.\n  return !!e.relatedTarget && goog.dom.contains(elem, e.relatedTarget);\n};\n\n\n/**\n * Handles mousedown events.  If the component is enabled, highlights and\n * activates it.  If the component isn't configured for keyboard access,\n * prevents it from receiving keyboard focus.  Considered protected; should\n * only be used within this package and by subclasses.\n * @param {goog.events.Event} e Mouse event to handle.\n */\ngoog.ui.Control.prototype.handleMouseDown = function(e) {\n  if (this.isEnabled()) {\n    // Highlight enabled control on mousedown, regardless of the mouse button.\n    if (this.isAutoState(goog.ui.Component.State.HOVER)) {\n      this.setHighlighted(true);\n    }\n\n    // For the left button only, activate the control, and focus its key event\n    // target (if supported).\n    if (e.isMouseActionButton()) {\n      if (this.isAutoState(goog.ui.Component.State.ACTIVE)) {\n        this.setActive(true);\n      }\n      if (this.renderer_ && this.renderer_.isFocusable(this)) {\n        this.getKeyEventTarget().focus();\n      }\n    }\n  }\n\n  // Cancel the default action unless the control allows text selection.\n  if (!this.isAllowTextSelection() && e.isMouseActionButton()) {\n    e.preventDefault();\n  }\n};\n\n\n/**\n * Handles mouseup events.  If the component is enabled, highlights it.  If\n * the component has previously been activated, performs its associated action\n * by calling {@link performActionInternal}, then deactivates it.  Considered\n * protected; should only be used within this package and by subclasses.\n * @param {goog.events.Event} e Mouse event to handle.\n */\ngoog.ui.Control.prototype.handleMouseUp = function(e) {\n  if (this.isEnabled()) {\n    if (this.isAutoState(goog.ui.Component.State.HOVER)) {\n      this.setHighlighted(true);\n    }\n    if (this.isActive() && this.performActionInternal(e) &&\n        this.isAutoState(goog.ui.Component.State.ACTIVE)) {\n      this.setActive(false);\n    }\n  }\n};\n\n\n/**\n * Handles dblclick events.  Should only be registered if the user agent is\n * IE.  If the component is enabled, performs its associated action by calling\n * {@link performActionInternal}.  This is used to allow more performant\n * buttons in IE.  In IE, no mousedown event is fired when that mousedown will\n * trigger a dblclick event.  Because of this, a user clicking quickly will\n * only cause ACTION events to fire on every other click.  This is a workaround\n * to generate ACTION events for every click.  Unfortunately, this workaround\n * won't ever trigger the ACTIVE state.  This is roughly the same behaviour as\n * if this were a 'button' element with a listener on mouseup.  Considered\n * protected; should only be used within this package and by subclasses.\n * @param {goog.events.Event} e Mouse event to handle.\n */\ngoog.ui.Control.prototype.handleDblClick = function(e) {\n  if (this.isEnabled()) {\n    this.performActionInternal(e);\n  }\n};\n\n\n/**\n * Performs the appropriate action when the control is activated by the user.\n * The default implementation first updates the checked and selected state of\n * controls that support them, then dispatches an ACTION event.  Considered\n * protected; should only be used within this package and by subclasses.\n * @param {goog.events.Event} e Event that triggered the action.\n * @return {boolean} Whether the action is allowed to proceed.\n * @protected\n */\ngoog.ui.Control.prototype.performActionInternal = function(e) {\n  if (this.isAutoState(goog.ui.Component.State.CHECKED)) {\n    this.setChecked(!this.isChecked());\n  }\n  if (this.isAutoState(goog.ui.Component.State.SELECTED)) {\n    this.setSelected(true);\n  }\n  if (this.isAutoState(goog.ui.Component.State.OPENED)) {\n    this.setOpen(!this.isOpen());\n  }\n\n  var actionEvent =\n      new goog.events.Event(goog.ui.Component.EventType.ACTION, this);\n  if (e) {\n    actionEvent.altKey = e.altKey;\n    actionEvent.ctrlKey = e.ctrlKey;\n    actionEvent.metaKey = e.metaKey;\n    actionEvent.shiftKey = e.shiftKey;\n    actionEvent.platformModifierKey = e.platformModifierKey;\n  }\n  return this.dispatchEvent(actionEvent);\n};\n\n\n/**\n * Handles focus events on the component's key event target element.  If the\n * component is focusable, updates its state and styling to indicate that it\n * now has keyboard focus.  Considered protected; should only be used within\n * this package and by subclasses.  <b>Warning:</b> IE dispatches focus and\n * blur events asynchronously!\n * @param {goog.events.Event} e Focus event to handle.\n */\ngoog.ui.Control.prototype.handleFocus = function(e) {\n  if (this.isAutoState(goog.ui.Component.State.FOCUSED)) {\n    this.setFocused(true);\n  }\n};\n\n\n/**\n * Handles blur events on the component's key event target element.  Always\n * deactivates the component.  In addition, if the component is focusable,\n * updates its state and styling to indicate that it no longer has keyboard\n * focus.  Considered protected; should only be used within this package and\n * by subclasses.  <b>Warning:</b> IE dispatches focus and blur events\n * asynchronously!\n * @param {goog.events.Event} e Blur event to handle.\n */\ngoog.ui.Control.prototype.handleBlur = function(e) {\n  if (this.isAutoState(goog.ui.Component.State.ACTIVE)) {\n    this.setActive(false);\n  }\n  if (this.isAutoState(goog.ui.Component.State.FOCUSED)) {\n    this.setFocused(false);\n  }\n};\n\n\n/**\n * Attempts to handle a keyboard event, if the component is enabled and visible,\n * by calling {@link handleKeyEventInternal}.  Considered protected; should only\n * be used within this package and by subclasses.\n * @param {goog.events.KeyEvent} e Key event to handle.\n * @return {boolean} Whether the key event was handled.\n */\ngoog.ui.Control.prototype.handleKeyEvent = function(e) {\n  if (this.isVisible() && this.isEnabled() && this.handleKeyEventInternal(e)) {\n    e.preventDefault();\n    e.stopPropagation();\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Attempts to handle a keyboard event; returns true if the event was handled,\n * false otherwise.  Considered protected; should only be used within this\n * package and by subclasses.\n * @param {goog.events.KeyEvent} e Key event to handle.\n * @return {boolean} Whether the key event was handled.\n * @protected\n */\ngoog.ui.Control.prototype.handleKeyEventInternal = function(e) {\n  return e.keyCode == goog.events.KeyCodes.ENTER &&\n      this.performActionInternal(e);\n};\n\n\n// Register the default renderer for goog.ui.Controls.\ngoog.ui.registry.setDefaultRenderer(goog.ui.Control, goog.ui.ControlRenderer);\n\n\n// Register a decorator factory function for goog.ui.Controls.\ngoog.ui.registry.setDecoratorByClassName(\n    goog.ui.ControlRenderer.CSS_CLASS,\n    function() { return new goog.ui.Control(null); });\n\n\n\n/**\n * A singleton that helps goog.ui.Control instances play well with screen\n * readers.  It necessitated by shortcomings in IE, and need not be\n * instantiated in any other browser.\n *\n * In most cases, a click on a goog.ui.Control results in a sequence of events:\n * MOUSEDOWN, MOUSEUP and CLICK.  UI controls rely on this sequence since most\n * behavior is trigged by MOUSEDOWN and MOUSEUP.  But when IE is used with some\n * traditional screen readers (JAWS, NVDA and perhaps others), IE only sends\n * the CLICK event, resulting in the control being unresponsive.  This class\n * monitors the sequence of these events, and if it detects a CLICK event not\n * not preceded by a MOUSEUP event, directly calls the control's event handlers\n * for MOUSEDOWN, then MOUSEUP.  While the resulting sequence is different from\n * the norm (the CLICK comes first instead of last), testing thus far shows\n * the resulting behavior to be correct.\n *\n * See http://goo.gl/qvQR4C for more details.\n *\n * @param {!goog.ui.Control} control\n * @constructor\n * @extends {goog.Disposable}\n * @private\n */\ngoog.ui.Control.IeMouseEventSequenceSimulator_ = function(control) {\n  goog.ui.Control.IeMouseEventSequenceSimulator_.base(this, 'constructor');\n\n  /** @private {goog.ui.Control}*/\n  this.control_ = control;\n\n  /** @private {boolean} */\n  this.clickExpected_ = false;\n\n  /** @private @const {!goog.events.EventHandler<\n   *                       !goog.ui.Control.IeMouseEventSequenceSimulator_>}\n   */\n  this.handler_ = new goog.events.EventHandler(this);\n  this.registerDisposable(this.handler_);\n\n  var element = this.control_.getElementStrict();\n  this.handler_\n      .listen(element, goog.events.EventType.MOUSEDOWN, this.handleMouseDown_)\n      .listen(element, goog.events.EventType.MOUSEUP, this.handleMouseUp_)\n      .listen(element, goog.events.EventType.CLICK, this.handleClick_);\n};\ngoog.inherits(goog.ui.Control.IeMouseEventSequenceSimulator_, goog.Disposable);\n\n\n/**\n * Whether this browser supports synthetic MouseEvents.\n *\n * See https://msdn.microsoft.com/library/dn905219(v=vs.85).aspx for details.\n *\n * @private {boolean}\n * @const\n */\ngoog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_ =\n    !goog.userAgent.IE || goog.userAgent.isDocumentModeOrHigher(9);\n\n\n/** @private */\ngoog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleMouseDown_ =\n    function() {\n  this.clickExpected_ = false;\n};\n\n\n/** @private */\ngoog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleMouseUp_ =\n    function() {\n  this.clickExpected_ = true;\n};\n\n\n/**\n * @param {!MouseEvent} e\n * @param {goog.events.EventType} typeArg\n * @return {!MouseEvent}\n * @private\n */\ngoog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_ = function(\n    e, typeArg) {\n  'use strict';\n\n  if (!goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_) {\n    // IE < 9 does not support synthetic mouse events. Therefore, reuse the\n    // existing MouseEvent by overwriting the read only button and type\n    // properties. As IE < 9 does not support ES5 strict mode this will not\n    // generate an exception even when the script specifies \"use strict\".\n    e.button = goog.events.BrowserEvent.MouseButton.LEFT;\n    e.type = typeArg;\n    return e;\n  }\n\n  var event = /** @type {!MouseEvent} */ (document.createEvent('MouseEvents'));\n  event.initMouseEvent(\n      typeArg, e.bubbles, e.cancelable,\n      e.view || null,  // IE9 errors if view is undefined\n      e.detail, e.screenX, e.screenY, e.clientX, e.clientY, e.ctrlKey, e.altKey,\n      e.shiftKey, e.metaKey, goog.events.BrowserEvent.MouseButton.LEFT,\n      e.relatedTarget || null);  // IE9 errors if relatedTarget is undefined\n  return event;\n};\n\n\n/**\n * @param {!goog.events.Event} e\n * @private\n */\ngoog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleClick_ =\n    function(e) {\n  if (this.clickExpected_) {\n    // This is the end of a normal click sequence: mouse-down, mouse-up, click.\n    // Assume appropriate actions have already been performed.\n    this.clickExpected_ = false;\n    return;\n  }\n\n  // For click events not part of a normal sequence, similate the mouse-down and\n  // mouse-up events by creating synthetic events for each and directly invoke\n  // the corresponding event listeners in order.\n\n  var browserEvent = /** @type {goog.events.BrowserEvent} */ (e);\n\n  var event = /** @type {!MouseEvent} */ (browserEvent.getBrowserEvent());\n  var origEventButton = event.button;\n  var origEventType = event.type;\n\n  var down = goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_(\n      event, goog.events.EventType.MOUSEDOWN);\n  this.control_.handleMouseDown(\n      new goog.events.BrowserEvent(down, browserEvent.currentTarget));\n\n  var up = goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_(\n      event, goog.events.EventType.MOUSEUP);\n  this.control_.handleMouseUp(\n      new goog.events.BrowserEvent(up, browserEvent.currentTarget));\n\n  if (goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_) {\n    // This browser supports synthetic events. Avoid resetting the read only\n    // properties (type, button) as they were not overwritten and writing them\n    // results in an exception when running in ES5 strict mode.\n    return;\n  }\n\n  // Restore original values for click handlers that have not yet been invoked.\n  event.button = origEventButton;\n  event.type = origEventType;\n};\n\n\n/** @override */\ngoog.ui.Control.IeMouseEventSequenceSimulator_.prototype.disposeInternal =\n    function() {\n  this.control_ = null;\n  goog.ui.Control.IeMouseEventSequenceSimulator_.base(this, 'disposeInternal');\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Base class for containers that host {@link goog.ui.Control}s,\n * such as menus and toolbars.  Provides default keyboard and mouse event\n * handling and child management, based on a generalized version of\n * {@link goog.ui.Menu}.\n *\n * @author attila@google.com (Attila Bodis)\n * @see ../demos/container.html\n */\n// TODO(attila):  Fix code/logic duplication between this and goog.ui.Control.\n// TODO(attila):  Maybe pull common stuff all the way up into Component...?\n\ngoog.provide('goog.ui.Container');\ngoog.provide('goog.ui.Container.EventType');\ngoog.provide('goog.ui.Container.Orientation');\n\ngoog.require('goog.a11y.aria');\ngoog.require('goog.a11y.aria.State');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.events.EventType');\ngoog.require('goog.events.KeyCodes');\ngoog.require('goog.events.KeyHandler');\ngoog.require('goog.object');\ngoog.require('goog.style');\ngoog.require('goog.ui.Component');\ngoog.require('goog.ui.ContainerRenderer');\ngoog.require('goog.ui.Control');\n\n\n\n/**\n * Base class for containers.  Extends {@link goog.ui.Component} by adding\n * the following:\n *  <ul>\n *    <li>a {@link goog.events.KeyHandler}, to simplify keyboard handling,\n *    <li>a pluggable <em>renderer</em> framework, to simplify the creation of\n *        containers without the need to subclass this class,\n *    <li>methods to manage child controls hosted in the container,\n *    <li>default mouse and keyboard event handling methods.\n *  </ul>\n * @param {?goog.ui.Container.Orientation=} opt_orientation Container\n *     orientation; defaults to {@code VERTICAL}.\n * @param {goog.ui.ContainerRenderer=} opt_renderer Renderer used to render or\n *     decorate the container; defaults to {@link goog.ui.ContainerRenderer}.\n * @param {goog.dom.DomHelper=} opt_domHelper DOM helper, used for document\n *     interaction.\n * @extends {goog.ui.Component}\n * @constructor\n */\ngoog.ui.Container = function(opt_orientation, opt_renderer, opt_domHelper) {\n  goog.ui.Component.call(this, opt_domHelper);\n  this.renderer_ = opt_renderer || goog.ui.ContainerRenderer.getInstance();\n  this.orientation_ = opt_orientation || this.renderer_.getDefaultOrientation();\n};\ngoog.inherits(goog.ui.Container, goog.ui.Component);\ngoog.tagUnsealableClass(goog.ui.Container);\n\n\n/**\n * Container-specific events.\n * @enum {string}\n */\ngoog.ui.Container.EventType = {\n  /**\n   * Dispatched after a goog.ui.Container becomes visible. Non-cancellable.\n   * NOTE(user): This event really shouldn't exist, because the\n   * goog.ui.Component.EventType.SHOW event should behave like this one. But the\n   * SHOW event for containers has been behaving as other components'\n   * BEFORE_SHOW event for a long time, and too much code relies on that old\n   * behavior to fix it now.\n   */\n  AFTER_SHOW: 'aftershow',\n\n  /**\n   * Dispatched after a goog.ui.Container becomes invisible. Non-cancellable.\n   */\n  AFTER_HIDE: 'afterhide'\n};\n\n\n/**\n * Container orientation constants.\n * @enum {string}\n */\ngoog.ui.Container.Orientation = {\n  HORIZONTAL: 'horizontal',\n  VERTICAL: 'vertical'\n};\n\n\n/**\n * Allows an alternative element to be set to receive key events, otherwise\n * defers to the renderer's element choice.\n * @type {Element|undefined}\n * @private\n */\ngoog.ui.Container.prototype.keyEventTarget_ = null;\n\n\n/**\n * Keyboard event handler.\n * @type {goog.events.KeyHandler?}\n * @private\n */\ngoog.ui.Container.prototype.keyHandler_ = null;\n\n\n/**\n * Renderer for the container.  Defaults to {@link goog.ui.ContainerRenderer}.\n * @type {goog.ui.ContainerRenderer?}\n * @private\n */\ngoog.ui.Container.prototype.renderer_ = null;\n\n\n/**\n * Container orientation; determines layout and default keyboard navigation.\n * @type {?goog.ui.Container.Orientation}\n * @private\n */\ngoog.ui.Container.prototype.orientation_ = null;\n\n\n/**\n * Whether the container is set to be visible.  Defaults to true.\n * @type {boolean}\n * @private\n */\ngoog.ui.Container.prototype.visible_ = true;\n\n\n/**\n * Whether the container is enabled and reacting to keyboard and mouse events.\n * Defaults to true.\n * @type {boolean}\n * @private\n */\ngoog.ui.Container.prototype.enabled_ = true;\n\n\n/**\n * Whether the container supports keyboard focus.  Defaults to true.  Focusable\n * containers have a {@code tabIndex} and can be navigated to via the keyboard.\n * @type {boolean}\n * @private\n */\ngoog.ui.Container.prototype.focusable_ = true;\n\n\n/**\n * The 0-based index of the currently highlighted control in the container\n * (-1 if none).\n * @type {number}\n * @private\n */\ngoog.ui.Container.prototype.highlightedIndex_ = -1;\n\n\n/**\n * The currently open (expanded) control in the container (null if none).\n * @type {goog.ui.Control?}\n * @private\n */\ngoog.ui.Container.prototype.openItem_ = null;\n\n\n/**\n * Whether the mouse button is held down.  Defaults to false.  This flag is set\n * when the user mouses down over the container, and remains set until they\n * release the mouse button.\n * @type {boolean}\n * @private\n */\ngoog.ui.Container.prototype.mouseButtonPressed_ = false;\n\n\n/**\n * Whether focus of child components should be allowed.  Only effective if\n * focusable_ is set to false.\n * @type {boolean}\n * @private\n */\ngoog.ui.Container.prototype.allowFocusableChildren_ = false;\n\n\n/**\n * Whether highlighting a child component should also open it.\n * @type {boolean}\n * @private\n */\ngoog.ui.Container.prototype.openFollowsHighlight_ = true;\n\n\n/**\n * Map of DOM IDs to child controls.  Each key is the DOM ID of a child\n * control's root element; each value is a reference to the child control\n * itself.  Used for looking up the child control corresponding to a DOM\n * node in O(1) time.\n * @type {Object}\n * @private\n */\ngoog.ui.Container.prototype.childElementIdMap_ = null;\n\n\n// Event handler and renderer management.\n\n\n/**\n * Returns the DOM element on which the container is listening for keyboard\n * events (null if none).\n * @return {Element} Element on which the container is listening for key\n *     events.\n */\ngoog.ui.Container.prototype.getKeyEventTarget = function() {\n  // Delegate to renderer, unless we've set an explicit target.\n  return this.keyEventTarget_ || this.renderer_.getKeyEventTarget(this);\n};\n\n\n/**\n * Attaches an element on which to listen for key events.\n * @param {Element|undefined} element The element to attach, or null/undefined\n *     to attach to the default element.\n */\ngoog.ui.Container.prototype.setKeyEventTarget = function(element) {\n  if (this.focusable_) {\n    var oldTarget = this.getKeyEventTarget();\n    var inDocument = this.isInDocument();\n\n    this.keyEventTarget_ = element;\n    var newTarget = this.getKeyEventTarget();\n\n    if (inDocument) {\n      // Unlisten for events on the old key target.  Requires us to reset\n      // key target state temporarily.\n      this.keyEventTarget_ = oldTarget;\n      this.enableFocusHandling_(false);\n      this.keyEventTarget_ = element;\n\n      // Listen for events on the new key target.\n      this.getKeyHandler().attach(newTarget);\n      this.enableFocusHandling_(true);\n    }\n  } else {\n    throw Error(\n        'Can\\'t set key event target for container ' +\n        'that doesn\\'t support keyboard focus!');\n  }\n};\n\n\n/**\n * Returns the keyboard event handler for this container, lazily created the\n * first time this method is called.  The keyboard event handler listens for\n * keyboard events on the container's key event target, as determined by its\n * renderer.\n * @return {!goog.events.KeyHandler} Keyboard event handler for this container.\n */\ngoog.ui.Container.prototype.getKeyHandler = function() {\n  return this.keyHandler_ ||\n      (this.keyHandler_ = new goog.events.KeyHandler(this.getKeyEventTarget()));\n};\n\n\n/**\n * Returns the renderer used by this container to render itself or to decorate\n * an existing element.\n * @return {goog.ui.ContainerRenderer} Renderer used by the container.\n */\ngoog.ui.Container.prototype.getRenderer = function() {\n  return this.renderer_;\n};\n\n\n/**\n * Registers the given renderer with the container.  Changing renderers after\n * the container has already been rendered or decorated is an error.\n * @param {goog.ui.ContainerRenderer} renderer Renderer used by the container.\n */\ngoog.ui.Container.prototype.setRenderer = function(renderer) {\n  if (this.getElement()) {\n    // Too late.\n    throw Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  }\n\n  this.renderer_ = renderer;\n};\n\n\n// Standard goog.ui.Component implementation.\n\n\n/**\n * Creates the container's DOM.\n * @override\n */\ngoog.ui.Container.prototype.createDom = function() {\n  // Delegate to renderer.\n  this.setElementInternal(this.renderer_.createDom(this));\n};\n\n\n/**\n * Returns the DOM element into which child components are to be rendered,\n * or null if the container itself hasn't been rendered yet.  Overrides\n * {@link goog.ui.Component#getContentElement} by delegating to the renderer.\n * @return {Element} Element to contain child elements (null if none).\n * @override\n */\ngoog.ui.Container.prototype.getContentElement = function() {\n  // Delegate to renderer.\n  return this.renderer_.getContentElement(this.getElement());\n};\n\n\n/**\n * Returns true if the given element can be decorated by this container.\n * Overrides {@link goog.ui.Component#canDecorate}.\n * @param {Element} element Element to decorate.\n * @return {boolean} True iff the element can be decorated.\n * @override\n */\ngoog.ui.Container.prototype.canDecorate = function(element) {\n  // Delegate to renderer.\n  return this.renderer_.canDecorate(element);\n};\n\n\n/**\n * Decorates the given element with this container. Overrides {@link\n * goog.ui.Component#decorateInternal}.  Considered protected.\n * @param {Element} element Element to decorate.\n * @override\n */\ngoog.ui.Container.prototype.decorateInternal = function(element) {\n  // Delegate to renderer.\n  this.setElementInternal(this.renderer_.decorate(this, element));\n  // Check whether the decorated element is explicitly styled to be invisible.\n  if (element.style.display == 'none') {\n    this.visible_ = false;\n  }\n};\n\n\n/**\n * Configures the container after its DOM has been rendered, and sets up event\n * handling.  Overrides {@link goog.ui.Component#enterDocument}.\n * @override\n */\ngoog.ui.Container.prototype.enterDocument = function() {\n  goog.ui.Container.superClass_.enterDocument.call(this);\n\n  this.forEachChild(function(child) {\n    if (child.isInDocument()) {\n      this.registerChildId_(child);\n    }\n  }, this);\n\n  var elem = this.getElement();\n\n  // Call the renderer's initializeDom method to initialize the container's DOM.\n  this.renderer_.initializeDom(this);\n\n  // Initialize visibility (opt_force = true, so we don't dispatch events).\n  this.setVisible(this.visible_, true);\n\n  // Handle events dispatched by child controls.\n  this.getHandler()\n      .listen(this, goog.ui.Component.EventType.ENTER, this.handleEnterItem)\n      .listen(\n          this, goog.ui.Component.EventType.HIGHLIGHT, this.handleHighlightItem)\n      .listen(\n          this, goog.ui.Component.EventType.UNHIGHLIGHT,\n          this.handleUnHighlightItem)\n      .listen(this, goog.ui.Component.EventType.OPEN, this.handleOpenItem)\n      .listen(this, goog.ui.Component.EventType.CLOSE, this.handleCloseItem)\n      .\n\n      // Handle mouse events.\n      listen(elem, goog.events.EventType.MOUSEDOWN, this.handleMouseDown)\n      .listen(\n          goog.dom.getOwnerDocument(elem), goog.events.EventType.MOUSEUP,\n          this.handleDocumentMouseUp)\n      .\n\n      // Handle mouse events on behalf of controls in the container.\n      listen(\n          elem,\n          [\n            goog.events.EventType.MOUSEDOWN, goog.events.EventType.MOUSEUP,\n            goog.events.EventType.MOUSEOVER, goog.events.EventType.MOUSEOUT,\n            goog.events.EventType.CONTEXTMENU\n          ],\n          this.handleChildMouseEvents);\n\n  // If the container is focusable, set up keyboard event handling.\n  if (this.isFocusable()) {\n    this.enableFocusHandling_(true);\n  }\n};\n\n\n/**\n * Sets up listening for events applicable to focusable containers.\n * @param {boolean} enable Whether to enable or disable focus handling.\n * @private\n */\ngoog.ui.Container.prototype.enableFocusHandling_ = function(enable) {\n  var handler = this.getHandler();\n  var keyTarget = this.getKeyEventTarget();\n  if (enable) {\n    handler.listen(keyTarget, goog.events.EventType.FOCUS, this.handleFocus)\n        .listen(keyTarget, goog.events.EventType.BLUR, this.handleBlur)\n        .listen(\n            this.getKeyHandler(), goog.events.KeyHandler.EventType.KEY,\n            this.handleKeyEvent);\n  } else {\n    handler.unlisten(keyTarget, goog.events.EventType.FOCUS, this.handleFocus)\n        .unlisten(keyTarget, goog.events.EventType.BLUR, this.handleBlur)\n        .unlisten(\n            this.getKeyHandler(), goog.events.KeyHandler.EventType.KEY,\n            this.handleKeyEvent);\n  }\n};\n\n\n/**\n * Cleans up the container before its DOM is removed from the document, and\n * removes event handlers.  Overrides {@link goog.ui.Component#exitDocument}.\n * @override\n */\ngoog.ui.Container.prototype.exitDocument = function() {\n  // {@link #setHighlightedIndex} has to be called before\n  // {@link goog.ui.Component#exitDocument}, otherwise it has no effect.\n  this.setHighlightedIndex(-1);\n\n  if (this.openItem_) {\n    this.openItem_.setOpen(false);\n  }\n\n  this.mouseButtonPressed_ = false;\n\n  goog.ui.Container.superClass_.exitDocument.call(this);\n};\n\n\n/** @override */\ngoog.ui.Container.prototype.disposeInternal = function() {\n  goog.ui.Container.superClass_.disposeInternal.call(this);\n\n  if (this.keyHandler_) {\n    this.keyHandler_.dispose();\n    this.keyHandler_ = null;\n  }\n\n  this.keyEventTarget_ = null;\n  this.childElementIdMap_ = null;\n  this.openItem_ = null;\n  this.renderer_ = null;\n};\n\n\n// Default event handlers.\n\n\n/**\n * Handles ENTER events raised by child controls when they are navigated to.\n * @param {goog.events.Event} e ENTER event to handle.\n * @return {boolean} Whether to prevent handleMouseOver from handling\n *    the event.\n */\ngoog.ui.Container.prototype.handleEnterItem = function(e) {\n  // Allow the Control to highlight itself.\n  return true;\n};\n\n\n/**\n * Handles HIGHLIGHT events dispatched by items in the container when\n * they are highlighted.\n * @param {goog.events.Event} e Highlight event to handle.\n */\ngoog.ui.Container.prototype.handleHighlightItem = function(e) {\n  var index = this.indexOfChild(/** @type {goog.ui.Control} */ (e.target));\n  if (index > -1 && index != this.highlightedIndex_) {\n    var item = this.getHighlighted();\n    if (item) {\n      // Un-highlight previously highlighted item.\n      item.setHighlighted(false);\n    }\n\n    this.highlightedIndex_ = index;\n    item = this.getHighlighted();\n\n    if (this.isMouseButtonPressed()) {\n      // Activate item when mouse button is pressed, to allow MacOS-style\n      // dragging to choose menu items.  Although this should only truly\n      // happen if the highlight is due to mouse movements, there is little\n      // harm in doing it for keyboard or programmatic highlights.\n      item.setActive(true);\n    }\n\n    // Update open item if open item needs follow highlight.\n    if (this.openFollowsHighlight_ && this.openItem_ &&\n        item != this.openItem_) {\n      if (item.isSupportedState(goog.ui.Component.State.OPENED)) {\n        item.setOpen(true);\n      } else {\n        this.openItem_.setOpen(false);\n      }\n    }\n  }\n\n  var element = this.getElement();\n  goog.asserts.assert(\n      element, 'The DOM element for the container cannot be null.');\n  if (e.target.getElement() != null) {\n    goog.a11y.aria.setState(\n        element, goog.a11y.aria.State.ACTIVEDESCENDANT,\n        e.target.getElement().id);\n  }\n};\n\n\n/**\n * Handles UNHIGHLIGHT events dispatched by items in the container when\n * they are unhighlighted.\n * @param {goog.events.Event} e Unhighlight event to handle.\n */\ngoog.ui.Container.prototype.handleUnHighlightItem = function(e) {\n  if (e.target == this.getHighlighted()) {\n    this.highlightedIndex_ = -1;\n  }\n  var element = this.getElement();\n  goog.asserts.assert(\n      element, 'The DOM element for the container cannot be null.');\n  // Setting certain ARIA attributes to empty strings is problematic.\n  // Just remove the attribute instead.\n  goog.a11y.aria.removeState(element, goog.a11y.aria.State.ACTIVEDESCENDANT);\n};\n\n\n/**\n * Handles OPEN events dispatched by items in the container when they are\n * opened.\n * @param {goog.events.Event} e Open event to handle.\n */\ngoog.ui.Container.prototype.handleOpenItem = function(e) {\n  var item = /** @type {goog.ui.Control} */ (e.target);\n  if (item && item != this.openItem_ && item.getParent() == this) {\n    if (this.openItem_) {\n      this.openItem_.setOpen(false);\n    }\n    this.openItem_ = item;\n  }\n};\n\n\n/**\n * Handles CLOSE events dispatched by items in the container when they are\n * closed.\n * @param {goog.events.Event} e Close event to handle.\n */\ngoog.ui.Container.prototype.handleCloseItem = function(e) {\n  if (e.target == this.openItem_) {\n    this.openItem_ = null;\n  }\n\n  var element = this.getElement();\n  var targetEl = e.target.getElement();\n  // Set the active descendant to the menu item when its submenu is closed and\n  // it is still highlighted. This can sometimes be called when the menuitem is\n  // unhighlighted because the focus moved elsewhere, do nothing at that point.\n  if (element && e.target.isHighlighted() && targetEl) {\n    goog.a11y.aria.setActiveDescendant(element, targetEl);\n  }\n};\n\n\n/**\n * Handles mousedown events over the container.  The default implementation\n * sets the \"mouse button pressed\" flag and, if the container is focusable,\n * grabs keyboard focus.\n * @param {goog.events.BrowserEvent} e Mousedown event to handle.\n */\ngoog.ui.Container.prototype.handleMouseDown = function(e) {\n  if (this.enabled_) {\n    this.setMouseButtonPressed(true);\n  }\n\n  var keyTarget = this.getKeyEventTarget();\n  if (keyTarget && goog.dom.isFocusableTabIndex(keyTarget)) {\n    // The container is configured to receive keyboard focus.\n    keyTarget.focus();\n  } else {\n    // The control isn't configured to receive keyboard focus; prevent it\n    // from stealing focus or destroying the selection.\n    e.preventDefault();\n  }\n};\n\n\n/**\n * Handles mouseup events over the document.  The default implementation\n * clears the \"mouse button pressed\" flag.\n * @param {goog.events.BrowserEvent} e Mouseup event to handle.\n */\ngoog.ui.Container.prototype.handleDocumentMouseUp = function(e) {\n  this.setMouseButtonPressed(false);\n};\n\n\n/**\n * Handles mouse events originating from nodes belonging to the controls hosted\n * in the container.  Locates the child control based on the DOM node that\n * dispatched the event, and forwards the event to the control for handling.\n * @param {goog.events.BrowserEvent} e Mouse event to handle.\n */\ngoog.ui.Container.prototype.handleChildMouseEvents = function(e) {\n  var control = this.getOwnerControl(/** @type {Node} */ (e.target));\n  if (control) {\n    // Child control identified; forward the event.\n    switch (e.type) {\n      case goog.events.EventType.MOUSEDOWN:\n        control.handleMouseDown(e);\n        break;\n      case goog.events.EventType.MOUSEUP:\n        control.handleMouseUp(e);\n        break;\n      case goog.events.EventType.MOUSEOVER:\n        control.handleMouseOver(e);\n        break;\n      case goog.events.EventType.MOUSEOUT:\n        control.handleMouseOut(e);\n        break;\n      case goog.events.EventType.CONTEXTMENU:\n        control.handleContextMenu(e);\n        break;\n    }\n  }\n};\n\n\n/**\n * Returns the child control that owns the given DOM node, or null if no such\n * control is found.\n * @param {Node} node DOM node whose owner is to be returned.\n * @return {goog.ui.Control?} Control hosted in the container to which the node\n *     belongs (if found).\n * @protected\n */\ngoog.ui.Container.prototype.getOwnerControl = function(node) {\n  // Ensure that this container actually has child controls before\n  // looking up the owner.\n  if (this.childElementIdMap_) {\n    var elem = this.getElement();\n    // See http://b/2964418 . IE9 appears to evaluate '!=' incorrectly, so\n    // using '!==' instead.\n    // TODO(user): Possibly revert this change if/when IE9 fixes the issue.\n    while (node && node !== elem) {\n      var id = node.id;\n      if (id in this.childElementIdMap_) {\n        return this.childElementIdMap_[id];\n      }\n      node = node.parentNode;\n    }\n  }\n  return null;\n};\n\n\n/**\n * Handles focus events raised when the container's key event target receives\n * keyboard focus.\n * @param {goog.events.BrowserEvent} e Focus event to handle.\n */\ngoog.ui.Container.prototype.handleFocus = function(e) {\n  // No-op in the base class.\n};\n\n\n/**\n * Handles blur events raised when the container's key event target loses\n * keyboard focus.  The default implementation clears the highlight index.\n * @param {goog.events.BrowserEvent} e Blur event to handle.\n */\ngoog.ui.Container.prototype.handleBlur = function(e) {\n  this.setHighlightedIndex(-1);\n  this.setMouseButtonPressed(false);\n  // If the container loses focus, and one of its children is open, close it.\n  if (this.openItem_) {\n    this.openItem_.setOpen(false);\n  }\n};\n\n\n/**\n * Attempts to handle a keyboard event, if the control is enabled, by calling\n * {@link handleKeyEventInternal}.  Considered protected; should only be used\n * within this package and by subclasses.\n * @param {goog.events.KeyEvent} e Key event to handle.\n * @return {boolean} Whether the key event was handled.\n */\ngoog.ui.Container.prototype.handleKeyEvent = function(e) {\n  if (this.isEnabled() && this.isVisible() &&\n      (this.getChildCount() != 0 || this.keyEventTarget_) &&\n      this.handleKeyEventInternal(e)) {\n    e.preventDefault();\n    e.stopPropagation();\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Attempts to handle a keyboard event; returns true if the event was handled,\n * false otherwise.  If the container is enabled, and a child is highlighted,\n * calls the child control's {@code handleKeyEvent} method to give the control\n * a chance to handle the event first.\n * @param {goog.events.KeyEvent} e Key event to handle.\n * @return {boolean} Whether the event was handled by the container (or one of\n *     its children).\n */\ngoog.ui.Container.prototype.handleKeyEventInternal = function(e) {\n  // Give the highlighted control the chance to handle the key event.\n  var highlighted = this.getHighlighted();\n  if (highlighted && typeof highlighted.handleKeyEvent == 'function' &&\n      highlighted.handleKeyEvent(e)) {\n    return true;\n  }\n\n  // Give the open control the chance to handle the key event.\n  if (this.openItem_ && this.openItem_ != highlighted &&\n      typeof this.openItem_.handleKeyEvent == 'function' &&\n      this.openItem_.handleKeyEvent(e)) {\n    return true;\n  }\n\n  // Do not handle the key event if any modifier key is pressed.\n  if (e.shiftKey || e.ctrlKey || e.metaKey || e.altKey) {\n    return false;\n  }\n\n  // Either nothing is highlighted, or the highlighted control didn't handle\n  // the key event, so attempt to handle it here.\n  switch (e.keyCode) {\n    case goog.events.KeyCodes.ESC:\n      if (this.isFocusable()) {\n        this.getKeyEventTarget().blur();\n      } else {\n        return false;\n      }\n      break;\n\n    case goog.events.KeyCodes.HOME:\n      this.highlightFirst();\n      break;\n\n    case goog.events.KeyCodes.END:\n      this.highlightLast();\n      break;\n\n    case goog.events.KeyCodes.UP:\n      if (this.orientation_ == goog.ui.Container.Orientation.VERTICAL) {\n        this.highlightPrevious();\n      } else {\n        return false;\n      }\n      break;\n\n    case goog.events.KeyCodes.LEFT:\n      if (this.orientation_ == goog.ui.Container.Orientation.HORIZONTAL) {\n        if (this.isRightToLeft()) {\n          this.highlightNext();\n        } else {\n          this.highlightPrevious();\n        }\n      } else {\n        return false;\n      }\n      break;\n\n    case goog.events.KeyCodes.DOWN:\n      if (this.orientation_ == goog.ui.Container.Orientation.VERTICAL) {\n        this.highlightNext();\n      } else {\n        return false;\n      }\n      break;\n\n    case goog.events.KeyCodes.RIGHT:\n      if (this.orientation_ == goog.ui.Container.Orientation.HORIZONTAL) {\n        if (this.isRightToLeft()) {\n          this.highlightPrevious();\n        } else {\n          this.highlightNext();\n        }\n      } else {\n        return false;\n      }\n      break;\n\n    default:\n      return false;\n  }\n\n  return true;\n};\n\n\n// Child component management.\n\n\n/**\n * Creates a DOM ID for the child control and registers it to an internal\n * hash table to be able to find it fast by id.\n * @param {goog.ui.Component} child The child control. Its root element has\n *     to be created yet.\n * @private\n */\ngoog.ui.Container.prototype.registerChildId_ = function(child) {\n  // Map the DOM ID of the control's root element to the control itself.\n  var childElem = child.getElement();\n\n  // If the control's root element doesn't have a DOM ID assign one.\n  var id = childElem.id || (childElem.id = child.getId());\n\n  // Lazily create the child element ID map on first use.\n  if (!this.childElementIdMap_) {\n    this.childElementIdMap_ = {};\n  }\n  this.childElementIdMap_[id] = child;\n};\n\n\n/**\n * Adds the specified control as the last child of this container.  See\n * {@link goog.ui.Container#addChildAt} for detailed semantics.\n * @param {goog.ui.Component} child The new child control.\n * @param {boolean=} opt_render Whether the new child should be rendered\n *     immediately after being added (defaults to false).\n * @override\n */\ngoog.ui.Container.prototype.addChild = function(child, opt_render) {\n  goog.asserts.assertInstanceof(\n      child, goog.ui.Control, 'The child of a container must be a control');\n  goog.ui.Container.superClass_.addChild.call(this, child, opt_render);\n};\n\n\n/**\n * Overrides {@link goog.ui.Container#getChild} to make it clear that it\n * only returns {@link goog.ui.Control}s.\n * @param {string} id Child component ID.\n * @return {goog.ui.Control} The child with the given ID; null if none.\n * @override\n */\ngoog.ui.Container.prototype.getChild;\n\n\n/**\n * Overrides {@link goog.ui.Container#getChildAt} to make it clear that it\n * only returns {@link goog.ui.Control}s.\n * @param {number} index 0-based index.\n * @return {goog.ui.Control} The child with the given ID; null if none.\n * @override\n */\ngoog.ui.Container.prototype.getChildAt;\n\n\n/**\n * Adds the control as a child of this container at the given 0-based index.\n * Overrides {@link goog.ui.Component#addChildAt} by also updating the\n * container's highlight index.  Since {@link goog.ui.Component#addChild} uses\n * {@link #addChildAt} internally, we only need to override this method.\n * @param {goog.ui.Component} control New child.\n * @param {number} index Index at which the new child is to be added.\n * @param {boolean=} opt_render Whether the new child should be rendered\n *     immediately after being added (defaults to false).\n * @override\n */\ngoog.ui.Container.prototype.addChildAt = function(control, index, opt_render) {\n  goog.asserts.assertInstanceof(control, goog.ui.Control);\n\n  // Make sure the child control dispatches HIGHLIGHT, UNHIGHLIGHT, OPEN, and\n  // CLOSE events, and that it doesn't steal keyboard focus.\n  control.setDispatchTransitionEvents(goog.ui.Component.State.HOVER, true);\n  control.setDispatchTransitionEvents(goog.ui.Component.State.OPENED, true);\n  if (this.isFocusable() || !this.isFocusableChildrenAllowed()) {\n    control.setSupportedState(goog.ui.Component.State.FOCUSED, false);\n  }\n\n  // Disable mouse event handling by child controls.\n  control.setHandleMouseEvents(false);\n\n  var srcIndex =\n      (control.getParent() == this) ? this.indexOfChild(control) : -1;\n\n  // Let the superclass implementation do the work.\n  goog.ui.Container.superClass_.addChildAt.call(\n      this, control, index, opt_render);\n\n  if (control.isInDocument() && this.isInDocument()) {\n    this.registerChildId_(control);\n  }\n\n  this.updateHighlightedIndex_(srcIndex, index);\n};\n\n\n/**\n * Updates the highlighted index when children are added or moved.\n * @param {number} fromIndex Index of the child before it was moved, or -1 if\n *     the child was added.\n * @param {number} toIndex Index of the child after it was moved or added.\n * @private\n */\ngoog.ui.Container.prototype.updateHighlightedIndex_ = function(\n    fromIndex, toIndex) {\n  if (fromIndex == -1) {\n    fromIndex = this.getChildCount();\n  }\n  if (fromIndex == this.highlightedIndex_) {\n    // The highlighted element itself was moved.\n    this.highlightedIndex_ = Math.min(this.getChildCount() - 1, toIndex);\n  } else if (\n      fromIndex > this.highlightedIndex_ && toIndex <= this.highlightedIndex_) {\n    // The control was added or moved behind the highlighted index.\n    this.highlightedIndex_++;\n  } else if (\n      fromIndex < this.highlightedIndex_ && toIndex > this.highlightedIndex_) {\n    // The control was moved from before to behind the highlighted index.\n    this.highlightedIndex_--;\n  }\n};\n\n\n/**\n * Removes a child control.  Overrides {@link goog.ui.Component#removeChild} by\n * updating the highlight index.  Since {@link goog.ui.Component#removeChildAt}\n * uses {@link #removeChild} internally, we only need to override this method.\n * @param {string|goog.ui.Component} control The ID of the child to remove, or\n *     the control itself.\n * @param {boolean=} opt_unrender Whether to call {@code exitDocument} on the\n *     removed control, and detach its DOM from the document (defaults to\n *     false).\n * @return {goog.ui.Control} The removed control, if any.\n * @override\n */\ngoog.ui.Container.prototype.removeChild = function(control, opt_unrender) {\n  control = goog.isString(control) ? this.getChild(control) : control;\n  goog.asserts.assertInstanceof(control, goog.ui.Control);\n\n  if (control) {\n    var index = this.indexOfChild(control);\n    if (index != -1) {\n      if (index == this.highlightedIndex_) {\n        control.setHighlighted(false);\n        this.highlightedIndex_ = -1;\n      } else if (index < this.highlightedIndex_) {\n        this.highlightedIndex_--;\n      }\n    }\n\n    // Remove the mapping from the child element ID map.\n    var childElem = control.getElement();\n    if (childElem && childElem.id && this.childElementIdMap_) {\n      goog.object.remove(this.childElementIdMap_, childElem.id);\n    }\n  }\n\n  control = /** @type {!goog.ui.Control} */ (\n      goog.ui.Container.superClass_.removeChild.call(\n          this, control, opt_unrender));\n\n  // Re-enable mouse event handling (in case the control is reused elsewhere).\n  control.setHandleMouseEvents(true);\n\n  return control;\n};\n\n\n// Container state management.\n\n\n/**\n * Returns the container's orientation.\n * @return {?goog.ui.Container.Orientation} Container orientation.\n */\ngoog.ui.Container.prototype.getOrientation = function() {\n  return this.orientation_;\n};\n\n\n/**\n * Sets the container's orientation.\n * @param {goog.ui.Container.Orientation} orientation Container orientation.\n */\n// TODO(attila): Do we need to support containers with dynamic orientation?\ngoog.ui.Container.prototype.setOrientation = function(orientation) {\n  if (this.getElement()) {\n    // Too late.\n    throw Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  }\n\n  this.orientation_ = orientation;\n};\n\n\n/**\n * Returns true if the container's visibility is set to visible, false if\n * it is set to hidden.  A container that is set to hidden is guaranteed\n * to be hidden from the user, but the reverse isn't necessarily true.\n * A container may be set to visible but can otherwise be obscured by another\n * element, rendered off-screen, or hidden using direct CSS manipulation.\n * @return {boolean} Whether the container is set to be visible.\n */\ngoog.ui.Container.prototype.isVisible = function() {\n  return this.visible_;\n};\n\n\n/**\n * Shows or hides the container.  Does nothing if the container already has\n * the requested visibility.  Otherwise, dispatches a SHOW or HIDE event as\n * appropriate, giving listeners a chance to prevent the visibility change.\n * @param {boolean} visible Whether to show or hide the container.\n * @param {boolean=} opt_force If true, doesn't check whether the container\n *     already has the requested visibility, and doesn't dispatch any events.\n * @return {boolean} Whether the visibility was changed.\n */\ngoog.ui.Container.prototype.setVisible = function(visible, opt_force) {\n  if (opt_force || (this.visible_ != visible &&\n                    this.dispatchEvent(\n                        visible ? goog.ui.Component.EventType.SHOW :\n                                  goog.ui.Component.EventType.HIDE))) {\n    this.visible_ = visible;\n\n    var elem = this.getElement();\n    if (elem) {\n      goog.style.setElementShown(elem, visible);\n      if (this.isFocusable()) {\n        // Enable keyboard access only for enabled & visible containers.\n        this.renderer_.enableTabIndex(\n            this.getKeyEventTarget(), this.enabled_ && this.visible_);\n      }\n      if (!opt_force) {\n        this.dispatchEvent(\n            this.visible_ ? goog.ui.Container.EventType.AFTER_SHOW :\n                            goog.ui.Container.EventType.AFTER_HIDE);\n      }\n    }\n\n    return true;\n  }\n\n  return false;\n};\n\n\n/**\n * Returns true if the container is enabled, false otherwise.\n * @return {boolean} Whether the container is enabled.\n */\ngoog.ui.Container.prototype.isEnabled = function() {\n  return this.enabled_;\n};\n\n\n/**\n * Enables/disables the container based on the {@code enable} argument.\n * Dispatches an {@code ENABLED} or {@code DISABLED} event prior to changing\n * the container's state, which may be caught and canceled to prevent the\n * container from changing state.  Also enables/disables child controls.\n * @param {boolean} enable Whether to enable or disable the container.\n */\ngoog.ui.Container.prototype.setEnabled = function(enable) {\n  if (this.enabled_ != enable &&\n      this.dispatchEvent(\n          enable ? goog.ui.Component.EventType.ENABLE :\n                   goog.ui.Component.EventType.DISABLE)) {\n    if (enable) {\n      // Flag the container as enabled first, then update children.  This is\n      // because controls can't be enabled if their parent is disabled.\n      this.enabled_ = true;\n      this.forEachChild(function(child) {\n        // Enable child control unless it is flagged.\n        if (child.wasDisabled) {\n          delete child.wasDisabled;\n        } else {\n          child.setEnabled(true);\n        }\n      });\n    } else {\n      // Disable children first, then flag the container as disabled.  This is\n      // because controls can't be disabled if their parent is already disabled.\n      this.forEachChild(function(child) {\n        // Disable child control, or flag it if it's already disabled.\n        if (child.isEnabled()) {\n          child.setEnabled(false);\n        } else {\n          child.wasDisabled = true;\n        }\n      });\n      this.enabled_ = false;\n      this.setMouseButtonPressed(false);\n    }\n\n    if (this.isFocusable()) {\n      // Enable keyboard access only for enabled & visible components.\n      this.renderer_.enableTabIndex(\n          this.getKeyEventTarget(), enable && this.visible_);\n    }\n  }\n};\n\n\n/**\n * Returns true if the container is focusable, false otherwise.  The default\n * is true.  Focusable containers always have a tab index and allocate a key\n * handler to handle keyboard events while focused.\n * @return {boolean} Whether the component is focusable.\n */\ngoog.ui.Container.prototype.isFocusable = function() {\n  return this.focusable_;\n};\n\n\n/**\n * Sets whether the container is focusable.  The default is true.  Focusable\n * containers always have a tab index and allocate a key handler to handle\n * keyboard events while focused.\n * @param {boolean} focusable Whether the component is to be focusable.\n */\ngoog.ui.Container.prototype.setFocusable = function(focusable) {\n  if (focusable != this.focusable_ && this.isInDocument()) {\n    this.enableFocusHandling_(focusable);\n  }\n  this.focusable_ = focusable;\n  if (this.enabled_ && this.visible_) {\n    this.renderer_.enableTabIndex(this.getKeyEventTarget(), focusable);\n  }\n};\n\n\n/**\n * Returns true if the container allows children to be focusable, false\n * otherwise.  Only effective if the container is not focusable.\n * @return {boolean} Whether children should be focusable.\n */\ngoog.ui.Container.prototype.isFocusableChildrenAllowed = function() {\n  return this.allowFocusableChildren_;\n};\n\n\n/**\n * Sets whether the container allows children to be focusable, false\n * otherwise.  Only effective if the container is not focusable.\n * @param {boolean} focusable Whether the children should be focusable.\n */\ngoog.ui.Container.prototype.setFocusableChildrenAllowed = function(focusable) {\n  this.allowFocusableChildren_ = focusable;\n};\n\n\n/**\n * @return {boolean} Whether highlighting a child component should also open it.\n */\ngoog.ui.Container.prototype.isOpenFollowsHighlight = function() {\n  return this.openFollowsHighlight_;\n};\n\n\n/**\n * Sets whether highlighting a child component should also open it.\n * @param {boolean} follow Whether highlighting a child component also opens it.\n */\ngoog.ui.Container.prototype.setOpenFollowsHighlight = function(follow) {\n  this.openFollowsHighlight_ = follow;\n};\n\n\n// Highlight management.\n\n\n/**\n * Returns the index of the currently highlighted item (-1 if none).\n * @return {number} Index of the currently highlighted item.\n */\ngoog.ui.Container.prototype.getHighlightedIndex = function() {\n  return this.highlightedIndex_;\n};\n\n\n/**\n * Highlights the item at the given 0-based index (if any).  If another item\n * was previously highlighted, it is un-highlighted.\n * @param {number} index Index of item to highlight (-1 removes the current\n *     highlight).\n */\ngoog.ui.Container.prototype.setHighlightedIndex = function(index) {\n  var child = this.getChildAt(index);\n  if (child) {\n    child.setHighlighted(true);\n  } else if (this.highlightedIndex_ > -1) {\n    this.getHighlighted().setHighlighted(false);\n  }\n};\n\n\n/**\n * Highlights the given item if it exists and is a child of the container;\n * otherwise un-highlights the currently highlighted item.\n * @param {goog.ui.Control} item Item to highlight.\n */\ngoog.ui.Container.prototype.setHighlighted = function(item) {\n  this.setHighlightedIndex(this.indexOfChild(item));\n};\n\n\n/**\n * Returns the currently highlighted item (if any).\n * @return {goog.ui.Control?} Highlighted item (null if none).\n */\ngoog.ui.Container.prototype.getHighlighted = function() {\n  return this.getChildAt(this.highlightedIndex_);\n};\n\n\n/**\n * Highlights the first highlightable item in the container\n */\ngoog.ui.Container.prototype.highlightFirst = function() {\n  this.highlightHelper(function(index, max) {\n    return (index + 1) % max;\n  }, this.getChildCount() - 1);\n};\n\n\n/**\n * Highlights the last highlightable item in the container.\n */\ngoog.ui.Container.prototype.highlightLast = function() {\n  this.highlightHelper(function(index, max) {\n    index--;\n    return index < 0 ? max - 1 : index;\n  }, 0);\n};\n\n\n/**\n * Highlights the next highlightable item (or the first if nothing is currently\n * highlighted).\n */\ngoog.ui.Container.prototype.highlightNext = function() {\n  this.highlightHelper(function(index, max) {\n    return (index + 1) % max;\n  }, this.highlightedIndex_);\n};\n\n\n/**\n * Highlights the previous highlightable item (or the last if nothing is\n * currently highlighted).\n */\ngoog.ui.Container.prototype.highlightPrevious = function() {\n  this.highlightHelper(function(index, max) {\n    index--;\n    return index < 0 ? max - 1 : index;\n  }, this.highlightedIndex_);\n};\n\n\n/**\n * Helper function that manages the details of moving the highlight among\n * child controls in response to keyboard events.\n * @param {function(this: goog.ui.Container, number, number) : number} fn\n *     Function that accepts the current and maximum indices, and returns the\n *     next index to check.\n * @param {number} startIndex Start index.\n * @return {boolean} Whether the highlight has changed.\n * @protected\n */\ngoog.ui.Container.prototype.highlightHelper = function(fn, startIndex) {\n  // If the start index is -1 (meaning there's nothing currently highlighted),\n  // try starting from the currently open item, if any.\n  var curIndex =\n      startIndex < 0 ? this.indexOfChild(this.openItem_) : startIndex;\n  var numItems = this.getChildCount();\n\n  curIndex = fn.call(this, curIndex, numItems);\n  var visited = 0;\n  while (visited <= numItems) {\n    var control = this.getChildAt(curIndex);\n    if (control && this.canHighlightItem(control)) {\n      this.setHighlightedIndexFromKeyEvent(curIndex);\n      return true;\n    }\n    visited++;\n    curIndex = fn.call(this, curIndex, numItems);\n  }\n  return false;\n};\n\n\n/**\n * Returns whether the given item can be highlighted.\n * @param {goog.ui.Control} item The item to check.\n * @return {boolean} Whether the item can be highlighted.\n * @protected\n */\ngoog.ui.Container.prototype.canHighlightItem = function(item) {\n  return item.isVisible() && item.isEnabled() &&\n      item.isSupportedState(goog.ui.Component.State.HOVER);\n};\n\n\n/**\n * Helper method that sets the highlighted index to the given index in response\n * to a keyboard event.  The base class implementation simply calls the\n * {@link #setHighlightedIndex} method, but subclasses can override this\n * behavior as needed.\n * @param {number} index Index of item to highlight.\n * @protected\n */\ngoog.ui.Container.prototype.setHighlightedIndexFromKeyEvent = function(index) {\n  this.setHighlightedIndex(index);\n};\n\n\n/**\n * Returns the currently open (expanded) control in the container (null if\n * none).\n * @return {goog.ui.Control?} The currently open control.\n */\ngoog.ui.Container.prototype.getOpenItem = function() {\n  return this.openItem_;\n};\n\n\n/**\n * Returns true if the mouse button is pressed, false otherwise.\n * @return {boolean} Whether the mouse button is pressed.\n */\ngoog.ui.Container.prototype.isMouseButtonPressed = function() {\n  return this.mouseButtonPressed_;\n};\n\n\n/**\n * Sets or clears the \"mouse button pressed\" flag.\n * @param {boolean} pressed Whether the mouse button is presed.\n */\ngoog.ui.Container.prototype.setMouseButtonPressed = function(pressed) {\n  this.mouseButtonPressed_ = pressed;\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Renderer for {@link goog.ui.MenuHeader}s.\n *\n */\n\ngoog.provide('goog.ui.MenuHeaderRenderer');\n\ngoog.require('goog.ui.ControlRenderer');\n\n\n\n/**\n * Renderer for menu headers.\n * @constructor\n * @extends {goog.ui.ControlRenderer}\n */\ngoog.ui.MenuHeaderRenderer = function() {\n  goog.ui.ControlRenderer.call(this);\n};\ngoog.inherits(goog.ui.MenuHeaderRenderer, goog.ui.ControlRenderer);\ngoog.addSingletonGetter(goog.ui.MenuHeaderRenderer);\n\n\n/**\n * Default CSS class to be applied to the root element of components rendered\n * by this renderer.\n * @type {string}\n */\ngoog.ui.MenuHeaderRenderer.CSS_CLASS = goog.getCssName('goog-menuheader');\n\n\n/**\n * Returns the CSS class to be applied to the root element of components\n * rendered using this renderer.\n * @return {string} Renderer-specific CSS class.\n * @override\n */\ngoog.ui.MenuHeaderRenderer.prototype.getCssClass = function() {\n  return goog.ui.MenuHeaderRenderer.CSS_CLASS;\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A class for representing menu headers.\n * @see goog.ui.Menu\n *\n */\n\ngoog.provide('goog.ui.MenuHeader');\n\ngoog.require('goog.ui.Component');\ngoog.require('goog.ui.Control');\ngoog.require('goog.ui.MenuHeaderRenderer');\ngoog.require('goog.ui.registry');\n\n\n\n/**\n * Class representing a menu header.\n * @param {goog.ui.ControlContent} content Text caption or DOM structure to\n *     display as the content of the item (use to add icons or styling to\n *     menus).\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper used for\n *     document interactions.\n * @param {goog.ui.MenuHeaderRenderer=} opt_renderer Optional renderer.\n * @constructor\n * @extends {goog.ui.Control}\n */\ngoog.ui.MenuHeader = function(content, opt_domHelper, opt_renderer) {\n  goog.ui.Control.call(\n      this, content, opt_renderer || goog.ui.MenuHeaderRenderer.getInstance(),\n      opt_domHelper);\n\n  this.setSupportedState(goog.ui.Component.State.DISABLED, false);\n  this.setSupportedState(goog.ui.Component.State.HOVER, false);\n  this.setSupportedState(goog.ui.Component.State.ACTIVE, false);\n  this.setSupportedState(goog.ui.Component.State.FOCUSED, false);\n\n  // Headers are always considered disabled.\n  this.setStateInternal(goog.ui.Component.State.DISABLED);\n};\ngoog.inherits(goog.ui.MenuHeader, goog.ui.Control);\n\n\n// Register a decorator factory function for goog.ui.MenuHeaders.\ngoog.ui.registry.setDecoratorByClassName(\n    goog.ui.MenuHeaderRenderer.CSS_CLASS, function() {\n      // MenuHeader defaults to using MenuHeaderRenderer.\n      return new goog.ui.MenuHeader(null);\n    });\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Renderer for {@link goog.ui.MenuItem}s.\n *\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.MenuItemRenderer');\n\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.classlist');\ngoog.require('goog.ui.Component');\ngoog.require('goog.ui.ControlRenderer');\n\n\n\n/**\n * Default renderer for {@link goog.ui.MenuItem}s.  Each item has the following\n * structure:\n *\n *    <div class=\"goog-menuitem\">\n *      <div class=\"goog-menuitem-content\">\n *        ...(menu item contents)...\n *      </div>\n *    </div>\n *\n * @constructor\n * @extends {goog.ui.ControlRenderer}\n */\ngoog.ui.MenuItemRenderer = function() {\n  goog.ui.ControlRenderer.call(this);\n\n  /**\n   * Commonly used CSS class names, cached here for convenience (and to avoid\n   * unnecessary string concatenation).\n   * @type {!Array<string>}\n   * @private\n   */\n  this.classNameCache_ = [];\n};\ngoog.inherits(goog.ui.MenuItemRenderer, goog.ui.ControlRenderer);\ngoog.addSingletonGetter(goog.ui.MenuItemRenderer);\n\n\n/**\n * CSS class name the renderer applies to menu item elements.\n * @type {string}\n */\ngoog.ui.MenuItemRenderer.CSS_CLASS = goog.getCssName('goog-menuitem');\n\n\n/**\n * Constants for referencing composite CSS classes.\n * @enum {number}\n * @private\n */\ngoog.ui.MenuItemRenderer.CompositeCssClassIndex_ = {\n  HOVER: 0,\n  CHECKBOX: 1,\n  CONTENT: 2\n};\n\n\n/**\n * Returns the composite CSS class by using the cached value or by constructing\n * the value from the base CSS class and the passed index.\n * @param {goog.ui.MenuItemRenderer.CompositeCssClassIndex_} index Index for the\n *     CSS class - could be highlight, checkbox or content in usual cases.\n * @return {string} The composite CSS class.\n * @private\n */\ngoog.ui.MenuItemRenderer.prototype.getCompositeCssClass_ = function(index) {\n  var result = this.classNameCache_[index];\n  if (!result) {\n    switch (index) {\n      case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER:\n        result = goog.getCssName(this.getStructuralCssClass(), 'highlight');\n        break;\n      case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX:\n        result = goog.getCssName(this.getStructuralCssClass(), 'checkbox');\n        break;\n      case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT:\n        result = goog.getCssName(this.getStructuralCssClass(), 'content');\n        break;\n    }\n    this.classNameCache_[index] = result;\n  }\n\n  return result;\n};\n\n\n/** @override */\ngoog.ui.MenuItemRenderer.prototype.getAriaRole = function() {\n  return goog.a11y.aria.Role.MENU_ITEM;\n};\n\n\n/**\n * Overrides {@link goog.ui.ControlRenderer#createDom} by adding extra markup\n * and stying to the menu item's element if it is selectable or checkable.\n * @param {goog.ui.Control} item Menu item to render.\n * @return {Element} Root element for the item.\n * @override\n */\ngoog.ui.MenuItemRenderer.prototype.createDom = function(item) {\n  var element = item.getDomHelper().createDom(\n      goog.dom.TagName.DIV, this.getClassNames(item).join(' '),\n      this.createContent(item.getContent(), item.getDomHelper()));\n  this.setEnableCheckBoxStructure(\n      item, element, item.isSupportedState(goog.ui.Component.State.SELECTED) ||\n          item.isSupportedState(goog.ui.Component.State.CHECKED));\n  return element;\n};\n\n\n/** @override */\ngoog.ui.MenuItemRenderer.prototype.getContentElement = function(element) {\n  return /** @type {Element} */ (element && element.firstChild);\n};\n\n\n/**\n * Overrides {@link goog.ui.ControlRenderer#decorate} by initializing the\n * menu item to checkable based on whether the element to be decorated has\n * extra stying indicating that it should be.\n * @param {goog.ui.Control} item Menu item instance to decorate the element.\n * @param {Element} element Element to decorate.\n * @return {Element} Decorated element.\n * @override\n */\ngoog.ui.MenuItemRenderer.prototype.decorate = function(item, element) {\n  goog.asserts.assert(element);\n  if (!this.hasContentStructure(element)) {\n    element.appendChild(\n        this.createContent(element.childNodes, item.getDomHelper()));\n  }\n  if (goog.dom.classlist.contains(element, goog.getCssName('goog-option'))) {\n    (/** @type {goog.ui.MenuItem} */ (item)).setCheckable(true);\n    this.setCheckable(item, element, true);\n  }\n  return goog.ui.MenuItemRenderer.superClass_.decorate.call(\n      this, item, element);\n};\n\n\n/**\n * Takes a menu item's root element, and sets its content to the given text\n * caption or DOM structure.  Overrides the superclass immplementation by\n * making sure that the checkbox structure (for selectable/checkable menu\n * items) is preserved.\n * @param {Element} element The item's root element.\n * @param {goog.ui.ControlContent} content Text caption or DOM structure to be\n *     set as the item's content.\n * @override\n */\ngoog.ui.MenuItemRenderer.prototype.setContent = function(element, content) {\n  // Save the checkbox element, if present.\n  var contentElement = this.getContentElement(element);\n  var checkBoxElement =\n      this.hasCheckBoxStructure(element) ? contentElement.firstChild : null;\n  goog.ui.MenuItemRenderer.superClass_.setContent.call(this, element, content);\n  if (checkBoxElement && !this.hasCheckBoxStructure(element)) {\n    // The call to setContent() blew away the checkbox element; reattach it.\n    contentElement.insertBefore(\n        checkBoxElement, contentElement.firstChild || null);\n  }\n};\n\n\n/**\n * Returns true if the element appears to have a proper menu item structure by\n * checking whether its first child has the appropriate structural class name.\n * @param {Element} element Element to check.\n * @return {boolean} Whether the element appears to have a proper menu item DOM.\n * @protected\n */\ngoog.ui.MenuItemRenderer.prototype.hasContentStructure = function(element) {\n  var child = goog.dom.getFirstElementChild(element);\n  var contentClassName = this.getCompositeCssClass_(\n      goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT);\n  return !!child && goog.dom.classlist.contains(child, contentClassName);\n};\n\n\n/**\n * Wraps the given text caption or existing DOM node(s) in a structural element\n * containing the menu item's contents.\n * @param {goog.ui.ControlContent} content Menu item contents.\n * @param {goog.dom.DomHelper} dom DOM helper for document interaction.\n * @return {Element} Menu item content element.\n * @protected\n */\ngoog.ui.MenuItemRenderer.prototype.createContent = function(content, dom) {\n  var contentClassName = this.getCompositeCssClass_(\n      goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT);\n  return dom.createDom(goog.dom.TagName.DIV, contentClassName, content);\n};\n\n\n/**\n * Enables/disables radio button semantics on the menu item.\n * @param {goog.ui.Control} item Menu item to update.\n * @param {Element} element Menu item element to update (may be null if the\n *     item hasn't been rendered yet).\n * @param {boolean} selectable Whether the item should be selectable.\n */\ngoog.ui.MenuItemRenderer.prototype.setSelectable = function(\n    item, element, selectable) {\n  if (item && element) {\n    this.setEnableCheckBoxStructure(item, element, selectable);\n  }\n};\n\n\n/**\n * Enables/disables checkbox semantics on the menu item.\n * @param {goog.ui.Control} item Menu item to update.\n * @param {Element} element Menu item element to update (may be null if the\n *     item hasn't been rendered yet).\n * @param {boolean} checkable Whether the item should be checkable.\n */\ngoog.ui.MenuItemRenderer.prototype.setCheckable = function(\n    item, element, checkable) {\n  if (item && element) {\n    this.setEnableCheckBoxStructure(item, element, checkable);\n  }\n};\n\n\n/**\n * Determines whether the item contains a checkbox element.\n * @param {Element} element Menu item root element.\n * @return {boolean} Whether the element contains a checkbox element.\n * @protected\n */\ngoog.ui.MenuItemRenderer.prototype.hasCheckBoxStructure = function(element) {\n  var contentElement = this.getContentElement(element);\n  if (contentElement) {\n    var child = contentElement.firstChild;\n    var checkboxClassName = this.getCompositeCssClass_(\n        goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX);\n    return !!child && goog.dom.isElement(child) &&\n        goog.dom.classlist.contains(\n            /** @type {!Element} */ (child), checkboxClassName);\n  }\n  return false;\n};\n\n\n/**\n * Adds or removes extra markup and CSS styling to the menu item to make it\n * selectable or non-selectable, depending on the value of the\n * {@code selectable} argument.\n * @param {!goog.ui.Control} item Menu item to update.\n * @param {!Element} element Menu item element to update.\n * @param {boolean} enable Whether to add or remove the checkbox structure.\n * @protected\n */\ngoog.ui.MenuItemRenderer.prototype.setEnableCheckBoxStructure = function(\n    item, element, enable) {\n  this.setAriaRole(element, item.getPreferredAriaRole());\n  this.setAriaStates(item, element);\n  if (enable != this.hasCheckBoxStructure(element)) {\n    goog.dom.classlist.enable(element, goog.getCssName('goog-option'), enable);\n    var contentElement = this.getContentElement(element);\n    if (enable) {\n      // Insert checkbox structure.\n      var checkboxClassName = this.getCompositeCssClass_(\n          goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX);\n      contentElement.insertBefore(\n          item.getDomHelper().createDom(\n              goog.dom.TagName.DIV, checkboxClassName),\n          contentElement.firstChild || null);\n    } else {\n      // Remove checkbox structure.\n      contentElement.removeChild(contentElement.firstChild);\n    }\n  }\n};\n\n\n/**\n * Takes a single {@link goog.ui.Component.State}, and returns the\n * corresponding CSS class name (null if none).  Overrides the superclass\n * implementation by using 'highlight' as opposed to 'hover' as the CSS\n * class name suffix for the HOVER state, for backwards compatibility.\n * @param {goog.ui.Component.State} state Component state.\n * @return {string|undefined} CSS class representing the given state\n *     (undefined if none).\n * @override\n */\ngoog.ui.MenuItemRenderer.prototype.getClassForState = function(state) {\n  switch (state) {\n    case goog.ui.Component.State.HOVER:\n      // We use 'highlight' as the suffix, for backwards compatibility.\n      return this.getCompositeCssClass_(\n          goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER);\n    case goog.ui.Component.State.CHECKED:\n    case goog.ui.Component.State.SELECTED:\n      // We use 'goog-option-selected' as the class, for backwards\n      // compatibility.\n      return goog.getCssName('goog-option-selected');\n    default:\n      return goog.ui.MenuItemRenderer.superClass_.getClassForState.call(\n          this, state);\n  }\n};\n\n\n/**\n * Takes a single CSS class name which may represent a component state, and\n * returns the corresponding component state (0x00 if none).  Overrides the\n * superclass implementation by treating 'goog-option-selected' as special,\n * for backwards compatibility.\n * @param {string} className CSS class name, possibly representing a component\n *     state.\n * @return {goog.ui.Component.State} state Component state corresponding\n *     to the given CSS class (0x00 if none).\n * @override\n */\ngoog.ui.MenuItemRenderer.prototype.getStateFromClass = function(className) {\n  var hoverClassName = this.getCompositeCssClass_(\n      goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER);\n  switch (className) {\n    case goog.getCssName('goog-option-selected'):\n      return goog.ui.Component.State.CHECKED;\n    case hoverClassName:\n      return goog.ui.Component.State.HOVER;\n    default:\n      return goog.ui.MenuItemRenderer.superClass_.getStateFromClass.call(\n          this, className);\n  }\n};\n\n\n/** @override */\ngoog.ui.MenuItemRenderer.prototype.getCssClass = function() {\n  return goog.ui.MenuItemRenderer.CSS_CLASS;\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A class for representing items in menus.\n * @see goog.ui.Menu\n *\n * @author attila@google.com (Attila Bodis)\n * @see ../demos/menuitem.html\n */\n\ngoog.provide('goog.ui.MenuItem');\n\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.array');\ngoog.require('goog.dom');\ngoog.require('goog.dom.classlist');\ngoog.require('goog.math.Coordinate');\ngoog.require('goog.string');\ngoog.require('goog.ui.Component');\ngoog.require('goog.ui.Control');\ngoog.require('goog.ui.MenuItemRenderer');\ngoog.require('goog.ui.registry');\n\n\n\n/**\n * Class representing an item in a menu.\n *\n * @param {goog.ui.ControlContent} content Text caption or DOM structure to\n *     display as the content of the item (use to add icons or styling to\n *     menus).\n * @param {*=} opt_model Data/model associated with the menu item.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper used for\n *     document interactions.\n * @param {goog.ui.MenuItemRenderer=} opt_renderer Optional renderer.\n * @constructor\n * @extends {goog.ui.Control}\n */\ngoog.ui.MenuItem = function(content, opt_model, opt_domHelper, opt_renderer) {\n  goog.ui.Control.call(\n      this, content, opt_renderer || goog.ui.MenuItemRenderer.getInstance(),\n      opt_domHelper);\n  this.setValue(opt_model);\n};\ngoog.inherits(goog.ui.MenuItem, goog.ui.Control);\ngoog.tagUnsealableClass(goog.ui.MenuItem);\n\n\n/**\n * The access key for this menu item. This key allows the user to quickly\n * trigger this item's action with they keyboard. For example, setting the\n * mnenomic key to 70 (F), when the user opens the menu and hits \"F,\" the\n * menu item is triggered.\n *\n * @type {goog.events.KeyCodes}\n * @private\n */\ngoog.ui.MenuItem.prototype.mnemonicKey_;\n\n\n/**\n * The class set on an element that contains a parenthetical mnemonic key hint.\n * Parenthetical hints are added to items in which the mnemonic key is not found\n * within the menu item's caption itself. For example, if you have a menu item\n * with the caption \"Record,\" but its mnemonic key is \"I\", the caption displayed\n * in the menu will appear as \"Record (I)\".\n *\n * @type {string}\n * @private\n */\ngoog.ui.MenuItem.MNEMONIC_WRAPPER_CLASS_ =\n    goog.getCssName('goog-menuitem-mnemonic-separator');\n\n\n/**\n * The class set on an element that contains a keyboard accelerator hint.\n * @type {string}\n */\ngoog.ui.MenuItem.ACCELERATOR_CLASS = goog.getCssName('goog-menuitem-accel');\n\n\n// goog.ui.Component and goog.ui.Control implementation.\n\n\n/**\n * Returns the value associated with the menu item.  The default implementation\n * returns the model object associated with the item (if any), or its caption.\n * @return {*} Value associated with the menu item, if any, or its caption.\n */\ngoog.ui.MenuItem.prototype.getValue = function() {\n  var model = this.getModel();\n  return model != null ? model : this.getCaption();\n};\n\n\n/**\n * Sets the value associated with the menu item.  The default implementation\n * stores the value as the model of the menu item.\n * @param {*} value Value to be associated with the menu item.\n */\ngoog.ui.MenuItem.prototype.setValue = function(value) {\n  this.setModel(value);\n};\n\n\n/** @override */\ngoog.ui.MenuItem.prototype.setSupportedState = function(state, support) {\n  goog.ui.MenuItem.base(this, 'setSupportedState', state, support);\n  switch (state) {\n    case goog.ui.Component.State.SELECTED:\n      this.setSelectableInternal_(support);\n      break;\n    case goog.ui.Component.State.CHECKED:\n      this.setCheckableInternal_(support);\n      break;\n  }\n};\n\n\n/**\n * Sets the menu item to be selectable or not.  Set to true for menu items\n * that represent selectable options.\n * @param {boolean} selectable Whether the menu item is selectable.\n */\ngoog.ui.MenuItem.prototype.setSelectable = function(selectable) {\n  this.setSupportedState(goog.ui.Component.State.SELECTED, selectable);\n};\n\n\n/**\n * Sets the menu item to be selectable or not.\n * @param {boolean} selectable  Whether the menu item is selectable.\n * @private\n */\ngoog.ui.MenuItem.prototype.setSelectableInternal_ = function(selectable) {\n  if (this.isChecked() && !selectable) {\n    this.setChecked(false);\n  }\n\n  var element = this.getElement();\n  if (element) {\n    this.getRenderer().setSelectable(this, element, selectable);\n  }\n};\n\n\n/**\n * Sets the menu item to be checkable or not.  Set to true for menu items\n * that represent checkable options.\n * @param {boolean} checkable Whether the menu item is checkable.\n */\ngoog.ui.MenuItem.prototype.setCheckable = function(checkable) {\n  this.setSupportedState(goog.ui.Component.State.CHECKED, checkable);\n};\n\n\n/**\n * Sets the menu item to be checkable or not.\n * @param {boolean} checkable Whether the menu item is checkable.\n * @private\n */\ngoog.ui.MenuItem.prototype.setCheckableInternal_ = function(checkable) {\n  var element = this.getElement();\n  if (element) {\n    this.getRenderer().setCheckable(this, element, checkable);\n  }\n};\n\n\n/**\n * Returns the text caption of the component while ignoring accelerators.\n * @override\n */\ngoog.ui.MenuItem.prototype.getCaption = function() {\n  var content = this.getContent();\n  if (goog.isArray(content)) {\n    var acceleratorClass = goog.ui.MenuItem.ACCELERATOR_CLASS;\n    var mnemonicWrapClass = goog.ui.MenuItem.MNEMONIC_WRAPPER_CLASS_;\n    var caption =\n        goog.array\n            .map(\n                content,\n                function(node) {\n                  if (goog.dom.isElement(node) &&\n                      (goog.dom.classlist.contains(\n                           /** @type {!Element} */ (node), acceleratorClass) ||\n                       goog.dom.classlist.contains(\n                           /** @type {!Element} */ (node),\n                           mnemonicWrapClass))) {\n                    return '';\n                  } else {\n                    return goog.dom.getRawTextContent(node);\n                  }\n                })\n            .join('');\n    return goog.string.collapseBreakingSpaces(caption);\n  }\n  return goog.ui.MenuItem.superClass_.getCaption.call(this);\n};\n\n\n/**\n * @return {?string} The keyboard accelerator text, or null if the menu item\n *     doesn't have one.\n */\ngoog.ui.MenuItem.prototype.getAccelerator = function() {\n  var dom = this.getDomHelper();\n  var content = this.getContent();\n  if (goog.isArray(content)) {\n    var acceleratorEl = goog.array.find(content, function(e) {\n      return goog.dom.classlist.contains(\n          /** @type {!Element} */ (e), goog.ui.MenuItem.ACCELERATOR_CLASS);\n    });\n    if (acceleratorEl) {\n      return dom.getTextContent(acceleratorEl);\n    }\n  }\n  return null;\n};\n\n\n/** @override */\ngoog.ui.MenuItem.prototype.handleMouseUp = function(e) {\n  var parentMenu = /** @type {goog.ui.Menu} */ (this.getParent());\n\n  if (parentMenu) {\n    var oldCoords = parentMenu.openingCoords;\n    // Clear out the saved opening coords immediately so they're not used twice.\n    parentMenu.openingCoords = null;\n\n    if (oldCoords && goog.isNumber(e.clientX)) {\n      var newCoords = new goog.math.Coordinate(e.clientX, e.clientY);\n      if (goog.math.Coordinate.equals(oldCoords, newCoords)) {\n        // This menu was opened by a mousedown and we're handling the consequent\n        // mouseup. The coords haven't changed, meaning this was a simple click,\n        // not a click and drag. Don't do the usual behavior because the menu\n        // just popped up under the mouse and the user didn't mean to activate\n        // this item.\n        return;\n      }\n    }\n  }\n\n  goog.ui.MenuItem.base(this, 'handleMouseUp', e);\n};\n\n\n/** @override */\ngoog.ui.MenuItem.prototype.handleKeyEventInternal = function(e) {\n  if (e.keyCode == this.getMnemonic() && this.performActionInternal(e)) {\n    return true;\n  } else {\n    return goog.ui.MenuItem.base(this, 'handleKeyEventInternal', e);\n  }\n};\n\n\n/**\n * Sets the mnemonic key code. The mnemonic is the key associated with this\n * action.\n * @param {goog.events.KeyCodes} key The key code.\n */\ngoog.ui.MenuItem.prototype.setMnemonic = function(key) {\n  this.mnemonicKey_ = key;\n};\n\n\n/**\n * Gets the mnemonic key code. The mnemonic is the key associated with this\n * action.\n * @return {goog.events.KeyCodes} The key code of the mnemonic key.\n */\ngoog.ui.MenuItem.prototype.getMnemonic = function() {\n  return this.mnemonicKey_;\n};\n\n\n// Register a decorator factory function for goog.ui.MenuItems.\ngoog.ui.registry.setDecoratorByClassName(\n    goog.ui.MenuItemRenderer.CSS_CLASS, function() {\n      // MenuItem defaults to using MenuItemRenderer.\n      return new goog.ui.MenuItem(null);\n    });\n\n\n/**\n * @override\n */\ngoog.ui.MenuItem.prototype.getPreferredAriaRole = function() {\n  if (this.isSupportedState(goog.ui.Component.State.CHECKED)) {\n    return goog.a11y.aria.Role.MENU_ITEM_CHECKBOX;\n  }\n  if (this.isSupportedState(goog.ui.Component.State.SELECTED)) {\n    return goog.a11y.aria.Role.MENU_ITEM_RADIO;\n  }\n  return goog.ui.MenuItem.base(this, 'getPreferredAriaRole');\n};\n\n\n/**\n * @override\n * @return {goog.ui.Menu}\n */\ngoog.ui.MenuItem.prototype.getParent = function() {\n  return /** @type {goog.ui.Menu} */ (\n      goog.ui.Control.prototype.getParent.call(this));\n};\n\n\n/**\n * @override\n * @return {goog.ui.Menu}\n */\ngoog.ui.MenuItem.prototype.getParentEventTarget = function() {\n  return /** @type {goog.ui.Menu} */ (\n      goog.ui.Control.prototype.getParentEventTarget.call(this));\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Renderer for {@link goog.ui.MenuSeparator}s.\n *\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.MenuSeparatorRenderer');\n\ngoog.require('goog.dom');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.classlist');\ngoog.require('goog.ui.ControlRenderer');\n\n\n\n/**\n * Renderer for menu separators.\n * @constructor\n * @extends {goog.ui.ControlRenderer}\n */\ngoog.ui.MenuSeparatorRenderer = function() {\n  goog.ui.ControlRenderer.call(this);\n};\ngoog.inherits(goog.ui.MenuSeparatorRenderer, goog.ui.ControlRenderer);\ngoog.addSingletonGetter(goog.ui.MenuSeparatorRenderer);\n\n\n/**\n * Default CSS class to be applied to the root element of components rendered\n * by this renderer.\n * @type {string}\n */\ngoog.ui.MenuSeparatorRenderer.CSS_CLASS = goog.getCssName('goog-menuseparator');\n\n\n/**\n * Returns an empty, styled menu separator DIV.  Overrides {@link\n * goog.ui.ControlRenderer#createDom}.\n * @param {goog.ui.Control} separator goog.ui.Separator to render.\n * @return {!Element} Root element for the separator.\n * @override\n */\ngoog.ui.MenuSeparatorRenderer.prototype.createDom = function(separator) {\n  return separator.getDomHelper().createDom(\n      goog.dom.TagName.DIV, this.getCssClass());\n};\n\n\n/**\n * Takes an existing element, and decorates it with the separator.  Overrides\n * {@link goog.ui.ControlRenderer#decorate}.\n * @param {goog.ui.Control} separator goog.ui.MenuSeparator to decorate the\n *     element.\n * @param {Element} element Element to decorate.\n * @return {!Element} Decorated element.\n * @override\n */\ngoog.ui.MenuSeparatorRenderer.prototype.decorate = function(\n    separator, element) {\n  // Normally handled in the superclass. But we don't call the superclass.\n  if (element.id) {\n    separator.setId(element.id);\n  }\n\n  if (element.tagName == goog.dom.TagName.HR) {\n    // Replace HR with separator.\n    var hr = element;\n    element = this.createDom(separator);\n    goog.dom.insertSiblingBefore(element, hr);\n    goog.dom.removeNode(hr);\n  } else {\n    goog.dom.classlist.add(element, this.getCssClass());\n  }\n  return element;\n};\n\n\n/**\n * Overrides {@link goog.ui.ControlRenderer#setContent} to do nothing, since\n * separators are empty.\n * @param {Element} separator The separator's root element.\n * @param {goog.ui.ControlContent} content Text caption or DOM structure to be\n *    set as the separators's content (ignored).\n * @override\n */\ngoog.ui.MenuSeparatorRenderer.prototype.setContent = function(\n    separator, content) {\n  // Do nothing.  Separators are empty.\n};\n\n\n/**\n * Returns the CSS class to be applied to the root element of components\n * rendered using this renderer.\n * @return {string} Renderer-specific CSS class.\n * @override\n */\ngoog.ui.MenuSeparatorRenderer.prototype.getCssClass = function() {\n  return goog.ui.MenuSeparatorRenderer.CSS_CLASS;\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A class for representing a separator, with renderers for both\n * horizontal (menu) and vertical (toolbar) separators.\n *\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.Separator');\n\ngoog.require('goog.a11y.aria');\ngoog.require('goog.asserts');\ngoog.require('goog.ui.Component');\ngoog.require('goog.ui.Control');\ngoog.require('goog.ui.MenuSeparatorRenderer');\ngoog.require('goog.ui.registry');\n\n\n\n/**\n * Class representing a separator.  Although it extends {@link goog.ui.Control},\n * the Separator class doesn't allocate any event handlers, nor does it change\n * its appearance on mouseover, etc.\n * @param {goog.ui.MenuSeparatorRenderer=} opt_renderer Renderer to render or\n *    decorate the separator; defaults to {@link goog.ui.MenuSeparatorRenderer}.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper, used for\n *    document interaction.\n * @constructor\n * @extends {goog.ui.Control}\n */\ngoog.ui.Separator = function(opt_renderer, opt_domHelper) {\n  goog.ui.Control.call(\n      this, null, opt_renderer || goog.ui.MenuSeparatorRenderer.getInstance(),\n      opt_domHelper);\n\n  this.setSupportedState(goog.ui.Component.State.DISABLED, false);\n  this.setSupportedState(goog.ui.Component.State.HOVER, false);\n  this.setSupportedState(goog.ui.Component.State.ACTIVE, false);\n  this.setSupportedState(goog.ui.Component.State.FOCUSED, false);\n\n  // Separators are always considered disabled.\n  this.setStateInternal(goog.ui.Component.State.DISABLED);\n};\ngoog.inherits(goog.ui.Separator, goog.ui.Control);\n\n\n/**\n * Configures the component after its DOM has been rendered.  Overrides\n * {@link goog.ui.Control#enterDocument} by making sure no event handler\n * is allocated.\n * @override\n */\ngoog.ui.Separator.prototype.enterDocument = function() {\n  goog.ui.Separator.superClass_.enterDocument.call(this);\n  var element = this.getElement();\n  goog.asserts.assert(\n      element, 'The DOM element for the separator cannot be null.');\n  goog.a11y.aria.setRole(element, 'separator');\n};\n\n\n// Register a decorator factory function for goog.ui.MenuSeparators.\ngoog.ui.registry.setDecoratorByClassName(\n    goog.ui.MenuSeparatorRenderer.CSS_CLASS, function() {\n      // Separator defaults to using MenuSeparatorRenderer.\n      return new goog.ui.Separator();\n    });\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Renderer for {@link goog.ui.Menu}s.\n *\n * @author robbyw@google.com (Robby Walker)\n */\n\ngoog.provide('goog.ui.MenuRenderer');\n\ngoog.require('goog.a11y.aria');\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.a11y.aria.State');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.ui.ContainerRenderer');\ngoog.require('goog.ui.Separator');\n\n\n\n/**\n * Default renderer for {@link goog.ui.Menu}s, based on {@link\n * goog.ui.ContainerRenderer}.\n * @param {string=} opt_ariaRole Optional ARIA role used for the element.\n * @constructor\n * @extends {goog.ui.ContainerRenderer}\n */\ngoog.ui.MenuRenderer = function(opt_ariaRole) {\n  goog.ui.ContainerRenderer.call(\n      this, opt_ariaRole || goog.a11y.aria.Role.MENU);\n};\ngoog.inherits(goog.ui.MenuRenderer, goog.ui.ContainerRenderer);\ngoog.addSingletonGetter(goog.ui.MenuRenderer);\n\n\n/**\n * Default CSS class to be applied to the root element of toolbars rendered\n * by this renderer.\n * @type {string}\n */\ngoog.ui.MenuRenderer.CSS_CLASS = goog.getCssName('goog-menu');\n\n\n/**\n * Returns whether the element is a UL or acceptable to our superclass.\n * @param {Element} element Element to decorate.\n * @return {boolean} Whether the renderer can decorate the element.\n * @override\n */\ngoog.ui.MenuRenderer.prototype.canDecorate = function(element) {\n  return element.tagName == goog.dom.TagName.UL ||\n      goog.ui.MenuRenderer.superClass_.canDecorate.call(this, element);\n};\n\n\n/**\n * Inspects the element, and creates an instance of {@link goog.ui.Control} or\n * an appropriate subclass best suited to decorate it.  Overrides the superclass\n * implementation by recognizing HR elements as separators.\n * @param {Element} element Element to decorate.\n * @return {goog.ui.Control?} A new control suitable to decorate the element\n *     (null if none).\n * @override\n */\ngoog.ui.MenuRenderer.prototype.getDecoratorForChild = function(element) {\n  return element.tagName == goog.dom.TagName.HR ?\n      new goog.ui.Separator() :\n      goog.ui.MenuRenderer.superClass_.getDecoratorForChild.call(this, element);\n};\n\n\n/**\n * Returns whether the given element is contained in the menu's DOM.\n * @param {goog.ui.Menu} menu The menu to test.\n * @param {Element} element The element to test.\n * @return {boolean} Whether the given element is contained in the menu.\n */\ngoog.ui.MenuRenderer.prototype.containsElement = function(menu, element) {\n  return goog.dom.contains(menu.getElement(), element);\n};\n\n\n/**\n * Returns the CSS class to be applied to the root element of containers\n * rendered using this renderer.\n * @return {string} Renderer-specific CSS class.\n * @override\n */\ngoog.ui.MenuRenderer.prototype.getCssClass = function() {\n  return goog.ui.MenuRenderer.CSS_CLASS;\n};\n\n\n/** @override */\ngoog.ui.MenuRenderer.prototype.initializeDom = function(container) {\n  goog.ui.MenuRenderer.superClass_.initializeDom.call(this, container);\n\n  var element = container.getElement();\n  goog.asserts.assert(element, 'The menu DOM element cannot be null.');\n  goog.a11y.aria.setState(element, goog.a11y.aria.State.HASPOPUP, 'true');\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A class for representing menu separators.\n * @see goog.ui.Menu\n *\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.MenuSeparator');\n\ngoog.require('goog.ui.MenuSeparatorRenderer');\ngoog.require('goog.ui.Separator');\ngoog.require('goog.ui.registry');\n\n\n\n/**\n * Class representing a menu separator.  A menu separator extends {@link\n * goog.ui.Separator} by always setting its renderer to {@link\n * goog.ui.MenuSeparatorRenderer}.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper used for\n *     document interactions.\n * @constructor\n * @extends {goog.ui.Separator}\n */\ngoog.ui.MenuSeparator = function(opt_domHelper) {\n  goog.ui.Separator.call(\n      this, goog.ui.MenuSeparatorRenderer.getInstance(), opt_domHelper);\n};\ngoog.inherits(goog.ui.MenuSeparator, goog.ui.Separator);\n\n\n// Register a decorator factory function for goog.ui.MenuSeparators.\ngoog.ui.registry.setDecoratorByClassName(\n    goog.ui.MenuSeparatorRenderer.CSS_CLASS, function() {\n      // Separator defaults to using MenuSeparatorRenderer.\n      return new goog.ui.Separator();\n    });\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A base menu class that supports key and mouse events. The menu\n * can be bound to an existing HTML structure or can generate its own DOM.\n *\n * To decorate, the menu should be bound to an element containing children\n * with the classname 'goog-menuitem'.  HRs will be classed as separators.\n *\n * Decorate Example:\n * <div id=\"menu\" class=\"goog-menu\" tabIndex=\"0\">\n *   <div class=\"goog-menuitem\">Google</div>\n *   <div class=\"goog-menuitem\">Yahoo</div>\n *   <div class=\"goog-menuitem\">MSN</div>\n *   <hr>\n *   <div class=\"goog-menuitem\">New...</div>\n * </div>\n * <script>\n *\n * var menu = new goog.ui.Menu();\n * menu.decorate(goog.dom.getElement('menu'));\n *\n * TESTED=FireFox 2.0, IE6, Opera 9, Chrome.\n * TODO(user): Key handling is flaky in Opera and Chrome\n * TODO(user): Rename all references of \"item\" to child since menu is\n * essentially very generic and could, in theory, host a date or color picker.\n *\n * @see ../demos/menu.html\n * @see ../demos/menus.html\n */\n\ngoog.provide('goog.ui.Menu');\ngoog.provide('goog.ui.Menu.EventType');\n\ngoog.require('goog.dom.TagName');\ngoog.require('goog.math.Coordinate');\ngoog.require('goog.string');\ngoog.require('goog.style');\ngoog.require('goog.ui.Component.EventType');\ngoog.require('goog.ui.Component.State');\ngoog.require('goog.ui.Container');\ngoog.require('goog.ui.Container.Orientation');\ngoog.require('goog.ui.MenuHeader');\ngoog.require('goog.ui.MenuItem');\ngoog.require('goog.ui.MenuRenderer');\ngoog.require('goog.ui.MenuSeparator');\n\n// The dependencies MenuHeader, MenuItem, and MenuSeparator are implicit.\n// There are no references in the code, but we need to load these\n// classes before goog.ui.Menu.\n\n\n\n// TODO(robbyw): Reverse constructor argument order for consistency.\n/**\n * A basic menu class.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper.\n * @param {goog.ui.MenuRenderer=} opt_renderer Renderer used to render or\n *     decorate the container; defaults to {@link goog.ui.MenuRenderer}.\n * @constructor\n * @extends {goog.ui.Container}\n */\ngoog.ui.Menu = function(opt_domHelper, opt_renderer) {\n  goog.ui.Container.call(\n      this, goog.ui.Container.Orientation.VERTICAL,\n      opt_renderer || goog.ui.MenuRenderer.getInstance(), opt_domHelper);\n\n  // Unlike Containers, Menus aren't keyboard-accessible by default.  This line\n  // preserves backwards compatibility with code that depends on menus not\n  // receiving focus - e.g. {@code goog.ui.MenuButton}.\n  this.setFocusable(false);\n};\ngoog.inherits(goog.ui.Menu, goog.ui.Container);\ngoog.tagUnsealableClass(goog.ui.Menu);\n\n\n// TODO(robbyw): Remove this and all references to it.\n// Please ensure that BEFORE_SHOW behavior is not disrupted as a result.\n/**\n * Event types dispatched by the menu.\n * @enum {string}\n * @deprecated Use goog.ui.Component.EventType.\n */\ngoog.ui.Menu.EventType = {\n  /** Dispatched before the menu becomes visible */\n  BEFORE_SHOW: goog.ui.Component.EventType.BEFORE_SHOW,\n\n  /** Dispatched when the menu is shown */\n  SHOW: goog.ui.Component.EventType.SHOW,\n\n  /** Dispatched before the menu becomes hidden */\n  BEFORE_HIDE: goog.ui.Component.EventType.HIDE,\n\n  /** Dispatched when the menu is hidden */\n  HIDE: goog.ui.Component.EventType.HIDE\n};\n\n\n// TODO(robbyw): Remove this and all references to it.\n/**\n * CSS class for menus.\n * @type {string}\n * @deprecated Use goog.ui.MenuRenderer.CSS_CLASS.\n */\ngoog.ui.Menu.CSS_CLASS = goog.ui.MenuRenderer.CSS_CLASS;\n\n\n/**\n * Coordinates of the mousedown event that caused this menu to be made visible.\n * Used to prevent the consequent mouseup event due to a simple click from\n * activating a menu item immediately. Considered protected; should only be used\n * within this package or by subclasses.\n * @type {goog.math.Coordinate|undefined}\n */\ngoog.ui.Menu.prototype.openingCoords;\n\n\n/**\n * Whether the menu can move the focus to its key event target when it is\n * shown.  Default = true\n * @type {boolean}\n * @private\n */\ngoog.ui.Menu.prototype.allowAutoFocus_ = true;\n\n\n/**\n * Whether the menu should use windows syle behavior and allow disabled menu\n * items to be highlighted (though not selectable).  Defaults to false\n * @type {boolean}\n * @private\n */\ngoog.ui.Menu.prototype.allowHighlightDisabled_ = false;\n\n\n/**\n * Returns the CSS class applied to menu elements, also used as the prefix for\n * derived styles, if any.  Subclasses should override this method as needed.\n * Considered protected.\n * @return {string} The CSS class applied to menu elements.\n * @protected\n * @deprecated Use getRenderer().getCssClass().\n */\ngoog.ui.Menu.prototype.getCssClass = function() {\n  return this.getRenderer().getCssClass();\n};\n\n\n/**\n * Returns whether the provided element is to be considered inside the menu for\n * purposes such as dismissing the menu on an event.  This is so submenus can\n * make use of elements outside their own DOM.\n * @param {Element} element The element to test for.\n * @return {boolean} Whether the provided element is to be considered inside\n *     the menu.\n */\ngoog.ui.Menu.prototype.containsElement = function(element) {\n  if (this.getRenderer().containsElement(this, element)) {\n    return true;\n  }\n\n  for (var i = 0, count = this.getChildCount(); i < count; i++) {\n    var child = this.getChildAt(i);\n    if (typeof child.containsElement == 'function' &&\n        child.containsElement(element)) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\n\n/**\n * Adds a new menu item at the end of the menu.\n * @param {goog.ui.MenuHeader|goog.ui.MenuItem|goog.ui.MenuSeparator} item Menu\n *     item to add to the menu.\n * @deprecated Use {@link #addChild} instead, with true for the second argument.\n */\ngoog.ui.Menu.prototype.addItem = function(item) {\n  this.addChild(item, true);\n};\n\n\n/**\n * Adds a new menu item at a specific index in the menu.\n * @param {goog.ui.MenuHeader|goog.ui.MenuItem|goog.ui.MenuSeparator} item Menu\n *     item to add to the menu.\n * @param {number} n Index at which to insert the menu item.\n * @deprecated Use {@link #addChildAt} instead, with true for the third\n *     argument.\n */\ngoog.ui.Menu.prototype.addItemAt = function(item, n) {\n  this.addChildAt(item, n, true);\n};\n\n\n/**\n * Removes an item from the menu and disposes of it.\n * @param {goog.ui.MenuHeader|goog.ui.MenuItem|goog.ui.MenuSeparator} item The\n *     menu item to remove.\n * @deprecated Use {@link #removeChild} instead.\n */\ngoog.ui.Menu.prototype.removeItem = function(item) {\n  var removedChild = this.removeChild(item, true);\n  if (removedChild) {\n    removedChild.dispose();\n  }\n};\n\n\n/**\n * Removes a menu item at a given index in the menu and disposes of it.\n * @param {number} n Index of item.\n * @deprecated Use {@link #removeChildAt} instead.\n */\ngoog.ui.Menu.prototype.removeItemAt = function(n) {\n  var removedChild = this.removeChildAt(n, true);\n  if (removedChild) {\n    removedChild.dispose();\n  }\n};\n\n\n/**\n * Returns a reference to the menu item at a given index.\n * @param {number} n Index of menu item.\n * @return {goog.ui.MenuHeader|goog.ui.MenuItem|goog.ui.MenuSeparator|null}\n *     Reference to the menu item.\n * @deprecated Use {@link #getChildAt} instead.\n */\ngoog.ui.Menu.prototype.getItemAt = function(n) {\n  return /** @type {goog.ui.MenuItem?} */ (this.getChildAt(n));\n};\n\n\n/**\n * Returns the number of items in the menu (including separators).\n * @return {number} The number of items in the menu.\n * @deprecated Use {@link #getChildCount} instead.\n */\ngoog.ui.Menu.prototype.getItemCount = function() {\n  return this.getChildCount();\n};\n\n\n/**\n * Returns an array containing the menu items contained in the menu.\n * @return {!Array<goog.ui.MenuItem>} An array of menu items.\n * @deprecated Use getChildAt, forEachChild, and getChildCount.\n */\ngoog.ui.Menu.prototype.getItems = function() {\n  // TODO(user): Remove reference to getItems and instead use getChildAt,\n  // forEachChild, and getChildCount\n  var children = [];\n  this.forEachChild(function(child) { children.push(child); });\n  return children;\n};\n\n\n/**\n * Sets the position of the menu relative to the view port.\n * @param {number|goog.math.Coordinate} x Left position or coordinate obj.\n * @param {number=} opt_y Top position.\n */\ngoog.ui.Menu.prototype.setPosition = function(x, opt_y) {\n  // NOTE(user): It is necessary to temporarily set the display from none, so\n  // that the position gets set correctly.\n  var visible = this.isVisible();\n  if (!visible) {\n    goog.style.setElementShown(this.getElement(), true);\n  }\n  goog.style.setPageOffset(this.getElement(), x, opt_y);\n  if (!visible) {\n    goog.style.setElementShown(this.getElement(), false);\n  }\n};\n\n\n/**\n * Gets the page offset of the menu, or null if the menu isn't visible\n * @return {goog.math.Coordinate?} Object holding the x-y coordinates of the\n *     menu or null if the menu is not visible.\n */\ngoog.ui.Menu.prototype.getPosition = function() {\n  return this.isVisible() ? goog.style.getPageOffset(this.getElement()) : null;\n};\n\n\n/**\n * Sets whether the menu can automatically move focus to its key event target\n * when it is set to visible.\n * @param {boolean} allow Whether the menu can automatically move focus to its\n *     key event target when it is set to visible.\n */\ngoog.ui.Menu.prototype.setAllowAutoFocus = function(allow) {\n  this.allowAutoFocus_ = allow;\n  if (allow) {\n    this.setFocusable(true);\n  }\n};\n\n\n/**\n * @return {boolean} Whether the menu can automatically move focus to its key\n *     event target when it is set to visible.\n */\ngoog.ui.Menu.prototype.getAllowAutoFocus = function() {\n  return this.allowAutoFocus_;\n};\n\n\n/**\n * Sets whether the menu will highlight disabled menu items or skip to the next\n * active item.\n * @param {boolean} allow Whether the menu will highlight disabled menu items or\n *     skip to the next active item.\n */\ngoog.ui.Menu.prototype.setAllowHighlightDisabled = function(allow) {\n  this.allowHighlightDisabled_ = allow;\n};\n\n\n/**\n * @return {boolean} Whether the menu will highlight disabled menu items or skip\n *     to the next active item.\n */\ngoog.ui.Menu.prototype.getAllowHighlightDisabled = function() {\n  return this.allowHighlightDisabled_;\n};\n\n\n/**\n * @override\n * @param {boolean} show Whether to show or hide the menu.\n * @param {boolean=} opt_force If true, doesn't check whether the menu\n *     already has the requested visibility, and doesn't dispatch any events.\n * @param {goog.events.Event=} opt_e Mousedown event that caused this menu to\n *     be made visible (ignored if show is false).\n */\ngoog.ui.Menu.prototype.setVisible = function(show, opt_force, opt_e) {\n  var visibilityChanged =\n      goog.ui.Menu.superClass_.setVisible.call(this, show, opt_force);\n  if (visibilityChanged && show && this.isInDocument() &&\n      this.allowAutoFocus_) {\n    this.getKeyEventTarget().focus();\n  }\n  if (show && opt_e && goog.isNumber(opt_e.clientX)) {\n    this.openingCoords = new goog.math.Coordinate(opt_e.clientX, opt_e.clientY);\n  } else {\n    this.openingCoords = null;\n  }\n  return visibilityChanged;\n};\n\n\n/** @override */\ngoog.ui.Menu.prototype.handleEnterItem = function(e) {\n  if (this.allowAutoFocus_) {\n    this.getKeyEventTarget().focus();\n  }\n\n  return goog.ui.Menu.superClass_.handleEnterItem.call(this, e);\n};\n\n\n/**\n * Highlights the next item that begins with the specified string.  If no\n * (other) item begins with the given string, the selection is unchanged.\n * @param {string} charStr The prefix to match.\n * @return {boolean} Whether a matching prefix was found.\n */\ngoog.ui.Menu.prototype.highlightNextPrefix = function(charStr) {\n  var re = new RegExp('^' + goog.string.regExpEscape(charStr), 'i');\n  return this.highlightHelper(function(index, max) {\n    // Index is >= -1 because it is set to -1 when nothing is selected.\n    var start = index < 0 ? 0 : index;\n    var wrapped = false;\n\n    // We always start looking from one after the current, because we\n    // keep the current selection only as a last resort. This makes the\n    // loop a little awkward in the case where there is no current\n    // selection, as we need to stop somewhere but can't just stop\n    // when index == start, which is why we need the 'wrapped' flag.\n    do {\n      ++index;\n      if (index == max) {\n        index = 0;\n        wrapped = true;\n      }\n      var name = this.getChildAt(index).getCaption();\n      if (name && name.match(re)) {\n        return index;\n      }\n    } while (!wrapped || index != start);\n    return this.getHighlightedIndex();\n  }, this.getHighlightedIndex());\n};\n\n\n/** @override */\ngoog.ui.Menu.prototype.canHighlightItem = function(item) {\n  return (this.allowHighlightDisabled_ || item.isEnabled()) &&\n      item.isVisible() && item.isSupportedState(goog.ui.Component.State.HOVER);\n};\n\n\n/** @override */\ngoog.ui.Menu.prototype.decorateInternal = function(element) {\n  this.decorateContent(element);\n  goog.ui.Menu.superClass_.decorateInternal.call(this, element);\n};\n\n\n/** @override */\ngoog.ui.Menu.prototype.handleKeyEventInternal = function(e) {\n  var handled = goog.ui.Menu.base(this, 'handleKeyEventInternal', e);\n  if (!handled) {\n    // Loop through all child components, and for each menu item call its\n    // key event handler so that keyboard mnemonics can be handled.\n    this.forEachChild(function(menuItem) {\n      if (!handled && menuItem.getMnemonic &&\n          menuItem.getMnemonic() == e.keyCode) {\n        if (this.isEnabled()) {\n          this.setHighlighted(menuItem);\n        }\n        // We still delegate to handleKeyEvent, so that it can handle\n        // enabled/disabled state.\n        handled = menuItem.handleKeyEvent(e);\n      }\n    }, this);\n  }\n  return handled;\n};\n\n\n/** @override */\ngoog.ui.Menu.prototype.setHighlightedIndex = function(index) {\n  goog.ui.Menu.base(this, 'setHighlightedIndex', index);\n\n  // Bring the highlighted item into view. This has no effect if the menu is not\n  // scrollable.\n  var child = this.getChildAt(index);\n  if (child) {\n    goog.style.scrollIntoContainerView(child.getElement(), this.getElement());\n  }\n};\n\n\n/**\n * Decorate menu items located in any descendent node which as been explicitly\n * marked as a 'content' node.\n * @param {Element} element Element to decorate.\n * @protected\n */\ngoog.ui.Menu.prototype.decorateContent = function(element) {\n  var renderer = this.getRenderer();\n  var contentElements = this.getDomHelper().getElementsByTagNameAndClass(\n      goog.dom.TagName.DIV, goog.getCssName(renderer.getCssClass(), 'content'),\n      element);\n\n  // Some versions of IE do not like it when you access this nodeList\n  // with invalid indices. See\n  // http://code.google.com/p/closure-library/issues/detail?id=373\n  var length = contentElements.length;\n  for (var i = 0; i < length; i++) {\n    renderer.decorateChildren(this, contentElements[i]);\n  }\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Functionality for the right-click context menus.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.ContextMenu');\n\ngoog.require('goog.dom');\ngoog.require('goog.style');\ngoog.require('goog.ui.Menu');\ngoog.require('goog.ui.MenuItem');\n\n/**\n * Which block is the context menu attach to?\n * @type {Blockly.Block}\n */\nBlockly.ContextMenu.currentBlock = null;\n\n/**\n * Construct the menu based on the list of options and show the menu.\n * @param {!Event} e Mouse Event\n * @param {!Array.<!Object>} options Array of menu options.\n */\nBlockly.ContextMenu.show = function(e, options) {\n  Blockly.WidgetDiv.show(Blockly.ContextMenu, null);\n  if (!options.length) {\n    Blockly.ContextMenu.hide();\n    return;\n  }\n  /* Here's what one option object looks like:\n    {text: 'Make It So',\n     enabled: true,\n     callback: Blockly.MakeItSo}\n  */\n  var menu = new goog.ui.Menu();\n\n  for (var x = 0, option; option = options[x]; x++) {\n    var menuItem = new goog.ui.MenuItem(option.text);\n    menu.addItem(menuItem);\n    menuItem.setEnabled(option.enabled);\n    if (option.enabled) {\n      goog.events.listen(menuItem, goog.ui.Component.EventType.ACTION,\n                         option.callback);\n    }\n  }\n  goog.events.listen(menu, goog.ui.Component.EventType.ACTION,\n                     Blockly.ContextMenu.hide);\n  // Record windowSize and scrollOffset before adding menu.\n  var windowSize = goog.dom.getViewportSize();\n  var scrollOffset = goog.style.getViewportPageOffset(document);\n  var div = Blockly.WidgetDiv.DIV;\n  menu.render(div);\n  menu.setAllowAutoFocus(true);\n  var menuDom = menu.getElement();\n  Blockly.addClass_(menuDom, 'blocklyContextMenu');\n  // Record menuSize after adding menu\n  var menuSize = goog.style.getSize(menuDom);\n\n  // Position the menu.\n  var x = e.clientX + scrollOffset.x;\n  var y = e.clientY + scrollOffset.y;\n  // Flip menu vertically if off the bottom.\n  if (e.clientY + menuSize.height >= windowSize.height) {\n    y -= menuSize.height;\n  }\n  // Flip menu horizontally if off the edge.\n  if (Blockly.RTL) {\n    if (menuSize.width >= e.clientX) {\n      x += menuSize.width;\n    }\n  } else {\n    if (e.clientX + menuSize.width >= windowSize.width) {\n      x -= menuSize.width;\n    }\n  }\n  Blockly.WidgetDiv.position(x, y, windowSize, scrollOffset);\n\n  Blockly.ContextMenu.currentBlock = null; // May be set by Blockly.block\n};\n\n/**\n * Hide the context menu.\n */\nBlockly.ContextMenu.hide = function() {\n  Blockly.WidgetDiv.hideIfOwner(Blockly.ContextMenu);\n  Blockly.ContextMenu.currentBlock = null;\n};\n\n/**\n * Create the DOM nodes for a menu option.\n * @param {string} text The option's text.\n * @return {!Element} <g> node containing the menu option.\n * @private\n */\nBlockly.ContextMenu.optionToDom_ = function(text) {\n  /* Here's the SVG we create:\n    <g class=\"blocklyMenuDiv\">\n      <rect height=\"20\"/>\n      <text class=\"blocklyMenuText\" x=\"20\" y=\"15\">Make It So</text>\n    </g>\n  */\n  var gElement = Blockly.createSvgElement('g', {'class': 'blocklyMenuDiv'},\n                                          null);\n  var rectElement = Blockly.createSvgElement('rect',\n      {'height': Blockly.ContextMenu.Y_HEIGHT}, gElement);\n  var textElement = Blockly.createSvgElement('text',\n      {'class': 'blocklyMenuText',\n      'x': Blockly.ContextMenu.X_PADDING,\n      'y': 15}, gElement);\n  var textNode = document.createTextNode(text);\n  textElement.appendChild(textNode);\n  return gElement;\n};\n\n/**\n * Create a callback function that creates and configures a block,\n *   then places the new block next to the original.\n * @param {!Blockly.Block} block Original block.\n * @param {!Element} xml XML representation of new block.\n * @return {!Function} Function that creates a block.\n */\nBlockly.ContextMenu.callbackFactory = function(block, xml) {\n  return function() {\n    var newBlock = Blockly.Xml.domToBlock(block.blockSpace, xml);\n    // Move the new block next to the old block.\n    var xy = block.getRelativeToSurfaceXY();\n    if (Blockly.RTL) {\n      xy.x -= Blockly.SNAP_RADIUS;\n    } else {\n      xy.x += Blockly.SNAP_RADIUS;\n    }\n    xy.y += Blockly.SNAP_RADIUS * 2;\n    newBlock.moveBy(xy.x, xy.y);\n    newBlock.select();\n  };\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Input field.  Used for editable titles, variables, etc.\n * This is an abstract class that defines the UI on the block.  Actual\n * instances would be Blockly.FieldTextInput, Blockly.FieldDropdown, etc.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Field');\n\n// TODO(scr): Fix circular dependencies\n// goog.require('Blockly.Block');\ngoog.require('Blockly.BlockSvg');\n\n\n/**\n * Class for an editable field.\n * @param {string} text The initial content of the field.\n * @constructor\n */\nBlockly.Field = function(text) {\n  this.sourceBlock_ = null;\n  // Build the DOM.\n  this.fieldGroup_ = Blockly.createSvgElement('g', {}, null);\n  this.borderRect_ = Blockly.createSvgElement('rect',\n      {'rx': 4,\n       'ry': 4,\n       'x': -Blockly.BlockSvg.SEP_SPACE_X / 2,\n       'y': -12,\n       'height': 16}, this.fieldGroup_);\n  this.textElement_ = Blockly.createSvgElement('text',\n      {'class': 'blocklyText'}, this.fieldGroup_);\n  this.size_ = {height: 25, width: 0};\n  this.setText(text);\n  this.visible_ = true;\n};\n\n/**\n * If this field is attached to a block whose output connection is attached to a\n * connection that has the specified field helper, get the options for that\n * field helper.\n * @param {string} fieldHelper - the field helper to retrieve. One of\n *        Blockly.BlockFieldHelper\n * @return {Object|undefined} the options object if it exists\n */\nBlockly.Field.prototype.getFieldHelperOptions_ = function(fieldHelper) {\n  return (\n    this.sourceBlock_ &&\n    this.sourceBlock_.outputConnection &&\n    this.sourceBlock_.outputConnection.targetConnection &&\n    this.sourceBlock_.outputConnection.targetConnection.getFieldHelperOptions(fieldHelper)\n  );\n};\n\n/**\n * @returns {Blockly.BlockSpace.blockSpaceEditor}\n * @protected\n */\nBlockly.Field.prototype.getParentEditor_ = function() {\n  return this.sourceBlock_.blockSpace.blockSpaceEditor;\n};\n\n/**\n * The root <svg> element this field is a child of\n * @returns {Blockly.BlockSpaceEditor.svg_}\n * @protected\n */\nBlockly.Field.prototype.getRootSVGElement_ = function() {\n  return this.getParentEditor_().svg_;\n};\n\n/**\n * Non-breaking space.\n */\nBlockly.Field.NBSP = '\\u00A0';\n\n/**\n * Editable fields are saved by the XML renderer, non-editable fields are not.\n */\nBlockly.Field.prototype.EDITABLE = true;\n\n/**\n * Install this field on a block.\n * @param {!Blockly.Block} block The block containing this field.\n */\nBlockly.Field.prototype.init = function(block) {\n  if (this.sourceBlock_) {\n    throw 'Field has already been initialized once.';\n  }\n  this.sourceBlock_ = block;\n  this.updateEditable();\n  block.getSvgRoot().appendChild(this.fieldGroup_);\n  this.mouseDownWrapper_ = Blockly.bindEvent_(this.fieldGroup_, 'mousedown',\n      this, this.onMouseDown_);\n  this.mouseUpWrapper_ =\n      Blockly.bindEvent_(this.fieldGroup_, 'mouseup', this, this.onMouseUp_);\n  this.clickWrapper_ =\n      Blockly.bindEvent_(this.fieldGroup_, 'click', this, this.onClick_);\n  // Bump to set the colours for dropdown arrows.\n  this.setText(null);\n};\n\n/**\n * Dispose of all DOM objects belonging to this editable field.\n */\nBlockly.Field.prototype.dispose = function() {\n  if (this.mouseDownWrapper_) {\n    Blockly.unbindEvent_(this.mouseDownWrapper_);\n    this.mouseDownWrapper_ = null;\n  }\n  if (this.mouseUpWrapper_) {\n    Blockly.unbindEvent_(this.mouseUpWrapper_);\n    this.mouseUpWrapper_ = null;\n  }\n  if (this.clickWrapper_) {\n    Blockly.unbindEvent_(this.clickWrapper_);\n    this.clickWrapper_ = null;\n  }\n  this.sourceBlock_ = null;\n  goog.dom.removeNode(this.fieldGroup_);\n  this.fieldGroup_ = null;\n  this.textElement_ = null;\n  this.borderRect_ = null;\n};\n\n/**\n * Add or remove the UI indicating if this field is editable or not.\n */\nBlockly.Field.prototype.updateEditable = function() {\n  if (!this.EDITABLE) {\n    return;\n  }\n  if (this.sourceBlock_.isEditable()) {\n    Blockly.addClass_(/** @type {!Element} */ (this.fieldGroup_),\n                      'blocklyEditableText');\n    Blockly.removeClass_(/** @type {!Element} */ (this.fieldGroup_),\n                         'blocklyNoNEditableText');\n    this.fieldGroup_.style.cursor = this.CURSOR;\n  } else {\n    Blockly.addClass_(/** @type {!Element} */ (this.fieldGroup_),\n                      'blocklyNonEditableText');\n    Blockly.removeClass_(/** @type {!Element} */ (this.fieldGroup_),\n                         'blocklyEditableText');\n    this.fieldGroup_.style.cursor = '';\n  }\n};\n\n/**\n * Gets whether this editable field is visible or not.\n * @return {boolean} True if visible.\n */\nBlockly.Field.prototype.isVisible = function() {\n  return this.visible_;\n};\n\n/**\n * Sets whether this editable field is visible or not.\n * @param {boolean} visible True if visible.\n */\nBlockly.Field.prototype.setVisible = function(visible) {\n  this.visible_ = visible;\n  this.getRootElement().style.display = visible ? 'block' : 'none';\n};\n\n/**\n * Gets the group element for this editable field.\n * Used for measuring the size and for positioning.\n * @return {!Element} The group element.\n */\nBlockly.Field.prototype.getRootElement = function() {\n  return /** @type {!Element} */ (this.fieldGroup_);\n};\n\n/**\n * Draws the border with the correct width.\n * Saves the computed width in a property.\n * @private\n */\nBlockly.Field.prototype.updateWidth_ = function() {\n  var width;\n  if (this.textElement_.getComputedTextLength &&\n      document.body.contains(this.textElement_)) {\n    width = this.textElement_.getComputedTextLength();\n  } else {\n    // Running headless.\n    width = 1;\n  }\n  if (this.borderRect_) {\n    this.borderRect_.setAttribute('width',\n        width + Blockly.BlockSvg.SEP_SPACE_X);\n  }\n  this.size_.width = width;\n};\n\n/**\n * Returns the height and width of the title.\n * @return {!Object} Height and width.\n */\nBlockly.Field.prototype.getSize = function() {\n  if (!this.size_.width) {\n    this.updateWidth_();\n  }\n  return this.size_;\n};\n\n/**\n * Returns how many pixels of buffer space we want above field. Override by\n * children.\n * @return {Number} Number of pixels\n */\nBlockly.Field.prototype.getBufferY = function() {\n  return 0;\n};\n\n/**\n * Get the text from this field.\n * @return {string} Current text.\n */\nBlockly.Field.prototype.getText = function() {\n  return this.text_;\n};\n\n/**\n * Set the text in this field.  Trigger a rerender of the source block.\n * @param {?string} text New text.\n */\nBlockly.Field.prototype.setText = function(text) {\n  if (text === null || text === this.text_) {\n    // No change if null.\n    return;\n  }\n  this.text_ = text;\n  // Empty the text element.\n  goog.dom.removeChildren(/** @type {!Element} */ (this.textElement_));\n  // Replace whitespace with non-breaking spaces so the text doesn't collapse.\n  text = text.replace(/\\s/g, Blockly.Field.NBSP);\n  if (!text) {\n    // Prevent the field from disappearing if empty.\n    text = Blockly.Field.NBSP;\n  }\n  var textNode = document.createTextNode(text);\n  this.textElement_.appendChild(textNode);\n\n  // Cached width is obsolete.  Clear it.\n  this.size_.width = 0;\n\n  this.refreshRender();\n};\n\n/**\n * Trigger a rerender of the source block.\n */\nBlockly.Field.prototype.refreshRender = function () {\n  if (this.sourceBlock_ && this.sourceBlock_.rendered) {\n    this.sourceBlock_.render();\n    this.sourceBlock_.bumpNeighbours();\n    this.sourceBlock_.blockSpace.fireChangeEvent();\n  }\n};\n\n/**\n * By default there is no difference between the human-readable text and\n * the language-neutral values.  Subclasses (such as dropdown) may define this.\n * @return {string} Current text.\n */\nBlockly.Field.prototype.getValue = function() {\n  return this.getText();\n};\n\n/**\n * By default there is no difference between the human-readable text and\n * the language-neutral values.  Subclasses (such as dropdown) may define this.\n * @param {string} text New text.\n */\nBlockly.Field.prototype.setValue = function(text) {\n  this.setText(text);\n};\n\n/**\n * @return {boolean} Whether this field accepts keyboard input.\n * @private\n */\nBlockly.Field.prototype.isKeyboardInputField_ = function() {\n  // Subclasses which accept keyboard input must override this method.\n  return false;\n};\n\n/**\n * Returns whether to show the editor on click. Otherwise it will be\n * shown on mousedown.\n * @return {boolean} Whether the editor should be shown on click.\n * @private\n */\nBlockly.Field.prototype.showEditorOnClick_ = function() {\n  // On Android, we allow inline text editing. The keyboard can only be\n  // summoned by a call to el.focus() from within the click handler.\n\n  // On iOS, inline text editing jumps around unpredictably so we use\n  // window.prompt instead. Show the prompt on the click event,\n  // because if we show it on the mouseup event then other events come\n  // in after the prompt closes, causing block deletion or keyboard\n  // re-prompting.\n\n  // Limit this behavior to keyboard input fields to avoid the side\n  // effects listed below.\n\n  return !!(this.isKeyboardInputField_() &&\n      (goog.userAgent.ANDROID || goog.userAgent.MOBILE));\n};\n\n/**\n * Handle a mousedown or touchstart event on an editable field.\n * @param {!Event} e Event.\n * @private\n */\nBlockly.Field.prototype.onMouseDown_ = function(e) {\n  if (this.showEditorOnClick_()) {\n    // Preserve the click event by stopping other event handlers from\n    // firing. Otherwise, the Block component may call\n    // e.preventDefault on the touchstart event which which would\n    // suppress the click event.  The side effects of this are that:\n    // (1) blocks cannot be dragged by touches to the input field, and\n    // (2) in browsers which do not understand CSS touch-action or\n    // -ms-touch-action such as Chrome 35 and earlier, the screen can\n    // be scrolled by touch events to the input field.\n\n    e.stopPropagation();\n  }\n};\n\n/**\n * Handle a mouseup or touchend event on an editable field.\n * @param {!Event} e Event.\n * @private\n */\nBlockly.Field.prototype.onMouseUp_ = function(e) {\n  if (this.showEditorOnClick_()) {\n    return;\n  } else if (Blockly.isRightButton(e)) {\n    // Right-click.\n    return;\n  } else if (Blockly.Block.isFreelyDragging()) {\n    // Drag operation is concluding.  Don't open the editor.\n    return;\n  } else if (this.sourceBlock_.isEditable()) {\n    // Non-abstract sub-classes must define a showEditor_ method.\n    this.showEditor_();\n  }\n};\n\n/**\n * Handle a click event on an editable field.\n * @param {!Event} e Click event.\n * @private\n */\nBlockly.Field.prototype.onClick_ = function(e) {\n  if (!this.showEditorOnClick_()) {\n    return;\n  } else if (Blockly.isRightButton(e)) {\n    // Right-click.\n    return;\n  } else if (this.sourceBlock_.isEditable()) {\n    this.showEditor_();\n  }\n};\n\n/**\n * Change the tooltip text for this field.\n * @param {string|!Element} newTip Text for tooltip or a parent element to\n *     link to for its tooltip.\n */\nBlockly.Field.prototype.setTooltip = function(newTip) {\n  // Non-abstract sub-classes may wish to implement this.  See FieldLabel.\n};\n\nBlockly.Field.prototype.positionWidgetDiv = function() {\n  // intentional noop; overridden by child classes\n};\n\nBlockly.Field.prototype.handleBlockSpaceScrolled = function () {\n  if (this.sourceBlock_) {\n    this.positionWidgetDiv();\n  }\n};\n\nBlockly.Field.prototype.showWidgetDiv_ = function() {\n  Blockly.WidgetDiv.show(this, this.generateWidgetDisposeHandler_());\n\n  // if we are attached to a block, recalculate our position when the\n  // block's blockspace gets scrolled.\n  if (this.sourceBlock_ &&\n      this.sourceBlock_.blockSpace &&\n      this.sourceBlock_.blockSpace.events) {\n    var events = this.sourceBlock_.blockSpace.events;\n\n    if (!this.blockSpaceScrolledListenKey_) {\n      this.blockSpaceScrolledListenKey_ = events.listen(\n          Blockly.BlockSpace.EVENTS.BLOCK_SPACE_SCROLLED,\n          this.handleBlockSpaceScrolled.bind(this));\n    }\n  }\n};\n\n/**\n * Generates a function which will be called when the widget is closed,\n * to be used as an onDispose handler.\n * @return {function}\n */\nBlockly.Field.prototype.generateWidgetDisposeHandler_ = function() {\n  return function () {\n    if (this.blockSpaceScrolledListenKey_ &&\n        this.sourceBlock_ &&\n        this.sourceBlock_.blockSpace &&\n        this.sourceBlock_.blockSpace.events) {\n      this.sourceBlock_.blockSpace.events.unlistenByKey(\n          this.blockSpaceScrolledListenKey_);\n      this.blockSpaceScrolledListenKey_ = null;\n    }\n  }.bind(this);\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Library to create tooltips for Blockly.\n * First, call Blockly.Tooltip.init() after onload.\n * Second, set the 'tooltip' property on any SVG element that needs a tooltip.\n * If the tooltip is a string, then that message will be displayed.\n * If the tooltip is an SVG element, then that object's tooltip will be used.\n * Third, call Blockly.Tooltip.bindMouseEvents(e) passing the SVG element.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Tooltip');\n\n\n/**\n * Is a tooltip currently showing?\n */\nBlockly.Tooltip.visible = false;\n\n/**\n * PID of suspended thread to clear tooltip on mouse out.\n * @private\n */\nBlockly.Tooltip.mouseOutPid_ = 0;\n\n/**\n * PID of suspended thread to show the tooltip.\n * @private\n */\nBlockly.Tooltip.showPid_ = 0;\n\n/**\n * Last observed location of the mouse pointer (freezes when tooltip appears).\n * @private\n */\nBlockly.Tooltip.lastXY_ = {x: 0, y: 0};\n\n/**\n * Current element being pointed at.\n * @private\n */\nBlockly.Tooltip.element_ = null;\n\n/**\n * Once a tooltip has opened for an element, that element is 'poisoned' and\n * cannot respawn a tooltip until the pointer moves over a different element.\n * @private\n */\nBlockly.Tooltip.poisonedElement_ = null;\n\n/**\n * Tooltip's SVG group element.\n * @type {Element}\n * @private\n */\nBlockly.Tooltip.svgGroup_ = null;\n\n/**\n * Tooltip's SVG text element.\n * @type {SVGTextElement}\n * @private\n */\nBlockly.Tooltip.svgText_ = null;\n\n/**\n * Tooltip's SVG background rectangle.\n * @type {Element}\n * @private\n */\nBlockly.Tooltip.svgBackground_ = null;\n\n/**\n * Tooltip's SVG shadow rectangle.\n * @type {Element}\n * @private\n */\nBlockly.Tooltip.svgShadow_ = null;\n\n/**\n * Horizontal offset between mouse cursor and tooltip.\n */\nBlockly.Tooltip.OFFSET_X = 0;\n\n/**\n * Vertical offset between mouse cursor and tooltip.\n */\nBlockly.Tooltip.OFFSET_Y = 10;\n\n/**\n * Radius mouse can move before killing tooltip.\n */\nBlockly.Tooltip.RADIUS_OK = 10;\n\n/**\n * Delay before tooltip appears.\n */\nBlockly.Tooltip.HOVER_MS = 1000;\n\n/**\n * Horizontal padding between text and background.\n */\nBlockly.Tooltip.MARGINS = 5;\n\n/**\n * Create the tooltip elements.  Only needs to be called once.\n * @return {!SVGGElement} The tooltip's SVG group.\n */\nBlockly.Tooltip.createDom = function() {\n  /*\n  <g class=\"blocklyHidden\">\n    <rect class=\"blocklyTooltipShadow\" x=\"2\" y=\"2\"/>\n    <rect class=\"blocklyTooltipBackground\"/>\n    <text class=\"blocklyTooltipText\"></text>\n  </g>\n  */\n  var svgGroup = /** @type {!SVGGElement} */ (\n      Blockly.createSvgElement('g', {'class': 'blocklyHidden'}, null));\n  Blockly.Tooltip.svgGroup_ = svgGroup;\n  Blockly.Tooltip.svgShadow_ = /** @type {!SVGRectElement} */ (\n      Blockly.createSvgElement(\n          'rect', {'class': 'blocklyTooltipShadow', 'x': 2, 'y': 2}, svgGroup));\n  Blockly.Tooltip.svgBackground_ = /** @type {!SVGRectElement} */ (\n      Blockly.createSvgElement(\n          'rect', {'class': 'blocklyTooltipBackground'}, svgGroup));\n  Blockly.Tooltip.svgText_ = /** @type {!SVGTextElement} */ (\n      Blockly.createSvgElement(\n          'text', {'class': 'blocklyTooltipText'}, svgGroup));\n  return svgGroup;\n};\n\n/**\n * Binds the required mouse events onto an SVG element.\n * @param {!Element} element SVG element onto which tooltip is to be bound.\n */\nBlockly.Tooltip.bindMouseEvents = function(element) {\n  Blockly.bindEvent_(element, 'mouseover', null, Blockly.Tooltip.onMouseOver_);\n  Blockly.bindEvent_(element, 'mouseout', null, Blockly.Tooltip.onMouseOut_);\n  Blockly.bindEvent_(element, 'mousemove', null, Blockly.Tooltip.onMouseMove_);\n};\n\n/**\n * Hide the tooltip if the mouse is over a different object.\n * Initialize the tooltip to potentially appear for this object.\n * @param {!Event} e Mouse event.\n * @private\n */\nBlockly.Tooltip.onMouseOver_ = function(e) {\n  // If the tooltip is an object, treat it as a pointer to the next object in\n  // the chain to look at.  Terminate when a string or function is found.\n  var element = e.target;\n  while (!goog.isString(element.tooltip) && !goog.isFunction(element.tooltip)) {\n    element = element.tooltip;\n  }\n  if (Blockly.Tooltip.element_ != element) {\n    Blockly.Tooltip.hide();\n    Blockly.Tooltip.poisonedElement_ = null;\n    Blockly.Tooltip.element_ = element;\n  }\n  // Forget about any immediately preceeding mouseOut event.\n  window.clearTimeout(Blockly.Tooltip.mouseOutPid_);\n};\n\n/**\n * Hide the tooltip if the mouse leaves the object and enters the blockSpace.\n * @param {!Event} e Mouse event.\n * @private\n */\nBlockly.Tooltip.onMouseOut_ = function(e) {\n  // Moving from one element to another (overlapping or with no gap) generates\n  // a mouseOut followed instantly by a mouseOver.  Fork off the mouseOut\n  // event and kill it if a mouseOver is received immediately.\n  // This way the task only fully executes if mousing into the void.\n  Blockly.Tooltip.mouseOutPid_ = window.setTimeout(function() {\n        Blockly.Tooltip.element_ = null;\n        Blockly.Tooltip.poisonedElement_ = null;\n        Blockly.Tooltip.hide();\n      }, 1);\n  window.clearTimeout(Blockly.Tooltip.showPid_);\n};\n\n/**\n * When hovering over an element, schedule a tooltip to be shown.  If a tooltip\n * is already visible, hide it if the mouse strays out of a certain radius.\n * @param {!Event} e Mouse event.\n * @private\n */\nBlockly.Tooltip.onMouseMove_ = function(e) {\n  if (!Blockly.Tooltip.element_ || !Blockly.Tooltip.element_.tooltip) {\n    // No tooltip here to show.\n    return;\n  } else if (Blockly.Block.isDragging()) {\n    // Don't display a tooltip during a drag.\n    return;\n  } else if (Blockly.WidgetDiv.isVisible()) {\n    // Don't display a tooltip if a widget is open (tooltip would be under it).\n    return;\n  }\n  if (Blockly.Tooltip.visible) {\n    // Compute the distance between the mouse position when the tooltip was\n    // shown and the current mouse position.  Pythagorean theorem.\n    var mouseXY = Blockly.mouseToSvg(e);\n    var dx = Blockly.Tooltip.lastXY_.x - mouseXY.x;\n    var dy = Blockly.Tooltip.lastXY_.y - mouseXY.y;\n    var dr = Math.sqrt(Math.pow(dx, 2) + Math.pow(dy, 2));\n    if (dr > Blockly.Tooltip.RADIUS_OK) {\n      Blockly.Tooltip.hide();\n    }\n  } else if (Blockly.Tooltip.poisonedElement_ != Blockly.Tooltip.element_) {\n    // The mouse moved, clear any previously scheduled tooltip.\n    window.clearTimeout(Blockly.Tooltip.showPid_);\n    // Maybe this time the mouse will stay put.  Schedule showing of tooltip.\n    Blockly.Tooltip.lastXY_ = Blockly.mouseToSvg(e);\n    Blockly.Tooltip.showPid_ =\n        window.setTimeout(Blockly.Tooltip.show_, Blockly.Tooltip.HOVER_MS);\n  }\n};\n\n/**\n * Hide the tooltip.\n */\nBlockly.Tooltip.hide = function() {\n  if (Blockly.Tooltip.visible) {\n    Blockly.Tooltip.visible = false;\n    if (Blockly.Tooltip.svgGroup_) {\n      Blockly.Tooltip.svgGroup_.style.display = 'none';\n    }\n  }\n  window.clearTimeout(Blockly.Tooltip.showPid_);\n};\n\n/**\n * Create the tooltip and show it.\n * @private\n */\nBlockly.Tooltip.show_ = function() {\n  Blockly.Tooltip.poisonedElement_ = Blockly.Tooltip.element_;\n  if (!Blockly.Tooltip.svgGroup_) {\n    return;\n  }\n  // Erase all existing text.\n  goog.dom.removeChildren(\n      /** @type {!Element} */ (Blockly.Tooltip.svgText_));\n  // Create new text, line by line.\n  var tip = Blockly.Tooltip.element_.tooltip;\n  if (goog.isFunction(tip)) {\n    tip = tip();\n  }\n  var lines = tip.split('\\n');\n  for (var i = 0; i < lines.length; i++) {\n    var tspanElement = Blockly.createSvgElement('tspan',\n        {'dy': '1em', 'x': Blockly.Tooltip.MARGINS}, Blockly.Tooltip.svgText_);\n    var textNode = document.createTextNode(lines[i]);\n    tspanElement.appendChild(textNode);\n  }\n  // Display the tooltip.\n  Blockly.Tooltip.visible = true;\n  Blockly.Tooltip.svgGroup_.style.display = 'block';\n  // Resize the background and shadow to fit.\n  if (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0) {\n      Blockly.Tooltip.svgText_.style.display = \"inline\";   /* reqd for IE */\n      var bBox = {\n          x: Blockly.Tooltip.svgText_.getBBox().x,\n          y: Blockly.Tooltip.svgText_.getBBox().y,\n          width: Blockly.Tooltip.svgText_.scrollWidth,\n          height: Blockly.Tooltip.svgText_.scrollHeight\n      };\n  }\n  else {\n      var bBox = Blockly.Tooltip.svgText_.getBBox();\n  }\n  var width = 2 * Blockly.Tooltip.MARGINS + bBox.width;\n  var height = bBox.height;\n  Blockly.Tooltip.svgBackground_.setAttribute('width', width);\n  Blockly.Tooltip.svgBackground_.setAttribute('height', height);\n  Blockly.Tooltip.svgShadow_.setAttribute('width', width);\n  Blockly.Tooltip.svgShadow_.setAttribute('height', height);\n  if (Blockly.RTL) {\n    // Right-align the paragraph.\n    // This cannot be done until the tooltip is rendered on screen.\n    var maxWidth = bBox.width;\n    for (var x = 0, textElement;\n         textElement = Blockly.Tooltip.svgText_.childNodes[x]; x++) {\n      textElement.setAttribute('text-anchor', 'end');\n      textElement.setAttribute('x', maxWidth + Blockly.Tooltip.MARGINS);\n    }\n  }\n  // Move the tooltip to just below the cursor.\n  var anchorX = Blockly.Tooltip.lastXY_.x;\n  if (Blockly.RTL) {\n    anchorX -= Blockly.Tooltip.OFFSET_X + width;\n  } else {\n    anchorX += Blockly.Tooltip.OFFSET_X;\n  }\n  var anchorY = Blockly.Tooltip.lastXY_.y + Blockly.Tooltip.OFFSET_Y;\n\n  var svgSize = Blockly.mainBlockSpaceEditor.svgSize();\n  if (anchorY + bBox.height > svgSize.height) {\n    // Falling off the bottom of the screen; shift the tooltip up.\n    anchorY -= bBox.height + 2 * Blockly.Tooltip.OFFSET_Y;\n  }\n  if (Blockly.RTL) {\n    // Prevent falling off left edge in RTL mode.\n    anchorX = Math.max(Blockly.Tooltip.MARGINS, anchorX);\n  } else {\n    if (anchorX + bBox.width > svgSize.width - 2 * Blockly.Tooltip.MARGINS) {\n      // Falling off the right edge of the screen;\n      // clamp the tooltip on the edge.\n      anchorX = svgSize.width - bBox.width - 2 * Blockly.Tooltip.MARGINS;\n    }\n  }\n  Blockly.Tooltip.svgGroup_.setAttribute('transform',\n      'translate(' + anchorX + ',' + anchorY + ')');\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Non-editable text field.  Used for titles, labels, etc.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.FieldLabel');\n\ngoog.require('Blockly.Field');\ngoog.require('Blockly.Tooltip');\n\n/**\n * Class for a non-editable text field.\n * @param {string} text The initial content of the field.\n * @param customOptions\n * @extends {Blockly.Field}\n * @constructor\n */\nBlockly.FieldLabel = function(text, customOptions) {\n  customOptions = customOptions || {};\n\n  this.sourceBlock_ = null;\n  // Build the DOM.\n  this.textElement_ = Blockly.createSvgElement('text',\n      {'class': 'blocklyText'}, null);\n\n  var loadingSize = {width: 0, height: 25};\n  this.forceSize_ = customOptions.hasOwnProperty('fixedSize');\n  this.forceWidth_ = this.forceSize_ && customOptions.fixedSize.width !== undefined;\n\n  // ideally we would dynamically resize based on fontSize. instead we depend\n  // on fixedSize being set if you want to also change the size\n  this.fontSize_ = customOptions.fontSize;\n  this.size_ = this.forceSize_ ? customOptions.fixedSize : loadingSize;\n  this.setText(text);\n  this.fieldGroup_ = this.textElement_;\n};\ngoog.inherits(Blockly.FieldLabel, Blockly.Field);\n\n/**\n * Editable fields are saved by the XML renderer, non-editable fields are not.\n */\nBlockly.FieldLabel.prototype.EDITABLE = false;\n\n/**\n * Install this text on a block.\n * @param {!Blockly.Block} block The block containing this text.\n */\nBlockly.FieldLabel.prototype.init = function(block) {\n  if (this.sourceBlock_) {\n    throw 'Text has already been initialized once.';\n  }\n  this.sourceBlock_ = block;\n  block.getSvgRoot().appendChild(this.textElement_);\n\n  // Configure the field to be transparent with respect to tooltips.\n  this.textElement_.tooltip = this.sourceBlock_;\n  if (!this.sourceBlock_.blockSpace.blockSpaceEditor.disableTooltip) {\n    Blockly.Tooltip && Blockly.Tooltip.bindMouseEvents(this.textElement_);\n  }\n};\n\nBlockly.FieldLabel.prototype.getSize = function() {\n  // Update the width if we don't have one, unless we've forced the size to 0\n  if (!this.size_.width && !this.forceWidth_) {\n    this.updateWidth_();\n  }\n  return this.size_;\n};\n\n\nBlockly.FieldLabel.prototype.getBufferY = function() {\n  // If we explicitly set a fontSize, center our text by having a y buffer on top.\n  if (!this.fontSize_) {\n    return 0;\n  }\n\n  return (this.size_.height - this.fontSize_) / 2;\n};\n\nBlockly.FieldLabel.prototype.setText = function(text) {\n  if (text === null || text === this.text_) {\n    // No change if null.\n    return;\n  }\n  this.text_ = text;\n  // Empty the text element.\n  goog.dom.removeChildren(/** @type {!Element} */ (this.textElement_));\n  // Replace whitespace with non-breaking spaces so the text doesn't collapse.\n  text = text.replace(/\\s/g, Blockly.Field.NBSP);\n  if (!text) {\n    // Prevent the field from disappearing if empty.\n    text = Blockly.Field.NBSP;\n  }\n  var textNode = document.createTextNode(text);\n  this.textElement_.appendChild(textNode);\n\n  if (this.fontSize_) {\n    this.textElement_.style.fontSize = this.fontSize_ + \"px\";\n  }\n\n  // Cached width is obsolete.  Clear it.\n  if (!this.forceWidth_) {\n    this.size_.width = 0;\n  }\n\n  this.refreshRender();\n};\n\n/**\n * Dispose of all DOM objects belonging to this text.\n */\nBlockly.FieldLabel.prototype.dispose = function() {\n  goog.dom.removeNode(this.textElement_);\n  this.textElement_ = null;\n};\n\n/**\n * Gets the group element for this field.\n * Used for measuring the size and for positioning.\n * @return {!Element} The group element.\n */\nBlockly.FieldLabel.prototype.getRootElement = function() {\n  return /** @type {!Element} */ (this.textElement_);\n};\n\n/**\n * Change the tooltip text for this field.\n * @param {string|!Element} newTip Text for tooltip or a parent element to\n *     link to for its tooltip.\n */\nBlockly.FieldLabel.prototype.setTooltip = function(newTip) {\n  this.textElement_.tooltip = newTip;\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Object representing an input (value, statement, or dummy).\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Input');\n\n// TODO(scr): Fix circular dependencies\n// goog.require('Blockly.Block');\ngoog.require('Blockly.Connection');\ngoog.require('Blockly.FieldLabel');\n\n\n/**\n * Class for an input with an optional title.\n * @param {number} type The type of the input.\n * @param {string} name Language-neutral identifier which may used to find this\n *     input again.\n * @param {!Blockly.Block} block The block containing this input.\n * @param {?Blockly.Connection} connection Optional connection for this input.\n * @param {?number} statementTrailingSpace Optional extra space to render below\n *     this input.\n * @constructor\n */\nBlockly.Input = function(type, name, block, connection, statementTrailingSpace) {\n  this.type = type;\n  this.name = name;\n  this.sourceBlock_ = block;\n  this.connection = connection;\n  this.titleRow = [];\n  this.align = Blockly.ALIGN_LEFT;\n  this.inline_ = false;\n  this.visible_ = true;\n  this.colour_ = {\n    hue: null,\n    saturation: null,\n    value: null\n  };\n  /**\n   * Extra space to leave trailing the last block in a statement input.\n   * @private {number}\n   */\n  this.statementTrailingSpace_ = statementTrailingSpace || 0;\n};\n\n/**\n * Add an item to the end of the input's title row.\n * @param {*} title Something to add as a title.\n * @param {?string} opt_name Language-neutral identifier which may used to find\n *     this title again.  Should be unique to the host block.\n * @return {!Blockly.Input} The input being append to (to allow chaining).\n */\nBlockly.Input.prototype.appendTitle = function(title, opt_name) {\n  // Empty string, Null or undefined generates no title, unless title is named.\n  if (!title && !opt_name) {\n    return this;\n  }\n  // Generate a FieldLabel when given a plain text title.\n  if (goog.isString(title)) {\n    title = new Blockly.FieldLabel(/** @type {string} */ (title));\n  }\n  if (this.sourceBlock_.svg_) {\n    title.init(this.sourceBlock_);\n  }\n  title.name = opt_name;\n\n  if (title.prefixTitle) {\n    // Add any prefix.\n    this.appendTitle(title.prefixTitle);\n  }\n  // Add the title to the title row.\n  this.titleRow.push(title);\n  if (title.suffixTitle) {\n    // Add any suffix.\n    this.appendTitle(title.suffixTitle);\n  }\n\n  if (this.sourceBlock_.rendered) {\n    this.sourceBlock_.render();\n    // Adding a title will cause the block to change shape.\n    this.sourceBlock_.bumpNeighbours();\n  }\n  return this;\n};\n\n/**\n * Gets whether this input is visible or not.\n * @return {boolean} True if visible.\n */\nBlockly.Input.prototype.isVisible = function() {\n  return this.visible_;\n};\n\n/**\n * Sets whether this input is visible or not.\n * @param {boolean} visible True if visible.\n * @return {!Array.<!Blockly.Block>} List of blocks to render.\n */\nBlockly.Input.prototype.setVisible = function(visible) {\n  var renderList = [];\n  if (this.visible_ == visible) {\n    return renderList;\n  }\n  this.visible_ = visible;\n\n  var display = visible ? 'block' : 'none';\n  for (var y = 0, title; title = this.titleRow[y]; y++) {\n    title.setVisible(visible);\n  }\n  if (this.connection) {\n    // Has a connection.\n    if (visible) {\n      renderList = this.connection.unhideAll();\n    } else {\n      renderList = this.connection.hideAll();\n    }\n    var child = this.connection.targetBlock();\n    if (child) {\n      child.svg_.getRootElement().style.display = display;\n      if (!visible) {\n        child.rendered = false;\n      }\n    }\n  }\n  return renderList;\n};\n\n/**\n * Change a connection's compatibility.\n * @param {string|Array.<string>|null} check Compatible value type or\n *     list of value types.  Null if all types are compatible.\n * @return {!Blockly.Input} The input being modified (to allow chaining).\n */\nBlockly.Input.prototype.setStrictCheck = function(check) {\n  if (!this.connection) {\n    throw 'This input does not have a connection.';\n  }\n  this.connection.setStrictCheck(check);\n  return this;\n};\n\n/**\n * Change a connection's compatibility.\n * @param {string|Array.<string>|null} check Compatible value type or\n *     list of value types.  Null if all types are compatible.\n * @return {!Blockly.Input} The input being modified (to allow chaining).\n */\nBlockly.Input.prototype.setCheck = function(check) {\n  if (!this.connection) {\n    throw 'This input does not have a connection.';\n  }\n  this.connection.setCheck(check);\n  return this;\n};\n\n/**\n * Enable the specified field helper with the specified options for this\n * input's connection\n * @param {string} fieldHelper the field helper to retrieve. One of\n *        Blockly.BlockFieldHelper\n * @param {*} options for this helper\n * @return {!Blockly.Input} The input being modified (to allow chaining).\n */\nBlockly.Input.prototype.addFieldHelper = function(fieldHelper, options) {\n  if (this.type !== Blockly.INPUT_VALUE) {\n    throw 'Only Value Inputs can be augmented with helpers';\n  }\n\n  this.connection.addFieldHelper(fieldHelper, options);\n  return this;\n};\n\n/**\n * Change the alignment of the connection's title(s).\n * @param {number} align One of Blockly.ALIGN_LEFT, ALIGN_CENTRE, ALIGN_RIGHT.\n *   In RTL mode directions are reversed, and ALIGN_RIGHT aligns to the left.\n * @return {!Blockly.Input} The input being modified (to allow chaining).\n */\nBlockly.Input.prototype.setAlign = function(align) {\n  this.align = align;\n  if (this.sourceBlock_.rendered) {\n    this.sourceBlock_.render();\n  }\n  return this;\n};\n\n/**\n * Initialize the titles on this input.\n */\nBlockly.Input.prototype.init = function() {\n  for (var x = 0; x < this.titleRow.length; x++) {\n    this.titleRow[x].init(this.sourceBlock_);\n  }\n};\n\n/**\n * Sever all links to this input.\n */\nBlockly.Input.prototype.dispose = function() {\n  for (var i = 0, title; title = this.titleRow[i]; i++) {\n    title.dispose();\n  }\n  if (this.connection) {\n    this.connection.dispose();\n  }\n  this.sourceBlock_ = null;\n};\n\n/**\n * Mark this input as being inlined (on the same row as the previous input).\n * When rendering blocks, each input will get a new line unless\n * (1) inputsInLine is true on the parent block\n * (2) inline_ is set on the input\n * Note, we don't allow inlining NEXT_STATEMENT inputs\n */\nBlockly.Input.prototype.setInline = function (inline) {\n  if (inline === undefined) {\n    inline = true;\n  }\n  this.inline_ = inline;\n  if (this.type === Blockly.NEXT_STATEMENT && inline) {\n    throw \"Can't inline next statement\";\n  }\n  return this;\n};\n\n/**\n * Is this input inlined? Can be marked on the input itself, or on the source\n * block\n */\nBlockly.Input.prototype.isInline = function () {\n  if (this.type === Blockly.NEXT_STATEMENT) {\n    return false;\n  }\n  return this.inline_ || this.sourceBlock_.inputsInline;\n};\n\nBlockly.Input.prototype.setHSV = function (hue, saturation, value) {\n  if (this.type !== Blockly.FUNCTIONAL_INPUT) {\n    throw \"setColor only for functional inputs\";\n  }\n  this.colour_ = { hue: hue, saturation: saturation, value: value };\n\n  return this;\n};\n\nBlockly.Input.prototype.getHexColour = function() {\n  return Blockly.makeColour(this.colour_.hue, this.colour_.saturation,\n    this.colour_.value);\n};\n\n/**\n * @return {number} extra spacing to leave below last statement in an input.\n */\nBlockly.Input.prototype.getStatementTrailingSpace = function() {\n  return this.statementTrailingSpace_;\n};\n\nBlockly.Input.prototype.matchesBlock = function (block) {\n  if (block.getColour() !== this.colour_.hue) {\n    return false;\n  }\n  if (block.getSaturation() !== this.colour_.saturation) {\n    return false;\n  }\n  if (block.getValue() !== this.colour_.value) {\n    return false;\n  }\n  return true;\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2013 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Core JavaScript library for Blockly.\n * @author scr@google.com (Sheridan Rawlins)\n */\n'use strict';\n\n/**\n * Name space for the Msg singleton.\n * Msg gets populated in the message files.\n */\ngoog.provide('Blockly.Msg');\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Object representing a UI bubble.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Bubble');\n\ngoog.require('Blockly.BlockSpace');\n\n\n/**\n * Class for UI bubble.\n * @param {!Blockly.BlockSpace} blockSpace The blockSpace on which to draw the\n *     bubble.\n * @param {!Element} content SVG content for the bubble.\n * @param {Element} shape SVG element to avoid eclipsing.\n * @param {number} anchorX Absolute horizontal position of bubbles anchor point.\n * @param {number} anchorY Absolute vertical position of bubbles anchor point.\n * @param {?number} bubbleWidth Width of bubble, or null if not resizable.\n * @param {?number} bubbleHeight Height of bubble, or null if not resizable.\n * @constructor\n */\nBlockly.Bubble = function(blockSpace, content, shape,\n                          anchorX, anchorY,\n                          bubbleWidth, bubbleHeight, dragCanvas) {\n  var angle = Blockly.Bubble.ARROW_ANGLE;\n  if (Blockly.RTL) {\n    angle = -angle;\n  }\n  this.arrow_radians_ = angle / 360 * Math.PI * 2;\n\n  this.blockSpace_ = blockSpace;\n  this.content_ = content;\n  this.shape_ = shape;\n  this.dragCanvas_ = dragCanvas;\n  var canvas = blockSpace.getBubbleCanvas();\n  canvas.appendChild(this.createDom_(content, !!(bubbleWidth && bubbleHeight)));\n\n  this.setAnchorLocation(anchorX, anchorY);\n  if (!bubbleWidth || !bubbleHeight) {\n    var bBox;\n    try {\n      bBox = content.getBBox();\n    } catch(e) {\n      // IE9 sometimes throws an exception above when rendering the\n      // function inputs box, presumably because the content hasn't\n      // been rendered yet. In this case, a later call to resizeBubble_\n      // sets the size correctly.\n      bBox = this.blockSpace_.getCanvas().getBBox();\n    }\n    bubbleWidth = bBox.width + 2 * Blockly.Bubble.BORDER_WIDTH;\n    bubbleHeight = bBox.height + 2 * Blockly.Bubble.BORDER_WIDTH;\n  }\n  this.setBubbleSize(bubbleWidth, bubbleHeight);\n\n  // Render the bubble.\n  this.positionBubble_();\n  this.renderArrow_();\n  this.rendered_ = true;\n\n  if (!blockSpace.isReadOnly()) {\n    Blockly.bindEvent_(this.bubbleBack_, 'mousedown', this,\n                       this.bubbleMouseDown_);\n    if (this.resizeGroup_) {\n      Blockly.bindEvent_(this.resizeGroup_, 'mousedown', this,\n                         this.resizeMouseDown_);\n    }\n  }\n};\n\n/**\n * Width of the border around the bubble.\n */\nBlockly.Bubble.BORDER_WIDTH = 6;\n\n/**\n * Determines the thickness of the base of the arrow in relation to the size\n * of the bubble.  Higher numbers result in thinner arrows.\n */\nBlockly.Bubble.ARROW_THICKNESS = 10;\n\n/**\n * The number of degrees that the arrow bends counter-clockwise.\n */\nBlockly.Bubble.ARROW_ANGLE = 20;\n\n/**\n * The sharpness of the arrow's bend.  Higher numbers result in smoother arrows.\n */\nBlockly.Bubble.ARROW_BEND = 4;\n\n/**\n * Distance between arrow point and anchor point.\n */\nBlockly.Bubble.ANCHOR_RADIUS = 8;\n\n/**\n * Wrapper function called when a mouseUp occurs during a drag operation.\n * @type {BindData}\n * @private\n */\nBlockly.Bubble.onMouseUpWrapper_ = null;\n\n/**\n * Wrapper function called when a mouseMove occurs during a drag operation.\n * @type {BindData}\n * @private\n */\nBlockly.Bubble.onMouseMoveWrapper_ = null;\n\n/**\n * Stop binding to the global mouseup and mousemove events.\n * @private\n */\nBlockly.Bubble.unbindDragEvents_ = function() {\n  if (Blockly.Bubble.onMouseUpWrapper_) {\n    Blockly.unbindEvent_(Blockly.Bubble.onMouseUpWrapper_);\n    Blockly.Bubble.onMouseUpWrapper_ = null;\n  }\n  if (Blockly.Bubble.onMouseMoveWrapper_) {\n    Blockly.unbindEvent_(Blockly.Bubble.onMouseMoveWrapper_);\n    Blockly.Bubble.onMouseMoveWrapper_ = null;\n  }\n};\n\n/**\n * Flag to stop incremental rendering during construction.\n * @private\n */\nBlockly.Bubble.prototype.rendered_ = false;\n\n/**\n * Absolute X coordinate of anchor point.\n * @private\n */\nBlockly.Bubble.prototype.anchorX_ = 0;\n\n/**\n * Absolute Y coordinate of anchor point.\n * @private\n */\nBlockly.Bubble.prototype.anchorY_ = 0;\n\n/**\n * Relative X coordinate of bubble with respect to the anchor's centre.\n * In RTL mode the initial value is negated.\n * @private\n */\nBlockly.Bubble.prototype.relativeLeft_ = 0;\n\n/**\n * Relative Y coordinate of bubble with respect to the anchor's centre.\n * @private\n */\nBlockly.Bubble.prototype.relativeTop_ = 0;\n\n/**\n * Width of bubble.\n * @private\n */\nBlockly.Bubble.prototype.width_ = 0;\n\n/**\n * Height of bubble.\n * @private\n */\nBlockly.Bubble.prototype.height_ = 0;\n\n/**\n * Automatically position and reposition the bubble.\n * @private\n */\nBlockly.Bubble.prototype.autoLayout_ = true;\n\n/**\n * Create the bubble's DOM.\n * @param {!Element} content SVG content for the bubble.\n * @param {boolean} hasResize Add diagonal resize gripper if true.\n * @return {!Element} The bubble's SVG group.\n * @private\n */\nBlockly.Bubble.prototype.createDom_ = function(content, hasResize) {\n  /* Create the bubble.  Here's the markup that will be generated:\n  <g>\n    <g filter=\"url(#blocklyEmboss)\">\n      <path d=\"... Z\" />\n      <rect class=\"blocklyDraggable\" rx=\"8\" ry=\"8\" width=\"180\" height=\"180\"/>\n    </g>\n    <g transform=\"translate(165, 165)\" class=\"blocklyResizeSE\">\n      <polygon points=\"0,15 15,15 15,0\"/>\n      <line class=\"blocklyResizeLine\" x1=\"5\" y1=\"14\" x2=\"14\" y2=\"5\"/>\n      <line class=\"blocklyResizeLine\" x1=\"10\" y1=\"14\" x2=\"14\" y2=\"10\"/>\n    </g>\n    [...content goes here...]\n  </g>\n  */\n  this.bubbleGroup_ = Blockly.createSvgElement('g', {}, null);\n  var bubbleEmboss = Blockly.createSvgElement('g',\n      {'filter': 'url(#blocklyEmboss)'}, this.bubbleGroup_);\n  this.bubbleArrow_ = Blockly.createSvgElement('path', {}, bubbleEmboss);\n  this.bubbleBack_ = Blockly.createSvgElement('rect',\n      {'class': 'blocklyDraggable', 'x': 0, 'y': 0,\n      'rx': Blockly.Bubble.BORDER_WIDTH, 'ry': Blockly.Bubble.BORDER_WIDTH},\n      bubbleEmboss);\n  if (hasResize) {\n    this.resizeGroup_ = Blockly.createSvgElement('g',\n        {'class': Blockly.RTL ? 'blocklyResizeSW' : 'blocklyResizeSE'},\n        this.bubbleGroup_);\n    var resizeSize = 2 * Blockly.Bubble.BORDER_WIDTH;\n    Blockly.createSvgElement('polygon',\n        {'points': '0,x x,x x,0'.replace(/x/g, resizeSize.toString())},\n        this.resizeGroup_);\n    Blockly.createSvgElement('line',\n        {'class': 'blocklyResizeLine',\n        'x1': resizeSize / 3, 'y1': resizeSize - 1,\n        'x2': resizeSize - 1, 'y2': resizeSize / 3}, this.resizeGroup_);\n    Blockly.createSvgElement('line',\n        {'class': 'blocklyResizeLine',\n        'x1': resizeSize * 2 / 3, 'y1': resizeSize - 1,\n        'x2': resizeSize - 1, 'y2': resizeSize * 2 / 3}, this.resizeGroup_);\n  } else {\n    this.resizeGroup_ = null;\n  }\n  this.bubbleGroup_.appendChild(content);\n  return this.bubbleGroup_;\n};\n\n/**\n * Handle a mouse-down on bubble's border.\n * @param {!Event} e Mouse down event.\n * @private\n */\nBlockly.Bubble.prototype.bubbleMouseDown_ = function(e) {\n  this.promote_();\n  Blockly.Bubble.unbindDragEvents_();\n  if (Blockly.isRightButton(e)) {\n    // Right-click.\n    return;\n  } else if (Blockly.isTargetInput(e)) {\n    // When focused on an HTML text input widget, don't trap any events.\n    return;\n  }\n  // Left-click (or middle click)\n  this.blockSpace_.blockSpaceEditor.setCursor(Blockly.Css.Cursor.CLOSED);\n  // Record the starting offset between the current location and the mouse.\n  if (Blockly.RTL) {\n    this.dragDeltaX = this.relativeLeft_ + e.clientX;\n  } else {\n    this.dragDeltaX = this.relativeLeft_ - e.clientX;\n  }\n  this.dragDeltaY = this.relativeTop_ - e.clientY;\n\n  Blockly.Bubble.onMouseUpWrapper_ = Blockly.bindEvent_(document,\n      'mouseup', this, Blockly.Bubble.unbindDragEvents_);\n  Blockly.Bubble.onMouseMoveWrapper_ = Blockly.bindEvent_(document,\n      'mousemove', this, this.bubbleMouseMove_);\n  this.blockSpace_.blockSpaceEditor.hideChaff();\n  // This event has been handled.  No need to bubble up to the document.\n  e.stopPropagation();\n};\n\n/**\n * Drag this bubble to follow the mouse.\n * @param {!Event} e Mouse move event.\n * @private\n */\nBlockly.Bubble.prototype.bubbleMouseMove_ = function(e) {\n  this.autoLayout_ = false;\n  if (Blockly.RTL) {\n    this.relativeLeft_ = this.dragDeltaX - e.clientX;\n  } else {\n    this.relativeLeft_ = this.dragDeltaX + e.clientX;\n  }\n  this.relativeTop_ = this.dragDeltaY + e.clientY;\n  this.positionBubble_();\n  this.renderArrow_();\n};\n\n/**\n * Handle a mouse-down on bubble's resize corner.\n * @param {!Event} e Mouse down event.\n * @private\n */\nBlockly.Bubble.prototype.resizeMouseDown_ = function(e) {\n  this.promote_();\n  Blockly.Bubble.unbindDragEvents_();\n  if (Blockly.isRightButton(e)) {\n    // Right-click.\n    return;\n  }\n  // Left-click (or middle click)\n  this.blockSpace_.blockSpaceEditor.setCursor(Blockly.Css.Cursor.CLOSED);\n  // Record the starting offset between the current location and the mouse.\n  if (Blockly.RTL) {\n    this.resizeDeltaWidth = this.width_ + e.clientX;\n  } else {\n    this.resizeDeltaWidth = this.width_ - e.clientX;\n  }\n  this.resizeDeltaHeight = this.height_ - e.clientY;\n\n  Blockly.Bubble.onMouseUpWrapper_ = Blockly.bindEvent_(document,\n      'mouseup', this, Blockly.Bubble.unbindDragEvents_);\n  Blockly.Bubble.onMouseMoveWrapper_ = Blockly.bindEvent_(document,\n      'mousemove', this, this.resizeMouseMove_);\n  this.blockSpace_.blockSpaceEditor.hideChaff();\n  // This event has been handled.  No need to bubble up to the document.\n  e.stopPropagation();\n};\n\n/**\n * Resize this bubble to follow the mouse.\n * @param {!Event} e Mouse move event.\n * @private\n */\nBlockly.Bubble.prototype.resizeMouseMove_ = function(e) {\n  this.autoLayout_ = false;\n  var w = this.resizeDeltaWidth;\n  var h = this.resizeDeltaHeight + e.clientY;\n  if (Blockly.RTL) {\n    // RTL drags the bottom-left corner.\n    w -= e.clientX;\n  } else {\n    // LTR drags the bottom-right corner.\n    w += e.clientX;\n  }\n  this.setBubbleSize(w, h);\n  if (Blockly.RTL) {\n    // RTL requires the bubble to move its left edge.\n    this.positionBubble_();\n  }\n};\n\n/**\n * Register a function as a callback event for when the bubble is resized.\n * @param {Object} thisObject The value of 'this' in the callback.\n * @param {!Function} callback The function to call on resize.\n */\nBlockly.Bubble.prototype.registerResizeEvent = function(thisObject, callback) {\n  Blockly.bindEvent_(this.bubbleGroup_, 'resize', thisObject, callback);\n};\n\n/**\n * Move this bubble to the top of the stack.\n * @private\n */\nBlockly.Bubble.prototype.promote_ = function() {\n  var svgGroup = this.bubbleGroup_.parentNode;\n  svgGroup.appendChild(this.bubbleGroup_);\n};\n\n/**\n * Notification that the anchor has moved.\n * Update the arrow and bubble accordingly.\n * @param {number} x Absolute horizontal location.\n * @param {number} y Absolute vertical location.\n */\nBlockly.Bubble.prototype.setAnchorLocation = function(x, y) {\n  this.anchorX_ = x;\n  this.anchorY_ = y;\n  if (this.rendered_) {\n    this.positionBubble_();\n  }\n};\n\n/**\n * Position the bubble so that it does not fall offscreen.\n * @private\n */\nBlockly.Bubble.prototype.layoutBubble_ = function() {\n  // Compute the preferred bubble location.\n  var relativeLeft = -this.width_ / 4;\n  var relativeTop = -this.height_ - Blockly.BlockSvg.MIN_BLOCK_Y;\n  // Prevent the bubble from being offscreen.\n  if (this.blockSpace_.scrollbarPair) {\n    // Fetch the blockSpace's metrics, if they exist.\n    var metrics = this.blockSpace_.getMetrics();\n    if (this.anchorX_ + relativeLeft <\n        Blockly.BlockSvg.SEP_SPACE_X + metrics.viewLeft) {\n      // Slide the bubble right until it is onscreen.\n      relativeLeft = Blockly.BlockSvg.SEP_SPACE_X + metrics.viewLeft -\n          this.anchorX_;\n    } else if (metrics.viewLeft + metrics.viewWidth <\n        this.anchorX_ + relativeLeft + this.width_ +\n        Blockly.BlockSvg.SEP_SPACE_X +\n        Blockly.Scrollbar.scrollbarThickness) {\n      // Slide the bubble left until it is onscreen.\n      relativeLeft = metrics.viewLeft + metrics.viewWidth - this.anchorX_ -\n          this.width_ - Blockly.BlockSvg.SEP_SPACE_X -\n          Blockly.Scrollbar.scrollbarThickness;\n    }\n    if (this.anchorY_ + relativeTop <\n        Blockly.BlockSvg.SEP_SPACE_Y + metrics.viewTop) {\n      // Slide the bubble below the block.\n        if (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0) {\n            (this.shape_).style.display = \"inline\";   /* reqd for IE */\n            var bBox = {\n                x: (this.shape_).getBBox().x,\n                y: (this.shape_).getBBox().y,\n                width: (this.shape_).scrollWidth,\n                height: (this.shape_).scrollHeight\n            };\n        }\n        else {\n            var bBox = /** @type {SVGLocatable} */ (this.shape_).getBBox();\n        }\n      relativeTop = bBox.height;\n    }\n  }\n  this.relativeLeft_ = relativeLeft;\n  this.relativeTop_ = relativeTop;\n};\n\n/**\n * Move the bubble to a location relative to the anchor's centre.\n * @private\n */\nBlockly.Bubble.prototype.positionBubble_ = function() {\n  var left;\n  if (Blockly.RTL) {\n    left = this.anchorX_ - this.relativeLeft_ - this.width_;\n  } else {\n    left = this.anchorX_ + this.relativeLeft_;\n  }\n  var top = this.relativeTop_ + this.anchorY_;\n  this.bubbleGroup_.setAttribute('transform',\n      'translate(' + left + ', ' + top + ')');\n\n  var offset = Blockly.convertCoordinates(Blockly.RTL ? this.blockSpaceWidth_ : 0, 0, this.content_, false);\n  this.dragCanvas_.setAttribute('transform', 'translate(' + offset.x + ',' + offset.y + ')');\n};\n\n/**\n * Get the dimensions of this bubble.\n * @return {!Object} Object with width and height properties.\n */\nBlockly.Bubble.prototype.getBubbleSize = function() {\n  return {width: this.width_, height: this.height_};\n};\n\n/**\n * Size this bubble.\n * @param {number} width Width of the bubble.\n * @param {number} height Height of the bubble.\n */\nBlockly.Bubble.prototype.setBubbleSize = function(width, height) {\n  var doubleBorderWidth = 2 * Blockly.Bubble.BORDER_WIDTH;\n  // Minimum size of a bubble.\n  width = Math.max(width, doubleBorderWidth + 45);\n  height = Math.max(height, doubleBorderWidth + Blockly.BlockSvg.TITLE_HEIGHT);\n  this.width_ = width;\n  this.height_ = height;\n  this.bubbleBack_.setAttribute('width', width);\n  this.bubbleBack_.setAttribute('height', height);\n  if (this.resizeGroup_) {\n    if (Blockly.RTL) {\n      // Mirror the resize group.\n      var resizeSize = 2 * Blockly.Bubble.BORDER_WIDTH;\n      this.resizeGroup_.setAttribute('transform', 'translate(' +\n          resizeSize + ', ' +\n          (height - doubleBorderWidth) + ') scale(-1 1)');\n    } else {\n      this.resizeGroup_.setAttribute('transform', 'translate(' +\n          (width - doubleBorderWidth) + ', ' +\n          (height - doubleBorderWidth) + ')');\n    }\n  }\n  if (this.rendered_) {\n    if (this.autoLayout_) {\n      this.layoutBubble_();\n    }\n    this.positionBubble_();\n    this.renderArrow_();\n  }\n  // Fire an event to allow the contents to resize.\n  Blockly.fireUiEvent(this.bubbleGroup_, 'resize');\n};\n\n/**\n * Draw the arrow between the bubble and the origin.\n * @private\n */\nBlockly.Bubble.prototype.renderArrow_ = function() {\n  var steps = [];\n  // Find the relative coordinates of the center of the bubble.\n  var relBubbleX = this.width_ / 2;\n  var relBubbleY = this.height_ / 2;\n  // Find the relative coordinates of the center of the anchor.\n  var relAnchorX = -this.relativeLeft_;\n  var relAnchorY = -this.relativeTop_;\n  if (relBubbleX == relAnchorX && relBubbleY == relAnchorY) {\n    // Null case.  Bubble is directly on top of the anchor.\n    // Short circuit this rather than wade through divide by zeros.\n    steps.push('M ' + relBubbleX + ',' + relBubbleY);\n  } else {\n    // Compute the angle of the arrow's line.\n    var rise = relAnchorY - relBubbleY;\n    var run = relAnchorX - relBubbleX;\n    if (Blockly.RTL) {\n      run *= -1;\n    }\n    var hypotenuse = Math.sqrt(rise * rise + run * run);\n    var angle = Math.acos(run / hypotenuse);\n    if (rise < 0) {\n      angle = 2 * Math.PI - angle;\n    }\n    // Compute a line perpendicular to the arrow.\n    var rightAngle = angle + Math.PI / 2;\n    if (rightAngle > Math.PI * 2) {\n      rightAngle -= Math.PI * 2;\n    }\n    var rightRise = Math.sin(rightAngle);\n    var rightRun = Math.cos(rightAngle);\n\n    // Calculate the thickness of the base of the arrow.\n    var bubbleSize = this.getBubbleSize();\n    var thickness = (bubbleSize.width + bubbleSize.height) /\n                    Blockly.Bubble.ARROW_THICKNESS;\n    thickness = Math.min(thickness, bubbleSize.width, bubbleSize.height) / 2;\n\n    // Back the tip of the arrow off of the anchor.\n    var backoffRatio = 1 - Blockly.Bubble.ANCHOR_RADIUS / hypotenuse;\n    relAnchorX = relBubbleX + backoffRatio * run;\n    relAnchorY = relBubbleY + backoffRatio * rise;\n\n    // Coordinates for the base of the arrow.\n    var baseX1 = relBubbleX + thickness * rightRun;\n    var baseY1 = relBubbleY + thickness * rightRise;\n    var baseX2 = relBubbleX - thickness * rightRun;\n    var baseY2 = relBubbleY - thickness * rightRise;\n\n    // Distortion to curve the arrow.\n    var swirlAngle = angle + this.arrow_radians_;\n    if (swirlAngle > Math.PI * 2) {\n      swirlAngle -= Math.PI * 2;\n    }\n    var swirlRise = Math.sin(swirlAngle) *\n        hypotenuse / Blockly.Bubble.ARROW_BEND;\n    var swirlRun = Math.cos(swirlAngle) *\n        hypotenuse / Blockly.Bubble.ARROW_BEND;\n\n    steps.push('M' + baseX1 + ',' + baseY1);\n    steps.push('C' + (baseX1 + swirlRun) + ',' + (baseY1 + swirlRise) +\n               ' ' + relAnchorX + ',' + relAnchorY +\n               ' ' + relAnchorX + ',' + relAnchorY);\n    steps.push('C' + relAnchorX + ',' + relAnchorY +\n               ' ' + (baseX2 + swirlRun) + ',' + (baseY2 + swirlRise) +\n               ' ' + baseX2 + ',' + baseY2);\n  }\n  steps.push('z');\n  this.bubbleArrow_.setAttribute('d', steps.join(' '));\n};\n\n/**\n * Change the colour of a bubble.\n * @param {string} hexColour Hex code of colour.\n */\nBlockly.Bubble.prototype.setColour = function(hexColour) {\n  this.bubbleBack_.setAttribute('fill', hexColour);\n  this.bubbleArrow_.setAttribute('fill', hexColour);\n};\n\n/**\n * Dispose of this bubble.\n */\nBlockly.Bubble.prototype.dispose = function() {\n  Blockly.Bubble.unbindDragEvents_();\n  // Dispose of and unlink the bubble.\n  goog.dom.removeNode(this.bubbleGroup_);\n  this.bubbleGroup_ = null;\n  this.blockSpace_ = null;\n  this.content_ = null;\n  this.shape_ = null;\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2013 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Object representing an icon on a block.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Icon');\n\n/**\n * Class for an icon.\n * @param {Blockly.Block} block The block associated with this icon.\n * @constructor\n */\nBlockly.Icon = function(block) {\n  this.block_ = block;\n};\n\n/**\n * Radius of icons.\n */\nBlockly.Icon.RADIUS = 8;\n\n/**\n * Bubble UI (if visible).\n * @type {Blockly.Bubble}\n * @private\n */\nBlockly.Icon.prototype.bubble_ = null;\n\n/**\n * Absolute X coordinate of icon's center.\n * @private\n */\nBlockly.Icon.prototype.iconX_ = 0;\n\n/**\n * Absolute Y coordinate of icon's centre.\n * @private\n */\nBlockly.Icon.prototype.iconY_ = 0;\n\n/**\n * Create the icon on the block.\n * @private\n */\nBlockly.Icon.prototype.createIcon_ = function() {\n  /* Here's the markup that will be generated:\n  <g class=\"blocklyIconGroup\"></g>\n  */\n  this.iconGroup_ = Blockly.createSvgElement('g', {}, null);\n  this.block_.getSvgRoot().appendChild(this.iconGroup_);\n  Blockly.bindEvent_(this.iconGroup_, 'mouseup', this, this.iconClick_);\n  this.updateEditable();\n};\n\n/**\n * Dispose of this icon.\n */\nBlockly.Icon.prototype.dispose = function() {\n  // Dispose of and unlink the icon.\n  goog.dom.removeNode(this.iconGroup_);\n  this.iconGroup_ = null;\n  // Dispose of and unlink the bubble.\n  this.setVisible(false);\n  this.block_ = null;\n};\n\n/**\n * Add or remove the UI indicating if this icon may be clicked or not.\n */\nBlockly.Icon.prototype.updateEditable = function() {\n  if (this.block_.isEditable() && !this.block_.isInFlyout) {\n    Blockly.addClass_(/** @type {!Element} */ (this.iconGroup_),\n                      'blocklyIconGroup');\n  } else {\n    Blockly.removeClass_(/** @type {!Element} */ (this.iconGroup_),\n                         'blocklyIconGroup');\n  }\n};\n\n/**\n * Is the associated bubble visible?\n * @return {boolean} True if the bubble is visible.\n */\nBlockly.Icon.prototype.isVisible = function() {\n  return !!this.bubble_;\n};\n\n/**\n * Clicking on the icon toggles if the bubble is visible.\n * @param {!Event} e Mouse click event.\n * @private\n */\nBlockly.Icon.prototype.iconClick_ = function(e) {\n  if (this.block_.isEditable() && !this.block_.isInFlyout) {\n    this.setVisible(!this.isVisible());\n  }\n};\n\n/**\n * Change the colour of the associated bubble to match its block.\n */\nBlockly.Icon.prototype.updateColour = function() {\n  if (this.isVisible()) {\n    this.bubble_.setColour(this.block_.getHexColour());\n  }\n};\n\n/**\n * Render the icon.\n * @param {number} cursorX Horizontal offset at which to position the icon.\n * @return {number} Horizontal offset for next item to draw.\n */\nBlockly.Icon.prototype.renderIcon = function(cursorX) {\n  if (this.block_.isCollapsed()) {\n    this.iconGroup_.setAttribute('display', 'none');\n    return cursorX;\n  }\n  this.iconGroup_.setAttribute('display', 'block');\n\n  var TOP_MARGIN = 5;\n  var diameter = 2 * Blockly.Icon.RADIUS;\n  if (Blockly.RTL) {\n    cursorX -= diameter;\n  }\n  this.iconGroup_.setAttribute('transform',\n      'translate(' + cursorX + ', ' + TOP_MARGIN + ')');\n  this.computeIconLocation();\n  if (Blockly.RTL) {\n    cursorX -= Blockly.BlockSvg.SEP_SPACE_X;\n  } else {\n    cursorX += diameter + Blockly.BlockSvg.SEP_SPACE_X;\n  }\n  return cursorX;\n};\n\n/**\n * Notification that the icon has moved.  Update the arrow accordingly.\n * @param {number} x Absolute horizontal location.\n * @param {number} y Absolute vertical location.\n */\nBlockly.Icon.prototype.setIconLocation = function(x, y) {\n  this.iconX_ = x;\n  this.iconY_ = y;\n  if (this.isVisible()) {\n    this.bubble_.setAnchorLocation(x, y);\n  }\n};\n\n/**\n * Notification that the icon has moved, but we don't really know where.\n * Recompute the icon's location from scratch.\n */\nBlockly.Icon.prototype.computeIconLocation = function() {\n  // Find coordinates for the centre of the icon and update the arrow.\n  var blockXY = this.block_.getRelativeToSurfaceXY();\n  var iconXY = Blockly.getRelativeXY(this.iconGroup_);\n  var newX = blockXY.x + iconXY.x + Blockly.Icon.RADIUS;\n  var newY = blockXY.y + iconXY.y + Blockly.Icon.RADIUS;\n  if (newX !== this.iconX_ || newY !== this.iconY_) {\n    this.setIconLocation(newX, newY);\n  }\n};\n\n/**\n * Returns the center of the block's icon relative to the surface.\n * @return {!Object} Object with x and y properties.\n */\nBlockly.Icon.prototype.getIconLocation = function() {\n  return {x: this.iconX_, y: this.iconY_};\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Object representing a mutator dialog.  A mutator allows the\n * user to change the shape of a block using a nested blocks editor.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Mutator');\n\ngoog.require('Blockly.Bubble');\ngoog.require('Blockly.Icon');\n\n\n/**\n * Class for a mutator dialog.\n * @param {!Array.<string>} quarkNames List of names of sub-blocks for flyout.\n * @extends {Blockly.Icon}\n * @constructor\n */\nBlockly.Mutator = function(quarkNames) {\n  Blockly.Mutator.superClass_.constructor.call(this, null);\n  this.quarkXml_ = [];\n  // Convert the list of names into a list of XML objects for the flyout.\n  for (var x = 0; x < quarkNames.length; x++) {\n    var element = goog.dom.createDom('block', {'type': quarkNames[x]});\n    this.quarkXml_[x] = element;\n  }\n};\ngoog.inherits(Blockly.Mutator, Blockly.Icon);\n\n/**\n * Width of blockSpace.\n * @private\n */\nBlockly.Mutator.prototype.blockSpaceWidth_ = 0;\n\n/**\n * Height of blockSpace.\n * @private\n */\nBlockly.Mutator.prototype.blockSpaceHeight_ = 0;\n\n/**\n * Create the icon on the block.\n */\nBlockly.Mutator.prototype.createIcon = function() {\n  Blockly.Icon.prototype.createIcon_.call(this);\n  /* Here's the markup that will be generated:\n  <rect class=\"blocklyIconShield\" width=\"16\" height=\"16\" rx=\"4\" ry=\"4\"/>\n  <text class=\"blocklyIconMark\" x=\"8\" y=\"12\"></text>\n  */\n  var quantum = Blockly.Icon.RADIUS / 2;\n  var iconShield = Blockly.createSvgElement('rect',\n      {'class': 'blocklyIconShield',\n       'width': 4 * quantum,\n       'height': 4 * quantum,\n       'rx': quantum,\n       'ry': quantum}, this.iconGroup_);\n  this.iconMark_ = Blockly.createSvgElement('text',\n      {'class': 'blocklyIconMark',\n       'x': Blockly.Icon.RADIUS,\n       'y': 2 * Blockly.Icon.RADIUS - 4}, this.iconGroup_);\n  this.iconMark_.appendChild(document.createTextNode('\\u2605'));\n};\n\n/**\n * Create the editor for the mutator's bubble.\n * @return {!Element} The top-level node of the editor.\n * @private\n */\nBlockly.Mutator.prototype.createEditor_ = function() {\n  /* Create the editor.  Here's the markup that will be generated:\n  <svg>\n    <rect class=\"blocklyMutatorBackground\" />\n    [Flyout]\n    [BlockSpace]\n  </svg>\n  */\n  this.svgDialog_ = Blockly.createSvgElement('svg',\n      {'x': Blockly.Bubble.BORDER_WIDTH, 'y': Blockly.Bubble.BORDER_WIDTH},\n      null);\n  this.svgBackground_ = Blockly.createSvgElement('rect',\n      {'class': 'blocklyMutatorBackground',\n       'height': '100%', 'width': '100%'}, this.svgDialog_);\n\n  var mutator = this;\n  var blockSpaceEditor = this.block_.blockSpace.blockSpaceEditor;\n  this.blockSpace_ = new Blockly.BlockSpace(blockSpaceEditor,\n      function() {return mutator.getFlyoutMetrics_();}, null);\n  this.blockSpace_.flyout_ = new Blockly.Flyout(blockSpaceEditor);\n  this.blockSpace_.flyout_.autoClose = false;\n  this.svgDialog_.appendChild(this.blockSpace_.flyout_.createDom());\n  this.svgDialog_.appendChild(this.blockSpace_.createDom());\n  return this.svgDialog_;\n};\n\n/**\n * Callback function triggered when the bubble has resized.\n * Resize the blockSpace accordingly.\n * @private\n */\nBlockly.Mutator.prototype.resizeBubble_ = function() {\n  var doubleBorderWidth = 2 * Blockly.Bubble.BORDER_WIDTH;\n  var blockSpaceSize = this.blockSpace_.getCanvas().getBBox();\n  var flyoutMetrics = this.blockSpace_.flyout_.getMetrics_();\n  var width;\n  if (Blockly.RTL) {\n    width = -blockSpaceSize.x;\n  } else {\n    width = blockSpaceSize.width + blockSpaceSize.x;\n  }\n  var height = Math.max(blockSpaceSize.height + doubleBorderWidth * 3,\n                        flyoutMetrics.contentHeight + 20);\n  width += doubleBorderWidth * 3;\n  // Only resize if the size difference is significant.  Eliminates shuddering.\n  if (Math.abs(this.blockSpaceWidth_ - width) > doubleBorderWidth ||\n      Math.abs(this.blockSpaceHeight_ - height) > doubleBorderWidth) {\n    // Record some layout information for getFlyoutMetrics_.\n    this.blockSpaceWidth_ = width;\n    this.blockSpaceHeight_ = height;\n    // Resize the bubble.\n    this.bubble_.setBubbleSize(width + doubleBorderWidth,\n                               height + doubleBorderWidth);\n    this.svgDialog_.setAttribute('width', this.blockSpaceWidth_);\n    this.svgDialog_.setAttribute('height', this.blockSpaceHeight_);\n  }\n\n  if (Blockly.RTL) {\n    // Scroll the blockSpace to always left-align.\n    var translation = 'translate(' + this.blockSpaceWidth_ + ',0)';\n    this.blockSpace_.getCanvas().setAttribute('transform', translation);\n  }\n\n  var offset = Blockly.convertCoordinates(Blockly.RTL ? this.blockSpaceWidth_ : 0, 0, this.svgDialog_, false);\n  this.blockSpace_.getDragCanvas().setAttribute('transform', 'translate(' + offset.x + ',' + offset.y + ')');\n};\n\n/**\n * Show or hide the mutator bubble.\n * @param {boolean} visible True if the bubble should be visible.\n */\nBlockly.Mutator.prototype.setVisible = function(visible) {\n  if (visible == this.isVisible()) {\n    // No change.\n    return;\n  }\n  if (visible) {\n    this.createEditor_();\n    // Create the bubble.\n    this.bubble_ = new Blockly.Bubble(this.block_.blockSpace,\n        this.svgDialog_, this.block_.svg_.svgGroup_,\n        this.iconX_, this.iconY_, null, null, this.blockSpace_.getDragCanvas());\n    var thisObj = this;\n    this.blockSpace_.flyout_.init(this.blockSpace_, false);\n    this.blockSpace_.flyout_.show(this.quarkXml_);\n\n    this.rootBlock_ = this.block_.decompose(this.blockSpace_);\n    var blocks = this.rootBlock_.getDescendants();\n    for (var i = 0, child; child = blocks[i]; i++) {\n      child.render();\n    }\n    // The root block should not be dragable or deletable.\n    this.rootBlock_.setMovable(false);\n    this.rootBlock_.setDeletable(false);\n    var margin = this.blockSpace_.flyout_.CORNER_RADIUS * 2;\n    var x = this.blockSpace_.flyout_.width_ + margin;\n    if (Blockly.RTL) {\n      x = -x;\n    }\n    this.rootBlock_.moveBy(x, margin);\n    // Save the initial connections, then listen for further changes.\n    if (this.block_.saveConnections) {\n      this.block_.saveConnections(this.rootBlock_);\n      this.sourceListener_ = Blockly.bindEvent_(\n          this.block_.blockSpace.getCanvas(),\n          'blocklyBlockSpaceChange', this.block_,\n          function() {thisObj.block_.saveConnections(thisObj.rootBlock_)});\n    }\n    this.resizeBubble_();\n    // When the mutator's blockSpace changes, update the source block.\n    Blockly.bindEvent_(this.blockSpace_.getCanvas(), 'blocklyBlockSpaceChange',\n        this.block_, function() {thisObj.blockSpaceChanged_();});\n    this.updateColour();\n  } else {\n    // Dispose of the bubble.\n    this.svgDialog_ = null;\n    this.svgBackground_ = null;\n    this.blockSpace_.dispose();\n    this.blockSpace_ = null;\n    this.rootBlock_ = null;\n    this.bubble_.dispose();\n    this.bubble_ = null;\n    this.blockSpaceWidth_ = 0;\n    this.blockSpaceHeight_ = 0;\n    if (this.sourceListener_) {\n      Blockly.unbindEvent_(this.sourceListener_);\n      this.sourceListener_ = null;\n    }\n  }\n};\n\n/**\n * Update the source block when the mutator's blocks are changed.\n * Bump down any block that's too high.\n * Fired whenever a change is made to the mutator's blockSpace.\n * @private\n */\nBlockly.Mutator.prototype.blockSpaceChanged_ = function() {\n  // When dragging a function block to the trash by it's icon, we would end up\n  // calling this with no blockSpace and throwing an exception.\n  if (!this.blockSpace_) {\n    return;\n  }\n  if (!Blockly.Block.isDragging()) {\n    var blocks = this.blockSpace_.getTopBlocks(false);\n    var MARGIN = 20;\n    for (var b = 0, block; block = blocks[b]; b++) {\n      var blockXY = block.getRelativeToSurfaceXY();\n      var blockHW = block.getHeightWidth();\n      if (blockXY.y + blockHW.height < MARGIN) {\n        // Bump any block that's above the top back inside.\n        block.moveBy(0, MARGIN - blockHW.height - blockXY.y);\n      }\n    }\n  }\n\n  // When the mutator's blockSpace changes, update the source block.\n  if (this.rootBlock_.blockSpace == this.blockSpace_) {\n    // Switch off rendering while the source block is rebuilt.\n    var savedRendered = this.block_.rendered;\n    this.block_.rendered = false;\n    // Allow the source block to rebuild itself.\n    this.block_.compose(this.rootBlock_);\n    // Restore rendering and show the changes.\n    this.block_.rendered = savedRendered;\n    if (this.block_.rendered) {\n      this.block_.render();\n    }\n    if (!Blockly.Block.isDragging()) {\n      this.resizeBubble_();\n    }\n    // The source block may have changed, notify its blockSpace.\n    this.block_.blockSpace.fireChangeEvent();\n  }\n};\n\n/**\n * Return an object with all the metrics required to size scrollbars for the\n * mutator flyout.  The following properties are computed:\n * .viewHeight: Height of the visible rectangle,\n * .absoluteTop: Top-edge of view.\n * .absoluteLeft: Left-edge of view.\n * @return {!Object} Contains size and position metrics of mutator dialog's\n *     blockSpace.\n * @private\n */\nBlockly.Mutator.prototype.getFlyoutMetrics_ = function() {\n  var left = 0;\n  if (Blockly.RTL) {\n    left += this.blockSpaceWidth_;\n  }\n  return {\n    viewHeight: this.blockSpaceHeight_,\n    viewWidth: this.blockSpaceWidth_,\n    absoluteTop: 0,\n    absoluteLeft: left\n  };\n};\n\n/**\n * Dispose of this mutator.\n */\nBlockly.Mutator.prototype.dispose = function() {\n  this.block_.mutator = null;\n  Blockly.Icon.prototype.dispose.call(this);\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Object representing a warning.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Warning');\n\ngoog.require('Blockly.Bubble');\ngoog.require('Blockly.Icon');\n\n\n/**\n * Class for a warning.\n * @param {!Blockly.Block} block The block associated with this warning.\n * @extends {Blockly.Icon}\n * @constructor\n */\nBlockly.Warning = function(block) {\n  Blockly.Warning.superClass_.constructor.call(this, block);\n  this.createIcon_();\n};\ngoog.inherits(Blockly.Warning, Blockly.Icon);\n\n/**\n * Warning text (if bubble is not visible).\n * @private\n */\nBlockly.Warning.prototype.text_ = '';\n\n/**\n * Create the icon on the block.\n * @private\n */\nBlockly.Warning.prototype.createIcon_ = function() {\n  Blockly.Icon.prototype.createIcon_.call(this);\n  /* Here's the markup that will be generated:\n  <path class=\"blocklyIconShield\" d=\"...\"/>\n  <text class=\"blocklyIconMark\" x=\"8\" y=\"13\">!</text>\n  */\n  var iconShield = Blockly.createSvgElement('path',\n      {'class': 'blocklyIconShield',\n       'd': 'M 2,15 Q -1,15 0.5,12 L 6.5,1.7 Q 8,-1 9.5,1.7 L 15.5,12 ' +\n       'Q 17,15 14,15 z'},\n      this.iconGroup_);\n  this.iconMark_ = Blockly.createSvgElement('text',\n      {'class': 'blocklyIconMark',\n       'x': Blockly.Icon.RADIUS,\n       'y': 2 * Blockly.Icon.RADIUS - 3}, this.iconGroup_);\n  this.iconMark_.appendChild(document.createTextNode('!'));\n};\n\n/**\n * Create the text for the warning's bubble.\n * @param {string} text The text to display.\n * @return {!SVGTextElement} The top-level node of the text.\n * @private\n */\nBlockly.Warning.prototype.textToDom_ = function(text) {\n  var paragraph = /** @type {!SVGTextElement} */ (\n      Blockly.createSvgElement(\n          'text', {'class': 'blocklyText', 'y': Blockly.Bubble.BORDER_WIDTH},\n          null));\n  var lines = text.split('\\n');\n  for (var i = 0; i < lines.length; i++) {\n    var tspanElement = Blockly.createSvgElement('tspan',\n        {'dy': '1em', 'x': Blockly.Bubble.BORDER_WIDTH}, paragraph);\n    var textNode = document.createTextNode(lines[i]);\n    tspanElement.appendChild(textNode);\n  }\n  return paragraph;\n};\n\n/**\n * Show or hide the warning bubble.\n * @param {boolean} visible True if the bubble should be visible.\n */\nBlockly.Warning.prototype.setVisible = function(visible) {\n  if (visible == this.isVisible()) {\n    // No change.\n    return;\n  }\n  if (visible) {\n    // Create the bubble.\n    var paragraph = this.textToDom_(this.text_);\n    this.bubble_ = new Blockly.Bubble(\n        /** @type {!Blockly.BlockSpace} */ (this.block_.blockSpace),\n        paragraph, this.block_.svg_.svgGroup_,\n        this.iconX_, this.iconY_, null, null);\n    if (Blockly.RTL) {\n      // Right-align the paragraph.\n      // This cannot be done until the bubble is rendered on screen.\n        if (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0) {\n            paragraph.style.display = \"inline\";   /* reqd for IE */\n            var bBox = {\n                x: paragraph.getBBox().x,\n                y: paragraph.getBBox().y,\n                width: paragraph.scrollWidth,\n                height: paragraph.scrollHeight\n            };\n            var maxWidth = bBox.width;\n        }\n        else {\n            var maxWidth = paragraph.getBBox().width;\n        }\n      for (var x = 0, textElement; textElement = paragraph.childNodes[x]; x++) {\n        textElement.setAttribute('text-anchor', 'end');\n        textElement.setAttribute('x', maxWidth + Blockly.Bubble.BORDER_WIDTH);\n      }\n    }\n    this.updateColour();\n    // Bump the warning into the right location.\n    var size = this.bubble_.getBubbleSize();\n    this.bubble_.setBubbleSize(size.width, size.height);\n  } else {\n    // Dispose of the bubble.\n    this.bubble_.dispose();\n    this.bubble_ = null;\n    this.body_ = null;\n    this.foreignObject_ = null;\n  }\n};\n\n/**\n * Bring the warning to the top of the stack when clicked on.\n * @param {!Event} e Mouse up event.\n * @private\n */\nBlockly.Warning.prototype.bodyFocus_ = function(e) {\n  this.bubble_.promote_();\n};\n\n/**\n * Set this warning's text.\n * @param {string} text Warning text.\n */\nBlockly.Warning.prototype.setText = function(text) {\n  this.text_ = text;\n  if (this.isVisible()) {\n    this.setVisible(false);\n    this.setVisible(true);\n  }\n};\n\n/**\n * Dispose of this warning.\n */\nBlockly.Warning.prototype.dispose = function() {\n  this.block_.warning = null;\n  Blockly.Icon.prototype.dispose.call(this);\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* global Blockly, goog */\n\n/**\n * @fileoverview The class representing one block.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Block');\n\ngoog.require('Blockly.BlockSvg');\ngoog.require('Blockly.BlockSvgFramed');\ngoog.require('Blockly.BlockSvgFunctional');\ngoog.require('Blockly.Blocks');\ngoog.require('Blockly.Connection');\ngoog.require('Blockly.ContextMenu');\ngoog.require('Blockly.Input');\ngoog.require('Blockly.Msg');\ngoog.require('Blockly.Mutator');\ngoog.require('Blockly.Warning');\ngoog.require('Blockly.BlockSpace');\ngoog.require('Blockly.Xml');\ngoog.require('goog.asserts');\ngoog.require('goog.string');\n\n\n/**\n * Unique ID counter for created blocks.\n * @private\n */\nBlockly.uidCounter_ = 0;\n\n/**\n * Class for one block.\n * @param {!Blockly.BlockSpace} blockSpace The new block's blockSpace.\n * @param {?string} prototypeName Name of the language object containing\n *     type-specific functions for this block.\n * @constructor\n */\nBlockly.Block = function(blockSpace, prototypeName, htmlId) {\n  this.id = ++Blockly.uidCounter_;\n  this.htmlId = htmlId;\n  this.outputConnection = null;\n  this.nextConnection = null;\n  this.previousConnection = null;\n  this.inputList = [];\n  this.inputsInline = false;\n  this.rendered = false;\n  this.disabled = false;\n  this.tooltip = '';\n\n  this.contextMenu = true;\n\n  this.parentBlock_ = null;\n  this.childBlocks_ = [];\n  this.deletable_ = true;\n  this.movable_ = true;\n  this.editable_ = true;\n  this.userVisible_ = true;\n  this.nextConnectionDisabled_ = false;\n  this.collapsed_ = false;\n  this.dragging_ = false;\n\n  // Used to hide function blocks when not in modal workspace. This property\n  // is not serialized/deserialized.\n  this.currentlyHidden_ = false;\n\n  /**\n   * Whether this block is allowed to disconnect from its parent block.\n   * @private {boolean}\n   */\n  this.canDisconnectFromParent_ = true;\n\n  /**\n   * The label which can be clicked to edit this block. This field is\n   * currently set only for functional_call blocks.\n   * @type {Blockly.FieldIcon}\n   */\n  this.editLabel_ = null;\n\n  /**\n   * @type {!Blockly.BlockSpace}\n   */\n  this.blockSpace = blockSpace;\n  this.isInFlyout = blockSpace.isFlyout;\n\n  this.colourSaturation_ = 0.45;\n  this.colourValue_ = 0.65;\n  this.fillPattern_ = null;\n  this.blockSvgClass_ = Blockly.BlockSvg;\n  this.customOptions_ = {};\n\n  /**\n   * Optional method to run just prior to disposing this block\n   * @type {?Function}\n   */\n  this.beforeDispose = null;\n\n  this.setRenderBlockSpace(blockSpace);\n\n  // Copy the type-specific functions and data from the prototype.\n  if (prototypeName) {\n    this.type = prototypeName;\n    var prototype = Blockly.Blocks[prototypeName];\n    if (!prototype) {\n      Blockly.fireUiEvent(window, 'unknownBlock', {name: prototypeName});\n      prototype = Blockly.Blocks.unknown;\n      this.appendDummyInput().appendTitle('unknown: ' + prototypeName);\n      console.warn('Warning: \"' + prototypeName + '\" is an unknown language block.');\n    }\n    goog.mixin(this, prototype);\n  }\n  // Call an initialization function, if it exists.\n  if (goog.isFunction(this.init)) {\n    this.init();\n  }\n\n  if (this.shouldHideIfInMainBlockSpace && this.shouldHideIfInMainBlockSpace() &&\n      this.blockSpace === Blockly.mainBlockSpace) {\n    this.setCurrentlyHidden(true);\n  }\n\n  this.handleBlockLimitChanges();\n\n  /** @type {goog.events.EventTarget} */\n  this.blockEvents = new goog.events.EventTarget();\n};\n\n/**\n * @enum {string}\n */\nBlockly.Block.EVENTS = {\n  AFTER_DISPOSED: 'afterDisposed',\n  AFTER_DROPPED: 'afterDropped'\n};\n\n/**\n * Pointer to SVG representation of the block.\n * @type {Blockly.BlockSvg}\n * @private\n */\nBlockly.Block.prototype.svg_ = null;\n\n/**\n * Block's mutator icon (if any).\n * @type {?Blockly.Mutator}\n */\nBlockly.Block.prototype.mutator = null;\n\n/**\n * Block's warning icon (if any).\n * @type {?Blockly.Warning}\n */\nBlockly.Block.prototype.warning = null;\n\n/**\n * Callback function called after initialization\n * (typically defined by subclasses)\n * @type {?function()}\n */\nBlockly.Block.prototype.init = null;\n\n/**\n * Callback function called after initialization\n * (typically defined by subclasses)\n * @type {?function()}\n */\nBlockly.Block.prototype.onchange = null;\n\n/**\n * Update limit UI on block count changes.\n */\nBlockly.Block.prototype.handleBlockLimitChanges = function() {\n  if (this.blockSpace && this.blockSpace.blockSpaceEditor) {\n    // Normally we want to show block limits in the flyout, but while editing\n    // blocks (e.g. in the Toolbox Blocks Editor), we'd like to show them in\n    // the main block space.\n    var shouldShowBlockLimits = Blockly.editBlocks ? !this.isInFlyout : this.isInFlyout;\n    if (shouldShowBlockLimits) {\n      this.blockSpace.blockSpaceEditor.blockLimits.events.listen('change',\n          this.onBlockLimitChange.bind(this));\n    }\n  }\n};\n\nBlockly.Block.prototype.onBlockLimitChange = function(eventObject) {\n  if (eventObject.type !== this.type) {\n    return;\n  }\n  if (!this.svg_) {\n    return;\n  }\n\n  // When editing blocks, show full count. Otherwise, show remaining #.\n  var displayCount = Blockly.editBlocks ? eventObject.limit : eventObject.remaining;\n  this.svg_.updateLimit(displayCount);\n};\n\n/**\n * @param {Blockly.BlockSpace} blockSpace target blockspace to begin rendering on\n */\nBlockly.Block.prototype.setRenderBlockSpace = function(blockSpace) {\n  this.blockSpace = blockSpace;\n  this.blockSpace.addTopBlock(this);\n\n  // Bind an onchange function if one exists (typically set by block subclasses)\n  if (goog.isFunction(this.onchange)) {\n    Blockly.bindEvent_(this.blockSpace.getCanvas(), 'blocklyBlockSpaceChange',\n      this, this.onchange);\n  }\n};\n\n/**\n * Returns a list of mutator and warning icons.\n * @return {!Array} List of icons.\n */\nBlockly.Block.prototype.getIcons = function() {\n  var icons = [];\n  if (this.mutator) {\n    icons.push(this.mutator);\n  }\n  if (this.warning) {\n    icons.push(this.warning);\n  }\n  return icons;\n};\n\n/**\n * Create and initialize the SVG representation of the block.\n */\nBlockly.Block.prototype.initSvg = function() {\n  this.svg_ = new this.blockSvgClass_(this, this.customOptions_);\n  this.svg_.init();\n  if (!this.blockSpace.isReadOnly()) {\n    Blockly.bindEvent_(this.svg_.getRootElement(), 'mousedown', this,\n                       this.onMouseDown_);\n    Blockly.bindEvent_(this.svg_.getRootElement(), 'focus', this,\n      this.select.bind(this, false));\n  }\n  this.setCurrentlyHidden(this.currentlyHidden_);\n  this.moveToFrontOfMainCanvas_();\n  this.setIsUnused();\n};\n\n/**\n * Return the root node of the SVG or null if none exists.\n * @return {Element} The root SVG node (probably a group).\n */\nBlockly.Block.prototype.getSvgRoot = function() {\n  return this.svg_ && this.svg_.getRootElement();\n};\n\nBlockly.Block.DRAG_MODE_NOT_DRAGGING = 0;\nBlockly.Block.DRAG_MODE_INSIDE_STICKY_RADIUS = 1;\nBlockly.Block.DRAG_MODE_FREELY_DRAGGING = 2;\n\n/**\n * Is the mouse dragging a block?\n * 0 - No drag operation.\n * 1 - Still inside the sticky DRAG_RADIUS.\n * 2 - Freely draggable.\n * @private\n */\nBlockly.Block.dragMode_ = Blockly.Block.DRAG_MODE_NOT_DRAGGING;\n\nBlockly.Block.isDragging = function() {\n  return Blockly.Block.dragMode_ !== Blockly.Block.DRAG_MODE_NOT_DRAGGING;\n};\n\nBlockly.Block.isFreelyDragging = function() {\n  return Blockly.Block.dragMode_ === Blockly.Block.DRAG_MODE_FREELY_DRAGGING;\n};\n\n/**\n * Pretend that we've already started dragging a block. This ensures that any\n * methods called between now and onMouseDown behave as though a block is being\n * dragged, e.g. skipping neighbour bumping.\n */\nBlockly.Block.startDragging = function() {\n  Blockly.Block.dragMode_ = Blockly.Block.DRAG_MODE_INSIDE_STICKY_RADIUS;\n}\n\n/**\n * Wrapper function called when a mouseUp occurs during a drag operation.\n * @type {BindData}\n * @private\n */\nBlockly.Block.onMouseUpWrapper_ = null;\n\n/**\n * Wrapper function called when a mouseMove occurs during a drag operation.\n * @type {BindData}\n * @private\n */\nBlockly.Block.onMouseMoveWrapper_ = null;\n\n/**\n * Stop binding to the global mouseup and mousemove events.\n * @private\n */\nBlockly.Block.terminateDrag_ = function() {\n  if (Blockly.Block.onMouseUpWrapper_) {\n    Blockly.unbindEvent_(Blockly.Block.onMouseUpWrapper_);\n    Blockly.Block.onMouseUpWrapper_ = null;\n  }\n  if (Blockly.Block.onMouseMoveWrapper_) {\n    Blockly.unbindEvent_(Blockly.Block.onMouseMoveWrapper_);\n    Blockly.Block.onMouseMoveWrapper_ = null;\n  }\n  var selected = Blockly.selected;\n  if (Blockly.Block.isFreelyDragging()) {\n    // Terminate a drag operation.\n    if (selected) {\n      selected.blockSpace.clearPickedUpBlockOrigin();\n      selected.blockSpace.stopAutoScrolling();\n      // Update the connection locations.\n      var xy = selected.getRelativeToSurfaceXY();\n      var dx = xy.x - selected.startDragX;\n      var dy = xy.y - selected.startDragY;\n      selected.moveConnections_(dx, dy);\n      delete selected.draggedBubbles_;\n      selected.setDragging_(false);\n      selected.moveToFrontOfMainCanvas_();\n      selected.render();\n      window.setTimeout(selected.bumpNeighbours.bind(selected), Blockly.BUMP_DELAY);\n      selected.blockSpace.blockSpaceEditor.bumpBlocksIntoBlockSpace();\n      selected.blockSpace.scrollIntoView(selected);\n\n      // Fire an event to allow scrollbars to resize.\n      Blockly.fireUiEvent(window, 'resize');\n    }\n  }\n  // When we have a selected block, we should use its editor to run\n  // the cursor change so that the editor's SVG gets a cursor change\n  // as well.\n  if (selected) {\n    selected.blockSpace.fireChangeEvent();\n    selected.blockSpace.blockSpaceEditor.setCursor(Blockly.Css.Cursor.OPEN);\n  }\n\n  Blockly.Block.dragMode_ = Blockly.Block.DRAG_MODE_NOT_DRAGGING;\n\n  if (selected) {\n    selected.blockEvents.dispatchEvent(Blockly.Block.EVENTS.AFTER_DROPPED);\n  }\n};\n\n/**\n * Select this block.  Highlight it visually.\n */\nBlockly.Block.prototype.select = function(spotlight) {\n  if (!this.svg_) {\n    throw 'Block is not rendered.';\n  }\n  if (Blockly.selected) {\n    // Unselect any previously selected block.\n    Blockly.selected.unselect();\n  }\n  Blockly.selected = this;\n  this.svg_.addSelect(!this.parentBlock_);\n  if (spotlight) {\n    this.svg_.addSpotlight();\n  }\n  Blockly.fireUiEvent(this.blockSpace.getCanvas(), 'blocklySelectChange');\n};\n\n/**\n * Unselect this block.  Remove its highlighting.\n */\nBlockly.Block.prototype.unselect = function() {\n  if (Blockly.selected !== this) {\n    return;\n  }\n\n  if (!this.svg_) {\n    throw 'Block is not rendered.';\n  }\n  Blockly.BlockSpaceEditor.terminateDrag_();\n  Blockly.selected = null;\n  this.svg_.removeSelect();\n  this.svg_.removeSpotlight();\n  Blockly.fireUiEvent(this.blockSpace.getCanvas(), 'blocklySelectChange');\n};\n\n/**\n * Whether this block can be copied, cut, and pasted.\n * Can be overridden by individual block types.\n * @returns {boolean}\n */\nBlockly.Block.prototype.isCopyable = function() {\n  return true;\n};\n\n/**\n * Dispose of this block.\n * @param {boolean} healStack If true, then try to heal any gap by connecting\n *     the next statement with the previous statement.  Otherwise, dispose of\n *     all children of this block.\n * @param {boolean} animate If true, show a disposal animation and sound.\n */\nBlockly.Block.prototype.dispose = function(healStack, animate) {\n  if (goog.isFunction(this.beforeDispose)) {\n    this.beforeDispose();\n  }\n\n  // Switch off rerendering.\n  this.rendered = false;\n  this.unplug(healStack);\n\n  if (animate && this.svg_) {\n    this.svg_.disposeUiEffect();\n  }\n\n  var updateBlockSpaceCallback = goog.bind(\n      this.blockSpace.updateScrollableSize, this.blockSpace);\n\n  // This block is now at the top of the blockSpace.\n  // Remove this block from the blockSpace's list of top-most blocks.\n  this.blockSpace.removeTopBlock(this);\n  this.blockSpace = null;\n\n  // Just deleting this block from the DOM would result in a memory leak as\n  // well as corruption of the connection database.  Therefore we must\n  // methodically step through the blocks and carefully disassemble them.\n\n  if (Blockly.selected == this) {\n    Blockly.selected = null;\n    // If there's a drag in-progress, unlink the mouse events.\n    Blockly.BlockSpaceEditor.terminateDrag_();\n  }\n\n  // If this block has a context menu open, close it.\n  if (Blockly.ContextMenu.currentBlock == this) {\n    Blockly.ContextMenu.hide();\n  }\n\n  // First, dispose of all my children.\n  for (var x = this.childBlocks_.length - 1; x >= 0; x--) {\n    this.childBlocks_[x].dispose(false);\n  }\n  // Then dispose of myself.\n  var icons = this.getIcons();\n  for (var x = 0; x < icons.length; x++) {\n    icons[x].dispose();\n  }\n  // Dispose of all inputs and their titles.\n  for (var x = 0, input; input = this.inputList[x]; x++) {\n    input.dispose();\n  }\n  this.inputList = [];\n  // Dispose of any remaining connections (next/previous/output).\n  var connections = this.getConnections_(true);\n  for (var x = 0; x < connections.length; x++) {\n    var connection = connections[x];\n    if (connection.targetConnection) {\n      connection.disconnect();\n    }\n    connections[x].dispose();\n  }\n  // Dispose of the SVG and break circular references.\n  if (this.svg_) {\n    this.svg_.dispose();\n    this.svg_ = null;\n  }\n\n  this.blockEvents.dispatchEvent(Blockly.Block.EVENTS.AFTER_DISPOSED);\n  updateBlockSpaceCallback();\n};\n\n/**\n * Unplug this block from its superior block.  If this block is a statement,\n * optionally reconnect the block underneath with the block on top.\n * @param {boolean} healStack Disconnect child statement and reconnect stack.\n * @param {boolean} bump Move the unplugged block sideways a short distance.\n */\nBlockly.Block.prototype.unplug = function(healStack, bump) {\n  bump = bump && !!this.getParent();\n  if (this.outputConnection) {\n    if (this.outputConnection.targetConnection) {\n      // Disconnect from any superior block.\n      this.setParent(null);\n    }\n  } else {\n    var previousTarget = null;\n    if (this.previousConnection && this.previousConnection.targetConnection) {\n      // Remember the connection that any next statements need to connect to.\n      previousTarget = this.previousConnection.targetConnection;\n      // Detach this block from the parent's tree.\n      this.setParent(null);\n    }\n    if (healStack && this.nextConnection &&\n        this.nextConnection.targetConnection) {\n      // Disconnect the next statement.\n      var nextTarget = this.nextConnection.targetConnection;\n      var nextBlock = this.nextConnection.targetBlock();\n      nextBlock.setParent(null);\n      if (previousTarget) {\n        // Attach the next statement to the previous statement.\n        previousTarget.connect(nextTarget);\n      }\n    }\n  }\n  if (bump) {\n    // Bump the block sideways.\n    var dx = Blockly.SNAP_RADIUS * (Blockly.RTL ? -1 : 1);\n    var dy = Blockly.SNAP_RADIUS * 2;\n    this.moveBy(dx, dy);\n  }\n};\n\n/**\n * Return the coordinates of the top-left corner of this block relative to the\n * drawing surface's origin (0,0).\n * @return {!Object} Object with .x and .y properties.\n */\nBlockly.Block.prototype.getRelativeToSurfaceXY = function() {\n  var x = 0;\n  var y = 0;\n  var elementIsRootCanvas = false;\n  if (this.svg_) {\n    var element = this.svg_.getRootElement();\n    do {\n      // Loop through this block and every parent.\n      var xy = Blockly.getRelativeXY(element);\n      x += xy.x;\n      y += xy.y;\n      element = element.parentNode;\n      elementIsRootCanvas = (element == this.blockSpace.getCanvas() ||\n          element == this.blockSpace.getDragCanvas());\n    } while (element && !elementIsRootCanvas);\n  }\n  return {x: x, y: y};\n};\n\n/**\n * Move a block to a specific location on the drawing surface.\n * @param {number} x Horizontal location.\n * @param {number} y Vertical location.\n */\nBlockly.Block.prototype.moveTo = function(x, y) {\n  var oldXY = this.getRelativeToSurfaceXY();\n  this.svg_.getRootElement().setAttribute('transform',\n      'translate(' + x + ', ' + y + ')');\n  this.moveConnections_(x - oldXY.x, y - oldXY.y);\n};\n\n/**\n * Move a block by a relative offset.\n * @param {number} dx Horizontal offset.\n * @param {number} dy Vertical offset.\n */\nBlockly.Block.prototype.moveBy = function(dx, dy) {\n  var xy = this.getRelativeToSurfaceXY();\n  this.svg_.getRootElement().setAttribute('transform',\n      'translate(' + (xy.x + dx) + ', ' + (xy.y + dy) + ')');\n  this.moveConnections_(dx, dy);\n};\n\n/**\n * Gets box dimensions of block\n * @returns {goog.math.Box}\n */\nBlockly.Block.prototype.getBox = function() {\n  var heightWidth = this.getHeightWidth();\n  var xy = this.getRelativeToSurfaceXY();\n\n  // Account for left notch\n  if (this.outputConnection) {\n    xy.x -= Blockly.BlockSvg.TAB_WIDTH;\n  }\n\n  return new goog.math.Box(\n    xy.y,\n    xy.x + heightWidth.width,\n    xy.y + heightWidth.height,\n    xy.x);\n};\n\n/**\n * Returns the padding of the SVG or null if none exists\n * @return {Object} object with padding values for top, bottom, left, and right\n */\nBlockly.Block.prototype.getSvgPadding = function() {\n  return this.svg_ && this.svg_.getPadding();\n};\n\n/**\n * Returns a bounding box describing the dimensions of this block.\n * @return {!Object} Object with height and width properties.\n */\nBlockly.Block.prototype.getHeightWidth = function() {\n  var bBox;\n\n  try {\n    var ie10OrOlder = Blockly.ieVersion() && Blockly.ieVersion() <= 10;\n    var initialStyle;\n\n    if (ie10OrOlder) {\n      // Required to set display to inline during calculation in IE <= 10\n      initialStyle = this.getSvgRoot().style.display;\n      this.getSvgRoot().style.display = \"inline\";\n    }\n\n    bBox = goog.object.clone(this.getSvgRoot().getBBox());\n\n    if (ie10OrOlder) {\n      // Reset to original display value\n      this.getSvgRoot().style.display = initialStyle;\n    }\n  } catch (e) {\n    // Firefox has trouble with hidden elements (Bug 528969).\n    return {height: 0, width: 0};\n  }\n\n  var expectedBBoxY = 0;\n\n  if (Blockly.BROKEN_CONTROL_POINTS) {\n    /* HACK:\n     WebKit bug 67298 causes control points to be included in the reported\n     bounding box.  The render functions (below) add two 5px spacer control\n     points that we need to subtract.\n    */\n    bBox.height -= 10;\n    if (this.nextConnection) {\n      // Bottom control point partially masked by lower tab.\n      bBox.height += 4;\n    }\n    /**\n     * We would expect bBox.y to be 0, but with broken control points,\n     * we'll expect it to be -5 (since we added an extra control point for\n     * measurement).\n     */\n    expectedBBoxY = -5;\n  }\n\n  if (bBox.height > 0) {\n    // Subtract one from the height due to the shadow.\n    bBox.height -= 1;\n  }\n\n  /**\n   * When <text> or other child content's boundaries extend beyond tops of\n   * blocks (e.g. due to IE MSDN issue #791152), bBox.y ends up being < 0.\n   * Here we add bBox.y (which is otherwise typically 0) to the height to\n   * discount the above-block content distance.\n   */\n  var bboxYDifference = (bBox.y - expectedBBoxY);\n  var heightWithoutContentAboveTop = bBox.height + bboxYDifference;\n  bBox.height = Math.max(0, heightWithoutContentAboveTop);\n\n  return bBox;\n};\n\n/**\n * Handle a mouse-down on an SVG block.\n * @param {!Event} e Mouse down event.\n * @private\n */\nBlockly.Block.prototype.onMouseDown_ = function(e) {\n  // Stop the browser from scrolling/zooming the page\n  e.preventDefault();\n\n  // If we're clicking on an input target, don't do anything with the event\n  // at the block level\n  var targetClass = e.target.getAttribute && e.target.getAttribute('class');\n  if (targetClass === 'inputClickTarget') {\n    e.stopPropagation();\n    return;\n  }\n\n  // ...but this prevents blurring of inputs, so do it manually\n  document.activeElement && document.activeElement.blur\n    && document.activeElement.blur();\n\n  if (this.isInFlyout) {\n    return;\n  }\n  // Update Blockly's knowledge of its own location.\n  this.blockSpace.blockSpaceEditor.svgResize();\n  Blockly.BlockSpaceEditor.terminateDrag_();\n\n  this.select();\n\n  this.blockSpace.blockSpaceEditor.hideChaff();\n\n  if (Blockly.isRightButton(e)) {\n    // Right-click.\n    // Only show context menus for level editors\n    if (Blockly.editBlocks) {\n      this.showContextMenu_(e);\n    }\n  } else if (this.blockSpace.isMovementLocked() ||\n      !this.isMovable() ||\n      !this.canDisconnectFromParent()) {\n    // Allow unmovable blocks to be selected and context menued, but not\n    // dragged.  Let this event bubble up to document, so the blockSpace may be\n    // dragged instead.\n    return;\n  } else {\n    // Left-click (or middle click)\n    Blockly.removeAllRanges();\n    this.setIsUnused(false);\n    this.blockSpace.blockSpaceEditor.setCursor(Blockly.Css.Cursor.CLOSED);\n    // Look up the current translation and record it.\n    var xy = this.getRelativeToSurfaceXY();\n    this.startDragX = xy.x;\n    this.startDragY = xy.y;\n\n    // If we were given the start drag location, use that.\n    if (e.startDragMouseX_ !== undefined && e.startDragMouseY_ !== undefined) {\n      this.startDragMouseX = e.startDragMouseX_;\n      this.startDragMouseY = e.startDragMouseY_;\n      e.startDragMouseX_ = undefined;\n      e.startDragMouseY_ = undefined;\n    } else {\n      // Record the current mouse position.\n      this.startDragMouseX = e.clientX;\n      this.startDragMouseY = e.clientY;\n    }\n\n    Blockly.Block.dragMode_ = Blockly.Block.DRAG_MODE_INSIDE_STICKY_RADIUS;\n    Blockly.Block.onMouseUpWrapper_ = Blockly.bindEvent_(document,\n        'mouseup', this, this.onMouseUp_);\n    Blockly.Block.onMouseMoveWrapper_ = Blockly.bindEvent_(document,\n        'mousemove', this, this.onMouseMove_);\n    // Build a list of bubbles that need to be moved and where they started.\n    this.draggedBubbles_ = [];\n    var descendants = this.getDescendants();\n    for (var x = 0, descendant; descendant = descendants[x]; x++) {\n      var icons = descendant.getIcons();\n      for (var y = 0; y < icons.length; y++) {\n        var data = icons[y].getIconLocation();\n        data.bubble = icons[y];\n        this.draggedBubbles_.push(data);\n      }\n    }\n  }\n  // This event has been handled.  No need to bubble up to the document.\n  e.stopPropagation();\n};\n\n/**\n * Handle a mouse-up anywhere in the SVG pane.  Is only registered when a\n * block is clicked.  We can't use mouseUp on the block since a fast-moving\n * cursor can briefly escape the block before it catches up.\n * @param {!Event} e Mouse up event.\n * @private\n */\nBlockly.Block.prototype.onMouseUp_ = function(e) {\n  var thisBlockSpace = this.blockSpace;\n  Blockly.BlockSpaceEditor.terminateDrag_();\n  if (Blockly.selected && Blockly.highlightedConnection_) {\n    // Connect two blocks together.\n    Blockly.localConnection_.connect(Blockly.highlightedConnection_);\n    if (this.svg_) {\n      // Trigger a connection animation.\n      // Determine which connection is inferior (lower in the source stack).\n      var inferiorConnection;\n      if (Blockly.localConnection_.isSuperior()) {\n        inferiorConnection = Blockly.highlightedConnection_;\n      } else {\n        inferiorConnection = Blockly.localConnection_;\n      }\n      inferiorConnection.sourceBlock_.svg_.connectionUiEffect();\n    }\n    if (thisBlockSpace.trashcan) {\n      // Don't throw an object in the trash can if it just got connected.\n      thisBlockSpace.trashcan.close();\n    }\n  } else if (Blockly.selected &&\n      Blockly.selected.areBlockAndDescendantsDeletable() &&\n      thisBlockSpace.isDeleteArea(e.clientX, e.clientY, this.startDragMouseX)) {\n    // The ordering of the statement above is important because isDeleteArea()\n    // has a side effect of opening the trash can.\n    var trashcan = thisBlockSpace.trashcan;\n    if (trashcan) {\n      window.setTimeout(trashcan.close.bind(trashcan), 100);\n    }\n    Blockly.selected.dispose(false, true);\n    if (Blockly.topLevelProcedureAutopopulate && this.isFunctionDefinition()) {\n      window.setTimeout(function() {\n        thisBlockSpace.blockSpaceEditor.updateFlyout();\n      }, 0);\n    }\n    // Dropping a block on the trash can will usually cause the blockSpace to\n    // resize to contain the newly positioned block.  Force a second resize now\n    // that the block has been deleted.\n    Blockly.fireUiEvent(window, 'resize');\n  }\n\n  if (Blockly.selected) {\n    Blockly.selected.setIsUnused();\n  }\n\n  if (Blockly.highlightedConnection_) {\n    Blockly.highlightedConnection_.unhighlight();\n    Blockly.highlightedConnection_ = null;\n  }\n  thisBlockSpace.hideDelete();\n  thisBlockSpace.blockSpaceEditor.setCursor(Blockly.Css.Cursor.OPEN);\n};\n\n/**\n * Load the block's help page in a new window.\n * @private\n */\nBlockly.Block.prototype.showHelp_ = function() {\n  var url = goog.isFunction(this.helpUrl) ? this.helpUrl() : this.helpUrl;\n  if (url) {\n    window.open(url);\n  }\n};\n\n/**\n * Duplicate this block and its children.\n * @return {!Blockly.Block} The duplicate.\n * @private\n */\nBlockly.Block.prototype.duplicate_ = function() {\n  // Create a duplicate via XML.\n  var xmlBlock = Blockly.Xml.blockToDom(this);\n  Blockly.Xml.deleteNext(xmlBlock);\n  var newBlock = Blockly.Xml.domToBlock(\n      /** @type {!Blockly.BlockSpace} */ (this.blockSpace), xmlBlock);\n  // Move the duplicate next to the old block.\n  var xy = this.getRelativeToSurfaceXY();\n  if (Blockly.RTL) {\n    xy.x -= Blockly.SNAP_RADIUS;\n  } else {\n    xy.x += Blockly.SNAP_RADIUS;\n  }\n  xy.y += Blockly.SNAP_RADIUS * 2;\n  newBlock.moveBy(xy.x, xy.y);\n  return newBlock;\n};\n\n/**\n * Show the context menu for this block.\n * @param {!Event} e Mouse event\n * @private\n */\nBlockly.Block.prototype.showContextMenu_ = function(e) {\n  if (this.blockSpace.isReadOnly() || !this.contextMenu) {\n    return;\n  }\n  // Save the current block in a variable for use in closures.\n  var block = this;\n  var options = [];\n\n  if (this.isDeletable() && !block.isInFlyout) {\n    // Option to duplicate this block.\n    var duplicateOption = {\n      text: Blockly.Msg.DUPLICATE_BLOCK,\n      enabled: true,\n      callback: function() {\n        block.duplicate_();\n      }\n    };\n    if (this.getDescendants().length > this.blockSpace.remainingCapacity()) {\n      duplicateOption.enabled = false;\n    }\n    options.push(duplicateOption);\n\n    // Option to disable/enable block.\n    var disableOption = {\n      text: this.disabled ?\n          Blockly.Msg.ENABLE_BLOCK : Blockly.Msg.DISABLE_BLOCK,\n      enabled: !this.getInheritedDisabled(),\n      callback: function() {\n        block.setDisabled(!block.disabled);\n      }\n    };\n    options.push(disableOption);\n\n    // Option to delete this block.\n    // Count the number of blocks that are nested in this block.\n    var descendantCount = this.getDescendants().length;\n    if (block.nextConnection && block.nextConnection.targetConnection) {\n      // Blocks in the current stack would survive this block's deletion.\n      descendantCount -= this.nextConnection.targetBlock().\n          getDescendants().length;\n    }\n    var deleteOption = {\n      text: descendantCount == 1 ? Blockly.Msg.DELETE_BLOCK :\n          Blockly.Msg.DELETE_X_BLOCKS.replace('%1', descendantCount),\n      enabled: true,\n      callback: function() {\n        block.dispose(true, true);\n      }\n    };\n    options.push(deleteOption);\n  }\n\n  // Block-editor-only options\n  // Do not need to be localized\n  if (Blockly.editBlocks) {\n    // uservisible\n    var userVisibleOption = {\n      text: this.userVisible_ ?\n          \"Make Invisible to Users\" : \"Make Visible to Users\",\n      enabled: true,\n      callback: function() {\n        block.setUserVisible(!block.isUserVisible());\n        Blockly.ContextMenu.hide();\n      }\n    };\n    options.push(userVisibleOption);\n\n    // deletable\n    var deletableOption = {\n      text: this.deletable_ ?\n          \"Make Undeletable to Users\" : \"Make Deletable to Users\",\n      enabled: true,\n      callback: function() {\n        block.setDeletable(!block.isDeletable());\n        Blockly.ContextMenu.hide();\n      }\n    };\n    options.push(deletableOption);\n\n    // movable\n    var movableOption = {\n      text: this.movable_ ?\n          \"Make Immovable to Users\" : \"Make Movable to Users\",\n      enabled: true,\n      callback: function() {\n        block.setMovable(!block.isMovable());\n        Blockly.ContextMenu.hide();\n      }\n    };\n    options.push(movableOption);\n\n    // next connection disabled\n    var nextConnectionDisabledOption = {\n      text: this.nextConnectionDisabled_ ?\n          \"Enable Next Connection\" : \"Disable Next Connection\",\n      enabled: true,\n      callback: function () {\n        block.setNextConnectionDisabled(!block.nextConnectionDisabled_);\n        Blockly.ContextMenu.hide();\n      }\n    };\n    options.push(nextConnectionDisabledOption);\n\n    // editable\n    var editableOption = {\n      text: this.editable_ ?\n          \"Make Uneditable\" : \"Make editable\",\n      enabled: true,\n      callback: function () {\n        block.setEditable(!block.isEditable());\n        Blockly.ContextMenu.hide();\n      }\n    };\n    options.push(editableOption);\n\n    // can disconnect from parent\n    var canDisconnectFromParentOption = {\n      text: this.canDisconnectFromParent_ ?\n          \"Lock to Parent Block\" : \"Unlock from Parent Block\",\n      enabled: true,\n      callback: function () {\n        block.setCanDisconnectFromParent(!block.canDisconnectFromParent_);\n        Blockly.ContextMenu.hide();\n      }\n    };\n    options.push(canDisconnectFromParentOption);\n\n\n    // limit\n    var getCurrentLimit = function() {\n      return block.blockSpace.blockSpaceEditor.blockLimits.getLimit(block.type);\n    };\n    var limitOption = {\n      text: \"Set limit (current: \" + (getCurrentLimit() || 'none') + \")\",\n      enabled: true,\n      callback: function () {\n        block.blockSpace.blockSpaceEditor.blockLimits.setLimit(\n            block.type, prompt(\"New Limit\", getCurrentLimit()));\n      }\n    };\n    options.push(limitOption);\n\n    if (this.getCustomContextMenuItems) {\n      options = options.concat(this.getCustomContextMenuItems());\n    }\n  }\n\n  // Allow the block to add or modify options.\n  if (this.customContextMenu && !block.isInFlyout) {\n    this.customContextMenu(options);\n  }\n\n  Blockly.ContextMenu.show(e, options);\n  Blockly.ContextMenu.currentBlock = this;\n};\n\n/**\n * Returns all connections originating from this block.\n * @param {boolean} all If true, return all connections even hidden ones.\n *     Otherwise return those that are visible.\n * @return {!Array.<!Blockly.Connection>} Array of connections.\n * @private\n */\nBlockly.Block.prototype.getConnections_ = function(all) {\n  var myConnections = [];\n  if (all || this.rendered) {\n    if (this.outputConnection) {\n      myConnections.push(this.outputConnection);\n    }\n    if (this.nextConnection) {\n      myConnections.push(this.nextConnection);\n    }\n    if (this.previousConnection) {\n      myConnections.push(this.previousConnection);\n    }\n    if (all || !this.collapsed_) {\n      for (var x = 0, input; input = this.inputList[x]; x++) {\n        if (input.connection) {\n          myConnections.push(input.connection);\n        }\n      }\n    }\n  }\n  return myConnections;\n};\n\n/**\n * Return all leaf connections originating from this block (i.e. open connections\n * on this block or any descendants)\n * @param {Blockly.Block} source The source block we've connected from.  We will\n *    avoid traversing back to that block.\n * @return {!Array.<!Blockly.Connection>} Array of connections.\n * @private\n */\nBlockly.Block.prototype.getLeafConnections_ = function(source) {\n  var self = this;\n  var leaves = [];\n  var allConnections = [this.outputConnection, this.nextConnection,\n    this.previousConnection];\n  this.inputList.forEach(function (input) {\n    allConnections.push(input.connection);\n  });\n  allConnections.forEach(function (connection) {\n    if (!connection) {\n      return;\n    }\n    var targetBlock = connection.targetBlock();\n    if (!targetBlock) {\n      // this is a leaf\n      leaves.push(connection);\n    } else if (targetBlock !== source) {\n      // traverse target for leaves\n      leaves = leaves.concat(targetBlock.getLeafConnections_(self));\n    }\n  });\n\n  return leaves;\n};\n\n/**\n * Move the connections for this block and all blocks attached under it.\n * Also update any attached bubbles.\n * @param {number} dx Horizontal offset from current location.\n * @param {number} dy Vertical offset from current location.\n * @private\n */\nBlockly.Block.prototype.moveConnections_ = function(dx, dy) {\n  if (!this.rendered) {\n    // Rendering is required to lay out the blocks.\n    // This is probably an invisible block attached to a collapsed block.\n    return;\n  }\n  var myConnections = this.getConnections_(false);\n  for (var x = 0; x < myConnections.length; x++) {\n    myConnections[x].moveBy(dx, dy);\n  }\n  var icons = this.getIcons();\n  for (var x = 0; x < icons.length; x++) {\n    icons[x].computeIconLocation();\n  }\n\n  // Recurse through all blocks attached under this one.\n  for (var x = 0; x < this.childBlocks_.length; x++) {\n    this.childBlocks_[x].moveConnections_(dx, dy);\n  }\n};\n\n/**\n * Recursively adds or removes the dragging class to this node and its children.\n * @param {boolean} adding True if adding, false if removing.\n * @private\n */\nBlockly.Block.prototype.setDragging_ = function(adding) {\n  this.setDraggingHandleImmovable_(adding, null);\n};\n\n/**\n * Determine whether block is being dragged\n * @returns {boolean} True if block is being dragged\n * @private\n */\nBlockly.Block.prototype.getDragging = function() {\n  return this.dragging_;\n};\n\n/**\n * Recursively adds or removes the dragging class to this node and its children.\n * @param {boolean} adding True if adding, false if removing.\n * @param {function} immovableBlockHandler callback when immovable block is found\n * @private\n */\nBlockly.Block.prototype.setDraggingHandleImmovable_ = function(adding, immovableBlockHandler) {\n  if (adding) {\n    this.dragging_ = true;\n    this.svg_.addDragging();\n  } else {\n    this.dragging_ = false;\n    this.svg_.removeDragging();\n  }\n\n  // Recurse through all blocks attached under this one.\n  for (var x = 0; x < this.childBlocks_.length; x++) {\n    var block = this.childBlocks_[x];\n    if (adding && immovableBlockHandler !== null && !block.isMovable()) {\n      immovableBlockHandler(block);\n      break;\n    }\n\n    block.setDraggingHandleImmovable_(adding, immovableBlockHandler);\n  }\n};\n\n/**\n * @param {boolean} canDisconnect\n */\nBlockly.Block.prototype.setCanDisconnectFromParent = function (canDisconnect) {\n  this.canDisconnectFromParent_ = canDisconnect;\n};\n\n/**\n * @returns {boolean}\n */\nBlockly.Block.prototype.canDisconnectFromParent = function () {\n  return this.canDisconnectFromParent_;\n};\n\n/**\n * Move the block's svg into the drag-layer SVGGElement\n * @private\n */\nBlockly.Block.prototype.moveToDragCanvas_ = function () {\n  if (!this.svg_) {\n    return;\n  }\n  this.blockSpace.moveElementToDragCanvas(this.svg_.getRootElement());\n};\n\n/**\n * Move the block's svg into the regular canvas SVGGElement\n * @private\n */\nBlockly.Block.prototype.moveToFrontOfMainCanvas_ = function () {\n  if (!this.svg_) {\n    return;\n  }\n  this.blockSpace.moveElementToMainCanvas(this.svg_.getRootElement());\n};\n\nBlockly.Block.prototype.moveBlockBeingDragged_ = function (mouseX, mouseY, singleBlock) {\n  Blockly.removeAllRanges();\n  var dx = mouseX - this.startDragMouseX;\n  var dy = mouseY - this.startDragMouseY;\n\n  if (Blockly.Block.dragMode_ == Blockly.Block.DRAG_MODE_INSIDE_STICKY_RADIUS) {\n    // Still dragging within the sticky DRAG_RADIUS.\n    var dr = Math.sqrt(Math.pow(dx, 2) + Math.pow(dy, 2));\n    if (dr > Blockly.DRAG_RADIUS) {\n      // Switch to unrestricted dragging.\n      Blockly.Block.dragMode_ = Blockly.Block.DRAG_MODE_FREELY_DRAGGING;\n      // Push this block to the very top of the stack.\n      var firstImmovableBlockHandler = this.generateReconnector_(this.previousConnection);\n      if (singleBlock) {\n        this.unplug(true, false);\n      }\n      this.setParent(null);\n      this.setDraggingHandleImmovable_(true, firstImmovableBlockHandler);\n      this.moveToDragCanvas_();\n      this.blockSpace.recordPickedUpBlockOrigin();\n      this.blockSpace.recordDeleteAreas();\n    }\n  }\n  if (Blockly.Block.dragMode_ == Blockly.Block.DRAG_MODE_FREELY_DRAGGING) {\n    // Unrestricted dragging.\n    var x = this.startDragX + dx;\n    var y = this.startDragY + dy;\n    this.svg_.getRootElement().setAttribute('transform',\n        'translate(' + x + ', ' + y + ')');\n    // Drag all the nested bubbles.\n    for (var i = 0; i < this.draggedBubbles_.length; i++) {\n      var data = this.draggedBubbles_[i];\n      data.bubble.setIconLocation(data.x + dx, data.y + dy);\n    }\n\n    // Check to see if any of this block's connections are within range of\n    // another block's connection.\n    var myConnections = this.getLeafConnections_(null);\n    var closestConnection = null;\n    var localConnection = null;\n    var radiusConnection = Blockly.SNAP_RADIUS;\n    for (var i = 0; i < myConnections.length; i++) {\n      var myConnection = myConnections[i];\n      var neighbour = myConnection.closest(radiusConnection, dx, dy);\n      if (neighbour.connection) {\n        closestConnection = neighbour.connection;\n        localConnection = myConnection;\n        radiusConnection = neighbour.radius;\n      }\n    }\n\n    // Remove connection highlighting if needed.\n    var oldConnection = null;\n    if (Blockly.highlightedConnection_ &&\n      Blockly.highlightedConnection_ != closestConnection) {\n      Blockly.highlightedConnection_.unhighlight();\n      oldConnection = Blockly.highlightedConnection_;\n      oldConnection.sourceBlock_.pendingConnection(\n          oldConnection, closestConnection);\n      Blockly.highlightedConnection_ = null;\n      Blockly.localConnection_ = null;\n    }\n    // Add connection highlighting if needed.\n    if (closestConnection &&\n      closestConnection != Blockly.highlightedConnection_) {\n      closestConnection.highlight();\n      Blockly.highlightedConnection_ = closestConnection;\n      closestConnection.sourceBlock_.pendingConnection(\n          oldConnection, closestConnection);\n      Blockly.localConnection_ = localConnection;\n    }\n\n    // Provide visual indication of whether the block will be\n    // deleted if dropped here.\n    var undeletable = !this.areBlockAndDescendantsDeletable();\n    this.blockSpace.isDeleteArea(mouseX, mouseY, this.startDragMouseX, undeletable);\n  }\n};\n\n/**\n * This is called when a block is dragged to or away from one of this block's\n * inputs. Override in subclasses if needed.\n */\nBlockly.Block.prototype.pendingConnection =\n    function(oldConnection, newConnection) {};\n\n/**\n * Drag this block to follow the mouse.\n * @param {!Event} e Mouse move event.\n * @private\n */\nBlockly.Block.prototype.onMouseMove_ = function(e) {\n  if (e.type == 'mousemove' && e.clientX <= 1 && e.clientY == 0 &&\n      e.button == 0) {\n    /* HACK:\n     Safari Mobile 6.0 and Chrome for Android 18.0 fire rogue mousemove events\n     on certain touch actions. Ignore events with these signatures.\n     This may result in a one-pixel blind spot in other browsers,\n     but this shouldn't be noticable. */\n    e.stopPropagation();\n    return;\n  }\n  this.moveBlockBeingDragged_(e.clientX, e.clientY, e.ctrlKey || e.metaKey);\n  this.blockSpace.panIfOverEdge(this, e.clientX, e.clientY);\n  // This event has been handled.  No need to bubble up to the document.\n  e.stopPropagation();\n};\n\n/**\n * Generates a callback that takes in a block and connects its `previousConnection` to the given `earlierConnection`\n * and disconnects any previous connection\n * @param earlierConnection {Connection}\n * @returns {Function}\n * @private\n */\nBlockly.Block.prototype.generateReconnector_ = function(earlierConnection) {\n  var earlierNextConnection;\n\n  if (earlierConnection && earlierConnection.targetConnection) {\n    earlierNextConnection = earlierConnection.targetConnection;\n  }\n\n  return function(block){\n    if (block.previousConnection) {\n      block.setParent(null);\n      earlierNextConnection && earlierNextConnection.connect(block.previousConnection);\n    }\n  };\n};\n\n/**\n * Bump unconnected blocks out of alignment.  Two blocks which aren't actually\n * connected should not coincidentally line up on screen.\n * @private\n */\nBlockly.Block.prototype.bumpNeighbours = function() {\n  if (Blockly.Block.isDragging() || !Blockly.BUMP_UNCONNECTED) {\n    // Don't bump blocks during a drag.\n    return;\n  }\n  var rootBlock = this.getRootBlock();\n  if (rootBlock.isInFlyout) {\n    // Don't move blocks around in a flyout.\n    return;\n  }\n  // Loop though every connection on this block.\n  var myConnections = this.getConnections_(false);\n  for (var x = 0; x < myConnections.length; x++) {\n    var connection = myConnections[x];\n    // Spider down from this block bumping all sub-blocks.\n    if (connection.targetConnection && connection.isSuperior()) {\n      connection.targetBlock().bumpNeighbours();\n    }\n\n    var neighbours = connection.neighbours_(Blockly.SNAP_RADIUS);\n    for (var y = 0; y < neighbours.length; y++) {\n      var otherConnection = neighbours[y];\n      // If both connections are connected, that's probably fine.  But if\n      // either one of them is unconnected, then there could be confusion.\n      if (connection.targetConnection && otherConnection.targetConnection) {\n        continue;\n      }\n      // Only bump blocks if they are from different tree structures.\n      var otherRootBlock = otherConnection.sourceBlock_.getRootBlock();\n      if (otherRootBlock === rootBlock) {\n        continue;\n      }\n\n      var bumpOther = false;\n      // When bumping connections of opposite types, always bump the inferior block.\n      if (connection.type !== otherConnection.type) {\n        bumpOther = connection.isSuperior();\n      // If one is connected and the other is unconnected, always bump the\n      // unconnected block.\n      } else if (connection.targetConnection && !otherConnection.targetConnection) {\n        bumpOther = true;\n      } else if (!connection.targetConnection && otherConnection.targetConnection) {\n        bumpOther = false;\n      // Otherwise bump the block that is lower on the screen.\n      } else {\n        var rootY = rootBlock.getRelativeToSurfaceXY().y;\n        var otherY = otherRootBlock.getRelativeToSurfaceXY().y;\n        bumpOther = rootY < otherY;\n      }\n\n      if (bumpOther) {\n        otherConnection.bumpAwayFrom_(connection);\n      } else {\n        connection.bumpAwayFrom_(otherConnection);\n      }\n    }\n  }\n};\n\n/**\n * Return the parent block or null if this block is at the top level.\n * @return {Blockly.Block} The block that holds the current block.\n */\nBlockly.Block.prototype.getParent = function() {\n  // Look at the DOM to see if we are nested in another block.\n  return this.parentBlock_;\n};\n\n/**\n * Return the parent block that surrounds the current block, or null if this\n * block has no surrounding block.  A parent block might just be the previous\n * statement, whereas the surrounding block is an if statement, while loop, etc.\n * @return {Blockly.Block} The block that surrounds the current block.\n */\nBlockly.Block.prototype.getSurroundParent = function() {\n  var block = this;\n  while (true) {\n    do {\n      var prevBlock = block;\n      block = block.getParent();\n      if (!block) {\n        // Ran off the top.\n        return null;\n      }\n    } while (block.nextConnection &&\n             block.nextConnection.targetBlock() == prevBlock);\n    // This block is an enclosing parent, not just a statement in a stack.\n    return block;\n  }\n};\n\n/**\n * Return the top-most block in this block's tree.\n * This will return itself if this block is at the top level.\n * @return {!Blockly.Block} The root block.\n */\nBlockly.Block.prototype.getRootBlock = function() {\n  var rootBlock;\n  var block = this;\n  do {\n    rootBlock = block;\n    block = rootBlock.parentBlock_;\n  } while (block);\n  return rootBlock;\n};\n\n/**\n * Find all the blocks that are directly nested inside this one.\n * Includes value and block inputs, as well as any following statement.\n * Excludes any connection on an output tab or any preceding statement.\n * @return {!Array.<!Blockly.Block>} Array of blocks.\n */\nBlockly.Block.prototype.getChildren = function() {\n  return this.childBlocks_;\n};\n\n/**\n * Set parent of this block to be a new block or null.\n * @param {Blockly.Block} newParent New parent block.\n */\nBlockly.Block.prototype.setParent = function(newParent) {\n  if (this.parentBlock_) {\n    // Remove this block from the old parent's child list.\n    var children = this.parentBlock_.childBlocks_;\n    for (var child, x = 0; (child = children[x]); x++) {\n      if (child == this) {\n        children.splice(x, 1);\n        break;\n      }\n    }\n    // Move this block up the DOM.  Keep track of x/y translations.\n    var xy = this.getRelativeToSurfaceXY();\n    this.moveToFrontOfMainCanvas_();\n    this.svg_.getRootElement().setAttribute('transform',\n        'translate(' + xy.x + ', ' + xy.y + ')');\n\n    // Disconnect from superior blocks.\n    this.parentBlock_ = null;\n    if (this.previousConnection && this.previousConnection.targetConnection) {\n      this.previousConnection.disconnect();\n    }\n    if (this.outputConnection && this.outputConnection.targetConnection) {\n      this.outputConnection.disconnect();\n    }\n    // This block hasn't actually moved on-screen, so there's no need to update\n    // its connection locations.\n  } else {\n    // Remove this block from the blockSpace's list of top-most blocks.\n    this.blockSpace.removeTopBlock(this);\n    this.setIsUnused();\n  }\n\n  this.parentBlock_ = newParent;\n  if (newParent) {\n    // Add this block to the new parent's child list.\n    newParent.childBlocks_.push(this);\n\n    // Account for the transform added by the relative position of the parent.\n    var oldXY = this.getRelativeToSurfaceXY();\n    var parentXY = newParent.getRelativeToSurfaceXY();\n    this.svg_.getRootElement().setAttribute('transform', 'translate(' +\n      (oldXY.x - parentXY.x) + ', ' + (oldXY.y - parentXY.y) + ')');\n\n    if (newParent.svg_ && this.svg_) {\n      newParent.svg_.getRootElement().appendChild(this.svg_.getRootElement());\n    }\n    var newXY = this.getRelativeToSurfaceXY();\n    // Move the connections to match the child's new position.\n    this.moveConnections_(newXY.x - oldXY.x, newXY.y - oldXY.y);\n  } else {\n    this.blockSpace.addTopBlock(this);\n  }\n};\n\n/**\n * Find all the blocks that are directly or indirectly nested inside this one.\n * Includes this block in the list.\n * Includes value and block inputs, as well as any following statements.\n * Excludes any connection on an output tab or any preceding statements.\n * @return {!Array.<!Blockly.Block>} Flattened array of blocks.\n */\nBlockly.Block.prototype.getDescendants = function() {\n  var blocks = [this];\n  for (var child, x = 0; child = this.childBlocks_[x]; x++) {\n    blocks = blocks.concat(child.getDescendants());\n  }\n  return blocks;\n};\n\n/**\n * Get whether this block and all of its connected descendants\n * are configured as deletable. Used when deciding whether the\n * user can trash a group of blocks - all of the blocks must\n * be deletable.\n * @return {boolean} True if this block and all blocks connected\n *    below it are deleteable.\n */\nBlockly.Block.prototype.areBlockAndDescendantsDeletable = function() {\n  var deleteBlockedByChildren = this.childBlocks_.some(\n    function (child) {\n      return !child.areBlockAndDescendantsDeletable();\n    });\n  return this.isDeletable() && !deleteBlockedByChildren;\n}\n\n/**\n * Get whether this block is deletable or not.\n * @return {boolean} True if deletable.\n */\nBlockly.Block.prototype.isDeletable = function() {\n  return this.deletable_ && !this.blockSpace.isReadOnly();\n};\n\n/**\n * Set whether this block is deletable or not.\n * @param {boolean} deletable True if deletable.\n */\nBlockly.Block.prototype.setDeletable = function(deletable) {\n  this.deletable_ = deletable;\n  if (this.svg_) {\n    this.svg_.grayOut(this.shouldBeGrayedOut());\n  }\n};\n\n/**\n * @returns {boolean} whether this block should be rendered as grayed out\n */\nBlockly.Block.prototype.shouldBeGrayedOut = function() {\n  return Blockly.grayOutUndeletableBlocks\n    && !this.isDeletable()\n    && !this.blockSpace.isReadOnly();\n};\n\n/**\n * Get whether this block is movable or not. Note that this can still return\n * true if block movement is locked for the entire blockSpace, check\n * blockSpaceEditor.isMovementLocked() separately.\n * @return {boolean} True if movable.\n */\nBlockly.Block.prototype.isMovable = function() {\n  return this.movable_ && !this.blockSpace.isReadOnly();\n};\n\n/**\n * Set whether this block is movable or not.\n * @param {boolean} movable True if movable.\n */\nBlockly.Block.prototype.setMovable = function(movable) {\n  this.movable_ = movable;\n  this.svg_ && this.svg_.updateMovable();\n};\n\n/**\n * Get whether this block is editable or not.\n * @return {boolean} True if editable.\n */\nBlockly.Block.prototype.isEditable = function() {\n  return this.editable_ && !this.blockSpace.isReadOnly();\n};\n\n/**\n * Set whether this block is editable or not.\n * @param {boolean} editable True if editable.\n */\nBlockly.Block.prototype.setEditable = function(editable) {\n  this.editable_ = editable;\n  for (var x = 0, input; input = this.inputList[x]; x++) {\n    for (var y = 0, title; title = input.titleRow[y]; y++) {\n      title.updateEditable();\n    }\n  }\n  var icons = this.getIcons();\n  for (var x = 0; x < icons.length; x++) {\n    icons[x].updateEditable();\n  }\n  if (this.editLabel_) {\n    this.editLabel_.setVisible(editable);\n  }\n};\n\n/**\n * Get whether this block is visible to the user.\n * @return {boolean} True if visible to the user.\n */\nBlockly.Block.prototype.isUserVisible = function() {\n  return this.userVisible_;\n};\n\n/**\n * Set whether this block and all child blocks are visible to the user.\n * @param {boolean} userVisible True if visible to user.\n * @param {boolean} opt_renderAfterVisible True if should render once if set to visible\n */\nBlockly.Block.prototype.setUserVisible = function(userVisible, opt_renderAfterVisible) {\n  this.userVisible_ = userVisible;\n  if (userVisible) {\n    this.svg_ && Blockly.removeClass_(this.svg_.svgGroup_, 'userHidden');\n  } else {\n    this.svg_ && Blockly.addClass_(this.svg_.svgGroup_, 'userHidden');\n  }\n  // Apply to all children recursively\n  this.childBlocks_.forEach(function (child) {\n    child.setUserVisible(userVisible, opt_renderAfterVisible);\n  });\n\n  if (opt_renderAfterVisible && userVisible && this.childBlocks_.length === 0) {\n    // At leaf node blocks, renders up through the root\n    this.svg_ && this.render();\n  }\n};\n\nBlockly.Block.prototype.isNextConnectionDisabled = function() {\n  return this.nextConnectionDisabled_;\n};\n\nBlockly.Block.prototype.isFunctionDefinition = function() {\n  return !!this.getProcedureInfo;\n};\n\n/**\n * Set whether this block should allow for succeeding connections.\n * Called by Xml.domToBlock, primarily used as a passthrough to\n * setNextStatement to disable any existing connections.\n */\nBlockly.Block.prototype.setNextConnectionDisabled = function(disabled) {\n  this.nextConnectionDisabled_ = disabled;\n  if (disabled && this.nextConnection && this.nextConnection.targetConnection) {\n    this.nextConnection.disconnect();\n  }\n  this.setNextStatement(!disabled);\n};\n\n/**\n * @returns {boolean} whether this block is selected and mid-drag\n */\nBlockly.Block.prototype.isCurrentlyBeingDragged = function () {\n  return Blockly.selected === this && Blockly.Block.isDragging();\n};\n\n/**\n * Check whether this block is currently hidden (a non-persistent property)\n */\nBlockly.Block.prototype.isCurrentlyHidden_ = function () {\n  return this.currentlyHidden_;\n};\n\n/**\n * Set whether this block is currently hidden (a non-persistent property)\n * Note: Does not set children to currently hidden, but they will display as hidden\n */\nBlockly.Block.prototype.setCurrentlyHidden = function (hidden) {\n  this.currentlyHidden_ = hidden;\n  if (this.svg_) {\n    this.svg_.setVisible(!hidden);\n    if (!hidden) {\n      this.refreshRender();\n    }\n  }\n};\n\n/**\n * Account for the fact that we have two different visibility states.\n * UserVisible is a persisent property used to create blocks that can be seen\n * by level builders, but not by the user.\n * CurrentlyHidden is a non-persistent property used to hide certain blocks\n * (like function definitions/examples) that should only be visible when using\n * the modal function editor.\n * This method calculates whether this block is currently visible based\n * on our current block-editing state (Blockly.editBlocks)\n * @returns true if both visibility conditions are met.\n */\nBlockly.Block.prototype.isVisible = function () {\n  var visibleThroughParent = !this.parentBlock_ || this.parentBlock_.isVisible();\n  var visible = visibleThroughParent && !this.isCurrentlyHidden_();\n\n  if (Blockly.editBlocks) {\n    // If we're in edit mode, we're not a \"user\", so we don't care if\n    // the block isUserVisible or not.\n    return visible;\n  }\n\n  return visible && this.isUserVisible();\n};\n\n/**\n * Set the URL of this block's help page.\n * @param {string|Function} url URL string for block help, or function that\n *     returns a URL.  Null for no help.\n */\nBlockly.Block.prototype.setHelpUrl = function(url) {\n  this.helpUrl = url;\n};\n\n/**\n * Get the current colour of this block\n * @returns {string} hexadecimal colour value\n */\nBlockly.Block.prototype.getHexColour = function() {\n  return Blockly.makeColour(this.getColour(), this.getSaturation(), this.getValue());\n};\n\n/**\n * Get the colour of a block.\n * @return {number} HSV hue value.\n */\nBlockly.Block.prototype.getColour = function() {\n  return this.colourHue_;\n};\n\n/**\n * Get the saturation of a block.\n * @return {number} HSV saturation.\n */\nBlockly.Block.prototype.getSaturation = function() {\n  return this.colourSaturation_;\n};\n\n/**\n * Get the fill pattern for the block\n * @return {string} Pattern name xlink\n */\nBlockly.Block.prototype.getFillPattern = function() {\n  return this.fillPattern_;\n};\n\n/**\n * Whether or not this block has a frame around it. Should only be true for\n * function definitions\n * @return {boolean}\n */\nBlockly.Block.prototype.isFramed = function() {\n  return this.blockSvgClass_ === Blockly.BlockSvgFramed;\n};\n\n/**\n * Get the value of a block.\n * @return {number} HSV value.\n */\nBlockly.Block.prototype.getValue = function() {\n  return this.colourValue_;\n};\n\n/**\n * Change the colour of a block.\n * @param {number} colourHue HSV hue value.\n */\nBlockly.Block.prototype.setColour = function(colourHue) {\n  this.colourHue_ = colourHue;\n  if (this.svg_) {\n    this.svg_.updateColour();\n  }\n  var icons = this.getIcons();\n  for (var x = 0; x < icons.length; x++) {\n    icons[x].updateColour();\n  }\n  if (this.rendered) {\n    // Bump every dropdown to change its colour.\n    for (var x = 0, input; input = this.inputList[x]; x++) {\n      for (var y = 0, title; title = input.titleRow[y]; y++) {\n        title.setText(null);\n      }\n    }\n    this.render();\n  }\n};\n\n/**\n * Change the fill pattern of a block\n * @param {string} pattern The id of the pattern\n */\nBlockly.Block.prototype.setFillPattern = function(pattern) {\n  this.fillPattern_ = pattern;\n};\n\n/**\n * Set whether or not this block should be framed.  Should only be set for\n * function definitions.\n * @param {boolean} isFramed\n */\nBlockly.Block.prototype.setFramed = function(isFramed) {\n  this.blockSvgClass_ = isFramed ? Blockly.BlockSvgFramed : Blockly.BlockSvg;\n};\n\nBlockly.Block.prototype.isUnused = function() {\n  return this.svg_.isUnused() || this.isCurrentlyBeingDragged();\n};\n\nBlockly.Block.prototype.setIsUnused = function(isUnused) {\n  if (isUnused === undefined) {\n    var shouldBeTopBlock = this.previousConnection === null &&\n        this.outputConnection === null;\n\n    isUnused = !shouldBeTopBlock &&\n        this.isUserVisible() &&\n        this.type !== 'functional_definition' &&\n        Blockly.mainBlockSpace &&\n        Blockly.mainBlockSpace.isReadOnly() === false &&\n        Blockly.mainBlockSpace.isTopBlock(this);\n  }\n  if (Blockly.showUnusedBlocks && isUnused !== this.svg_.isUnused()) {\n    this.svg_.setIsUnused(isUnused);\n    this.childBlocks_.forEach(function (block) {\n      block.setIsUnused(false);\n    });\n  }\n};\n\n/**\n * Set whether or not this block should use the functional svg\n * @param {boolean} isFramed\n */\nBlockly.Block.prototype.setFunctional = function(isFunctional, options) {\n  this.blockSvgClass_ = isFunctional ? Blockly.BlockSvgFunctional : Blockly.BlockSvg;\n  this.customOptions_ = isFunctional ? options : {};\n};\n\n\n/**\n * Change the HSV of a block.\n * @param {number} colourHue HSV hue value.\n * @param {number} colourSaturation HSV saturation value.\n * @param {number} colourValue HSV value.\n */\nBlockly.Block.prototype.setHSV = function(\n    colourHue, colourSaturation, colourValue) {\n  this.colourHue_ = colourHue;\n  this.colourSaturation_ = colourSaturation;\n  this.colourValue_ = colourValue;\n  if (this.svg_) {\n    this.svg_.updateColour();\n  }\n  var icons = this.getIcons();\n  for (var x = 0; x < icons.length; x++) {\n    icons[x].updateColour();\n  }\n  if (this.rendered) {\n    // Bump every dropdown to change its colour.\n    for (var x = 0, input; input = this.inputList[x]; x++) {\n      for (var y = 0, title; title = input.titleRow[y]; y++) {\n        title.setText(null);\n      }\n    }\n    this.render();\n  }\n};\n\n/**\n * Returns the named title from a block.\n * @param {string} name The name of the title.\n * @return {*} Named title, or null if title does not exist.\n * @private\n */\nBlockly.Block.prototype.getTitle_ = function(name) {\n  for (var x = 0, input; input = this.inputList[x]; x++) {\n    for (var y = 0, title; title = input.titleRow[y]; y++) {\n      if (title.name === name) {\n        return title;\n      }\n    }\n  }\n  return null;\n};\n\nBlockly.Block.prototype.getTitles = function() {\n  var titles = [];\n  for (var x = 0, input; input = this.inputList[x]; x++) {\n    for (var y = 0, title; title = input.titleRow[y]; y++) {\n      titles.push(title);\n    }\n  }\n  return titles;\n};\n\n/**\n * Returns the language-neutral value from the title of a block.\n * @param {string} name The name of the title.\n * @return {?string} Value from the title or null if title does not exist.\n */\nBlockly.Block.prototype.getTitleValue = function(name) {\n  var title = this.getTitle_(name);\n  if (title) {\n    return title.getValue();\n  }\n  return null;\n};\n\n/**\n * Change the title value for a block (e.g. 'CHOOSE' or 'REMOVE').\n * @param {string} newValue Value to be the new title.\n * @param {string} name The name of the title.\n */\nBlockly.Block.prototype.setTitleValue = function(newValue, name) {\n  var title = this.getTitle_(name);\n  if (title) {\n    title.setValue(newValue);\n  } else {\n    this.appendDummyInput().appendTitle(new Blockly.FieldTextInput(newValue), name);\n    console.warn('Unknown title: \"' + name + '\" not found.');\n  }\n};\n\n/**\n * Change the config value for a given field on the block\n * @param {string} fieldName The name of the field\n * @param {string} configString configuration to set for the field\n */\nBlockly.Block.prototype.setFieldConfig = function(fieldName, configString) {\n  var field = this.getTitle_(fieldName);\n  if (!field) {\n    console.warn('Unknown field: \"' + fieldName + '\" not found.');\n    return;\n  }\n\n  if (field.setConfig) {\n    field.setConfig(configString);\n  }\n};\n\n/**\n * Change the tooltip text for a block.\n * @param {string|!Element} newTip Text for tooltip or a parent element to\n *     link to for its tooltip.\n */\nBlockly.Block.prototype.setTooltip = function(newTip) {\n  this.tooltip = newTip;\n};\n\n/**\n * Set whether this block can chain onto the bottom of another block.\n * @param {boolean} hasPrevious True if there can be a previous statement.\n * @param {string|Array.<string>|null} opt_check Statement type or list of\n *     statement types.  Null or undefined if any type could be connected.\n */\nBlockly.Block.prototype.setPreviousStatement = function(hasPrevious, opt_check) {\n  if (this.previousConnection) {\n    if (this.previousConnection.targetConnection) {\n      throw 'Must disconnect previous statement before removing connection.';\n    }\n    this.previousConnection.dispose();\n    this.previousConnection = null;\n  }\n  if (hasPrevious) {\n    if (this.outputConnection) {\n      throw 'Remove output connection prior to adding previous connection.';\n    }\n    if (opt_check === undefined) {\n      opt_check = null;\n    }\n    this.previousConnection =\n        new Blockly.Connection(this, Blockly.PREVIOUS_STATEMENT);\n    this.previousConnection.setCheck(opt_check);\n  }\n  this.refreshRender();\n};\n\n/**\n * Set whether another block can chain onto the bottom of this block.\n * @param {boolean} hasNext True if there can be a next statement.\n * @param {string|Array.<string>|null} opt_check Statement type or list of\n *     statement types.  Null or undefined if any type could be connected.\n */\nBlockly.Block.prototype.setNextStatement = function(hasNext, opt_check) {\n  if (this.nextConnection) {\n    if (this.nextConnection.targetConnection) {\n      throw 'Must disconnect next statement before removing connection.';\n    }\n    this.nextConnection.dispose();\n    this.nextConnection = null;\n  }\n  if (hasNext) {\n    if (opt_check === undefined) {\n      opt_check = null;\n    }\n    this.nextConnection =\n        new Blockly.Connection(this, Blockly.NEXT_STATEMENT);\n    this.nextConnection.setCheck(opt_check);\n  }\n  this.refreshRender();\n};\n\n/**\n * Set whether this block returns a value, with strict type checking if so.\n * @param {boolean} hasOutput True if there is an output.\n * @param {string|Array.<string>|null} opt_check Returned type or list of\n *     returned types.  Null or undefined if any type could be returned\n *     (e.g. variable get).\n */\nBlockly.Block.prototype.setStrictOutput = function(hasOutput, opt_check) {\n  this.setOutput(hasOutput, opt_check, true);\n}\n/**\n * Set whether this block returns a value.\n * @param {boolean} hasOutput True if there is an output.\n * @param {string|Array.<string>|null} opt_check Returned type or list of\n *     returned types.  Null or undefined if any type could be returned\n *     (e.g. variable get).\n * @param {boolean} opt_strict Specify if the output type is strict, i.e. it\n *     can only connect to inputs that expect the exact same type\n */\nBlockly.Block.prototype.setOutput = function(hasOutput, opt_check, opt_strict) {\n  if (this.outputConnection) {\n    if (this.outputConnection.targetConnection) {\n      throw 'Must disconnect output value before removing connection.';\n    }\n    this.outputConnection.dispose();\n    this.outputConnection = null;\n  }\n  if (hasOutput) {\n    if (this.previousConnection) {\n      throw 'Remove previous connection prior to adding output connection.';\n    }\n    if (opt_check === undefined) {\n      opt_check = null;\n    }\n    this.outputConnection =\n        new Blockly.Connection(this, Blockly.OUTPUT_VALUE);\n    this.outputConnection.setCheck(opt_check, opt_strict);\n  }\n  this.refreshRender();\n};\n\nBlockly.Block.prototype.refreshRender = function () {\n  if (this.rendered) {\n    this.render();\n    this.bumpNeighbours();\n  }\n};\n/**\n * Set whether this is a functional block that returns a value. Currently this\n * will be displayed as previous connection that will only connect with\n * functional inputs\n * @param {boolean} hasOutput True if there is an output.\n * @param {string|Array.<string>|null} opt_check Returned type or list of\n *     returned types.  Null or undefined if any type could be returned\n *     (e.g. variable get).\n */\nBlockly.Block.prototype.setFunctionalOutput = function(hasOutput, opt_check) {\n  if (this.previousConnection) {\n    if (this.previousConnection.targetConnection) {\n      throw 'Must disconnect output value before removing connection.';\n    }\n    this.previousConnection.dispose();\n    this.previousConnection = null;\n  }\n  if (hasOutput) {\n    if (this.previousConnection) {\n      throw 'Remove previous connection prior to adding output connection.';\n    }\n    if (opt_check === undefined) {\n      opt_check = null;\n    }\n    this.previousConnection =\n        new Blockly.Connection(this, Blockly.FUNCTIONAL_OUTPUT);\n    this.previousConnection.setCheck(opt_check);\n  }\n  this.refreshRender();\n};\n\n/**\n * Sets this block to have a new functional output type\n * @param {Blockly.BlockValueType} newType\n */\nBlockly.Block.prototype.changeFunctionalOutput = function(newType) {\n  this.setHSV.apply(this, Blockly.FunctionalTypeColors[newType]);\n  this.previousConnection = this.previousConnection || new Blockly.Connection(this, Blockly.FUNCTIONAL_OUTPUT);\n  this.previousConnection.setCheck(newType);\n  this.refreshRender();\n};\n\n/**\n * Set whether value inputs are arranged horizontally or vertically.\n * @param {boolean} inputsInline True if inputs are horizontal.\n */\nBlockly.Block.prototype.setInputsInline = function(inputsInline) {\n  this.inputsInline = inputsInline;\n  if (this.rendered) {\n    this.render();\n    this.bumpNeighbours();\n    this.blockSpace.fireChangeEvent();\n  }\n};\n\n/**\n * Set whether the block is disabled or not.\n * @param {boolean} disabled True if disabled.\n */\nBlockly.Block.prototype.setDisabled = function(disabled) {\n  if (this.disabled == disabled) {\n    return;\n  }\n  this.disabled = disabled;\n  this.svg_.updateDisabled();\n  this.blockSpace.fireChangeEvent();\n};\n\n/**\n * Get whether the block is disabled or not due to parents.\n * The block's own disabled property is not considered.\n * @return {boolean} True if disabled.\n */\nBlockly.Block.prototype.getInheritedDisabled = function() {\n  var block = this;\n  while (true) {\n    block = block.getSurroundParent();\n    if (!block) {\n      // Ran off the top.\n      return false;\n    } else if (block.disabled) {\n      return true;\n    }\n  }\n};\n\n/**\n * Get whether the block is collapsed or not.\n * @return {boolean} True if collapsed.\n */\nBlockly.Block.prototype.isCollapsed = function() {\n  return this.collapsed_;\n};\n\n/**\n * Set whether the block is collapsed or not.\n * @param {boolean} collapsed True if collapsed.\n */\nBlockly.Block.prototype.setCollapsed = function(collapsed) {\n  if (this.collapsed_ == collapsed) {\n    return;\n  }\n  this.collapsed_ = collapsed;\n  var renderList = [];\n  // Show/hide the inputs.\n  for (var x = 0, input; input = this.inputList[x]; x++) {\n    renderList = renderList.concat(input.setVisible(!collapsed));\n  }\n\n  var COLLAPSED_INPUT_NAME = '_TEMP_COLLAPSED_INPUT';\n  if (collapsed) {\n    var icons = this.getIcons();\n    for (var x = 0; x < icons.length; x++) {\n      icons[x].setVisible(false);\n    }\n    var text = this.toString(Blockly.COLLAPSE_CHARS);\n    this.appendDummyInput(COLLAPSED_INPUT_NAME).appendTitle(text);\n  } else {\n    this.removeInput(COLLAPSED_INPUT_NAME)\n  }\n\n  if (!renderList.length) {\n    // No child blocks, just render this block.\n    renderList[0] = this;\n  }\n  if (this.rendered) {\n    for (var x = 0, block; block = renderList[x]; x++) {\n      block.render();\n    }\n    this.bumpNeighbours();\n  }\n};\n\n/**\n * Create a human-readable text representation of this block and any children.\n * @param {?number} opt_maxLength Truncate the string to this length.\n * @return {string} Text of block.\n */\nBlockly.Block.prototype.toString = function(opt_maxLength) {\n  var text = [];\n  for (var x = 0, input; input = this.inputList[x]; x++) {\n    for (var y = 0, title; title = input.titleRow[y]; y++) {\n      text.push(title.getText());\n    }\n    if (input.connection) {\n      var child = input.connection.targetBlock();\n      if (child) {\n        text.push(child.toString());\n      } else {\n        text.push('?');\n      }\n    }\n  }\n  text = goog.string.trim(text.join(' ')) || '???';\n  if (opt_maxLength) {\n    // TODO: Improve truncation so that text from this block is given priority.\n    // TODO: Handle FieldImage better.\n    text = goog.string.truncate(text, opt_maxLength);\n  }\n  return text;\n}\n\n/**\n * Shortcut for appending a value input row.\n * @param {string} name Language-neutral identifier which may used to find this\n *     input again.  Should be unique to this block.\n * @return {!Blockly.Input} The input object created.\n */\nBlockly.Block.prototype.appendValueInput = function(name) {\n  return this.appendInput_(Blockly.INPUT_VALUE, name);\n};\n\n/**\n * Shortcut for appending a statement input row.\n * @param {string} name Language-neutral identifier which may used to find this\n *     input again.  Should be unique to this block.\n * @param {?number} trailingSpacing Extra space to leave below the input's last\n *     block.\n * @return {!Blockly.Input} The input object created.\n */\nBlockly.Block.prototype.appendStatementInput = function(name, trailingSpacing) {\n  trailingSpacing = trailingSpacing || 0;\n  return this.appendInput_(Blockly.NEXT_STATEMENT, name, trailingSpacing);\n};\n\n/**\n * Shortcut for appending a dummy input row.\n * @param {?string} opt_name Language-neutral identifier which may used to find\n *     this input again.  Should be unique to this block.\n * @return {!Blockly.Input} The input object created.\n */\nBlockly.Block.prototype.appendDummyInput = function(opt_name) {\n  return this.appendInput_(Blockly.DUMMY_INPUT, opt_name || '');\n};\n\n/**\n * Shortcut for appending a functional input. Functional inputs are displayed\n * similarly to value inputs, but with a notch similar to previous/next\n * connections instead of the tab on the left.\n * @param {string} opt_name Language-neutral identifier which may used to find\n *     this input again.  Should be unique to this block.\n * @return {!Blockly.Input} The input object created.\n */\nBlockly.Block.prototype.appendFunctionalInput = function(name) {\n  return this.appendInput_(Blockly.FUNCTIONAL_INPUT, name);\n};\n\n/**\n * Interpolate a message string, creating titles and inputs.\n * @param {string} msg The message string to parse.  %1, %2, etc. are symbols\n *     for value inputs.\n * @param {!Array.<string|number>|number} var_args A series of tuples that\n *     each specify the value inputs to create.  Each tuple has three values:\n *     the input name, its check type, and its title's alignment.  The last\n *     parameter is not a tuple, but just an alignment for any trailing dummy\n *     input.  This last parameter is mandatory; there may be any number of\n *     tuples (though the number of tuples must match the symbols in msg).\n */\nBlockly.Block.prototype.interpolateMsg = function(msg, var_args) {\n  // Remove the msg from the start and the dummy alignment from the end of args.\n  goog.asserts.assertString(msg);\n  var dummyAlign = arguments.length - 1;\n  goog.asserts.assertNumber(dummyAlign);\n\n  var tokens = msg.split(/(%\\d)/);\n  for (var i = 0; i < tokens.length; i += 2) {\n    var text = goog.string.trim(tokens[i]);\n    var symbol = tokens[i + 1];\n    if (symbol) {\n      // Value input.\n      var digit = window.parseInt(symbol.charAt(1), 10);\n      var tuple = arguments[digit];\n      goog.asserts.assertArray(tuple,\n          'Message symbol \"%s\" is out of range.', symbol);\n      this.appendValueInput(tuple[0])\n          .setCheck(tuple[1])\n          .setAlign(tuple[2])\n          .appendTitle(text);\n      arguments[digit] = null;  // Inputs may not be reused.\n    } else if (text) {\n      // Trailing dummy input.\n      this.appendDummyInput()\n          .setAlign(dummyAlign)\n          .appendTitle(text);\n    }\n  }\n  // Verify that all inputs were used.\n  for (var i = 1; i < arguments.length - 1; i++) {\n    goog.asserts.assert(arguments[i] === null,\n        'Input \"%%s\" not used in message: \"%s\"', i, msg);\n  }\n  // Make the inputs inline unless there is only one input and\n  // no text follows it.\n  this.setInputsInline(!msg.match(/%1\\s*$/))\n};\n\n/**\n * Add a value input, statement input or local variable to this block.\n * @param {number} type Either Blockly.INPUT_VALUE or Blockly.NEXT_STATEMENT or\n *     Blockly.DUMMY_INPUT.\n * @param {string} name Language-neutral identifier which may used to find this\n *     input again.  Should be unique to this block.\n * @param {?number} spacing extra space to put below this input's last statement\n * @return {!Blockly.Input} The input object created.\n * @private\n */\nBlockly.Block.prototype.appendInput_ = function(type, name, spacing) {\n  spacing = spacing || 0;\n  var connection = null;\n  if (type === Blockly.INPUT_VALUE || type === Blockly.NEXT_STATEMENT ||\n    type === Blockly.FUNCTIONAL_INPUT) {\n    connection = new Blockly.Connection(this, type);\n  }\n  var input = new Blockly.Input(type, name, this, connection, spacing);\n  // Append input to list.\n  this.inputList.push(input);\n  if (this.rendered) {\n    this.render();\n    // Adding an input will cause the block to change shape.\n    this.bumpNeighbours();\n  }\n  return input;\n};\n\n/**\n * Move an input to a different location on this block.\n * @param {string} name The name of the input to move.\n * @param {string} refName Name of input that should be after the moved input.\n */\nBlockly.Block.prototype.moveInputBefore = function(name, refName) {\n  if (name == refName) {\n    throw 'Can\\'t move \"' + name + '\" to itself.';\n  }\n  // Find both inputs.\n  var inputIndex = -1;\n  var refIndex = -1;\n  for (var x = 0, input; input = this.inputList[x]; x++) {\n    if (input.name == name) {\n      inputIndex = x;\n      if (refIndex != -1) {\n        break;\n      }\n    } else if (input.name == refName) {\n      refIndex = x;\n      if (inputIndex != -1) {\n        break;\n      }\n    }\n  }\n  if (inputIndex == -1) {\n    throw 'Named input \"' + name + '\" not found.';\n  }\n  if (refIndex == -1) {\n    throw 'Reference input \"' + name + '\" not found.';\n  }\n  // Remove input.\n  this.inputList.splice(inputIndex, 1);\n  if (inputIndex < refIndex) {\n    refIndex--;\n  }\n  // Reinsert input.\n  this.inputList.splice(refIndex, 0, input);\n  if (this.rendered) {\n    this.render();\n    // Moving an input will cause the block to change shape.\n    this.bumpNeighbours();\n  }\n};\n\n/**\n * Remove an input from this block.\n * @param {string} name The name of the input.\n * @param {boolean} opt_quiet True to prevent error if input is not present.\n * @throws {goog.asserts.AssertionError} if the input is not present and\n *     opt_quiet is not true.\n */\nBlockly.Block.prototype.removeInput = function(name, opt_quiet) {\n  for (var x = 0, input; input = this.inputList[x]; x++) {\n    if (input.name == name) {\n      if (input.connection) {\n        if (input.connection === Blockly.highlightedConnection_) {\n          input.connection.unhighlight();\n          Blockly.highlightedConnection_ = null;\n        }\n        if (input.connection.targetConnection) {\n          // Disconnect any attached block.\n          input.connection.targetBlock().setParent(null);\n        }\n      }\n      input.dispose();\n      this.inputList.splice(x, 1);\n      if (this.rendered) {\n        this.render();\n        // Removing an input will cause the block to change shape.\n        this.bumpNeighbours();\n      }\n      return;\n    }\n  }\n  if (!opt_quiet) {\n    goog.asserts.fail('Input \"%s\" not found.', name);\n  }\n};\n\n/**\n * Fetches the named input object.\n * @param {string} name The name of the input.\n * @return {Blockly.Input|null} The input object, or null of the input does not exist.\n */\nBlockly.Block.prototype.getInput = function(name) {\n  for (var x = 0, input; input = this.inputList[x]; x++) {\n    if (input.name == name) {\n      return input;\n    }\n  }\n  // This input does not exist.\n  return null;\n};\n\n/**\n * Fetches the block attached to the named input.\n * @param {string} name The name of the input.\n * @return {Blockly.Block} The attached value block, or null if the input is\n *     either disconnected or if the input does not exist.\n */\nBlockly.Block.prototype.getInputTargetBlock = function(name) {\n  var input = this.getInput(name);\n  return input && input.connection && input.connection.targetBlock();\n};\n\nBlockly.Block.prototype.attachBlockToInputName = function(newBlock, inputName) {\n  var input = this.getInput(inputName);\n  if (!input || !input.connection) {\n    throw 'Block has no input named ' + name;\n  }\n\n  newBlock.previousConnection.connect(input.connection);\n};\n\n/**\n * Give this block a mutator dialog.\n * @param {Blockly.Mutator} mutator A mutator dialog instance or null to remove.\n */\nBlockly.Block.prototype.setMutator = function(mutator) {\n  if (this.mutator && this.mutator !== mutator) {\n    this.mutator.dispose();\n  }\n  if (mutator) {\n    mutator.block_ = this;\n    this.mutator = mutator;\n    if (this.svg_) {\n      mutator.createIcon();\n    }\n  }\n};\n\n/**\n * Set this block's warning text.\n * @param {?string} text The text, or null to delete.\n */\nBlockly.Block.prototype.setWarningText = function(text) {\n  if (!Blockly.Warning) {\n    throw 'Warnings not supported.';\n  }\n  if (this.isInFlyout) {\n    text = null;\n  }\n  var changedState = false;\n  if (goog.isString(text)) {\n    if (!this.warning) {\n      this.warning = new Blockly.Warning(this);\n      changedState = true;\n    }\n    this.warning.setText(/** @type {string} */ (text));\n  } else {\n    if (this.warning) {\n      this.warning.dispose();\n      changedState = true;\n    }\n  }\n  if (changedState && this.rendered) {\n    this.render();\n    // Adding or removing a warning icon will cause the block to change shape.\n    this.bumpNeighbours();\n  }\n};\n\nBlockly.Block.prototype.setInputCount = function(inputCount) {\n  this.inputCount = parseInt(inputCount);\n};\n\nBlockly.Block.prototype.svgInitialized = function() {\n  return !!this.svg_;\n};\n\n/**\n * Render the block.\n * Lays out and reflows a block based on its contents and settings.\n * @param {boolean} selfOnly Whether to render only this block and NOT also\n * its parents which in turn would trigger a window resize event. Defaults to\n * false.\n */\nBlockly.Block.prototype.render = function(selfOnly) {\n  if (!this.svg_) {\n    throw 'Uninitialized block cannot be rendered.  Call block.initSvg()';\n  }\n  this.svg_.render(selfOnly);\n};\n\n/**\n * Exposes this block's BlockSvg\n */\nBlockly.Block.prototype.getSvgRenderer = function () {\n  return this.svg_;\n};\n\n/**\n * Get the oldest ancestor of this block.\n */\nBlockly.Block.prototype.getRootBlock = function () {\n  var rootBlock;\n  var current = this;\n  while (current) {\n    rootBlock = current;\n    current = current.getParent();\n  }\n\n  return rootBlock;\n};\n\n/**\n * @returns True if any of this blocks inputs have a connection that is unfilled\n */\nBlockly.Block.prototype.hasUnfilledFunctionalInput = function () {\n  // Does this block have a connection without a block attached\n  return this.inputList.some(function (input) {\n    return input.type === Blockly.FUNCTIONAL_INPUT && input.connection &&\n      !input.connection.targetBlock();\n  });\n};\n","/**\n * @fileoverview Angle Helper for angle Fields\n */\n'use strict';\n\ngoog.provide('Blockly.AngleHelper');\ngoog.require('goog.math.Vec2');\n\n/**\n * Simple widget to help visualize angles.\n * @param {string} direction - 'turnRight' or 'turnLeft' as set by\n * direction dropdown.\n * @param {object} opt_options\n * @param {String} opt_options.arcColour \n * @param {number} opt_options.angle \n * @param {number} opt_options.circleR \n * @param {number} opt_options.height \n * @param {number} opt_options.width \n * @param {boolean} opt_options.dragging \n * @param {number} opt_options.strokeWidth \n * @param {number[]} opt_options.snapPoints\n * @param {function} opt_options.onUpdate\n */\nBlockly.AngleHelper = function(direction, opt_options) {\n  opt_options = opt_options || {};\n\n  this.turnRight_ = direction === 'turnRight';\n\n  this.arcColour_ = opt_options.arcColour || '#949ca2';\n  this.angle_ = opt_options.angle || 0;\n  this.circleR_ = opt_options.circleR || 10;\n  this.height_ = opt_options.height || 150;\n  this.width_ = opt_options.width || 150;\n  this.dragging_ = opt_options.dragging || false;\n  this.strokeWidth_ = opt_options.strokeWidth || 3;\n  this.snapPoints_ = opt_options.snapPoints && opt_options.snapPoints.map(function (point) {\n    return Math.round(parseInt(point));\n  });\n\n  this.center_ = new goog.math.Vec2(this.width_ / 2, this.height_ / 2);\n\n  var circumference = Math.min(this.height_, this.width_);\n  this.lineLength_ = new goog.math.Vec2((circumference / 2) - this.circleR_ - this.strokeWidth_, 0);\n\n  this.circleCenter_ = this.center_.clone().add(this.lineLength_)\n  this.circleCenter_ = goog.math.Vec2.rotateAroundPoint(\n    this.circleCenter_,\n    this.center_,\n    goog.math.toRadians(this.turnRight_ ? this.angle_ : -this.angle_)\n  );\n\n  this.arc_ = null;\n  this.circle_ = null;\n  this.svg_ = null;\n  this.variableLine_ = null;\n\n  this.animationInterval_ = null;\n\n  this.onUpdate_ = opt_options.onUpdate;\n};\n\n/**\n * Animate the angle change. Used when an external change causes the angle to change\n * potentially by a lot; a smooth transition helps better visualize the change.\n *\n * @param {number} targetAngle\n * @param {number=200} animationDuration\n */\nBlockly.AngleHelper.prototype.animateAngleChange = function(targetAngle, animationDuration) {\n  animationDuration = animationDuration || 200;\n  var minSteps = animationDuration / 10;\n\n  var totalDiff = targetAngle - this.getAngle();\n  var steps = Math.min(Math.abs(totalDiff), minSteps);\n  var timePerStep = animationDuration / steps;\n  var diffPerStep = totalDiff / steps;\n\n  clearInterval(this.animationInterval_);\n  this.animationInterval_ = setInterval(function () {\n    if (Math.abs(this.getAngle() - targetAngle) < 1) {\n      this.setAngle(targetAngle);\n      clearInterval(this.animationInterval_);\n    } else {\n      var newAngle = this.getAngle() + diffPerStep;\n      this.setAngle(newAngle, true);\n    }\n  }.bind(this), timePerStep);\n};\n\n/**\n * Set the current angle and update the visualization appropriately\n *\n * @param {number} angle\n * @param {boolean=false} skipSnap - should we ignore our snapping configuration?\n */\nBlockly.AngleHelper.prototype.setAngle = function(angle, skipSnap) {\n  this.angle_ = skipSnap ? angle : this.snap_(angle);\n  this.update_();\n};\n\nBlockly.AngleHelper.prototype.getAngle = function() {\n  return this.angle_;\n};\n\nBlockly.AngleHelper.prototype.init = function(svgContainer) {\n  this.svg_ = Blockly.createSvgElement('svg', {\n    'xmlns': 'http://www.w3.org/2000/svg',\n    'xmlns:html': 'http://www.w3.org/1999/xhtml',\n    'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n    'version': '1.1',\n    'height': this.height_ + 'px',\n    'width': this.width_ + 'px',\n    'style': 'background: rgb(255, 255, 255);',\n  }, svgContainer);\n  this.mouseMoveWrapper_ = Blockly.bindEvent_(this.svg_, 'mousemove', this, this.updateDrag_);\n  this.mouseUpWrapper_ = Blockly.bindEvent_(this.svg_, 'mouseup', this, this.stopDrag_);\n  this.mouseDownWrapper_ = Blockly.bindEvent_(this.svg_, 'mousedown', this, this.startDrag_);\n\n  Blockly.createSvgElement('line', {\n    'stroke': '#4d575f',\n    'stroke-width': this.strokeWidth_,\n    'stroke-linecap': 'round',\n    'x1': this.center_.x - this.lineLength_.x,\n    'x2': this.center_.x,\n    'y1': this.center_.y,\n    'y2': this.center_.y\n  }, this.svg_);\n\n  Blockly.createSvgElement('line', {\n    'stroke': '#949ca2',\n    'stroke-dasharray': '6,6',\n    'stroke-width': this.strokeWidth_,\n    'stroke-linecap': 'round',\n    'x1': this.center_.x,\n    'x2': this.center_.x + this.lineLength_.x,\n    'y1': this.center_.y,\n    'y2': this.center_.y,\n  }, this.svg_);\n\n  this.arc_ = Blockly.createSvgElement('path', {\n    'stroke': this.arcColour_,\n    'fill': 'none',\n    'stroke-width': this.strokeWidth_,\n  }, this.svg_);\n\n  // Draw markers every 15 degrees around the edge.\n  for (var angle = 15; angle < 360; angle += 15) {\n    // define three marker sizes; 5px, 10px, and 15px at angles modulo\n    // 15, 45, and 90 degrees, respectively.\n    var markerSize = (angle % 90 == 0 ? 15 : angle % 45 == 0 ? 10 : 5);\n    var isOnPrimaryHalf = this.turnRight_ ? angle < 180 : angle > 180;\n    Blockly.createSvgElement('line', {\n      'stroke-linecap': 'round',\n      'stroke-opacity': isOnPrimaryHalf ? 1 : 0.3,\n      'x1': this.center_.x + this.lineLength_.x,\n      'y1': this.center_.y,\n      'x2': this.center_.x + this.lineLength_.x - markerSize,\n      'y2': this.center_.y,\n      'class': 'blocklyAngleMarks',\n      'transform': 'rotate(' + angle + ', ' + this.center_.x + ', ' + this.center_.y + ')'\n    }, this.svg_);\n  }\n\n  this.variableLine_ = Blockly.createSvgElement('line', {\n    'stroke': '#4d575f',\n    'stroke-width': this.strokeWidth_,\n    'stroke-linecap': 'round',\n    'x1': this.center_.x,\n    'x2': this.circleCenter_.x,\n    'y1': this.center_.y,\n    'y2': this.circleCenter_.y\n  }, this.svg_);\n\n  this.circle_ = Blockly.createSvgElement('circle', {\n    'cx': this.circleCenter_.x,\n    'cy': this.circleCenter_.y,\n    'fill': '#a69bc1',\n    'r': this.circleR_,\n    'stroke': '#4d575f',\n    'stroke-width': this.strokeWidth_,\n    'style': 'cursor: move;',\n  }, this.svg_);\n\n  this.update_();\n};\n\n/**\n * Usually triggered by a change to this.angle_, this method updates the\n * positions of the various movable elements and triggers the optional\n * onUpdate callback\n */\nBlockly.AngleHelper.prototype.update_ = function() {\n  this.circleCenter_ = goog.math.Vec2.rotateAroundPoint(\n    this.center_.clone().add(this.lineLength_),\n    this.center_,\n    goog.math.toRadians(this.turnRight_ ? this.angle_ : -this.angle_)\n  );\n\n  this.variableLine_.setAttribute('x2', this.circleCenter_.x);\n  this.variableLine_.setAttribute('y2', this.circleCenter_.y);\n\n  this.circle_.setAttribute('cx', this.circleCenter_.x);\n  this.circle_.setAttribute('cy', this.circleCenter_.y);\n\n  var arcStart = 0;\n  var arcEnd = this.turnRight_ ? this.angle_ : -this.angle_;\n  this.arc_.setAttribute('d', Blockly.AngleHelper.describeArc(this.center_, 20, arcStart, arcEnd));\n};\n\nBlockly.AngleHelper.prototype.startDrag_ = function() {\n  this.dragging_ = true;\n};\n\nBlockly.AngleHelper.prototype.updateDrag_ = function(e) {\n  if (!this.dragging_) {\n    return;\n  }\n\n  // try to use offset if we can; touch events don't provide us with an\n  // offset, so calculate it ourselves if we cannot.\n  var x, y;\n  if (e.offsetX && e.offsetY) {\n    x = e.offsetX;\n    y = e.offsetY;\n  } else {\n    var rect = this.svg_.getBoundingClientRect();\n    x = e.clientX - rect.left;\n    y = e.clientY - rect.top;\n  }\n\n  var angle = goog.math.angle(this.center_.x, this.center_.y, x, y);\n\n  if (!this.turnRight_) {\n    angle = goog.math.standardAngle(-angle);\n  }\n\n  this.setAngle(angle);\n\n  if (this.onUpdate_) {\n    this.onUpdate_();\n  }\n\n  e.stopPropagation();\n  e.preventDefault();\n};\n\nBlockly.AngleHelper.prototype.stopDrag_ = function() {\n  this.dragging_ = false;\n};\n\n/**\n * If this helper is intended to only align to a subset of points (as is\n * the case in Dropdown mode), return the point in the set closest to\n * the given value. Otherwise, simply round to the nearest integer.\n */\nBlockly.AngleHelper.prototype.snap_ = function(val) {\n  if (!this.snapPoints_) {\n    return Math.round(val);\n  }\n\n  // return the point closest to the source\n  return this.snapPoints_.reduce(function(prev, curr) {\n    var currDiff = Math.abs(goog.math.angleDifference(curr, val));\n    var prevDiff = Math.abs(goog.math.angleDifference(prev, val));\n    return currDiff < prevDiff ? curr : prev;\n  });\n};\n\nBlockly.AngleHelper.prototype.dispose = function() {\n  if (this.mouseDownWrapper_) {\n    Blockly.unbindEvent_(this.mouseDownWrapper_);\n    this.mouseDownWrapper_ = null;\n  }\n  if (this.mouseUpWrapper_) {\n    Blockly.unbindEvent_(this.mouseUpWrapper_);\n    this.mouseUpWrapper_ = null;\n  }\n  if (this.mouseMoveWrapper_) {\n    Blockly.unbindEvent_(this.mouseMoveWrapper_);\n    this.mouseMoveWrapper_ = null;\n  }\n  goog.dom.removeNode(this.svg_);\n  this.arc_ = null;\n  this.circle_ = null;\n  this.svg_ = null;\n  this.variableLine_ = null;\n};\n\n/**\n * Create an SVG path string describing the given arc\n * @param {goog.math.Vec2} center\n * @param {number} radius\n * @param {number} startAngle\n * @param {number} endAngle\n * @return {String} path\n */\nBlockly.AngleHelper.describeArc = function(center, radius, startAngle, endAngle) {\n  var vector = center.clone().add(new goog.math.Vec2(radius, 0));\n  var start = goog.math.Vec2.rotateAroundPoint(vector, center, goog.math.toRadians(startAngle));\n  var end = goog.math.Vec2.rotateAroundPoint(vector, center, goog.math.toRadians(endAngle));\n\n  // largeArcFlag should be set if the angle to be drawn is greater than\n  // 180 degrees; it determines which \"direction\" the arc travels around\n  // the circle.\n  var largeArcFlag = Math.abs(startAngle - endAngle) > 180 ? '1' : '0';\n\n  // Sweep flag determines if the if the arc is moving at \"positive\"\n  // angles or \"negative\" ones.\n  var sweepFlag = endAngle - startAngle < 0 ? '0' : '1';\n\n  var d = [\n    'M', start.x.toFixed(2), start.y.toFixed(2),\n    'A', radius, radius, 0, largeArcFlag, sweepFlag, end.x.toFixed(2), end.y.toFixed(2)\n  ].join(' ');\n\n  return d;\n}\n","'use strict';\n\ngoog.provide('Blockly.BlockFieldHelper');\n\n/**\n * @enum {string}\n */\nBlockly.BlockFieldHelper = {\n  ANGLE_HELPER: 'Angle Helper'\n};\n\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Text input field.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.FieldTextInput');\n\ngoog.require('Blockly.Field');\ngoog.require('Blockly.AngleHelper');\ngoog.require('Blockly.BlockFieldHelper');\ngoog.require('Blockly.Msg');\ngoog.require('goog.asserts');\ngoog.require('goog.userAgent');\n\n\n/**\n * Class for an editable text field.\n * @param {string} text The initial content of the field.\n * @param {Function} opt_changeHandler An optional function that is called\n *     to validate any constraints on what the user entered.  Takes the new\n *     text as an argument and returns the accepted text or null to abort\n *     the change.\n * @extends {Blockly.Field}\n * @constructor\n */\nBlockly.FieldTextInput = function(text, opt_changeHandler) {\n  Blockly.FieldTextInput.superClass_.constructor.call(this, text);\n\n  this.changeHandler_ = opt_changeHandler;\n  this.angleHelper = null;\n};\ngoog.inherits(Blockly.FieldTextInput, Blockly.Field);\n\n/**\n * Mouse cursor style when over the hotspot that initiates the editor.\n */\nBlockly.FieldTextInput.prototype.CURSOR = 'text';\n\nBlockly.FieldTextInput.ANGLE_HELPER_SIZE = 150;\n\n/**\n * Close the input widget if this input is being deleted.\n */\nBlockly.FieldTextInput.prototype.dispose = function() {\n  if (this.angleHelper) {\n    this.angleHelper.dispose();\n  }\n\n  Blockly.WidgetDiv.hideIfOwner(this);\n  Blockly.FieldTextInput.superClass_.dispose.call(this);\n};\n\n/**\n * Set the text in this field.\n * @param {?string} text New text.\n * @override\n */\nBlockly.FieldTextInput.prototype.setText = function(text) {\n  if (text === null) {\n    // No change if null.\n    return;\n  }\n  if (this.changeHandler_) {\n    var validated = this.changeHandler_(text);\n    // If the new text is invalid, validation returns null.\n    // In this case we still want to display the illegal result.\n    if (validated !== null && validated !== undefined) {\n      text = validated;\n    }\n  }\n  Blockly.Field.prototype.setText.call(this, text);\n};\n\nBlockly.FieldTextInput.prototype.shouldShowAngleHelper_ = function() {\n  return this.getFieldHelperOptions_(Blockly.BlockFieldHelper.ANGLE_HELPER);\n};\n\nBlockly.FieldTextInput.prototype.getAngleHelperDirection_ = function() {\n  var options = this.getFieldHelperOptions_(Blockly.BlockFieldHelper.ANGLE_HELPER);\n\n  // direction can be set by specifying either direction or directionTitleName,\n  // but not both\n  if (options.direction && options.directionTitleName) {\n    throw 'FieldTextInput should not have both a direction and a directionTitleName; please pass at most one of these options';\n  }\n\n  if (options.directionTitle) {\n    return options.block.getTitleValue(options.directionTitle);\n  } else if (options.direction) {\n    return options.direction;\n  }\n\n  // Turn right (clockwise) by default.\n  return 'turnRight';\n};\n\nBlockly.FieldTextInput.prototype.showAngleHelper_ = function() {\n  var div = Blockly.WidgetDiv.DIV;\n  var container = goog.dom.createDom('div', 'blocklyFieldAngleTextInput');\n  container.style.height = Blockly.FieldTextInput.ANGLE_HELPER_SIZE + 'px';\n  container.style.width = Blockly.FieldTextInput.ANGLE_HELPER_SIZE + 'px';\n  div.appendChild(container);\n\n  var options = this.getFieldHelperOptions_(Blockly.BlockFieldHelper.ANGLE_HELPER);\n  var dir = this.getAngleHelperDirection_();\n  var colour = options.block.getHexColour();\n  this.angleHelper = new Blockly.AngleHelper(dir, {\n    onUpdate: function () {\n      var value = this.angleHelper.getAngle().toString();\n      this.setText(value);\n      Blockly.FieldTextInput.htmlInput_.value = value;\n    }.bind(this),\n    arcColour: colour,\n    height: Blockly.FieldTextInput.ANGLE_HELPER_SIZE,\n    width: Blockly.FieldTextInput.ANGLE_HELPER_SIZE,\n    angle: parseInt(this.getValue())\n  });\n\n  this.angleHelper.init(container);\n};\n\n/**\n * Show the inline free-text editor on top of the text.\n * @private\n */\nBlockly.FieldTextInput.prototype.showEditor_ = function() {\n  this.showWidgetDiv_();\n  var div = Blockly.WidgetDiv.DIV;\n  // Create the input.\n  var htmlInput = goog.dom.createDom('input', 'blocklyHtmlInput');\n  if (this.changeHandler_ === Blockly.FieldTextInput.numberValidator) {\n    htmlInput.setAttribute('type', 'number');\n    htmlInput.setAttribute('step', 'any');\n  } else if (this.changeHandler_ === Blockly.FieldTextInput.nonnegativeIntegerValidator) {\n    htmlInput.setAttribute('type', 'number');\n    // Trigger the numeric keyboard on iOS.\n    htmlInput.setAttribute('pattern', '\\\\d*');\n  }\n  Blockly.FieldTextInput.htmlInput_ = htmlInput;\n  div.appendChild(htmlInput);\n\n  htmlInput.value = htmlInput.defaultValue = this.text_;\n  htmlInput.oldValue_ = null;\n  this.validate_();\n  this.resizeEditor_();\n  htmlInput.focus();\n  if (goog.userAgent.IPAD || goog.userAgent.IPHONE) {\n    // input.select() does't work on mobile safari.\n    htmlInput.setSelectionRange(0, 9999);\n  } else {\n    htmlInput.select();\n  }\n\n  // Bind to keydown -- prevent Delete from removing the block in iOS.\n  htmlInput.onKeyUpWrapper_ =\n      Blockly.bindEvent_(htmlInput, 'keydown', this, function(e) {\n        e.stopPropagation();\n      });\n  // Bind to keyup -- trap Enter and Esc; resize after every keystroke.\n  htmlInput.onKeyUpWrapper_ =\n      Blockly.bindEvent_(htmlInput, 'keyup', this, this.onHtmlInputChange_);\n  // Bind to keyPress -- repeatedly resize when holding down a key.\n  htmlInput.onKeyPressWrapper_ =\n      Blockly.bindEvent_(htmlInput, 'keypress', this, this.onHtmlInputChange_);\n  var blockSpaceSvg = this.sourceBlock_.blockSpace.getCanvas();\n  htmlInput.onBlockSpaceChangeWrapper_ =\n      Blockly.bindEvent_(blockSpaceSvg, 'blocklyBlockSpaceChange', this,\n      this.resizeEditor_);\n\n  if (this.shouldShowAngleHelper_()) {\n    this.showAngleHelper_();\n  }\n};\n\n/**\n * Handle a change to the editor.\n * @param {!Event} e Keyboard event.\n * @private\n */\nBlockly.FieldTextInput.prototype.onHtmlInputChange_ = function(e) {\n  var htmlInput = Blockly.FieldTextInput.htmlInput_;\n  if (e.keyCode == 13) {\n    // Enter\n    Blockly.WidgetDiv.hide();\n    // In IE9 (for some reason) the run button is getting focus at some point\n    // after this, and then handling the enter event it thinks it got. Instead\n    // let's prevent default so that this doesn't happen.\n    e.preventDefault();\n  } else if (e.keyCode == 27) {\n    // Esc\n    this.setText(htmlInput.defaultValue);\n    Blockly.WidgetDiv.hide();\n  } else {\n    // Update source block.\n    var text = htmlInput.value;\n    if (text !== htmlInput.oldValue_) {\n      htmlInput.oldValue_ = text;\n      this.setText(text);\n      this.validate_();\n    } else if (goog.userAgent.WEBKIT) {\n      // Cursor key.  Render the source block to show the caret moving.\n      // Chrome only (version 26, OS X).\n      this.sourceBlock_.render();\n    }\n  }\n\n  if (this.angleHelper) {\n    this.angleHelper.animateAngleChange(parseInt(this.getText()));\n  }\n};\n\n/**\n * Check to see if the contents of the editor validates.\n * Style the editor accordingly.\n * @private\n */\nBlockly.FieldTextInput.prototype.validate_ = function() {\n  var valid = true;\n  goog.asserts.assertObject(Blockly.FieldTextInput.htmlInput_);\n  var htmlInput = /** @type {!Element} */ (Blockly.FieldTextInput.htmlInput_);\n  if (this.changeHandler_) {\n    valid = this.changeHandler_(htmlInput.value);\n  }\n  if (valid === null) {\n    Blockly.addClass_(htmlInput, 'blocklyInvalidInput');\n  } else {\n    Blockly.removeClass_(htmlInput, 'blocklyInvalidInput');\n  }\n};\n\n/**\n * Resize the editor and the underlying block to fit the text.\n * @private\n */\nBlockly.FieldTextInput.prototype.resizeEditor_ = function() {\n  var div = Blockly.WidgetDiv.DIV;\n  if (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0) {\n      this.fieldGroup_.style.display = \"inline\";   /* reqd for IE */\n      var bBox = {\n          x: this.fieldGroup_.getBBox().x,\n          y: this.fieldGroup_.getBBox().y,\n          width: this.fieldGroup_.scrollWidth,\n          height: this.fieldGroup_.scrollHeight\n      };\n  }\n  else {\n      var bBox = this.fieldGroup_.getBBox();\n  }\n  div.style.width = bBox.width + 'px';\n  this.positionWidgetDiv();\n};\n\n/**\n * @override\n */\nBlockly.FieldTextInput.prototype.positionWidgetDiv = function() {\n  var xy = Blockly.getAbsoluteXY_(/** @type {!Element} */ (this.borderRect_), this.getRootSVGElement_());\n  // In RTL mode block titles and LTR input titles the left edge moves,\n  // whereas the right edge is fixed.  Reposition the editor.\n  if (Blockly.RTL) {\n      if (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0) {\n          this.borderRect_.style.display = \"inline\";   /* reqd for IE */\n          var borderBBox = {\n              x: this.borderRect_.getBBox().x,\n              y: this.borderRect_.getBBox().y,\n              width: this.borderRect_.scrollWidth,\n              height: this.borderRect_.scrollHeight\n          };\n      }\n      else {\n          var borderBBox = this.borderRect_.getBBox();\n      }\n    xy.x += borderBBox.width;\n    xy.x -= Blockly.WidgetDiv.DIV.offsetWidth;\n  }\n  // Shift by a few pixels to line up exactly.\n  xy.y += 1;\n  if (goog.userAgent.WEBKIT) {\n    xy.y -= 3;\n  }\n\n  var windowSize = goog.dom.getViewportSize();\n  var scrollOffset = goog.style.getViewportPageOffset(document);\n  Blockly.WidgetDiv.position(xy.x, xy.y, windowSize, scrollOffset);\n};\n\n/**\n * Close the editor, save the results, and dispose of the editable\n * text field's elements.\n * @override\n */\nBlockly.FieldTextInput.prototype.generateWidgetDisposeHandler_ = function() {\n  var superWidgetDisposeHandler_ = Blockly.FieldRectangularDropdown.superClass_.generateWidgetDisposeHandler_.call(this);\n  return function() {\n    superWidgetDisposeHandler_();\n    var htmlInput = Blockly.FieldTextInput.htmlInput_;\n    // Save the edit (if it validates).\n    var text = htmlInput.value;\n    if (this.changeHandler_) {\n      text = this.changeHandler_(text);\n      if (text === null) {\n        // Invalid edit.\n        text = htmlInput.defaultValue;\n      }\n    }\n    this.setText(text);\n    this.sourceBlock_.rendered && this.sourceBlock_.render();\n    Blockly.unbindEvent_(htmlInput.onKeyUpWrapper_);\n    Blockly.unbindEvent_(htmlInput.onKeyPressWrapper_);\n    Blockly.unbindEvent_(htmlInput.onBlockSpaceChangeWrapper_);\n    Blockly.FieldTextInput.htmlInput_ = null;\n    // Delete the width property.\n    Blockly.WidgetDiv.DIV.style.width = 'auto';\n  }.bind(this);\n};\n\n/**\n *  @override\n */\nBlockly.FieldTextInput.prototype.isKeyboardInputField_ = function() {\n  return true;\n};\n\n/**\n * Ensure that only a number may be entered.\n * @param {string} text The user's text.\n * @return {?string} A string representing a valid number, or null if invalid.\n *   Returns 0 for null or empty string.\n */\nBlockly.FieldTextInput.numberValidator = function(text) {\n  text = text || \"\";\n  // TODO: Handle cases like 'ten', '1.203,14', etc.\n  // 'O' is sometimes mistaken for '0' by inexperienced users.\n  text = text.replace(/O/ig, '0');\n  // Strip out thousands separators.\n  text = text.replace(/,/g, '');\n  var n = parseFloat(text || 0);\n  return isNaN(n) ? null : String(n);\n};\n\n/**\n * Ensure that only a nonnegative integer may be entered.\n * @param {string} text The user's text.\n * @return {?string} A string representing a valid int, or null if invalid.\n */\nBlockly.FieldTextInput.nonnegativeIntegerValidator = function(text) {\n  var n = Blockly.FieldTextInput.numberValidator(text);\n  if (n) {\n    n = String(Math.max(0, Math.floor(n)));\n  }\n  return n;\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2013 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Angle input field.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.FieldAngle');\n\ngoog.require('Blockly.FieldTextInput');\n\n\n/**\n * Class for an editable angle field.\n * @param {string} text The initial content of the field.\n * @param {Function} opt_changeHandler An optional function that is called\n *     to validate any constraints on what the user entered.  Takes the new\n *     text as an argument and returns the accepted text or null to abort\n *     the change.\n * @extends {Blockly.Field}\n * @constructor\n */\nBlockly.FieldAngle = function(text, opt_changeHandler) {\n  var changeHandler;\n  if (opt_changeHandler) {\n    // Wrap the user's change handler together with the angle validator.\n    var thisObj = this;\n    changeHandler = function(value) {\n      value = Blockly.FieldAngle.angleValidator.call(thisObj, value);\n      if (value !== null) {\n        opt_changeHandler.call(thisObj, value);\n      }\n      return value;\n    };\n  } else {\n    changeHandler = Blockly.FieldAngle.angleValidator;\n  }\n\n  // Add degree symbol: \"360\" (LTR) or \"360\" (RTL)\n  this.symbol_ = Blockly.createSvgElement('tspan', {}, null);\n  this.symbol_.appendChild(document.createTextNode('\\u00B0'));\n\n  Blockly.FieldAngle.superClass_.constructor.call(this,\n      text, changeHandler);\n};\ngoog.inherits(Blockly.FieldAngle, Blockly.FieldTextInput);\n\n/**\n * Half the width of protractor image.\n */\nBlockly.FieldAngle.HALF = 100 / 2;\n\n/**\n * Radius of protractor circle.  Slightly smaller than protractor size since\n * otherwise SVG crops off half the border at the edges.\n */\nBlockly.FieldAngle.RADIUS = Blockly.FieldAngle.HALF - 1;\n\n/**\n * Clean up this FieldAngle, as well as the inherited FieldTextInput.\n * @return {!Function} Closure to call on destruction of the WidgetDiv.\n * @private\n */\nBlockly.FieldAngle.prototype.dispose_ = function() {\n  var thisField = this;\n  return function() {\n    Blockly.FieldAngle.superClass_.dispose_.call(thisField)();\n    thisField.gauge_ = null;\n    if (thisField.clickWrapper_) {\n      Blockly.unbindEvent_(thisField.clickWrapper_);\n    }\n    if (thisField.moveWrapper1_) {\n      Blockly.unbindEvent_(thisField.moveWrapper1_);\n    }\n    if (thisField.moveWrapper2_) {\n      Blockly.unbindEvent_(thisField.moveWrapper2_);\n    }\n  };\n};\n\n/**\n * Show the inline free-text editor on top of the text.\n * @private\n */\nBlockly.FieldAngle.prototype.showEditor_ = function() {\n  Blockly.FieldAngle.superClass_.showEditor_.call(this);\n  var div = Blockly.WidgetDiv.DIV;\n  if (!div.firstChild) {\n    // Mobile interface uses window.prompt.\n    return;\n  }\n  // Build the SVG DOM.\n  var svg = Blockly.createSvgElement('svg', {\n    'xmlns': 'http://www.w3.org/2000/svg',\n    'xmlns:html': 'http://www.w3.org/1999/xhtml',\n    'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n    'version': '1.1',\n    'height': (Blockly.FieldAngle.HALF * 2) + 'px',\n    'width': (Blockly.FieldAngle.HALF * 2) + 'px'\n  }, div);\n  var circle = Blockly.createSvgElement('circle', {\n    'cx': Blockly.FieldAngle.HALF, 'cy': Blockly.FieldAngle.HALF,\n    'r': Blockly.FieldAngle.RADIUS,\n    'class': 'blocklyAngleCircle'\n  }, svg);\n  this.gauge_ =\n      Blockly.createSvgElement('path', {'class': 'blocklyAngleGuage'}, svg);\n  // Draw markers around the edge.\n  for (var a = 0; a < 360; a += 15) {\n    Blockly.createSvgElement('line', {\n      'x1': Blockly.FieldAngle.HALF + Blockly.FieldAngle.RADIUS,\n      'y1': Blockly.FieldAngle.HALF,\n      'x2': Blockly.FieldAngle.HALF + Blockly.FieldAngle.RADIUS -\n          (a % 45 == 0 ? 10 : 5),\n      'y2': Blockly.FieldAngle.HALF,\n      'class': 'blocklyAngleMarks',\n      'transform': 'rotate(' + a + ', ' +\n          Blockly.FieldAngle.HALF + ', ' + Blockly.FieldAngle.HALF + ')'\n    }, svg);\n  }\n  svg.style.marginLeft = '-35px';\n  this.clickWrapper_ =\n      Blockly.bindEvent_(svg, 'click', this, Blockly.WidgetDiv.hide);\n  this.moveWrapper1_ =\n      Blockly.bindEvent_(circle, 'mousemove', this, this.onMouseMove);\n  this.moveWrapper2_ =\n      Blockly.bindEvent_(this.gauge_, 'mousemove', this, this.onMouseMove);\n  this.updateGraph();\n};\n\n/**\n * Set the angle to match the mouse's position.\n * @param {!Event} e Mouse move event.\n */\nBlockly.FieldAngle.prototype.onMouseMove = function(e) {\n  var bBox = this.gauge_.ownerSVGElement.getBoundingClientRect();\n  var dx = e.clientX - bBox.left - Blockly.FieldAngle.HALF;\n  var dy = e.clientY - bBox.top - Blockly.FieldAngle.HALF;\n  var angle = Math.atan(-dy / dx);\n  if (isNaN(angle)) {\n    // This shouldn't happen, but let's not let this error propogate further.\n    return;\n  }\n  angle = angle / Math.PI * 180;\n  // 0: East, 90: North, 180: West, 270: South.\n  if (dx < 0) {\n    angle += 180;\n  } else if (dy > 0) {\n    angle += 360;\n  }\n  angle = String(Math.round(angle));\n  Blockly.FieldTextInput.htmlInput_.value = angle;\n  this.setText(angle);\n};\n\n/**\n * Insert a degree symbol.\n * @param {?string} text New text.\n */\nBlockly.FieldAngle.prototype.setText = function(text) {\n  Blockly.FieldAngle.superClass_.setText.call(this, text);\n  this.updateGraph();\n  // Insert degree symbol.\n  if (Blockly.RTL) {\n    this.textElement_.insertBefore(this.symbol_, this.textElement_.firstChild);\n  } else {\n    this.textElement_.appendChild(this.symbol_);\n  }\n  // Cached width is obsolete.  Clear it.\n  this.size_.width = 0;\n};\n\n/**\n * Ensure that only an angle may be entered.\n * @param {string} text The user's text.\n * @return {?string} A string representing a valid angle, or null if invalid.\n */\nBlockly.FieldAngle.prototype.updateGraph = function() {\n  if (this.gauge_) {\n    var angleRadians = Number(this.getText()) / 180 * Math.PI;\n    if (isNaN(angleRadians)) {\n      this.gauge_.setAttribute('d',\n          'M ' + Blockly.FieldAngle.HALF + ', ' + Blockly.FieldAngle.HALF);\n    } else {\n      var x = Blockly.FieldAngle.HALF + Math.cos(angleRadians) *\n          Blockly.FieldAngle.RADIUS;\n      var y = Blockly.FieldAngle.HALF + Math.sin(angleRadians) *\n          -Blockly.FieldAngle.RADIUS;\n      var largeFlag = (angleRadians > Math.PI) ? 1 : 0;\n      this.gauge_.setAttribute('d',\n          'M ' + Blockly.FieldAngle.HALF + ', ' + Blockly.FieldAngle.HALF +\n          ' h ' + Blockly.FieldAngle.RADIUS +\n          ' A ' + Blockly.FieldAngle.RADIUS + ',' + Blockly.FieldAngle.RADIUS +\n          ' 0 ' + largeFlag + ' 0 ' + x + ',' + y + ' z');\n    }\n  }\n};\n\n/**\n * Ensure that only an angle may be entered.\n * @param {string} text The user's text.\n * @return {?string} A string representing a valid angle, or null if invalid.\n */\nBlockly.FieldAngle.angleValidator = function(text) {\n  var n = Blockly.FieldTextInput.numberValidator(text);\n  if (n !== null) {\n    n = n % 360;\n    if (n < 0) {\n      n += 360;\n    }\n    n = String(n);\n   }\n  return n;\n};\n","'use strict';\n\ngoog.provide('Blockly.FieldButton');\n\ngoog.require('Blockly.Field');\n\nvar CORNER_RADIUS = 3;\nvar INNER_HEIGHT = 17;\nvar Y_OFFSET = -13;\n\n/**\n * Class for a button field.\n * @param {string} value The initial value of the field.\n * @param {Function} opt_buttonHandler A function that is executed when the button\n *   is clicked. It should eventually call FieldButton.setValue() to update the\n *   field value.\n * @param {string} opt_color fill color\n * @param {Function} opt_changeHandler A function that is executed when the\n *   value is changed\n * @extends {Blockly.Field}\n * @constructor\n */\nBlockly.FieldButton = function(title, opt_buttonHandler, opt_color, opt_changeHandler) {\n  Blockly.FieldButton.superClass_.constructor.call(this, '');\n\n  this.changeHandler_ = opt_changeHandler;\n  this.buttonHandler_ = opt_buttonHandler;\n\n  this.borderRect_.setAttribute('height', INNER_HEIGHT + 2);\n  this.borderRect_.setAttribute('y', Y_OFFSET - 1);\n  this.buttonElement_ = Blockly.createSvgElement('rect',\n      {\n        rx: CORNER_RADIUS,\n        ry: CORNER_RADIUS,\n        x: (-Blockly.BlockSvg.SEP_SPACE_X / 2) + 1,\n        y: Y_OFFSET,\n        height: INNER_HEIGHT,\n      },\n      this.fieldGroup_\n  );\n  this.buttonElement_.style.fillOpacity = 1;\n  this.buttonElement_.style.fill = opt_color;\n  this.fieldGroup_.insertBefore(this.buttonElement_, this.textElement_);\n\n  this.textElement_.style.fontSize = '11pt';\n  this.textElement_.style.fill = 'white';\n  if (goog.isString(title)) {\n    this.setText(title);\n  } else {\n    this.textElement_.textContent = '';\n    this.textElement_.appendChild(title);\n  }\n};\ngoog.inherits(Blockly.FieldButton, Blockly.Field);\n\n/**\n * Mouse cursor style when over the hotspot that initiates clickability.\n */\nBlockly.FieldButton.prototype.CURSOR = 'pointer';\n\n/**\n * @return {string} Current value\n */\nBlockly.FieldButton.prototype.getValue = function() {\n  return String(this.value_);\n};\n\n/**\n * Set the value\n * @param {string} value New value.\n */\nBlockly.FieldButton.prototype.setValue = function(value) {\n  if (this.value_ !== value) {\n    if (this.changeHandler_) {\n      // Call any change handler, and allow it to override.\n      var override = this.changeHandler_(value);\n      if (override !== undefined) {\n        value = override;\n      }\n    }\n    this.value_ = value;\n    if (this.sourceBlock_ && this.sourceBlock_.rendered) {\n      this.sourceBlock_.blockSpace.fireChangeEvent();\n    }\n  }\n};\n\n/**\n * Call the button handler when clicked\n * @private\n */\nBlockly.FieldButton.prototype.showEditor_ = function() {\n  if (!this.buttonHandler_) {\n    return;\n  }\n  this.buttonHandler_(this.setValue.bind(this));\n};\n\n/**\n * Draws the border with the correct width.\n * Saves the computed width in a property.\n * @private\n */\nBlockly.FieldButton.prototype.updateWidth_ = function() {\n  Blockly.FieldButton.superClass_.updateWidth_.call(this);\n  if (this.buttonElement_) {\n    this.buttonElement_.setAttribute('width', this.size_.width + Blockly.BlockSvg.SEP_SPACE_X - 2);\n  }\n};\n\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Base class for a dropdown input field.\n */\n'use strict';\n\ngoog.provide('Blockly.FieldRectangularDropdown');\ngoog.require('Blockly.Field');\ngoog.require('Blockly.FieldImage');\ngoog.require('Blockly.ImageDimensionCache');\n\n/**\n * Class for a rectangular dropdown field.\n * @param {!Array.<string>} choices An array of choices for a dropdown list, each choice is a\n *                                  tuple of [image location, value]\n * @extends {Blockly.Field}\n * @constructor\n */\nBlockly.FieldRectangularDropdown = function(choices) {\n  this.choices_ = choices;\n  var firstTuple = this.choices_[0];\n  this.value_ = firstTuple[Blockly.FieldRectangularDropdown.TUPLE_VALUE_INDEX];\n  var firstPreviewData = firstTuple[Blockly.FieldRectangularDropdown.TUPLE_PREVIEW_DATA_INDEX];\n\n  this.size_ = {width: Blockly.FieldImage.IMAGE_LOADING_WIDTH, height: Blockly.FieldImage.IMAGE_LOADING_HEIGHT};\n  this.buildDOMElements_();\n  this.updatePreviewData_(firstPreviewData);\n};\ngoog.inherits(Blockly.FieldRectangularDropdown, Blockly.Field);\n\nBlockly.FieldRectangularDropdown.TUPLE_PREVIEW_DATA_INDEX = 0;\nBlockly.FieldRectangularDropdown.TUPLE_VALUE_INDEX = 1;\nBlockly.FieldRectangularDropdown.BORDER_MARGIN = 2;\nBlockly.FieldRectangularDropdown.DROPDOWN_MENU_BORDER = 2;\nBlockly.FieldRectangularDropdown.MENU_CSS_CLASS = 'blocklyRectangularDropdownMenu';\nBlockly.FieldRectangularDropdown.BORDER_OFFSET_X = -Blockly.FieldRectangularDropdown.BORDER_MARGIN;\nBlockly.FieldRectangularDropdown.BORDER_OFFSET_Y = Blockly.FieldImage.IMAGE_OFFSET_Y - Blockly.FieldRectangularDropdown.BORDER_MARGIN;\nBlockly.FieldRectangularDropdown.BORDER_RECTANGLE_RADIUS = 4;\nBlockly.FieldRectangularDropdown.BORDER_EXTRA_ARROW_WIDTH = 30;\nBlockly.FieldRectangularDropdown.DROPDOWN_ARROW_WIDTH = 20;\nBlockly.FieldRectangularDropdown.DROPDOWN_ARROW_HEIGHT = 23;\nBlockly.FieldRectangularDropdown.DROPDOWN_ARROW_X_OFFSET_FROM_PREVIEW_RIGHT =\n  Blockly.FieldRectangularDropdown.BORDER_EXTRA_ARROW_WIDTH / 2 -\n  Blockly.FieldRectangularDropdown.DROPDOWN_ARROW_WIDTH / 2;\nBlockly.FieldRectangularDropdown.DROPDOWN_ARROW_Y_OFFSET_FROM_PREVIEW_MIDDLE =\n  -Blockly.FieldRectangularDropdown.DROPDOWN_ARROW_HEIGHT / 2 - 4;\nBlockly.FieldRectangularDropdown.CHECKMARK_OVERHANG = 0; // Horizontal distance that a selection menu checkmark overhangs the dropdown.\nBlockly.FieldRectangularDropdown.DOWN_ARROW_CHARACTER = '\\u25BC'; // \nBlockly.FieldRectangularDropdown.UP_ARROW_CHARACTER = '\\u25B2';\nBlockly.FieldRectangularDropdown.prototype.CURSOR = 'default';\nBlockly.FieldRectangularDropdown.prototype.EDITABLE = true;\n\nBlockly.FieldRectangularDropdown.prototype.getOptions = function() {\n  return this.choices_;\n};\n\nBlockly.FieldRectangularDropdown.prototype.buildDOMElements_ = function() {\n  this.fieldGroup_ = Blockly.createSvgElement('g', {}, null);\n  this.dropdownBorderRectElement_ = Blockly.createSvgElement('rect',\n    {'rx': Blockly.FieldRectangularDropdown.BORDER_RECTANGLE_RADIUS,\n      'ry': Blockly.FieldRectangularDropdown.BORDER_RECTANGLE_RADIUS,\n      'x': Blockly.FieldRectangularDropdown.BORDER_OFFSET_X,\n      'y': Blockly.FieldRectangularDropdown.BORDER_OFFSET_Y,\n      'height': Blockly.FieldImage.IMAGE_LOADING_HEIGHT,\n      'class': 'fieldRectangularDropdownBackdrop'\n    }, this.fieldGroup_);\n  this.addPreviewElementTo_(this.fieldGroup_);\n  this.createDropdownArrow_();\n  this.clickRectElement_ = Blockly.createSvgElement('rect',\n    {'height': Blockly.FieldImage.IMAGE_LOADING_HEIGHT + 'px',\n      'width': Blockly.FieldImage.IMAGE_LOADING_WIDTH + 'px',\n      'y': Blockly.FieldImage.IMAGE_OFFSET_Y,\n      'fill-opacity': 0}, this.fieldGroup_);\n};\n\nBlockly.FieldRectangularDropdown.prototype.addPreviewElementTo_ = function () {\n  throw Error(\"FieldRectangularDropdown.prototype.addPreviewElementTo_ not implemented\");\n};\n\nBlockly.FieldRectangularDropdown.prototype.createDropdownArrow_ = function () {\n  this.dropdownArrowText_ = Blockly.createSvgElement('text',\n    {'class': 'blocklyText'}, this.fieldGroup_);\n  this.arrowCharacter_ = Blockly.createSvgElement('tspan',\n    {'class': 'blocklyArrow blocklyRectangularDropdownArrow'}, this.dropdownArrowText_);\n  this.arrowCharacter_.appendChild(document.createTextNode(Blockly.FieldRectangularDropdown.DOWN_ARROW_CHARACTER));\n};\n\nBlockly.FieldRectangularDropdown.prototype.updatePreviewData_ = function(previewData) {\n  throw Error(\"FieldRectangularDropdown.prototype.updatePreviewData_ not implemented\");\n};\n\n/**\n * Updates widget component dimensions based on new preview rectangle width and height\n * @param previewRectangleWidth\n * @param previewRectangleHeight\n * @private\n */\nBlockly.FieldRectangularDropdown.prototype.updateDimensions_ = function(previewRectangleWidth, previewRectangleHeight) {\n  this.previewSize_ = {width: previewRectangleWidth, height: previewRectangleHeight};\n  var borderHeight = previewRectangleHeight + 2 * Blockly.FieldRectangularDropdown.BORDER_MARGIN;\n  var borderWidth = previewRectangleWidth +\n    2 * Blockly.FieldRectangularDropdown.BORDER_MARGIN +\n    Blockly.FieldRectangularDropdown.BORDER_EXTRA_ARROW_WIDTH;\n  this.updatePreviewDimensions_(previewRectangleWidth, previewRectangleHeight);\n  this.clickRectElement_.setAttribute('width', borderWidth + 'px');\n  this.clickRectElement_.setAttribute('height', borderHeight + 'px');\n  this.dropdownBorderRectElement_.setAttribute('width', borderWidth + 'px');\n  this.dropdownBorderRectElement_.setAttribute('height', borderHeight + 'px');\n  var previewMiddle = previewRectangleHeight / 2 - Blockly.FieldImage.IMAGE_OFFSET_Y;\n  this.dropdownArrowText_.setAttribute('x', previewRectangleWidth + Blockly.FieldRectangularDropdown.DROPDOWN_ARROW_X_OFFSET_FROM_PREVIEW_RIGHT);\n  this.dropdownArrowText_.setAttribute('y', previewMiddle + Blockly.FieldRectangularDropdown.DROPDOWN_ARROW_Y_OFFSET_FROM_PREVIEW_MIDDLE );\n  this.size_ = {height: borderHeight + Blockly.FieldImage.BELOW_IMAGE_PADDING, width: borderWidth};\n  this.refreshRender();\n};\n\nBlockly.FieldRectangularDropdown.prototype.updatePreviewDimensions_ = function(previewWidth, previewHeight) {\n  throw Error(\"FieldRectangularDropdown.prototype.updatePreviewDimensions_ not implemented\");\n};\n\n/**\n * Creates a preview element suitable for display within a goog.ui.MenuItem\n * @param previewData\n * @returns {HTMLElement}\n * @private\n */\nBlockly.FieldRectangularDropdown.prototype.createDropdownPreviewElement_ = function(previewData) {\n  throw Error(\"FieldRectangularDropdown.prototype.updatePreviewDimensions_ not implemented\");\n};\n\nBlockly.FieldRectangularDropdown.prototype.pointArrowUp_ = function() {\n  this.setArrowDirection_(true);\n};\n\nBlockly.FieldRectangularDropdown.prototype.pointArrowDown_ = function() {\n  this.setArrowDirection_(false);\n};\n\nBlockly.FieldRectangularDropdown.prototype.setArrowDirection_ = function(up) {\n  this.arrowCharacter_.firstChild.nodeValue = up ? Blockly.FieldRectangularDropdown.UP_ARROW_CHARACTER : Blockly.FieldRectangularDropdown.DOWN_ARROW_CHARACTER;\n};\n\nBlockly.FieldRectangularDropdown.prototype.showMenu_ = function() {\n  this.showWidgetDiv_();\n  this.menu_ = this.createMenuWithChoices_(this.choices_);\n  goog.events.listen(this.menu_, goog.ui.Component.EventType.ACTION, this.generateMenuItemSelectedHandler_());\n  this.addPositionAndShowMenu(this.menu_);\n  this.pointArrowUp_();\n};\n\nBlockly.FieldRectangularDropdown.prototype.hideMenu_ = function() {\n  this.pointArrowDown_();\n};\n\nBlockly.FieldRectangularDropdown.prototype.menuAlreadyShowing_ = function() {\n  return (\n    this.menu_ &&\n    Blockly.WidgetDiv.isOwner(this) &&\n    Blockly.WidgetDiv.isVisible()\n  );\n};\n\nBlockly.FieldRectangularDropdown.prototype.createMenuWithChoices_ = function(choices) {\n  var menu = new goog.ui.Menu();\n  for (var x = 0; x < choices.length; x++) {\n    var previewData = choices[x][Blockly.FieldRectangularDropdown.TUPLE_PREVIEW_DATA_INDEX];\n    var value = choices[x][Blockly.FieldRectangularDropdown.TUPLE_VALUE_INDEX];\n    var isCurrentSelection = (value === this.value_);\n    var dropdownPreviewElement = this.createDropdownPreviewElement_(previewData);\n    var menuItem = new goog.ui.MenuItem(dropdownPreviewElement);\n    menuItem.setValue(value);\n    var singleColumnLayout = chooseNumberOfColumns(choices.length) === 1;\n    if (isCurrentSelection && singleColumnLayout) {\n      menu.addItemAt(menuItem, 0);\n    } else {\n      menu.addItem(menuItem);\n    }\n  }\n  return menu;\n};\n\nfunction chooseNumberOfColumns(numItems) {\n  if (numItems <= 7)  {\n    return 1;\n  }\n  return Math.floor(Math.sqrt(numItems));\n};\n\nBlockly.FieldRectangularDropdown.prototype.generateMenuItemSelectedHandler_ = function() {\n  var fieldRectanglularDropdown = this;\n  return function(googMenuElement) {\n    var menuItem = googMenuElement.target;\n    if (menuItem) {\n      var value = menuItem.getValue();\n      if (value !== null) {\n        fieldRectanglularDropdown.setValue(value);\n      }\n    }\n    Blockly.WidgetDiv.hideIfOwner(fieldRectanglularDropdown);\n  };\n};\n\n/**\n * @override\n */\nBlockly.FieldRectangularDropdown.prototype.generateWidgetDisposeHandler_ = function () {\n  var superWidgetDisposeHandler_ = Blockly.FieldRectangularDropdown.superClass_.generateWidgetDisposeHandler_.call(this);\n  return function() {\n    superWidgetDisposeHandler_();\n    this.hideMenu_();\n  }.bind(this);\n};\n\nBlockly.FieldRectangularDropdown.prototype.addPositionAndShowMenu = function (menu) {\n  // Record windowSize and scrollOffset before adding menu.\n  var widgetDiv = Blockly.WidgetDiv.DIV;\n\n  // IE will scroll the bottom of the page into view to show this element\n  // before we move it, so hide it until we've repositioned.\n  widgetDiv.style.visibility = \"hidden\";\n  menu.render(widgetDiv);\n  menu.setAllowAutoFocus(true);\n  var menuDom = menu.getElement();\n  Blockly.addClass_(menuDom, 'blocklyDropdownMenu');\n  Blockly.addClass_(menuDom, Blockly.FieldRectangularDropdown.MENU_CSS_CLASS);\n  Blockly.addClass_(menuDom, 'goog-menu-noaccel');  // display menu items without shortcuts\n  var backdropColour = this.calculateBackdropColourWithoutAlpha_();\n  menuDom.style.borderColor = backdropColour;\n  menuDom.style.background = backdropColour;\n\n  var numberOfColumns = chooseNumberOfColumns(menu.getChildCount());\n  var multipleColumns = numberOfColumns > 1;\n  if (multipleColumns) {\n    var marginWidth = 4;\n    var widthPerMenuItem = this.previewSize_.width + marginWidth;\n    menuDom.style.width =\n      widthPerMenuItem * numberOfColumns // all items + their left margins\n      + marginWidth // right margin\n      + \"px\";\n    Blockly.addClass_(menuDom, 'blocklyGridDropdownMenu');\n  }\n\n  this.positionWidgetDiv();\n\n  widgetDiv.style.visibility = \"visible\";\n};\n\n/**\n * @override\n */\nBlockly.FieldRectangularDropdown.prototype.positionWidgetDiv = function () {\n  var size = goog.style.getSize(this.menu_.getElement());\n  var numberOfColumns = chooseNumberOfColumns(this.menu_.getChildCount());\n  var positionBelow = numberOfColumns > 1;\n\n  var menuPosition = this.calculateMenuPosition_(this.previewElement_, positionBelow);\n\n  var windowSize = goog.dom.getViewportSize();\n  \n  if(menuPosition.x + size.width > windowSize.width) {\n  \tmenuPosition.x -= size.width - (size.width / numberOfColumns);\n  }\n  if(menuPosition.y + size.height > windowSize.height) {\n  \tmenuPosition.y -= size.height + (size.height / Math.ceil(this.menu_.getChildCount() / numberOfColumns)); \n  }\n  \n  var scrollOffset = goog.style.getViewportPageOffset(document);\n\n  Blockly.WidgetDiv.position(menuPosition.x, menuPosition.y, windowSize, scrollOffset);\n};\n\n/**\n * Calculates position of menu\n * @param dropdownTargetElement\n * @param positionBelow (optional) whether to place the menu below the SVG preview element\n * @returns {{x: number, y: number}}\n * @private\n */\nBlockly.FieldRectangularDropdown.prototype.calculateMenuPosition_ = function (dropdownTargetElement, positionBelow) {\n  var previewTopLeft = Blockly.getAbsoluteXY_(dropdownTargetElement, this.getRootSVGElement_());\n  var menuTopLeft = {\n    x: previewTopLeft.x - Blockly.FieldRectangularDropdown.DROPDOWN_MENU_BORDER,\n    y: previewTopLeft.y - Blockly.FieldRectangularDropdown.DROPDOWN_MENU_BORDER\n  };\n  if (positionBelow) {\n    menuTopLeft.y += this.previewSize_.height + Blockly.FieldRectangularDropdown.DROPDOWN_MENU_BORDER;\n  }\n  return menuTopLeft;\n};\n\n/**\n * Get the language-neutral value from this dropdown menu.\n * @return {string} Current text.\n */\nBlockly.FieldRectangularDropdown.prototype.getValue = function() {\n  return this.value_;\n};\n\n/**\n * Set the language-neutral value for this dropdown menu.\n * @param {string} newValue New value to set.\n */\nBlockly.FieldRectangularDropdown.prototype.setValue = function(newValue) {\n  this.value_ = newValue;\n  this.refreshPreview_();\n};\n\nBlockly.FieldRectangularDropdown.prototype.refreshPreview_ = function() {\n  this.updatePreviewData_(this.getCurrentPreviewData_());\n};\n\nBlockly.FieldRectangularDropdown.prototype.getCurrentPreviewData_ = function() {\n  return this.getPreviewDataForValue_(this.value_);\n};\n\nBlockly.FieldRectangularDropdown.prototype.getPreviewDataForValue_ = function(value) {\n  var choices = this.choices_;\n  for (var x = 0; x < choices.length; x++) {\n    if (choices[x][Blockly.FieldRectangularDropdown.TUPLE_VALUE_INDEX] == value) {\n      return choices[x][Blockly.FieldRectangularDropdown.TUPLE_PREVIEW_DATA_INDEX];\n    }\n  }\n  throw 'Preview data for given value \"' + value + '\" not found';\n};\n\n/**\n * Install this field on a block\n *  * @param {!Blockly.Block} block The block containing this field.\n */\nBlockly.FieldRectangularDropdown.prototype.init = function(block) {\n  if (this.sourceBlock_) {\n    throw 'Field has already been initialized once.';\n  }\n  this.sourceBlock_ = block;\n  this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_);\n  this.mouseUpWrapper_ = Blockly.bindEvent_(this.getClickTarget(), 'mouseup', this, this.onMouseUp_);\n  this.mouseDownWrapper_ = Blockly.bindEvent_(this.getClickTarget(), 'mousedown', this, this.onMouseDown_);\n  this.updateDropdownArrowColour_();\n};\n\nBlockly.FieldRectangularDropdown.prototype.updateDropdownArrowColour_ = function () {\n  if (!this.sourceBlock_) {\n    throw 'Cannot update dropdown arrow colour before added to block';\n  }\n  // Match arrow colour to source block colour\n  this.arrowCharacter_.style.fill = this.sourceBlock_.getHexColour();\n};\n\nBlockly.FieldRectangularDropdown.prototype.dispose = function() {\n  Blockly.WidgetDiv.hideIfOwner(this);\n  if (this.mouseDownWrapper_) {\n    Blockly.unbindEvent_(this.mouseDownWrapper_);\n    this.mouseDownWrapper_ = null;\n  }\n  Blockly.FieldRectangularDropdown.superClass_.dispose.call(this);\n};\n\nBlockly.FieldRectangularDropdown.prototype.onMouseUp_ = function(e) {\n  if (this.doNotOpenEditorNextMouseUp_) {\n    this.doNotOpenEditorNextMouseUp_ = false;\n    return;\n  }\n\n  if (Blockly.isRightButton(e) ||\n      Blockly.Block.isFreelyDragging() ||\n      !this.sourceBlock_.isEditable()) {\n    return;\n  }\n\n  this.showMenu_();\n};\n\nBlockly.FieldRectangularDropdown.prototype.onMouseDown_ = function(e) {\n  if (this.menuAlreadyShowing_()) {\n    // Menu is being closed, don't re-open if they click the arrow\n    this.doNotOpenEditorNextMouseUp_ = true;\n  }\n};\n\nBlockly.FieldRectangularDropdown.prototype.getClickTarget = function() {\n  return this.clickRectElement_;\n};\n\nBlockly.FieldRectangularDropdown.prototype.sendClickRectToFront_ = function() {\n  this.fieldGroup_.appendChild(this.clickRectElement_);\n};\n\nBlockly.FieldRectangularDropdown.prototype.calculateBackdropColourWithoutAlpha_ = function() {\n  var blockColour = this.sourceBlock_.getHexColour();\n  var backdropOverlayColour = '#ffffff';\n  var backdropOverlayOpacity = 0.6; // Match this with .fieldRectangularDropdownBackdrop in core/css.js\n  return Blockly.mixColoursWithForegroundOpacity(backdropOverlayColour, blockColour, backdropOverlayOpacity);\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Checkbox field.  Checked or not checked.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.FieldCheckbox');\n\ngoog.require('Blockly.Field');\n\n\n/**\n * Class for a checkbox field.\n * @param {string} state The initial state of the field ('TRUE' or 'FALSE').\n * @param {Function} opt_changeHandler A function that is executed when a new\n *     option is selected.\n * @extends {Blockly.Field}\n * @constructor\n */\nBlockly.FieldCheckbox = function(state, opt_changeHandler) {\n  Blockly.FieldCheckbox.superClass_.constructor.call(this, '');\n\n  this.changeHandler_ = opt_changeHandler;\n  // The checkbox doesn't use the inherited text element.\n  // Instead it uses a custom checkmark element that is either visible or not.\n  this.checkElement_ = Blockly.createSvgElement('text',\n      {'class': 'blocklyText', 'x': -3}, this.fieldGroup_);\n  var textNode = document.createTextNode('\\u2713');\n  this.checkElement_.appendChild(textNode);\n  // Set the initial state.\n  this.setValue(state);\n};\ngoog.inherits(Blockly.FieldCheckbox, Blockly.Field);\n\n/**\n * Mouse cursor style when over the hotspot that initiates editability.\n */\nBlockly.FieldCheckbox.prototype.CURSOR = 'default';\n\n/**\n * Return 'TRUE' if the checkbox is checked, 'FALSE' otherwise.\n * @return {string} Current state.\n */\nBlockly.FieldCheckbox.prototype.getValue = function() {\n  return String(this.state_).toUpperCase();\n};\n\n/**\n * Set the checkbox to be checked if strBool is 'TRUE', unchecks otherwise.\n * @param {string} strBool New state.\n */\nBlockly.FieldCheckbox.prototype.setValue = function(strBool) {\n  var newState = (strBool == 'TRUE');\n  if (this.state_ !== newState) {\n    this.state_ = newState;\n    this.checkElement_.style.display = newState ? 'block' : 'none';\n    if (this.sourceBlock_ && this.sourceBlock_.rendered) {\n      this.sourceBlock_.blockSpace.fireChangeEvent();\n    }\n  }\n};\n\n/**\n * Toggle the state of the checkbox.\n * @private\n */\nBlockly.FieldCheckbox.prototype.showEditor_ = function() {\n  var newState = !this.state_;\n  if (this.changeHandler_) {\n    // Call any change handler, and allow it to override.\n    var override = this.changeHandler_(newState);\n    if (override !== undefined) {\n      newState = override;\n    }\n  }\n  if (newState !== null) {\n    this.setValue(String(newState).toUpperCase());\n  }\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Names of standard colors with their associated hex values.\n */\n\ngoog.provide('goog.color.names');\n\n\n/**\n * A map that contains a lot of colors that are recognised by various browsers.\n * This list is way larger than the minimal one dictated by W3C.\n * The keys of this map are the lowercase \"readable\" names of the colors, while\n * the values are the \"hex\" values.\n *\n * @type {!Object<string, string>}\n */\ngoog.color.names = {\n  'aliceblue': '#f0f8ff',\n  'antiquewhite': '#faebd7',\n  'aqua': '#00ffff',\n  'aquamarine': '#7fffd4',\n  'azure': '#f0ffff',\n  'beige': '#f5f5dc',\n  'bisque': '#ffe4c4',\n  'black': '#000000',\n  'blanchedalmond': '#ffebcd',\n  'blue': '#0000ff',\n  'blueviolet': '#8a2be2',\n  'brown': '#a52a2a',\n  'burlywood': '#deb887',\n  'cadetblue': '#5f9ea0',\n  'chartreuse': '#7fff00',\n  'chocolate': '#d2691e',\n  'coral': '#ff7f50',\n  'cornflowerblue': '#6495ed',\n  'cornsilk': '#fff8dc',\n  'crimson': '#dc143c',\n  'cyan': '#00ffff',\n  'darkblue': '#00008b',\n  'darkcyan': '#008b8b',\n  'darkgoldenrod': '#b8860b',\n  'darkgray': '#a9a9a9',\n  'darkgreen': '#006400',\n  'darkgrey': '#a9a9a9',\n  'darkkhaki': '#bdb76b',\n  'darkmagenta': '#8b008b',\n  'darkolivegreen': '#556b2f',\n  'darkorange': '#ff8c00',\n  'darkorchid': '#9932cc',\n  'darkred': '#8b0000',\n  'darksalmon': '#e9967a',\n  'darkseagreen': '#8fbc8f',\n  'darkslateblue': '#483d8b',\n  'darkslategray': '#2f4f4f',\n  'darkslategrey': '#2f4f4f',\n  'darkturquoise': '#00ced1',\n  'darkviolet': '#9400d3',\n  'deeppink': '#ff1493',\n  'deepskyblue': '#00bfff',\n  'dimgray': '#696969',\n  'dimgrey': '#696969',\n  'dodgerblue': '#1e90ff',\n  'firebrick': '#b22222',\n  'floralwhite': '#fffaf0',\n  'forestgreen': '#228b22',\n  'fuchsia': '#ff00ff',\n  'gainsboro': '#dcdcdc',\n  'ghostwhite': '#f8f8ff',\n  'gold': '#ffd700',\n  'goldenrod': '#daa520',\n  'gray': '#808080',\n  'green': '#008000',\n  'greenyellow': '#adff2f',\n  'grey': '#808080',\n  'honeydew': '#f0fff0',\n  'hotpink': '#ff69b4',\n  'indianred': '#cd5c5c',\n  'indigo': '#4b0082',\n  'ivory': '#fffff0',\n  'khaki': '#f0e68c',\n  'lavender': '#e6e6fa',\n  'lavenderblush': '#fff0f5',\n  'lawngreen': '#7cfc00',\n  'lemonchiffon': '#fffacd',\n  'lightblue': '#add8e6',\n  'lightcoral': '#f08080',\n  'lightcyan': '#e0ffff',\n  'lightgoldenrodyellow': '#fafad2',\n  'lightgray': '#d3d3d3',\n  'lightgreen': '#90ee90',\n  'lightgrey': '#d3d3d3',\n  'lightpink': '#ffb6c1',\n  'lightsalmon': '#ffa07a',\n  'lightseagreen': '#20b2aa',\n  'lightskyblue': '#87cefa',\n  'lightslategray': '#778899',\n  'lightslategrey': '#778899',\n  'lightsteelblue': '#b0c4de',\n  'lightyellow': '#ffffe0',\n  'lime': '#00ff00',\n  'limegreen': '#32cd32',\n  'linen': '#faf0e6',\n  'magenta': '#ff00ff',\n  'maroon': '#800000',\n  'mediumaquamarine': '#66cdaa',\n  'mediumblue': '#0000cd',\n  'mediumorchid': '#ba55d3',\n  'mediumpurple': '#9370db',\n  'mediumseagreen': '#3cb371',\n  'mediumslateblue': '#7b68ee',\n  'mediumspringgreen': '#00fa9a',\n  'mediumturquoise': '#48d1cc',\n  'mediumvioletred': '#c71585',\n  'midnightblue': '#191970',\n  'mintcream': '#f5fffa',\n  'mistyrose': '#ffe4e1',\n  'moccasin': '#ffe4b5',\n  'navajowhite': '#ffdead',\n  'navy': '#000080',\n  'oldlace': '#fdf5e6',\n  'olive': '#808000',\n  'olivedrab': '#6b8e23',\n  'orange': '#ffa500',\n  'orangered': '#ff4500',\n  'orchid': '#da70d6',\n  'palegoldenrod': '#eee8aa',\n  'palegreen': '#98fb98',\n  'paleturquoise': '#afeeee',\n  'palevioletred': '#db7093',\n  'papayawhip': '#ffefd5',\n  'peachpuff': '#ffdab9',\n  'peru': '#cd853f',\n  'pink': '#ffc0cb',\n  'plum': '#dda0dd',\n  'powderblue': '#b0e0e6',\n  'purple': '#800080',\n  'red': '#ff0000',\n  'rosybrown': '#bc8f8f',\n  'royalblue': '#4169e1',\n  'saddlebrown': '#8b4513',\n  'salmon': '#fa8072',\n  'sandybrown': '#f4a460',\n  'seagreen': '#2e8b57',\n  'seashell': '#fff5ee',\n  'sienna': '#a0522d',\n  'silver': '#c0c0c0',\n  'skyblue': '#87ceeb',\n  'slateblue': '#6a5acd',\n  'slategray': '#708090',\n  'slategrey': '#708090',\n  'snow': '#fffafa',\n  'springgreen': '#00ff7f',\n  'steelblue': '#4682b4',\n  'tan': '#d2b48c',\n  'teal': '#008080',\n  'thistle': '#d8bfd8',\n  'tomato': '#ff6347',\n  'turquoise': '#40e0d0',\n  'violet': '#ee82ee',\n  'wheat': '#f5deb3',\n  'white': '#ffffff',\n  'whitesmoke': '#f5f5f5',\n  'yellow': '#ffff00',\n  'yellowgreen': '#9acd32'\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities related to color and color conversion.\n */\n\ngoog.provide('goog.color');\ngoog.provide('goog.color.Hsl');\ngoog.provide('goog.color.Hsv');\ngoog.provide('goog.color.Rgb');\n\ngoog.require('goog.color.names');\ngoog.require('goog.math');\n\n\n/**\n * RGB color representation. An array containing three elements [r, g, b],\n * each an integer in [0, 255], representing the red, green, and blue components\n * of the color respectively.\n * @typedef {Array<number>}\n */\ngoog.color.Rgb;\n\n\n/**\n * HSV color representation. An array containing three elements [h, s, v]:\n * h (hue) must be an integer in [0, 360], cyclic.\n * s (saturation) must be a number in [0, 1].\n * v (value/brightness) must be an integer in [0, 255].\n * @typedef {Array<number>}\n */\ngoog.color.Hsv;\n\n\n/**\n * HSL color representation. An array containing three elements [h, s, l]:\n * h (hue) must be an integer in [0, 360], cyclic.\n * s (saturation) must be a number in [0, 1].\n * l (lightness) must be a number in [0, 1].\n * @typedef {Array<number>}\n */\ngoog.color.Hsl;\n\n\n/**\n * Parses a color out of a string.\n * @param {string} str Color in some format.\n * @return {{hex: string, type: string}} 'hex' is a string containing a hex\n *     representation of the color, 'type' is a string containing the type\n *     of color format passed in ('hex', 'rgb', 'named').\n */\ngoog.color.parse = function(str) {\n  var result = {};\n  str = String(str);\n\n  var maybeHex = goog.color.prependHashIfNecessaryHelper(str);\n  if (goog.color.isValidHexColor_(maybeHex)) {\n    result.hex = goog.color.normalizeHex(maybeHex);\n    result.type = 'hex';\n    return result;\n  } else {\n    var rgb = goog.color.isValidRgbColor_(str);\n    if (rgb.length) {\n      result.hex = goog.color.rgbArrayToHex(rgb);\n      result.type = 'rgb';\n      return result;\n    } else if (goog.color.names) {\n      var hex = goog.color.names[str.toLowerCase()];\n      if (hex) {\n        result.hex = hex;\n        result.type = 'named';\n        return result;\n      }\n    }\n  }\n  throw Error(str + ' is not a valid color string');\n};\n\n\n/**\n * Determines if the given string can be parsed as a color.\n *     {@see goog.color.parse}.\n * @param {string} str Potential color string.\n * @return {boolean} True if str is in a format that can be parsed to a color.\n */\ngoog.color.isValidColor = function(str) {\n  var maybeHex = goog.color.prependHashIfNecessaryHelper(str);\n  return !!(\n      goog.color.isValidHexColor_(maybeHex) ||\n      goog.color.isValidRgbColor_(str).length ||\n      goog.color.names && goog.color.names[str.toLowerCase()]);\n};\n\n\n/**\n * Parses red, green, blue components out of a valid rgb color string.\n * Throws Error if the color string is invalid.\n * @param {string} str RGB representation of a color.\n *    {@see goog.color.isValidRgbColor_}.\n * @return {!goog.color.Rgb} rgb representation of the color.\n */\ngoog.color.parseRgb = function(str) {\n  var rgb = goog.color.isValidRgbColor_(str);\n  if (!rgb.length) {\n    throw Error(str + ' is not a valid RGB color');\n  }\n  return rgb;\n};\n\n\n/**\n * Converts a hex representation of a color to RGB.\n * @param {string} hexColor Color to convert.\n * @return {string} string of the form 'rgb(R,G,B)' which can be used in\n *    styles.\n */\ngoog.color.hexToRgbStyle = function(hexColor) {\n  return goog.color.rgbStyle_(goog.color.hexToRgb(hexColor));\n};\n\n\n/**\n * Regular expression for extracting the digits in a hex color triplet.\n * @type {RegExp}\n * @private\n */\ngoog.color.hexTripletRe_ = /#(.)(.)(.)/;\n\n\n/**\n * Normalize an hex representation of a color\n * @param {string} hexColor an hex color string.\n * @return {string} hex color in the format '#rrggbb' with all lowercase\n *     literals.\n */\ngoog.color.normalizeHex = function(hexColor) {\n  if (!goog.color.isValidHexColor_(hexColor)) {\n    throw Error(\"'\" + hexColor + \"' is not a valid hex color\");\n  }\n  if (hexColor.length == 4) {  // of the form #RGB\n    hexColor = hexColor.replace(goog.color.hexTripletRe_, '#$1$1$2$2$3$3');\n  }\n  return hexColor.toLowerCase();\n};\n\n\n/**\n * Converts a hex representation of a color to RGB.\n * @param {string} hexColor Color to convert.\n * @return {!goog.color.Rgb} rgb representation of the color.\n */\ngoog.color.hexToRgb = function(hexColor) {\n  hexColor = goog.color.normalizeHex(hexColor);\n  var r = parseInt(hexColor.substr(1, 2), 16);\n  var g = parseInt(hexColor.substr(3, 2), 16);\n  var b = parseInt(hexColor.substr(5, 2), 16);\n\n  return [r, g, b];\n};\n\n\n/**\n * Converts a color from RGB to hex representation.\n * @param {number} r Amount of red, int between 0 and 255.\n * @param {number} g Amount of green, int between 0 and 255.\n * @param {number} b Amount of blue, int between 0 and 255.\n * @return {string} hex representation of the color.\n */\ngoog.color.rgbToHex = function(r, g, b) {\n  r = Number(r);\n  g = Number(g);\n  b = Number(b);\n  if (r != (r & 255) || g != (g & 255) || b != (b & 255)) {\n    throw Error('\"(' + r + ',' + g + ',' + b + '\") is not a valid RGB color');\n  }\n  var hexR = goog.color.prependZeroIfNecessaryHelper(r.toString(16));\n  var hexG = goog.color.prependZeroIfNecessaryHelper(g.toString(16));\n  var hexB = goog.color.prependZeroIfNecessaryHelper(b.toString(16));\n  return '#' + hexR + hexG + hexB;\n};\n\n\n/**\n * Converts a color from RGB to hex representation.\n * @param {goog.color.Rgb} rgb rgb representation of the color.\n * @return {string} hex representation of the color.\n */\ngoog.color.rgbArrayToHex = function(rgb) {\n  return goog.color.rgbToHex(rgb[0], rgb[1], rgb[2]);\n};\n\n\n/**\n * Converts a color from RGB color space to HSL color space.\n * Modified from {@link http://en.wikipedia.org/wiki/HLS_color_space}.\n * @param {number} r Value of red, in [0, 255].\n * @param {number} g Value of green, in [0, 255].\n * @param {number} b Value of blue, in [0, 255].\n * @return {!goog.color.Hsl} hsl representation of the color.\n */\ngoog.color.rgbToHsl = function(r, g, b) {\n  // First must normalize r, g, b to be between 0 and 1.\n  var normR = r / 255;\n  var normG = g / 255;\n  var normB = b / 255;\n  var max = Math.max(normR, normG, normB);\n  var min = Math.min(normR, normG, normB);\n  var h = 0;\n  var s = 0;\n\n  // Luminosity is the average of the max and min rgb color intensities.\n  var l = 0.5 * (max + min);\n\n  // The hue and saturation are dependent on which color intensity is the max.\n  // If max and min are equal, the color is gray and h and s should be 0.\n  if (max != min) {\n    if (max == normR) {\n      h = 60 * (normG - normB) / (max - min);\n    } else if (max == normG) {\n      h = 60 * (normB - normR) / (max - min) + 120;\n    } else if (max == normB) {\n      h = 60 * (normR - normG) / (max - min) + 240;\n    }\n\n    if (0 < l && l <= 0.5) {\n      s = (max - min) / (2 * l);\n    } else {\n      s = (max - min) / (2 - 2 * l);\n    }\n  }\n\n  // Make sure the hue falls between 0 and 360.\n  return [Math.round(h + 360) % 360, s, l];\n};\n\n\n/**\n * Converts a color from RGB color space to HSL color space.\n * @param {goog.color.Rgb} rgb rgb representation of the color.\n * @return {!goog.color.Hsl} hsl representation of the color.\n */\ngoog.color.rgbArrayToHsl = function(rgb) {\n  return goog.color.rgbToHsl(rgb[0], rgb[1], rgb[2]);\n};\n\n\n/**\n * Helper for hslToRgb.\n * @param {number} v1 Helper variable 1.\n * @param {number} v2 Helper variable 2.\n * @param {number} vH Helper variable 3.\n * @return {number} Appropriate RGB value, given the above.\n * @private\n */\ngoog.color.hueToRgb_ = function(v1, v2, vH) {\n  if (vH < 0) {\n    vH += 1;\n  } else if (vH > 1) {\n    vH -= 1;\n  }\n  if ((6 * vH) < 1) {\n    return (v1 + (v2 - v1) * 6 * vH);\n  } else if (2 * vH < 1) {\n    return v2;\n  } else if (3 * vH < 2) {\n    return (v1 + (v2 - v1) * ((2 / 3) - vH) * 6);\n  }\n  return v1;\n};\n\n\n/**\n * Converts a color from HSL color space to RGB color space.\n * Modified from {@link http://www.easyrgb.com/math.html}\n * @param {number} h Hue, in [0, 360].\n * @param {number} s Saturation, in [0, 1].\n * @param {number} l Luminosity, in [0, 1].\n * @return {!goog.color.Rgb} rgb representation of the color.\n */\ngoog.color.hslToRgb = function(h, s, l) {\n  var r = 0;\n  var g = 0;\n  var b = 0;\n  var normH = h / 360;  // normalize h to fall in [0, 1]\n\n  if (s == 0) {\n    r = g = b = l * 255;\n  } else {\n    var temp1 = 0;\n    var temp2 = 0;\n    if (l < 0.5) {\n      temp2 = l * (1 + s);\n    } else {\n      temp2 = l + s - (s * l);\n    }\n    temp1 = 2 * l - temp2;\n    r = 255 * goog.color.hueToRgb_(temp1, temp2, normH + (1 / 3));\n    g = 255 * goog.color.hueToRgb_(temp1, temp2, normH);\n    b = 255 * goog.color.hueToRgb_(temp1, temp2, normH - (1 / 3));\n  }\n\n  return [Math.round(r), Math.round(g), Math.round(b)];\n};\n\n\n/**\n * Converts a color from HSL color space to RGB color space.\n * @param {goog.color.Hsl} hsl hsl representation of the color.\n * @return {!goog.color.Rgb} rgb representation of the color.\n */\ngoog.color.hslArrayToRgb = function(hsl) {\n  return goog.color.hslToRgb(hsl[0], hsl[1], hsl[2]);\n};\n\n\n/**\n * Helper for isValidHexColor_.\n * @type {RegExp}\n * @private\n */\ngoog.color.validHexColorRe_ = /^#(?:[0-9a-f]{3}){1,2}$/i;\n\n\n/**\n * Checks if a string is a valid hex color.  We expect strings of the format\n * #RRGGBB (ex: #1b3d5f) or #RGB (ex: #3CA == #33CCAA).\n * @param {string} str String to check.\n * @return {boolean} Whether the string is a valid hex color.\n * @private\n */\ngoog.color.isValidHexColor_ = function(str) {\n  return goog.color.validHexColorRe_.test(str);\n};\n\n\n/**\n * Helper for isNormalizedHexColor_.\n * @type {RegExp}\n * @private\n */\ngoog.color.normalizedHexColorRe_ = /^#[0-9a-f]{6}$/;\n\n\n/**\n * Checks if a string is a normalized hex color.\n * We expect strings of the format #RRGGBB (ex: #1b3d5f)\n * using only lowercase letters.\n * @param {string} str String to check.\n * @return {boolean} Whether the string is a normalized hex color.\n * @private\n */\ngoog.color.isNormalizedHexColor_ = function(str) {\n  return goog.color.normalizedHexColorRe_.test(str);\n};\n\n\n/**\n * Regular expression for matching and capturing RGB style strings. Helper for\n * isValidRgbColor_.\n * @type {RegExp}\n * @private\n */\ngoog.color.rgbColorRe_ =\n    /^(?:rgb)?\\((0|[1-9]\\d{0,2}),\\s?(0|[1-9]\\d{0,2}),\\s?(0|[1-9]\\d{0,2})\\)$/i;\n\n\n/**\n * Checks if a string is a valid rgb color.  We expect strings of the format\n * '(r, g, b)', or 'rgb(r, g, b)', where each color component is an int in\n * [0, 255].\n * @param {string} str String to check.\n * @return {!goog.color.Rgb} the rgb representation of the color if it is\n *     a valid color, or the empty array otherwise.\n * @private\n */\ngoog.color.isValidRgbColor_ = function(str) {\n  // Each component is separate (rather than using a repeater) so we can\n  // capture the match. Also, we explicitly set each component to be either 0,\n  // or start with a non-zero, to prevent octal numbers from slipping through.\n  var regExpResultArray = str.match(goog.color.rgbColorRe_);\n  if (regExpResultArray) {\n    var r = Number(regExpResultArray[1]);\n    var g = Number(regExpResultArray[2]);\n    var b = Number(regExpResultArray[3]);\n    if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255) {\n      return [r, g, b];\n    }\n  }\n  return [];\n};\n\n\n/**\n * Takes a hex value and prepends a zero if it's a single digit.\n * Small helper method for use by goog.color and friends.\n * @param {string} hex Hex value to prepend if single digit.\n * @return {string} hex value prepended with zero if it was single digit,\n *     otherwise the same value that was passed in.\n */\ngoog.color.prependZeroIfNecessaryHelper = function(hex) {\n  return hex.length == 1 ? '0' + hex : hex;\n};\n\n\n/**\n * Takes a string a prepends a '#' sign if one doesn't exist.\n * Small helper method for use by goog.color and friends.\n * @param {string} str String to check.\n * @return {string} The value passed in, prepended with a '#' if it didn't\n *     already have one.\n */\ngoog.color.prependHashIfNecessaryHelper = function(str) {\n  return str.charAt(0) == '#' ? str : '#' + str;\n};\n\n\n/**\n * Takes an array of [r, g, b] and converts it into a string appropriate for\n * CSS styles.\n * @param {goog.color.Rgb} rgb rgb representation of the color.\n * @return {string} string of the form 'rgb(r,g,b)'.\n * @private\n */\ngoog.color.rgbStyle_ = function(rgb) {\n  return 'rgb(' + rgb.join(',') + ')';\n};\n\n\n/**\n * Converts an HSV triplet to an RGB array.  V is brightness because b is\n *   reserved for blue in RGB.\n * @param {number} h Hue value in [0, 360].\n * @param {number} s Saturation value in [0, 1].\n * @param {number} brightness brightness in [0, 255].\n * @return {!goog.color.Rgb} rgb representation of the color.\n */\ngoog.color.hsvToRgb = function(h, s, brightness) {\n  var red = 0;\n  var green = 0;\n  var blue = 0;\n  if (s == 0) {\n    red = brightness;\n    green = brightness;\n    blue = brightness;\n  } else {\n    var sextant = Math.floor(h / 60);\n    var remainder = (h / 60) - sextant;\n    var val1 = brightness * (1 - s);\n    var val2 = brightness * (1 - (s * remainder));\n    var val3 = brightness * (1 - (s * (1 - remainder)));\n    switch (sextant) {\n      case 1:\n        red = val2;\n        green = brightness;\n        blue = val1;\n        break;\n      case 2:\n        red = val1;\n        green = brightness;\n        blue = val3;\n        break;\n      case 3:\n        red = val1;\n        green = val2;\n        blue = brightness;\n        break;\n      case 4:\n        red = val3;\n        green = val1;\n        blue = brightness;\n        break;\n      case 5:\n        red = brightness;\n        green = val1;\n        blue = val2;\n        break;\n      case 6:\n      case 0:\n        red = brightness;\n        green = val3;\n        blue = val1;\n        break;\n    }\n  }\n\n  return [Math.floor(red), Math.floor(green), Math.floor(blue)];\n};\n\n\n/**\n * Converts from RGB values to an array of HSV values.\n * @param {number} red Red value in [0, 255].\n * @param {number} green Green value in [0, 255].\n * @param {number} blue Blue value in [0, 255].\n * @return {!goog.color.Hsv} hsv representation of the color.\n */\ngoog.color.rgbToHsv = function(red, green, blue) {\n\n  var max = Math.max(Math.max(red, green), blue);\n  var min = Math.min(Math.min(red, green), blue);\n  var hue;\n  var saturation;\n  var value = max;\n  if (min == max) {\n    hue = 0;\n    saturation = 0;\n  } else {\n    var delta = (max - min);\n    saturation = delta / max;\n\n    if (red == max) {\n      hue = (green - blue) / delta;\n    } else if (green == max) {\n      hue = 2 + ((blue - red) / delta);\n    } else {\n      hue = 4 + ((red - green) / delta);\n    }\n    hue *= 60;\n    if (hue < 0) {\n      hue += 360;\n    }\n    if (hue > 360) {\n      hue -= 360;\n    }\n  }\n\n  return [hue, saturation, value];\n};\n\n\n/**\n * Converts from an array of RGB values to an array of HSV values.\n * @param {goog.color.Rgb} rgb rgb representation of the color.\n * @return {!goog.color.Hsv} hsv representation of the color.\n */\ngoog.color.rgbArrayToHsv = function(rgb) {\n  return goog.color.rgbToHsv(rgb[0], rgb[1], rgb[2]);\n};\n\n\n/**\n * Converts an HSV triplet to an RGB array.\n * @param {goog.color.Hsv} hsv hsv representation of the color.\n * @return {!goog.color.Rgb} rgb representation of the color.\n */\ngoog.color.hsvArrayToRgb = function(hsv) {\n  return goog.color.hsvToRgb(hsv[0], hsv[1], hsv[2]);\n};\n\n\n/**\n * Converts a hex representation of a color to HSL.\n * @param {string} hex Color to convert.\n * @return {!goog.color.Hsl} hsl representation of the color.\n */\ngoog.color.hexToHsl = function(hex) {\n  var rgb = goog.color.hexToRgb(hex);\n  return goog.color.rgbToHsl(rgb[0], rgb[1], rgb[2]);\n};\n\n\n/**\n * Converts from h,s,l values to a hex string\n * @param {number} h Hue, in [0, 360].\n * @param {number} s Saturation, in [0, 1].\n * @param {number} l Luminosity, in [0, 1].\n * @return {string} hex representation of the color.\n */\ngoog.color.hslToHex = function(h, s, l) {\n  return goog.color.rgbArrayToHex(goog.color.hslToRgb(h, s, l));\n};\n\n\n/**\n * Converts from an hsl array to a hex string\n * @param {goog.color.Hsl} hsl hsl representation of the color.\n * @return {string} hex representation of the color.\n */\ngoog.color.hslArrayToHex = function(hsl) {\n  return goog.color.rgbArrayToHex(goog.color.hslToRgb(hsl[0], hsl[1], hsl[2]));\n};\n\n\n/**\n * Converts a hex representation of a color to HSV\n * @param {string} hex Color to convert.\n * @return {!goog.color.Hsv} hsv representation of the color.\n */\ngoog.color.hexToHsv = function(hex) {\n  return goog.color.rgbArrayToHsv(goog.color.hexToRgb(hex));\n};\n\n\n/**\n * Converts from h,s,v values to a hex string\n * @param {number} h Hue, in [0, 360].\n * @param {number} s Saturation, in [0, 1].\n * @param {number} v Value, in [0, 255].\n * @return {string} hex representation of the color.\n */\ngoog.color.hsvToHex = function(h, s, v) {\n  return goog.color.rgbArrayToHex(goog.color.hsvToRgb(h, s, v));\n};\n\n\n/**\n * Converts from an HSV array to a hex string\n * @param {goog.color.Hsv} hsv hsv representation of the color.\n * @return {string} hex representation of the color.\n */\ngoog.color.hsvArrayToHex = function(hsv) {\n  return goog.color.hsvToHex(hsv[0], hsv[1], hsv[2]);\n};\n\n\n/**\n * Calculates the Euclidean distance between two color vectors on an HSL sphere.\n * A demo of the sphere can be found at:\n * http://en.wikipedia.org/wiki/HSL_color_space\n * In short, a vector for color (H, S, L) in this system can be expressed as\n * (S*L'*cos(2*PI*H), S*L'*sin(2*PI*H), L), where L' = abs(L - 0.5), and we\n * simply calculate the 1-2 distance using these coordinates\n * @param {goog.color.Hsl} hsl1 First color in hsl representation.\n * @param {goog.color.Hsl} hsl2 Second color in hsl representation.\n * @return {number} Distance between the two colors, in the range [0, 1].\n */\ngoog.color.hslDistance = function(hsl1, hsl2) {\n  var sl1, sl2;\n  if (hsl1[2] <= 0.5) {\n    sl1 = hsl1[1] * hsl1[2];\n  } else {\n    sl1 = hsl1[1] * (1.0 - hsl1[2]);\n  }\n\n  if (hsl2[2] <= 0.5) {\n    sl2 = hsl2[1] * hsl2[2];\n  } else {\n    sl2 = hsl2[1] * (1.0 - hsl2[2]);\n  }\n\n  var h1 = hsl1[0] / 360.0;\n  var h2 = hsl2[0] / 360.0;\n  var dh = (h1 - h2) * 2.0 * Math.PI;\n  return (hsl1[2] - hsl2[2]) * (hsl1[2] - hsl2[2]) + sl1 * sl1 + sl2 * sl2 -\n      2 * sl1 * sl2 * Math.cos(dh);\n};\n\n\n/**\n * Blend two colors together, using the specified factor to indicate the weight\n * given to the first color\n * @param {goog.color.Rgb} rgb1 First color represented in rgb.\n * @param {goog.color.Rgb} rgb2 Second color represented in rgb.\n * @param {number} factor The weight to be given to rgb1 over rgb2. Values\n *     should be in the range [0, 1]. If less than 0, factor will be set to 0.\n *     If greater than 1, factor will be set to 1.\n * @return {!goog.color.Rgb} Combined color represented in rgb.\n */\ngoog.color.blend = function(rgb1, rgb2, factor) {\n  factor = goog.math.clamp(factor, 0, 1);\n\n  return [\n    Math.round(factor * rgb1[0] + (1.0 - factor) * rgb2[0]),\n    Math.round(factor * rgb1[1] + (1.0 - factor) * rgb2[1]),\n    Math.round(factor * rgb1[2] + (1.0 - factor) * rgb2[2])\n  ];\n};\n\n\n/**\n * Adds black to the specified color, darkening it\n * @param {goog.color.Rgb} rgb rgb representation of the color.\n * @param {number} factor Number in the range [0, 1]. 0 will do nothing, while\n *     1 will return black. If less than 0, factor will be set to 0. If greater\n *     than 1, factor will be set to 1.\n * @return {!goog.color.Rgb} Combined rgb color.\n */\ngoog.color.darken = function(rgb, factor) {\n  var black = [0, 0, 0];\n  return goog.color.blend(black, rgb, factor);\n};\n\n\n/**\n * Adds white to the specified color, lightening it\n * @param {goog.color.Rgb} rgb rgb representation of the color.\n * @param {number} factor Number in the range [0, 1].  0 will do nothing, while\n *     1 will return white. If less than 0, factor will be set to 0. If greater\n *     than 1, factor will be set to 1.\n * @return {!goog.color.Rgb} Combined rgb color.\n */\ngoog.color.lighten = function(rgb, factor) {\n  var white = [255, 255, 255];\n  return goog.color.blend(white, rgb, factor);\n};\n\n\n/**\n * Find the \"best\" (highest-contrast) of the suggested colors for the prime\n * color. Uses W3C formula for judging readability and visual accessibility:\n * http://www.w3.org/TR/AERT#color-contrast\n * @param {goog.color.Rgb} prime Color represented as a rgb array.\n * @param {Array<goog.color.Rgb>} suggestions Array of colors,\n *     each representing a rgb array.\n * @return {!goog.color.Rgb} Highest-contrast color represented by an array..\n */\ngoog.color.highContrast = function(prime, suggestions) {\n  var suggestionsWithDiff = [];\n  for (var i = 0; i < suggestions.length; i++) {\n    suggestionsWithDiff.push({\n      color: suggestions[i],\n      diff: goog.color.yiqBrightnessDiff_(suggestions[i], prime) +\n          goog.color.colorDiff_(suggestions[i], prime)\n    });\n  }\n  suggestionsWithDiff.sort(function(a, b) { return b.diff - a.diff; });\n  return suggestionsWithDiff[0].color;\n};\n\n\n/**\n * Calculate brightness of a color according to YIQ formula (brightness is Y).\n * More info on YIQ here: http://en.wikipedia.org/wiki/YIQ. Helper method for\n * goog.color.highContrast()\n * @param {goog.color.Rgb} rgb Color represented by a rgb array.\n * @return {number} brightness (Y).\n * @private\n */\ngoog.color.yiqBrightness_ = function(rgb) {\n  return Math.round((rgb[0] * 299 + rgb[1] * 587 + rgb[2] * 114) / 1000);\n};\n\n\n/**\n * Calculate difference in brightness of two colors. Helper method for\n * goog.color.highContrast()\n * @param {goog.color.Rgb} rgb1 Color represented by a rgb array.\n * @param {goog.color.Rgb} rgb2 Color represented by a rgb array.\n * @return {number} Brightness difference.\n * @private\n */\ngoog.color.yiqBrightnessDiff_ = function(rgb1, rgb2) {\n  return Math.abs(\n      goog.color.yiqBrightness_(rgb1) - goog.color.yiqBrightness_(rgb2));\n};\n\n\n/**\n * Calculate color difference between two colors. Helper method for\n * goog.color.highContrast()\n * @param {goog.color.Rgb} rgb1 Color represented by a rgb array.\n * @param {goog.color.Rgb} rgb2 Color represented by a rgb array.\n * @return {number} Color difference.\n * @private\n */\ngoog.color.colorDiff_ = function(rgb1, rgb2) {\n  return Math.abs(rgb1[0] - rgb2[0]) + Math.abs(rgb1[1] - rgb2[1]) +\n      Math.abs(rgb1[2] - rgb2[2]);\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Python style iteration utilities.\n * @author arv@google.com (Erik Arvidsson)\n */\n\n\ngoog.provide('goog.iter');\ngoog.provide('goog.iter.Iterable');\ngoog.provide('goog.iter.Iterator');\ngoog.provide('goog.iter.StopIteration');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.functions');\ngoog.require('goog.math');\n\n\n/**\n * @typedef {goog.iter.Iterator|{length:number}|{__iterator__}}\n */\ngoog.iter.Iterable;\n\n\n/**\n * Singleton Error object that is used to terminate iterations.\n * @const {!Error}\n */\ngoog.iter.StopIteration = ('StopIteration' in goog.global) ?\n    // For script engines that support legacy iterators.\n    goog.global['StopIteration'] :\n    {message: 'StopIteration', stack: ''};\n\n\n\n/**\n * Class/interface for iterators.  An iterator needs to implement a {@code next}\n * method and it needs to throw a {@code goog.iter.StopIteration} when the\n * iteration passes beyond the end.  Iterators have no {@code hasNext} method.\n * It is recommended to always use the helper functions to iterate over the\n * iterator or in case you are only targeting JavaScript 1.7 for in loops.\n * @constructor\n * @template VALUE\n */\ngoog.iter.Iterator = function() {};\n\n\n/**\n * Returns the next value of the iteration.  This will throw the object\n * {@see goog.iter#StopIteration} when the iteration passes the end.\n * @return {VALUE} Any object or value.\n */\ngoog.iter.Iterator.prototype.next = function() {\n  throw goog.iter.StopIteration;\n};\n\n\n/**\n * Returns the {@code Iterator} object itself.  This is used to implement\n * the iterator protocol in JavaScript 1.7\n * @param {boolean=} opt_keys  Whether to return the keys or values. Default is\n *     to only return the values.  This is being used by the for-in loop (true)\n *     and the for-each-in loop (false).  Even though the param gives a hint\n *     about what the iterator will return there is no guarantee that it will\n *     return the keys when true is passed.\n * @return {!goog.iter.Iterator<VALUE>} The object itself.\n */\ngoog.iter.Iterator.prototype.__iterator__ = function(opt_keys) {\n  return this;\n};\n\n\n/**\n * Returns an iterator that knows how to iterate over the values in the object.\n * @param {goog.iter.Iterator<VALUE>|goog.iter.Iterable} iterable  If the\n *     object is an iterator it will be returned as is.  If the object has an\n *     {@code __iterator__} method that will be called to get the value\n *     iterator.  If the object is an array-like object we create an iterator\n *     for that.\n * @return {!goog.iter.Iterator<VALUE>} An iterator that knows how to iterate\n *     over the values in {@code iterable}.\n * @template VALUE\n */\ngoog.iter.toIterator = function(iterable) {\n  if (iterable instanceof goog.iter.Iterator) {\n    return iterable;\n  }\n  if (typeof iterable.__iterator__ == 'function') {\n    return iterable.__iterator__(false);\n  }\n  if (goog.isArrayLike(iterable)) {\n    var i = 0;\n    var newIter = new goog.iter.Iterator;\n    newIter.next = function() {\n      while (true) {\n        if (i >= iterable.length) {\n          throw goog.iter.StopIteration;\n        }\n        // Don't include deleted elements.\n        if (!(i in iterable)) {\n          i++;\n          continue;\n        }\n        return iterable[i++];\n      }\n    };\n    return newIter;\n  }\n\n\n  // TODO(arv): Should we fall back on goog.structs.getValues()?\n  throw Error('Not implemented');\n};\n\n\n/**\n * Calls a function for each element in the iterator with the element of the\n * iterator passed as argument.\n *\n * @param {goog.iter.Iterator<VALUE>|goog.iter.Iterable} iterable  The iterator\n *     to iterate over. If the iterable is an object {@code toIterator} will be\n *     called on it.\n * @param {function(this:THIS,VALUE,?,!goog.iter.Iterator<VALUE>)} f\n *     The function to call for every element.  This function takes 3 arguments\n *     (the element, undefined, and the iterator) and the return value is\n *     irrelevant.  The reason for passing undefined as the second argument is\n *     so that the same function can be used in {@see goog.array#forEach} as\n *     well as others.  The third parameter is of type \"number\" for\n *     arraylike objects, undefined, otherwise.\n * @param {THIS=} opt_obj  The object to be used as the value of 'this' within\n *     {@code f}.\n * @template THIS, VALUE\n */\ngoog.iter.forEach = function(iterable, f, opt_obj) {\n  if (goog.isArrayLike(iterable)) {\n    /** @preserveTry */\n    try {\n      // NOTES: this passes the index number to the second parameter\n      // of the callback contrary to the documentation above.\n      goog.array.forEach(\n          /** @type {IArrayLike<?>} */ (iterable), f, opt_obj);\n    } catch (ex) {\n      if (ex !== goog.iter.StopIteration) {\n        throw ex;\n      }\n    }\n  } else {\n    iterable = goog.iter.toIterator(iterable);\n    /** @preserveTry */\n    try {\n      while (true) {\n        f.call(opt_obj, iterable.next(), undefined, iterable);\n      }\n    } catch (ex) {\n      if (ex !== goog.iter.StopIteration) {\n        throw ex;\n      }\n    }\n  }\n};\n\n\n/**\n * Calls a function for every element in the iterator, and if the function\n * returns true adds the element to a new iterator.\n *\n * @param {goog.iter.Iterator<VALUE>|goog.iter.Iterable} iterable The iterator\n *     to iterate over.\n * @param {\n *     function(this:THIS,VALUE,undefined,!goog.iter.Iterator<VALUE>):boolean} f\n *     The function to call for every element. This function takes 3 arguments\n *     (the element, undefined, and the iterator) and should return a boolean.\n *     If the return value is true the element will be included in the returned\n *     iterator.  If it is false the element is not included.\n * @param {THIS=} opt_obj The object to be used as the value of 'this' within\n *     {@code f}.\n * @return {!goog.iter.Iterator<VALUE>} A new iterator in which only elements\n *     that passed the test are present.\n * @template THIS, VALUE\n */\ngoog.iter.filter = function(iterable, f, opt_obj) {\n  var iterator = goog.iter.toIterator(iterable);\n  var newIter = new goog.iter.Iterator;\n  newIter.next = function() {\n    while (true) {\n      var val = iterator.next();\n      if (f.call(opt_obj, val, undefined, iterator)) {\n        return val;\n      }\n    }\n  };\n  return newIter;\n};\n\n\n/**\n * Calls a function for every element in the iterator, and if the function\n * returns false adds the element to a new iterator.\n *\n * @param {goog.iter.Iterator<VALUE>|goog.iter.Iterable} iterable The iterator\n *     to iterate over.\n * @param {\n *     function(this:THIS,VALUE,undefined,!goog.iter.Iterator<VALUE>):boolean} f\n *     The function to call for every element. This function takes 3 arguments\n *     (the element, undefined, and the iterator) and should return a boolean.\n *     If the return value is false the element will be included in the returned\n *     iterator.  If it is true the element is not included.\n * @param {THIS=} opt_obj The object to be used as the value of 'this' within\n *     {@code f}.\n * @return {!goog.iter.Iterator<VALUE>} A new iterator in which only elements\n *     that did not pass the test are present.\n * @template THIS, VALUE\n */\ngoog.iter.filterFalse = function(iterable, f, opt_obj) {\n  return goog.iter.filter(iterable, goog.functions.not(f), opt_obj);\n};\n\n\n/**\n * Creates a new iterator that returns the values in a range.  This function\n * can take 1, 2 or 3 arguments:\n * <pre>\n * range(5) same as range(0, 5, 1)\n * range(2, 5) same as range(2, 5, 1)\n * </pre>\n *\n * @param {number} startOrStop  The stop value if only one argument is provided.\n *     The start value if 2 or more arguments are provided.  If only one\n *     argument is used the start value is 0.\n * @param {number=} opt_stop  The stop value.  If left out then the first\n *     argument is used as the stop value.\n * @param {number=} opt_step  The number to increment with between each call to\n *     next.  This can be negative.\n * @return {!goog.iter.Iterator<number>} A new iterator that returns the values\n *     in the range.\n */\ngoog.iter.range = function(startOrStop, opt_stop, opt_step) {\n  var start = 0;\n  var stop = startOrStop;\n  var step = opt_step || 1;\n  if (arguments.length > 1) {\n    start = startOrStop;\n    stop = opt_stop;\n  }\n  if (step == 0) {\n    throw Error('Range step argument must not be zero');\n  }\n\n  var newIter = new goog.iter.Iterator;\n  newIter.next = function() {\n    if (step > 0 && start >= stop || step < 0 && start <= stop) {\n      throw goog.iter.StopIteration;\n    }\n    var rv = start;\n    start += step;\n    return rv;\n  };\n  return newIter;\n};\n\n\n/**\n * Joins the values in a iterator with a delimiter.\n * @param {goog.iter.Iterator<VALUE>|goog.iter.Iterable} iterable The iterator\n *     to get the values from.\n * @param {string} deliminator  The text to put between the values.\n * @return {string} The joined value string.\n * @template VALUE\n */\ngoog.iter.join = function(iterable, deliminator) {\n  return goog.iter.toArray(iterable).join(deliminator);\n};\n\n\n/**\n * For every element in the iterator call a function and return a new iterator\n * with that value.\n *\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterator to iterate over.\n * @param {\n *     function(this:THIS,VALUE,undefined,!goog.iter.Iterator<VALUE>):RESULT} f\n *     The function to call for every element.  This function takes 3 arguments\n *     (the element, undefined, and the iterator) and should return a new value.\n * @param {THIS=} opt_obj The object to be used as the value of 'this' within\n *     {@code f}.\n * @return {!goog.iter.Iterator<RESULT>} A new iterator that returns the\n *     results of applying the function to each element in the original\n *     iterator.\n * @template THIS, VALUE, RESULT\n */\ngoog.iter.map = function(iterable, f, opt_obj) {\n  var iterator = goog.iter.toIterator(iterable);\n  var newIter = new goog.iter.Iterator;\n  newIter.next = function() {\n    var val = iterator.next();\n    return f.call(opt_obj, val, undefined, iterator);\n  };\n  return newIter;\n};\n\n\n/**\n * Passes every element of an iterator into a function and accumulates the\n * result.\n *\n * @param {goog.iter.Iterator<VALUE>|goog.iter.Iterable} iterable The iterator\n *     to iterate over.\n * @param {function(this:THIS,VALUE,VALUE):VALUE} f The function to call for\n *     every element. This function takes 2 arguments (the function's previous\n *     result or the initial value, and the value of the current element).\n *     function(previousValue, currentElement) : newValue.\n * @param {VALUE} val The initial value to pass into the function on the first\n *     call.\n * @param {THIS=} opt_obj  The object to be used as the value of 'this' within\n *     f.\n * @return {VALUE} Result of evaluating f repeatedly across the values of\n *     the iterator.\n * @template THIS, VALUE\n */\ngoog.iter.reduce = function(iterable, f, val, opt_obj) {\n  var rval = val;\n  goog.iter.forEach(\n      iterable, function(val) { rval = f.call(opt_obj, rval, val); });\n  return rval;\n};\n\n\n/**\n * Goes through the values in the iterator. Calls f for each of these, and if\n * any of them returns true, this returns true (without checking the rest). If\n * all return false this will return false.\n *\n * @param {goog.iter.Iterator<VALUE>|goog.iter.Iterable} iterable The iterator\n *     object.\n * @param {\n *     function(this:THIS,VALUE,undefined,!goog.iter.Iterator<VALUE>):boolean} f\n *     The function to call for every value. This function takes 3 arguments\n *     (the value, undefined, and the iterator) and should return a boolean.\n * @param {THIS=} opt_obj The object to be used as the value of 'this' within\n *     {@code f}.\n * @return {boolean} true if any value passes the test.\n * @template THIS, VALUE\n */\ngoog.iter.some = function(iterable, f, opt_obj) {\n  iterable = goog.iter.toIterator(iterable);\n  /** @preserveTry */\n  try {\n    while (true) {\n      if (f.call(opt_obj, iterable.next(), undefined, iterable)) {\n        return true;\n      }\n    }\n  } catch (ex) {\n    if (ex !== goog.iter.StopIteration) {\n      throw ex;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Goes through the values in the iterator. Calls f for each of these and if any\n * of them returns false this returns false (without checking the rest). If all\n * return true this will return true.\n *\n * @param {goog.iter.Iterator<VALUE>|goog.iter.Iterable} iterable The iterator\n *     object.\n * @param {\n *     function(this:THIS,VALUE,undefined,!goog.iter.Iterator<VALUE>):boolean} f\n *     The function to call for every value. This function takes 3 arguments\n *     (the value, undefined, and the iterator) and should return a boolean.\n * @param {THIS=} opt_obj The object to be used as the value of 'this' within\n *     {@code f}.\n * @return {boolean} true if every value passes the test.\n * @template THIS, VALUE\n */\ngoog.iter.every = function(iterable, f, opt_obj) {\n  iterable = goog.iter.toIterator(iterable);\n  /** @preserveTry */\n  try {\n    while (true) {\n      if (!f.call(opt_obj, iterable.next(), undefined, iterable)) {\n        return false;\n      }\n    }\n  } catch (ex) {\n    if (ex !== goog.iter.StopIteration) {\n      throw ex;\n    }\n  }\n  return true;\n};\n\n\n/**\n * Takes zero or more iterables and returns one iterator that will iterate over\n * them in the order chained.\n * @param {...!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} var_args Any\n *     number of iterable objects.\n * @return {!goog.iter.Iterator<VALUE>} Returns a new iterator that will\n *     iterate over all the given iterables' contents.\n * @template VALUE\n */\ngoog.iter.chain = function(var_args) {\n  return goog.iter.chainFromIterable(arguments);\n};\n\n\n/**\n * Takes a single iterable containing zero or more iterables and returns one\n * iterator that will iterate over each one in the order given.\n * @see https://goo.gl/5NRp5d\n * @param {goog.iter.Iterable} iterable The iterable of iterables to chain.\n * @return {!goog.iter.Iterator<VALUE>} Returns a new iterator that will\n *     iterate over all the contents of the iterables contained within\n *     {@code iterable}.\n * @template VALUE\n */\ngoog.iter.chainFromIterable = function(iterable) {\n  var iterator = goog.iter.toIterator(iterable);\n  var iter = new goog.iter.Iterator();\n  var current = null;\n\n  iter.next = function() {\n    while (true) {\n      if (current == null) {\n        var it = iterator.next();\n        current = goog.iter.toIterator(it);\n      }\n      try {\n        return current.next();\n      } catch (ex) {\n        if (ex !== goog.iter.StopIteration) {\n          throw ex;\n        }\n        current = null;\n      }\n    }\n  };\n\n  return iter;\n};\n\n\n/**\n * Builds a new iterator that iterates over the original, but skips elements as\n * long as a supplied function returns true.\n * @param {goog.iter.Iterator<VALUE>|goog.iter.Iterable} iterable The iterator\n *     object.\n * @param {\n *     function(this:THIS,VALUE,undefined,!goog.iter.Iterator<VALUE>):boolean} f\n *     The function to call for every value. This function takes 3 arguments\n *     (the value, undefined, and the iterator) and should return a boolean.\n * @param {THIS=} opt_obj The object to be used as the value of 'this' within\n *     {@code f}.\n * @return {!goog.iter.Iterator<VALUE>} A new iterator that drops elements from\n *     the original iterator as long as {@code f} is true.\n * @template THIS, VALUE\n */\ngoog.iter.dropWhile = function(iterable, f, opt_obj) {\n  var iterator = goog.iter.toIterator(iterable);\n  var newIter = new goog.iter.Iterator;\n  var dropping = true;\n  newIter.next = function() {\n    while (true) {\n      var val = iterator.next();\n      if (dropping && f.call(opt_obj, val, undefined, iterator)) {\n        continue;\n      } else {\n        dropping = false;\n      }\n      return val;\n    }\n  };\n  return newIter;\n};\n\n\n/**\n * Builds a new iterator that iterates over the original, but only as long as a\n * supplied function returns true.\n * @param {goog.iter.Iterator<VALUE>|goog.iter.Iterable} iterable The iterator\n *     object.\n * @param {\n *     function(this:THIS,VALUE,undefined,!goog.iter.Iterator<VALUE>):boolean} f\n *     The function to call for every value. This function takes 3 arguments\n *     (the value, undefined, and the iterator) and should return a boolean.\n * @param {THIS=} opt_obj This is used as the 'this' object in f when called.\n * @return {!goog.iter.Iterator<VALUE>} A new iterator that keeps elements in\n *     the original iterator as long as the function is true.\n * @template THIS, VALUE\n */\ngoog.iter.takeWhile = function(iterable, f, opt_obj) {\n  var iterator = goog.iter.toIterator(iterable);\n  var iter = new goog.iter.Iterator();\n  iter.next = function() {\n    var val = iterator.next();\n    if (f.call(opt_obj, val, undefined, iterator)) {\n      return val;\n    }\n    throw goog.iter.StopIteration;\n  };\n  return iter;\n};\n\n\n/**\n * Converts the iterator to an array\n * @param {goog.iter.Iterator<VALUE>|goog.iter.Iterable} iterable The iterator\n *     to convert to an array.\n * @return {!Array<VALUE>} An array of the elements the iterator iterates over.\n * @template VALUE\n */\ngoog.iter.toArray = function(iterable) {\n  // Fast path for array-like.\n  if (goog.isArrayLike(iterable)) {\n    return goog.array.toArray(/** @type {!IArrayLike<?>} */ (iterable));\n  }\n  iterable = goog.iter.toIterator(iterable);\n  var array = [];\n  goog.iter.forEach(iterable, function(val) { array.push(val); });\n  return array;\n};\n\n\n/**\n * Iterates over two iterables and returns true if they contain the same\n * sequence of elements and have the same length.\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable1 The first\n *     iterable object.\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable2 The second\n *     iterable object.\n * @param {function(VALUE,VALUE):boolean=} opt_equalsFn Optional comparison\n *     function.\n *     Should take two arguments to compare, and return true if the arguments\n *     are equal. Defaults to {@link goog.array.defaultCompareEquality} which\n *     compares the elements using the built-in '===' operator.\n * @return {boolean} true if the iterables contain the same sequence of elements\n *     and have the same length.\n * @template VALUE\n */\ngoog.iter.equals = function(iterable1, iterable2, opt_equalsFn) {\n  var fillValue = {};\n  var pairs = goog.iter.zipLongest(fillValue, iterable1, iterable2);\n  var equalsFn = opt_equalsFn || goog.array.defaultCompareEquality;\n  return goog.iter.every(\n      pairs, function(pair) { return equalsFn(pair[0], pair[1]); });\n};\n\n\n/**\n * Advances the iterator to the next position, returning the given default value\n * instead of throwing an exception if the iterator has no more entries.\n * @param {goog.iter.Iterator<VALUE>|goog.iter.Iterable} iterable The iterable\n *     object.\n * @param {VALUE} defaultValue The value to return if the iterator is empty.\n * @return {VALUE} The next item in the iteration, or defaultValue if the\n *     iterator was empty.\n * @template VALUE\n */\ngoog.iter.nextOrValue = function(iterable, defaultValue) {\n  try {\n    return goog.iter.toIterator(iterable).next();\n  } catch (e) {\n    if (e != goog.iter.StopIteration) {\n      throw e;\n    }\n    return defaultValue;\n  }\n};\n\n\n/**\n * Cartesian product of zero or more sets.  Gives an iterator that gives every\n * combination of one element chosen from each set.  For example,\n * ([1, 2], [3, 4]) gives ([1, 3], [1, 4], [2, 3], [2, 4]).\n * @see http://docs.python.org/library/itertools.html#itertools.product\n * @param {...!IArrayLike<VALUE>} var_args Zero or more sets, as\n *     arrays.\n * @return {!goog.iter.Iterator<!Array<VALUE>>} An iterator that gives each\n *     n-tuple (as an array).\n * @template VALUE\n */\ngoog.iter.product = function(var_args) {\n  var someArrayEmpty =\n      goog.array.some(arguments, function(arr) { return !arr.length; });\n\n  // An empty set in a cartesian product gives an empty set.\n  if (someArrayEmpty || !arguments.length) {\n    return new goog.iter.Iterator();\n  }\n\n  var iter = new goog.iter.Iterator();\n  var arrays = arguments;\n\n  // The first indices are [0, 0, ...]\n  var indicies = goog.array.repeat(0, arrays.length);\n\n  iter.next = function() {\n\n    if (indicies) {\n      var retVal = goog.array.map(indicies, function(valueIndex, arrayIndex) {\n        return arrays[arrayIndex][valueIndex];\n      });\n\n      // Generate the next-largest indices for the next call.\n      // Increase the rightmost index. If it goes over, increase the next\n      // rightmost (like carry-over addition).\n      for (var i = indicies.length - 1; i >= 0; i--) {\n        // Assertion prevents compiler warning below.\n        goog.asserts.assert(indicies);\n        if (indicies[i] < arrays[i].length - 1) {\n          indicies[i]++;\n          break;\n        }\n\n        // We're at the last indices (the last element of every array), so\n        // the iteration is over on the next call.\n        if (i == 0) {\n          indicies = null;\n          break;\n        }\n        // Reset the index in this column and loop back to increment the\n        // next one.\n        indicies[i] = 0;\n      }\n      return retVal;\n    }\n\n    throw goog.iter.StopIteration;\n  };\n\n  return iter;\n};\n\n\n/**\n * Create an iterator to cycle over the iterable's elements indefinitely.\n * For example, ([1, 2, 3]) would return : 1, 2, 3, 1, 2, 3, ...\n * @see: http://docs.python.org/library/itertools.html#itertools.cycle.\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterable object.\n * @return {!goog.iter.Iterator<VALUE>} An iterator that iterates indefinitely\n *     over the values in {@code iterable}.\n * @template VALUE\n */\ngoog.iter.cycle = function(iterable) {\n  var baseIterator = goog.iter.toIterator(iterable);\n\n  // We maintain a cache to store the iterable elements as we iterate\n  // over them. The cache is used to return elements once we have\n  // iterated over the iterable once.\n  var cache = [];\n  var cacheIndex = 0;\n\n  var iter = new goog.iter.Iterator();\n\n  // This flag is set after the iterable is iterated over once\n  var useCache = false;\n\n  iter.next = function() {\n    var returnElement = null;\n\n    // Pull elements off the original iterator if not using cache\n    if (!useCache) {\n      try {\n        // Return the element from the iterable\n        returnElement = baseIterator.next();\n        cache.push(returnElement);\n        return returnElement;\n      } catch (e) {\n        // If an exception other than StopIteration is thrown\n        // or if there are no elements to iterate over (the iterable was empty)\n        // throw an exception\n        if (e != goog.iter.StopIteration || goog.array.isEmpty(cache)) {\n          throw e;\n        }\n        // set useCache to true after we know that a 'StopIteration' exception\n        // was thrown and the cache is not empty (to handle the 'empty iterable'\n        // use case)\n        useCache = true;\n      }\n    }\n\n    returnElement = cache[cacheIndex];\n    cacheIndex = (cacheIndex + 1) % cache.length;\n\n    return returnElement;\n  };\n\n  return iter;\n};\n\n\n/**\n * Creates an iterator that counts indefinitely from a starting value.\n * @see http://docs.python.org/2/library/itertools.html#itertools.count\n * @param {number=} opt_start The starting value. Default is 0.\n * @param {number=} opt_step The number to increment with between each call to\n *     next. Negative and floating point numbers are allowed. Default is 1.\n * @return {!goog.iter.Iterator<number>} A new iterator that returns the values\n *     in the series.\n */\ngoog.iter.count = function(opt_start, opt_step) {\n  var counter = opt_start || 0;\n  var step = goog.isDef(opt_step) ? opt_step : 1;\n  var iter = new goog.iter.Iterator();\n\n  iter.next = function() {\n    var returnValue = counter;\n    counter += step;\n    return returnValue;\n  };\n\n  return iter;\n};\n\n\n/**\n * Creates an iterator that returns the same object or value repeatedly.\n * @param {VALUE} value Any object or value to repeat.\n * @return {!goog.iter.Iterator<VALUE>} A new iterator that returns the\n *     repeated value.\n * @template VALUE\n */\ngoog.iter.repeat = function(value) {\n  var iter = new goog.iter.Iterator();\n\n  iter.next = goog.functions.constant(value);\n\n  return iter;\n};\n\n\n/**\n * Creates an iterator that returns running totals from the numbers in\n * {@code iterable}. For example, the array {@code [1, 2, 3, 4, 5]} yields\n * {@code 1 -> 3 -> 6 -> 10 -> 15}.\n * @see http://docs.python.org/3.2/library/itertools.html#itertools.accumulate\n * @param {!goog.iter.Iterable} iterable The iterable of numbers to\n *     accumulate.\n * @return {!goog.iter.Iterator<number>} A new iterator that returns the\n *     numbers in the series.\n */\ngoog.iter.accumulate = function(iterable) {\n  var iterator = goog.iter.toIterator(iterable);\n  var total = 0;\n  var iter = new goog.iter.Iterator();\n\n  iter.next = function() {\n    total += iterator.next();\n    return total;\n  };\n\n  return iter;\n};\n\n\n/**\n * Creates an iterator that returns arrays containing the ith elements from the\n * provided iterables. The returned arrays will be the same size as the number\n * of iterables given in {@code var_args}. Once the shortest iterable is\n * exhausted, subsequent calls to {@code next()} will throw\n * {@code goog.iter.StopIteration}.\n * @see http://docs.python.org/2/library/itertools.html#itertools.izip\n * @param {...!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} var_args Any\n *     number of iterable objects.\n * @return {!goog.iter.Iterator<!Array<VALUE>>} A new iterator that returns\n *     arrays of elements from the provided iterables.\n * @template VALUE\n */\ngoog.iter.zip = function(var_args) {\n  var args = arguments;\n  var iter = new goog.iter.Iterator();\n\n  if (args.length > 0) {\n    var iterators = goog.array.map(args, goog.iter.toIterator);\n    iter.next = function() {\n      var arr = goog.array.map(iterators, function(it) { return it.next(); });\n      return arr;\n    };\n  }\n\n  return iter;\n};\n\n\n/**\n * Creates an iterator that returns arrays containing the ith elements from the\n * provided iterables. The returned arrays will be the same size as the number\n * of iterables given in {@code var_args}. Shorter iterables will be extended\n * with {@code fillValue}. Once the longest iterable is exhausted, subsequent\n * calls to {@code next()} will throw {@code goog.iter.StopIteration}.\n * @see http://docs.python.org/2/library/itertools.html#itertools.izip_longest\n * @param {VALUE} fillValue The object or value used to fill shorter iterables.\n * @param {...!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} var_args Any\n *     number of iterable objects.\n * @return {!goog.iter.Iterator<!Array<VALUE>>} A new iterator that returns\n *     arrays of elements from the provided iterables.\n * @template VALUE\n */\ngoog.iter.zipLongest = function(fillValue, var_args) {\n  var args = goog.array.slice(arguments, 1);\n  var iter = new goog.iter.Iterator();\n\n  if (args.length > 0) {\n    var iterators = goog.array.map(args, goog.iter.toIterator);\n\n    iter.next = function() {\n      var iteratorsHaveValues = false;  // false when all iterators are empty.\n      var arr = goog.array.map(iterators, function(it) {\n        var returnValue;\n        try {\n          returnValue = it.next();\n          // Iterator had a value, so we've not exhausted the iterators.\n          // Set flag accordingly.\n          iteratorsHaveValues = true;\n        } catch (ex) {\n          if (ex !== goog.iter.StopIteration) {\n            throw ex;\n          }\n          returnValue = fillValue;\n        }\n        return returnValue;\n      });\n\n      if (!iteratorsHaveValues) {\n        throw goog.iter.StopIteration;\n      }\n      return arr;\n    };\n  }\n\n  return iter;\n};\n\n\n/**\n * Creates an iterator that filters {@code iterable} based on a series of\n * {@code selectors}. On each call to {@code next()}, one item is taken from\n * both the {@code iterable} and {@code selectors} iterators. If the item from\n * {@code selectors} evaluates to true, the item from {@code iterable} is given.\n * Otherwise, it is skipped. Once either {@code iterable} or {@code selectors}\n * is exhausted, subsequent calls to {@code next()} will throw\n * {@code goog.iter.StopIteration}.\n * @see http://docs.python.org/2/library/itertools.html#itertools.compress\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterable to filter.\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} selectors An\n *     iterable of items to be evaluated in a boolean context to determine if\n *     the corresponding element in {@code iterable} should be included in the\n *     result.\n * @return {!goog.iter.Iterator<VALUE>} A new iterator that returns the\n *     filtered values.\n * @template VALUE\n */\ngoog.iter.compress = function(iterable, selectors) {\n  var selectorIterator = goog.iter.toIterator(selectors);\n\n  return goog.iter.filter(\n      iterable, function() { return !!selectorIterator.next(); });\n};\n\n\n\n/**\n * Implements the {@code goog.iter.groupBy} iterator.\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterable to group.\n * @param {function(VALUE): KEY=} opt_keyFunc  Optional function for\n *     determining the key value for each group in the {@code iterable}. Default\n *     is the identity function.\n * @constructor\n * @extends {goog.iter.Iterator<!Array<?>>}\n * @template KEY, VALUE\n * @private\n */\ngoog.iter.GroupByIterator_ = function(iterable, opt_keyFunc) {\n\n  /**\n   * The iterable to group, coerced to an iterator.\n   * @type {!goog.iter.Iterator}\n   */\n  this.iterator = goog.iter.toIterator(iterable);\n\n  /**\n   * A function for determining the key value for each element in the iterable.\n   * If no function is provided, the identity function is used and returns the\n   * element unchanged.\n   * @type {function(VALUE): KEY}\n   */\n  this.keyFunc = opt_keyFunc || goog.functions.identity;\n\n  /**\n   * The target key for determining the start of a group.\n   * @type {KEY}\n   */\n  this.targetKey;\n\n  /**\n   * The current key visited during iteration.\n   * @type {KEY}\n   */\n  this.currentKey;\n\n  /**\n   * The current value being added to the group.\n   * @type {VALUE}\n   */\n  this.currentValue;\n};\ngoog.inherits(goog.iter.GroupByIterator_, goog.iter.Iterator);\n\n\n/** @override */\ngoog.iter.GroupByIterator_.prototype.next = function() {\n  while (this.currentKey == this.targetKey) {\n    this.currentValue = this.iterator.next();  // Exits on StopIteration\n    this.currentKey = this.keyFunc(this.currentValue);\n  }\n  this.targetKey = this.currentKey;\n  return [this.currentKey, this.groupItems_(this.targetKey)];\n};\n\n\n/**\n * Performs the grouping of objects using the given key.\n * @param {KEY} targetKey  The target key object for the group.\n * @return {!Array<VALUE>} An array of grouped objects.\n * @private\n */\ngoog.iter.GroupByIterator_.prototype.groupItems_ = function(targetKey) {\n  var arr = [];\n  while (this.currentKey == targetKey) {\n    arr.push(this.currentValue);\n    try {\n      this.currentValue = this.iterator.next();\n    } catch (ex) {\n      if (ex !== goog.iter.StopIteration) {\n        throw ex;\n      }\n      break;\n    }\n    this.currentKey = this.keyFunc(this.currentValue);\n  }\n  return arr;\n};\n\n\n/**\n * Creates an iterator that returns arrays containing elements from the\n * {@code iterable} grouped by a key value. For iterables with repeated\n * elements (i.e. sorted according to a particular key function), this function\n * has a {@code uniq}-like effect. For example, grouping the array:\n * {@code [A, B, B, C, C, A]} produces\n * {@code [A, [A]], [B, [B, B]], [C, [C, C]], [A, [A]]}.\n * @see http://docs.python.org/2/library/itertools.html#itertools.groupby\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterable to group.\n * @param {function(VALUE): KEY=} opt_keyFunc  Optional function for\n *     determining the key value for each group in the {@code iterable}. Default\n *     is the identity function.\n * @return {!goog.iter.Iterator<!Array<?>>} A new iterator that returns\n *     arrays of consecutive key and groups.\n * @template KEY, VALUE\n */\ngoog.iter.groupBy = function(iterable, opt_keyFunc) {\n  return new goog.iter.GroupByIterator_(iterable, opt_keyFunc);\n};\n\n\n/**\n * Gives an iterator that gives the result of calling the given function\n * <code>f</code> with the arguments taken from the next element from\n * <code>iterable</code> (the elements are expected to also be iterables).\n *\n * Similar to {@see goog.iter#map} but allows the function to accept multiple\n * arguments from the iterable.\n *\n * @param {!goog.iter.Iterable} iterable The iterable of\n *     iterables to iterate over.\n * @param {function(this:THIS,...*):RESULT} f The function to call for every\n *     element.  This function takes N+2 arguments, where N represents the\n *     number of items from the next element of the iterable. The two\n *     additional arguments passed to the function are undefined and the\n *     iterator itself. The function should return a new value.\n * @param {THIS=} opt_obj The object to be used as the value of 'this' within\n *     {@code f}.\n * @return {!goog.iter.Iterator<RESULT>} A new iterator that returns the\n *     results of applying the function to each element in the original\n *     iterator.\n * @template THIS, RESULT\n */\ngoog.iter.starMap = function(iterable, f, opt_obj) {\n  var iterator = goog.iter.toIterator(iterable);\n  var iter = new goog.iter.Iterator();\n\n  iter.next = function() {\n    var args = goog.iter.toArray(iterator.next());\n    return f.apply(opt_obj, goog.array.concat(args, undefined, iterator));\n  };\n\n  return iter;\n};\n\n\n/**\n * Returns an array of iterators each of which can iterate over the values in\n * {@code iterable} without advancing the others.\n * @see http://docs.python.org/2/library/itertools.html#itertools.tee\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterable to tee.\n * @param {number=} opt_num  The number of iterators to create. Default is 2.\n * @return {!Array<goog.iter.Iterator<VALUE>>} An array of iterators.\n * @template VALUE\n */\ngoog.iter.tee = function(iterable, opt_num) {\n  var iterator = goog.iter.toIterator(iterable);\n  var num = goog.isNumber(opt_num) ? opt_num : 2;\n  var buffers =\n      goog.array.map(goog.array.range(num), function() { return []; });\n\n  var addNextIteratorValueToBuffers = function() {\n    var val = iterator.next();\n    goog.array.forEach(buffers, function(buffer) { buffer.push(val); });\n  };\n\n  var createIterator = function(buffer) {\n    // Each tee'd iterator has an associated buffer (initially empty). When a\n    // tee'd iterator's buffer is empty, it calls\n    // addNextIteratorValueToBuffers(), adding the next value to all tee'd\n    // iterators' buffers, and then returns that value. This allows each\n    // iterator to be advanced independently.\n    var iter = new goog.iter.Iterator();\n\n    iter.next = function() {\n      if (goog.array.isEmpty(buffer)) {\n        addNextIteratorValueToBuffers();\n      }\n      goog.asserts.assert(!goog.array.isEmpty(buffer));\n      return buffer.shift();\n    };\n\n    return iter;\n  };\n\n  return goog.array.map(buffers, createIterator);\n};\n\n\n/**\n * Creates an iterator that returns arrays containing a count and an element\n * obtained from the given {@code iterable}.\n * @see http://docs.python.org/2/library/functions.html#enumerate\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterable to enumerate.\n * @param {number=} opt_start  Optional starting value. Default is 0.\n * @return {!goog.iter.Iterator<!Array<?>>} A new iterator containing\n *     count/item pairs.\n * @template VALUE\n */\ngoog.iter.enumerate = function(iterable, opt_start) {\n  return goog.iter.zip(goog.iter.count(opt_start), iterable);\n};\n\n\n/**\n * Creates an iterator that returns the first {@code limitSize} elements from an\n * iterable. If this number is greater than the number of elements in the\n * iterable, all the elements are returned.\n * @see http://goo.gl/V0sihp Inspired by the limit iterator in Guava.\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterable to limit.\n * @param {number} limitSize  The maximum number of elements to return.\n * @return {!goog.iter.Iterator<VALUE>} A new iterator containing\n *     {@code limitSize} elements.\n * @template VALUE\n */\ngoog.iter.limit = function(iterable, limitSize) {\n  goog.asserts.assert(goog.math.isInt(limitSize) && limitSize >= 0);\n\n  var iterator = goog.iter.toIterator(iterable);\n\n  var iter = new goog.iter.Iterator();\n  var remaining = limitSize;\n\n  iter.next = function() {\n    if (remaining-- > 0) {\n      return iterator.next();\n    }\n    throw goog.iter.StopIteration;\n  };\n\n  return iter;\n};\n\n\n/**\n * Creates an iterator that is advanced {@code count} steps ahead. Consumed\n * values are silently discarded. If {@code count} is greater than the number\n * of elements in {@code iterable}, an empty iterator is returned. Subsequent\n * calls to {@code next()} will throw {@code goog.iter.StopIteration}.\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterable to consume.\n * @param {number} count  The number of elements to consume from the iterator.\n * @return {!goog.iter.Iterator<VALUE>} An iterator advanced zero or more steps\n *     ahead.\n * @template VALUE\n */\ngoog.iter.consume = function(iterable, count) {\n  goog.asserts.assert(goog.math.isInt(count) && count >= 0);\n\n  var iterator = goog.iter.toIterator(iterable);\n\n  while (count-- > 0) {\n    goog.iter.nextOrValue(iterator, null);\n  }\n\n  return iterator;\n};\n\n\n/**\n * Creates an iterator that returns a range of elements from an iterable.\n * Similar to {@see goog.array#slice} but does not support negative indexes.\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterable to slice.\n * @param {number} start  The index of the first element to return.\n * @param {number=} opt_end  The index after the last element to return. If\n *     defined, must be greater than or equal to {@code start}.\n * @return {!goog.iter.Iterator<VALUE>} A new iterator containing a slice of\n *     the original.\n * @template VALUE\n */\ngoog.iter.slice = function(iterable, start, opt_end) {\n  goog.asserts.assert(goog.math.isInt(start) && start >= 0);\n\n  var iterator = goog.iter.consume(iterable, start);\n\n  if (goog.isNumber(opt_end)) {\n    goog.asserts.assert(goog.math.isInt(opt_end) && opt_end >= start);\n    iterator = goog.iter.limit(iterator, opt_end - start /* limitSize */);\n  }\n\n  return iterator;\n};\n\n\n/**\n * Checks an array for duplicate elements.\n * @param {?IArrayLike<VALUE>} arr The array to check for\n *     duplicates.\n * @return {boolean} True, if the array contains duplicates, false otherwise.\n * @private\n * @template VALUE\n */\n// TODO(user): Consider moving this into goog.array as a public function.\ngoog.iter.hasDuplicates_ = function(arr) {\n  var deduped = [];\n  goog.array.removeDuplicates(arr, deduped);\n  return arr.length != deduped.length;\n};\n\n\n/**\n * Creates an iterator that returns permutations of elements in\n * {@code iterable}.\n *\n * Permutations are obtained by taking the Cartesian product of\n * {@code opt_length} iterables and filtering out those with repeated\n * elements. For example, the permutations of {@code [1,2,3]} are\n * {@code [[1,2,3], [1,3,2], [2,1,3], [2,3,1], [3,1,2], [3,2,1]]}.\n * @see http://docs.python.org/2/library/itertools.html#itertools.permutations\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterable from which to generate permutations.\n * @param {number=} opt_length Length of each permutation. If omitted, defaults\n *     to the length of {@code iterable}.\n * @return {!goog.iter.Iterator<!Array<VALUE>>} A new iterator containing the\n *     permutations of {@code iterable}.\n * @template VALUE\n */\ngoog.iter.permutations = function(iterable, opt_length) {\n  var elements = goog.iter.toArray(iterable);\n  var length = goog.isNumber(opt_length) ? opt_length : elements.length;\n\n  var sets = goog.array.repeat(elements, length);\n  var product = goog.iter.product.apply(undefined, sets);\n\n  return goog.iter.filter(\n      product, function(arr) { return !goog.iter.hasDuplicates_(arr); });\n};\n\n\n/**\n * Creates an iterator that returns combinations of elements from\n * {@code iterable}.\n *\n * Combinations are obtained by taking the {@see goog.iter#permutations} of\n * {@code iterable} and filtering those whose elements appear in the order they\n * are encountered in {@code iterable}. For example, the 3-length combinations\n * of {@code [0,1,2,3]} are {@code [[0,1,2], [0,1,3], [0,2,3], [1,2,3]]}.\n * @see http://docs.python.org/2/library/itertools.html#itertools.combinations\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterable from which to generate combinations.\n * @param {number} length The length of each combination.\n * @return {!goog.iter.Iterator<!Array<VALUE>>} A new iterator containing\n *     combinations from the {@code iterable}.\n * @template VALUE\n */\ngoog.iter.combinations = function(iterable, length) {\n  var elements = goog.iter.toArray(iterable);\n  var indexes = goog.iter.range(elements.length);\n  var indexIterator = goog.iter.permutations(indexes, length);\n  // sortedIndexIterator will now give arrays of with the given length that\n  // indicate what indexes into \"elements\" should be returned on each iteration.\n  var sortedIndexIterator = goog.iter.filter(\n      indexIterator, function(arr) { return goog.array.isSorted(arr); });\n\n  var iter = new goog.iter.Iterator();\n\n  function getIndexFromElements(index) { return elements[index]; }\n\n  iter.next = function() {\n    return goog.array.map(sortedIndexIterator.next(), getIndexFromElements);\n  };\n\n  return iter;\n};\n\n\n/**\n * Creates an iterator that returns combinations of elements from\n * {@code iterable}, with repeated elements possible.\n *\n * Combinations are obtained by taking the Cartesian product of {@code length}\n * iterables and filtering those whose elements appear in the order they are\n * encountered in {@code iterable}. For example, the 2-length combinations of\n * {@code [1,2,3]} are {@code [[1,1], [1,2], [1,3], [2,2], [2,3], [3,3]]}.\n * @see https://goo.gl/C0yXe4\n * @see https://goo.gl/djOCsk\n * @param {!goog.iter.Iterator<VALUE>|!goog.iter.Iterable} iterable The\n *     iterable to combine.\n * @param {number} length The length of each combination.\n * @return {!goog.iter.Iterator<!Array<VALUE>>} A new iterator containing\n *     combinations from the {@code iterable}.\n * @template VALUE\n */\ngoog.iter.combinationsWithReplacement = function(iterable, length) {\n  var elements = goog.iter.toArray(iterable);\n  var indexes = goog.array.range(elements.length);\n  var sets = goog.array.repeat(indexes, length);\n  var indexIterator = goog.iter.product.apply(undefined, sets);\n  // sortedIndexIterator will now give arrays of with the given length that\n  // indicate what indexes into \"elements\" should be returned on each iteration.\n  var sortedIndexIterator = goog.iter.filter(\n      indexIterator, function(arr) { return goog.array.isSorted(arr); });\n\n  var iter = new goog.iter.Iterator();\n\n  function getIndexFromElements(index) { return elements[index]; }\n\n  iter.next = function() {\n    return goog.array.map(\n        /** @type {!Array<number>} */\n        (sortedIndexIterator.next()), getIndexFromElements);\n  };\n\n  return iter;\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Iterator subclass for DOM tree traversal.\n *\n * @author robbyw@google.com (Robby Walker)\n */\n\ngoog.provide('goog.dom.TagIterator');\ngoog.provide('goog.dom.TagWalkType');\n\ngoog.require('goog.dom');\ngoog.require('goog.dom.NodeType');\ngoog.require('goog.iter.Iterator');\ngoog.require('goog.iter.StopIteration');\n\n\n/**\n * There are three types of token:\n *  <ol>\n *    <li>{@code START_TAG} - The beginning of a tag.\n *    <li>{@code OTHER} - Any non-element node position.\n *    <li>{@code END_TAG} - The end of a tag.\n *  </ol>\n * Users of this enumeration can rely on {@code START_TAG + END_TAG = 0} and\n * that {@code OTHER = 0}.\n *\n * @enum {number}\n */\ngoog.dom.TagWalkType = {\n  START_TAG: 1,\n  OTHER: 0,\n  END_TAG: -1\n};\n\n\n\n/**\n * A DOM tree traversal iterator.\n *\n * Starting with the given node, the iterator walks the DOM in order, reporting\n * events for the start and end of Elements, and the presence of text nodes. For\n * example:\n *\n * <pre>\n * &lt;div&gt;1&lt;span&gt;2&lt;/span&gt;3&lt;/div&gt;\n * </pre>\n *\n * Will return the following nodes:\n *\n * <code>[div, 1, span, 2, span, 3, div]</code>\n *\n * With the following states:\n *\n * <code>[START, OTHER, START, OTHER, END, OTHER, END]</code>\n *\n * And the following depths\n *\n * <code>[1, 1, 2, 2, 1, 1, 0]</code>\n *\n * Imagining <code>|</code> represents iterator position, the traversal stops at\n * each of the following locations:\n *\n * <pre>\n * &lt;div&gt;|1|&lt;span&gt;|2|&lt;/span&gt;|3|&lt;/div&gt;|\n * </pre>\n *\n * The iterator can also be used in reverse mode, which will return the nodes\n * and states in the opposite order.  The depths will be slightly different\n * since, like in normal mode, the depth is computed *after* the given node.\n *\n * Lastly, it is possible to create an iterator that is unconstrained, meaning\n * that it will continue iterating until the end of the document instead of\n * until exiting the start node.\n *\n * @param {Node=} opt_node The start node.  If unspecified or null, defaults to\n *     an empty iterator.\n * @param {boolean=} opt_reversed Whether to traverse the tree in reverse.\n * @param {boolean=} opt_unconstrained Whether the iterator is not constrained\n *     to the starting node and its children.\n * @param {goog.dom.TagWalkType?=} opt_tagType The type of the position.\n *     Defaults to the start of the given node for forward iterators, and\n *     the end of the node for reverse iterators.\n * @param {number=} opt_depth The starting tree depth.\n * @constructor\n * @extends {goog.iter.Iterator<Node>}\n */\ngoog.dom.TagIterator = function(\n    opt_node, opt_reversed, opt_unconstrained, opt_tagType, opt_depth) {\n  /**\n   * Whether the node iterator is moving in reverse.\n   * @type {boolean}\n   */\n  this.reversed = !!opt_reversed;\n\n  /**\n   * The node this position is located on.\n   * @type {Node}\n   */\n  this.node = null;\n\n  /**\n   * The type of this position.\n   * @type {goog.dom.TagWalkType}\n   */\n  this.tagType = goog.dom.TagWalkType.OTHER;\n\n  /**\n   * The tree depth of this position relative to where the iterator started.\n   * The depth is considered to be the tree depth just past the current node,\n   * so if an iterator is at position\n   * <pre>\n   *     <div>|</div>\n   * </pre>\n   * (i.e. the node is the div and the type is START_TAG) its depth will be 1.\n   * @type {number}\n   */\n  this.depth;\n\n  /**\n   * Whether iteration has started.\n   * @private {boolean}\n   */\n  this.started_ = false;\n\n  /**\n   * Whether the iterator is constrained to the starting node and its children.\n   * @type {boolean}\n   */\n  this.constrained = !opt_unconstrained;\n\n  if (opt_node) {\n    this.setPosition(opt_node, opt_tagType);\n  }\n  this.depth = opt_depth != undefined ? opt_depth : this.tagType || 0;\n  if (this.reversed) {\n    this.depth *= -1;\n  }\n};\ngoog.inherits(goog.dom.TagIterator, goog.iter.Iterator);\n\n\n/**\n * Set the position of the iterator.  Overwrite the tree node and the position\n * type which can be one of the {@link goog.dom.TagWalkType} token types.\n * Only overwrites the tree depth when the parameter is specified.\n * @param {Node} node The node to set the position to.\n * @param {goog.dom.TagWalkType?=} opt_tagType The type of the position\n *     Defaults to the start of the given node.\n * @param {number=} opt_depth The tree depth.\n */\ngoog.dom.TagIterator.prototype.setPosition = function(\n    node, opt_tagType, opt_depth) {\n  this.node = node;\n\n  if (node) {\n    if (goog.isNumber(opt_tagType)) {\n      this.tagType = opt_tagType;\n    } else {\n      // Auto-determine the proper type\n      this.tagType = this.node.nodeType != goog.dom.NodeType.ELEMENT ?\n          goog.dom.TagWalkType.OTHER :\n          this.reversed ? goog.dom.TagWalkType.END_TAG :\n                          goog.dom.TagWalkType.START_TAG;\n    }\n  }\n\n  if (goog.isNumber(opt_depth)) {\n    this.depth = opt_depth;\n  }\n};\n\n\n/**\n * Replace this iterator's values with values from another. The two iterators\n * must be of the same type.\n * @param {goog.dom.TagIterator} other The iterator to copy.\n * @protected\n */\ngoog.dom.TagIterator.prototype.copyFrom = function(other) {\n  this.node = other.node;\n  this.tagType = other.tagType;\n  this.depth = other.depth;\n  this.reversed = other.reversed;\n  this.constrained = other.constrained;\n};\n\n\n/**\n * @return {!goog.dom.TagIterator} A copy of this iterator.\n */\ngoog.dom.TagIterator.prototype.clone = function() {\n  return new goog.dom.TagIterator(\n      this.node, this.reversed, !this.constrained, this.tagType, this.depth);\n};\n\n\n/**\n * Skip the current tag.\n */\ngoog.dom.TagIterator.prototype.skipTag = function() {\n  var check = this.reversed ? goog.dom.TagWalkType.END_TAG :\n                              goog.dom.TagWalkType.START_TAG;\n  if (this.tagType == check) {\n    this.tagType = /** @type {goog.dom.TagWalkType} */ (check * -1);\n    this.depth += this.tagType * (this.reversed ? -1 : 1);\n  }\n};\n\n\n/**\n * Restart the current tag.\n */\ngoog.dom.TagIterator.prototype.restartTag = function() {\n  var check = this.reversed ? goog.dom.TagWalkType.START_TAG :\n                              goog.dom.TagWalkType.END_TAG;\n  if (this.tagType == check) {\n    this.tagType = /** @type {goog.dom.TagWalkType} */ (check * -1);\n    this.depth += this.tagType * (this.reversed ? -1 : 1);\n  }\n};\n\n\n/**\n * Move to the next position in the DOM tree.\n * @return {Node} Returns the next node, or throws a goog.iter.StopIteration\n *     exception if the end of the iterator's range has been reached.\n * @override\n */\ngoog.dom.TagIterator.prototype.next = function() {\n  var node;\n\n  if (this.started_) {\n    if (!this.node || this.constrained && this.depth == 0) {\n      throw goog.iter.StopIteration;\n    }\n    node = this.node;\n\n    var startType = this.reversed ? goog.dom.TagWalkType.END_TAG :\n                                    goog.dom.TagWalkType.START_TAG;\n\n    if (this.tagType == startType) {\n      // If we have entered the tag, test if there are any children to move to.\n      var child = this.reversed ? node.lastChild : node.firstChild;\n      if (child) {\n        this.setPosition(child);\n      } else {\n        // If not, move on to exiting this tag.\n        this.setPosition(\n            node,\n            /** @type {goog.dom.TagWalkType} */ (startType * -1));\n      }\n    } else {\n      var sibling = this.reversed ? node.previousSibling : node.nextSibling;\n      if (sibling) {\n        // Try to move to the next node.\n        this.setPosition(sibling);\n      } else {\n        // If no such node exists, exit our parent.\n        this.setPosition(\n            node.parentNode,\n            /** @type {goog.dom.TagWalkType} */ (startType * -1));\n      }\n    }\n\n    this.depth += this.tagType * (this.reversed ? -1 : 1);\n  } else {\n    this.started_ = true;\n  }\n\n  // Check the new position for being last, and return it if it's not.\n  node = this.node;\n  if (!this.node) {\n    throw goog.iter.StopIteration;\n  }\n  return node;\n};\n\n\n/**\n * @return {boolean} Whether next has ever been called on this iterator.\n * @protected\n */\ngoog.dom.TagIterator.prototype.isStarted = function() {\n  return this.started_;\n};\n\n\n/**\n * @return {boolean} Whether this iterator's position is a start tag position.\n */\ngoog.dom.TagIterator.prototype.isStartTag = function() {\n  return this.tagType == goog.dom.TagWalkType.START_TAG;\n};\n\n\n/**\n * @return {boolean} Whether this iterator's position is an end tag position.\n */\ngoog.dom.TagIterator.prototype.isEndTag = function() {\n  return this.tagType == goog.dom.TagWalkType.END_TAG;\n};\n\n\n/**\n * @return {boolean} Whether this iterator's position is not at an element node.\n */\ngoog.dom.TagIterator.prototype.isNonElement = function() {\n  return this.tagType == goog.dom.TagWalkType.OTHER;\n};\n\n\n/**\n * Test if two iterators are at the same position - i.e. if the node and tagType\n * is the same.  This will still return true if the two iterators are moving in\n * opposite directions or have different constraints.\n * @param {goog.dom.TagIterator} other The iterator to compare to.\n * @return {boolean} Whether the two iterators are at the same position.\n */\ngoog.dom.TagIterator.prototype.equals = function(other) {\n  // Nodes must be equal, and we must either have reached the end of our tree\n  // or be at the same position.\n  return other.node == this.node &&\n      (!this.node || other.tagType == this.tagType);\n};\n\n\n/**\n * Replace the current node with the list of nodes. Reset the iterator so that\n * it visits the first of the nodes next.\n * @param {...Object} var_args A list of nodes to replace the current node with.\n *     If the first argument is array-like, it will be used, otherwise all the\n *     arguments are assumed to be nodes.\n */\ngoog.dom.TagIterator.prototype.splice = function(var_args) {\n  // Reset the iterator so that it iterates over the first replacement node in\n  // the arguments on the next iteration.\n  var node = this.node;\n  this.restartTag();\n  this.reversed = !this.reversed;\n  goog.dom.TagIterator.prototype.next.call(this);\n  this.reversed = !this.reversed;\n\n  // Replace the node with the arguments.\n  var arr = goog.isArrayLike(arguments[0]) ? arguments[0] : arguments;\n  for (var i = arr.length - 1; i >= 0; i--) {\n    goog.dom.insertSiblingAfter(arr[i], node);\n  }\n  goog.dom.removeNode(node);\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Iterator subclass for DOM tree traversal.\n *\n * @author robbyw@google.com (Robby Walker)\n */\n\ngoog.provide('goog.dom.NodeIterator');\n\ngoog.require('goog.dom.TagIterator');\n\n\n\n/**\n * A DOM tree traversal iterator.\n *\n * Starting with the given node, the iterator walks the DOM in order, reporting\n * events for each node.  The iterator acts as a prefix iterator:\n *\n * <pre>\n * &lt;div&gt;1&lt;span&gt;2&lt;/span&gt;3&lt;/div&gt;\n * </pre>\n *\n * Will return the following nodes:\n *\n * <code>[div, 1, span, 2, 3]</code>\n *\n * With the following depths\n *\n * <code>[1, 1, 2, 2, 1]</code>\n *\n * Imagining <code>|</code> represents iterator position, the traversal stops at\n * each of the following locations:\n *\n * <pre>&lt;div&gt;|1|&lt;span&gt;|2|&lt;/span&gt;3|&lt;/div&gt;</pre>\n *\n * The iterator can also be used in reverse mode, which will return the nodes\n * and states in the opposite order.  The depths will be slightly different\n * since, like in normal mode, the depth is computed *after* the last move.\n *\n * Lastly, it is possible to create an iterator that is unconstrained, meaning\n * that it will continue iterating until the end of the document instead of\n * until exiting the start node.\n *\n * @param {Node=} opt_node The start node.  Defaults to an empty iterator.\n * @param {boolean=} opt_reversed Whether to traverse the tree in reverse.\n * @param {boolean=} opt_unconstrained Whether the iterator is not constrained\n *     to the starting node and its children.\n * @param {number=} opt_depth The starting tree depth.\n * @constructor\n * @extends {goog.dom.TagIterator}\n * @final\n */\ngoog.dom.NodeIterator = function(\n    opt_node, opt_reversed, opt_unconstrained, opt_depth) {\n  goog.dom.TagIterator.call(\n      this, opt_node, opt_reversed, opt_unconstrained, null, opt_depth);\n};\ngoog.inherits(goog.dom.NodeIterator, goog.dom.TagIterator);\n\n\n/**\n * Moves to the next position in the DOM tree.\n * @return {Node} Returns the next node, or throws a goog.iter.StopIteration\n *     exception if the end of the iterator's range has been reached.\n * @override\n */\ngoog.dom.NodeIterator.prototype.next = function() {\n  do {\n    goog.dom.NodeIterator.superClass_.next.call(this);\n  } while (this.isEndTag());\n\n  return this.node;\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Renderer for {@link goog.ui.Palette}s.\n *\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.PaletteRenderer');\n\ngoog.require('goog.a11y.aria');\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.a11y.aria.State');\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.dom.NodeIterator');\ngoog.require('goog.dom.NodeType');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.classlist');\ngoog.require('goog.iter');\ngoog.require('goog.style');\ngoog.require('goog.ui.ControlRenderer');\ngoog.require('goog.userAgent');\n\n\n\n/**\n * Default renderer for {@link goog.ui.Palette}s.  Renders the palette as an\n * HTML table wrapped in a DIV, with one palette item per cell:\n *\n *    <div class=\"goog-palette\">\n *      <table class=\"goog-palette-table\">\n *        <tbody class=\"goog-palette-body\">\n *          <tr class=\"goog-palette-row\">\n *            <td class=\"goog-palette-cell\">...Item 0...</td>\n *            <td class=\"goog-palette-cell\">...Item 1...</td>\n *            ...\n *          </tr>\n *          <tr class=\"goog-palette-row\">\n *            ...\n *          </tr>\n *        </tbody>\n *      </table>\n *    </div>\n *\n * @constructor\n * @extends {goog.ui.ControlRenderer}\n */\ngoog.ui.PaletteRenderer = function() {\n  goog.ui.ControlRenderer.call(this);\n};\ngoog.inherits(goog.ui.PaletteRenderer, goog.ui.ControlRenderer);\ngoog.addSingletonGetter(goog.ui.PaletteRenderer);\n\n\n/**\n * Globally unique ID sequence for cells rendered by this renderer class.\n * @type {number}\n * @private\n */\ngoog.ui.PaletteRenderer.cellId_ = 0;\n\n\n/**\n * Default CSS class to be applied to the root element of components rendered\n * by this renderer.\n * @type {string}\n */\ngoog.ui.PaletteRenderer.CSS_CLASS = goog.getCssName('goog-palette');\n\n\n/**\n * Returns the palette items arranged in a table wrapped in a DIV, with the\n * renderer's own CSS class and additional state-specific classes applied to\n * it.\n * @param {goog.ui.Control} palette goog.ui.Palette to render.\n * @return {!Element} Root element for the palette.\n * @override\n */\ngoog.ui.PaletteRenderer.prototype.createDom = function(palette) {\n  var classNames = this.getClassNames(palette);\n  var element = palette.getDomHelper().createDom(\n      goog.dom.TagName.DIV, classNames ? classNames.join(' ') : null,\n      this.createGrid(\n          /** @type {Array<Node>} */ (palette.getContent()), palette.getSize(),\n          palette.getDomHelper()));\n  goog.a11y.aria.setRole(element, goog.a11y.aria.Role.GRID);\n  return element;\n};\n\n\n/**\n * Returns the given items in a table with {@code size.width} columns and\n * {@code size.height} rows.  If the table is too big, empty cells will be\n * created as needed.  If the table is too small, the items that don't fit\n * will not be rendered.\n * @param {Array<Node>} items Palette items.\n * @param {goog.math.Size} size Palette size (columns x rows); both dimensions\n *     must be specified as numbers.\n * @param {goog.dom.DomHelper} dom DOM helper for document interaction.\n * @return {!Element} Palette table element.\n */\ngoog.ui.PaletteRenderer.prototype.createGrid = function(items, size, dom) {\n  var rows = [];\n  for (var row = 0, index = 0; row < size.height; row++) {\n    var cells = [];\n    for (var column = 0; column < size.width; column++) {\n      var item = items && items[index++];\n      cells.push(this.createCell(item, dom));\n    }\n    rows.push(this.createRow(cells, dom));\n  }\n\n  return this.createTable(rows, dom);\n};\n\n\n/**\n * Returns a table element (or equivalent) that wraps the given rows.\n * @param {Array<Element>} rows Array of row elements.\n * @param {goog.dom.DomHelper} dom DOM helper for document interaction.\n * @return {!Element} Palette table element.\n */\ngoog.ui.PaletteRenderer.prototype.createTable = function(rows, dom) {\n  var table = dom.createDom(\n      goog.dom.TagName.TABLE, goog.getCssName(this.getCssClass(), 'table'),\n      dom.createDom(\n          goog.dom.TagName.TBODY, goog.getCssName(this.getCssClass(), 'body'),\n          rows));\n  table.cellSpacing = '0';\n  table.cellPadding = '0';\n  return table;\n};\n\n\n/**\n * Returns a table row element (or equivalent) that wraps the given cells.\n * @param {Array<Element>} cells Array of cell elements.\n * @param {goog.dom.DomHelper} dom DOM helper for document interaction.\n * @return {!Element} Row element.\n */\ngoog.ui.PaletteRenderer.prototype.createRow = function(cells, dom) {\n  var row = dom.createDom(\n      goog.dom.TagName.TR, goog.getCssName(this.getCssClass(), 'row'), cells);\n  goog.a11y.aria.setRole(row, goog.a11y.aria.Role.ROW);\n  return row;\n};\n\n\n/**\n * Returns a table cell element (or equivalent) that wraps the given palette\n * item (which must be a DOM node).\n * @param {Node|string} node Palette item.\n * @param {goog.dom.DomHelper} dom DOM helper for document interaction.\n * @return {!Element} Cell element.\n */\ngoog.ui.PaletteRenderer.prototype.createCell = function(node, dom) {\n  var cell = dom.createDom(\n      goog.dom.TagName.TD, {\n        'class': goog.getCssName(this.getCssClass(), 'cell'),\n        // Cells must have an ID, for accessibility, so we generate one here.\n        'id': goog.getCssName(this.getCssClass(), 'cell-') +\n            goog.ui.PaletteRenderer.cellId_++\n      },\n      node);\n  goog.a11y.aria.setRole(cell, goog.a11y.aria.Role.GRIDCELL);\n  // Initialize to an unselected state.\n  goog.a11y.aria.setState(cell, goog.a11y.aria.State.SELECTED, false);\n\n  if (!goog.dom.getTextContent(cell) && !goog.a11y.aria.getLabel(cell)) {\n    var ariaLabelForCell = this.findAriaLabelForCell_(cell);\n    if (ariaLabelForCell) {\n      goog.a11y.aria.setLabel(cell, ariaLabelForCell);\n    }\n  }\n  return cell;\n};\n\n\n/**\n * Descends the DOM and tries to find an aria label for a grid cell\n * from the first child with a label or title.\n * @param {!Element} cell The cell.\n * @return {string} The label to use.\n * @private\n */\ngoog.ui.PaletteRenderer.prototype.findAriaLabelForCell_ = function(cell) {\n  var iter = new goog.dom.NodeIterator(cell);\n  var label = '';\n  var node;\n  while (!label && (node = goog.iter.nextOrValue(iter, null))) {\n    if (node.nodeType == goog.dom.NodeType.ELEMENT) {\n      label =\n          goog.a11y.aria.getLabel(/** @type {!Element} */ (node)) || node.title;\n    }\n  }\n  return label;\n};\n\n\n/**\n * Overrides {@link goog.ui.ControlRenderer#canDecorate} to always return false.\n * @param {Element} element Ignored.\n * @return {boolean} False, since palettes don't support the decorate flow (for\n *     now).\n * @override\n */\ngoog.ui.PaletteRenderer.prototype.canDecorate = function(element) {\n  return false;\n};\n\n\n/**\n * Overrides {@link goog.ui.ControlRenderer#decorate} to be a no-op, since\n * palettes don't support the decorate flow (for now).\n * @param {goog.ui.Control} palette Ignored.\n * @param {Element} element Ignored.\n * @return {null} Always null.\n * @override\n */\ngoog.ui.PaletteRenderer.prototype.decorate = function(palette, element) {\n  return null;\n};\n\n\n/**\n * Overrides {@link goog.ui.ControlRenderer#setContent} for palettes.  Locates\n * the HTML table representing the palette grid, and replaces the contents of\n * each cell with a new element from the array of nodes passed as the second\n * argument.  If the new content has too many items the table will have more\n * rows added to fit, if there are less items than the table has cells, then the\n * left over cells will be empty.\n * @param {Element} element Root element of the palette control.\n * @param {goog.ui.ControlContent} content Array of items to replace existing\n *     palette items.\n * @override\n */\ngoog.ui.PaletteRenderer.prototype.setContent = function(element, content) {\n  var items = /** @type {Array<Node>} */ (content);\n  if (element) {\n    var tbody = goog.dom.getElementsByTagNameAndClass(\n        goog.dom.TagName.TBODY, goog.getCssName(this.getCssClass(), 'body'),\n        element)[0];\n    if (tbody) {\n      var index = 0;\n      goog.array.forEach(tbody.rows, function(row) {\n        goog.array.forEach(row.cells, function(cell) {\n          goog.dom.removeChildren(cell);\n          if (items) {\n            var item = items[index++];\n            if (item) {\n              goog.dom.appendChild(cell, item);\n            }\n          }\n        });\n      });\n\n      // Make space for any additional items.\n      if (index < items.length) {\n        var cells = [];\n        var dom = goog.dom.getDomHelper(element);\n        var width = tbody.rows[0].cells.length;\n        while (index < items.length) {\n          var item = items[index++];\n          cells.push(this.createCell(item, dom));\n          if (cells.length == width) {\n            var row = this.createRow(cells, dom);\n            goog.dom.appendChild(tbody, row);\n            cells.length = 0;\n          }\n        }\n        if (cells.length > 0) {\n          while (cells.length < width) {\n            cells.push(this.createCell('', dom));\n          }\n          var row = this.createRow(cells, dom);\n          goog.dom.appendChild(tbody, row);\n        }\n      }\n    }\n    // Make sure the new contents are still unselectable.\n    goog.style.setUnselectable(element, true, goog.userAgent.GECKO);\n  }\n};\n\n\n/**\n * Returns the item corresponding to the given node, or null if the node is\n * neither a palette cell nor part of a palette item.\n * @param {goog.ui.Palette} palette Palette in which to look for the item.\n * @param {Node} node Node to look for.\n * @return {Node} The corresponding palette item (null if not found).\n */\ngoog.ui.PaletteRenderer.prototype.getContainingItem = function(palette, node) {\n  var root = palette.getElement();\n  while (node && node.nodeType == goog.dom.NodeType.ELEMENT && node != root) {\n    if (node.tagName == goog.dom.TagName.TD &&\n        goog.dom.classlist.contains(\n            /** @type {!Element} */ (node),\n            goog.getCssName(this.getCssClass(), 'cell'))) {\n      return node.firstChild;\n    }\n    node = node.parentNode;\n  }\n\n  return null;\n};\n\n\n/**\n * Updates the highlight styling of the palette cell containing the given node\n * based on the value of the Boolean argument.\n * @param {goog.ui.Palette} palette Palette containing the item.\n * @param {Node} node Item whose cell is to be highlighted or un-highlighted.\n * @param {boolean} highlight If true, the cell is highlighted; otherwise it is\n *     un-highlighted.\n */\ngoog.ui.PaletteRenderer.prototype.highlightCell = function(\n    palette, node, highlight) {\n  if (node) {\n    var cell = this.getCellForItem(node);\n    goog.asserts.assert(cell);\n    goog.dom.classlist.enable(\n        cell, goog.getCssName(this.getCssClass(), 'cell-hover'), highlight);\n    // See http://www.w3.org/TR/2006/WD-aria-state-20061220/#activedescendent\n    // for an explanation of the activedescendent.\n    if (highlight) {\n      goog.a11y.aria.setState(\n          palette.getElementStrict(), goog.a11y.aria.State.ACTIVEDESCENDANT,\n          cell.id);\n    } else if (\n        cell.id ==\n        goog.a11y.aria.getState(\n            palette.getElementStrict(),\n            goog.a11y.aria.State.ACTIVEDESCENDANT)) {\n      goog.a11y.aria.removeState(\n          palette.getElementStrict(), goog.a11y.aria.State.ACTIVEDESCENDANT);\n    }\n  }\n};\n\n\n/**\n * @param {Node} node Item whose cell is to be returned.\n * @return {Element} The grid cell for the palette item.\n */\ngoog.ui.PaletteRenderer.prototype.getCellForItem = function(node) {\n  return /** @type {Element} */ (node ? node.parentNode : null);\n};\n\n\n/**\n * Updates the selection styling of the palette cell containing the given node\n * based on the value of the Boolean argument.\n * @param {goog.ui.Palette} palette Palette containing the item.\n * @param {Node} node Item whose cell is to be selected or deselected.\n * @param {boolean} select If true, the cell is selected; otherwise it is\n *     deselected.\n */\ngoog.ui.PaletteRenderer.prototype.selectCell = function(palette, node, select) {\n  if (node) {\n    var cell = /** @type {!Element} */ (node.parentNode);\n    goog.dom.classlist.enable(\n        cell, goog.getCssName(this.getCssClass(), 'cell-selected'), select);\n    goog.a11y.aria.setState(cell, goog.a11y.aria.State.SELECTED, select);\n  }\n};\n\n\n/**\n * Returns the CSS class to be applied to the root element of components\n * rendered using this renderer.\n * @return {string} Renderer-specific CSS class.\n * @override\n */\ngoog.ui.PaletteRenderer.prototype.getCssClass = function() {\n  return goog.ui.PaletteRenderer.CSS_CLASS;\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Single-selection model implemenation.\n *\n * TODO(attila): Add keyboard & mouse event hooks?\n * TODO(attila): Add multiple selection?\n *\n * @author attila@google.com (Attila Bodis)\n */\n\n\ngoog.provide('goog.ui.SelectionModel');\n\ngoog.require('goog.array');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.events.EventType');\n\n\n\n/**\n * Single-selection model.  Dispatches a {@link goog.events.EventType.SELECT}\n * event when a selection is made.\n * @param {Array<Object>=} opt_items Array of items; defaults to empty.\n * @extends {goog.events.EventTarget}\n * @constructor\n */\ngoog.ui.SelectionModel = function(opt_items) {\n  goog.events.EventTarget.call(this);\n\n  /**\n   * Array of items controlled by the selection model.  If the items support\n   * the {@code setSelected(Boolean)} interface, they will be (de)selected\n   * as needed.\n   * @type {!Array<Object>}\n   * @private\n   */\n  this.items_ = [];\n  this.addItems(opt_items);\n};\ngoog.inherits(goog.ui.SelectionModel, goog.events.EventTarget);\ngoog.tagUnsealableClass(goog.ui.SelectionModel);\n\n\n/**\n * The currently selected item (null if none).\n * @type {Object}\n * @private\n */\ngoog.ui.SelectionModel.prototype.selectedItem_ = null;\n\n\n/**\n * Selection handler function.  Called with two arguments (the item to be\n * selected or deselected, and a Boolean indicating whether the item is to\n * be selected or deselected).\n * @type {Function}\n * @private\n */\ngoog.ui.SelectionModel.prototype.selectionHandler_ = null;\n\n\n/**\n * Returns the selection handler function used by the selection model to change\n * the internal selection state of items under its control.\n * @return {Function} Selection handler function (null if none).\n */\ngoog.ui.SelectionModel.prototype.getSelectionHandler = function() {\n  return this.selectionHandler_;\n};\n\n\n/**\n * Sets the selection handler function to be used by the selection model to\n * change the internal selection state of items under its control.  The\n * function must take two arguments:  an item and a Boolean to indicate whether\n * the item is to be selected or deselected.  Selection handler functions are\n * only needed if the items in the selection model don't natively support the\n * {@code setSelected(Boolean)} interface.\n * @param {Function} handler Selection handler function.\n */\ngoog.ui.SelectionModel.prototype.setSelectionHandler = function(handler) {\n  this.selectionHandler_ = handler;\n};\n\n\n/**\n * Returns the number of items controlled by the selection model.\n * @return {number} Number of items.\n */\ngoog.ui.SelectionModel.prototype.getItemCount = function() {\n  return this.items_.length;\n};\n\n\n/**\n * Returns the 0-based index of the given item within the selection model, or\n * -1 if no such item is found.\n * @param {Object|undefined} item Item to look for.\n * @return {number} Index of the given item (-1 if none).\n */\ngoog.ui.SelectionModel.prototype.indexOfItem = function(item) {\n  return item ? goog.array.indexOf(this.items_, item) : -1;\n};\n\n\n/**\n * @return {Object|undefined} The first item, or undefined if there are no items\n *     in the model.\n */\ngoog.ui.SelectionModel.prototype.getFirst = function() {\n  return this.items_[0];\n};\n\n\n/**\n * @return {Object|undefined} The last item, or undefined if there are no items\n *     in the model.\n */\ngoog.ui.SelectionModel.prototype.getLast = function() {\n  return this.items_[this.items_.length - 1];\n};\n\n\n/**\n * Returns the item at the given 0-based index.\n * @param {number} index Index of the item to return.\n * @return {Object} Item at the given index (null if none).\n */\ngoog.ui.SelectionModel.prototype.getItemAt = function(index) {\n  return this.items_[index] || null;\n};\n\n\n/**\n * Bulk-adds items to the selection model.  This is more efficient than calling\n * {@link #addItem} for each new item.\n * @param {Array<Object>|undefined} items New items to add.\n */\ngoog.ui.SelectionModel.prototype.addItems = function(items) {\n  if (items) {\n    // New items shouldn't be selected.\n    goog.array.forEach(\n        items, function(item) { this.selectItem_(item, false); }, this);\n    goog.array.extend(this.items_, items);\n  }\n};\n\n\n/**\n * Adds an item at the end of the list.\n * @param {Object} item Item to add.\n */\ngoog.ui.SelectionModel.prototype.addItem = function(item) {\n  this.addItemAt(item, this.getItemCount());\n};\n\n\n/**\n * Adds an item at the given index.\n * @param {Object} item Item to add.\n * @param {number} index Index at which to add the new item.\n */\ngoog.ui.SelectionModel.prototype.addItemAt = function(item, index) {\n  if (item) {\n    // New items must not be selected.\n    this.selectItem_(item, false);\n    goog.array.insertAt(this.items_, item, index);\n  }\n};\n\n\n/**\n * Removes the given item (if it exists).  Dispatches a {@code SELECT} event if\n * the removed item was the currently selected item.\n * @param {Object} item Item to remove.\n */\ngoog.ui.SelectionModel.prototype.removeItem = function(item) {\n  if (item && goog.array.remove(this.items_, item)) {\n    if (item == this.selectedItem_) {\n      this.selectedItem_ = null;\n      this.dispatchEvent(goog.events.EventType.SELECT);\n    }\n  }\n};\n\n\n/**\n * Removes the item at the given index.\n * @param {number} index Index of the item to remove.\n */\ngoog.ui.SelectionModel.prototype.removeItemAt = function(index) {\n  this.removeItem(this.getItemAt(index));\n};\n\n\n/**\n * @return {Object} The currently selected item, or null if none.\n */\ngoog.ui.SelectionModel.prototype.getSelectedItem = function() {\n  return this.selectedItem_;\n};\n\n\n/**\n * @return {!Array<Object>} All items in the selection model.\n */\ngoog.ui.SelectionModel.prototype.getItems = function() {\n  return goog.array.clone(this.items_);\n};\n\n\n/**\n * Selects the given item, deselecting any previously selected item, and\n * dispatches a {@code SELECT} event.\n * @param {Object} item Item to select (null to clear the selection).\n */\ngoog.ui.SelectionModel.prototype.setSelectedItem = function(item) {\n  if (item != this.selectedItem_) {\n    this.selectItem_(this.selectedItem_, false);\n    this.selectedItem_ = item;\n    this.selectItem_(item, true);\n  }\n\n  // Always dispatch a SELECT event; let listeners decide what to do if the\n  // selected item hasn't changed.\n  this.dispatchEvent(goog.events.EventType.SELECT);\n};\n\n\n/**\n * @return {number} The 0-based index of the currently selected item, or -1\n *     if none.\n */\ngoog.ui.SelectionModel.prototype.getSelectedIndex = function() {\n  return this.indexOfItem(this.selectedItem_);\n};\n\n\n/**\n * Selects the item at the given index, deselecting any previously selected\n * item, and dispatches a {@code SELECT} event.\n * @param {number} index Index to select (-1 to clear the selection).\n */\ngoog.ui.SelectionModel.prototype.setSelectedIndex = function(index) {\n  this.setSelectedItem(this.getItemAt(index));\n};\n\n\n/**\n * Clears the selection model by removing all items from the selection.\n */\ngoog.ui.SelectionModel.prototype.clear = function() {\n  goog.array.clear(this.items_);\n  this.selectedItem_ = null;\n};\n\n\n/** @override */\ngoog.ui.SelectionModel.prototype.disposeInternal = function() {\n  goog.ui.SelectionModel.superClass_.disposeInternal.call(this);\n  delete this.items_;\n  this.selectedItem_ = null;\n};\n\n\n/**\n * Private helper; selects or deselects the given item based on the value of\n * the {@code select} argument.  If a selection handler has been registered\n * (via {@link #setSelectionHandler}, calls it to update the internal selection\n * state of the item.  Otherwise, attempts to call {@code setSelected(Boolean)}\n * on the item itself, provided the object supports that interface.\n * @param {Object} item Item to select or deselect.\n * @param {boolean} select If true, the object will be selected; if false, it\n *     will be deselected.\n * @private\n */\ngoog.ui.SelectionModel.prototype.selectItem_ = function(item, select) {\n  if (item) {\n    if (typeof this.selectionHandler_ == 'function') {\n      // Use the registered selection handler function.\n      this.selectionHandler_(item, select);\n    } else if (typeof item.setSelected == 'function') {\n      // Call setSelected() on the item, if it supports it.\n      item.setSelected(select);\n    }\n  }\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A palette control.  A palette is a grid that the user can\n * highlight or select via the keyboard or the mouse.\n *\n * @author attila@google.com (Attila Bodis)\n * @see ../demos/palette.html\n */\n\ngoog.provide('goog.ui.Palette');\n\ngoog.require('goog.array');\ngoog.require('goog.dom');\ngoog.require('goog.events');\ngoog.require('goog.events.EventType');\ngoog.require('goog.events.KeyCodes');\ngoog.require('goog.math.Size');\ngoog.require('goog.ui.Component');\ngoog.require('goog.ui.Control');\ngoog.require('goog.ui.PaletteRenderer');\ngoog.require('goog.ui.SelectionModel');\n\n\n\n/**\n * A palette is a grid of DOM nodes that the user can highlight or select via\n * the keyboard or the mouse.  The selection state of the palette is controlled\n * an ACTION event.  Event listeners may retrieve the selected item using the\n * {@link #getSelectedItem} or {@link #getSelectedIndex} method.\n *\n * Use this class as the base for components like color palettes or emoticon\n * pickers.  Use {@link #setContent} to set/change the items in the palette\n * after construction.  See palette.html demo for example usage.\n *\n * @param {Array<Node>} items Array of DOM nodes to be displayed as items\n *     in the palette grid (limited to one per cell).\n * @param {goog.ui.PaletteRenderer=} opt_renderer Renderer used to render or\n *     decorate the palette; defaults to {@link goog.ui.PaletteRenderer}.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper, used for\n *     document interaction.\n * @constructor\n * @extends {goog.ui.Control}\n */\ngoog.ui.Palette = function(items, opt_renderer, opt_domHelper) {\n  goog.ui.Palette.base(\n      this, 'constructor', items,\n      opt_renderer || goog.ui.PaletteRenderer.getInstance(), opt_domHelper);\n  this.setAutoStates(\n      goog.ui.Component.State.CHECKED | goog.ui.Component.State.SELECTED |\n          goog.ui.Component.State.OPENED,\n      false);\n\n  /**\n   * A fake component for dispatching events on palette cell changes.\n   * @type {!goog.ui.Palette.CurrentCell_}\n   * @private\n   */\n  this.currentCellControl_ = new goog.ui.Palette.CurrentCell_();\n  this.currentCellControl_.setParentEventTarget(this);\n\n  /**\n   * @private {number} The last highlighted index, or -1 if it never had one.\n   */\n  this.lastHighlightedIndex_ = -1;\n};\ngoog.inherits(goog.ui.Palette, goog.ui.Control);\ngoog.tagUnsealableClass(goog.ui.Palette);\n\n\n/**\n * Events fired by the palette object\n * @enum {string}\n */\ngoog.ui.Palette.EventType = {\n  AFTER_HIGHLIGHT: goog.events.getUniqueId('afterhighlight')\n};\n\n\n/**\n * Palette dimensions (columns x rows).  If the number of rows is undefined,\n * it is calculated on first use.\n * @type {goog.math.Size}\n * @private\n */\ngoog.ui.Palette.prototype.size_ = null;\n\n\n/**\n * Index of the currently highlighted item (-1 if none).\n * @type {number}\n * @private\n */\ngoog.ui.Palette.prototype.highlightedIndex_ = -1;\n\n\n/**\n * Selection model controlling the palette's selection state.\n * @type {goog.ui.SelectionModel}\n * @private\n */\ngoog.ui.Palette.prototype.selectionModel_ = null;\n\n\n// goog.ui.Component / goog.ui.Control implementation.\n\n\n/** @override */\ngoog.ui.Palette.prototype.disposeInternal = function() {\n  goog.ui.Palette.superClass_.disposeInternal.call(this);\n\n  if (this.selectionModel_) {\n    this.selectionModel_.dispose();\n    this.selectionModel_ = null;\n  }\n\n  this.size_ = null;\n\n  this.currentCellControl_.dispose();\n};\n\n\n/**\n * Overrides {@link goog.ui.Control#setContentInternal} by also updating the\n * grid size and the selection model.  Considered protected.\n * @param {goog.ui.ControlContent} content Array of DOM nodes to be displayed\n *     as items in the palette grid (one item per cell).\n * @protected\n * @override\n */\ngoog.ui.Palette.prototype.setContentInternal = function(content) {\n  var items = /** @type {Array<Node>} */ (content);\n  goog.ui.Palette.superClass_.setContentInternal.call(this, items);\n\n  // Adjust the palette size.\n  this.adjustSize_();\n\n  // Add the items to the selection model, replacing previous items (if any).\n  if (this.selectionModel_) {\n    // We already have a selection model; just replace the items.\n    this.selectionModel_.clear();\n    this.selectionModel_.addItems(items);\n  } else {\n    // Create a selection model, initialize the items, and hook up handlers.\n    this.selectionModel_ = new goog.ui.SelectionModel(items);\n    this.selectionModel_.setSelectionHandler(goog.bind(this.selectItem_, this));\n    this.getHandler().listen(\n        this.selectionModel_, goog.events.EventType.SELECT,\n        this.handleSelectionChange);\n  }\n\n  // In all cases, clear the highlight.\n  this.highlightedIndex_ = -1;\n};\n\n\n/**\n * Overrides {@link goog.ui.Control#getCaption} to return the empty string,\n * since palettes don't have text captions.\n * @return {string} The empty string.\n * @override\n */\ngoog.ui.Palette.prototype.getCaption = function() {\n  return '';\n};\n\n\n/**\n * Overrides {@link goog.ui.Control#setCaption} to be a no-op, since palettes\n * don't have text captions.\n * @param {string} caption Ignored.\n * @override\n */\ngoog.ui.Palette.prototype.setCaption = function(caption) {\n  // Do nothing.\n};\n\n\n// Palette event handling.\n\n\n/**\n * Handles mouseover events.  Overrides {@link goog.ui.Control#handleMouseOver}\n * by determining which palette item (if any) was moused over, highlighting it,\n * and un-highlighting any previously-highlighted item.\n * @param {goog.events.BrowserEvent} e Mouse event to handle.\n * @override\n */\ngoog.ui.Palette.prototype.handleMouseOver = function(e) {\n  goog.ui.Palette.superClass_.handleMouseOver.call(this, e);\n\n  var item = this.getRenderer().getContainingItem(this, e.target);\n  if (item && e.relatedTarget && goog.dom.contains(item, e.relatedTarget)) {\n    // Ignore internal mouse moves.\n    return;\n  }\n\n  if (item != this.getHighlightedItem()) {\n    this.setHighlightedItem(item);\n  }\n};\n\n\n/**\n * Handles mousedown events.  Overrides {@link goog.ui.Control#handleMouseDown}\n * by ensuring that the item on which the user moused down is highlighted.\n * @param {goog.events.Event} e Mouse event to handle.\n * @override\n */\ngoog.ui.Palette.prototype.handleMouseDown = function(e) {\n  goog.ui.Palette.superClass_.handleMouseDown.call(this, e);\n\n  if (this.isActive()) {\n    // Make sure we move the highlight to the cell on which the user moused\n    // down.\n    var item = this.getRenderer().getContainingItem(this, e.target);\n    if (item != this.getHighlightedItem()) {\n      this.setHighlightedItem(item);\n    }\n  }\n};\n\n\n/**\n * Selects the currently highlighted palette item (triggered by mouseup or by\n * keyboard action).  Overrides {@link goog.ui.Control#performActionInternal}\n * by selecting the highlighted item and dispatching an ACTION event.\n * @param {goog.events.Event} e Mouse or key event that triggered the action.\n * @return {boolean} True if the action was allowed to proceed, false otherwise.\n * @override\n */\ngoog.ui.Palette.prototype.performActionInternal = function(e) {\n  var highlightedItem = this.getHighlightedItem();\n  if (highlightedItem) {\n    if (e && this.shouldSelectHighlightedItem_(e)) {\n      this.setSelectedItem(highlightedItem);\n    }\n    return goog.ui.Palette.base(this, 'performActionInternal', e);\n  }\n  return false;\n};\n\n\n/**\n * Determines whether to select the highlighted item while handling an internal\n * action. The highlighted item should not be selected if the action is a mouse\n * event occurring outside the palette or in an \"empty\" cell.\n * @param {!goog.events.Event} e Mouseup or key event being handled.\n * @return {boolean} True if the highlighted item should be selected.\n * @private\n */\ngoog.ui.Palette.prototype.shouldSelectHighlightedItem_ = function(e) {\n  if (!this.getSelectedItem()) {\n    // It's always ok to select when nothing is selected yet.\n    return true;\n  } else if (e.type != 'mouseup') {\n    // Keyboard can only act on valid cells.\n    return true;\n  } else {\n    // Return whether or not the mouse action was in the palette.\n    return !!this.getRenderer().getContainingItem(this, e.target);\n  }\n};\n\n\n/**\n * Handles keyboard events dispatched while the palette has focus.  Moves the\n * highlight on arrow keys, and selects the highlighted item on Enter or Space.\n * Returns true if the event was handled, false otherwise.  In particular, if\n * the user attempts to navigate out of the grid, the highlight isn't changed,\n * and this method returns false; it is then up to the parent component to\n * handle the event (e.g. by wrapping the highlight around).  Overrides {@link\n * goog.ui.Control#handleKeyEvent}.\n * @param {goog.events.KeyEvent} e Key event to handle.\n * @return {boolean} True iff the key event was handled by the component.\n * @override\n */\ngoog.ui.Palette.prototype.handleKeyEvent = function(e) {\n  var items = this.getContent();\n  var numItems = items ? items.length : 0;\n  var numColumns = this.size_.width;\n\n  // If the component is disabled or the palette is empty, bail.\n  if (numItems == 0 || !this.isEnabled()) {\n    return false;\n  }\n\n  // User hit ENTER or SPACE; trigger action.\n  if (e.keyCode == goog.events.KeyCodes.ENTER ||\n      e.keyCode == goog.events.KeyCodes.SPACE) {\n    return this.performActionInternal(e);\n  }\n\n  // User hit HOME or END; move highlight.\n  if (e.keyCode == goog.events.KeyCodes.HOME) {\n    this.setHighlightedIndex(0);\n    return true;\n  } else if (e.keyCode == goog.events.KeyCodes.END) {\n    this.setHighlightedIndex(numItems - 1);\n    return true;\n  }\n\n  // If nothing is highlighted, start from the selected index.  If nothing is\n  // selected either, highlightedIndex is -1.\n  var highlightedIndex = this.highlightedIndex_ < 0 ? this.getSelectedIndex() :\n                                                      this.highlightedIndex_;\n\n  switch (e.keyCode) {\n    case goog.events.KeyCodes.LEFT:\n      // If the highlighted index is uninitialized, or is at the beginning, move\n      // it to the end.\n      if (highlightedIndex == -1 || highlightedIndex == 0) {\n        highlightedIndex = numItems;\n      }\n      this.setHighlightedIndex(highlightedIndex - 1);\n      e.preventDefault();\n      return true;\n      break;\n\n    case goog.events.KeyCodes.RIGHT:\n      // If the highlighted index at the end, move it to the beginning.\n      if (highlightedIndex == numItems - 1) {\n        highlightedIndex = -1;\n      }\n      this.setHighlightedIndex(highlightedIndex + 1);\n      e.preventDefault();\n      return true;\n      break;\n\n    case goog.events.KeyCodes.UP:\n      if (highlightedIndex == -1) {\n        highlightedIndex = numItems + numColumns - 1;\n      }\n      if (highlightedIndex >= numColumns) {\n        this.setHighlightedIndex(highlightedIndex - numColumns);\n        e.preventDefault();\n        return true;\n      }\n      break;\n\n    case goog.events.KeyCodes.DOWN:\n      if (highlightedIndex == -1) {\n        highlightedIndex = -numColumns;\n      }\n      if (highlightedIndex < numItems - numColumns) {\n        this.setHighlightedIndex(highlightedIndex + numColumns);\n        e.preventDefault();\n        return true;\n      }\n      break;\n  }\n\n  return false;\n};\n\n\n/**\n * Handles selection change events dispatched by the selection model.\n * @param {goog.events.Event} e Selection event to handle.\n */\ngoog.ui.Palette.prototype.handleSelectionChange = function(e) {\n  // No-op in the base class.\n};\n\n\n// Palette management.\n\n\n/**\n * Returns the size of the palette grid.\n * @return {goog.math.Size} Palette size (columns x rows).\n */\ngoog.ui.Palette.prototype.getSize = function() {\n  return this.size_;\n};\n\n\n/**\n * Sets the size of the palette grid to the given size.  Callers can either\n * pass a single {@link goog.math.Size} or a pair of numbers (first the number\n * of columns, then the number of rows) to this method.  In both cases, the\n * number of rows is optional and will be calculated automatically if needed.\n * It is an error to attempt to change the size of the palette after it has\n * been rendered.\n * @param {goog.math.Size|number} size Either a size object or the number of\n *     columns.\n * @param {number=} opt_rows The number of rows (optional).\n */\ngoog.ui.Palette.prototype.setSize = function(size, opt_rows) {\n  if (this.getElement()) {\n    throw Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  }\n\n  this.size_ = goog.isNumber(size) ?\n      new goog.math.Size(size, /** @type {number} */ (opt_rows)) :\n      size;\n\n  // Adjust size, if needed.\n  this.adjustSize_();\n};\n\n\n/**\n * Returns the 0-based index of the currently highlighted palette item, or -1\n * if no item is highlighted.\n * @return {number} Index of the highlighted item (-1 if none).\n */\ngoog.ui.Palette.prototype.getHighlightedIndex = function() {\n  return this.highlightedIndex_;\n};\n\n\n/**\n * Returns the currently highlighted palette item, or null if no item is\n * highlighted.\n * @return {Node} The highlighted item (undefined if none).\n */\ngoog.ui.Palette.prototype.getHighlightedItem = function() {\n  var items = this.getContent();\n  return items && items[this.highlightedIndex_];\n};\n\n\n/**\n * @return {Element} The highlighted cell.\n * @private\n */\ngoog.ui.Palette.prototype.getHighlightedCellElement_ = function() {\n  return this.getRenderer().getCellForItem(this.getHighlightedItem());\n};\n\n\n/**\n * Highlights the item at the given 0-based index, or removes the highlight\n * if the argument is -1 or out of range.  Any previously-highlighted item\n * will be un-highlighted.\n * @param {number} index 0-based index of the item to highlight.\n */\ngoog.ui.Palette.prototype.setHighlightedIndex = function(index) {\n  if (index != this.highlightedIndex_) {\n    this.highlightIndex_(this.highlightedIndex_, false);\n    this.lastHighlightedIndex_ = this.highlightedIndex_;\n    this.highlightedIndex_ = index;\n    this.highlightIndex_(index, true);\n    this.dispatchEvent(goog.ui.Palette.EventType.AFTER_HIGHLIGHT);\n  }\n};\n\n\n/**\n * Highlights the given item, or removes the highlight if the argument is null\n * or invalid.  Any previously-highlighted item will be un-highlighted.\n * @param {Node|undefined} item Item to highlight.\n */\ngoog.ui.Palette.prototype.setHighlightedItem = function(item) {\n  var items = /** @type {Array<Node>} */ (this.getContent());\n  this.setHighlightedIndex(\n      (items && item) ? goog.array.indexOf(items, item) : -1);\n};\n\n\n/**\n * Returns the 0-based index of the currently selected palette item, or -1\n * if no item is selected.\n * @return {number} Index of the selected item (-1 if none).\n */\ngoog.ui.Palette.prototype.getSelectedIndex = function() {\n  return this.selectionModel_ ? this.selectionModel_.getSelectedIndex() : -1;\n};\n\n\n/**\n * Returns the currently selected palette item, or null if no item is selected.\n * @return {Node} The selected item (null if none).\n */\ngoog.ui.Palette.prototype.getSelectedItem = function() {\n  return this.selectionModel_ ?\n      /** @type {Node} */ (this.selectionModel_.getSelectedItem()) :\n                          null;\n};\n\n\n/**\n * Selects the item at the given 0-based index, or clears the selection\n * if the argument is -1 or out of range.  Any previously-selected item\n * will be deselected.\n * @param {number} index 0-based index of the item to select.\n */\ngoog.ui.Palette.prototype.setSelectedIndex = function(index) {\n  if (this.selectionModel_) {\n    this.selectionModel_.setSelectedIndex(index);\n  }\n};\n\n\n/**\n * Selects the given item, or clears the selection if the argument is null or\n * invalid.  Any previously-selected item will be deselected.\n * @param {Node} item Item to select.\n */\ngoog.ui.Palette.prototype.setSelectedItem = function(item) {\n  if (this.selectionModel_) {\n    this.selectionModel_.setSelectedItem(item);\n  }\n};\n\n\n/**\n * Private helper; highlights or un-highlights the item at the given index\n * based on the value of the Boolean argument.  This implementation simply\n * applies highlight styling to the cell containing the item to be highighted.\n * Does nothing if the palette hasn't been rendered yet.\n * @param {number} index 0-based index of item to highlight or un-highlight.\n * @param {boolean} highlight If true, the item is highlighted; otherwise it\n *     is un-highlighted.\n * @private\n */\ngoog.ui.Palette.prototype.highlightIndex_ = function(index, highlight) {\n  if (this.getElement()) {\n    var items = this.getContent();\n    if (items && index >= 0 && index < items.length) {\n      var cellEl = this.getHighlightedCellElement_();\n      if (this.currentCellControl_.getElement() != cellEl) {\n        this.currentCellControl_.setElementInternal(cellEl);\n      }\n      if (this.currentCellControl_.tryHighlight(highlight)) {\n        this.getRenderer().highlightCell(this, items[index], highlight);\n      }\n    }\n  }\n};\n\n\n/** @override */\ngoog.ui.Palette.prototype.setHighlighted = function(highlight) {\n  if (highlight && this.highlightedIndex_ == -1) {\n    // If there was a last highlighted index, use that. Otherwise, highlight the\n    // first cell.\n    this.setHighlightedIndex(\n        this.lastHighlightedIndex_ > -1 ? this.lastHighlightedIndex_ : 0);\n  } else if (!highlight) {\n    this.setHighlightedIndex(-1);\n  }\n  // The highlight event should be fired once the component has updated its own\n  // state.\n  goog.ui.Palette.base(this, 'setHighlighted', highlight);\n};\n\n\n/**\n * Private helper; selects or deselects the given item based on the value of\n * the Boolean argument.  This implementation simply applies selection styling\n * to the cell containing the item to be selected.  Does nothing if the palette\n * hasn't been rendered yet.\n * @param {Node} item Item to select or deselect.\n * @param {boolean} select If true, the item is selected; otherwise it is\n *     deselected.\n * @private\n */\ngoog.ui.Palette.prototype.selectItem_ = function(item, select) {\n  if (this.getElement()) {\n    this.getRenderer().selectCell(this, item, select);\n  }\n};\n\n\n/**\n * Calculates and updates the size of the palette based on any preset values\n * and the number of palette items.  If there is no preset size, sets the\n * palette size to the smallest square big enough to contain all items.  If\n * there is a preset number of columns, increases the number of rows to hold\n * all items if needed.  (If there are too many rows, does nothing.)\n * @private\n */\ngoog.ui.Palette.prototype.adjustSize_ = function() {\n  var items = this.getContent();\n  if (items) {\n    if (this.size_ && this.size_.width) {\n      // There is already a size set; honor the number of columns (if >0), but\n      // increase the number of rows if needed.\n      var minRows = Math.ceil(items.length / this.size_.width);\n      if (!goog.isNumber(this.size_.height) || this.size_.height < minRows) {\n        this.size_.height = minRows;\n      }\n    } else {\n      // No size has been set; size the grid to the smallest square big enough\n      // to hold all items (hey, why not?).\n      var length = Math.ceil(Math.sqrt(items.length));\n      this.size_ = new goog.math.Size(length, length);\n    }\n  } else {\n    // No items; set size to 0x0.\n    this.size_ = new goog.math.Size(0, 0);\n  }\n};\n\n\n\n/**\n * A component to represent the currently highlighted cell.\n * @constructor\n * @extends {goog.ui.Control}\n * @private\n */\ngoog.ui.Palette.CurrentCell_ = function() {\n  goog.ui.Palette.CurrentCell_.base(this, 'constructor', null);\n  this.setDispatchTransitionEvents(goog.ui.Component.State.HOVER, true);\n};\ngoog.inherits(goog.ui.Palette.CurrentCell_, goog.ui.Control);\n\n\n/**\n * @param {boolean} highlight Whether to highlight or unhighlight the component.\n * @return {boolean} Whether it was successful.\n */\ngoog.ui.Palette.CurrentCell_.prototype.tryHighlight = function(highlight) {\n  this.setHighlighted(highlight);\n  return this.isHighlighted() == highlight;\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A control for representing a palette of colors, that the user\n * can highlight or select via the keyboard or the mouse.\n *\n */\n\ngoog.provide('goog.ui.ColorPalette');\n\ngoog.require('goog.array');\ngoog.require('goog.color');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.style');\ngoog.require('goog.ui.Palette');\ngoog.require('goog.ui.PaletteRenderer');\n\n\n\n/**\n * A color palette is a grid of color swatches that the user can highlight or\n * select via the keyboard or the mouse.  The selection state of the palette is\n * controlled by a selection model.  When the user makes a selection, the\n * component fires an ACTION event.  Event listeners may retrieve the selected\n * color using the {@link #getSelectedColor} method.\n *\n * @param {Array<string>=} opt_colors Array of colors in any valid CSS color\n *     format.\n * @param {goog.ui.PaletteRenderer=} opt_renderer Renderer used to render or\n *     decorate the palette; defaults to {@link goog.ui.PaletteRenderer}.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper, used for\n *     document interaction.\n * @constructor\n * @extends {goog.ui.Palette}\n */\ngoog.ui.ColorPalette = function(opt_colors, opt_renderer, opt_domHelper) {\n  /**\n   * Array of colors to show in the palette.\n   * @type {Array<string>}\n   * @private\n   */\n  this.colors_ = opt_colors || [];\n\n  goog.ui.Palette.call(\n      this, null, opt_renderer || goog.ui.PaletteRenderer.getInstance(),\n      opt_domHelper);\n\n  // Set the colors separately from the super call since we need the correct\n  // DomHelper to be initialized for this class.\n  this.setColors(this.colors_);\n};\ngoog.inherits(goog.ui.ColorPalette, goog.ui.Palette);\ngoog.tagUnsealableClass(goog.ui.ColorPalette);\n\n\n/**\n * Array of normalized colors. Initialized lazily as often never needed.\n * @type {?Array<string>}\n * @private\n */\ngoog.ui.ColorPalette.prototype.normalizedColors_ = null;\n\n\n/**\n * Array of labels for the colors. Will be used for the tooltips and\n * accessibility.\n * @type {?Array<string>}\n * @private\n */\ngoog.ui.ColorPalette.prototype.labels_ = null;\n\n\n/**\n * Returns the array of colors represented in the color palette.\n * @return {Array<string>} Array of colors.\n */\ngoog.ui.ColorPalette.prototype.getColors = function() {\n  return this.colors_;\n};\n\n\n/**\n * Sets the colors that are contained in the palette.\n * @param {Array<string>} colors Array of colors in any valid CSS color format.\n * @param {Array<string>=} opt_labels The array of labels to be used as\n *        tooltips. When not provided, the color value will be used.\n */\ngoog.ui.ColorPalette.prototype.setColors = function(colors, opt_labels) {\n  this.colors_ = colors;\n  this.labels_ = opt_labels || null;\n  this.normalizedColors_ = null;\n  this.setContent(this.createColorNodes());\n};\n\n\n/**\n * @return {?string} The current selected color in hex, or null.\n */\ngoog.ui.ColorPalette.prototype.getSelectedColor = function() {\n  var selectedItem = /** @type {Element} */ (this.getSelectedItem());\n  if (selectedItem) {\n    var color = goog.style.getStyle(selectedItem, 'background-color');\n    return goog.ui.ColorPalette.parseColor_(color);\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * Sets the selected color.  Clears the selection if the argument is null or\n * can't be parsed as a color.\n * @param {?string} color The color to set as selected; null clears the\n *     selection.\n */\ngoog.ui.ColorPalette.prototype.setSelectedColor = function(color) {\n  var hexColor = goog.ui.ColorPalette.parseColor_(color);\n  if (!this.normalizedColors_) {\n    this.normalizedColors_ = goog.array.map(this.colors_, function(color) {\n      return goog.ui.ColorPalette.parseColor_(color);\n    });\n  }\n  this.setSelectedIndex(\n      hexColor ? goog.array.indexOf(this.normalizedColors_, hexColor) : -1);\n};\n\n\n/**\n * @return {!Array<!Node>} An array of DOM nodes for each color.\n * @protected\n */\ngoog.ui.ColorPalette.prototype.createColorNodes = function() {\n  return goog.array.map(this.colors_, function(color, index) {\n    var swatch = this.getDomHelper().createDom(goog.dom.TagName.DIV, {\n      'class': goog.getCssName(this.getRenderer().getCssClass(), 'colorswatch'),\n      'style': 'background-color:' + color\n    });\n    if (this.labels_ && this.labels_[index]) {\n      swatch.title = this.labels_[index];\n    } else {\n      swatch.title = color.charAt(0) == '#' ?\n          'RGB (' + goog.color.hexToRgb(color).join(', ') + ')' :\n          color;\n    }\n    return swatch;\n  }, this);\n};\n\n\n/**\n * Takes a string, attempts to parse it as a color spec, and returns a\n * normalized hex color spec if successful (null otherwise).\n * @param {?string} color String possibly containing a color spec; may be null.\n * @return {?string} Normalized hex color spec, or null if the argument can't\n *     be parsed as a color.\n * @private\n */\ngoog.ui.ColorPalette.parseColor_ = function(color) {\n  if (color) {\n    /** @preserveTry */\n    try {\n      return goog.color.parse(color).hex;\n    } catch (ex) {\n      // Fall through.\n    }\n  }\n  return null;\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A color picker component.  A color picker can compose several\n * instances of goog.ui.ColorPalette.\n *\n * NOTE: The ColorPicker is in a state of transition towards the common\n * component/control/container interface we are developing.  If the API changes\n * we will do our best to update your code.  The end result will be that a\n * color picker will compose multiple color palettes.  In the simple case this\n * will be one grid, but may consistute 3 distinct grids, a custom color picker\n * or even a color wheel.\n *\n */\n\ngoog.provide('goog.ui.ColorPicker');\ngoog.provide('goog.ui.ColorPicker.EventType');\n\ngoog.require('goog.ui.ColorPalette');\ngoog.require('goog.ui.Component');\n\n\n\n/**\n * Create a new, empty color picker.\n *\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper.\n * @param {goog.ui.ColorPalette=} opt_colorPalette Optional color palette to\n *     use for this color picker.\n * @extends {goog.ui.Component}\n * @constructor\n * @final\n */\ngoog.ui.ColorPicker = function(opt_domHelper, opt_colorPalette) {\n  goog.ui.Component.call(this, opt_domHelper);\n\n  /**\n   * The color palette used inside the color picker.\n   * @type {goog.ui.ColorPalette?}\n   * @private\n   */\n  this.colorPalette_ = opt_colorPalette || null;\n\n  this.getHandler().listen(\n      this, goog.ui.Component.EventType.ACTION, this.onColorPaletteAction_);\n};\ngoog.inherits(goog.ui.ColorPicker, goog.ui.Component);\n\n\n/**\n * Default number of columns in the color palette. May be overridden by calling\n * setSize.\n *\n * @type {number}\n */\ngoog.ui.ColorPicker.DEFAULT_NUM_COLS = 5;\n\n\n/**\n * Constants for event names.\n * @enum {string}\n */\ngoog.ui.ColorPicker.EventType = {\n  CHANGE: 'change'\n};\n\n\n/**\n * Whether the component is focusable.\n * @type {boolean}\n * @private\n */\ngoog.ui.ColorPicker.prototype.focusable_ = true;\n\n\n/**\n * Gets the array of colors displayed by the color picker.\n * Modifying this array will lead to unexpected behavior.\n * @return {Array<string>?} The colors displayed by this widget.\n */\ngoog.ui.ColorPicker.prototype.getColors = function() {\n  return this.colorPalette_ ? this.colorPalette_.getColors() : null;\n};\n\n\n/**\n * Sets the array of colors to be displayed by the color picker.\n * @param {Array<string>} colors The array of colors to be added.\n */\ngoog.ui.ColorPicker.prototype.setColors = function(colors) {\n  // TODO(user): Don't add colors directly, we should add palettes and the\n  // picker should support multiple palettes.\n  if (!this.colorPalette_) {\n    this.createColorPalette_(colors);\n  } else {\n    this.colorPalette_.setColors(colors);\n  }\n};\n\n\n/**\n * Sets the array of colors to be displayed by the color picker.\n * @param {Array<string>} colors The array of colors to be added.\n * @deprecated Use setColors.\n */\ngoog.ui.ColorPicker.prototype.addColors = function(colors) {\n  this.setColors(colors);\n};\n\n\n/**\n * Sets the size of the palette.  Will throw an error after the picker has been\n * rendered.\n * @param {goog.math.Size|number} size The size of the grid.\n */\ngoog.ui.ColorPicker.prototype.setSize = function(size) {\n  // TODO(user): The color picker should contain multiple palettes which will\n  // all be resized at this point.\n  if (!this.colorPalette_) {\n    this.createColorPalette_([]);\n  }\n  this.colorPalette_.setSize(size);\n};\n\n\n/**\n * Gets the number of columns displayed.\n * @return {goog.math.Size?} The size of the grid.\n */\ngoog.ui.ColorPicker.prototype.getSize = function() {\n  return this.colorPalette_ ? this.colorPalette_.getSize() : null;\n};\n\n\n/**\n * Sets the number of columns.  Will throw an error after the picker has been\n * rendered.\n * @param {number} n The number of columns.\n * @deprecated Use setSize.\n */\ngoog.ui.ColorPicker.prototype.setColumnCount = function(n) {\n  this.setSize(n);\n};\n\n\n/**\n * @return {number} The index of the color selected.\n */\ngoog.ui.ColorPicker.prototype.getSelectedIndex = function() {\n  return this.colorPalette_ ? this.colorPalette_.getSelectedIndex() : -1;\n};\n\n\n/**\n * Sets which color is selected. A value that is out-of-range means that no\n * color is selected.\n * @param {number} ind The index in this.colors_ of the selected color.\n */\ngoog.ui.ColorPicker.prototype.setSelectedIndex = function(ind) {\n  if (this.colorPalette_) {\n    this.colorPalette_.setSelectedIndex(ind);\n  }\n};\n\n\n/**\n * Gets the color that is currently selected in this color picker.\n * @return {?string} The hex string of the color selected, or null if no\n *     color is selected.\n */\ngoog.ui.ColorPicker.prototype.getSelectedColor = function() {\n  return this.colorPalette_ ? this.colorPalette_.getSelectedColor() : null;\n};\n\n\n/**\n * Sets which color is selected.  Noop if the color palette hasn't been created\n * yet.\n * @param {string} color The selected color.\n */\ngoog.ui.ColorPicker.prototype.setSelectedColor = function(color) {\n  // TODO(user): This will set the color in the first available palette that\n  // contains it\n  if (this.colorPalette_) {\n    this.colorPalette_.setSelectedColor(color);\n  }\n};\n\n\n/**\n * Returns true if the component is focusable, false otherwise.  The default\n * is true.  Focusable components always have a tab index and allocate a key\n * handler to handle keyboard events while focused.\n * @return {boolean} True iff the component is focusable.\n */\ngoog.ui.ColorPicker.prototype.isFocusable = function() {\n  return this.focusable_;\n};\n\n\n/**\n * Sets whether the component is focusable.  The default is true.\n * Focusable components always have a tab index and allocate a key handler to\n * handle keyboard events while focused.\n * @param {boolean} focusable True iff the component is focusable.\n */\ngoog.ui.ColorPicker.prototype.setFocusable = function(focusable) {\n  this.focusable_ = focusable;\n  if (this.colorPalette_) {\n    this.colorPalette_.setSupportedState(\n        goog.ui.Component.State.FOCUSED, focusable);\n  }\n};\n\n\n/**\n * ColorPickers cannot be used to decorate pre-existing html, since the\n * structure they build is fairly complicated.\n * @param {Element} element Element to decorate.\n * @return {boolean} Returns always false.\n * @override\n */\ngoog.ui.ColorPicker.prototype.canDecorate = function(element) {\n  return false;\n};\n\n\n/**\n * Renders the color picker inside the provided element. This will override the\n * current content of the element.\n * @override\n */\ngoog.ui.ColorPicker.prototype.enterDocument = function() {\n  goog.ui.ColorPicker.superClass_.enterDocument.call(this);\n  if (this.colorPalette_) {\n    this.colorPalette_.render(this.getElement());\n  }\n  this.getElement().unselectable = 'on';\n};\n\n\n/** @override */\ngoog.ui.ColorPicker.prototype.disposeInternal = function() {\n  goog.ui.ColorPicker.superClass_.disposeInternal.call(this);\n  if (this.colorPalette_) {\n    this.colorPalette_.dispose();\n    this.colorPalette_ = null;\n  }\n};\n\n\n/**\n * Sets the focus to the color picker's palette.\n */\ngoog.ui.ColorPicker.prototype.focus = function() {\n  if (this.colorPalette_) {\n    this.colorPalette_.getElement().focus();\n  }\n};\n\n\n/**\n * Handles actions from the color palette.\n *\n * @param {goog.events.Event} e The event.\n * @private\n */\ngoog.ui.ColorPicker.prototype.onColorPaletteAction_ = function(e) {\n  e.stopPropagation();\n  this.dispatchEvent(goog.ui.ColorPicker.EventType.CHANGE);\n};\n\n\n/**\n * Create a color palette for the color picker.\n * @param {Array<string>} colors Array of colors.\n * @private\n */\ngoog.ui.ColorPicker.prototype.createColorPalette_ = function(colors) {\n  // TODO(user): The color picker should eventually just contain a number of\n  // palettes and manage the interactions between them.  This will go away then.\n  var cp = new goog.ui.ColorPalette(colors, null, this.getDomHelper());\n  cp.setSize(goog.ui.ColorPicker.DEFAULT_NUM_COLS);\n  cp.setSupportedState(goog.ui.Component.State.FOCUSED, this.focusable_);\n  // TODO(user): Use addChild(cp, true) and remove calls to render.\n  this.addChild(cp);\n  this.colorPalette_ = cp;\n  if (this.isInDocument()) {\n    this.colorPalette_.render(this.getElement());\n  }\n};\n\n\n/**\n * Returns an unrendered instance of the color picker.  The colors and layout\n * are a simple color grid, the same as the old Gmail color picker.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper.\n * @return {!goog.ui.ColorPicker} The unrendered instance.\n */\ngoog.ui.ColorPicker.createSimpleColorGrid = function(opt_domHelper) {\n  var cp = new goog.ui.ColorPicker(opt_domHelper);\n  cp.setSize(7);\n  cp.setColors(goog.ui.ColorPicker.SIMPLE_GRID_COLORS);\n  return cp;\n};\n\n\n/**\n * Array of colors for a 7-cell wide simple-grid color picker.\n * @type {Array<string>}\n */\ngoog.ui.ColorPicker.SIMPLE_GRID_COLORS = [\n  // grays\n  '#ffffff', '#cccccc', '#c0c0c0', '#999999', '#666666', '#333333', '#000000',\n  // reds\n  '#ffcccc', '#ff6666', '#ff0000', '#cc0000', '#990000', '#660000', '#330000',\n  // oranges\n  '#ffcc99', '#ff9966', '#ff9900', '#ff6600', '#cc6600', '#993300', '#663300',\n  // yellows\n  '#ffff99', '#ffff66', '#ffcc66', '#ffcc33', '#cc9933', '#996633', '#663333',\n  // olives\n  '#ffffcc', '#ffff33', '#ffff00', '#ffcc00', '#999900', '#666600', '#333300',\n  // greens\n  '#99ff99', '#66ff99', '#33ff33', '#33cc00', '#009900', '#006600', '#003300',\n  // turquoises\n  '#99ffff', '#33ffff', '#66cccc', '#00cccc', '#339999', '#336666', '#003333',\n  // blues\n  '#ccffff', '#66ffff', '#33ccff', '#3366ff', '#3333ff', '#000099', '#000066',\n  // purples\n  '#ccccff', '#9999ff', '#6666cc', '#6633ff', '#6600cc', '#333399', '#330099',\n  // violets\n  '#ffccff', '#ff99ff', '#cc66cc', '#cc33cc', '#993399', '#663366', '#330033'\n];\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Colour input field.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.FieldColour');\n\ngoog.require('Blockly.Field');\ngoog.require('goog.ui.ColorPicker');\n\n\n/**\n * Class for a colour input field.\n * @param {string} colour The initial colour in '#rrggbb' format.\n * @param {Function} opt_changeHandler A function that is executed when a new\n *     option is selected.\n * @extends {Blockly.Field}\n * @constructor\n */\nBlockly.FieldColour = function(colour, opt_changeHandler) {\n  Blockly.FieldColour.superClass_.constructor.call(this, '\\u00A0\\u00A0\\u00A0');\n\n  this.changeHandler_ = opt_changeHandler;\n  this.borderRect_.style.fillOpacity = 1;\n  // Set the initial state.\n  this.setValue(colour);\n};\ngoog.inherits(Blockly.FieldColour, Blockly.Field);\n\n/**\n * Mouse cursor style when over the hotspot that initiates the editor.\n */\nBlockly.FieldColour.prototype.CURSOR = 'default';\n\n/**\n * Close the colour picker is this input is being deleteh\n */\nBlockly.FieldColour.prototype.dispose = function() {\n  Blockly.WidgetDiv.hideIfOwner(this);\n  Blockly.FieldColour.superClass_.dispose.call(this);\n};\n\n/**\n * Return the current colour.\n * @return {string} Current colour in '#rrggbb' format.\n */\nBlockly.FieldColour.prototype.getValue = function() {\n  return this.colour_;\n};\n\n/**\n * Set the colour.\n * @param {string} colour The new colour in '#rrggbb' format.\n */\nBlockly.FieldColour.prototype.setValue = function(colour) {\n  this.colour_ = colour;\n  this.borderRect_.style.fill = colour;\n  if (this.sourceBlock_ && this.sourceBlock_.rendered) {\n    this.sourceBlock_.blockSpace.fireChangeEvent();\n  }\n};\n\n/**\n * An array of colour strings for the palette.\n * See bottom of this page for the default:\n * http://docs.closure-library.googlecode.com/git/closure_goog_ui_colorpicker.js.source.html\n * @type {!Array.<string>}\n */\nBlockly.FieldColour.COLOURS = goog.ui.ColorPicker.SIMPLE_GRID_COLORS;\n\n/**\n * Number of columns in the palette.\n */\nBlockly.FieldColour.COLUMNS = 7;\n\n/**\n * Create a palette under the colour field.\n * @private\n */\nBlockly.FieldColour.prototype.showEditor_ = function() {\n  this.showWidgetDiv_();\n  var div = Blockly.WidgetDiv.DIV;\n  // Create the palette using Closure.\n  var picker = new goog.ui.ColorPicker();\n  picker.setSize(Blockly.FieldColour.COLUMNS);\n  picker.setColors(Blockly.FieldColour.COLOURS);\n  picker.render(div);\n  picker.setSelectedColor(this.getValue());\n\n  this.positionWidgetDiv();\n\n  // Configure event handler.\n  var thisObj = this;\n  Blockly.FieldColour.changeEventKey_ = goog.events.listen(picker,\n      goog.ui.ColorPicker.EventType.CHANGE,\n      function(event) {\n        var colour = event.target.getSelectedColor() || '#000000';\n        Blockly.WidgetDiv.hide();\n        if (thisObj.changeHandler_) {\n          // Call any change handler, and allow it to override.\n          var override = thisObj.changeHandler_(colour);\n          if (override !== undefined) {\n            colour = override;\n          }\n        }\n        if (colour !== null) {\n          thisObj.setValue(colour);\n        }\n      });\n};\n\n/**\n * @override\n */\nBlockly.FieldColour.prototype.positionWidgetDiv = function() {\n  // Position the palette to line up with the field.\n  var xy = Blockly.getAbsoluteXY_(/** @type {!Element} */ (this.borderRect_), this.\n    getRootSVGElement_());\n  if (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0) {\n      this.borderRect_.style.display = \"inline\";   /* reqd for IE */\n      var borderBBox = {\n          x: this.borderRect_.getBBox().x,\n          y: this.borderRect_.getBBox().y,\n          width: this.borderRect_.scrollWidth,\n          height: this.borderRect_.scrollHeight\n      };\n  }\n  else {\n      var borderBBox = this.borderRect_.getBBox();\n  }\n  if (Blockly.RTL) {\n    xy.x += borderBBox.width;\n  }\n  xy.y += borderBBox.height - 1;\n  if (Blockly.RTL) {\n    xy.x -= div.offsetWidth;\n  }\n\n  var windowSize = goog.dom.getViewportSize();\n  var scrollOffset = goog.style.getViewportPageOffset(document);\n  Blockly.WidgetDiv.position(xy.x, xy.y, windowSize, scrollOffset);\n}\n\n/**\n * Hide the colour palette.\n * @override\n */\nBlockly.FieldColour.prototype.generateWidgetDisposeHandler_ = function() {\n  var superWidgetDisposeHandler_ = Blockly.FieldRectangularDropdown.superClass_.generateWidgetDisposeHandler_.call(this);\n  return function() {\n    superWidgetDisposeHandler_();\n    if (Blockly.FieldColour.changeEventKey_) {\n      goog.events.unlistenByKey(Blockly.FieldColour.changeEventKey_);\n    }\n  }.bind(this);\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Class for caching image dimensions which have been dynamically determined\n */\n'use strict';\n\ngoog.provide('Blockly.ImageDimensionCache');\n\n/**\n * Cache for image dimensions\n * Hash of hashes: {imageUrl: String => {width: Number, height: Number}} \n * @private\n */\nBlockly.ImageDimensionCache.imageDimensions_ = {};\n\nBlockly.ImageDimensionCache.IMAGE_LOADING_WIDTH = 40;\nBlockly.ImageDimensionCache.IMAGE_LOADING_HEIGHT = 40;\n\n/**\n * Given a target image, calls back with its dimensions\n * If found, calls back immediately with dimensions\n * If not found, calls back with default dimensions and later with an update\n * @returns {width: *, height: *} of image (default)\n */\nBlockly.ImageDimensionCache.getCachedDimensionsOrDefaultAndUpdate = function(imageUrl, onDimensionUpdate) {\n  var cachedDimensions = Blockly.ImageDimensionCache.getCachedDimensions(imageUrl);\n  if (cachedDimensions) {\n    return cachedDimensions;\n  } else {\n    Blockly.ImageDimensionCache.getDimensionsAsync(imageUrl, onDimensionUpdate);\n    return {width: Blockly.ImageDimensionCache.IMAGE_LOADING_WIDTH, height: Blockly.ImageDimensionCache.IMAGE_LOADING_HEIGHT};\n  }\n};\n\n/**\n * @returns Dictionary of {width: Number, height: Number} or undefined if image dimensions are not already cached\n */\nBlockly.ImageDimensionCache.getCachedDimensions = function(imageUrl) {\n  return Blockly.ImageDimensionCache.imageDimensions_[imageUrl];\n};\n\nBlockly.ImageDimensionCache.storeDimensions = function(imageUrl, width, height) {\n  Blockly.ImageDimensionCache.imageDimensions_[imageUrl] = {width: width, height: height};\n};\n\n/**\n * Gets image width and height by loading the image.\n * @param {string} url\n * @param {!Function} callback Callback with parameters (width, height) to run upon\n *                    receiving width and height\n */\nBlockly.ImageDimensionCache.getDimensionsAsync = function(url, callback) {\n  var img = new Image();\n  img.onload = function(){\n    Blockly.ImageDimensionCache.storeDimensions(url, img.width, img.height);\n    callback(img.width, img.height);\n  };\n  // For cached image support in IE9, src set must occur after onload set\n  img.src = url;\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Image field.  Used for titles, labels, etc.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.FieldImage');\n\ngoog.require('Blockly.Field');\ngoog.require('goog.userAgent');\ngoog.require('Blockly.ImageDimensionCache');\n\n/**\n * Class for an image.\n * @param {string} src The URL of the image.\n * @param {number} width Width of the image.\n * @param {number} height Height of the image.\n * @extends {Blockly.Field}\n * @constructor\n */\nBlockly.FieldImage = function(src, width, height) {\n  if (!width && !height) {\n    var self = this;\n    var dimensions = Blockly.ImageDimensionCache.getCachedDimensionsOrDefaultAndUpdate(src, function(updatedWidth, updatedHeight) {\n      if (!self.isDestroyed_()) {\n        self.updateDimensions_(updatedWidth, updatedHeight);\n      }\n    });\n    width = dimensions.width;\n    height = dimensions.height;\n  }\n  this.initializeWithImage_(src, width, height);\n};\ngoog.inherits(Blockly.FieldImage, Blockly.Field);\n\nBlockly.FieldImage.prototype.isDestroyed_ = function() {\n  return !this.imageElement_;\n};\n\nBlockly.FieldImage.IMAGE_LOADING_WIDTH = 40;\nBlockly.FieldImage.IMAGE_LOADING_HEIGHT = 40;\nBlockly.FieldImage.IMAGE_OFFSET_Y = 6 - Blockly.BlockSvg.TITLE_HEIGHT;\nBlockly.FieldImage.BELOW_IMAGE_PADDING = 10;\n\nBlockly.FieldImage.prototype.initializeWithImage_ = function(src, width, height) {\n  this.sourceBlock_ = null;\n  // Ensure height and width are numbers.  Strings are bad at math.\n  height = Number(height);\n  width = Number(width);\n  this.size_ = {height: height + Blockly.FieldImage.BELOW_IMAGE_PADDING, width: width};\n  // Build the DOM.\n  this.fieldGroup_ = Blockly.createSvgElement('g', {}, null);\n  this.imageElement_ = Blockly.createSvgElement('image',\n      {'height': height + 'px',\n       'width': width + 'px',\n       'y': Blockly.FieldImage.IMAGE_OFFSET_Y}, this.fieldGroup_);\n  this.setText(src);\n  if (goog.userAgent.GECKO) {\n    // Due to a Firefox bug which eats mouse events on image elements,\n    // a transparent rectangle needs to be placed on top of the image.\n    this.clickRectElement_ = Blockly.createSvgElement('rect',\n        {'height': height + 'px',\n         'width': width + 'px',\n         'y': Blockly.FieldImage.IMAGE_OFFSET_Y,\n         'fill-opacity': 0}, this.fieldGroup_);\n  }\n};\n\nBlockly.FieldImage.prototype.updateDimensions_ = function(width, height) {\n  this.size_ = {height: height + Blockly.FieldImage.BELOW_IMAGE_PADDING, width: width};\n  this.imageElement_.setAttribute('width', width + 'px');\n  this.imageElement_.setAttribute('height', height + 'px');\n  if (this.clickRectElement_) {\n    this.clickRectElement_.setAttribute('width', width + 'px');\n    this.clickRectElement_.setAttribute('height', height + 'px');\n  }\n  this.refreshRender();\n};\n\n/**\n * Rectangular mask used by Firefox.\n * @type {Element}\n * @private\n */\nBlockly.FieldImage.prototype.clickRectElement_ = null;\n\n/**\n * Editable fields are saved by the XML renderer, non-editable fields are not.\n */\nBlockly.FieldImage.prototype.EDITABLE = false;\n\n/**\n * Install this text on a block.\n * @param {!Blockly.Block} block The block containing this text.\n */\nBlockly.FieldImage.prototype.init = function(block) {\n  if (this.sourceBlock_) {\n    throw 'Image has already been initialized once.';\n  }\n  this.sourceBlock_ = block;\n  block.getSvgRoot().appendChild(this.fieldGroup_);\n\n  // Configure the field to be transparent with respect to tooltips.\n  var topElement = this.getClickTarget();\n  topElement.tooltip = this.sourceBlock_;\n  Blockly.Tooltip && Blockly.Tooltip.bindMouseEvents(topElement);\n};\n\n/**\n * Dispose of all DOM objects belonging to this text.\n */\nBlockly.FieldImage.prototype.dispose = function() {\n  goog.dom.removeNode(this.fieldGroup_);\n  this.fieldGroup_ = null;\n  this.imageElement_ = null;\n  this.clickRectElement_ = null;\n};\n\n/**\n * Returns the click target for this image\n * @returns {Element}\n */\nBlockly.FieldImage.prototype.getClickTarget = function () {\n  return this.clickRectElement_ || this.imageElement_;\n};\n/**\n * Change the tooltip text for this field.\n * @param {string|!Element} newTip Text for tooltip or a parent element to\n *     link to for its tooltip.\n */\nBlockly.FieldImage.prototype.setTooltip = function(newTip) {\n  this.getClickTarget().tooltip = newTip;\n};\n\n/**\n * Get the source URL of this image.\n * @return {string} Current text.\n * @override\n */\nBlockly.FieldImage.prototype.getText = function() {\n  return this.src_;\n};\n\n/**\n * Set the source URL of this image.\n * @param {?string} src New source.\n * @override\n */\nBlockly.FieldImage.prototype.setText = function(src) {\n  if (src === null) {\n    // No change if null.\n    return;\n  }\n  this.src_ = src;\n  this.imageElement_.setAttributeNS('http://www.w3.org/1999/xlink',\n      'xlink:href', goog.isString(src) ? src : '');\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Single column colour dropdown input field.\n */\n'use strict';\n\ngoog.provide('Blockly.FieldColourDropdown');\ngoog.require('Blockly.Field');\ngoog.require('Blockly.FieldRectangularDropdown');\n\n/**\n * Class for a rectangular colour choice dropdown field.\n * @param {!Array.<string>} choices An array of choices for the colour dropdown list, each choice is\n *                                  a hex colour value (e.g., '#000000')\n * @param width {number}\n * @param height {number}\n * @extends {Blockly.Field}\n * @constructor\n */\nBlockly.FieldColourDropdown = function(choices, width, height) {\n  var colourChoiceTuples = this.convertColourChoicesToTuples_(choices);\n  Blockly.FieldColourDropdown.superClass_.constructor.call(this, colourChoiceTuples);\n  this.updateDimensions_(width, height);\n};\ngoog.inherits(Blockly.FieldColourDropdown, Blockly.FieldRectangularDropdown);\n\n/**\n * Convert an array of colour choices ['#000000', '#FFFFFF'] to an array of those \n * choices as preview data / value tuples for the superclass.\n * E.g., [['#000000', '#000000'], ['#FFFFFF', '#FFFFFF']]\n * @param choices\n * @returns {Array}\n * @private\n */\nBlockly.FieldColourDropdown.prototype.convertColourChoicesToTuples_ = function (choices) {\n  var previewDataValueTuples = [];\n  for (var i = 0; i < choices.length; i++) {\n    var choice = choices[i];\n    var choiceTuple = [];\n    choiceTuple[Blockly.FieldRectangularDropdown.TUPLE_PREVIEW_DATA_INDEX] = choice;\n    choiceTuple[Blockly.FieldRectangularDropdown.TUPLE_VALUE_INDEX] = choice;\n    previewDataValueTuples.push(choiceTuple);\n  }\n  return previewDataValueTuples;\n};\n\nBlockly.FieldColourDropdown.prototype.addPreviewElementTo_ = function(parentElement) {\n  this.previewElement_ = Blockly.createSvgElement('rect', {\n    'y': Blockly.FieldImage.IMAGE_OFFSET_Y,\n    'height': Blockly.FieldImage.IMAGE_LOADING_HEIGHT + 'px',\n    'width': Blockly.FieldImage.IMAGE_LOADING_WIDTH + 'px'\n  }, parentElement);\n};\n\nBlockly.FieldColourDropdown.prototype.createDropdownPreviewElement_ = function(previewData) {\n  var rect = document.createElement('div');\n  rect.style.backgroundColor = previewData;\n  rect.style.width = this.previewSize_.width + 'px';\n  rect.style.height = this.previewSize_.height + 'px';\n  return rect;\n};\n\nBlockly.FieldColourDropdown.prototype.updatePreviewData_ = function(previewData) {\n  this.previewElement_.setAttribute('fill', previewData);\n};\n\nBlockly.FieldColourDropdown.prototype.updatePreviewDimensions_ = function(previewWidth, previewHeight) {\n  this.previewElement_.setAttribute('width', previewWidth + 'px');\n  this.previewElement_.setAttribute('height', previewHeight + 'px');\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Dropdown input field.  Used for editable titles and variables.\n * In the interests of a consistent UI, the toolbox shares some functions and\n * properties with the context menu.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.FieldDropdown');\n\ngoog.require('Blockly.Field');\ngoog.require('goog.array');\n\n/**\n * Class for an editable dropdown field.\n * @param {(!Array.<string>|!Function)} menuGenerator An array of options\n *     for a dropdown list, or a function which generates these options.\n * @param {Function} opt_changeHandler A function that is executed when a new\n *     option is selected.\n * @param {boolean} opt_alwaysCallChangeHandler Whether or not to call\n *     opt_changeHandler when the value is set by something other than UI\n *     interaction\n * @extends {Blockly.Field}\n * @constructor\n */\nBlockly.FieldDropdown = function(menuGenerator, opt_changeHandler,\n    opt_alwaysCallChangeHandler) {\n  this.menuGenerator_ = menuGenerator ||\n    [[Blockly.FieldDropdown.NO_OPTIONS_MESSAGE,\n      Blockly.FieldDropdown.NO_OPTIONS_MESSAGE]];\n  this.changeHandler_ = opt_changeHandler;\n  this.alwaysCallChangeHandler_ = !!opt_alwaysCallChangeHandler;\n  this.trimOptions_();\n  var firstTuple = this.getOptions()[0];\n  this.value_ = firstTuple[1];\n\n  // Add dropdown arrow: \"option \" (LTR) or \" \" (RTL)\n  this.arrow_ = Blockly.createSvgElement('tspan',\n                                         {'class': 'blocklyArrow'},\n                                         null);\n  this.arrow_.appendChild(document.createTextNode(\n      Blockly.RTL ? '\\u25BC ' : ' \\u25BC'));\n\n  // Call parent's constructor.\n  Blockly.FieldDropdown.superClass_.constructor.call(this, firstTuple[0]);\n};\ngoog.inherits(Blockly.FieldDropdown, Blockly.Field);\n\n/**\n * Horizontal distance that a checkmark overhangs the dropdown.\n */\nBlockly.FieldDropdown.CHECKMARK_OVERHANG = 25;\n\n/**\n * Message displayed if no options have been configured yet\n * @type {string}\n */\nBlockly.FieldDropdown.NO_OPTIONS_MESSAGE = 'uninitialized';\n\n/**\n * Mouse cursor style when over the hotspot that initiates the editor.\n */\nBlockly.FieldDropdown.prototype.CURSOR = 'default';\n\n/**\n * Create a dropdown menu under the text.\n * @private\n */\nBlockly.FieldDropdown.prototype.showEditor_ = function(container) {\n  this.showWidgetDiv_();\n  var thisField = this;\n\n  function callback(e) {\n    var menuItem = e.target;\n    if (menuItem) {\n      var value = menuItem.getValue();\n      if (thisField.changeHandler_ && !thisField.alwaysCallChangeHandler_) {\n        // Call any change handler, and allow it to override. This happens\n        // inside setValue if alwaysCallChangeHandler_ is true.\n        var override = thisField.changeHandler_(value);\n        if (override !== undefined) {\n          value = override;\n        }\n      }\n      if (value !== null) {\n        thisField.setValue(value);\n      }\n    }\n    Blockly.WidgetDiv.hideIfOwner(thisField);\n  }\n\n  this.menu_ = new goog.ui.Menu();\n  var options = this.getOptions();\n  for (var x = 0; x < options.length; x++) {\n    var text = options[x][0];  // Human-readable text.\n    var value = options[x][1]; // Language-neutral value.\n    var menuItem = new goog.ui.MenuItem(text);\n    menuItem.setValue(value);\n    menuItem.setCheckable(true);\n    this.menu_.addItem(menuItem);\n    menuItem.setChecked(value === this.value_);\n  }\n  goog.events.listen(this.menu_, goog.ui.Component.EventType.ACTION, callback);\n  var div = container || Blockly.WidgetDiv.DIV;\n\n  // IE will scroll the bottom of the page into view to show this element\n  // before we move it, so hide it until we've repositioned.\n  div.style.visibility = \"hidden\";\n  this.menu_.render(div);\n  this.menu_.setAllowAutoFocus(true);\n  var menuDom = this.menu_.getElement();\n  Blockly.addClass_(menuDom, 'blocklyDropdownMenu');\n  // display menu items without shortcuts\n  Blockly.addClass_(menuDom, 'goog-menu-noaccel');\n  (container || menuDom).style.borderColor = 'hsla(' + this.sourceBlock_.getColour() + ', ' +\n    this.sourceBlock_.getSaturation() * 100 + '%, ' +\n    this.sourceBlock_.getValue() * 100 + '%' + ', 0.5)';\n  menuDom.style.overflowY = \"auto\";\n  menuDom.style[\"max-height\"] = \"250px\";\n\n  this.positionWidgetDiv();\n\n  div.style.visibility = \"visible\";\n};\n\n/**\n * @override\n */\nBlockly.FieldDropdown.prototype.positionWidgetDiv = function() {\n  var windowSize = goog.dom.getViewportSize();\n  var scrollOffset = goog.style.getViewportPageOffset(document);\n  var xy = Blockly.getAbsoluteXY_(/** @type {!Element} */ (this.borderRect_), this.getRootSVGElement_());\n  var borderBBox = this.borderRect_.getBBox();\n  var menuSize = goog.style.getSize(this.menu_.getElement());\n\n  // Flip menu vertically if off the bottom.\n  if (xy.y + menuSize.height + borderBBox.height >=\n      windowSize.height + scrollOffset.y) {\n    xy.y -= menuSize.height;\n  } else {\n    xy.y += borderBBox.height;\n  }\n\n  if (Blockly.RTL) {\n    xy.x += borderBBox.width;\n    xy.x += Blockly.FieldDropdown.CHECKMARK_OVERHANG;  // Width of checkmark.\n    // Don't go offscreen left.\n    if (xy.x < scrollOffset.x + menuSize.width) {\n      xy.x = scrollOffset.x + menuSize.width;\n    }\n  } else {\n    xy.x -= Blockly.FieldDropdown.CHECKMARK_OVERHANG;  // Width of checkmark.\n    // Don't go offscreen right.\n    if (xy.x > windowSize.width + scrollOffset.x - menuSize.width) {\n      xy.x = windowSize.width + scrollOffset.x - menuSize.width;\n    }\n  }\n\n  // iOS is positioning these wrong when scrolled. I believe the bug is in\n  // svg.getScreenCTM in Blockly.convertCoordinates, but prefer to make the\n  // lower impact change here.\n  if (Blockly.isIOS()) {\n    xy.y -= scrollOffset.y;\n  }\n\n  Blockly.WidgetDiv.position(xy.x, xy.y, windowSize, scrollOffset);\n}\n\n/**\n * Factor out common words in statically defined options.\n * Create prefix and/or suffix labels.\n * @private\n */\nBlockly.FieldDropdown.prototype.trimOptions_ = function() {\n  this.prefixTitle = null;\n  this.suffixTitle = null;\n  var options = this.menuGenerator_;\n  if (!goog.isArray(options) || options.length < 2) {\n    return;\n  }\n  var strings = options.map(function(t) {return t[0];});\n  var shortest = Blockly.shortestStringLength(strings);\n  var prefixLength = Blockly.commonWordPrefix(strings, shortest);\n  var suffixLength = Blockly.commonWordSuffix(strings, shortest);\n  if (!prefixLength && !suffixLength) {\n    return;\n  }\n  if (shortest <= prefixLength + suffixLength) {\n    // One or more strings will entirely vanish if we proceed.  Abort.\n    return;\n  }\n  if (prefixLength) {\n    this.prefixTitle = strings[0].substring(0, prefixLength - 1);\n  }\n  if (suffixLength) {\n    this.suffixTitle = strings[0].substr(1 - suffixLength);\n  }\n  // Remove the prefix and suffix from the options.\n  var newOptions = [];\n  for (var x = 0; x < options.length; x++) {\n    var text = options[x][0];\n    var value = options[x][1];\n    text = text.substring(prefixLength, text.length - suffixLength);\n    newOptions[x] = [text, value];\n  }\n  this.menuGenerator_ = newOptions;\n};\n\n/**\n * Return a list of the options for this dropdown.\n * @return {!Array.<!Array.<string>>} Array of option tuples:\n *     (human-readable text, language-neutral name).\n * @private\n */\nBlockly.FieldDropdown.prototype.getOptions = function() {\n  if (goog.isFunction(this.menuGenerator_)) {\n    return this.menuGenerator_.call(this);\n  }\n  return /** @type {!Array.<!Array.<string>>} */ (this.menuGenerator_);\n};\n\n/**\n * Get the language-neutral value from this dropdown menu.\n * @return {string} Current text.\n */\nBlockly.FieldDropdown.prototype.getValue = function() {\n  return this.value_;\n};\n\n/**\n * Set the language-neutral value for this dropdown menu.\n * @param {string} newValue New value to set.\n */\nBlockly.FieldDropdown.prototype.setValue = function(newValue) {\n  if (this.alwaysCallChangeHandler_ && this.changeHandler_) {\n    var override = this.changeHandler_(newValue);\n    if (override !== undefined) {\n      newValue = override;\n    }\n  }\n  this.value_ = newValue;\n  // Look up and display the human-readable text.\n  var options = this.getOptions();\n  for (var x = 0; x < options.length; x++) {\n    // Options are tuples of human-readable text and language-neutral values.\n    if (options[x][1] == newValue) {\n      this.setText(options[x][0]);\n      return;\n    }\n  }\n  // Value not found.  Add it, maybe it will become valid once set\n  // (like variable names).\n  this.setText(newValue);\n};\n\nBlockly.FieldDropdown.prototype.setToFirstValue_ = function () {\n  this.setValue(this.getOptions()[0][1]);\n};\n\n/**\n * Sets dropdown options to a set of numbers defined by the configString\n * @param configString printer-range style string, e.g., \"1-5,8,15\"\n */\nBlockly.FieldDropdown.prototype.setConfig = function(configString) {\n  this.config = configString; // Store for later block -> XML copying\n\n  var numberOptions = Blockly.printerRangeToNumbers(configString);\n  if (numberOptions.length === 0) {\n    return;\n  }\n\n  this.menuGenerator_ = goog.array.map(numberOptions, function(item) {\n    return [item.toString(), item.toString()];\n  });\n\n  this.setToFirstValue_();\n};\n\n/**\n * Set the text in this field.  Trigger a rerender of the source block.\n * @param {?string} text New text.\n */\nBlockly.FieldDropdown.prototype.setText = function(text) {\n  if (this.sourceBlock_) {\n    // Update arrow's colour.\n    this.arrow_.style.fill = this.sourceBlock_.getHexColour();\n  }\n  if (text === null) {\n    // No change if null.\n    return;\n  }\n  this.text_ = text;\n  // Empty the text element.\n  goog.dom.removeChildren(/** @type {!Element} */ (this.textElement_));\n  // Replace whitespace with non-breaking spaces so the text doesn't collapse.\n  text = text.replace(/\\s/g, Blockly.Field.NBSP);\n  if (!text) {\n    // Prevent the field from disappearing if empty.\n    text = Blockly.Field.NBSP;\n  }\n  var textNode = document.createTextNode(text);\n  this.textElement_.appendChild(textNode);\n\n  // Insert dropdown arrow.\n  if (Blockly.RTL) {\n    this.textElement_.insertBefore(this.arrow_, this.textElement_.firstChild);\n  } else {\n    this.textElement_.appendChild(this.arrow_);\n  }\n\n  // Cached width is obsolete.  Clear it.\n  this.size_.width = 0;\n\n  if (this.sourceBlock_ && this.sourceBlock_.rendered) {\n    this.sourceBlock_.render();\n    this.sourceBlock_.bumpNeighbours();\n    this.sourceBlock_.blockSpace.fireChangeEvent();\n  }\n};\n\n/**\n * Close the dropdown menu if this input is being deleted.\n */\nBlockly.FieldDropdown.prototype.dispose = function() {\n  Blockly.WidgetDiv.hideIfOwner(this);\n  Blockly.FieldDropdown.superClass_.dispose.call(this);\n};\n","/**\n * @fileoverview Dropdown Angle input field.\n */\n'use strict';\n\ngoog.provide('Blockly.FieldAngleDropdown');\ngoog.require('Blockly.FieldDropdown');\ngoog.require('Blockly.AngleHelper');\n\n/**\n * Class for an editable dropdown field with an angle helper.\n * @param {Object} opt_options An options object\n * @param {(!Array.<string>|!Function)} opt_options.menuGenerator An array of options\n *     for a dropdown list, or a function which generates these options.\n * @param {Function} opt_options.opt_changeHandler A function that is executed when a new\n *     option is selected.\n * @param {string} opt_options.directionTitleName The name of the title value\n *     from which to get the direction setting.\n * @param {string} opt_options.direction The hardcoded direction setting to pass along\n * @extends {Blockly.FieldAngleDropdown}\n * @constructor\n */\nBlockly.FieldAngleDropdown = function(opt_options) {\n  this.angleHelper = null;\n  this.direction = opt_options.direction;\n  this.directionTitleName = opt_options.directionTitleName;\n  Blockly.FieldAngleDropdown.superClass_.constructor.call(this,\n      opt_options.menuGenerator, opt_options.opt_changeHandler);\n};\ngoog.inherits(Blockly.FieldAngleDropdown, Blockly.FieldDropdown);\n\nBlockly.FieldAngleDropdown.prototype.getAngleDirection_ = function() {\n  // direction can be set by specifying either direction or directionTitleName,\n  // but not both\n  if (this.direction && this.directionTitleName) {\n    throw 'FieldAngleDropdown should not have both a direction and a directionTitleName; please pass at most one of these options';\n  }\n\n  if (this.directionTitleName) {\n    return this.sourceBlock_.getTitleValue(this.directionTitleName);\n  } else if (this.direction) {\n    return this.direction;\n  }\n\n  // Turn right (clockwise) by default.\n  return 'turnRight'\n};\n\nBlockly.FieldAngleDropdown.prototype.showEditor_ = function() {\n  var div = Blockly.WidgetDiv.DIV;\n\n  var container = goog.dom.createDom('div', 'blocklyFieldAngleDropdown');\n  div.appendChild(container);\n\n  Blockly.FieldAngleDropdown.superClass_.showEditor_.call(this, container);\n\n  var menuDom = this.menu_.getElement();\n  var menuSize = goog.style.getSize(menuDom);\n  var angleHelperHeight = menuSize.height;\n  var angleHelperWidth = Math.min(menuSize.height, 150);\n\n  container.style.height = angleHelperHeight + 'px';\n\n  var svgContainer = goog.dom.createDom('div');\n  container.appendChild(svgContainer);\n\n  this.angleHelper = new Blockly.AngleHelper(this.getAngleDirection_(), {\n    onUpdate: function () {\n      this.setValue(this.angleHelper.getAngle().toString());\n      this.menu_.getItems().forEach(function (menuItem) {\n        menuItem.setChecked(menuItem.getValue() === this.value_);\n      }, this);\n    }.bind(this),\n    snapPoints: this.getOptions().map(function (option) {\n      return parseInt(option[1]);\n    }),\n    arcColour: this.sourceBlock_.getHexColour(),\n    height: angleHelperHeight,\n    width: angleHelperWidth,\n    angle: parseInt(this.getValue())\n  });\n\n  this.angleHelper.init(svgContainer);\n\n  goog.events.listen(this.menu_, goog.ui.Component.EventType.HIGHLIGHT, function (e) {\n    var menuItem = e.target;\n    if (menuItem) {\n      var value = menuItem.getValue();\n      this.angleHelper.animateAngleChange(parseInt(value));\n    }\n  }.bind(this));\n  return div;\n}\n\nBlockly.FieldAngleDropdown.prototype.dispose = function() {\n  if (this.angleHelper) {\n    this.angleHelper.dispose();\n  }\n  Blockly.FieldAngleDropdown.superClass_.dispose.call(this);\n};\n","/**\n * @fileoverview special Text Input field that always shows angle helper\n * @author elijah@code.org (Elijah Hamovitz)\n */\n'use strict';\n\ngoog.provide('Blockly.FieldAngleTextInput');\n\ngoog.require('Blockly.AngleHelper');\ngoog.require('Blockly.BlockFieldHelper');\ngoog.require('Blockly.FieldTextInput');\n\n/**\n * Class for an editable text field which will always show the Angle Helper\n * @param {string} text The initial content of the field.\n * @param {Object} opt_options An options object\n * @param {string} opt_options.directionTitle the title of the field from which\n *     to obtain direction information\n * @param {string} opt_options.direction the hardcoded direction setting\n * @extends {Blockly.FieldTextInput}\n * @constructor\n */\nBlockly.FieldAngleTextInput = function(text, opt_options) {\n  this.direction = opt_options.direction;\n  this.directionTitle = opt_options.directionTitle;\n  Blockly.FieldAngleTextInput.superClass_.constructor.call(this,\n      text, Blockly.FieldTextInput.numberValidator);\n};\ngoog.inherits(Blockly.FieldAngleTextInput, Blockly.FieldTextInput);\n\nBlockly.FieldAngleTextInput.prototype.getFieldHelperOptions_ = function(field_helper) {\n  if (field_helper === Blockly.BlockFieldHelper.ANGLE_HELPER) {\n      return {\n        direction: this.direction,\n        directionTitle: this.directionTitle,\n        block: this.sourceBlock_\n      }\n  }\n};\n","/**\n * @fileoverview Non-editable text field, styled like Blockly icons.\n */\n'use strict';\n\ngoog.provide('Blockly.FieldIcon');\n\ngoog.require('Blockly.FieldLabel');\n\nBlockly.FieldIcon = function(text) {\n  Blockly.FieldIcon.superClass_.constructor.apply(this, arguments);\n  Blockly.addClass_(this.fieldGroup_, 'blocklyIconGroup');\n  Blockly.addClass_(this.borderRect_, 'blocklyIconShield');\n  this.textElement_.setAttribute('style', 'font-size:9pt; cursor:default;');\n};\ngoog.inherits(Blockly.FieldIcon, Blockly.Field);\n\n/**\n * Editable fields are saved by the XML renderer, non-editable fields are not.\n */\nBlockly.FieldIcon.prototype.EDITABLE = false;\n\n/**\n * To be overridden by the instance.\n * @private\n */\nBlockly.FieldIcon.prototype.showEditor_ = function() {\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Image-only dropdown input field.\n */\n'use strict';\n\ngoog.provide('Blockly.FieldImageDropdown');\ngoog.require('Blockly.Field');\ngoog.require('Blockly.FieldRectangularDropdown');\ngoog.require('Blockly.ImageDimensionCache');\n\n/**\n * Class for a rectangular image dropdown field.\n * By default, will auto-size SVG block preview and HTML dropdown previews to image dimensions,\n * specifying a width / height will make the images scale to auto-fill\n * @param {!Array.<string>} choices An array of choices for a dropdown list, each choice is a\n *                                  tuple of [image path, value]\n * @extends {Blockly.FieldRectangularDropdown}\n * @constructor\n * @param width force the dropdown to use a given width\n * @param height force the dropdown to use a given height\n */\nBlockly.FieldImageDropdown = function(choices, width, height) {\n  this.width_ = width;\n  this.height_ = height;\n  Blockly.FieldImageDropdown.superClass_.constructor.call(this, choices);\n  if (this.hasForcedDimensions_()) {\n    this.updateDimensions_(this.width_, this.height_);\n  }\n};\ngoog.inherits(Blockly.FieldImageDropdown, Blockly.FieldRectangularDropdown);\n\nBlockly.FieldImageDropdown.prototype.hasForcedDimensions_ = function() {\n  return !!this.width_;\n};\n\nBlockly.FieldImageDropdown.prototype.addPreviewElementTo_ = function(parentElement) {\n  this.previewElement_ = Blockly.createSvgElement('image',\n    {'height': Blockly.FieldImage.IMAGE_LOADING_HEIGHT + 'px',\n      'width': Blockly.FieldImage.IMAGE_LOADING_WIDTH + 'px',\n      'y': Blockly.FieldImage.IMAGE_OFFSET_Y,\n      'preserveAspectRatio': 'xMidYMid slice'}, parentElement);\n};\n\nBlockly.FieldImageDropdown.prototype.updatePreviewData_ = function(previewData) {\n  this.previewElement_.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', previewData);\n  if (this.hasForcedDimensions_()) {\n    return;\n  }\n\n  this.getUpdatedDimensions_(previewData);\n};\n\nBlockly.FieldImageDropdown.prototype.createDropdownPreviewElement_ = function(imagePath) {\n  if (this.hasForcedDimensions_()) {\n    return this.createAutoSizedDropdownPreviewElement_(imagePath, this.width_, this.height_);\n  }\n  return this.createImageDropdownPreviewElement_(imagePath);\n};\n\n/**\n * Creates an automatically-sized dropdown preview element for display within a goog.ui.MenuItem,\n * auto-filling a div of size width x height, with the image centered as the background.\n *\n * This is meant to match up with the canvas preview element's style preserveAspectRatio: \"xMidYMid slice\"\n * @param imagePath\n * @returns {HTMLElement} div with image in the background, centered and filling the background\n * @private\n */\nBlockly.FieldImageDropdown.prototype.createAutoSizedDropdownPreviewElement_ = function(imagePath, width, height) {\n  var dropdownPreviewElement = document.createElement('div');\n  dropdownPreviewElement.style.backgroundImage = \"url('\" + imagePath +  \"')\";\n  dropdownPreviewElement.style.backgroundSize = \"cover\";\n  dropdownPreviewElement.style.backgroundRepeat = \"no-repeat\";\n  dropdownPreviewElement.style.backgroundPosition = \"50% 50%\";\n  dropdownPreviewElement.style.width = width + 'px';\n  dropdownPreviewElement.style.height = height + 'px';\n  return dropdownPreviewElement;\n};\n\n/**\n * Creates a simple preview image for display within a goog.ui.MenuItem dropdown element\n * @param imagePath\n * @returns {HTMLElement}\n * @private\n */\nBlockly.FieldImageDropdown.prototype.createImageDropdownPreviewElement_ = function(imagePath) {\n  var dropdownPreviewElement = document.createElement('img');\n  dropdownPreviewElement.setAttribute('src', imagePath);\n  return dropdownPreviewElement;\n};\n\nBlockly.FieldImageDropdown.prototype.getUpdatedDimensions_ = function(src) {\n  // Update the preview dimensions now (if cached) or use a default + update later (if not yet loaded)\n  var self = this;\n  var dimensions = Blockly.ImageDimensionCache.getCachedDimensionsOrDefaultAndUpdate(src, function(width, height) {\n    self.updateDimensions_(width, height);\n  });\n  this.updateDimensions_(dimensions.width, dimensions.height);\n};\n\nBlockly.FieldImageDropdown.prototype.updatePreviewDimensions_ = function(previewWidth, previewHeight) {\n  this.previewElement_.setAttribute('width', previewWidth + 'px');\n  this.previewElement_.setAttribute('height', previewHeight + 'px');\n};\n","/**\n * @fileoverview Block Limits helper class for managing limited\n * quantities of blocks within a flyout\n */\n'use strict';\n\n/* global Blockly, goog */\n\ngoog.provide('Blockly.BlockLimits');\n\ngoog.require('Blockly.Block');\n\n/**\n * @typedef {Object} BlockLimit\n * @property {number} count\n * @property {number} limit\n */\n\n/**\n * Class for managing block limits\n * @constructor\n */\nBlockly.BlockLimits = function () {\n  /**\n   * Store of block types to block limit tracking objects.\n   * {Object.<string, BlockLimit>}\n   * @private\n   */\n  this.limits_ = {};\n\n  /**\n   * Fires event 'change' on remaining block count change.\n   * @type {goog.events.EventTarget}\n   */\n  this.events = new goog.events.EventTarget();\n};\n\nBlockly.BlockLimits.prototype.setLimit = function (type, limit) {\n  this.limits_[type] = {\n    count: undefined,\n    limit: limit\n  };\n  this.updateCount(type, 0);\n};\n\n/**\n * Update the block counts for limited-quantity workspace blocks\n * @param {string[]} blockTypes\n */\nBlockly.BlockLimits.prototype.updateBlockTotals = function (blockTypes) {\n  var countsByType = Blockly.aggregateCounts(blockTypes);\n\n  goog.object.forEach(this.limits_, function (limit, type) {\n    var blockCount = countsByType[type] || 0;\n    this.updateCount(type, blockCount);\n  }.bind(this));\n};\n\nBlockly.BlockLimits.prototype.updateCount = function (type, newCount) {\n  var limit = this.limits_[type];\n  var countChanged = newCount !== limit.count;\n  limit.count = newCount;\n  if (countChanged) {\n    this.events.fireListeners('change', false, {\n      type: type,\n      limit: limit.limit,\n      remaining: limit.limit - limit.count\n    });\n  }\n};\n\nBlockly.BlockLimits.prototype.getLimit = function (type) {\n  return this.limits_[type] ? this.limits_[type].limit : undefined;\n};\n\n/**\n * Returns true iff any of the blocks in this flyout are limited in quantity\n * @return {boolean}\n */\nBlockly.BlockLimits.prototype.hasBlockLimits = function () {\n  return Object.keys(this.limits_).length > 0;\n};\n\n/**\n * Returns true iff all given blocks can be added to this space without\n * exceeding any block limits\n * @param {string[]} blockTypes\n * @return {boolean}\n */\nBlockly.BlockLimits.prototype.canAddBlocks = function (blockTypes) {\n  var countsByType = Blockly.aggregateCounts(blockTypes);\n\n  var allWithinLimits = goog.object.every(countsByType, function (count, type) {\n    return this.blockTypeWithinLimits(type, count);\n  }, this);\n\n  return allWithinLimits;\n};\n\n/**\n * Returns true if the specified count of the specified block type can\n * be added to this space without exceeding any block limits\n * @param {string} type\n * @param {number} count\n * @return {boolean}\n */\nBlockly.BlockLimits.prototype.blockTypeWithinLimits = function (type, count) {\n  if (count === undefined) {\n    count = 1;\n  }\n  var limit = this.limits_[type];\n  if (limit) {\n    var remaining = limit.limit - limit.count;\n    return remaining >= count;\n  }\n  return true;\n};\n\n/**\n * Returns true if any block limit is currently exceeded\n */\nBlockly.BlockLimits.prototype.blockLimitExceeded = function () {\n  return goog.object.findKey(this.limits_, function (value) {\n    return value.count > value.limit;\n  });\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* global Blockly, goog */\n\n/**\n * @fileoverview Flyout tray containing blocks which may be created.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Flyout');\n\ngoog.require('Blockly.Block');\ngoog.require('Blockly.BlockLimits');\ngoog.require('goog.math.Rect');\n\n\n/**\n * Class for a flyout.\n * @param {!Blockly.BlockSpaceEditor} blockSpaceEditor Parent editor.\n * @param {boolean} opt_static Is the flyout a static (always open) toolbox?\n * @constructor\n */\nBlockly.Flyout = function(blockSpaceEditor, opt_static) {\n  var flyout = this;\n\n  /**\n   * @type {!Blockly.BlockSpaceEditor}\n   * @private\n   */\n  this.blockSpaceEditor_ = blockSpaceEditor;\n\n  /**\n   * @type {!Blockly.BlockSpace}\n   * @private\n   */\n  this.blockSpace_ = new Blockly.BlockSpace(blockSpaceEditor,\n      function() {return flyout.getMetrics_();},\n      function(ratio) {return flyout.setMetrics_(ratio);}\n  );\n  this.blockSpace_.isFlyout = true;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.static_ = opt_static;\n\n  /**\n   * Opaque data that can be passed to removeChangeListener.\n   * @type {BindData}\n   * @private\n   */\n  this.changeWrapper_ = null;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.width_ = 0;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.height_ = 0;\n\n  /**\n   * List of background buttons that lurk behind each block to catch clicks\n   * landing in the blocks' lakes and bays.\n   * @type {!Array.<!Element>}\n   * @private\n   */\n  this.buttons_ = [];\n\n  /**\n   * List of event listeners.\n   * @type {BindData}\n   * @private\n   */\n  this.listeners_ = [];\n\n  /**\n   * If disabled, clicks on blocks in flyout will be ignored.\n   */\n  this.enabled_ = true;\n};\n\n/**\n * Additional config for creating custom flyouts\n * @type {string} type custom category for which to use the provided config\n * @type {object} config\n * @type {function} config.initialize\n * @type {boolean} config.addDefaultVar\n */\nBlockly.Flyout.configure = function (type, config) {\n  Blockly.Flyout.config[type] = config;\n}\nBlockly.Flyout.config = {};\n\n/**\n * Does the flyout automatically close when a block is created?\n * @type {boolean}\n */\nBlockly.Flyout.prototype.autoClose = true;\n\n/**\n * Corner radius of the flyout background.\n * @type {number}\n * @const\n */\nBlockly.Flyout.prototype.CORNER_RADIUS = 8;\n\n/**\n * Wrapper function called when a resize occurs.\n * @type {BindData}\n * @private\n */\nBlockly.Flyout.prototype.onResizeWrapper_ = null;\n\n/**\n * Creates the flyout's DOM.  Only needs to be called once.\n * @type {boolean} insideToolbox Whether this flyout is in a toolbox.\n * @return {!Element} The flyout's SVG group.\n */\nBlockly.Flyout.prototype.createDom = function(insideToolbox) {\n  /*\n  <g>\n    <path class=\"blocklyFlyoutBackground\"/>\n    <g></g>\n  </g>\n  */\n  this.svgGroup_ = Blockly.createSvgElement('g', {'class': 'svgFlyoutGroup'}, null);\n  this.svgBackground_ = Blockly.createSvgElement('path',\n      {'class': 'blocklyFlyoutBackground'}, this.svgGroup_);\n  this.svgGroup_.appendChild(this.blockSpace_.createDom());\n\n  // Add a trashcan.\n  if (!Blockly.isPortrait && !insideToolbox) {\n    this.trashcan = new Blockly.Trashcan(this);\n    this.svgTrashcan_ = this.trashcan.createDom();\n    this.svgTrashcan_.setAttribute(\"style\",\n      \"display: none; pointer-events: none\");\n    this.svgTrashcan_.setAttribute('transform', 'translate(0, 20)');\n    this.svgGroup_.appendChild(this.svgTrashcan_);\n  }\n\n  return this.svgGroup_;\n};\n\n/**\n * Dispose of this flyout.\n * Unlink from all DOM elements to prevent memory leaks.\n */\nBlockly.Flyout.prototype.dispose = function() {\n  this.hide();\n  if (this.onResizeWrapper_) {\n    Blockly.unbindEvent_(this.onResizeWrapper_);\n    this.onResizeWrapper_ = null;\n  }\n  if (this.changeWrapper_) {\n    Blockly.unbindEvent_(this.changeWrapper_);\n    this.changeWrapper_ = null;\n  }\n  this.blockSpace_.dispose();\n  this.blockSpace_ = null;\n  if (this.svgGroup_) {\n    goog.dom.removeNode(this.svgGroup_);\n    this.svgGroup_ = null;\n  }\n  this.svgBackground_ = null;\n  this.targetBlockSpace_ = null;\n};\n\n/**\n * Return an object with all the metrics required to size scrollbars for the\n * flyout.  The following properties are computed:\n * .viewHeight: Height of the visible rectangle,\n * .viewWidth: Width of the visible rectangle,\n * .contentHeight: Height of the contents,\n * .viewTop: Offset of top edge of visible rectangle from parent,\n * .contentTop: Offset of the top-most content from the y=0 coordinate,\n * .absoluteTop: Top-edge of view.\n * .absoluteLeft: Left-edge of view.\n * @return {Object} Contains size and position metrics of the flyout.\n * @private\n */\nBlockly.Flyout.prototype.getMetrics_ = function() {\n  if (!this.isVisible()) {\n    // Flyout is hidden.\n    return null;\n  }\n  var viewHeight = this.height_ - 2 * this.CORNER_RADIUS;\n  var viewWidth = this.width_;\n  try {\n    if (Blockly.isMsie() || Blockly.isTrident()) {\n      this.blockSpace_.getCanvas().style.display = \"inline\"; // required for IE\n      var optionBox = {\n        x: this.blockSpace_.getCanvas().getBBox().x,\n        y: this.blockSpace_.getCanvas().getBBox().y,\n        width: this.blockSpace_.getCanvas().scrollWidth,\n        height: this.blockSpace_.getCanvas().scrollHeight\n      };\n    }\n    else {\n      var optionBox = this.blockSpace_.getCanvas().getBBox();\n    }\n  } catch (e) {\n    // Firefox has trouble with hidden elements (Bug 528969).\n    var optionBox = {height: 0, y: 0};\n  }\n  return {\n    viewHeight: viewHeight,\n    viewWidth: viewWidth,\n    contentHeight: optionBox.height + optionBox.y,\n    viewTop: this.blockSpace_.getScrollOffsetY(),\n    contentTop: 0,\n    absoluteTop: this.CORNER_RADIUS,\n    absoluteLeft: 0\n  };\n};\n\n/**\n * @returns {number} the height of this flyout\n */\nBlockly.Flyout.prototype.getHeight = function() {\n  return this.height_;\n};\n\n/**\n * Sets the Y translation of the flyout to match the scrollbars.\n * @param {!Object} yRatio Contains a y property which is a float\n *     between 0 and 1 specifying the degree of scrolling.\n * @private\n */\nBlockly.Flyout.prototype.setMetrics_ = function(yRatio) {\n  var metrics = this.getMetrics_();\n  if (goog.isNumber(yRatio.y)) {\n    // TODO(bjordan+bbuchanan): needs to change?\n    this.blockSpace_.yOffsetFromView = -metrics.contentHeight * yRatio.y\n        - metrics.contentTop;\n  }\n  var y = this.blockSpace_.yOffsetFromView + metrics.absoluteTop;\n  this.blockSpace_.getCanvas().setAttribute('transform', 'translate(0,'\n      + y + ')');\n};\n\n/**\n * Initializes the flyout.\n * @param {!Blockly.BlockSpace} blockSpace The blockSpace in which to create new\n *     blocks.\n * @param {boolean} withScrollbars True if a scrollbar should be displayed.\n */\nBlockly.Flyout.prototype.init = function(blockSpace, withScrollbars) {\n  this.targetBlockSpace_ = blockSpace;\n  // Add scrollbars.\n  var flyout = this;\n  if (withScrollbars) {\n    var useHorizontalScrollbar = false;\n    var useVerticalScrollbar = true;\n    flyout.blockSpace_.scrollbarPair = new Blockly.ScrollbarPair(\n        flyout.blockSpace_, useHorizontalScrollbar, useVerticalScrollbar);\n  }\n\n  this.hide();\n\n  // If the document resizes, reposition the flyout.\n  this.onResizeWrapper_ = Blockly.bindEvent_(window,\n      goog.events.EventType.RESIZE, this, this.position_);\n  this.position_();\n  this.changeWrapper_ = Blockly.bindEvent_(this.targetBlockSpace_.getCanvas(),\n      'blocklyBlockSpaceChange', this, this.onBlockSpaceChange_);\n};\n\n/**\n * Move the toolbox to the edge of the blockSpace.\n * @private\n */\nBlockly.Flyout.prototype.position_ = function() {\n  if (!this.isVisible()) {\n    return;\n  }\n  var metrics = this.targetBlockSpace_.customFlyoutMetrics_ ?\n      this.targetBlockSpace_.customFlyoutMetrics_() :\n      this.targetBlockSpace_.getMetrics();\n  if (!metrics) {\n    // Hidden components will return null.\n    return;\n  }\n  var edgeWidth = this.width_ - this.CORNER_RADIUS;\n  if (Blockly.RTL) {\n    edgeWidth *= -1;\n  }\n  var path = ['M ' + (Blockly.RTL ? this.width_ : 0) + ',0'];\n  path.push('h', edgeWidth + this.CORNER_RADIUS);\n  // path.push('a', this.CORNER_RADIUS, this.CORNER_RADIUS, 0, 0,\n  //     Blockly.RTL ? 0 : 1,\n  //     Blockly.RTL ? -this.CORNER_RADIUS : this.CORNER_RADIUS,\n  //     this.CORNER_RADIUS);\n  path.push('v', Math.max(0, metrics.viewHeight));\n  // path.push('a', this.CORNER_RADIUS, this.CORNER_RADIUS, 0, 0,\n  //     Blockly.RTL ? 0 : 1,\n  //     Blockly.RTL ? this.CORNER_RADIUS : -this.CORNER_RADIUS,\n  //     this.CORNER_RADIUS);\n  path.push('h', -edgeWidth-this.CORNER_RADIUS);\n  path.push('z');\n  this.svgBackground_.setAttribute('d', path.join(' '));\n\n  var x = metrics.absoluteLeft;\n  var y = metrics.absoluteTop;\n  if (Blockly.RTL) {\n    x = this.static_ ? 0 : -this.width_;\n    x += metrics.viewWidth;\n  } else if (this.static_) {\n    if (!Blockly.isPortrait) {\n      x -= this.width_;\n    }\n  }\n  this.svgGroup_.setAttribute('transform', 'translate(' + x + ',' + y + ')');\n\n  // Record the height for Blockly.Flyout.getMetrics_.\n  this.height_ = metrics.viewHeight;\n  this.blockSpace_.updateScrollableSize();\n\n  // Center the trashcan\n  if (this.svgTrashcan_) {\n    var flyoutWidth = this.svgGroup_.getBoundingClientRect().width;\n    var trashcanWidth = 70;\n    var trashcanX = Math.round(flyoutWidth / 2 - trashcanWidth / 2);\n    this.svgTrashcan_.setAttribute('transform', 'translate(' + trashcanX + ', 20)');\n  }\n};\n\n/**\n * Is the flyout visible?\n * @return {boolean} True if visible.\n */\nBlockly.Flyout.prototype.isVisible = function() {\n  return this.svgGroup_.style.display == 'block';\n};\n\n/**\n * Hide and empty the flyout.\n * @param {?Blockly.Block} opt_saveBlock - block to not immediately destroy\n */\nBlockly.Flyout.prototype.hide = function(opt_saveBlock) {\n  if (!this.isVisible()) {\n    return;\n  }\n  this.svgGroup_.style.display = 'none';\n  // Delete all the event listeners.\n  this.blockSpace_.unbindBeginPanDragHandler();\n  for (var x = 0, listen; listen = this.listeners_[x]; x++) {\n    Blockly.unbindEvent_(listen);\n  }\n  this.listeners_.splice(0);\n  if (this.reflowWrapper_) {\n    Blockly.unbindEvent_(this.reflowWrapper_);\n    this.reflowWrapper_ = null;\n  }\n  // Delete all the blocks.\n  this.blockSpace_.getTopBlocks(false).forEach(function (block) {\n    if (block.rendered && block !== opt_saveBlock) {\n      block.dispose(false, false, true);\n    }\n  });\n  // Delete all the background buttons.\n  for (var x = 0, rect; rect = this.buttons_[x]; x++) {\n    goog.dom.removeNode(rect);\n  }\n  // Delete the 'Create a Function' button.\n  goog.dom.removeNode(goog.dom.getElementByClass('createFunction',\n      this.blockSpace_.svgGroup_));\n  this.buttons_.splice(0);\n};\n\n/**\n * Arrange the given block in the flyout, and update cursorX/cursorY.\n * @param block\n * @param cursor\n * @param gap\n * @private\n */\nBlockly.Flyout.prototype.layoutBlock_ = function(block, cursor, gap, initialX) {\n  var blockHW = block.getHeightWidth();\n  block.moveBy(cursor.x, cursor.y);\n  cursor.y += blockHW.height + gap;\n};\n\n/**\n * Convert the given XML to Blocks and populate the given arrays of blocks and\n * gaps appropriately.\n *\n * @see Blockly.Flyout.prototype.show\n *\n * @param {!Array|string} xmlList List of blocks (as XML) to lay out\n * @param {!Array|Block} blocks Array to which the newly-created blocks are\n *     appended\n * @param {!Array|number} gaps Array to which the gap values for the\n *     newly-created blocks are appended\n */\nBlockly.Flyout.prototype.layoutXmlToBlocks_ = function(xmlList, blocks, gaps, margin) {\n  for (var i = 0, xml; xml = xmlList[i]; i++) {\n    if (xml.tagName && xml.tagName.toUpperCase() === 'BLOCK') {\n      blocks.push(Blockly.Xml.domToBlock(this.blockSpace_, xml));\n      gaps.push(margin * 3);\n    }\n  }\n};\n\n/**\n * Show and populate the flyout.\n * @param {!Array|string} xmlList List of blocks to show.\n *     Variables and procedures have a custom set of blocks.\n */\nBlockly.Flyout.prototype.show = function(xmlList) {\n  this.hide();\n  this.svgGroup_.style.display = 'block';\n\n  var margin = this.CORNER_RADIUS;\n  var initialX = Blockly.RTL ? this.width_ : margin\n      + Blockly.BlockSvg.TAB_WIDTH;\n  var cursor = {\n    x: initialX,\n    y: margin\n  };\n\n  // We bind mouse pan-drag on the background group so blocks are ignored.\n  this.blockSpace_.bindBeginPanDragHandler(this.svgBackground_);\n  // We bind scrollwheel on the full group so wheeling over blocks works.\n  this.blockSpace_.bindScrollOnWheelHandler(this.svgGroup_);\n\n  // Create the blocks to be shown in this flyout.\n  var blocks = [];\n  var gaps = [];\n  this.minFlyoutWidth_ = 0;\n  var firstBlock = xmlList && xmlList[0];\n  if (firstBlock === Blockly.Variables.NAME_TYPE) {\n    // Special category for variables.\n    // Allow for a mix of static + dynamic blocks. Static blocks will appear\n    // first in the category\n    this.layoutXmlToBlocks_(xmlList.slice(1), blocks, gaps, margin);\n    Blockly.Variables.flyoutCategory(blocks, gaps, margin, this.blockSpace_,\n      Blockly.Variables.DEFAULT_CATEGORY, true /* addDefaultVar */);\n  } else if (firstBlock === Blockly.Procedures.NAME_TYPE ||\n    Blockly.topLevelProcedureAutopopulate) {\n    // Special category for procedures.\n    if (Blockly.functionEditor && !Blockly.functionEditor.isOpen()) {\n      this.addButtonToFlyout_(cursor, Blockly.Msg.FUNCTION_CREATE, this.createFunction_);\n    }\n\n    if (Blockly.disableProcedureAutopopulate) {\n      this.layoutXmlToBlocks_(xmlList.slice(1), blocks, gaps, margin);\n    }\n\n    if (Blockly.topLevelProcedureAutopopulate) {\n      this.layoutXmlToBlocks_(xmlList, blocks, gaps, margin);\n    }\n\n    if (Blockly.mainBlockSpace) {\n      Blockly.Procedures.flyoutCategory(blocks, gaps, margin,\n        this.blockSpace_,\n        function(procedureInfo) {\n          return !procedureInfo.isFunctionalVariable &&\n            procedureInfo.type !== 'behavior_definition';\n        }\n      );\n    }\n  } else if (firstBlock === Blockly.Procedures.NAME_TYPE_FUNCTIONAL_VARIABLE) {\n    // Special category for functional variables.\n    if (Blockly.functionEditor && !Blockly.functionEditor.isOpen()) {\n      this.addButtonToFlyout_(cursor, Blockly.Msg.FUNCTIONAL_VARIABLE_CREATE,\n        this.createFunctionalVariable_);\n    }\n    Blockly.Procedures.flyoutCategory(blocks, gaps, margin,\n      this.blockSpace_,\n      function(procedureInfo) { return procedureInfo.isFunctionalVariable; }\n    );\n  } else if (firstBlock === 'Behavior' || Blockly.topLevelProcedureAutopopulate) {\n    // Special category for behaviors.\n    if (Blockly.disableProcedureAutopopulate) {\n      this.layoutXmlToBlocks_(xmlList.slice(1), blocks, gaps, margin);\n    }\n\n    if (Blockly.topLevelProcedureAutopopulate) {\n      this.layoutXmlToBlocks_(xmlList, blocks, gaps, margin);\n    }\n\n    if (Blockly.mainBlockSpace) {\n      Blockly.Procedures.flyoutCategory(blocks, gaps, margin,\n        this.blockSpace_,\n        function(procedureInfo) {\n          return procedureInfo.type === 'behavior_definition';\n        }\n      );\n    }\n  } else if (goog.isString(firstBlock)) {\n    // Special category for categorized variables.\n    // Allow for a mix of static + dynamic blocks. Static blocks will appear\n    // first in the category\n    var addDefaultVar = true;\n    var config = Blockly.Flyout.config[firstBlock];\n    if (config) {\n      addDefaultVar = config.addDefaultVar;\n      config.initialize(this, cursor);\n    }\n    this.layoutXmlToBlocks_(xmlList.slice(1), blocks, gaps, margin);\n    Blockly.Variables.flyoutCategory(\n      blocks, gaps, margin, this.blockSpace_, firstBlock, addDefaultVar);\n  } else {\n    this.layoutXmlToBlocks_(xmlList, blocks, gaps, margin);\n  }\n\n  // Lay out the blocks vertically.\n  for (var i = 0, block; block = blocks[i]; i++) {\n    var allBlocks = block.getDescendants();\n    for (var j = 0, child; child = allBlocks[j]; j++) {\n      // Mark blocks as being inside a flyout.  This is used to detect and\n      // prevent the closure of the flyout if the user right-clicks on such a\n      // block.\n      child.isInFlyout = true;\n    }\n\n    block.render(true);\n    this.layoutBlock_(block, cursor, gaps[i], initialX);\n    // Create an invisible rectangle under the block to act as a button.  Just\n    // using the block as a button is poor, since blocks have holes in them.\n    var rect = Blockly.createSvgElement('rect', {'fill-opacity': 0}, null);\n    // Add the rectangles under the blocks, so that the blocks' tooltips work.\n    this.blockSpace_.getCanvas().insertBefore(rect, block.getSvgRoot());\n    block.flyoutRect_ = rect;\n    this.buttons_[i] = rect;\n\n    var root = block.getSvgRoot();\n    if (this.autoClose) {\n      this.listeners_.push(Blockly.bindEvent_(root, 'mousedown', null,\n          this.createBlockFunc_(block)));\n    } else {\n      this.listeners_.push(Blockly.bindEvent_(root, 'mousedown', null,\n          this.blockMouseDown_(block)));\n    }\n    this.listeners_.push(Blockly.bindEvent_(root, 'mouseover', block.svg_,\n        block.svg_.addSelectNoMove));\n    this.listeners_.push(Blockly.bindEvent_(root, 'mouseout', block.svg_,\n        block.svg_.removeSelect));\n    this.listeners_.push(Blockly.bindEvent_(rect, 'mousedown', null,\n        this.createBlockFunc_(block)));\n    this.listeners_.push(Blockly.bindEvent_(rect, 'mouseover', block.svg_,\n        block.svg_.addSelectNoMove));\n    this.listeners_.push(Blockly.bindEvent_(rect, 'mouseout', block.svg_,\n        block.svg_.removeSelect));\n  }\n  this.width_ = 0;\n  this.reflow();\n\n  this.filterForCapacity_();\n  this.updateBlockLimitTotals_();\n\n  // Fire a resize event to update the flyout's scrollbar.\n  Blockly.fireUiEvent(window, 'resize');\n  this.reflowWrapper_ = Blockly.bindEvent_(this.blockSpace_.getCanvas(),\n      'blocklyBlockSpaceChange', this, this.reflow);\n  this.blockSpace_.fireChangeEvent();\n};\n\n/**\n * Adds a rectangular SVG button to this flyout's blockSpace\n * @param {{x: Number, y: Number}} cursor current drawing position in flyout\n * @param {String} buttonText text to display on button\n * @param {Function} onMouseDown callback for button press\n * @private\n */\nBlockly.Flyout.prototype.addButtonToFlyout_ = function(cursor, buttonText, onMouseDown) {\n  var button = Blockly.createSvgElement('g', {'class': 'createFunction'},\n    this.blockSpace_.svgGroup_);\n  var padding = 5;\n  var r = Blockly.createSvgElement('rect', {\n    rx: 5,\n    ry: 5,\n    fill: 'orange',\n    stroke: 'white'\n  }, button);\n  var text = Blockly.createSvgElement('text', {\n    x: padding,\n    y: padding,\n    'class': 'blocklyText'\n  }, button);\n  text.textContent = buttonText;\n  var bounds = text.getBoundingClientRect();\n  this.minFlyoutWidth_ = bounds.width + 2 * padding;\n  r.setAttribute('width', bounds.width + 2 * padding);\n  r.setAttribute('height', bounds.height + 2 * padding);\n  r.setAttribute('y', -bounds.height + padding - 1);\n  button.setAttribute('transform', 'translate(17, 25)');\n  Blockly.bindEvent_(button, 'mousedown', this, onMouseDown);\n  cursor.y += 40;\n};\n\n/**\n * Compute width of flyout.\n * For RTL: Lay out the blocks right-aligned.\n */\nBlockly.Flyout.prototype.reflow = function() {\n  var flyoutWidth = this.minFlyoutWidth_ || 0;\n  var margin = this.CORNER_RADIUS;\n  var blocks = this.blockSpace_.getTopBlocks(false);\n  for (var x = 0, block; block = blocks[x]; x++) {\n    var blockHW = block.getHeightWidth();\n    flyoutWidth = Math.max(flyoutWidth, blockHW.width);\n  }\n  flyoutWidth += margin + Blockly.BlockSvg.TAB_WIDTH + margin / 2 +\n                 Blockly.Scrollbar.scrollbarThickness;\n  if (this.width_ != flyoutWidth) {\n    for (var x = 0, block; block = blocks[x]; x++) {\n      var blockHW = block.getHeightWidth();\n      var blockXY = block.getRelativeToSurfaceXY();\n      if (Blockly.RTL) {\n        // With the flyoutWidth known, right-align the blocks.\n        var dx = flyoutWidth - margin - Blockly.BlockSvg.TAB_WIDTH - blockXY.x;\n        block.moveBy(dx, 0);\n        blockXY.x += dx;\n      }\n      if (block.flyoutRect_) {\n        block.flyoutRect_.setAttribute('width', blockHW.width);\n        block.flyoutRect_.setAttribute('height', blockHW.height);\n        block.flyoutRect_.setAttribute('x',\n            Blockly.RTL ? blockXY.x - blockHW.width : blockXY.x);\n        block.flyoutRect_.setAttribute('y', blockXY.y);\n      }\n    }\n    // Record the width for .getMetrics_ and .position_.\n    this.width_ = flyoutWidth;\n    // Fire a resize event to update the flyout's scrollbar.\n    Blockly.fireUiEvent(window, 'resize');\n  }\n};\n\n/**\n * Handle a mouse-down on an SVG block in a non-closing flyout.\n * @param {!Blockly.Block} originBlock The flyout block to copy.\n * @return {!Function} Function to call when block is clicked.\n * @private\n */\nBlockly.Flyout.prototype.blockMouseDown_ = function(block) {\n  var flyout = this;\n  return function(e) {\n    if (!flyout.enabled_) {\n      return;\n    }\n    Blockly.BlockSpaceEditor.terminateDrag_();\n    flyout.blockSpace_.blockSpaceEditor.hideChaff();\n    if (Blockly.isRightButton(e)) {\n      // Right-click.\n      // Unlike google Blockly, we don't want to show a context menu\n      //block.showContextMenu_(Blockly.mouseToSvg(e));\n    } else {\n      // Left-click (or middle click)\n      Blockly.removeAllRanges();\n      flyout.blockSpace_.blockSpaceEditor.setCursor(Blockly.Css.Cursor.CLOSED);\n      // Record the current mouse position.\n      Blockly.Flyout.startDragMouseX_ = e.clientX;\n      Blockly.Flyout.startDragMouseY_ = e.clientY;\n      Blockly.Flyout.startBlock_ = block;\n      Blockly.Flyout.startFlyout_ = flyout;\n      Blockly.Flyout.onMouseUpWrapper_ = Blockly.bindEvent_(document,\n          'mouseup', this, Blockly.BlockSpaceEditor.terminateDrag_);\n      Blockly.Flyout.onMouseMoveWrapper_ = Blockly.bindEvent_(document,\n          'mousemove', this, flyout.onMouseMove_);\n    }\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  };\n};\n\n/**\n * Mouse button is down on a block in a non-closing flyout.  Create the block\n * if the mouse moves beyond a small radius.  This allows one to play with\n * fields without instantiating blocks that instantly self-destruct.\n * @param {!Event} e Mouse move event.\n * @private\n */\nBlockly.Flyout.prototype.onMouseMove_ = function(e) {\n  if (e.type == 'mousemove' && e.clientX <= 1 && e.clientY == 0 &&\n      e.button == 0) {\n    /* HACK:\n     Safari Mobile 6.0 and Chrome for Android 18.0 fire rogue mousemove events\n     on certain touch actions. Ignore events with these signatures.\n     This may result in a one-pixel blind spot in other browsers,\n     but this shouldn't be noticable. */\n    e.stopPropagation();\n    return;\n  }\n  Blockly.removeAllRanges();\n  var dx = e.clientX - Blockly.Flyout.startDragMouseX_;\n  var dy = e.clientY - Blockly.Flyout.startDragMouseY_;\n  // Still dragging within the sticky DRAG_RADIUS.\n  var dr = Math.sqrt(Math.pow(dx, 2) + Math.pow(dy, 2));\n  if (dr > Blockly.DRAG_RADIUS) {\n\n    // Pass through the start drag position.\n    e.startDragMouseX_ = Blockly.Flyout.startDragMouseX_;\n    e.startDragMouseY_ = Blockly.Flyout.startDragMouseY_;\n\n    // Create the block.\n    Blockly.Flyout.startFlyout_.createBlockFunc_(Blockly.Flyout.startBlock_)(e);\n  }\n};\n\n/**\n * Create a new Function block and open the editor.\n * @return {!Function} Function to call when block is clicked.\n * @private\n */\nBlockly.Flyout.prototype.createFunction_ = function() {\n  Blockly.functionEditor.openWithNewFunction();\n};\n\nBlockly.Flyout.prototype.createFunctionalVariable_ = function() {\n  Blockly.contractEditor.openWithNewVariable();\n};\n\n/**\n * Create a copy of this block on the blockSpace.\n * @param {!Blockly.Block} originBlock The flyout block to copy.\n * @return {!Function} Function to call when block is clicked.\n * @private\n */\nBlockly.Flyout.prototype.createBlockFunc_ = function(originBlock) {\n  var flyout = this;\n  return function(e) {\n    if (!flyout.enabled_) {\n      return;\n    }\n    if (Blockly.isRightButton(e)) {\n      // Right-click.  Don't create a block, let the context menu show.\n      return;\n    }\n    if (originBlock.disabled) {\n      // Beyond capacity.\n      return;\n    }\n    // Create the new block by cloning the block in the flyout (via XML).\n    var xml = Blockly.Xml.blockToDom(originBlock);\n    var targetBlockSpace = flyout.targetBlockSpace_;\n    Blockly.Block.startDragging();\n    var block = Blockly.Xml.domToBlock(targetBlockSpace, xml);\n    // Place it in the same spot as the flyout copy.\n    var svgRootOld = originBlock.getSvgRoot();\n    if (!svgRootOld) {\n      throw 'originBlock is not rendered.';\n    }\n    var xyOld = Blockly.getSvgXY_(svgRootOld,\n        originBlock.blockSpace.blockSpaceEditor.svg_);\n    var svgRootNew = block.getSvgRoot();\n    if (!svgRootNew) {\n      throw 'block is not rendered.';\n    }\n    var xyNew = Blockly.getSvgXY_(svgRootNew,\n        block.blockSpace.blockSpaceEditor.svg_);\n    block.moveBy(xyOld.x - xyNew.x, xyOld.y - xyNew.y);\n    if (flyout.autoClose) {\n      /**\n       * We need to avoid destroying the currently dragged block\n       * until the active touchmove event is completed (block dropped)\n       * @see https://neil.fraser.name/news/2014/08/09/\n       */\n      flyout.hide(originBlock);\n      block.blockEvents.listenOnce(\n        Blockly.Block.EVENTS.AFTER_DROPPED,\n        function () {\n          originBlock.dispose(false, false);\n        }\n      );\n    } else {\n      flyout.filterForCapacity_();\n    }\n    if (Blockly.topLevelProcedureAutopopulate && block.isFunctionDefinition()) {\n      block.blockEvents.listenOnce(\n        Blockly.Block.EVENTS.AFTER_DROPPED,\n        function() {\n          window.setTimeout(function() {\n            targetBlockSpace.blockSpaceEditor.updateFlyout();\n          }, 0);\n        }\n      );\n    }\n    if (Blockly.isPortrait) {\n      flyout.svgGroup_.style.display = 'none';\n    }\n    // Start a dragging operation on the new block.\n    block.onMouseDown_(e);\n  };\n};\n\n/**\n * All updates to be performed every time the block space changes\n * @private\n */\nBlockly.Flyout.prototype.onBlockSpaceChange_ = function() {\n  this.filterForCapacity_();\n  this.updateBlockLimitTotals_();\n};\n\n/**\n * Filter the blocks on the flyout to disable the ones that are above the\n * capacity limit.\n * @private\n */\nBlockly.Flyout.prototype.filterForCapacity_ = function() {\n  var remainingCapacity = this.targetBlockSpace_.remainingCapacity();\n  var blocks = this.blockSpace_.getTopBlocks(false);\n  for (var i = 0, block; block = blocks[i]; i++) {\n    var allBlocks = block.getDescendants();\n    var disabled = allBlocks.length > remainingCapacity;\n    block.setDisabled(disabled);\n  }\n};\n\nBlockly.Flyout.prototype.updateBlockLimitTotals_ = function() {\n  var blocks = this.blockSpaceEditor_.blockSpace.getAllBlocks();\n  blocks = goog.array.filter(blocks, function (block) {\n    return block.isUserVisible() && !block.getRootBlock().isUnused();\n  });\n  var blockTypes = blocks.map(function (block) {\n    return block.type;\n  });\n  this.blockSpaceEditor_.blockLimits.updateBlockTotals(blockTypes);\n};\n\n/**\n * Stop binding to the global mouseup and mousemove events.\n * @private\n */\nBlockly.Flyout.terminateDrag_ = function() {\n  if (Blockly.Flyout.onMouseUpWrapper_) {\n    Blockly.unbindEvent_(Blockly.Flyout.onMouseUpWrapper_);\n    Blockly.Flyout.onMouseUpWrapper_ = null;\n  }\n  if (Blockly.Flyout.onMouseMoveWrapper_) {\n    Blockly.unbindEvent_(Blockly.Flyout.onMouseMoveWrapper_);\n    Blockly.Flyout.onMouseMoveWrapper_ = null;\n  }\n  Blockly.Flyout.startDragMouseX_ = 0;\n  Blockly.Flyout.startDragMouseY_ = 0;\n  Blockly.Flyout.startBlock_ = null;\n  Blockly.Flyout.startFlyout_ = null;\n};\n\n/**\n * When disabled, block clicks on blocks will be ignored.\n */\nBlockly.Flyout.prototype.setEnabled = function (enabled) {\n  this.enabled_ = enabled;\n};\n\n/**\n* Return the deletion rectangle for this flyout.\n* @return {goog.math.Rect} Rectangle in which to delete.\n*/\nBlockly.Flyout.prototype.getRect = function() {\n  // BIG_NUM is offscreen padding so that blocks dragged beyond the shown flyout\n  // area are still deleted.  Must be smaller than Infinity, but larger than\n  // the largest screen size.\n  var BIG_NUM = 10000000;\n  var x = Blockly.getSvgXY_(this.svgGroup_).x;\n  if (!Blockly.RTL) {\n    x -= BIG_NUM;\n  }\n  return new goog.math.Rect(x, -BIG_NUM,\n    BIG_NUM + this.width_, this.height_ + 2 * BIG_NUM);\n};\n\nBlockly.Flyout.prototype.getAllBlocks = function() {\n  return this.blockSpace_.getAllBlocks();\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview This event handler allows you to catch focusin and focusout\n * events on  descendants. Unlike the \"focus\" and \"blur\" events which do not\n * propagate consistently, and therefore must be added to the element that is\n * focused, this allows you to attach one listener to an ancester and you will\n * be notified when the focus state changes of ony of its descendants.\n * @author arv@google.com (Erik Arvidsson)\n * @see ../demos/focushandler.html\n */\n\ngoog.provide('goog.events.FocusHandler');\ngoog.provide('goog.events.FocusHandler.EventType');\n\ngoog.require('goog.events');\ngoog.require('goog.events.BrowserEvent');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.userAgent');\n\n\n\n/**\n * This event handler allows you to catch focus events when descendants gain or\n * loses focus.\n * @param {Element|Document} element  The node to listen on.\n * @constructor\n * @extends {goog.events.EventTarget}\n * @final\n */\ngoog.events.FocusHandler = function(element) {\n  goog.events.EventTarget.call(this);\n\n  /**\n   * This is the element that we will listen to the real focus events on.\n   * @type {Element|Document}\n   * @private\n   */\n  this.element_ = element;\n\n  // In IE we use focusin/focusout and in other browsers we use a capturing\n  // listner for focus/blur\n  var typeIn = goog.userAgent.IE ? 'focusin' : 'focus';\n  var typeOut = goog.userAgent.IE ? 'focusout' : 'blur';\n\n  /**\n   * Store the listen key so it easier to unlisten in dispose.\n   * @private\n   * @type {goog.events.Key}\n   */\n  this.listenKeyIn_ =\n      goog.events.listen(this.element_, typeIn, this, !goog.userAgent.IE);\n\n  /**\n   * Store the listen key so it easier to unlisten in dispose.\n   * @private\n   * @type {goog.events.Key}\n   */\n  this.listenKeyOut_ =\n      goog.events.listen(this.element_, typeOut, this, !goog.userAgent.IE);\n};\ngoog.inherits(goog.events.FocusHandler, goog.events.EventTarget);\n\n\n/**\n * Enum type for the events fired by the focus handler\n * @enum {string}\n */\ngoog.events.FocusHandler.EventType = {\n  FOCUSIN: 'focusin',\n  FOCUSOUT: 'focusout'\n};\n\n\n/**\n * This handles the underlying events and dispatches a new event.\n * @param {goog.events.BrowserEvent} e  The underlying browser event.\n */\ngoog.events.FocusHandler.prototype.handleEvent = function(e) {\n  var be = e.getBrowserEvent();\n  var event = new goog.events.BrowserEvent(be);\n  event.type = e.type == 'focusin' || e.type == 'focus' ?\n      goog.events.FocusHandler.EventType.FOCUSIN :\n      goog.events.FocusHandler.EventType.FOCUSOUT;\n  this.dispatchEvent(event);\n};\n\n\n/** @override */\ngoog.events.FocusHandler.prototype.disposeInternal = function() {\n  goog.events.FocusHandler.superClass_.disposeInternal.call(this);\n  goog.events.unlistenByKey(this.listenKeyIn_);\n  goog.events.unlistenByKey(this.listenKeyOut_);\n  delete this.element_;\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Generics method for collection-like classes and objects.\n *\n * @author arv@google.com (Erik Arvidsson)\n *\n * This file contains functions to work with collections. It supports using\n * Map, Set, Array and Object and other classes that implement collection-like\n * methods.\n */\n\n\ngoog.provide('goog.structs');\n\ngoog.require('goog.array');\ngoog.require('goog.object');\n\n\n// We treat an object as a dictionary if it has getKeys or it is an object that\n// isn't arrayLike.\n\n\n/**\n * Returns the number of values in the collection-like object.\n * @param {Object} col The collection-like object.\n * @return {number} The number of values in the collection-like object.\n */\ngoog.structs.getCount = function(col) {\n  if (col.getCount && typeof col.getCount == 'function') {\n    return col.getCount();\n  }\n  if (goog.isArrayLike(col) || goog.isString(col)) {\n    return col.length;\n  }\n  return goog.object.getCount(col);\n};\n\n\n/**\n * Returns the values of the collection-like object.\n * @param {Object} col The collection-like object.\n * @return {!Array<?>} The values in the collection-like object.\n */\ngoog.structs.getValues = function(col) {\n  if (col.getValues && typeof col.getValues == 'function') {\n    return col.getValues();\n  }\n  if (goog.isString(col)) {\n    return col.split('');\n  }\n  if (goog.isArrayLike(col)) {\n    var rv = [];\n    var l = col.length;\n    for (var i = 0; i < l; i++) {\n      rv.push(col[i]);\n    }\n    return rv;\n  }\n  return goog.object.getValues(col);\n};\n\n\n/**\n * Returns the keys of the collection. Some collections have no notion of\n * keys/indexes and this function will return undefined in those cases.\n * @param {Object} col The collection-like object.\n * @return {!Array|undefined} The keys in the collection.\n */\ngoog.structs.getKeys = function(col) {\n  if (col.getKeys && typeof col.getKeys == 'function') {\n    return col.getKeys();\n  }\n  // if we have getValues but no getKeys we know this is a key-less collection\n  if (col.getValues && typeof col.getValues == 'function') {\n    return undefined;\n  }\n  if (goog.isArrayLike(col) || goog.isString(col)) {\n    var rv = [];\n    var l = col.length;\n    for (var i = 0; i < l; i++) {\n      rv.push(i);\n    }\n    return rv;\n  }\n\n  return goog.object.getKeys(col);\n};\n\n\n/**\n * Whether the collection contains the given value. This is O(n) and uses\n * equals (==) to test the existence.\n * @param {Object} col The collection-like object.\n * @param {*} val The value to check for.\n * @return {boolean} True if the map contains the value.\n */\ngoog.structs.contains = function(col, val) {\n  if (col.contains && typeof col.contains == 'function') {\n    return col.contains(val);\n  }\n  if (col.containsValue && typeof col.containsValue == 'function') {\n    return col.containsValue(val);\n  }\n  if (goog.isArrayLike(col) || goog.isString(col)) {\n    return goog.array.contains(/** @type {!Array<?>} */ (col), val);\n  }\n  return goog.object.containsValue(col, val);\n};\n\n\n/**\n * Whether the collection is empty.\n * @param {Object} col The collection-like object.\n * @return {boolean} True if empty.\n */\ngoog.structs.isEmpty = function(col) {\n  if (col.isEmpty && typeof col.isEmpty == 'function') {\n    return col.isEmpty();\n  }\n\n  // We do not use goog.string.isEmptyOrWhitespace because here we treat the\n  // string as\n  // collection and as such even whitespace matters\n\n  if (goog.isArrayLike(col) || goog.isString(col)) {\n    return goog.array.isEmpty(/** @type {!Array<?>} */ (col));\n  }\n  return goog.object.isEmpty(col);\n};\n\n\n/**\n * Removes all the elements from the collection.\n * @param {Object} col The collection-like object.\n */\ngoog.structs.clear = function(col) {\n  // NOTE(arv): This should not contain strings because strings are immutable\n  if (col.clear && typeof col.clear == 'function') {\n    col.clear();\n  } else if (goog.isArrayLike(col)) {\n    goog.array.clear(/** @type {IArrayLike<?>} */ (col));\n  } else {\n    goog.object.clear(col);\n  }\n};\n\n\n/**\n * Calls a function for each value in a collection. The function takes\n * three arguments; the value, the key and the collection.\n *\n * NOTE: This will be deprecated soon! Please use a more specific method if\n * possible, e.g. goog.array.forEach, goog.object.forEach, etc.\n *\n * @param {S} col The collection-like object.\n * @param {function(this:T,?,?,S):?} f The function to call for every value.\n *     This function takes\n *     3 arguments (the value, the key or undefined if the collection has no\n *     notion of keys, and the collection) and the return value is irrelevant.\n * @param {T=} opt_obj The object to be used as the value of 'this'\n *     within {@code f}.\n * @template T,S\n */\ngoog.structs.forEach = function(col, f, opt_obj) {\n  if (col.forEach && typeof col.forEach == 'function') {\n    col.forEach(f, opt_obj);\n  } else if (goog.isArrayLike(col) || goog.isString(col)) {\n    goog.array.forEach(/** @type {!Array<?>} */ (col), f, opt_obj);\n  } else {\n    var keys = goog.structs.getKeys(col);\n    var values = goog.structs.getValues(col);\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n      f.call(/** @type {?} */ (opt_obj), values[i], keys && keys[i], col);\n    }\n  }\n};\n\n\n/**\n * Calls a function for every value in the collection. When a call returns true,\n * adds the value to a new collection (Array is returned by default).\n *\n * @param {S} col The collection-like object.\n * @param {function(this:T,?,?,S):boolean} f The function to call for every\n *     value. This function takes\n *     3 arguments (the value, the key or undefined if the collection has no\n *     notion of keys, and the collection) and should return a Boolean. If the\n *     return value is true the value is added to the result collection. If it\n *     is false the value is not included.\n * @param {T=} opt_obj The object to be used as the value of 'this'\n *     within {@code f}.\n * @return {!Object|!Array<?>} A new collection where the passed values are\n *     present. If col is a key-less collection an array is returned.  If col\n *     has keys and values a plain old JS object is returned.\n * @template T,S\n */\ngoog.structs.filter = function(col, f, opt_obj) {\n  if (typeof col.filter == 'function') {\n    return col.filter(f, opt_obj);\n  }\n  if (goog.isArrayLike(col) || goog.isString(col)) {\n    return goog.array.filter(/** @type {!Array<?>} */ (col), f, opt_obj);\n  }\n\n  var rv;\n  var keys = goog.structs.getKeys(col);\n  var values = goog.structs.getValues(col);\n  var l = values.length;\n  if (keys) {\n    rv = {};\n    for (var i = 0; i < l; i++) {\n      if (f.call(/** @type {?} */ (opt_obj), values[i], keys[i], col)) {\n        rv[keys[i]] = values[i];\n      }\n    }\n  } else {\n    // We should not use goog.array.filter here since we want to make sure that\n    // the index is undefined as well as make sure that col is passed to the\n    // function.\n    rv = [];\n    for (var i = 0; i < l; i++) {\n      if (f.call(opt_obj, values[i], undefined, col)) {\n        rv.push(values[i]);\n      }\n    }\n  }\n  return rv;\n};\n\n\n/**\n * Calls a function for every value in the collection and adds the result into a\n * new collection (defaults to creating a new Array).\n *\n * @param {S} col The collection-like object.\n * @param {function(this:T,?,?,S):V} f The function to call for every value.\n *     This function takes 3 arguments (the value, the key or undefined if the\n *     collection has no notion of keys, and the collection) and should return\n *     something. The result will be used as the value in the new collection.\n * @param {T=} opt_obj  The object to be used as the value of 'this'\n *     within {@code f}.\n * @return {!Object<V>|!Array<V>} A new collection with the new values.  If\n *     col is a key-less collection an array is returned.  If col has keys and\n *     values a plain old JS object is returned.\n * @template T,S,V\n */\ngoog.structs.map = function(col, f, opt_obj) {\n  if (typeof col.map == 'function') {\n    return col.map(f, opt_obj);\n  }\n  if (goog.isArrayLike(col) || goog.isString(col)) {\n    return goog.array.map(/** @type {!Array<?>} */ (col), f, opt_obj);\n  }\n\n  var rv;\n  var keys = goog.structs.getKeys(col);\n  var values = goog.structs.getValues(col);\n  var l = values.length;\n  if (keys) {\n    rv = {};\n    for (var i = 0; i < l; i++) {\n      rv[keys[i]] = f.call(/** @type {?} */ (opt_obj), values[i], keys[i], col);\n    }\n  } else {\n    // We should not use goog.array.map here since we want to make sure that\n    // the index is undefined as well as make sure that col is passed to the\n    // function.\n    rv = [];\n    for (var i = 0; i < l; i++) {\n      rv[i] = f.call(/** @type {?} */ (opt_obj), values[i], undefined, col);\n    }\n  }\n  return rv;\n};\n\n\n/**\n * Calls f for each value in a collection. If any call returns true this returns\n * true (without checking the rest). If all returns false this returns false.\n *\n * @param {S} col The collection-like object.\n * @param {function(this:T,?,?,S):boolean} f The function to call for every\n *     value. This function takes 3 arguments (the value, the key or undefined\n *     if the collection has no notion of keys, and the collection) and should\n *     return a boolean.\n * @param {T=} opt_obj  The object to be used as the value of 'this'\n *     within {@code f}.\n * @return {boolean} True if any value passes the test.\n * @template T,S\n */\ngoog.structs.some = function(col, f, opt_obj) {\n  if (typeof col.some == 'function') {\n    return col.some(f, opt_obj);\n  }\n  if (goog.isArrayLike(col) || goog.isString(col)) {\n    return goog.array.some(/** @type {!Array<?>} */ (col), f, opt_obj);\n  }\n  var keys = goog.structs.getKeys(col);\n  var values = goog.structs.getValues(col);\n  var l = values.length;\n  for (var i = 0; i < l; i++) {\n    if (f.call(/** @type {?} */ (opt_obj), values[i], keys && keys[i], col)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Calls f for each value in a collection. If all calls return true this return\n * true this returns true. If any returns false this returns false at this point\n *  and does not continue to check the remaining values.\n *\n * @param {S} col The collection-like object.\n * @param {function(this:T,?,?,S):boolean} f The function to call for every\n *     value. This function takes 3 arguments (the value, the key or\n *     undefined if the collection has no notion of keys, and the collection)\n *     and should return a boolean.\n * @param {T=} opt_obj  The object to be used as the value of 'this'\n *     within {@code f}.\n * @return {boolean} True if all key-value pairs pass the test.\n * @template T,S\n */\ngoog.structs.every = function(col, f, opt_obj) {\n  if (typeof col.every == 'function') {\n    return col.every(f, opt_obj);\n  }\n  if (goog.isArrayLike(col) || goog.isString(col)) {\n    return goog.array.every(/** @type {!Array<?>} */ (col), f, opt_obj);\n  }\n  var keys = goog.structs.getKeys(col);\n  var values = goog.structs.getValues(col);\n  var l = values.length;\n  for (var i = 0; i < l; i++) {\n    if (!f.call(/** @type {?} */ (opt_obj), values[i], keys && keys[i], col)) {\n      return false;\n    }\n  }\n  return true;\n};\n","// Copyright 2011 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Defines the collection interface.\n *\n * @author nnaze@google.com (Nathan Naze)\n */\n\ngoog.provide('goog.structs.Collection');\n\n\n\n/**\n * An interface for a collection of values.\n * @interface\n * @template T\n */\ngoog.structs.Collection = function() {};\n\n\n/**\n * @param {T} value Value to add to the collection.\n */\ngoog.structs.Collection.prototype.add;\n\n\n/**\n * @param {T} value Value to remove from the collection.\n */\ngoog.structs.Collection.prototype.remove;\n\n\n/**\n * @param {T} value Value to find in the collection.\n * @return {boolean} Whether the collection contains the specified value.\n */\ngoog.structs.Collection.prototype.contains;\n\n\n/**\n * @return {number} The number of values stored in the collection.\n */\ngoog.structs.Collection.prototype.getCount;\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Datastructure: Hash Map.\n *\n * @author arv@google.com (Erik Arvidsson)\n *\n * This file contains an implementation of a Map structure. It implements a lot\n * of the methods used in goog.structs so those functions work on hashes. This\n * is best suited for complex key types. For simple keys such as numbers and\n * strings consider using the lighter-weight utilities in goog.object.\n */\n\n\ngoog.provide('goog.structs.Map');\n\ngoog.require('goog.iter.Iterator');\ngoog.require('goog.iter.StopIteration');\ngoog.require('goog.object');\n\n\n\n/**\n * Class for Hash Map datastructure.\n * @param {*=} opt_map Map or Object to initialize the map with.\n * @param {...*} var_args If 2 or more arguments are present then they\n *     will be used as key-value pairs.\n * @constructor\n * @template K, V\n */\ngoog.structs.Map = function(opt_map, var_args) {\n\n  /**\n   * Underlying JS object used to implement the map.\n   * @private {!Object}\n   */\n  this.map_ = {};\n\n  /**\n   * An array of keys. This is necessary for two reasons:\n   *   1. Iterating the keys using for (var key in this.map_) allocates an\n   *      object for every key in IE which is really bad for IE6 GC perf.\n   *   2. Without a side data structure, we would need to escape all the keys\n   *      as that would be the only way we could tell during iteration if the\n   *      key was an internal key or a property of the object.\n   *\n   * This array can contain deleted keys so it's necessary to check the map\n   * as well to see if the key is still in the map (this doesn't require a\n   * memory allocation in IE).\n   * @private {!Array<string>}\n   */\n  this.keys_ = [];\n\n  /**\n   * The number of key value pairs in the map.\n   * @private {number}\n   */\n  this.count_ = 0;\n\n  /**\n   * Version used to detect changes while iterating.\n   * @private {number}\n   */\n  this.version_ = 0;\n\n  var argLength = arguments.length;\n\n  if (argLength > 1) {\n    if (argLength % 2) {\n      throw Error('Uneven number of arguments');\n    }\n    for (var i = 0; i < argLength; i += 2) {\n      this.set(arguments[i], arguments[i + 1]);\n    }\n  } else if (opt_map) {\n    this.addAll(/** @type {Object} */ (opt_map));\n  }\n};\n\n\n/**\n * @return {number} The number of key-value pairs in the map.\n */\ngoog.structs.Map.prototype.getCount = function() {\n  return this.count_;\n};\n\n\n/**\n * Returns the values of the map.\n * @return {!Array<V>} The values in the map.\n */\ngoog.structs.Map.prototype.getValues = function() {\n  this.cleanupKeysArray_();\n\n  var rv = [];\n  for (var i = 0; i < this.keys_.length; i++) {\n    var key = this.keys_[i];\n    rv.push(this.map_[key]);\n  }\n  return rv;\n};\n\n\n/**\n * Returns the keys of the map.\n * @return {!Array<string>} Array of string values.\n */\ngoog.structs.Map.prototype.getKeys = function() {\n  this.cleanupKeysArray_();\n  return /** @type {!Array<string>} */ (this.keys_.concat());\n};\n\n\n/**\n * Whether the map contains the given key.\n * @param {*} key The key to check for.\n * @return {boolean} Whether the map contains the key.\n */\ngoog.structs.Map.prototype.containsKey = function(key) {\n  return goog.structs.Map.hasKey_(this.map_, key);\n};\n\n\n/**\n * Whether the map contains the given value. This is O(n).\n * @param {V} val The value to check for.\n * @return {boolean} Whether the map contains the value.\n */\ngoog.structs.Map.prototype.containsValue = function(val) {\n  for (var i = 0; i < this.keys_.length; i++) {\n    var key = this.keys_[i];\n    if (goog.structs.Map.hasKey_(this.map_, key) && this.map_[key] == val) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Whether this map is equal to the argument map.\n * @param {goog.structs.Map} otherMap The map against which to test equality.\n * @param {function(V, V): boolean=} opt_equalityFn Optional equality function\n *     to test equality of values. If not specified, this will test whether\n *     the values contained in each map are identical objects.\n * @return {boolean} Whether the maps are equal.\n */\ngoog.structs.Map.prototype.equals = function(otherMap, opt_equalityFn) {\n  if (this === otherMap) {\n    return true;\n  }\n\n  if (this.count_ != otherMap.getCount()) {\n    return false;\n  }\n\n  var equalityFn = opt_equalityFn || goog.structs.Map.defaultEquals;\n\n  this.cleanupKeysArray_();\n  for (var key, i = 0; key = this.keys_[i]; i++) {\n    if (!equalityFn(this.get(key), otherMap.get(key))) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\n\n/**\n * Default equality test for values.\n * @param {*} a The first value.\n * @param {*} b The second value.\n * @return {boolean} Whether a and b reference the same object.\n */\ngoog.structs.Map.defaultEquals = function(a, b) {\n  return a === b;\n};\n\n\n/**\n * @return {boolean} Whether the map is empty.\n */\ngoog.structs.Map.prototype.isEmpty = function() {\n  return this.count_ == 0;\n};\n\n\n/**\n * Removes all key-value pairs from the map.\n */\ngoog.structs.Map.prototype.clear = function() {\n  this.map_ = {};\n  this.keys_.length = 0;\n  this.count_ = 0;\n  this.version_ = 0;\n};\n\n\n/**\n * Removes a key-value pair based on the key. This is O(logN) amortized due to\n * updating the keys array whenever the count becomes half the size of the keys\n * in the keys array.\n * @param {*} key  The key to remove.\n * @return {boolean} Whether object was removed.\n */\ngoog.structs.Map.prototype.remove = function(key) {\n  if (goog.structs.Map.hasKey_(this.map_, key)) {\n    delete this.map_[key];\n    this.count_--;\n    this.version_++;\n\n    // clean up the keys array if the threshold is hit\n    if (this.keys_.length > 2 * this.count_) {\n      this.cleanupKeysArray_();\n    }\n\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Cleans up the temp keys array by removing entries that are no longer in the\n * map.\n * @private\n */\ngoog.structs.Map.prototype.cleanupKeysArray_ = function() {\n  if (this.count_ != this.keys_.length) {\n    // First remove keys that are no longer in the map.\n    var srcIndex = 0;\n    var destIndex = 0;\n    while (srcIndex < this.keys_.length) {\n      var key = this.keys_[srcIndex];\n      if (goog.structs.Map.hasKey_(this.map_, key)) {\n        this.keys_[destIndex++] = key;\n      }\n      srcIndex++;\n    }\n    this.keys_.length = destIndex;\n  }\n\n  if (this.count_ != this.keys_.length) {\n    // If the count still isn't correct, that means we have duplicates. This can\n    // happen when the same key is added and removed multiple times. Now we have\n    // to allocate one extra Object to remove the duplicates. This could have\n    // been done in the first pass, but in the common case, we can avoid\n    // allocating an extra object by only doing this when necessary.\n    var seen = {};\n    var srcIndex = 0;\n    var destIndex = 0;\n    while (srcIndex < this.keys_.length) {\n      var key = this.keys_[srcIndex];\n      if (!(goog.structs.Map.hasKey_(seen, key))) {\n        this.keys_[destIndex++] = key;\n        seen[key] = 1;\n      }\n      srcIndex++;\n    }\n    this.keys_.length = destIndex;\n  }\n};\n\n\n/**\n * Returns the value for the given key.  If the key is not found and the default\n * value is not given this will return {@code undefined}.\n * @param {*} key The key to get the value for.\n * @param {DEFAULT=} opt_val The value to return if no item is found for the\n *     given key, defaults to undefined.\n * @return {V|DEFAULT} The value for the given key.\n * @template DEFAULT\n */\ngoog.structs.Map.prototype.get = function(key, opt_val) {\n  if (goog.structs.Map.hasKey_(this.map_, key)) {\n    return this.map_[key];\n  }\n  return opt_val;\n};\n\n\n/**\n * Adds a key-value pair to the map.\n * @param {*} key The key.\n * @param {V} value The value to add.\n * @return {*} Some subclasses return a value.\n */\ngoog.structs.Map.prototype.set = function(key, value) {\n  if (!(goog.structs.Map.hasKey_(this.map_, key))) {\n    this.count_++;\n    // TODO(johnlenz): This class lies, it claims to return an array of string\n    // keys, but instead returns the original object used.\n    this.keys_.push(/** @type {?} */ (key));\n    // Only change the version if we add a new key.\n    this.version_++;\n  }\n  this.map_[key] = value;\n};\n\n\n/**\n * Adds multiple key-value pairs from another goog.structs.Map or Object.\n * @param {Object} map  Object containing the data to add.\n */\ngoog.structs.Map.prototype.addAll = function(map) {\n  var keys, values;\n  if (map instanceof goog.structs.Map) {\n    keys = map.getKeys();\n    values = map.getValues();\n  } else {\n    keys = goog.object.getKeys(map);\n    values = goog.object.getValues(map);\n  }\n  // we could use goog.array.forEach here but I don't want to introduce that\n  // dependency just for this.\n  for (var i = 0; i < keys.length; i++) {\n    this.set(keys[i], values[i]);\n  }\n};\n\n\n/**\n * Calls the given function on each entry in the map.\n * @param {function(this:T, V, K, goog.structs.Map<K,V>)} f\n * @param {T=} opt_obj The value of \"this\" inside f.\n * @template T\n */\ngoog.structs.Map.prototype.forEach = function(f, opt_obj) {\n  var keys = this.getKeys();\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = this.get(key);\n    f.call(opt_obj, value, key, this);\n  }\n};\n\n\n/**\n * Clones a map and returns a new map.\n * @return {!goog.structs.Map} A new map with the same key-value pairs.\n */\ngoog.structs.Map.prototype.clone = function() {\n  return new goog.structs.Map(this);\n};\n\n\n/**\n * Returns a new map in which all the keys and values are interchanged\n * (keys become values and values become keys). If multiple keys map to the\n * same value, the chosen transposed value is implementation-dependent.\n *\n * It acts very similarly to {goog.object.transpose(Object)}.\n *\n * @return {!goog.structs.Map} The transposed map.\n */\ngoog.structs.Map.prototype.transpose = function() {\n  var transposed = new goog.structs.Map();\n  for (var i = 0; i < this.keys_.length; i++) {\n    var key = this.keys_[i];\n    var value = this.map_[key];\n    transposed.set(value, key);\n  }\n\n  return transposed;\n};\n\n\n/**\n * @return {!Object} Object representation of the map.\n */\ngoog.structs.Map.prototype.toObject = function() {\n  this.cleanupKeysArray_();\n  var obj = {};\n  for (var i = 0; i < this.keys_.length; i++) {\n    var key = this.keys_[i];\n    obj[key] = this.map_[key];\n  }\n  return obj;\n};\n\n\n/**\n * Returns an iterator that iterates over the keys in the map.  Removal of keys\n * while iterating might have undesired side effects.\n * @return {!goog.iter.Iterator} An iterator over the keys in the map.\n */\ngoog.structs.Map.prototype.getKeyIterator = function() {\n  return this.__iterator__(true);\n};\n\n\n/**\n * Returns an iterator that iterates over the values in the map.  Removal of\n * keys while iterating might have undesired side effects.\n * @return {!goog.iter.Iterator} An iterator over the values in the map.\n */\ngoog.structs.Map.prototype.getValueIterator = function() {\n  return this.__iterator__(false);\n};\n\n\n/**\n * Returns an iterator that iterates over the values or the keys in the map.\n * This throws an exception if the map was mutated since the iterator was\n * created.\n * @param {boolean=} opt_keys True to iterate over the keys. False to iterate\n *     over the values.  The default value is false.\n * @return {!goog.iter.Iterator} An iterator over the values or keys in the map.\n */\ngoog.structs.Map.prototype.__iterator__ = function(opt_keys) {\n  // Clean up keys to minimize the risk of iterating over dead keys.\n  this.cleanupKeysArray_();\n\n  var i = 0;\n  var version = this.version_;\n  var selfObj = this;\n\n  var newIter = new goog.iter.Iterator;\n  newIter.next = function() {\n    if (version != selfObj.version_) {\n      throw Error('The map has changed since the iterator was created');\n    }\n    if (i >= selfObj.keys_.length) {\n      throw goog.iter.StopIteration;\n    }\n    var key = selfObj.keys_[i++];\n    return opt_keys ? key : selfObj.map_[key];\n  };\n  return newIter;\n};\n\n\n/**\n * Safe way to test for hasOwnProperty.  It even allows testing for\n * 'hasOwnProperty'.\n * @param {Object} obj The object to test for presence of the given key.\n * @param {*} key The key to check for.\n * @return {boolean} Whether the object has the key.\n * @private\n */\ngoog.structs.Map.hasKey_ = function(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Datastructure: Set.\n *\n * @author arv@google.com (Erik Arvidsson)\n *\n * This class implements a set data structure. Adding and removing is O(1). It\n * supports both object and primitive values. Be careful because you can add\n * both 1 and new Number(1), because these are not the same. You can even add\n * multiple new Number(1) because these are not equal.\n */\n\n\ngoog.provide('goog.structs.Set');\n\ngoog.require('goog.structs');\ngoog.require('goog.structs.Collection');\ngoog.require('goog.structs.Map');\n\n\n\n/**\n * A set that can contain both primitives and objects.  Adding and removing\n * elements is O(1).  Primitives are treated as identical if they have the same\n * type and convert to the same string.  Objects are treated as identical only\n * if they are references to the same object.  WARNING: A goog.structs.Set can\n * contain both 1 and (new Number(1)), because they are not the same.  WARNING:\n * Adding (new Number(1)) twice will yield two distinct elements, because they\n * are two different objects.  WARNING: Any object that is added to a\n * goog.structs.Set will be modified!  Because goog.getUid() is used to\n * identify objects, every object in the set will be mutated.\n * @param {Array<T>|Object<?,T>=} opt_values Initial values to start with.\n * @constructor\n * @implements {goog.structs.Collection<T>}\n * @final\n * @template T\n */\ngoog.structs.Set = function(opt_values) {\n  this.map_ = new goog.structs.Map;\n  if (opt_values) {\n    this.addAll(opt_values);\n  }\n};\n\n\n/**\n * Obtains a unique key for an element of the set.  Primitives will yield the\n * same key if they have the same type and convert to the same string.  Object\n * references will yield the same key only if they refer to the same object.\n * @param {*} val Object or primitive value to get a key for.\n * @return {string} A unique key for this value/object.\n * @private\n */\ngoog.structs.Set.getKey_ = function(val) {\n  var type = typeof val;\n  if (type == 'object' && val || type == 'function') {\n    return 'o' + goog.getUid(/** @type {Object} */ (val));\n  } else {\n    return type.substr(0, 1) + val;\n  }\n};\n\n\n/**\n * @return {number} The number of elements in the set.\n * @override\n */\ngoog.structs.Set.prototype.getCount = function() {\n  return this.map_.getCount();\n};\n\n\n/**\n * Add a primitive or an object to the set.\n * @param {T} element The primitive or object to add.\n * @override\n */\ngoog.structs.Set.prototype.add = function(element) {\n  this.map_.set(goog.structs.Set.getKey_(element), element);\n};\n\n\n/**\n * Adds all the values in the given collection to this set.\n * @param {Array<T>|goog.structs.Collection<T>|Object<?,T>} col A collection\n *     containing the elements to add.\n */\ngoog.structs.Set.prototype.addAll = function(col) {\n  var values = goog.structs.getValues(col);\n  var l = values.length;\n  for (var i = 0; i < l; i++) {\n    this.add(values[i]);\n  }\n};\n\n\n/**\n * Removes all values in the given collection from this set.\n * @param {Array<T>|goog.structs.Collection<T>|Object<?,T>} col A collection\n *     containing the elements to remove.\n */\ngoog.structs.Set.prototype.removeAll = function(col) {\n  var values = goog.structs.getValues(col);\n  var l = values.length;\n  for (var i = 0; i < l; i++) {\n    this.remove(values[i]);\n  }\n};\n\n\n/**\n * Removes the given element from this set.\n * @param {T} element The primitive or object to remove.\n * @return {boolean} Whether the element was found and removed.\n * @override\n */\ngoog.structs.Set.prototype.remove = function(element) {\n  return this.map_.remove(goog.structs.Set.getKey_(element));\n};\n\n\n/**\n * Removes all elements from this set.\n */\ngoog.structs.Set.prototype.clear = function() {\n  this.map_.clear();\n};\n\n\n/**\n * Tests whether this set is empty.\n * @return {boolean} True if there are no elements in this set.\n */\ngoog.structs.Set.prototype.isEmpty = function() {\n  return this.map_.isEmpty();\n};\n\n\n/**\n * Tests whether this set contains the given element.\n * @param {T} element The primitive or object to test for.\n * @return {boolean} True if this set contains the given element.\n * @override\n */\ngoog.structs.Set.prototype.contains = function(element) {\n  return this.map_.containsKey(goog.structs.Set.getKey_(element));\n};\n\n\n/**\n * Tests whether this set contains all the values in a given collection.\n * Repeated elements in the collection are ignored, e.g.  (new\n * goog.structs.Set([1, 2])).containsAll([1, 1]) is True.\n * @param {goog.structs.Collection<T>|Object} col A collection-like object.\n * @return {boolean} True if the set contains all elements.\n */\ngoog.structs.Set.prototype.containsAll = function(col) {\n  return goog.structs.every(col, this.contains, this);\n};\n\n\n/**\n * Finds all values that are present in both this set and the given collection.\n * @param {Array<S>|Object<?,S>} col A collection.\n * @return {!goog.structs.Set<T|S>} A new set containing all the values\n *     (primitives or objects) present in both this set and the given\n *     collection.\n * @template S\n */\ngoog.structs.Set.prototype.intersection = function(col) {\n  var result = new goog.structs.Set();\n\n  var values = goog.structs.getValues(col);\n  for (var i = 0; i < values.length; i++) {\n    var value = values[i];\n    if (this.contains(value)) {\n      result.add(value);\n    }\n  }\n\n  return result;\n};\n\n\n/**\n * Finds all values that are present in this set and not in the given\n * collection.\n * @param {Array<T>|goog.structs.Collection<T>|Object<?,T>} col A collection.\n * @return {!goog.structs.Set} A new set containing all the values\n *     (primitives or objects) present in this set but not in the given\n *     collection.\n */\ngoog.structs.Set.prototype.difference = function(col) {\n  var result = this.clone();\n  result.removeAll(col);\n  return result;\n};\n\n\n/**\n * Returns an array containing all the elements in this set.\n * @return {!Array<T>} An array containing all the elements in this set.\n */\ngoog.structs.Set.prototype.getValues = function() {\n  return this.map_.getValues();\n};\n\n\n/**\n * Creates a shallow clone of this set.\n * @return {!goog.structs.Set<T>} A new set containing all the same elements as\n *     this set.\n */\ngoog.structs.Set.prototype.clone = function() {\n  return new goog.structs.Set(this);\n};\n\n\n/**\n * Tests whether the given collection consists of the same elements as this set,\n * regardless of order, without repetition.  Primitives are treated as equal if\n * they have the same type and convert to the same string; objects are treated\n * as equal if they are references to the same object.  This operation is O(n).\n * @param {goog.structs.Collection<T>|Object} col A collection.\n * @return {boolean} True if the given collection consists of the same elements\n *     as this set, regardless of order, without repetition.\n */\ngoog.structs.Set.prototype.equals = function(col) {\n  return this.getCount() == goog.structs.getCount(col) && this.isSubsetOf(col);\n};\n\n\n/**\n * Tests whether the given collection contains all the elements in this set.\n * Primitives are treated as equal if they have the same type and convert to the\n * same string; objects are treated as equal if they are references to the same\n * object.  This operation is O(n).\n * @param {goog.structs.Collection<T>|Object} col A collection.\n * @return {boolean} True if this set is a subset of the given collection.\n */\ngoog.structs.Set.prototype.isSubsetOf = function(col) {\n  var colCount = goog.structs.getCount(col);\n  if (this.getCount() > colCount) {\n    return false;\n  }\n  // TODO(user) Find the minimal collection size where the conversion makes\n  // the contains() method faster.\n  if (!(col instanceof goog.structs.Set) && colCount > 5) {\n    // Convert to a goog.structs.Set so that goog.structs.contains runs in\n    // O(1) time instead of O(n) time.\n    col = new goog.structs.Set(col);\n  }\n  return goog.structs.every(\n      this, function(value) { return goog.structs.contains(col, value); });\n};\n\n\n/**\n * Returns an iterator that iterates over the elements in this set.\n * @param {boolean=} opt_keys This argument is ignored.\n * @return {!goog.iter.Iterator} An iterator over the elements in this set.\n */\ngoog.structs.Set.prototype.__iterator__ = function(opt_keys) {\n  return this.map_.__iterator__(false);\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Logging and debugging utilities.\n *\n * @see ../demos/debug.html\n */\n\ngoog.provide('goog.debug');\n\ngoog.require('goog.array');\ngoog.require('goog.html.SafeHtml');\ngoog.require('goog.html.SafeUrl');\ngoog.require('goog.html.uncheckedconversions');\ngoog.require('goog.string.Const');\ngoog.require('goog.structs.Set');\ngoog.require('goog.userAgent');\n\n\n/** @define {boolean} Whether logging should be enabled. */\ngoog.define('goog.debug.LOGGING_ENABLED', goog.DEBUG);\n\n\n/** @define {boolean} Whether to force \"sloppy\" stack building. */\ngoog.define('goog.debug.FORCE_SLOPPY_STACKS', false);\n\n\n/**\n * Catches onerror events fired by windows and similar objects.\n * @param {function(Object)} logFunc The function to call with the error\n *    information.\n * @param {boolean=} opt_cancel Whether to stop the error from reaching the\n *    browser.\n * @param {Object=} opt_target Object that fires onerror events.\n */\ngoog.debug.catchErrors = function(logFunc, opt_cancel, opt_target) {\n  var target = opt_target || goog.global;\n  var oldErrorHandler = target.onerror;\n  var retVal = !!opt_cancel;\n\n  // Chrome interprets onerror return value backwards (http://crbug.com/92062)\n  // until it was fixed in webkit revision r94061 (Webkit 535.3). This\n  // workaround still needs to be skipped in Safari after the webkit change\n  // gets pushed out in Safari.\n  // See https://bugs.webkit.org/show_bug.cgi?id=67119\n  if (goog.userAgent.WEBKIT && !goog.userAgent.isVersionOrHigher('535.3')) {\n    retVal = !retVal;\n  }\n\n  /**\n   * New onerror handler for this target. This onerror handler follows the spec\n   * according to\n   * http://www.whatwg.org/specs/web-apps/current-work/#runtime-script-errors\n   * The spec was changed in August 2013 to support receiving column information\n   * and an error object for all scripts on the same origin or cross origin\n   * scripts with the proper headers. See\n   * https://mikewest.org/2013/08/debugging-runtime-errors-with-window-onerror\n   *\n   * @param {string} message The error message. For cross-origin errors, this\n   *     will be scrubbed to just \"Script error.\". For new browsers that have\n   *     updated to follow the latest spec, errors that come from origins that\n   *     have proper cross origin headers will not be scrubbed.\n   * @param {string} url The URL of the script that caused the error. The URL\n   *     will be scrubbed to \"\" for cross origin scripts unless the script has\n   *     proper cross origin headers and the browser has updated to the latest\n   *     spec.\n   * @param {number} line The line number in the script that the error\n   *     occurred on.\n   * @param {number=} opt_col The optional column number that the error\n   *     occurred on. Only browsers that have updated to the latest spec will\n   *     include this.\n   * @param {Error=} opt_error The optional actual error object for this\n   *     error that should include the stack. Only browsers that have updated\n   *     to the latest spec will inlude this parameter.\n   * @return {boolean} Whether to prevent the error from reaching the browser.\n   */\n  target.onerror = function(message, url, line, opt_col, opt_error) {\n    if (oldErrorHandler) {\n      oldErrorHandler(message, url, line, opt_col, opt_error);\n    }\n    logFunc({\n      message: message,\n      fileName: url,\n      line: line,\n      col: opt_col,\n      error: opt_error\n    });\n    return retVal;\n  };\n};\n\n\n/**\n * Creates a string representing an object and all its properties.\n * @param {Object|null|undefined} obj Object to expose.\n * @param {boolean=} opt_showFn Show the functions as well as the properties,\n *     default is false.\n * @return {string} The string representation of {@code obj}.\n */\ngoog.debug.expose = function(obj, opt_showFn) {\n  if (typeof obj == 'undefined') {\n    return 'undefined';\n  }\n  if (obj == null) {\n    return 'NULL';\n  }\n  var str = [];\n\n  for (var x in obj) {\n    if (!opt_showFn && goog.isFunction(obj[x])) {\n      continue;\n    }\n    var s = x + ' = ';\n    /** @preserveTry */\n    try {\n      s += obj[x];\n    } catch (e) {\n      s += '*** ' + e + ' ***';\n    }\n    str.push(s);\n  }\n  return str.join('\\n');\n};\n\n\n/**\n * Creates a string representing a given primitive or object, and for an\n * object, all its properties and nested objects.  WARNING: If an object is\n * given, it and all its nested objects will be modified.  To detect reference\n * cycles, this method identifies objects using goog.getUid() which mutates the\n * object.\n * @param {*} obj Object to expose.\n * @param {boolean=} opt_showFn Also show properties that are functions (by\n *     default, functions are omitted).\n * @return {string} A string representation of {@code obj}.\n */\ngoog.debug.deepExpose = function(obj, opt_showFn) {\n  var str = [];\n\n  var helper = function(obj, space, parentSeen) {\n    var nestspace = space + '  ';\n    var seen = new goog.structs.Set(parentSeen);\n\n    var indentMultiline = function(str) {\n      return str.replace(/\\n/g, '\\n' + space);\n    };\n\n    /** @preserveTry */\n    try {\n      if (!goog.isDef(obj)) {\n        str.push('undefined');\n      } else if (goog.isNull(obj)) {\n        str.push('NULL');\n      } else if (goog.isString(obj)) {\n        str.push('\"' + indentMultiline(obj) + '\"');\n      } else if (goog.isFunction(obj)) {\n        str.push(indentMultiline(String(obj)));\n      } else if (goog.isObject(obj)) {\n        if (seen.contains(obj)) {\n          str.push('*** reference loop detected ***');\n        } else {\n          seen.add(obj);\n          str.push('{');\n          for (var x in obj) {\n            if (!opt_showFn && goog.isFunction(obj[x])) {\n              continue;\n            }\n            str.push('\\n');\n            str.push(nestspace);\n            str.push(x + ' = ');\n            helper(obj[x], nestspace, seen);\n          }\n          str.push('\\n' + space + '}');\n        }\n      } else {\n        str.push(obj);\n      }\n    } catch (e) {\n      str.push('*** ' + e + ' ***');\n    }\n  };\n\n  helper(obj, '', new goog.structs.Set());\n  return str.join('');\n};\n\n\n/**\n * Recursively outputs a nested array as a string.\n * @param {Array<?>} arr The array.\n * @return {string} String representing nested array.\n */\ngoog.debug.exposeArray = function(arr) {\n  var str = [];\n  for (var i = 0; i < arr.length; i++) {\n    if (goog.isArray(arr[i])) {\n      str.push(goog.debug.exposeArray(arr[i]));\n    } else {\n      str.push(arr[i]);\n    }\n  }\n  return '[ ' + str.join(', ') + ' ]';\n};\n\n\n/**\n * Exposes an exception that has been caught by a try...catch and outputs the\n * error as HTML with a stack trace.\n * @param {Object} err Error object or string.\n * @param {Function=} opt_fn Optional function to start stack trace from.\n * @return {string} Details of exception, as HTML.\n */\ngoog.debug.exposeException = function(err, opt_fn) {\n  var html = goog.debug.exposeExceptionAsHtml(err, opt_fn);\n  return goog.html.SafeHtml.unwrap(html);\n};\n\n\n/**\n * Exposes an exception that has been caught by a try...catch and outputs the\n * error with a stack trace.\n * @param {Object} err Error object or string.\n * @param {Function=} opt_fn Optional function to start stack trace from.\n * @return {!goog.html.SafeHtml} Details of exception.\n */\ngoog.debug.exposeExceptionAsHtml = function(err, opt_fn) {\n  /** @preserveTry */\n  try {\n    var e = goog.debug.normalizeErrorObject(err);\n    // Create the error message\n    var viewSourceUrl = goog.debug.createViewSourceUrl_(e.fileName);\n    var error = goog.html.SafeHtml.concat(\n        goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces(\n            'Message: ' + e.message + '\\nUrl: '),\n        goog.html.SafeHtml.create(\n            'a', {href: viewSourceUrl, target: '_new'}, e.fileName),\n        goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces(\n            '\\nLine: ' + e.lineNumber + '\\n\\nBrowser stack:\\n' + e.stack +\n            '-> ' +\n            '[end]\\n\\nJS stack traversal:\\n' +\n            goog.debug.getStacktrace(opt_fn) + '-> '));\n    return error;\n  } catch (e2) {\n    return goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces(\n        'Exception trying to expose exception! You win, we lose. ' + e2);\n  }\n};\n\n\n/**\n * @param {?string=} opt_fileName\n * @return {!goog.html.SafeUrl} SafeUrl with view-source scheme, pointing at\n *     fileName.\n * @private\n */\ngoog.debug.createViewSourceUrl_ = function(opt_fileName) {\n  if (!goog.isDefAndNotNull(opt_fileName)) {\n    opt_fileName = '';\n  }\n  if (!/^https?:\\/\\//i.test(opt_fileName)) {\n    return goog.html.SafeUrl.fromConstant(\n        goog.string.Const.from('sanitizedviewsrc'));\n  }\n  var sanitizedFileName = goog.html.SafeUrl.sanitize(opt_fileName);\n  return goog.html.uncheckedconversions\n      .safeUrlFromStringKnownToSatisfyTypeContract(\n          goog.string.Const.from('view-source scheme plus HTTP/HTTPS URL'),\n          'view-source:' + goog.html.SafeUrl.unwrap(sanitizedFileName));\n};\n\n\n/**\n * Normalizes the error/exception object between browsers.\n * @param {Object} err Raw error object.\n * @return {!{\n *    message: (?|undefined),\n *    name: (?|undefined),\n *    lineNumber: (?|undefined),\n *    fileName: (?|undefined),\n *    stack: (?|undefined)\n * }} Normalized error object.\n */\ngoog.debug.normalizeErrorObject = function(err) {\n  var href = goog.getObjectByName('window.location.href');\n  if (goog.isString(err)) {\n    return {\n      'message': err,\n      'name': 'Unknown error',\n      'lineNumber': 'Not available',\n      'fileName': href,\n      'stack': 'Not available'\n    };\n  }\n\n  var lineNumber, fileName;\n  var threwError = false;\n\n  try {\n    lineNumber = err.lineNumber || err.line || 'Not available';\n  } catch (e) {\n    // Firefox 2 sometimes throws an error when accessing 'lineNumber':\n    // Message: Permission denied to get property UnnamedClass.lineNumber\n    lineNumber = 'Not available';\n    threwError = true;\n  }\n\n  try {\n    fileName = err.fileName || err.filename || err.sourceURL ||\n        // $googDebugFname may be set before a call to eval to set the filename\n        // that the eval is supposed to present.\n        goog.global['$googDebugFname'] || href;\n  } catch (e) {\n    // Firefox 2 may also throw an error when accessing 'filename'.\n    fileName = 'Not available';\n    threwError = true;\n  }\n\n  // The IE Error object contains only the name and the message.\n  // The Safari Error object uses the line and sourceURL fields.\n  if (threwError || !err.lineNumber || !err.fileName || !err.stack ||\n      !err.message || !err.name) {\n    return {\n      'message': err.message || 'Not available',\n      'name': err.name || 'UnknownError',\n      'lineNumber': lineNumber,\n      'fileName': fileName,\n      'stack': err.stack || 'Not available'\n    };\n  }\n\n  // Standards error object\n  // Typed !Object. Should be a subtype of the return type, but it's not.\n  return /** @type {?} */ (err);\n};\n\n\n/**\n * Converts an object to an Error using the object's toString if it's not\n * already an Error, adds a stacktrace if there isn't one, and optionally adds\n * an extra message.\n * @param {*} err The original thrown error, object, or string.\n * @param {string=} opt_message  optional additional message to add to the\n *     error.\n * @return {!Error} If err is an Error, it is enhanced and returned. Otherwise,\n *     it is converted to an Error which is enhanced and returned.\n */\ngoog.debug.enhanceError = function(err, opt_message) {\n  var error;\n  if (!(err instanceof Error)) {\n    error = Error(err);\n    if (Error.captureStackTrace) {\n      // Trim this function off the call stack, if we can.\n      Error.captureStackTrace(error, goog.debug.enhanceError);\n    }\n  } else {\n    error = err;\n  }\n\n  if (!error.stack) {\n    error.stack = goog.debug.getStacktrace(goog.debug.enhanceError);\n  }\n  if (opt_message) {\n    // find the first unoccupied 'messageX' property\n    var x = 0;\n    while (error['message' + x]) {\n      ++x;\n    }\n    error['message' + x] = String(opt_message);\n  }\n  return error;\n};\n\n\n/**\n * Gets the current stack trace. Simple and iterative - doesn't worry about\n * catching circular references or getting the args.\n * @param {number=} opt_depth Optional maximum depth to trace back to.\n * @return {string} A string with the function names of all functions in the\n *     stack, separated by \\n.\n * @suppress {es5Strict}\n */\ngoog.debug.getStacktraceSimple = function(opt_depth) {\n  if (!goog.debug.FORCE_SLOPPY_STACKS) {\n    var stack = goog.debug.getNativeStackTrace_(goog.debug.getStacktraceSimple);\n    if (stack) {\n      return stack;\n    }\n    // NOTE: browsers that have strict mode support also have native \"stack\"\n    // properties.  Fall-through for legacy browser support.\n  }\n\n  var sb = [];\n  var fn = arguments.callee.caller;\n  var depth = 0;\n\n  while (fn && (!opt_depth || depth < opt_depth)) {\n    sb.push(goog.debug.getFunctionName(fn));\n    sb.push('()\\n');\n    /** @preserveTry */\n    try {\n      fn = fn.caller;\n    } catch (e) {\n      sb.push('[exception trying to get caller]\\n');\n      break;\n    }\n    depth++;\n    if (depth >= goog.debug.MAX_STACK_DEPTH) {\n      sb.push('[...long stack...]');\n      break;\n    }\n  }\n  if (opt_depth && depth >= opt_depth) {\n    sb.push('[...reached max depth limit...]');\n  } else {\n    sb.push('[end]');\n  }\n\n  return sb.join('');\n};\n\n\n/**\n * Max length of stack to try and output\n * @type {number}\n */\ngoog.debug.MAX_STACK_DEPTH = 50;\n\n\n/**\n * @param {Function} fn The function to start getting the trace from.\n * @return {?string}\n * @private\n */\ngoog.debug.getNativeStackTrace_ = function(fn) {\n  var tempErr = new Error();\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(tempErr, fn);\n    return String(tempErr.stack);\n  } else {\n    // IE10, only adds stack traces when an exception is thrown.\n    try {\n      throw tempErr;\n    } catch (e) {\n      tempErr = e;\n    }\n    var stack = tempErr.stack;\n    if (stack) {\n      return String(stack);\n    }\n  }\n  return null;\n};\n\n\n/**\n * Gets the current stack trace, either starting from the caller or starting\n * from a specified function that's currently on the call stack.\n * @param {Function=} opt_fn Optional function to start getting the trace from.\n *     If not provided, defaults to the function that called this.\n * @return {string} Stack trace.\n * @suppress {es5Strict}\n */\ngoog.debug.getStacktrace = function(opt_fn) {\n  var stack;\n  if (!goog.debug.FORCE_SLOPPY_STACKS) {\n    // Try to get the stack trace from the environment if it is available.\n    var contextFn = opt_fn || goog.debug.getStacktrace;\n    stack = goog.debug.getNativeStackTrace_(contextFn);\n  }\n  if (!stack) {\n    // NOTE: browsers that have strict mode support also have native \"stack\"\n    // properties. This function will throw in strict mode.\n    stack =\n        goog.debug.getStacktraceHelper_(opt_fn || arguments.callee.caller, []);\n  }\n  return stack;\n};\n\n\n/**\n * Private helper for getStacktrace().\n * @param {Function} fn Function to start getting the trace from.\n * @param {Array<!Function>} visited List of functions visited so far.\n * @return {string} Stack trace starting from function fn.\n * @suppress {es5Strict}\n * @private\n */\ngoog.debug.getStacktraceHelper_ = function(fn, visited) {\n  var sb = [];\n\n  // Circular reference, certain functions like bind seem to cause a recursive\n  // loop so we need to catch circular references\n  if (goog.array.contains(visited, fn)) {\n    sb.push('[...circular reference...]');\n\n    // Traverse the call stack until function not found or max depth is reached\n  } else if (fn && visited.length < goog.debug.MAX_STACK_DEPTH) {\n    sb.push(goog.debug.getFunctionName(fn) + '(');\n    var args = fn.arguments;\n    // Args may be null for some special functions such as host objects or eval.\n    for (var i = 0; args && i < args.length; i++) {\n      if (i > 0) {\n        sb.push(', ');\n      }\n      var argDesc;\n      var arg = args[i];\n      switch (typeof arg) {\n        case 'object':\n          argDesc = arg ? 'object' : 'null';\n          break;\n\n        case 'string':\n          argDesc = arg;\n          break;\n\n        case 'number':\n          argDesc = String(arg);\n          break;\n\n        case 'boolean':\n          argDesc = arg ? 'true' : 'false';\n          break;\n\n        case 'function':\n          argDesc = goog.debug.getFunctionName(arg);\n          argDesc = argDesc ? argDesc : '[fn]';\n          break;\n\n        case 'undefined':\n        default:\n          argDesc = typeof arg;\n          break;\n      }\n\n      if (argDesc.length > 40) {\n        argDesc = argDesc.substr(0, 40) + '...';\n      }\n      sb.push(argDesc);\n    }\n    visited.push(fn);\n    sb.push(')\\n');\n    /** @preserveTry */\n    try {\n      sb.push(goog.debug.getStacktraceHelper_(fn.caller, visited));\n    } catch (e) {\n      sb.push('[exception trying to get caller]\\n');\n    }\n\n  } else if (fn) {\n    sb.push('[...long stack...]');\n  } else {\n    sb.push('[end]');\n  }\n  return sb.join('');\n};\n\n\n/**\n * Set a custom function name resolver.\n * @param {function(Function): string} resolver Resolves functions to their\n *     names.\n */\ngoog.debug.setFunctionResolver = function(resolver) {\n  goog.debug.fnNameResolver_ = resolver;\n};\n\n\n/**\n * Gets a function name\n * @param {Function} fn Function to get name of.\n * @return {string} Function's name.\n */\ngoog.debug.getFunctionName = function(fn) {\n  if (goog.debug.fnNameCache_[fn]) {\n    return goog.debug.fnNameCache_[fn];\n  }\n  if (goog.debug.fnNameResolver_) {\n    var name = goog.debug.fnNameResolver_(fn);\n    if (name) {\n      goog.debug.fnNameCache_[fn] = name;\n      return name;\n    }\n  }\n\n  // Heuristically determine function name based on code.\n  var functionSource = String(fn);\n  if (!goog.debug.fnNameCache_[functionSource]) {\n    var matches = /function ([^\\(]+)/.exec(functionSource);\n    if (matches) {\n      var method = matches[1];\n      goog.debug.fnNameCache_[functionSource] = method;\n    } else {\n      goog.debug.fnNameCache_[functionSource] = '[Anonymous]';\n    }\n  }\n\n  return goog.debug.fnNameCache_[functionSource];\n};\n\n\n/**\n * Makes whitespace visible by replacing it with printable characters.\n * This is useful in finding diffrences between the expected and the actual\n * output strings of a testcase.\n * @param {string} string whose whitespace needs to be made visible.\n * @return {string} string whose whitespace is made visible.\n */\ngoog.debug.makeWhitespaceVisible = function(string) {\n  return string.replace(/ /g, '[_]')\n      .replace(/\\f/g, '[f]')\n      .replace(/\\n/g, '[n]\\n')\n      .replace(/\\r/g, '[r]')\n      .replace(/\\t/g, '[t]');\n};\n\n\n/**\n * Returns the type of a value. If a constructor is passed, and a suitable\n * string cannot be found, 'unknown type name' will be returned.\n *\n * <p>Forked rather than moved from {@link goog.asserts.getType_}\n * to avoid adding a dependency to goog.asserts.\n * @param {*} value A constructor, object, or primitive.\n * @return {string} The best display name for the value, or 'unknown type name'.\n */\ngoog.debug.runtimeType = function(value) {\n  if (value instanceof Function) {\n    return value.displayName || value.name || 'unknown type name';\n  } else if (value instanceof Object) {\n    return value.constructor.displayName || value.constructor.name ||\n        Object.prototype.toString.call(value);\n  } else {\n    return value === null ? 'null' : typeof value;\n  }\n};\n\n\n/**\n * Hash map for storing function names that have already been looked up.\n * @type {Object}\n * @private\n */\ngoog.debug.fnNameCache_ = {};\n\n\n/**\n * Resolves functions to their names.  Resolved function names will be cached.\n * @type {function(Function):string}\n * @private\n */\ngoog.debug.fnNameResolver_;\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Definition of the LogRecord class. Please minimize\n * dependencies this file has on other closure classes as any dependency it\n * takes won't be able to use the logging infrastructure.\n *\n */\n\ngoog.provide('goog.debug.LogRecord');\n\n\n\n/**\n * LogRecord objects are used to pass logging requests between\n * the logging framework and individual log Handlers.\n * @constructor\n * @param {goog.debug.Logger.Level} level One of the level identifiers.\n * @param {string} msg The string message.\n * @param {string} loggerName The name of the source logger.\n * @param {number=} opt_time Time this log record was created if other than now.\n *     If 0, we use #goog.now.\n * @param {number=} opt_sequenceNumber Sequence number of this log record. This\n *     should only be passed in when restoring a log record from persistence.\n */\ngoog.debug.LogRecord = function(\n    level, msg, loggerName, opt_time, opt_sequenceNumber) {\n  this.reset(level, msg, loggerName, opt_time, opt_sequenceNumber);\n};\n\n\n/**\n * Time the LogRecord was created.\n * @type {number}\n * @private\n */\ngoog.debug.LogRecord.prototype.time_;\n\n\n/**\n * Level of the LogRecord\n * @type {goog.debug.Logger.Level}\n * @private\n */\ngoog.debug.LogRecord.prototype.level_;\n\n\n/**\n * Message associated with the record\n * @type {string}\n * @private\n */\ngoog.debug.LogRecord.prototype.msg_;\n\n\n/**\n * Name of the logger that created the record.\n * @type {string}\n * @private\n */\ngoog.debug.LogRecord.prototype.loggerName_;\n\n\n/**\n * Sequence number for the LogRecord. Each record has a unique sequence number\n * that is greater than all log records created before it.\n * @type {number}\n * @private\n */\ngoog.debug.LogRecord.prototype.sequenceNumber_ = 0;\n\n\n/**\n * Exception associated with the record\n * @type {Object}\n * @private\n */\ngoog.debug.LogRecord.prototype.exception_ = null;\n\n\n/**\n * @define {boolean} Whether to enable log sequence numbers.\n */\ngoog.define('goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS', true);\n\n\n/**\n * A sequence counter for assigning increasing sequence numbers to LogRecord\n * objects.\n * @type {number}\n * @private\n */\ngoog.debug.LogRecord.nextSequenceNumber_ = 0;\n\n\n/**\n * Sets all fields of the log record.\n * @param {goog.debug.Logger.Level} level One of the level identifiers.\n * @param {string} msg The string message.\n * @param {string} loggerName The name of the source logger.\n * @param {number=} opt_time Time this log record was created if other than now.\n *     If 0, we use #goog.now.\n * @param {number=} opt_sequenceNumber Sequence number of this log record. This\n *     should only be passed in when restoring a log record from persistence.\n */\ngoog.debug.LogRecord.prototype.reset = function(\n    level, msg, loggerName, opt_time, opt_sequenceNumber) {\n  if (goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS) {\n    this.sequenceNumber_ = typeof opt_sequenceNumber == 'number' ?\n        opt_sequenceNumber :\n        goog.debug.LogRecord.nextSequenceNumber_++;\n  }\n\n  this.time_ = opt_time || goog.now();\n  this.level_ = level;\n  this.msg_ = msg;\n  this.loggerName_ = loggerName;\n  delete this.exception_;\n};\n\n\n/**\n * Get the source Logger's name.\n *\n * @return {string} source logger name (may be null).\n */\ngoog.debug.LogRecord.prototype.getLoggerName = function() {\n  return this.loggerName_;\n};\n\n\n/**\n * Get the exception that is part of the log record.\n *\n * @return {Object} the exception.\n */\ngoog.debug.LogRecord.prototype.getException = function() {\n  return this.exception_;\n};\n\n\n/**\n * Set the exception that is part of the log record.\n *\n * @param {Object} exception the exception.\n */\ngoog.debug.LogRecord.prototype.setException = function(exception) {\n  this.exception_ = exception;\n};\n\n\n/**\n * Get the source Logger's name.\n *\n * @param {string} loggerName source logger name (may be null).\n */\ngoog.debug.LogRecord.prototype.setLoggerName = function(loggerName) {\n  this.loggerName_ = loggerName;\n};\n\n\n/**\n * Get the logging message level, for example Level.SEVERE.\n * @return {goog.debug.Logger.Level} the logging message level.\n */\ngoog.debug.LogRecord.prototype.getLevel = function() {\n  return this.level_;\n};\n\n\n/**\n * Set the logging message level, for example Level.SEVERE.\n * @param {goog.debug.Logger.Level} level the logging message level.\n */\ngoog.debug.LogRecord.prototype.setLevel = function(level) {\n  this.level_ = level;\n};\n\n\n/**\n * Get the \"raw\" log message, before localization or formatting.\n *\n * @return {string} the raw message string.\n */\ngoog.debug.LogRecord.prototype.getMessage = function() {\n  return this.msg_;\n};\n\n\n/**\n * Set the \"raw\" log message, before localization or formatting.\n *\n * @param {string} msg the raw message string.\n */\ngoog.debug.LogRecord.prototype.setMessage = function(msg) {\n  this.msg_ = msg;\n};\n\n\n/**\n * Get event time in milliseconds since 1970.\n *\n * @return {number} event time in millis since 1970.\n */\ngoog.debug.LogRecord.prototype.getMillis = function() {\n  return this.time_;\n};\n\n\n/**\n * Set event time in milliseconds since 1970.\n *\n * @param {number} time event time in millis since 1970.\n */\ngoog.debug.LogRecord.prototype.setMillis = function(time) {\n  this.time_ = time;\n};\n\n\n/**\n * Get the sequence number.\n * <p>\n * Sequence numbers are normally assigned in the LogRecord\n * constructor, which assigns unique sequence numbers to\n * each new LogRecord in increasing order.\n * @return {number} the sequence number.\n */\ngoog.debug.LogRecord.prototype.getSequenceNumber = function() {\n  return this.sequenceNumber_;\n};\n","// Copyright 2010 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A buffer for log records. The purpose of this is to improve\n * logging performance by re-using old objects when the buffer becomes full and\n * to eliminate the need for each app to implement their own log buffer. The\n * disadvantage to doing this is that log handlers cannot maintain references to\n * log records and expect that they are not overwriten at a later point.\n *\n * @author agrieve@google.com (Andrew Grieve)\n */\n\ngoog.provide('goog.debug.LogBuffer');\n\ngoog.require('goog.asserts');\ngoog.require('goog.debug.LogRecord');\n\n\n\n/**\n * Creates the log buffer.\n * @constructor\n * @final\n */\ngoog.debug.LogBuffer = function() {\n  goog.asserts.assert(\n      goog.debug.LogBuffer.isBufferingEnabled(),\n      'Cannot use goog.debug.LogBuffer without defining ' +\n          'goog.debug.LogBuffer.CAPACITY.');\n  this.clear();\n};\n\n\n/**\n * A static method that always returns the same instance of LogBuffer.\n * @return {!goog.debug.LogBuffer} The LogBuffer singleton instance.\n */\ngoog.debug.LogBuffer.getInstance = function() {\n  if (!goog.debug.LogBuffer.instance_) {\n    // This function is written with the return statement after the assignment\n    // to avoid the jscompiler StripCode bug described in http://b/2608064.\n    // After that bug is fixed this can be refactored.\n    goog.debug.LogBuffer.instance_ = new goog.debug.LogBuffer();\n  }\n  return goog.debug.LogBuffer.instance_;\n};\n\n\n/**\n * @define {number} The number of log records to buffer. 0 means disable\n * buffering.\n */\ngoog.define('goog.debug.LogBuffer.CAPACITY', 0);\n\n\n/**\n * The array to store the records.\n * @type {!Array<!goog.debug.LogRecord|undefined>}\n * @private\n */\ngoog.debug.LogBuffer.prototype.buffer_;\n\n\n/**\n * The index of the most recently added record or -1 if there are no records.\n * @type {number}\n * @private\n */\ngoog.debug.LogBuffer.prototype.curIndex_;\n\n\n/**\n * Whether the buffer is at capacity.\n * @type {boolean}\n * @private\n */\ngoog.debug.LogBuffer.prototype.isFull_;\n\n\n/**\n * Adds a log record to the buffer, possibly overwriting the oldest record.\n * @param {goog.debug.Logger.Level} level One of the level identifiers.\n * @param {string} msg The string message.\n * @param {string} loggerName The name of the source logger.\n * @return {!goog.debug.LogRecord} The log record.\n */\ngoog.debug.LogBuffer.prototype.addRecord = function(level, msg, loggerName) {\n  var curIndex = (this.curIndex_ + 1) % goog.debug.LogBuffer.CAPACITY;\n  this.curIndex_ = curIndex;\n  if (this.isFull_) {\n    var ret = this.buffer_[curIndex];\n    ret.reset(level, msg, loggerName);\n    return ret;\n  }\n  this.isFull_ = curIndex == goog.debug.LogBuffer.CAPACITY - 1;\n  return this.buffer_[curIndex] =\n             new goog.debug.LogRecord(level, msg, loggerName);\n};\n\n\n/**\n * @return {boolean} Whether the log buffer is enabled.\n */\ngoog.debug.LogBuffer.isBufferingEnabled = function() {\n  return goog.debug.LogBuffer.CAPACITY > 0;\n};\n\n\n/**\n * Removes all buffered log records.\n */\ngoog.debug.LogBuffer.prototype.clear = function() {\n  this.buffer_ = new Array(goog.debug.LogBuffer.CAPACITY);\n  this.curIndex_ = -1;\n  this.isFull_ = false;\n};\n\n\n/**\n * Calls the given function for each buffered log record, starting with the\n * oldest one.\n * @param {function(!goog.debug.LogRecord)} func The function to call.\n */\ngoog.debug.LogBuffer.prototype.forEachRecord = function(func) {\n  var buffer = this.buffer_;\n  // Corner case: no records.\n  if (!buffer[0]) {\n    return;\n  }\n  var curIndex = this.curIndex_;\n  var i = this.isFull_ ? curIndex : -1;\n  do {\n    i = (i + 1) % goog.debug.LogBuffer.CAPACITY;\n    func(/** @type {!goog.debug.LogRecord} */ (buffer[i]));\n  } while (i != curIndex);\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Definition of the Logger class. Please minimize dependencies\n * this file has on other closure classes as any dependency it takes won't be\n * able to use the logging infrastructure.\n *\n * @see ../demos/debug.html\n */\n\ngoog.provide('goog.debug.LogManager');\ngoog.provide('goog.debug.Loggable');\ngoog.provide('goog.debug.Logger');\ngoog.provide('goog.debug.Logger.Level');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.debug');\ngoog.require('goog.debug.LogBuffer');\ngoog.require('goog.debug.LogRecord');\n\n\n/**\n * A message value that can be handled by a Logger.\n *\n * Functions are treated like callbacks, but are only called when the event's\n * log level is enabled. This is useful for logging messages that are expensive\n * to construct.\n *\n * @typedef {string|function(): string}\n */\ngoog.debug.Loggable;\n\n\n\n/**\n * The Logger is an object used for logging debug messages. Loggers are\n * normally named, using a hierarchical dot-separated namespace. Logger names\n * can be arbitrary strings, but they should normally be based on the package\n * name or class name of the logged component, such as goog.net.BrowserChannel.\n *\n * The Logger object is loosely based on the java class\n * java.util.logging.Logger. It supports different levels of filtering for\n * different loggers.\n *\n * The logger object should never be instantiated by application code. It\n * should always use the goog.debug.Logger.getLogger function.\n *\n * @constructor\n * @param {string} name The name of the Logger.\n * @final\n */\ngoog.debug.Logger = function(name) {\n  /**\n   * Name of the Logger. Generally a dot-separated namespace\n   * @private {string}\n   */\n  this.name_ = name;\n\n  /**\n   * Parent Logger.\n   * @private {goog.debug.Logger}\n   */\n  this.parent_ = null;\n\n  /**\n   * Level that this logger only filters above. Null indicates it should\n   * inherit from the parent.\n   * @private {goog.debug.Logger.Level}\n   */\n  this.level_ = null;\n\n  /**\n   * Map of children loggers. The keys are the leaf names of the children and\n   * the values are the child loggers.\n   * @private {Object}\n   */\n  this.children_ = null;\n\n  /**\n   * Handlers that are listening to this logger.\n   * @private {Array<Function>}\n   */\n  this.handlers_ = null;\n};\n\n\n/** @const */\ngoog.debug.Logger.ROOT_LOGGER_NAME = '';\n\n\n/**\n * @define {boolean} Toggles whether loggers other than the root logger can have\n *     log handlers attached to them and whether they can have their log level\n *     set. Logging is a bit faster when this is set to false.\n */\ngoog.define('goog.debug.Logger.ENABLE_HIERARCHY', true);\n\n\nif (!goog.debug.Logger.ENABLE_HIERARCHY) {\n  /**\n   * @type {!Array<Function>}\n   * @private\n   */\n  goog.debug.Logger.rootHandlers_ = [];\n\n\n  /**\n   * @type {goog.debug.Logger.Level}\n   * @private\n   */\n  goog.debug.Logger.rootLevel_;\n}\n\n\n\n/**\n * The Level class defines a set of standard logging levels that\n * can be used to control logging output.  The logging Level objects\n * are ordered and are specified by ordered integers.  Enabling logging\n * at a given level also enables logging at all higher levels.\n * <p>\n * Clients should normally use the predefined Level constants such\n * as Level.SEVERE.\n * <p>\n * The levels in descending order are:\n * <ul>\n * <li>SEVERE (highest value)\n * <li>WARNING\n * <li>INFO\n * <li>CONFIG\n * <li>FINE\n * <li>FINER\n * <li>FINEST  (lowest value)\n * </ul>\n * In addition there is a level OFF that can be used to turn\n * off logging, and a level ALL that can be used to enable\n * logging of all messages.\n *\n * @param {string} name The name of the level.\n * @param {number} value The numeric value of the level.\n * @constructor\n * @final\n */\ngoog.debug.Logger.Level = function(name, value) {\n  /**\n   * The name of the level\n   * @type {string}\n   */\n  this.name = name;\n\n  /**\n   * The numeric value of the level\n   * @type {number}\n   */\n  this.value = value;\n};\n\n\n/**\n * @return {string} String representation of the logger level.\n * @override\n */\ngoog.debug.Logger.Level.prototype.toString = function() {\n  return this.name;\n};\n\n\n/**\n * OFF is a special level that can be used to turn off logging.\n * This level is initialized to <CODE>Infinity</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.OFF = new goog.debug.Logger.Level('OFF', Infinity);\n\n\n/**\n * SHOUT is a message level for extra debugging loudness.\n * This level is initialized to <CODE>1200</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.SHOUT = new goog.debug.Logger.Level('SHOUT', 1200);\n\n\n/**\n * SEVERE is a message level indicating a serious failure.\n * This level is initialized to <CODE>1000</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.SEVERE = new goog.debug.Logger.Level('SEVERE', 1000);\n\n\n/**\n * WARNING is a message level indicating a potential problem.\n * This level is initialized to <CODE>900</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.WARNING = new goog.debug.Logger.Level('WARNING', 900);\n\n\n/**\n * INFO is a message level for informational messages.\n * This level is initialized to <CODE>800</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.INFO = new goog.debug.Logger.Level('INFO', 800);\n\n\n/**\n * CONFIG is a message level for static configuration messages.\n * This level is initialized to <CODE>700</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.CONFIG = new goog.debug.Logger.Level('CONFIG', 700);\n\n\n/**\n * FINE is a message level providing tracing information.\n * This level is initialized to <CODE>500</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.FINE = new goog.debug.Logger.Level('FINE', 500);\n\n\n/**\n * FINER indicates a fairly detailed tracing message.\n * This level is initialized to <CODE>400</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.FINER = new goog.debug.Logger.Level('FINER', 400);\n\n/**\n * FINEST indicates a highly detailed tracing message.\n * This level is initialized to <CODE>300</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\n\ngoog.debug.Logger.Level.FINEST = new goog.debug.Logger.Level('FINEST', 300);\n\n\n/**\n * ALL indicates that all messages should be logged.\n * This level is initialized to <CODE>0</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.ALL = new goog.debug.Logger.Level('ALL', 0);\n\n\n/**\n * The predefined levels.\n * @type {!Array<!goog.debug.Logger.Level>}\n * @final\n */\ngoog.debug.Logger.Level.PREDEFINED_LEVELS = [\n  goog.debug.Logger.Level.OFF, goog.debug.Logger.Level.SHOUT,\n  goog.debug.Logger.Level.SEVERE, goog.debug.Logger.Level.WARNING,\n  goog.debug.Logger.Level.INFO, goog.debug.Logger.Level.CONFIG,\n  goog.debug.Logger.Level.FINE, goog.debug.Logger.Level.FINER,\n  goog.debug.Logger.Level.FINEST, goog.debug.Logger.Level.ALL\n];\n\n\n/**\n * A lookup map used to find the level object based on the name or value of\n * the level object.\n * @type {Object}\n * @private\n */\ngoog.debug.Logger.Level.predefinedLevelsCache_ = null;\n\n\n/**\n * Creates the predefined levels cache and populates it.\n * @private\n */\ngoog.debug.Logger.Level.createPredefinedLevelsCache_ = function() {\n  goog.debug.Logger.Level.predefinedLevelsCache_ = {};\n  for (var i = 0, level; level = goog.debug.Logger.Level.PREDEFINED_LEVELS[i];\n       i++) {\n    goog.debug.Logger.Level.predefinedLevelsCache_[level.value] = level;\n    goog.debug.Logger.Level.predefinedLevelsCache_[level.name] = level;\n  }\n};\n\n\n/**\n * Gets the predefined level with the given name.\n * @param {string} name The name of the level.\n * @return {goog.debug.Logger.Level} The level, or null if none found.\n */\ngoog.debug.Logger.Level.getPredefinedLevel = function(name) {\n  if (!goog.debug.Logger.Level.predefinedLevelsCache_) {\n    goog.debug.Logger.Level.createPredefinedLevelsCache_();\n  }\n\n  return goog.debug.Logger.Level.predefinedLevelsCache_[name] || null;\n};\n\n\n/**\n * Gets the highest predefined level <= #value.\n * @param {number} value Level value.\n * @return {goog.debug.Logger.Level} The level, or null if none found.\n */\ngoog.debug.Logger.Level.getPredefinedLevelByValue = function(value) {\n  if (!goog.debug.Logger.Level.predefinedLevelsCache_) {\n    goog.debug.Logger.Level.createPredefinedLevelsCache_();\n  }\n\n  if (value in /** @type {!Object} */ (\n          goog.debug.Logger.Level.predefinedLevelsCache_)) {\n    return goog.debug.Logger.Level.predefinedLevelsCache_[value];\n  }\n\n  for (var i = 0; i < goog.debug.Logger.Level.PREDEFINED_LEVELS.length; ++i) {\n    var level = goog.debug.Logger.Level.PREDEFINED_LEVELS[i];\n    if (level.value <= value) {\n      return level;\n    }\n  }\n  return null;\n};\n\n\n/**\n * Finds or creates a logger for a named subsystem. If a logger has already been\n * created with the given name it is returned. Otherwise a new logger is\n * created. If a new logger is created its log level will be configured based\n * on the LogManager configuration and it will configured to also send logging\n * output to its parent's handlers. It will be registered in the LogManager\n * global namespace.\n *\n * @param {string} name A name for the logger. This should be a dot-separated\n * name and should normally be based on the package name or class name of the\n * subsystem, such as goog.net.BrowserChannel.\n * @return {!goog.debug.Logger} The named logger.\n * @deprecated use {@link goog.log} instead.\n */\ngoog.debug.Logger.getLogger = function(name) {\n  return goog.debug.LogManager.getLogger(name);\n};\n\n\n/**\n * Logs a message to profiling tools, if available.\n * {@see https://developers.google.com/web-toolkit/speedtracer/logging-api}\n * {@see http://msdn.microsoft.com/en-us/library/dd433074(VS.85).aspx}\n * @param {string} msg The message to log.\n */\ngoog.debug.Logger.logToProfilers = function(msg) {\n  // Using goog.global, as loggers might be used in window-less contexts.\n  if (goog.global['console']) {\n    if (goog.global['console']['timeStamp']) {\n      // Logs a message to Firebug, Web Inspector, SpeedTracer, etc.\n      goog.global['console']['timeStamp'](msg);\n    } else if (goog.global['console']['markTimeline']) {\n      // TODO(user): markTimeline is deprecated. Drop this else clause entirely\n      // after Chrome M14 hits stable.\n      goog.global['console']['markTimeline'](msg);\n    }\n  }\n\n  if (goog.global['msWriteProfilerMark']) {\n    // Logs a message to the Microsoft profiler\n    goog.global['msWriteProfilerMark'](msg);\n  }\n};\n\n\n/**\n * Gets the name of this logger.\n * @return {string} The name of this logger.\n */\ngoog.debug.Logger.prototype.getName = function() {\n  return this.name_;\n};\n\n\n/**\n * Adds a handler to the logger. This doesn't use the event system because\n * we want to be able to add logging to the event system.\n * @param {Function} handler Handler function to add.\n */\ngoog.debug.Logger.prototype.addHandler = function(handler) {\n  if (goog.debug.LOGGING_ENABLED) {\n    if (goog.debug.Logger.ENABLE_HIERARCHY) {\n      if (!this.handlers_) {\n        this.handlers_ = [];\n      }\n      this.handlers_.push(handler);\n    } else {\n      goog.asserts.assert(\n          !this.name_, 'Cannot call addHandler on a non-root logger when ' +\n              'goog.debug.Logger.ENABLE_HIERARCHY is false.');\n      goog.debug.Logger.rootHandlers_.push(handler);\n    }\n  }\n};\n\n\n/**\n * Removes a handler from the logger. This doesn't use the event system because\n * we want to be able to add logging to the event system.\n * @param {Function} handler Handler function to remove.\n * @return {boolean} Whether the handler was removed.\n */\ngoog.debug.Logger.prototype.removeHandler = function(handler) {\n  if (goog.debug.LOGGING_ENABLED) {\n    var handlers = goog.debug.Logger.ENABLE_HIERARCHY ?\n        this.handlers_ :\n        goog.debug.Logger.rootHandlers_;\n    return !!handlers && goog.array.remove(handlers, handler);\n  } else {\n    return false;\n  }\n};\n\n\n/**\n * Returns the parent of this logger.\n * @return {goog.debug.Logger} The parent logger or null if this is the root.\n */\ngoog.debug.Logger.prototype.getParent = function() {\n  return this.parent_;\n};\n\n\n/**\n * Returns the children of this logger as a map of the child name to the logger.\n * @return {!Object} The map where the keys are the child leaf names and the\n *     values are the Logger objects.\n */\ngoog.debug.Logger.prototype.getChildren = function() {\n  if (!this.children_) {\n    this.children_ = {};\n  }\n  return this.children_;\n};\n\n\n/**\n * Set the log level specifying which message levels will be logged by this\n * logger. Message levels lower than this value will be discarded.\n * The level value Level.OFF can be used to turn off logging. If the new level\n * is null, it means that this node should inherit its level from its nearest\n * ancestor with a specific (non-null) level value.\n *\n * @param {goog.debug.Logger.Level} level The new level.\n */\ngoog.debug.Logger.prototype.setLevel = function(level) {\n  if (goog.debug.LOGGING_ENABLED) {\n    if (goog.debug.Logger.ENABLE_HIERARCHY) {\n      this.level_ = level;\n    } else {\n      goog.asserts.assert(\n          !this.name_, 'Cannot call setLevel() on a non-root logger when ' +\n              'goog.debug.Logger.ENABLE_HIERARCHY is false.');\n      goog.debug.Logger.rootLevel_ = level;\n    }\n  }\n};\n\n\n/**\n * Gets the log level specifying which message levels will be logged by this\n * logger. Message levels lower than this value will be discarded.\n * The level value Level.OFF can be used to turn off logging. If the level\n * is null, it means that this node should inherit its level from its nearest\n * ancestor with a specific (non-null) level value.\n *\n * @return {goog.debug.Logger.Level} The level.\n */\ngoog.debug.Logger.prototype.getLevel = function() {\n  return goog.debug.LOGGING_ENABLED ? this.level_ : goog.debug.Logger.Level.OFF;\n};\n\n\n/**\n * Returns the effective level of the logger based on its ancestors' levels.\n * @return {goog.debug.Logger.Level} The level.\n */\ngoog.debug.Logger.prototype.getEffectiveLevel = function() {\n  if (!goog.debug.LOGGING_ENABLED) {\n    return goog.debug.Logger.Level.OFF;\n  }\n\n  if (!goog.debug.Logger.ENABLE_HIERARCHY) {\n    return goog.debug.Logger.rootLevel_;\n  }\n  if (this.level_) {\n    return this.level_;\n  }\n  if (this.parent_) {\n    return this.parent_.getEffectiveLevel();\n  }\n  goog.asserts.fail('Root logger has no level set.');\n  return null;\n};\n\n\n/**\n * Checks if a message of the given level would actually be logged by this\n * logger. This check is based on the Loggers effective level, which may be\n * inherited from its parent.\n * @param {goog.debug.Logger.Level} level The level to check.\n * @return {boolean} Whether the message would be logged.\n */\ngoog.debug.Logger.prototype.isLoggable = function(level) {\n  return goog.debug.LOGGING_ENABLED &&\n      level.value >= this.getEffectiveLevel().value;\n};\n\n\n/**\n * Logs a message. If the logger is currently enabled for the\n * given message level then the given message is forwarded to all the\n * registered output Handler objects.\n * @param {goog.debug.Logger.Level} level One of the level identifiers.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error|Object=} opt_exception An exception associated with the\n *     message.\n */\ngoog.debug.Logger.prototype.log = function(level, msg, opt_exception) {\n  // java caches the effective level, not sure it's necessary here\n  if (goog.debug.LOGGING_ENABLED && this.isLoggable(level)) {\n    // Message callbacks can be useful when a log message is expensive to build.\n    if (goog.isFunction(msg)) {\n      msg = msg();\n    }\n\n    this.doLogRecord_(this.getLogRecord(level, msg, opt_exception));\n  }\n};\n\n\n/**\n * Creates a new log record and adds the exception (if present) to it.\n * @param {goog.debug.Logger.Level} level One of the level identifiers.\n * @param {string} msg The string message.\n * @param {Error|Object=} opt_exception An exception associated with the\n *     message.\n * @return {!goog.debug.LogRecord} A log record.\n * @suppress {es5Strict}\n */\ngoog.debug.Logger.prototype.getLogRecord = function(level, msg, opt_exception) {\n  if (goog.debug.LogBuffer.isBufferingEnabled()) {\n    var logRecord =\n        goog.debug.LogBuffer.getInstance().addRecord(level, msg, this.name_);\n  } else {\n    logRecord = new goog.debug.LogRecord(level, String(msg), this.name_);\n  }\n  if (opt_exception) {\n    logRecord.setException(opt_exception);\n  }\n  return logRecord;\n};\n\n\n/**\n * Logs a message at the Logger.Level.SHOUT level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.shout = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.SHOUT, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.SEVERE level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.severe = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.SEVERE, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.WARNING level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.warning = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.WARNING, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.INFO level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.info = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.INFO, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.CONFIG level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.config = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.CONFIG, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.FINE level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.fine = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.FINE, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.FINER level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.finer = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.FINER, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.FINEST level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.finest = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.FINEST, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a LogRecord. If the logger is currently enabled for the\n * given message level then the given message is forwarded to all the\n * registered output Handler objects.\n * @param {goog.debug.LogRecord} logRecord A log record to log.\n */\ngoog.debug.Logger.prototype.logRecord = function(logRecord) {\n  if (goog.debug.LOGGING_ENABLED && this.isLoggable(logRecord.getLevel())) {\n    this.doLogRecord_(logRecord);\n  }\n};\n\n\n/**\n * Logs a LogRecord.\n * @param {goog.debug.LogRecord} logRecord A log record to log.\n * @private\n */\ngoog.debug.Logger.prototype.doLogRecord_ = function(logRecord) {\n  goog.debug.Logger.logToProfilers('log:' + logRecord.getMessage());\n  if (goog.debug.Logger.ENABLE_HIERARCHY) {\n    var target = this;\n    while (target) {\n      target.callPublish_(logRecord);\n      target = target.getParent();\n    }\n  } else {\n    for (var i = 0, handler; handler = goog.debug.Logger.rootHandlers_[i++];) {\n      handler(logRecord);\n    }\n  }\n};\n\n\n/**\n * Calls the handlers for publish.\n * @param {goog.debug.LogRecord} logRecord The log record to publish.\n * @private\n */\ngoog.debug.Logger.prototype.callPublish_ = function(logRecord) {\n  if (this.handlers_) {\n    for (var i = 0, handler; handler = this.handlers_[i]; i++) {\n      handler(logRecord);\n    }\n  }\n};\n\n\n/**\n * Sets the parent of this logger. This is used for setting up the logger tree.\n * @param {goog.debug.Logger} parent The parent logger.\n * @private\n */\ngoog.debug.Logger.prototype.setParent_ = function(parent) {\n  this.parent_ = parent;\n};\n\n\n/**\n * Adds a child to this logger. This is used for setting up the logger tree.\n * @param {string} name The leaf name of the child.\n * @param {goog.debug.Logger} logger The child logger.\n * @private\n */\ngoog.debug.Logger.prototype.addChild_ = function(name, logger) {\n  this.getChildren()[name] = logger;\n};\n\n\n/**\n * There is a single global LogManager object that is used to maintain a set of\n * shared state about Loggers and log services. This is loosely based on the\n * java class java.util.logging.LogManager.\n * @const\n */\ngoog.debug.LogManager = {};\n\n\n/**\n * Map of logger names to logger objects.\n *\n * @type {!Object<string, !goog.debug.Logger>}\n * @private\n */\ngoog.debug.LogManager.loggers_ = {};\n\n\n/**\n * The root logger which is the root of the logger tree.\n * @type {goog.debug.Logger}\n * @private\n */\ngoog.debug.LogManager.rootLogger_ = null;\n\n\n/**\n * Initializes the LogManager if not already initialized.\n */\ngoog.debug.LogManager.initialize = function() {\n  if (!goog.debug.LogManager.rootLogger_) {\n    goog.debug.LogManager.rootLogger_ =\n        new goog.debug.Logger(goog.debug.Logger.ROOT_LOGGER_NAME);\n    goog.debug.LogManager.loggers_[goog.debug.Logger.ROOT_LOGGER_NAME] =\n        goog.debug.LogManager.rootLogger_;\n    goog.debug.LogManager.rootLogger_.setLevel(goog.debug.Logger.Level.CONFIG);\n  }\n};\n\n\n/**\n * Returns all the loggers.\n * @return {!Object<string, !goog.debug.Logger>} Map of logger names to logger\n *     objects.\n */\ngoog.debug.LogManager.getLoggers = function() {\n  return goog.debug.LogManager.loggers_;\n};\n\n\n/**\n * Returns the root of the logger tree namespace, the logger with the empty\n * string as its name.\n *\n * @return {!goog.debug.Logger} The root logger.\n */\ngoog.debug.LogManager.getRoot = function() {\n  goog.debug.LogManager.initialize();\n  return /** @type {!goog.debug.Logger} */ (goog.debug.LogManager.rootLogger_);\n};\n\n\n/**\n * Finds a named logger.\n *\n * @param {string} name A name for the logger. This should be a dot-separated\n * name and should normally be based on the package name or class name of the\n * subsystem, such as goog.net.BrowserChannel.\n * @return {!goog.debug.Logger} The named logger.\n */\ngoog.debug.LogManager.getLogger = function(name) {\n  goog.debug.LogManager.initialize();\n  var ret = goog.debug.LogManager.loggers_[name];\n  return ret || goog.debug.LogManager.createLogger_(name);\n};\n\n\n/**\n * Creates a function that can be passed to goog.debug.catchErrors. The function\n * will log all reported errors using the given logger.\n * @param {goog.debug.Logger=} opt_logger The logger to log the errors to.\n *     Defaults to the root logger.\n * @return {function(Object)} The created function.\n */\ngoog.debug.LogManager.createFunctionForCatchErrors = function(opt_logger) {\n  return function(info) {\n    var logger = opt_logger || goog.debug.LogManager.getRoot();\n    logger.severe(\n        'Error: ' + info.message + ' (' + info.fileName + ' @ Line: ' +\n        info.line + ')');\n  };\n};\n\n\n/**\n * Creates the named logger. Will also create the parents of the named logger\n * if they don't yet exist.\n * @param {string} name The name of the logger.\n * @return {!goog.debug.Logger} The named logger.\n * @private\n */\ngoog.debug.LogManager.createLogger_ = function(name) {\n  // find parent logger\n  var logger = new goog.debug.Logger(name);\n  if (goog.debug.Logger.ENABLE_HIERARCHY) {\n    var lastDotIndex = name.lastIndexOf('.');\n    var parentName = name.substr(0, lastDotIndex);\n    var leafName = name.substr(lastDotIndex + 1);\n    var parentLogger = goog.debug.LogManager.getLogger(parentName);\n\n    // tell the parent about the child and the child about the parent\n    parentLogger.addChild_(leafName, logger);\n    logger.setParent_(parentLogger);\n  }\n\n  goog.debug.LogManager.loggers_[name] = logger;\n  return logger;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Basic strippable logging definitions.\n * @see http://go/closurelogging\n *\n * @author johnlenz@google.com (John Lenz)\n */\n\ngoog.provide('goog.log');\ngoog.provide('goog.log.Level');\ngoog.provide('goog.log.LogRecord');\ngoog.provide('goog.log.Logger');\n\ngoog.require('goog.debug');\ngoog.require('goog.debug.LogManager');\ngoog.require('goog.debug.LogRecord');\ngoog.require('goog.debug.Logger');\n\n\n/** @define {boolean} Whether logging is enabled. */\ngoog.define('goog.log.ENABLED', goog.debug.LOGGING_ENABLED);\n\n\n/** @const {string} */\ngoog.log.ROOT_LOGGER_NAME = goog.debug.Logger.ROOT_LOGGER_NAME;\n\n\n\n/**\n * @constructor\n * @final\n */\ngoog.log.Logger = goog.debug.Logger;\n\n\n\n/**\n * @constructor\n * @final\n */\ngoog.log.Level = goog.debug.Logger.Level;\n\n\n\n/**\n * @constructor\n * @final\n */\ngoog.log.LogRecord = goog.debug.LogRecord;\n\n\n/**\n * Finds or creates a logger for a named subsystem. If a logger has already been\n * created with the given name it is returned. Otherwise a new logger is\n * created. If a new logger is created its log level will be configured based\n * on the goog.debug.LogManager configuration and it will configured to also\n * send logging output to its parent's handlers.\n * @see goog.debug.LogManager\n *\n * @param {string} name A name for the logger. This should be a dot-separated\n *     name and should normally be based on the package name or class name of\n *     the subsystem, such as goog.net.BrowserChannel.\n * @param {goog.log.Level=} opt_level If provided, override the\n *     default logging level with the provided level.\n * @return {goog.log.Logger} The named logger or null if logging is disabled.\n */\ngoog.log.getLogger = function(name, opt_level) {\n  if (goog.log.ENABLED) {\n    var logger = goog.debug.LogManager.getLogger(name);\n    if (opt_level && logger) {\n      logger.setLevel(opt_level);\n    }\n    return logger;\n  } else {\n    return null;\n  }\n};\n\n\n// TODO(johnlenz): try to tighten the types to these functions.\n/**\n * Adds a handler to the logger. This doesn't use the event system because\n * we want to be able to add logging to the event system.\n * @param {goog.log.Logger} logger\n * @param {Function} handler Handler function to add.\n */\ngoog.log.addHandler = function(logger, handler) {\n  if (goog.log.ENABLED && logger) {\n    logger.addHandler(handler);\n  }\n};\n\n\n/**\n * Removes a handler from the logger. This doesn't use the event system because\n * we want to be able to add logging to the event system.\n * @param {goog.log.Logger} logger\n * @param {Function} handler Handler function to remove.\n * @return {boolean} Whether the handler was removed.\n */\ngoog.log.removeHandler = function(logger, handler) {\n  if (goog.log.ENABLED && logger) {\n    return logger.removeHandler(handler);\n  } else {\n    return false;\n  }\n};\n\n\n/**\n * Logs a message. If the logger is currently enabled for the\n * given message level then the given message is forwarded to all the\n * registered output Handler objects.\n * @param {goog.log.Logger} logger\n * @param {goog.log.Level} level One of the level identifiers.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error|Object=} opt_exception An exception associated with the\n *     message.\n */\ngoog.log.log = function(logger, level, msg, opt_exception) {\n  if (goog.log.ENABLED && logger) {\n    logger.log(level, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Level.SEVERE level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.log.Logger} logger\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.log.error = function(logger, msg, opt_exception) {\n  if (goog.log.ENABLED && logger) {\n    logger.severe(msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Level.WARNING level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.log.Logger} logger\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.log.warning = function(logger, msg, opt_exception) {\n  if (goog.log.ENABLED && logger) {\n    logger.warning(msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Level.INFO level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.log.Logger} logger\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.log.info = function(logger, msg, opt_exception) {\n  if (goog.log.ENABLED && logger) {\n    logger.info(msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Level.Fine level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.log.Logger} logger\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.log.fine = function(logger, msg, opt_exception) {\n  if (goog.log.ENABLED && logger) {\n    logger.fine(msg, opt_exception);\n  }\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\ngoog.provide('goog.Thenable');\n\n\n\n/**\n * Provides a more strict interface for Thenables in terms of\n * http://promisesaplus.com for interop with {@see goog.Promise}.\n *\n * @interface\n * @extends {IThenable<TYPE>}\n * @template TYPE\n */\ngoog.Thenable = function() {};\n\n\n/**\n * Adds callbacks that will operate on the result of the Thenable, returning a\n * new child Promise.\n *\n * If the Thenable is fulfilled, the {@code onFulfilled} callback will be\n * invoked with the fulfillment value as argument, and the child Promise will\n * be fulfilled with the return value of the callback. If the callback throws\n * an exception, the child Promise will be rejected with the thrown value\n * instead.\n *\n * If the Thenable is rejected, the {@code onRejected} callback will be invoked\n * with the rejection reason as argument, and the child Promise will be rejected\n * with the return value of the callback or thrown value.\n *\n * @param {?(function(this:THIS, TYPE): VALUE)=} opt_onFulfilled A\n *     function that will be invoked with the fulfillment value if the Promise\n *     is fulfilled.\n * @param {?(function(this:THIS, *): *)=} opt_onRejected A function that will\n *     be invoked with the rejection reason if the Promise is rejected.\n * @param {THIS=} opt_context An optional context object that will be the\n *     execution context for the callbacks. By default, functions are executed\n *     with the default this.\n *\n * @return {RESULT} A new Promise that will receive the result\n *     of the fulfillment or rejection callback.\n * @template VALUE\n * @template THIS\n *\n * When a Promise (or thenable) is returned from the fulfilled callback,\n * the result is the payload of that promise, not the promise itself.\n *\n * @template RESULT := type('goog.Promise',\n *     cond(isUnknown(VALUE), unknown(),\n *       mapunion(VALUE, (V) =>\n *         cond(isTemplatized(V) && sub(rawTypeOf(V), 'IThenable'),\n *           templateTypeOf(V, 0),\n *           cond(sub(V, 'Thenable'),\n *              unknown(),\n *              V)))))\n *  =:\n *\n */\ngoog.Thenable.prototype.then = function(\n    opt_onFulfilled, opt_onRejected, opt_context) {};\n\n\n/**\n * An expando property to indicate that an object implements\n * {@code goog.Thenable}.\n *\n * {@see addImplementation}.\n *\n * @const\n */\ngoog.Thenable.IMPLEMENTED_BY_PROP = '$goog_Thenable';\n\n\n/**\n * Marks a given class (constructor) as an implementation of Thenable, so\n * that we can query that fact at runtime. The class must have already\n * implemented the interface.\n * Exports a 'then' method on the constructor prototype, so that the objects\n * also implement the extern {@see goog.Thenable} interface for interop with\n * other Promise implementations.\n * @param {function(new:goog.Thenable,...?)} ctor The class constructor. The\n *     corresponding class must have already implemented the interface.\n */\ngoog.Thenable.addImplementation = function(ctor) {\n  // Use bracket notation instead of goog.exportSymbol() so that the compiler\n  // won't create a 'var ctor;' extern when the \"create externs from exports\"\n  // mode is enabled.\n  ctor.prototype['then'] = ctor.prototype.then;\n  if (COMPILED) {\n    ctor.prototype[goog.Thenable.IMPLEMENTED_BY_PROP] = true;\n  } else {\n    // Avoids dictionary access in uncompiled mode.\n    ctor.prototype.$goog_Thenable = true;\n  }\n};\n\n\n/**\n * @param {?} object\n * @return {boolean} Whether a given instance implements {@code goog.Thenable}.\n *     The class/superclass of the instance must call {@code addImplementation}.\n */\ngoog.Thenable.isImplementedBy = function(object) {\n  if (!object) {\n    return false;\n  }\n  try {\n    if (COMPILED) {\n      return !!object[goog.Thenable.IMPLEMENTED_BY_PROP];\n    }\n    return !!object.$goog_Thenable;\n  } catch (e) {\n    // Property access seems to be forbidden.\n    return false;\n  }\n};\n","// Copyright 2015 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Simple freelist.\n *\n * An anterative to goog.structs.SimplePool, it imposes the requirement that the\n * objects in the list contain a \"next\" property that can be used to maintain\n * the pool.\n */\n\ngoog.provide('goog.async.FreeList');\n\n\n/**\n * @template ITEM\n */\ngoog.async.FreeList = goog.defineClass(null, {\n  /**\n   * @param {function():ITEM} create\n   * @param {function(ITEM):void} reset\n   * @param {number} limit\n   */\n  constructor: function(create, reset, limit) {\n    /** @private @const {number} */\n    this.limit_ = limit;\n    /** @private @const {function()} */\n    this.create_ = create;\n    /** @private @const {function(ITEM):void} */\n    this.reset_ = reset;\n\n    /** @private {number} */\n    this.occupants_ = 0;\n    /** @private {ITEM} */\n    this.head_ = null;\n  },\n\n  /**\n   * @return {ITEM}\n   */\n  get: function() {\n    var item;\n    if (this.occupants_ > 0) {\n      this.occupants_--;\n      item = this.head_;\n      this.head_ = item.next;\n      item.next = null;\n    } else {\n      item = this.create_();\n    }\n    return item;\n  },\n\n  /**\n   * @param {ITEM} item An item available for possible future reuse.\n   */\n  put: function(item) {\n    this.reset_(item);\n    if (this.occupants_ < this.limit_) {\n      this.occupants_++;\n      item.next = this.head_;\n      this.head_ = item;\n    }\n  },\n\n  /**\n   * Visible for testing.\n   * @package\n   * @return {number}\n   */\n  occupants: function() { return this.occupants_; }\n});\n","// Copyright 2015 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\ngoog.provide('goog.async.WorkItem');\ngoog.provide('goog.async.WorkQueue');\n\ngoog.require('goog.asserts');\ngoog.require('goog.async.FreeList');\n\n\n// TODO(johnlenz): generalize the WorkQueue if this is used by more\n// than goog.async.run.\n\n\n\n/**\n * A low GC workqueue. The key elements of this design:\n *   - avoids the need for goog.bind or equivalent by carrying scope\n *   - avoids the need for array reallocation by using a linked list\n *   - minimizes work entry objects allocation by recycling objects\n * @constructor\n * @final\n * @struct\n */\ngoog.async.WorkQueue = function() {\n  this.workHead_ = null;\n  this.workTail_ = null;\n};\n\n\n/** @define {number} The maximum number of entries to keep for recycling. */\ngoog.define('goog.async.WorkQueue.DEFAULT_MAX_UNUSED', 100);\n\n\n/** @const @private {goog.async.FreeList<goog.async.WorkItem>} */\ngoog.async.WorkQueue.freelist_ = new goog.async.FreeList(\n    function() { return new goog.async.WorkItem(); },\n    function(item) { item.reset(); }, goog.async.WorkQueue.DEFAULT_MAX_UNUSED);\n\n\n/**\n * @param {function()} fn\n * @param {Object|null|undefined} scope\n */\ngoog.async.WorkQueue.prototype.add = function(fn, scope) {\n  var item = this.getUnusedItem_();\n  item.set(fn, scope);\n\n  if (this.workTail_) {\n    this.workTail_.next = item;\n    this.workTail_ = item;\n  } else {\n    goog.asserts.assert(!this.workHead_);\n    this.workHead_ = item;\n    this.workTail_ = item;\n  }\n};\n\n\n/**\n * @return {goog.async.WorkItem}\n */\ngoog.async.WorkQueue.prototype.remove = function() {\n  var item = null;\n\n  if (this.workHead_) {\n    item = this.workHead_;\n    this.workHead_ = this.workHead_.next;\n    if (!this.workHead_) {\n      this.workTail_ = null;\n    }\n    item.next = null;\n  }\n  return item;\n};\n\n\n/**\n * @param {goog.async.WorkItem} item\n */\ngoog.async.WorkQueue.prototype.returnUnused = function(item) {\n  goog.async.WorkQueue.freelist_.put(item);\n};\n\n\n/**\n * @return {goog.async.WorkItem}\n * @private\n */\ngoog.async.WorkQueue.prototype.getUnusedItem_ = function() {\n  return goog.async.WorkQueue.freelist_.get();\n};\n\n\n\n/**\n * @constructor\n * @final\n * @struct\n */\ngoog.async.WorkItem = function() {\n  /** @type {?function()} */\n  this.fn = null;\n  /** @type {Object|null|undefined} */\n  this.scope = null;\n  /** @type {?goog.async.WorkItem} */\n  this.next = null;\n};\n\n\n/**\n * @param {function()} fn\n * @param {Object|null|undefined} scope\n */\ngoog.async.WorkItem.prototype.set = function(fn, scope) {\n  this.fn = fn;\n  this.scope = scope;\n  this.next = null;\n};\n\n\n/** Reset the work item so they don't prevent GC before reuse */\ngoog.async.WorkItem.prototype.reset = function() {\n  this.fn = null;\n  this.scope = null;\n  this.next = null;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Provides a function to schedule running a function as soon\n * as possible after the current JS execution stops and yields to the event\n * loop.\n *\n */\n\ngoog.provide('goog.async.nextTick');\ngoog.provide('goog.async.throwException');\n\ngoog.require('goog.debug.entryPointRegistry');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.functions');\ngoog.require('goog.labs.userAgent.browser');\ngoog.require('goog.labs.userAgent.engine');\n\n\n/**\n * Throw an item without interrupting the current execution context.  For\n * example, if processing a group of items in a loop, sometimes it is useful\n * to report an error while still allowing the rest of the batch to be\n * processed.\n * @param {*} exception\n */\ngoog.async.throwException = function(exception) {\n  // Each throw needs to be in its own context.\n  goog.global.setTimeout(function() { throw exception; }, 0);\n};\n\n\n/**\n * Fires the provided callbacks as soon as possible after the current JS\n * execution context. setTimeout(, 0) takes at least 4ms when called from\n * within another setTimeout(, 0) for legacy reasons.\n *\n * This will not schedule the callback as a microtask (i.e. a task that can\n * preempt user input or networking callbacks). It is meant to emulate what\n * setTimeout(_, 0) would do if it were not throttled. If you desire microtask\n * behavior, use {@see goog.Promise} instead.\n *\n * @param {function(this:SCOPE)} callback Callback function to fire as soon as\n *     possible.\n * @param {SCOPE=} opt_context Object in whose scope to call the listener.\n * @param {boolean=} opt_useSetImmediate Avoid the IE workaround that\n *     ensures correctness at the cost of speed. See comments for details.\n * @template SCOPE\n */\ngoog.async.nextTick = function(callback, opt_context, opt_useSetImmediate) {\n  var cb = callback;\n  if (opt_context) {\n    cb = goog.bind(callback, opt_context);\n  }\n  cb = goog.async.nextTick.wrapCallback_(cb);\n  // Note we do allow callers to also request setImmediate if they are willing\n  // to accept the possible tradeoffs of incorrectness in exchange for speed.\n  // The IE fallback of readystate change is much slower. See useSetImmediate_\n  // for details.\n  if (goog.isFunction(goog.global.setImmediate) &&\n      (opt_useSetImmediate || goog.async.nextTick.useSetImmediate_())) {\n    goog.global.setImmediate(cb);\n    return;\n  }\n\n  // Look for and cache the custom fallback version of setImmediate.\n  if (!goog.async.nextTick.setImmediate_) {\n    goog.async.nextTick.setImmediate_ =\n        goog.async.nextTick.getSetImmediateEmulator_();\n  }\n  goog.async.nextTick.setImmediate_(cb);\n};\n\n\n/**\n * Returns whether should use setImmediate implementation currently on window.\n *\n * window.setImmediate was introduced and currently only supported by IE10+,\n * but due to a bug in the implementation it is not guaranteed that\n * setImmediate is faster than setTimeout nor that setImmediate N is before\n * setImmediate N+1. That is why we do not use the native version if\n * available. We do, however, call setImmediate if it is a non-native function\n * because that indicates that it has been replaced by goog.testing.MockClock\n * which we do want to support.\n * See\n * http://connect.microsoft.com/IE/feedback/details/801823/setimmediate-and-messagechannel-are-broken-in-ie10\n *\n * @return {boolean} Whether to use the implementation of setImmediate defined\n *     on Window.\n * @private\n */\ngoog.async.nextTick.useSetImmediate_ = function() {\n  // Not a browser environment.\n  if (!goog.global.Window || !goog.global.Window.prototype) {\n    return true;\n  }\n\n  // MS Edge has window.setImmediate natively, but it's not on Window.prototype.\n  // Also, there's no clean way to detect if the goog.global.setImmediate has\n  // been replaced by mockClock as its replacement also shows up as \"[native\n  // code]\" when using toString. Therefore, just always use\n  // goog.global.setImmediate for Edge. It's unclear if it suffers the same\n  // issues as IE10/11, but based on\n  // https://dev.modern.ie/testdrive/demos/setimmediatesorting/\n  // it seems they've been working to ensure it's WAI.\n  if (goog.labs.userAgent.browser.isEdge() ||\n      goog.global.Window.prototype.setImmediate != goog.global.setImmediate) {\n    // Something redefined setImmediate in which case we decide to use it (This\n    // is so that we use the mockClock setImmediate).\n    return true;\n  }\n\n  return false;\n};\n\n\n/**\n * Cache for the setImmediate implementation.\n * @type {function(function())}\n * @private\n */\ngoog.async.nextTick.setImmediate_;\n\n\n/**\n * Determines the best possible implementation to run a function as soon as\n * the JS event loop is idle.\n * @return {function(function())} The \"setImmediate\" implementation.\n * @private\n */\ngoog.async.nextTick.getSetImmediateEmulator_ = function() {\n  // Create a private message channel and use it to postMessage empty messages\n  // to ourselves.\n  var Channel = goog.global['MessageChannel'];\n  // If MessageChannel is not available and we are in a browser, implement\n  // an iframe based polyfill in browsers that have postMessage and\n  // document.addEventListener. The latter excludes IE8 because it has a\n  // synchronous postMessage implementation.\n  if (typeof Channel === 'undefined' && typeof window !== 'undefined' &&\n      window.postMessage && window.addEventListener &&\n      // Presto (The old pre-blink Opera engine) has problems with iframes\n      // and contentWindow.\n      !goog.labs.userAgent.engine.isPresto()) {\n    /** @constructor */\n    Channel = function() {\n      // Make an empty, invisible iframe.\n      var iframe = /** @type {!HTMLIFrameElement} */ (\n          document.createElement(String(goog.dom.TagName.IFRAME)));\n      iframe.style.display = 'none';\n      iframe.src = '';\n      document.documentElement.appendChild(iframe);\n      var win = iframe.contentWindow;\n      var doc = win.document;\n      doc.open();\n      doc.write('');\n      doc.close();\n      // Do not post anything sensitive over this channel, as the workaround for\n      // pages with file: origin could allow that information to be modified or\n      // intercepted.\n      var message = 'callImmediate' + Math.random();\n      // The same origin policy rejects attempts to postMessage from file: urls\n      // unless the origin is '*'.\n      // TODO(b/16335441): Use '*' origin for data: and other similar protocols.\n      var origin = win.location.protocol == 'file:' ?\n          '*' :\n          win.location.protocol + '//' + win.location.host;\n      var onmessage = goog.bind(function(e) {\n        // Validate origin and message to make sure that this message was\n        // intended for us. If the origin is set to '*' (see above) only the\n        // message needs to match since, for example, '*' != 'file://'. Allowing\n        // the wildcard is ok, as we are not concerned with security here.\n        if ((origin != '*' && e.origin != origin) || e.data != message) {\n          return;\n        }\n        this['port1'].onmessage();\n      }, this);\n      win.addEventListener('message', onmessage, false);\n      this['port1'] = {};\n      this['port2'] = {\n        postMessage: function() { win.postMessage(message, origin); }\n      };\n    };\n  }\n  if (typeof Channel !== 'undefined' && (!goog.labs.userAgent.browser.isIE())) {\n    // Exclude all of IE due to\n    // http://codeforhire.com/2013/09/21/setimmediate-and-messagechannel-broken-on-internet-explorer-10/\n    // which allows starving postMessage with a busy setTimeout loop.\n    // This currently affects IE10 and IE11 which would otherwise be able\n    // to use the postMessage based fallbacks.\n    var channel = new Channel();\n    // Use a fifo linked list to call callbacks in the right order.\n    var head = {};\n    var tail = head;\n    channel['port1'].onmessage = function() {\n      if (goog.isDef(head.next)) {\n        head = head.next;\n        var cb = head.cb;\n        head.cb = null;\n        cb();\n      }\n    };\n    return function(cb) {\n      tail.next = {cb: cb};\n      tail = tail.next;\n      channel['port2'].postMessage(0);\n    };\n  }\n  // Implementation for IE6 to IE10: Script elements fire an asynchronous\n  // onreadystatechange event when inserted into the DOM.\n  if (typeof document !== 'undefined' &&\n      'onreadystatechange' in\n          document.createElement(String(goog.dom.TagName.SCRIPT))) {\n    return function(cb) {\n      var script = document.createElement(String(goog.dom.TagName.SCRIPT));\n      script.onreadystatechange = function() {\n        // Clean up and call the callback.\n        script.onreadystatechange = null;\n        script.parentNode.removeChild(script);\n        script = null;\n        cb();\n        cb = null;\n      };\n      document.documentElement.appendChild(script);\n    };\n  }\n  // Fall back to setTimeout with 0. In browsers this creates a delay of 5ms\n  // or more.\n  // NOTE(user): This fallback is used for IE11.\n  return function(cb) { goog.global.setTimeout(cb, 0); };\n};\n\n\n/**\n * Helper function that is overrided to protect callbacks with entry point\n * monitor if the application monitors entry points.\n * @param {function()} callback Callback function to fire as soon as possible.\n * @return {function()} The wrapped callback.\n * @private\n */\ngoog.async.nextTick.wrapCallback_ = goog.functions.identity;\n\n\n// Register the callback function as an entry point, so that it can be\n// monitored for exception handling, etc. This has to be done in this file\n// since it requires special code to handle all browsers.\ngoog.debug.entryPointRegistry.register(\n    /**\n     * @param {function(!Function): !Function} transformer The transforming\n     *     function.\n     */\n    function(transformer) { goog.async.nextTick.wrapCallback_ = transformer; });\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\ngoog.provide('goog.async.run');\n\ngoog.require('goog.async.WorkQueue');\ngoog.require('goog.async.nextTick');\ngoog.require('goog.async.throwException');\n\n\n/**\n * Fires the provided callback just before the current callstack unwinds, or as\n * soon as possible after the current JS execution context.\n * @param {function(this:THIS)} callback\n * @param {THIS=} opt_context Object to use as the \"this value\" when calling\n *     the provided function.\n * @template THIS\n */\ngoog.async.run = function(callback, opt_context) {\n  if (!goog.async.run.schedule_) {\n    goog.async.run.initializeRunner_();\n  }\n  if (!goog.async.run.workQueueScheduled_) {\n    // Nothing is currently scheduled, schedule it now.\n    goog.async.run.schedule_();\n    goog.async.run.workQueueScheduled_ = true;\n  }\n\n  goog.async.run.workQueue_.add(callback, opt_context);\n};\n\n\n/**\n * Initializes the function to use to process the work queue.\n * @private\n */\ngoog.async.run.initializeRunner_ = function() {\n  // If native Promises are available in the browser, just schedule the callback\n  // on a fulfilled promise, which is specified to be async, but as fast as\n  // possible.  Use goog.global.Promise instead of just Promise because the\n  // relevant externs may be missing, and don't alias it because this could\n  // confuse the compiler into thinking the polyfill is required when it should\n  // be treated as optional.\n  if (String(goog.global.Promise).indexOf('[native code]') != -1) {\n    var promise = goog.global.Promise.resolve(undefined);\n    goog.async.run.schedule_ = function() {\n      promise.then(goog.async.run.processWorkQueue);\n    };\n  } else {\n    goog.async.run.schedule_ = function() {\n      goog.async.nextTick(goog.async.run.processWorkQueue);\n    };\n  }\n};\n\n\n/**\n * Forces goog.async.run to use nextTick instead of Promise.\n *\n * This should only be done in unit tests. It's useful because MockClock\n * replaces nextTick, but not the browser Promise implementation, so it allows\n * Promise-based code to be tested with MockClock.\n *\n * However, we also want to run promises if the MockClock is no longer in\n * control so we schedule a backup \"setTimeout\" to the unmocked timeout if\n * provided.\n *\n * @param {function(function())=} opt_realSetTimeout\n */\ngoog.async.run.forceNextTick = function(opt_realSetTimeout) {\n  goog.async.run.schedule_ = function() {\n    goog.async.nextTick(goog.async.run.processWorkQueue);\n    if (opt_realSetTimeout) {\n      opt_realSetTimeout(goog.async.run.processWorkQueue);\n    }\n  };\n};\n\n\n/**\n * The function used to schedule work asynchronousely.\n * @private {function()}\n */\ngoog.async.run.schedule_;\n\n\n/** @private {boolean} */\ngoog.async.run.workQueueScheduled_ = false;\n\n\n/** @private {!goog.async.WorkQueue} */\ngoog.async.run.workQueue_ = new goog.async.WorkQueue();\n\n\nif (goog.DEBUG) {\n  /**\n   * Reset the work queue. Only available for tests in debug mode.\n   */\n  goog.async.run.resetQueue = function() {\n    goog.async.run.workQueueScheduled_ = false;\n    goog.async.run.workQueue_ = new goog.async.WorkQueue();\n  };\n}\n\n\n/**\n * Run any pending goog.async.run work items. This function is not intended\n * for general use, but for use by entry point handlers to run items ahead of\n * goog.async.nextTick.\n */\ngoog.async.run.processWorkQueue = function() {\n  // NOTE: additional work queue items may be added while processing.\n  var item = null;\n  while (item = goog.async.run.workQueue_.remove()) {\n    try {\n      item.fn.call(item.scope);\n    } catch (e) {\n      goog.async.throwException(e);\n    }\n    goog.async.run.workQueue_.returnUnused(item);\n  }\n\n  // There are no more work items, allow processing to be scheduled again.\n  goog.async.run.workQueueScheduled_ = false;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\ngoog.provide('goog.promise.Resolver');\n\n\n\n/**\n * Resolver interface for promises. The resolver is a convenience interface that\n * bundles the promise and its associated resolve and reject functions together,\n * for cases where the resolver needs to be persisted internally.\n *\n * @interface\n * @template TYPE\n */\ngoog.promise.Resolver = function() {};\n\n\n/**\n * The promise that created this resolver.\n * @type {!goog.Promise<TYPE>}\n */\ngoog.promise.Resolver.prototype.promise;\n\n\n/**\n * Resolves this resolver with the specified value.\n * @type {function((TYPE|goog.Promise<TYPE>|Thenable)=)}\n */\ngoog.promise.Resolver.prototype.resolve;\n\n\n/**\n * Rejects this resolver with the specified reason.\n * @type {function(*=): void}\n */\ngoog.promise.Resolver.prototype.reject;\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\ngoog.provide('goog.Promise');\n\ngoog.require('goog.Thenable');\ngoog.require('goog.asserts');\ngoog.require('goog.async.FreeList');\ngoog.require('goog.async.run');\ngoog.require('goog.async.throwException');\ngoog.require('goog.debug.Error');\ngoog.require('goog.promise.Resolver');\n\n\n\n/**\n * NOTE: This class was created in anticipation of the built-in Promise type\n * being standardized and implemented across browsers. Now that Promise is\n * available in modern browsers, and is automatically polyfilled by the Closure\n * Compiler, by default, most new code should use native {@code Promise}\n * instead of {@code goog.Promise}. However, {@code goog.Promise} has the\n * concept of cancellation which native Promises do not yet have. So code\n * needing cancellation may still want to use {@code goog.Promise}.\n *\n * Promises provide a result that may be resolved asynchronously. A Promise may\n * be resolved by being fulfilled with a fulfillment value, rejected with a\n * rejection reason, or blocked by another Promise. A Promise is said to be\n * settled if it is either fulfilled or rejected. Once settled, the Promise\n * result is immutable.\n *\n * Promises may represent results of any type, including undefined. Rejection\n * reasons are typically Errors, but may also be of any type. Closure Promises\n * allow for optional type annotations that enforce that fulfillment values are\n * of the appropriate types at compile time.\n *\n * The result of a Promise is accessible by calling {@code then} and registering\n * {@code onFulfilled} and {@code onRejected} callbacks. Once the Promise\n * is settled, the relevant callbacks are invoked with the fulfillment value or\n * rejection reason as argument. Callbacks are always invoked in the order they\n * were registered, even when additional {@code then} calls are made from inside\n * another callback. A callback is always run asynchronously sometime after the\n * scope containing the registering {@code then} invocation has returned.\n *\n * If a Promise is resolved with another Promise, the first Promise will block\n * until the second is settled, and then assumes the same result as the second\n * Promise. This allows Promises to depend on the results of other Promises,\n * linking together multiple asynchronous operations.\n *\n * This implementation is compatible with the Promises/A+ specification and\n * passes that specification's conformance test suite. A Closure Promise may be\n * resolved with a Promise instance (or sufficiently compatible Promise-like\n * object) created by other Promise implementations. From the specification,\n * Promise-like objects are known as \"Thenables\".\n *\n * @see http://promisesaplus.com/\n *\n * @param {function(\n *             this:RESOLVER_CONTEXT,\n *             function((TYPE|IThenable<TYPE>|Thenable)=),\n *             function(*=)): void} resolver\n *     Initialization function that is invoked immediately with {@code resolve}\n *     and {@code reject} functions as arguments. The Promise is resolved or\n *     rejected with the first argument passed to either function.\n * @param {RESOLVER_CONTEXT=} opt_context An optional context for executing the\n *     resolver function. If unspecified, the resolver function will be executed\n *     in the default scope.\n * @constructor\n * @struct\n * @final\n * @implements {goog.Thenable<TYPE>}\n * @template TYPE,RESOLVER_CONTEXT\n */\ngoog.Promise = function(resolver, opt_context) {\n  /**\n   * The internal state of this Promise. Either PENDING, FULFILLED, REJECTED, or\n   * BLOCKED.\n   * @private {goog.Promise.State_}\n   */\n  this.state_ = goog.Promise.State_.PENDING;\n\n  /**\n   * The settled result of the Promise. Immutable once set with either a\n   * fulfillment value or rejection reason.\n   * @private {*}\n   */\n  this.result_ = undefined;\n\n  /**\n   * For Promises created by calling {@code then()}, the originating parent.\n   * @private {goog.Promise}\n   */\n  this.parent_ = null;\n\n  /**\n   * The linked list of {@code onFulfilled} and {@code onRejected} callbacks\n   * added to this Promise by calls to {@code then()}.\n   * @private {?goog.Promise.CallbackEntry_}\n   */\n  this.callbackEntries_ = null;\n\n  /**\n   * The tail of the linked list of {@code onFulfilled} and {@code onRejected}\n   * callbacks added to this Promise by calls to {@code then()}.\n   * @private {?goog.Promise.CallbackEntry_}\n   */\n  this.callbackEntriesTail_ = null;\n\n  /**\n   * Whether the Promise is in the queue of Promises to execute.\n   * @private {boolean}\n   */\n  this.executing_ = false;\n\n  if (goog.Promise.UNHANDLED_REJECTION_DELAY > 0) {\n    /**\n     * A timeout ID used when the {@code UNHANDLED_REJECTION_DELAY} is greater\n     * than 0 milliseconds. The ID is set when the Promise is rejected, and\n     * cleared only if an {@code onRejected} callback is invoked for the\n     * Promise (or one of its descendants) before the delay is exceeded.\n     *\n     * If the rejection is not handled before the timeout completes, the\n     * rejection reason is passed to the unhandled rejection handler.\n     * @private {number}\n     */\n    this.unhandledRejectionId_ = 0;\n  } else if (goog.Promise.UNHANDLED_REJECTION_DELAY == 0) {\n    /**\n     * When the {@code UNHANDLED_REJECTION_DELAY} is set to 0 milliseconds, a\n     * boolean that is set if the Promise is rejected, and reset to false if an\n     * {@code onRejected} callback is invoked for the Promise (or one of its\n     * descendants). If the rejection is not handled before the next timestep,\n     * the rejection reason is passed to the unhandled rejection handler.\n     * @private {boolean}\n     */\n    this.hadUnhandledRejection_ = false;\n  }\n\n  if (goog.Promise.LONG_STACK_TRACES) {\n    /**\n     * A list of stack trace frames pointing to the locations where this Promise\n     * was created or had callbacks added to it. Saved to add additional context\n     * to stack traces when an exception is thrown.\n     * @private {!Array<string>}\n     */\n    this.stack_ = [];\n    this.addStackTrace_(new Error('created'));\n\n    /**\n     * Index of the most recently executed stack frame entry.\n     * @private {number}\n     */\n    this.currentStep_ = 0;\n  }\n\n  // As an optimization, we can skip this if resolver is goog.nullFunction.\n  // This value is passed internally when creating a promise which will be\n  // resolved through a more optimized path.\n  if (resolver != goog.nullFunction) {\n    try {\n      var self = this;\n      resolver.call(\n          opt_context,\n          function(value) {\n            self.resolve_(goog.Promise.State_.FULFILLED, value);\n          },\n          function(reason) {\n            if (goog.DEBUG &&\n                !(reason instanceof goog.Promise.CancellationError)) {\n              try {\n                // Promise was rejected. Step up one call frame to see why.\n                if (reason instanceof Error) {\n                  throw reason;\n                } else {\n                  throw new Error('Promise rejected.');\n                }\n              } catch (e) {\n                // Only thrown so browser dev tools can catch rejections of\n                // promises when the option to break on caught exceptions is\n                // activated.\n              }\n            }\n            self.resolve_(goog.Promise.State_.REJECTED, reason);\n          });\n    } catch (e) {\n      this.resolve_(goog.Promise.State_.REJECTED, e);\n    }\n  }\n};\n\n\n/**\n * @define {boolean} Whether traces of {@code then} calls should be included in\n * exceptions thrown\n */\ngoog.define('goog.Promise.LONG_STACK_TRACES', false);\n\n\n/**\n * @define {number} The delay in milliseconds before a rejected Promise's reason\n * is passed to the rejection handler. By default, the rejection handler\n * rethrows the rejection reason so that it appears in the developer console or\n * {@code window.onerror} handler.\n *\n * Rejections are rethrown as quickly as possible by default. A negative value\n * disables rejection handling entirely.\n */\ngoog.define('goog.Promise.UNHANDLED_REJECTION_DELAY', 0);\n\n\n/**\n * The possible internal states for a Promise. These states are not directly\n * observable to external callers.\n * @enum {number}\n * @private\n */\ngoog.Promise.State_ = {\n  /** The Promise is waiting for resolution. */\n  PENDING: 0,\n\n  /** The Promise is blocked waiting for the result of another Thenable. */\n  BLOCKED: 1,\n\n  /** The Promise has been resolved with a fulfillment value. */\n  FULFILLED: 2,\n\n  /** The Promise has been resolved with a rejection reason. */\n  REJECTED: 3\n};\n\n\n\n/**\n * Entries in the callback chain. Each call to {@code then},\n * {@code thenCatch}, or {@code thenAlways} creates an entry containing the\n * functions that may be invoked once the Promise is settled.\n *\n * @private @final @struct @constructor\n */\ngoog.Promise.CallbackEntry_ = function() {\n  /** @type {?goog.Promise} */\n  this.child = null;\n  /** @type {Function} */\n  this.onFulfilled = null;\n  /** @type {Function} */\n  this.onRejected = null;\n  /** @type {?} */\n  this.context = null;\n  /** @type {?goog.Promise.CallbackEntry_} */\n  this.next = null;\n\n  /**\n   * A boolean value to indicate this is a \"thenAlways\" callback entry.\n   * Unlike a normal \"then/thenVoid\" a \"thenAlways doesn't participate\n   * in \"cancel\" considerations but is simply an observer and requires\n   * special handling.\n   * @type {boolean}\n   */\n  this.always = false;\n};\n\n\n/** clear the object prior to reuse */\ngoog.Promise.CallbackEntry_.prototype.reset = function() {\n  this.child = null;\n  this.onFulfilled = null;\n  this.onRejected = null;\n  this.context = null;\n  this.always = false;\n};\n\n\n/**\n * @define {number} The number of currently unused objects to keep around for\n *    reuse.\n */\ngoog.define('goog.Promise.DEFAULT_MAX_UNUSED', 100);\n\n\n/** @const @private {goog.async.FreeList<!goog.Promise.CallbackEntry_>} */\ngoog.Promise.freelist_ = new goog.async.FreeList(\n    function() { return new goog.Promise.CallbackEntry_(); },\n    function(item) { item.reset(); }, goog.Promise.DEFAULT_MAX_UNUSED);\n\n\n/**\n * @param {Function} onFulfilled\n * @param {Function} onRejected\n * @param {?} context\n * @return {!goog.Promise.CallbackEntry_}\n * @private\n */\ngoog.Promise.getCallbackEntry_ = function(onFulfilled, onRejected, context) {\n  var entry = goog.Promise.freelist_.get();\n  entry.onFulfilled = onFulfilled;\n  entry.onRejected = onRejected;\n  entry.context = context;\n  return entry;\n};\n\n\n/**\n * @param {!goog.Promise.CallbackEntry_} entry\n * @private\n */\ngoog.Promise.returnEntry_ = function(entry) {\n  goog.Promise.freelist_.put(entry);\n};\n\n\n// NOTE: this is the same template expression as is used for\n// goog.IThenable.prototype.then\n\n\n/**\n * @param {VALUE=} opt_value\n * @return {RESULT} A new Promise that is immediately resolved\n *     with the given value. If the input value is already a goog.Promise, it\n *     will be returned immediately without creating a new instance.\n * @template VALUE\n * @template RESULT := type('goog.Promise',\n *     cond(isUnknown(VALUE), unknown(),\n *       mapunion(VALUE, (V) =>\n *         cond(isTemplatized(V) && sub(rawTypeOf(V), 'IThenable'),\n *           templateTypeOf(V, 0),\n *           cond(sub(V, 'Thenable'),\n *              unknown(),\n *              V)))))\n * =:\n */\ngoog.Promise.resolve = function(opt_value) {\n  if (opt_value instanceof goog.Promise) {\n    // Avoid creating a new object if we already have a promise object\n    // of the correct type.\n    return opt_value;\n  }\n\n  // Passing goog.nullFunction will cause the constructor to take an optimized\n  // path that skips calling the resolver function.\n  var promise = new goog.Promise(goog.nullFunction);\n  promise.resolve_(goog.Promise.State_.FULFILLED, opt_value);\n  return promise;\n};\n\n\n/**\n * @param {*=} opt_reason\n * @return {!goog.Promise} A new Promise that is immediately rejected with the\n *     given reason.\n */\ngoog.Promise.reject = function(opt_reason) {\n  return new goog.Promise(function(resolve, reject) { reject(opt_reason); });\n};\n\n\n/**\n * This is identical to\n * {@code goog.Promise.resolve(value).then(onFulfilled, onRejected)}, but it\n * avoids creating an unnecessary wrapper Promise when {@code value} is already\n * thenable.\n *\n * @param {?(goog.Thenable<TYPE>|Thenable|TYPE)} value\n * @param {function(TYPE): ?} onFulfilled\n * @param {function(*): *} onRejected\n * @template TYPE\n * @private\n */\ngoog.Promise.resolveThen_ = function(value, onFulfilled, onRejected) {\n  var isThenable =\n      goog.Promise.maybeThen_(value, onFulfilled, onRejected, null);\n  if (!isThenable) {\n    goog.async.run(goog.partial(onFulfilled, value));\n  }\n};\n\n\n/**\n * @param {!Array<?(goog.Promise<TYPE>|goog.Thenable<TYPE>|Thenable|*)>}\n *     promises\n * @return {!goog.Promise<TYPE>} A Promise that receives the result of the\n *     first Promise (or Promise-like) input to settle immediately after it\n *     settles.\n * @template TYPE\n */\ngoog.Promise.race = function(promises) {\n  return new goog.Promise(function(resolve, reject) {\n    if (!promises.length) {\n      resolve(undefined);\n    }\n    for (var i = 0, promise; i < promises.length; i++) {\n      promise = promises[i];\n      goog.Promise.resolveThen_(promise, resolve, reject);\n    }\n  });\n};\n\n\n/**\n * @param {!Array<?(goog.Promise<TYPE>|goog.Thenable<TYPE>|Thenable|*)>}\n *     promises\n * @return {!goog.Promise<!Array<TYPE>>} A Promise that receives a list of\n *     every fulfilled value once every input Promise (or Promise-like) is\n *     successfully fulfilled, or is rejected with the first rejection reason\n *     immediately after it is rejected.\n * @template TYPE\n */\ngoog.Promise.all = function(promises) {\n  return new goog.Promise(function(resolve, reject) {\n    var toFulfill = promises.length;\n    var values = [];\n\n    if (!toFulfill) {\n      resolve(values);\n      return;\n    }\n\n    var onFulfill = function(index, value) {\n      toFulfill--;\n      values[index] = value;\n      if (toFulfill == 0) {\n        resolve(values);\n      }\n    };\n\n    var onReject = function(reason) { reject(reason); };\n\n    for (var i = 0, promise; i < promises.length; i++) {\n      promise = promises[i];\n      goog.Promise.resolveThen_(promise, goog.partial(onFulfill, i), onReject);\n    }\n  });\n};\n\n\n/**\n * @param {!Array<?(goog.Promise<TYPE>|goog.Thenable<TYPE>|Thenable|*)>}\n *     promises\n * @return {!goog.Promise<!Array<{\n *     fulfilled: boolean,\n *     value: (TYPE|undefined),\n *     reason: (*|undefined)}>>} A Promise that resolves with a list of\n *         result objects once all input Promises (or Promise-like) have\n *         settled. Each result object contains a 'fulfilled' boolean indicating\n *         whether an input Promise was fulfilled or rejected. For fulfilled\n *         Promises, the resulting value is stored in the 'value' field. For\n *         rejected Promises, the rejection reason is stored in the 'reason'\n *         field.\n * @template TYPE\n */\ngoog.Promise.allSettled = function(promises) {\n  return new goog.Promise(function(resolve, reject) {\n    var toSettle = promises.length;\n    var results = [];\n\n    if (!toSettle) {\n      resolve(results);\n      return;\n    }\n\n    var onSettled = function(index, fulfilled, result) {\n      toSettle--;\n      results[index] = fulfilled ? {fulfilled: true, value: result} :\n                                   {fulfilled: false, reason: result};\n      if (toSettle == 0) {\n        resolve(results);\n      }\n    };\n\n    for (var i = 0, promise; i < promises.length; i++) {\n      promise = promises[i];\n      goog.Promise.resolveThen_(\n          promise, goog.partial(onSettled, i, true /* fulfilled */),\n          goog.partial(onSettled, i, false /* fulfilled */));\n    }\n  });\n};\n\n\n/**\n * @param {!Array<?(goog.Promise<TYPE>|goog.Thenable<TYPE>|Thenable|*)>}\n *     promises\n * @return {!goog.Promise<TYPE>} A Promise that receives the value of the first\n *     input to be fulfilled, or is rejected with a list of every rejection\n *     reason if all inputs are rejected.\n * @template TYPE\n */\ngoog.Promise.firstFulfilled = function(promises) {\n  return new goog.Promise(function(resolve, reject) {\n    var toReject = promises.length;\n    var reasons = [];\n\n    if (!toReject) {\n      resolve(undefined);\n      return;\n    }\n\n    var onFulfill = function(value) { resolve(value); };\n\n    var onReject = function(index, reason) {\n      toReject--;\n      reasons[index] = reason;\n      if (toReject == 0) {\n        reject(reasons);\n      }\n    };\n\n    for (var i = 0, promise; i < promises.length; i++) {\n      promise = promises[i];\n      goog.Promise.resolveThen_(promise, onFulfill, goog.partial(onReject, i));\n    }\n  });\n};\n\n\n/**\n * @return {!goog.promise.Resolver<TYPE>} Resolver wrapping the promise and its\n *     resolve / reject functions. Resolving or rejecting the resolver\n *     resolves or rejects the promise.\n * @template TYPE\n */\ngoog.Promise.withResolver = function() {\n  var resolve, reject;\n  var promise = new goog.Promise(function(rs, rj) {\n    resolve = rs;\n    reject = rj;\n  });\n  return new goog.Promise.Resolver_(promise, resolve, reject);\n};\n\n\n/**\n * Adds callbacks that will operate on the result of the Promise, returning a\n * new child Promise.\n *\n * If the Promise is fulfilled, the {@code onFulfilled} callback will be invoked\n * with the fulfillment value as argument, and the child Promise will be\n * fulfilled with the return value of the callback. If the callback throws an\n * exception, the child Promise will be rejected with the thrown value instead.\n *\n * If the Promise is rejected, the {@code onRejected} callback will be invoked\n * with the rejection reason as argument, and the child Promise will be resolved\n * with the return value or rejected with the thrown value of the callback.\n *\n * @override\n */\ngoog.Promise.prototype.then = function(\n    opt_onFulfilled, opt_onRejected, opt_context) {\n\n  if (opt_onFulfilled != null) {\n    goog.asserts.assertFunction(\n        opt_onFulfilled, 'opt_onFulfilled should be a function.');\n  }\n  if (opt_onRejected != null) {\n    goog.asserts.assertFunction(\n        opt_onRejected,\n        'opt_onRejected should be a function. Did you pass opt_context ' +\n            'as the second argument instead of the third?');\n  }\n\n  if (goog.Promise.LONG_STACK_TRACES) {\n    this.addStackTrace_(new Error('then'));\n  }\n\n  return this.addChildPromise_(\n      goog.isFunction(opt_onFulfilled) ? opt_onFulfilled : null,\n      goog.isFunction(opt_onRejected) ? opt_onRejected : null, opt_context);\n};\ngoog.Thenable.addImplementation(goog.Promise);\n\n\n/**\n * Adds callbacks that will operate on the result of the Promise without\n * returning a child Promise (unlike \"then\").\n *\n * If the Promise is fulfilled, the {@code onFulfilled} callback will be invoked\n * with the fulfillment value as argument.\n *\n * If the Promise is rejected, the {@code onRejected} callback will be invoked\n * with the rejection reason as argument.\n *\n * @param {?(function(this:THIS, TYPE):?)=} opt_onFulfilled A\n *     function that will be invoked with the fulfillment value if the Promise\n *     is fulfilled.\n * @param {?(function(this:THIS, *): *)=} opt_onRejected A function that will\n *     be invoked with the rejection reason if the Promise is rejected.\n * @param {THIS=} opt_context An optional context object that will be the\n *     execution context for the callbacks. By default, functions are executed\n *     with the default this.\n * @package\n * @template THIS\n */\ngoog.Promise.prototype.thenVoid = function(\n    opt_onFulfilled, opt_onRejected, opt_context) {\n\n  if (opt_onFulfilled != null) {\n    goog.asserts.assertFunction(\n        opt_onFulfilled, 'opt_onFulfilled should be a function.');\n  }\n  if (opt_onRejected != null) {\n    goog.asserts.assertFunction(\n        opt_onRejected,\n        'opt_onRejected should be a function. Did you pass opt_context ' +\n            'as the second argument instead of the third?');\n  }\n\n  if (goog.Promise.LONG_STACK_TRACES) {\n    this.addStackTrace_(new Error('then'));\n  }\n\n  // Note: no default rejection handler is provided here as we need to\n  // distinguish unhandled rejections.\n  this.addCallbackEntry_(\n      goog.Promise.getCallbackEntry_(\n          opt_onFulfilled || goog.nullFunction, opt_onRejected || null,\n          opt_context));\n};\n\n\n/**\n * Adds a callback that will be invoked when the Promise is settled (fulfilled\n * or rejected). The callback receives no argument, and no new child Promise is\n * created. This is useful for ensuring that cleanup takes place after certain\n * asynchronous operations. Callbacks added with {@code thenAlways} will be\n * executed in the same order with other calls to {@code then},\n * {@code thenAlways}, or {@code thenCatch}.\n *\n * Since it does not produce a new child Promise, cancellation propagation is\n * not prevented by adding callbacks with {@code thenAlways}. A Promise that has\n * a cleanup handler added with {@code thenAlways} will be canceled if all of\n * its children created by {@code then} (or {@code thenCatch}) are canceled.\n * Additionally, since any rejections are not passed to the callback, it does\n * not stop the unhandled rejection handler from running.\n *\n * @param {function(this:THIS): void} onSettled A function that will be invoked\n *     when the Promise is settled (fulfilled or rejected).\n * @param {THIS=} opt_context An optional context object that will be the\n *     execution context for the callbacks. By default, functions are executed\n *     in the global scope.\n * @return {!goog.Promise<TYPE>} This Promise, for chaining additional calls.\n * @template THIS\n */\ngoog.Promise.prototype.thenAlways = function(onSettled, opt_context) {\n  if (goog.Promise.LONG_STACK_TRACES) {\n    this.addStackTrace_(new Error('thenAlways'));\n  }\n\n  var entry = goog.Promise.getCallbackEntry_(onSettled, onSettled, opt_context);\n  entry.always = true;\n  this.addCallbackEntry_(entry);\n  return this;\n};\n\n\n/**\n * Adds a callback that will be invoked only if the Promise is rejected. This\n * is equivalent to {@code then(null, onRejected)}.\n *\n * @param {function(this:THIS, *): *} onRejected A function that will be\n *     invoked with the rejection reason if the Promise is rejected.\n * @param {THIS=} opt_context An optional context object that will be the\n *     execution context for the callbacks. By default, functions are executed\n *     in the global scope.\n * @return {!goog.Promise} A new Promise that will receive the result of the\n *     callback.\n * @template THIS\n */\ngoog.Promise.prototype.thenCatch = function(onRejected, opt_context) {\n  if (goog.Promise.LONG_STACK_TRACES) {\n    this.addStackTrace_(new Error('thenCatch'));\n  }\n  return this.addChildPromise_(null, onRejected, opt_context);\n};\n\n\n/**\n * Cancels the Promise if it is still pending by rejecting it with a cancel\n * Error. No action is performed if the Promise is already resolved.\n *\n * All child Promises of the canceled Promise will be rejected with the same\n * cancel error, as with normal Promise rejection. If the Promise to be canceled\n * is the only child of a pending Promise, the parent Promise will also be\n * canceled. Cancellation may propagate upward through multiple generations.\n *\n * @param {string=} opt_message An optional debugging message for describing the\n *     cancellation reason.\n */\ngoog.Promise.prototype.cancel = function(opt_message) {\n  if (this.state_ == goog.Promise.State_.PENDING) {\n    goog.async.run(function() {\n      var err = new goog.Promise.CancellationError(opt_message);\n      this.cancelInternal_(err);\n    }, this);\n  }\n};\n\n\n/**\n * Cancels this Promise with the given error.\n *\n * @param {!Error} err The cancellation error.\n * @private\n */\ngoog.Promise.prototype.cancelInternal_ = function(err) {\n  if (this.state_ == goog.Promise.State_.PENDING) {\n    if (this.parent_) {\n      // Cancel the Promise and remove it from the parent's child list.\n      this.parent_.cancelChild_(this, err);\n      this.parent_ = null;\n    } else {\n      this.resolve_(goog.Promise.State_.REJECTED, err);\n    }\n  }\n};\n\n\n/**\n * Cancels a child Promise from the list of callback entries. If the Promise has\n * not already been resolved, reject it with a cancel error. If there are no\n * other children in the list of callback entries, propagate the cancellation\n * by canceling this Promise as well.\n *\n * @param {!goog.Promise} childPromise The Promise to cancel.\n * @param {!Error} err The cancel error to use for rejecting the Promise.\n * @private\n */\ngoog.Promise.prototype.cancelChild_ = function(childPromise, err) {\n  if (!this.callbackEntries_) {\n    return;\n  }\n  var childCount = 0;\n  var childEntry = null;\n  var beforeChildEntry = null;\n\n  // Find the callback entry for the childPromise, and count whether there are\n  // additional child Promises.\n  for (var entry = this.callbackEntries_; entry; entry = entry.next) {\n    if (!entry.always) {\n      childCount++;\n      if (entry.child == childPromise) {\n        childEntry = entry;\n      }\n      if (childEntry && childCount > 1) {\n        break;\n      }\n    }\n    if (!childEntry) {\n      beforeChildEntry = entry;\n    }\n  }\n\n  // Can a child entry be missing?\n\n  // If the child Promise was the only child, cancel this Promise as well.\n  // Otherwise, reject only the child Promise with the cancel error.\n  if (childEntry) {\n    if (this.state_ == goog.Promise.State_.PENDING && childCount == 1) {\n      this.cancelInternal_(err);\n    } else {\n      if (beforeChildEntry) {\n        this.removeEntryAfter_(beforeChildEntry);\n      } else {\n        this.popEntry_();\n      }\n\n      this.executeCallback_(childEntry, goog.Promise.State_.REJECTED, err);\n    }\n  }\n};\n\n\n/**\n * Adds a callback entry to the current Promise, and schedules callback\n * execution if the Promise has already been settled.\n *\n * @param {goog.Promise.CallbackEntry_} callbackEntry Record containing\n *     {@code onFulfilled} and {@code onRejected} callbacks to execute after\n *     the Promise is settled.\n * @private\n */\ngoog.Promise.prototype.addCallbackEntry_ = function(callbackEntry) {\n  if (!this.hasEntry_() && (this.state_ == goog.Promise.State_.FULFILLED ||\n                            this.state_ == goog.Promise.State_.REJECTED)) {\n    this.scheduleCallbacks_();\n  }\n  this.queueEntry_(callbackEntry);\n};\n\n\n/**\n * Creates a child Promise and adds it to the callback entry list. The result of\n * the child Promise is determined by the state of the parent Promise and the\n * result of the {@code onFulfilled} or {@code onRejected} callbacks as\n * specified in the Promise resolution procedure.\n *\n * @see http://promisesaplus.com/#the__method\n *\n * @param {?function(this:THIS, TYPE):\n *          (RESULT|goog.Promise<RESULT>|Thenable)} onFulfilled A callback that\n *     will be invoked if the Promise is fulfilled, or null.\n * @param {?function(this:THIS, *): *} onRejected A callback that will be\n *     invoked if the Promise is rejected, or null.\n * @param {THIS=} opt_context An optional execution context for the callbacks.\n *     in the default calling context.\n * @return {!goog.Promise} The child Promise.\n * @template RESULT,THIS\n * @private\n */\ngoog.Promise.prototype.addChildPromise_ = function(\n    onFulfilled, onRejected, opt_context) {\n\n  /** @type {goog.Promise.CallbackEntry_} */\n  var callbackEntry = goog.Promise.getCallbackEntry_(null, null, null);\n\n  callbackEntry.child = new goog.Promise(function(resolve, reject) {\n    // Invoke onFulfilled, or resolve with the parent's value if absent.\n    callbackEntry.onFulfilled = onFulfilled ? function(value) {\n      try {\n        var result = onFulfilled.call(opt_context, value);\n        resolve(result);\n      } catch (err) {\n        reject(err);\n      }\n    } : resolve;\n\n    // Invoke onRejected, or reject with the parent's reason if absent.\n    callbackEntry.onRejected = onRejected ? function(reason) {\n      try {\n        var result = onRejected.call(opt_context, reason);\n        if (!goog.isDef(result) &&\n            reason instanceof goog.Promise.CancellationError) {\n          // Propagate cancellation to children if no other result is returned.\n          reject(reason);\n        } else {\n          resolve(result);\n        }\n      } catch (err) {\n        reject(err);\n      }\n    } : reject;\n  });\n\n  callbackEntry.child.parent_ = this;\n  this.addCallbackEntry_(callbackEntry);\n  return callbackEntry.child;\n};\n\n\n/**\n * Unblocks the Promise and fulfills it with the given value.\n *\n * @param {TYPE} value\n * @private\n */\ngoog.Promise.prototype.unblockAndFulfill_ = function(value) {\n  goog.asserts.assert(this.state_ == goog.Promise.State_.BLOCKED);\n  this.state_ = goog.Promise.State_.PENDING;\n  this.resolve_(goog.Promise.State_.FULFILLED, value);\n};\n\n\n/**\n * Unblocks the Promise and rejects it with the given rejection reason.\n *\n * @param {*} reason\n * @private\n */\ngoog.Promise.prototype.unblockAndReject_ = function(reason) {\n  goog.asserts.assert(this.state_ == goog.Promise.State_.BLOCKED);\n  this.state_ = goog.Promise.State_.PENDING;\n  this.resolve_(goog.Promise.State_.REJECTED, reason);\n};\n\n\n/**\n * Attempts to resolve a Promise with a given resolution state and value. This\n * is a no-op if the given Promise has already been resolved.\n *\n * If the given result is a Thenable (such as another Promise), the Promise will\n * be settled with the same state and result as the Thenable once it is itself\n * settled.\n *\n * If the given result is not a Thenable, the Promise will be settled (fulfilled\n * or rejected) with that result based on the given state.\n *\n * @see http://promisesaplus.com/#the_promise_resolution_procedure\n *\n * @param {goog.Promise.State_} state\n * @param {*} x The result to apply to the Promise.\n * @private\n */\ngoog.Promise.prototype.resolve_ = function(state, x) {\n  if (this.state_ != goog.Promise.State_.PENDING) {\n    return;\n  }\n\n  if (this === x) {\n    state = goog.Promise.State_.REJECTED;\n    x = new TypeError('Promise cannot resolve to itself');\n  }\n\n  this.state_ = goog.Promise.State_.BLOCKED;\n  var isThenable = goog.Promise.maybeThen_(\n      x, this.unblockAndFulfill_, this.unblockAndReject_, this);\n  if (isThenable) {\n    return;\n  }\n\n  this.result_ = x;\n  this.state_ = state;\n  // Since we can no longer be canceled, remove link to parent, so that the\n  // child promise does not keep the parent promise alive.\n  this.parent_ = null;\n  this.scheduleCallbacks_();\n\n  if (state == goog.Promise.State_.REJECTED &&\n      !(x instanceof goog.Promise.CancellationError)) {\n    goog.Promise.addUnhandledRejection_(this, x);\n  }\n};\n\n\n/**\n * Invokes the \"then\" method of an input value if that value is a Thenable. This\n * is a no-op if the value is not thenable.\n *\n * @param {?} value A potentially thenable value.\n * @param {!Function} onFulfilled\n * @param {!Function} onRejected\n * @param {?} context\n * @return {boolean} Whether the input value was thenable.\n * @private\n */\ngoog.Promise.maybeThen_ = function(value, onFulfilled, onRejected, context) {\n  if (value instanceof goog.Promise) {\n    value.thenVoid(onFulfilled, onRejected, context);\n    return true;\n  } else if (goog.Thenable.isImplementedBy(value)) {\n    value = /** @type {!goog.Thenable} */ (value);\n    value.then(onFulfilled, onRejected, context);\n    return true;\n  } else if (goog.isObject(value)) {\n    try {\n      var then = value['then'];\n      if (goog.isFunction(then)) {\n        goog.Promise.tryThen_(value, then, onFulfilled, onRejected, context);\n        return true;\n      }\n    } catch (e) {\n      onRejected.call(context, e);\n      return true;\n    }\n  }\n\n  return false;\n};\n\n\n/**\n * Attempts to call the {@code then} method on an object in the hopes that it is\n * a Promise-compatible instance. This allows interoperation between different\n * Promise implementations, however a non-compliant object may cause a Promise\n * to hang indefinitely. If the {@code then} method throws an exception, the\n * dependent Promise will be rejected with the thrown value.\n *\n * @see http://promisesaplus.com/#point-70\n *\n * @param {Thenable} thenable An object with a {@code then} method that may be\n *     compatible with the Promise/A+ specification.\n * @param {!Function} then The {@code then} method of the Thenable object.\n * @param {!Function} onFulfilled\n * @param {!Function} onRejected\n * @param {*} context\n * @private\n */\ngoog.Promise.tryThen_ = function(\n    thenable, then, onFulfilled, onRejected, context) {\n\n  var called = false;\n  var resolve = function(value) {\n    if (!called) {\n      called = true;\n      onFulfilled.call(context, value);\n    }\n  };\n\n  var reject = function(reason) {\n    if (!called) {\n      called = true;\n      onRejected.call(context, reason);\n    }\n  };\n\n  try {\n    then.call(thenable, resolve, reject);\n  } catch (e) {\n    reject(e);\n  }\n};\n\n\n/**\n * Executes the pending callbacks of a settled Promise after a timeout.\n *\n * Section 2.2.4 of the Promises/A+ specification requires that Promise\n * callbacks must only be invoked from a call stack that only contains Promise\n * implementation code, which we accomplish by invoking callback execution after\n * a timeout. If {@code startExecution_} is called multiple times for the same\n * Promise, the callback chain will be evaluated only once. Additional callbacks\n * may be added during the evaluation phase, and will be executed in the same\n * event loop.\n *\n * All Promises added to the waiting list during the same browser event loop\n * will be executed in one batch to avoid using a separate timeout per Promise.\n *\n * @private\n */\ngoog.Promise.prototype.scheduleCallbacks_ = function() {\n  if (!this.executing_) {\n    this.executing_ = true;\n    goog.async.run(this.executeCallbacks_, this);\n  }\n};\n\n\n/**\n * @return {boolean} Whether there are any pending callbacks queued.\n * @private\n */\ngoog.Promise.prototype.hasEntry_ = function() {\n  return !!this.callbackEntries_;\n};\n\n\n/**\n * @param {goog.Promise.CallbackEntry_} entry\n * @private\n */\ngoog.Promise.prototype.queueEntry_ = function(entry) {\n  goog.asserts.assert(entry.onFulfilled != null);\n\n  if (this.callbackEntriesTail_) {\n    this.callbackEntriesTail_.next = entry;\n    this.callbackEntriesTail_ = entry;\n  } else {\n    // It the work queue was empty set the head too.\n    this.callbackEntries_ = entry;\n    this.callbackEntriesTail_ = entry;\n  }\n};\n\n\n/**\n * @return {goog.Promise.CallbackEntry_} entry\n * @private\n */\ngoog.Promise.prototype.popEntry_ = function() {\n  var entry = null;\n  if (this.callbackEntries_) {\n    entry = this.callbackEntries_;\n    this.callbackEntries_ = entry.next;\n    entry.next = null;\n  }\n  // It the work queue is empty clear the tail too.\n  if (!this.callbackEntries_) {\n    this.callbackEntriesTail_ = null;\n  }\n\n  if (entry != null) {\n    goog.asserts.assert(entry.onFulfilled != null);\n  }\n  return entry;\n};\n\n\n/**\n * @param {goog.Promise.CallbackEntry_} previous\n * @private\n */\ngoog.Promise.prototype.removeEntryAfter_ = function(previous) {\n  goog.asserts.assert(this.callbackEntries_);\n  goog.asserts.assert(previous != null);\n  // If the last entry is being removed, update the tail\n  if (previous.next == this.callbackEntriesTail_) {\n    this.callbackEntriesTail_ = previous;\n  }\n\n  previous.next = previous.next.next;\n};\n\n\n/**\n * Executes all pending callbacks for this Promise.\n *\n * @private\n */\ngoog.Promise.prototype.executeCallbacks_ = function() {\n  var entry = null;\n  while (entry = this.popEntry_()) {\n    if (goog.Promise.LONG_STACK_TRACES) {\n      this.currentStep_++;\n    }\n    this.executeCallback_(entry, this.state_, this.result_);\n  }\n  this.executing_ = false;\n};\n\n\n/**\n * Executes a pending callback for this Promise. Invokes an {@code onFulfilled}\n * or {@code onRejected} callback based on the settled state of the Promise.\n *\n * @param {!goog.Promise.CallbackEntry_} callbackEntry An entry containing the\n *     onFulfilled and/or onRejected callbacks for this step.\n * @param {goog.Promise.State_} state The resolution status of the Promise,\n *     either FULFILLED or REJECTED.\n * @param {*} result The settled result of the Promise.\n * @private\n */\ngoog.Promise.prototype.executeCallback_ = function(\n    callbackEntry, state, result) {\n  // Cancel an unhandled rejection if the then/thenVoid call had an onRejected.\n  if (state == goog.Promise.State_.REJECTED && callbackEntry.onRejected &&\n      !callbackEntry.always) {\n    this.removeUnhandledRejection_();\n  }\n\n  if (callbackEntry.child) {\n    // When the parent is settled, the child no longer needs to hold on to it,\n    // as the parent can no longer be canceled.\n    callbackEntry.child.parent_ = null;\n    goog.Promise.invokeCallback_(callbackEntry, state, result);\n  } else {\n    // Callbacks created with thenAlways or thenVoid do not have the rejection\n    // handling code normally set up in the child Promise.\n    try {\n      callbackEntry.always ?\n          callbackEntry.onFulfilled.call(callbackEntry.context) :\n          goog.Promise.invokeCallback_(callbackEntry, state, result);\n    } catch (err) {\n      goog.Promise.handleRejection_.call(null, err);\n    }\n  }\n  goog.Promise.returnEntry_(callbackEntry);\n};\n\n\n/**\n * Executes the onFulfilled or onRejected callback for a callbackEntry.\n *\n * @param {!goog.Promise.CallbackEntry_} callbackEntry\n * @param {goog.Promise.State_} state\n * @param {*} result\n * @private\n */\ngoog.Promise.invokeCallback_ = function(callbackEntry, state, result) {\n  if (state == goog.Promise.State_.FULFILLED) {\n    callbackEntry.onFulfilled.call(callbackEntry.context, result);\n  } else if (callbackEntry.onRejected) {\n    callbackEntry.onRejected.call(callbackEntry.context, result);\n  }\n};\n\n\n/**\n * Records a stack trace entry for functions that call {@code then} or the\n * Promise constructor. May be disabled by unsetting {@code LONG_STACK_TRACES}.\n *\n * @param {!Error} err An Error object created by the calling function for\n *     providing a stack trace.\n * @private\n */\ngoog.Promise.prototype.addStackTrace_ = function(err) {\n  if (goog.Promise.LONG_STACK_TRACES && goog.isString(err.stack)) {\n    // Extract the third line of the stack trace, which is the entry for the\n    // user function that called into Promise code.\n    var trace = err.stack.split('\\n', 4)[3];\n    var message = err.message;\n\n    // Pad the message to align the traces.\n    message += Array(11 - message.length).join(' ');\n    this.stack_.push(message + trace);\n  }\n};\n\n\n/**\n * Adds extra stack trace information to an exception for the list of\n * asynchronous {@code then} calls that have been run for this Promise. Stack\n * trace information is recorded in {@see #addStackTrace_}, and appended to\n * rethrown errors when {@code LONG_STACK_TRACES} is enabled.\n *\n * @param {*} err An unhandled exception captured during callback execution.\n * @private\n */\ngoog.Promise.prototype.appendLongStack_ = function(err) {\n  if (goog.Promise.LONG_STACK_TRACES && err && goog.isString(err.stack) &&\n      this.stack_.length) {\n    var longTrace = ['Promise trace:'];\n\n    for (var promise = this; promise; promise = promise.parent_) {\n      for (var i = this.currentStep_; i >= 0; i--) {\n        longTrace.push(promise.stack_[i]);\n      }\n      longTrace.push(\n          'Value: ' +\n          '[' + (promise.state_ == goog.Promise.State_.REJECTED ? 'REJECTED' :\n                                                                  'FULFILLED') +\n          '] ' +\n          '<' + String(promise.result_) + '>');\n    }\n    err.stack += '\\n\\n' + longTrace.join('\\n');\n  }\n};\n\n\n/**\n * Marks this rejected Promise as having being handled. Also marks any parent\n * Promises in the rejected state as handled. The rejection handler will no\n * longer be invoked for this Promise (if it has not been called already).\n *\n * @private\n */\ngoog.Promise.prototype.removeUnhandledRejection_ = function() {\n  if (goog.Promise.UNHANDLED_REJECTION_DELAY > 0) {\n    for (var p = this; p && p.unhandledRejectionId_; p = p.parent_) {\n      goog.global.clearTimeout(p.unhandledRejectionId_);\n      p.unhandledRejectionId_ = 0;\n    }\n  } else if (goog.Promise.UNHANDLED_REJECTION_DELAY == 0) {\n    for (var p = this; p && p.hadUnhandledRejection_; p = p.parent_) {\n      p.hadUnhandledRejection_ = false;\n    }\n  }\n};\n\n\n/**\n * Marks this rejected Promise as unhandled. If no {@code onRejected} callback\n * is called for this Promise before the {@code UNHANDLED_REJECTION_DELAY}\n * expires, the reason will be passed to the unhandled rejection handler. The\n * handler typically rethrows the rejection reason so that it becomes visible in\n * the developer console.\n *\n * @param {!goog.Promise} promise The rejected Promise.\n * @param {*} reason The Promise rejection reason.\n * @private\n */\ngoog.Promise.addUnhandledRejection_ = function(promise, reason) {\n  if (goog.Promise.UNHANDLED_REJECTION_DELAY > 0) {\n    promise.unhandledRejectionId_ = goog.global.setTimeout(function() {\n      promise.appendLongStack_(reason);\n      goog.Promise.handleRejection_.call(null, reason);\n    }, goog.Promise.UNHANDLED_REJECTION_DELAY);\n\n  } else if (goog.Promise.UNHANDLED_REJECTION_DELAY == 0) {\n    promise.hadUnhandledRejection_ = true;\n    goog.async.run(function() {\n      if (promise.hadUnhandledRejection_) {\n        promise.appendLongStack_(reason);\n        goog.Promise.handleRejection_.call(null, reason);\n      }\n    });\n  }\n};\n\n\n/**\n * A method that is invoked with the rejection reasons for Promises that are\n * rejected but have no {@code onRejected} callbacks registered yet.\n * @type {function(*)}\n * @private\n */\ngoog.Promise.handleRejection_ = goog.async.throwException;\n\n\n/**\n * Sets a handler that will be called with reasons from unhandled rejected\n * Promises. If the rejected Promise (or one of its descendants) has an\n * {@code onRejected} callback registered, the rejection will be considered\n * handled, and the rejection handler will not be called.\n *\n * By default, unhandled rejections are rethrown so that the error may be\n * captured by the developer console or a {@code window.onerror} handler.\n *\n * @param {function(*)} handler A function that will be called with reasons from\n *     rejected Promises. Defaults to {@code goog.async.throwException}.\n */\ngoog.Promise.setUnhandledRejectionHandler = function(handler) {\n  goog.Promise.handleRejection_ = handler;\n};\n\n\n\n/**\n * Error used as a rejection reason for canceled Promises.\n *\n * @param {string=} opt_message\n * @constructor\n * @extends {goog.debug.Error}\n * @final\n */\ngoog.Promise.CancellationError = function(opt_message) {\n  goog.Promise.CancellationError.base(this, 'constructor', opt_message);\n};\ngoog.inherits(goog.Promise.CancellationError, goog.debug.Error);\n\n\n/** @override */\ngoog.Promise.CancellationError.prototype.name = 'cancel';\n\n\n\n/**\n * Internal implementation of the resolver interface.\n *\n * @param {!goog.Promise<TYPE>} promise\n * @param {function((TYPE|goog.Promise<TYPE>|Thenable)=)} resolve\n * @param {function(*=): void} reject\n * @implements {goog.promise.Resolver<TYPE>}\n * @final @struct\n * @constructor\n * @private\n * @template TYPE\n */\ngoog.Promise.Resolver_ = function(promise, resolve, reject) {\n  /** @const */\n  this.promise = promise;\n\n  /** @const */\n  this.resolve = resolve;\n\n  /** @const */\n  this.reject = reject;\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A timer class to which other classes and objects can listen on.\n * This is only an abstraction above {@code setInterval}.\n *\n * @see ../demos/timers.html\n */\n\ngoog.provide('goog.Timer');\n\ngoog.require('goog.Promise');\ngoog.require('goog.events.EventTarget');\n\n\n\n/**\n * Class for handling timing events.\n *\n * @param {number=} opt_interval Number of ms between ticks (default: 1ms).\n * @param {Object=} opt_timerObject  An object that has {@code setTimeout},\n *     {@code setInterval}, {@code clearTimeout} and {@code clearInterval}\n *     (e.g., {@code window}).\n * @constructor\n * @extends {goog.events.EventTarget}\n */\ngoog.Timer = function(opt_interval, opt_timerObject) {\n  goog.events.EventTarget.call(this);\n\n  /**\n   * Number of ms between ticks\n   * @private {number}\n   */\n  this.interval_ = opt_interval || 1;\n\n  /**\n   * An object that implements {@code setTimeout}, {@code setInterval},\n   * {@code clearTimeout} and {@code clearInterval}. We default to the window\n   * object. Changing this on {@link goog.Timer.prototype} changes the object\n   * for all timer instances which can be useful if your environment has some\n   * other implementation of timers than the {@code window} object.\n   * @private {{setTimeout:!Function, clearTimeout:!Function}}\n   */\n  this.timerObject_ = /** @type {{setTimeout, clearTimeout}} */ (\n      opt_timerObject || goog.Timer.defaultTimerObject);\n\n  /**\n   * Cached {@code tick_} bound to the object for later use in the timer.\n   * @private {Function}\n   * @const\n   */\n  this.boundTick_ = goog.bind(this.tick_, this);\n\n  /**\n   * Firefox browser often fires the timer event sooner (sometimes MUCH sooner)\n   * than the requested timeout. So we compare the time to when the event was\n   * last fired, and reschedule if appropriate. See also\n   * {@link goog.Timer.intervalScale}.\n   * @private {number}\n   */\n  this.last_ = goog.now();\n};\ngoog.inherits(goog.Timer, goog.events.EventTarget);\n\n\n/**\n * Maximum timeout value.\n *\n * Timeout values too big to fit into a signed 32-bit integer may cause overflow\n * in FF, Safari, and Chrome, resulting in the timeout being scheduled\n * immediately. It makes more sense simply not to schedule these timeouts, since\n * 24.8 days is beyond a reasonable expectation for the browser to stay open.\n *\n * @private {number}\n * @const\n */\ngoog.Timer.MAX_TIMEOUT_ = 2147483647;\n\n\n/**\n * A timer ID that cannot be returned by any known implementation of\n * {@code window.setTimeout}. Passing this value to {@code window.clearTimeout}\n * should therefore be a no-op.\n *\n * @private {number}\n * @const\n */\ngoog.Timer.INVALID_TIMEOUT_ID_ = -1;\n\n\n/**\n * Whether this timer is enabled\n * @type {boolean}\n */\ngoog.Timer.prototype.enabled = false;\n\n\n/**\n * An object that implements {@code setTimeout}, {@code setInterval},\n * {@code clearTimeout} and {@code clearInterval}. We default to the global\n * object. Changing {@code goog.Timer.defaultTimerObject} changes the object for\n * all timer instances which can be useful if your environment has some other\n * implementation of timers you'd like to use.\n * @type {{setTimeout, clearTimeout}}\n */\ngoog.Timer.defaultTimerObject = goog.global;\n\n\n/**\n * Variable that controls the timer error correction. If the timer is called\n * before the requested interval times {@code intervalScale}, which often\n * happens on Mozilla, the timer is rescheduled.\n * @see {@link #last_}\n * @type {number}\n */\ngoog.Timer.intervalScale = 0.8;\n\n\n/**\n * Variable for storing the result of {@code setInterval}.\n * @private {?number}\n */\ngoog.Timer.prototype.timer_ = null;\n\n\n/**\n * Gets the interval of the timer.\n * @return {number} interval Number of ms between ticks.\n */\ngoog.Timer.prototype.getInterval = function() {\n  return this.interval_;\n};\n\n\n/**\n * Sets the interval of the timer.\n * @param {number} interval Number of ms between ticks.\n */\ngoog.Timer.prototype.setInterval = function(interval) {\n  this.interval_ = interval;\n  if (this.timer_ && this.enabled) {\n    // Stop and then start the timer to reset the interval.\n    this.stop();\n    this.start();\n  } else if (this.timer_) {\n    this.stop();\n  }\n};\n\n\n/**\n * Callback for the {@code setTimeout} used by the timer.\n * @private\n */\ngoog.Timer.prototype.tick_ = function() {\n  if (this.enabled) {\n    var elapsed = goog.now() - this.last_;\n    if (elapsed > 0 && elapsed < this.interval_ * goog.Timer.intervalScale) {\n      this.timer_ = this.timerObject_.setTimeout(\n          this.boundTick_, this.interval_ - elapsed);\n      return;\n    }\n\n    // Prevents setInterval from registering a duplicate timeout when called\n    // in the timer event handler.\n    if (this.timer_) {\n      this.timerObject_.clearTimeout(this.timer_);\n      this.timer_ = null;\n    }\n\n    this.dispatchTick();\n    // The timer could be stopped in the timer event handler.\n    if (this.enabled) {\n      this.timer_ =\n          this.timerObject_.setTimeout(this.boundTick_, this.interval_);\n      this.last_ = goog.now();\n    }\n  }\n};\n\n\n/**\n * Dispatches the TICK event. This is its own method so subclasses can override.\n */\ngoog.Timer.prototype.dispatchTick = function() {\n  this.dispatchEvent(goog.Timer.TICK);\n};\n\n\n/**\n * Starts the timer.\n */\ngoog.Timer.prototype.start = function() {\n  this.enabled = true;\n\n  // If there is no interval already registered, start it now\n  if (!this.timer_) {\n    // IMPORTANT!\n    // window.setInterval in FireFox has a bug - it fires based on\n    // absolute time, rather than on relative time. What this means\n    // is that if a computer is sleeping/hibernating for 24 hours\n    // and the timer interval was configured to fire every 1000ms,\n    // then after the PC wakes up the timer will fire, in rapid\n    // succession, 3600*24 times.\n    // This bug is described here and is already fixed, but it will\n    // take time to propagate, so for now I am switching this over\n    // to setTimeout logic.\n    //     https://bugzilla.mozilla.org/show_bug.cgi?id=376643\n    //\n    this.timer_ = this.timerObject_.setTimeout(this.boundTick_, this.interval_);\n    this.last_ = goog.now();\n  }\n};\n\n\n/**\n * Stops the timer.\n */\ngoog.Timer.prototype.stop = function() {\n  this.enabled = false;\n  if (this.timer_) {\n    this.timerObject_.clearTimeout(this.timer_);\n    this.timer_ = null;\n  }\n};\n\n\n/** @override */\ngoog.Timer.prototype.disposeInternal = function() {\n  goog.Timer.superClass_.disposeInternal.call(this);\n  this.stop();\n  delete this.timerObject_;\n};\n\n\n/**\n * Constant for the timer's event type.\n * @const\n */\ngoog.Timer.TICK = 'tick';\n\n\n/**\n * Calls the given function once, after the optional pause.\n * <p>\n * The function is always called asynchronously, even if the delay is 0. This\n * is a common trick to schedule a function to run after a batch of browser\n * event processing.\n *\n * @param {function(this:SCOPE)|{handleEvent:function()}|null} listener Function\n *     or object that has a handleEvent method.\n * @param {number=} opt_delay Milliseconds to wait; default is 0.\n * @param {SCOPE=} opt_handler Object in whose scope to call the listener.\n * @return {number} A handle to the timer ID.\n * @template SCOPE\n */\ngoog.Timer.callOnce = function(listener, opt_delay, opt_handler) {\n  if (goog.isFunction(listener)) {\n    if (opt_handler) {\n      listener = goog.bind(listener, opt_handler);\n    }\n  } else if (listener && typeof listener.handleEvent == 'function') {\n    // using typeof to prevent strict js warning\n    listener = goog.bind(listener.handleEvent, listener);\n  } else {\n    throw Error('Invalid listener argument');\n  }\n\n  if (Number(opt_delay) > goog.Timer.MAX_TIMEOUT_) {\n    // Timeouts greater than MAX_INT return immediately due to integer\n    // overflow in many browsers.  Since MAX_INT is 24.8 days, just don't\n    // schedule anything at all.\n    return goog.Timer.INVALID_TIMEOUT_ID_;\n  } else {\n    return goog.Timer.defaultTimerObject.setTimeout(listener, opt_delay || 0);\n  }\n};\n\n\n/**\n * Clears a timeout initiated by {@link #callOnce}.\n * @param {?number} timerId A timer ID.\n */\ngoog.Timer.clear = function(timerId) {\n  goog.Timer.defaultTimerObject.clearTimeout(timerId);\n};\n\n\n/**\n * @param {number} delay Milliseconds to wait.\n * @param {(RESULT|goog.Thenable<RESULT>|Thenable)=} opt_result The value\n *     with which the promise will be resolved.\n * @return {!goog.Promise<RESULT>} A promise that will be resolved after\n *     the specified delay, unless it is canceled first.\n * @template RESULT\n */\ngoog.Timer.promise = function(delay, opt_result) {\n  var timerKey = null;\n  return new goog\n      .Promise(function(resolve, reject) {\n        timerKey =\n            goog.Timer.callOnce(function() { resolve(opt_result); }, delay);\n        if (timerKey == goog.Timer.INVALID_TIMEOUT_ID_) {\n          reject(new Error('Failed to schedule timer.'));\n        }\n      })\n      .thenCatch(function(error) {\n        // Clear the timer. The most likely reason is \"cancel\" signal.\n        goog.Timer.clear(timerKey);\n        throw error;\n      });\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utility for fast string concatenation.\n */\n\ngoog.provide('goog.string.StringBuffer');\n\n\n\n/**\n * Utility class to facilitate string concatenation.\n *\n * @param {*=} opt_a1 Optional first initial item to append.\n * @param {...*} var_args Other initial items to\n *     append, e.g., new goog.string.StringBuffer('foo', 'bar').\n * @constructor\n */\ngoog.string.StringBuffer = function(opt_a1, var_args) {\n  if (opt_a1 != null) {\n    this.append.apply(this, arguments);\n  }\n};\n\n\n/**\n * Internal buffer for the string to be concatenated.\n * @type {string}\n * @private\n */\ngoog.string.StringBuffer.prototype.buffer_ = '';\n\n\n/**\n * Sets the contents of the string buffer object, replacing what's currently\n * there.\n *\n * @param {*} s String to set.\n */\ngoog.string.StringBuffer.prototype.set = function(s) {\n  this.buffer_ = '' + s;\n};\n\n\n/**\n * Appends one or more items to the buffer.\n *\n * Calling this with null, undefined, or empty arguments is an error.\n *\n * @param {*} a1 Required first string.\n * @param {*=} opt_a2 Optional second string.\n * @param {...?} var_args Other items to append,\n *     e.g., sb.append('foo', 'bar', 'baz').\n * @return {!goog.string.StringBuffer} This same StringBuffer object.\n * @suppress {duplicate}\n */\ngoog.string.StringBuffer.prototype.append = function(a1, opt_a2, var_args) {\n  // Use a1 directly to avoid arguments instantiation for single-arg case.\n  this.buffer_ += String(a1);\n  if (opt_a2 != null) {  // second argument is undefined (null == undefined)\n    for (var i = 1; i < arguments.length; i++) {\n      this.buffer_ += arguments[i];\n    }\n  }\n  return this;\n};\n\n\n/**\n * Clears the internal buffer.\n */\ngoog.string.StringBuffer.prototype.clear = function() {\n  this.buffer_ = '';\n};\n\n\n/**\n * @return {number} the length of the current contents of the buffer.\n */\ngoog.string.StringBuffer.prototype.getLength = function() {\n  return this.buffer_.length;\n};\n\n\n/**\n * @return {string} The concatenated string.\n * @override\n */\ngoog.string.StringBuffer.prototype.toString = function() {\n  return this.buffer_;\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Definition of the goog.ui.tree.BaseNode class.\n *\n * @author arv@google.com (Erik Arvidsson)\n * @author eae@google.com (Emil A Eklund)\n *\n * This is a based on the webfx tree control. It since been updated to add\n * typeahead support, as well as accessibility support using ARIA framework.\n * See file comment in treecontrol.js.\n */\n\ngoog.provide('goog.ui.tree.BaseNode');\ngoog.provide('goog.ui.tree.BaseNode.EventType');\n\ngoog.require('goog.Timer');\ngoog.require('goog.a11y.aria');\ngoog.require('goog.asserts');\ngoog.require('goog.dom.safe');\ngoog.require('goog.events.Event');\ngoog.require('goog.events.KeyCodes');\ngoog.require('goog.html.SafeHtml');\ngoog.require('goog.html.SafeStyle');\ngoog.require('goog.string');\ngoog.require('goog.string.StringBuffer');\ngoog.require('goog.style');\ngoog.require('goog.ui.Component');\n\n\n\n/**\n * An abstract base class for a node in the tree.\n *\n * @param {string|!goog.html.SafeHtml} content The content of the node label.\n *     Strings are treated as plain-text and will be HTML escaped.\n * @param {Object=} opt_config The configuration for the tree. See\n *    {@link goog.ui.tree.BaseNode.defaultConfig}. If not specified the\n *    default config will be used.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper.\n * @constructor\n * @extends {goog.ui.Component}\n */\ngoog.ui.tree.BaseNode = function(content, opt_config, opt_domHelper) {\n  goog.ui.Component.call(this, opt_domHelper);\n\n  /**\n   * The configuration for the tree.\n   * @type {Object}\n   * @private\n   */\n  this.config_ = opt_config || goog.ui.tree.BaseNode.defaultConfig;\n\n  /**\n   * HTML content of the node label.\n   * @type {!goog.html.SafeHtml}\n   * @private\n   */\n  this.html_ = goog.html.SafeHtml.htmlEscapePreservingNewlines(content);\n\n  /** @private {string} */\n  this.iconClass_;\n\n  /** @private {string} */\n  this.expandedIconClass_;\n\n  /** @protected {goog.ui.tree.TreeControl} */\n  this.tree;\n\n  /** @private {goog.ui.tree.BaseNode} */\n  this.previousSibling_;\n\n  /** @private {goog.ui.tree.BaseNode} */\n  this.nextSibling_;\n\n  /** @private {goog.ui.tree.BaseNode} */\n  this.firstChild_;\n\n  /** @private {goog.ui.tree.BaseNode} */\n  this.lastChild_;\n\n  /**\n   * Whether the tree item is selected.\n   * @private {boolean}\n   */\n  this.selected_ = false;\n\n  /**\n   * Whether the tree node is expanded.\n   * @private {boolean}\n   */\n  this.expanded_ = false;\n\n  /**\n   * Tooltip for the tree item\n   * @private {?string}\n   */\n  this.toolTip_ = null;\n\n  /**\n   * HTML that can appear after the label (so not inside the anchor).\n   * @private {!goog.html.SafeHtml}\n   */\n  this.afterLabelHtml_ = goog.html.SafeHtml.EMPTY;\n\n  /**\n   * Whether to allow user to collapse this node.\n   * @private {boolean}\n   */\n  this.isUserCollapsible_ = true;\n\n  /**\n   * Nesting depth of this node; cached result of computeDepth_.\n   * -1 if value has not been cached.\n   * @private {number}\n   */\n  this.depth_ = -1;\n};\ngoog.inherits(goog.ui.tree.BaseNode, goog.ui.Component);\n\n\n/**\n * The event types dispatched by this class.\n * @enum {string}\n */\ngoog.ui.tree.BaseNode.EventType = {\n  BEFORE_EXPAND: 'beforeexpand',\n  EXPAND: 'expand',\n  BEFORE_COLLAPSE: 'beforecollapse',\n  COLLAPSE: 'collapse'\n};\n\n\n/**\n * Map of nodes in existence. Needed to route events to the appropriate nodes.\n * Nodes are added to the map at {@link #enterDocument} time and removed at\n * {@link #exitDocument} time.\n * @type {Object}\n * @protected\n */\ngoog.ui.tree.BaseNode.allNodes = {};\n\n\n/** @override */\ngoog.ui.tree.BaseNode.prototype.disposeInternal = function() {\n  goog.ui.tree.BaseNode.superClass_.disposeInternal.call(this);\n  if (this.tree) {\n    this.tree.removeNode(this);\n    this.tree = null;\n  }\n  this.setElementInternal(null);\n};\n\n\n/**\n * Adds roles and states.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.initAccessibility = function() {\n  var el = this.getElement();\n  if (el) {\n    // Set an id for the label\n    var label = this.getLabelElement();\n    if (label && !label.id) {\n      label.id = this.getId() + '.label';\n    }\n\n    goog.a11y.aria.setRole(el, 'treeitem');\n    goog.a11y.aria.setState(el, 'selected', false);\n    goog.a11y.aria.setState(el, 'expanded', false);\n    goog.a11y.aria.setState(el, 'level', this.getDepth());\n    if (label) {\n      goog.a11y.aria.setState(el, 'labelledby', label.id);\n    }\n\n    var img = this.getIconElement();\n    if (img) {\n      goog.a11y.aria.setRole(img, 'presentation');\n    }\n    var ei = this.getExpandIconElement();\n    if (ei) {\n      goog.a11y.aria.setRole(ei, 'presentation');\n    }\n\n    var ce = this.getChildrenElement();\n    if (ce) {\n      goog.a11y.aria.setRole(ce, 'group');\n\n      // In case the children will be created lazily.\n      if (ce.hasChildNodes()) {\n        // do setsize for each child\n        var count = this.getChildCount();\n        for (var i = 1; i <= count; i++) {\n          var child = this.getChildAt(i - 1).getElement();\n          goog.asserts.assert(child, 'The child element cannot be null');\n          goog.a11y.aria.setState(child, 'setsize', count);\n          goog.a11y.aria.setState(child, 'posinset', i);\n        }\n      }\n    }\n  }\n};\n\n\n/** @override */\ngoog.ui.tree.BaseNode.prototype.createDom = function() {\n  var element = this.getDomHelper().safeHtmlToNode(this.toSafeHtml());\n  this.setElementInternal(/** @type {!Element} */ (element));\n};\n\n\n/** @override */\ngoog.ui.tree.BaseNode.prototype.enterDocument = function() {\n  goog.ui.tree.BaseNode.superClass_.enterDocument.call(this);\n  goog.ui.tree.BaseNode.allNodes[this.getId()] = this;\n  this.initAccessibility();\n};\n\n\n/** @override */\ngoog.ui.tree.BaseNode.prototype.exitDocument = function() {\n  goog.ui.tree.BaseNode.superClass_.exitDocument.call(this);\n  delete goog.ui.tree.BaseNode.allNodes[this.getId()];\n};\n\n\n/**\n * The method assumes that the child doesn't have parent node yet.\n * The {@code opt_render} argument is not used. If the parent node is expanded,\n * the child node's state will be the same as the parent's. Otherwise the\n * child's DOM tree won't be created.\n * @override\n */\ngoog.ui.tree.BaseNode.prototype.addChildAt = function(\n    child, index, opt_render) {\n  goog.asserts.assert(!child.getParent());\n  goog.asserts.assertInstanceof(child, goog.ui.tree.BaseNode);\n  var prevNode = this.getChildAt(index - 1);\n  var nextNode = this.getChildAt(index);\n\n  goog.ui.tree.BaseNode.superClass_.addChildAt.call(this, child, index);\n\n  child.previousSibling_ = prevNode;\n  child.nextSibling_ = nextNode;\n\n  if (prevNode) {\n    prevNode.nextSibling_ = child;\n  } else {\n    this.firstChild_ = child;\n  }\n  if (nextNode) {\n    nextNode.previousSibling_ = child;\n  } else {\n    this.lastChild_ = child;\n  }\n\n  var tree = this.getTree();\n  if (tree) {\n    child.setTreeInternal(tree);\n  }\n\n  child.setDepth_(this.getDepth() + 1);\n\n  if (this.getElement()) {\n    this.updateExpandIcon();\n    if (this.getExpanded()) {\n      var el = this.getChildrenElement();\n      if (!child.getElement()) {\n        child.createDom();\n      }\n      var childElement = child.getElement();\n      var nextElement = nextNode && nextNode.getElement();\n      el.insertBefore(childElement, nextElement);\n\n      if (this.isInDocument()) {\n        child.enterDocument();\n      }\n\n      if (!nextNode) {\n        if (prevNode) {\n          prevNode.updateExpandIcon();\n        } else {\n          goog.style.setElementShown(el, true);\n          this.setExpanded(this.getExpanded());\n        }\n      }\n    }\n  }\n};\n\n\n/**\n * Adds a node as a child to the current node.\n * @param {goog.ui.tree.BaseNode} child The child to add.\n * @param {goog.ui.tree.BaseNode=} opt_before If specified, the new child is\n *    added as a child before this one. If not specified, it's appended to the\n *    end.\n * @return {!goog.ui.tree.BaseNode} The added child.\n */\ngoog.ui.tree.BaseNode.prototype.add = function(child, opt_before) {\n  goog.asserts.assert(\n      !opt_before || opt_before.getParent() == this,\n      'Can only add nodes before siblings');\n  if (child.getParent()) {\n    child.getParent().removeChild(child);\n  }\n  this.addChildAt(\n      child, opt_before ? this.indexOfChild(opt_before) : this.getChildCount());\n  return child;\n};\n\n\n/**\n * Removes a child. The caller is responsible for disposing the node.\n * @param {goog.ui.Component|string} childNode The child to remove. Must be a\n *     {@link goog.ui.tree.BaseNode}.\n * @param {boolean=} opt_unrender Unused. The child will always be unrendered.\n * @return {!goog.ui.tree.BaseNode} The child that was removed.\n * @override\n */\ngoog.ui.tree.BaseNode.prototype.removeChild = function(\n    childNode, opt_unrender) {\n  // In reality, this only accepts BaseNodes.\n  var child = /** @type {goog.ui.tree.BaseNode} */ (childNode);\n\n  // if we remove selected or tree with the selected we should select this\n  var tree = this.getTree();\n  var selectedNode = tree ? tree.getSelectedItem() : null;\n  if (selectedNode == child || child.contains(selectedNode)) {\n    if (tree.hasFocus()) {\n      this.select();\n      goog.Timer.callOnce(this.onTimeoutSelect_, 10, this);\n    } else {\n      this.select();\n    }\n  }\n\n  goog.ui.tree.BaseNode.superClass_.removeChild.call(this, child);\n\n  if (this.lastChild_ == child) {\n    this.lastChild_ = child.previousSibling_;\n  }\n  if (this.firstChild_ == child) {\n    this.firstChild_ = child.nextSibling_;\n  }\n  if (child.previousSibling_) {\n    child.previousSibling_.nextSibling_ = child.nextSibling_;\n  }\n  if (child.nextSibling_) {\n    child.nextSibling_.previousSibling_ = child.previousSibling_;\n  }\n\n  var wasLast = child.isLastSibling();\n\n  child.tree = null;\n  child.depth_ = -1;\n\n  if (tree) {\n    // Tell the tree control that the child node is now removed.\n    tree.removeNode(child);\n\n    if (this.isInDocument()) {\n      var el = this.getChildrenElement();\n\n      if (child.isInDocument()) {\n        var childEl = child.getElement();\n        el.removeChild(childEl);\n\n        child.exitDocument();\n      }\n\n      if (wasLast) {\n        var newLast = this.getLastChild();\n        if (newLast) {\n          newLast.updateExpandIcon();\n        }\n      }\n      if (!this.hasChildren()) {\n        el.style.display = 'none';\n        this.updateExpandIcon();\n        this.updateIcon_();\n      }\n    }\n  }\n\n  return child;\n};\n\n\n/**\n * @deprecated Use {@link #removeChild}.\n */\ngoog.ui.tree.BaseNode.prototype.remove =\n    goog.ui.tree.BaseNode.prototype.removeChild;\n\n\n/**\n * Handler for setting focus asynchronously.\n * @private\n */\ngoog.ui.tree.BaseNode.prototype.onTimeoutSelect_ = function() {\n  this.select();\n};\n\n\n/**\n * Returns the tree.\n * @return {?goog.ui.tree.TreeControl}\n */\ngoog.ui.tree.BaseNode.prototype.getTree = goog.abstractMethod;\n\n\n/**\n * Returns the depth of the node in the tree. Should not be overridden.\n * @return {number} The non-negative depth of this node (the root is zero).\n */\ngoog.ui.tree.BaseNode.prototype.getDepth = function() {\n  var depth = this.depth_;\n  if (depth < 0) {\n    depth = this.computeDepth_();\n    this.setDepth_(depth);\n  }\n  return depth;\n};\n\n\n/**\n * Computes the depth of the node in the tree.\n * Called only by getDepth, when the depth hasn't already been cached.\n * @return {number} The non-negative depth of this node (the root is zero).\n * @private\n */\ngoog.ui.tree.BaseNode.prototype.computeDepth_ = function() {\n  var parent = this.getParent();\n  if (parent) {\n    return parent.getDepth() + 1;\n  } else {\n    return 0;\n  }\n};\n\n\n/**\n * Changes the depth of a node (and all its descendants).\n * @param {number} depth The new nesting depth; must be non-negative.\n * @private\n */\ngoog.ui.tree.BaseNode.prototype.setDepth_ = function(depth) {\n  if (depth != this.depth_) {\n    this.depth_ = depth;\n    var row = this.getRowElement();\n    if (row) {\n      var indent = this.getPixelIndent_() + 'px';\n      if (this.isRightToLeft()) {\n        row.style.paddingRight = indent;\n      } else {\n        row.style.paddingLeft = indent;\n      }\n    }\n    this.forEachChild(function(child) { child.setDepth_(depth + 1); });\n  }\n};\n\n\n/**\n * Returns true if the node is a descendant of this node\n * @param {goog.ui.tree.BaseNode} node The node to check.\n * @return {boolean} True if the node is a descendant of this node, false\n *    otherwise.\n */\ngoog.ui.tree.BaseNode.prototype.contains = function(node) {\n  var current = node;\n  while (current) {\n    if (current == this) {\n      return true;\n    }\n    current = current.getParent();\n  }\n  return false;\n};\n\n\n/**\n * An array of empty children to return for nodes that have no children.\n * @type {!Array<!goog.ui.tree.BaseNode>}\n * @private\n */\ngoog.ui.tree.BaseNode.EMPTY_CHILDREN_ = [];\n\n\n/**\n * @param {number} index 0-based index.\n * @return {goog.ui.tree.BaseNode} The child at the given index; null if none.\n */\ngoog.ui.tree.BaseNode.prototype.getChildAt;\n\n\n/**\n * Returns the children of this node.\n * @return {!Array<!goog.ui.tree.BaseNode>} The children.\n */\ngoog.ui.tree.BaseNode.prototype.getChildren = function() {\n  var children = [];\n  this.forEachChild(function(child) { children.push(child); });\n  return children;\n};\n\n\n/**\n * @return {goog.ui.tree.BaseNode} The first child of this node.\n */\ngoog.ui.tree.BaseNode.prototype.getFirstChild = function() {\n  return this.getChildAt(0);\n};\n\n\n/**\n * @return {goog.ui.tree.BaseNode} The last child of this node.\n */\ngoog.ui.tree.BaseNode.prototype.getLastChild = function() {\n  return this.getChildAt(this.getChildCount() - 1);\n};\n\n\n/**\n * @return {goog.ui.tree.BaseNode} The previous sibling of this node.\n */\ngoog.ui.tree.BaseNode.prototype.getPreviousSibling = function() {\n  return this.previousSibling_;\n};\n\n\n/**\n * @return {goog.ui.tree.BaseNode} The next sibling of this node.\n */\ngoog.ui.tree.BaseNode.prototype.getNextSibling = function() {\n  return this.nextSibling_;\n};\n\n\n/**\n * @return {boolean} Whether the node is the last sibling.\n */\ngoog.ui.tree.BaseNode.prototype.isLastSibling = function() {\n  return !this.nextSibling_;\n};\n\n\n/**\n * @return {boolean} Whether the node is selected.\n */\ngoog.ui.tree.BaseNode.prototype.isSelected = function() {\n  return this.selected_;\n};\n\n\n/**\n * Selects the node.\n */\ngoog.ui.tree.BaseNode.prototype.select = function() {\n  var tree = this.getTree();\n  if (tree) {\n    tree.setSelectedItem(this);\n  }\n};\n\n\n/**\n * Originally it was intended to deselect the node but never worked.\n * @deprecated Use {@code tree.setSelectedItem(null)}.\n */\ngoog.ui.tree.BaseNode.prototype.deselect = goog.nullFunction;\n\n\n/**\n * Called from the tree to instruct the node change its selection state.\n * @param {boolean} selected The new selection state.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.setSelectedInternal = function(selected) {\n  if (this.selected_ == selected) {\n    return;\n  }\n  this.selected_ = selected;\n\n  this.updateRow();\n\n  var el = this.getElement();\n  if (el) {\n    goog.a11y.aria.setState(el, 'selected', selected);\n    if (selected) {\n      var treeElement = this.getTree().getElement();\n      goog.asserts.assert(\n          treeElement, 'The DOM element for the tree cannot be null');\n      goog.a11y.aria.setState(treeElement, 'activedescendant', this.getId());\n    }\n  }\n};\n\n\n/**\n * @return {boolean} Whether the node is expanded.\n */\ngoog.ui.tree.BaseNode.prototype.getExpanded = function() {\n  return this.expanded_;\n};\n\n\n/**\n * Sets the node to be expanded internally, without state change events.\n * @param {boolean} expanded Whether to expand or close the node.\n */\ngoog.ui.tree.BaseNode.prototype.setExpandedInternal = function(expanded) {\n  this.expanded_ = expanded;\n};\n\n\n/**\n * Sets the node to be expanded.\n * @param {boolean} expanded Whether to expand or close the node.\n */\ngoog.ui.tree.BaseNode.prototype.setExpanded = function(expanded) {\n  var isStateChange = expanded != this.expanded_;\n  if (isStateChange) {\n    // Only fire events if the expanded state has actually changed.\n    var prevented = !this.dispatchEvent(\n        expanded ? goog.ui.tree.BaseNode.EventType.BEFORE_EXPAND :\n                   goog.ui.tree.BaseNode.EventType.BEFORE_COLLAPSE);\n    if (prevented) return;\n  }\n  var ce;\n  this.expanded_ = expanded;\n  var tree = this.getTree();\n  var el = this.getElement();\n\n  if (this.hasChildren()) {\n    if (!expanded && tree && this.contains(tree.getSelectedItem())) {\n      this.select();\n    }\n\n    if (el) {\n      ce = this.getChildrenElement();\n      if (ce) {\n        goog.style.setElementShown(ce, expanded);\n\n        // Make sure we have the HTML for the children here.\n        if (expanded && this.isInDocument() && !ce.hasChildNodes()) {\n          var children = [];\n          this.forEachChild(function(child) {\n            children.push(child.toSafeHtml());\n          });\n          goog.dom.safe.setInnerHtml(ce, goog.html.SafeHtml.concat(children));\n          this.forEachChild(function(child) { child.enterDocument(); });\n        }\n      }\n      this.updateExpandIcon();\n    }\n  } else {\n    ce = this.getChildrenElement();\n    if (ce) {\n      goog.style.setElementShown(ce, false);\n    }\n  }\n  if (el) {\n    this.updateIcon_();\n    goog.a11y.aria.setState(el, 'expanded', expanded);\n  }\n\n  if (isStateChange) {\n    this.dispatchEvent(\n        expanded ? goog.ui.tree.BaseNode.EventType.EXPAND :\n                   goog.ui.tree.BaseNode.EventType.COLLAPSE);\n  }\n};\n\n\n/**\n * Toggles the expanded state of the node.\n */\ngoog.ui.tree.BaseNode.prototype.toggle = function() {\n  this.setExpanded(!this.getExpanded());\n};\n\n\n/**\n * Expands the node.\n */\ngoog.ui.tree.BaseNode.prototype.expand = function() {\n  this.setExpanded(true);\n};\n\n\n/**\n * Collapses the node.\n */\ngoog.ui.tree.BaseNode.prototype.collapse = function() {\n  this.setExpanded(false);\n};\n\n\n/**\n * Collapses the children of the node.\n */\ngoog.ui.tree.BaseNode.prototype.collapseChildren = function() {\n  this.forEachChild(function(child) { child.collapseAll(); });\n};\n\n\n/**\n * Collapses the children and the node.\n */\ngoog.ui.tree.BaseNode.prototype.collapseAll = function() {\n  this.collapseChildren();\n  this.collapse();\n};\n\n\n/**\n * Expands the children of the node.\n */\ngoog.ui.tree.BaseNode.prototype.expandChildren = function() {\n  this.forEachChild(function(child) { child.expandAll(); });\n};\n\n\n/**\n * Expands the children and the node.\n */\ngoog.ui.tree.BaseNode.prototype.expandAll = function() {\n  this.expandChildren();\n  this.expand();\n};\n\n\n/**\n * Expands the parent chain of this node so that it is visible.\n */\ngoog.ui.tree.BaseNode.prototype.reveal = function() {\n  var parent = this.getParent();\n  if (parent) {\n    parent.setExpanded(true);\n    parent.reveal();\n  }\n};\n\n\n/**\n * Sets whether the node will allow the user to collapse it.\n * @param {boolean} isCollapsible Whether to allow node collapse.\n */\ngoog.ui.tree.BaseNode.prototype.setIsUserCollapsible = function(isCollapsible) {\n  this.isUserCollapsible_ = isCollapsible;\n  if (!this.isUserCollapsible_) {\n    this.expand();\n  }\n  if (this.getElement()) {\n    this.updateExpandIcon();\n  }\n};\n\n\n/**\n * @return {boolean} Whether the node is collapsible by user actions.\n */\ngoog.ui.tree.BaseNode.prototype.isUserCollapsible = function() {\n  return this.isUserCollapsible_;\n};\n\n\n/**\n * Creates HTML for the node.\n * @return {!goog.html.SafeHtml}\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.toSafeHtml = function() {\n  var tree = this.getTree();\n  var hideLines = !tree.getShowLines() ||\n      tree == this.getParent() && !tree.getShowRootLines();\n\n  var childClass =\n      hideLines ? this.config_.cssChildrenNoLines : this.config_.cssChildren;\n\n  var nonEmptyAndExpanded = this.getExpanded() && this.hasChildren();\n\n  var attributes = {'class': childClass, 'style': this.getLineStyle()};\n\n  var content = [];\n  if (nonEmptyAndExpanded) {\n    // children\n    this.forEachChild(function(child) { content.push(child.toSafeHtml()); });\n  }\n\n  var children = goog.html.SafeHtml.create('div', attributes, content);\n\n  return goog.html.SafeHtml.create(\n      'div', {'class': this.config_.cssItem, 'id': this.getId()},\n      [this.getRowSafeHtml(), children]);\n};\n\n\n/**\n * @return {number} The pixel indent of the row.\n * @private\n */\ngoog.ui.tree.BaseNode.prototype.getPixelIndent_ = function() {\n  return Math.max(0, (this.getDepth() - 1) * this.config_.indentWidth);\n};\n\n\n/**\n * @return {!goog.html.SafeHtml} The html for the row.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.getRowSafeHtml = function() {\n  var style = {};\n  style['padding-' + (this.isRightToLeft() ? 'right' : 'left')] =\n      this.getPixelIndent_() + 'px';\n  var attributes = {'class': this.getRowClassName(), 'style': style};\n  var content = [\n    this.getExpandIconSafeHtml(), this.getIconSafeHtml(),\n    this.getLabelSafeHtml()\n  ];\n  return goog.html.SafeHtml.create('div', attributes, content);\n};\n\n\n/**\n * @return {string} The class name for the row.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.getRowClassName = function() {\n  var selectedClass;\n  if (this.isSelected()) {\n    selectedClass = ' ' + this.config_.cssSelectedRow;\n  } else {\n    selectedClass = '';\n  }\n  return this.config_.cssTreeRow + selectedClass;\n};\n\n\n/**\n * @return {!goog.html.SafeHtml} The html for the label.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.getLabelSafeHtml = function() {\n  var html = goog.html.SafeHtml.create(\n      'span',\n      {'class': this.config_.cssItemLabel, 'title': this.getToolTip() || null},\n      this.getSafeHtml());\n  return goog.html.SafeHtml.concat(\n      html,\n      goog.html.SafeHtml.create('span', {}, this.getAfterLabelSafeHtml()));\n};\n\n\n/**\n * Returns the html that appears after the label. This is useful if you want to\n * put extra UI on the row of the label but not inside the anchor tag.\n * @return {string} The html.\n * @final\n */\ngoog.ui.tree.BaseNode.prototype.getAfterLabelHtml = function() {\n  return goog.html.SafeHtml.unwrap(this.getAfterLabelSafeHtml());\n};\n\n\n/**\n * Returns the html that appears after the label. This is useful if you want to\n * put extra UI on the row of the label but not inside the anchor tag.\n * @return {!goog.html.SafeHtml} The html.\n */\ngoog.ui.tree.BaseNode.prototype.getAfterLabelSafeHtml = function() {\n  return this.afterLabelHtml_;\n};\n\n\n/**\n * Sets the html that appears after the label. This is useful if you want to\n * put extra UI on the row of the label but not inside the anchor tag.\n * @param {!goog.html.SafeHtml} html The html.\n */\ngoog.ui.tree.BaseNode.prototype.setAfterLabelSafeHtml = function(html) {\n  this.afterLabelHtml_ = html;\n  var el = this.getAfterLabelElement();\n  if (el) {\n    goog.dom.safe.setInnerHtml(el, html);\n  }\n};\n\n\n/**\n * @return {!goog.html.SafeHtml} The html for the icon.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.getIconSafeHtml = function() {\n  return goog.html.SafeHtml.create('span', {\n    'style': {'display': 'inline-block'},\n    'class': this.getCalculatedIconClass()\n  });\n};\n\n\n/**\n * Gets the calculated icon class.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.getCalculatedIconClass = goog.abstractMethod;\n\n\n/**\n * @return {!goog.html.SafeHtml} The source for the icon.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.getExpandIconSafeHtml = function() {\n  return goog.html.SafeHtml.create('span', {\n    'type': 'expand',\n    'style': {'display': 'inline-block'},\n    'class': this.getExpandIconClass()\n  });\n};\n\n\n/**\n * @return {string} The class names of the icon used for expanding the node.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.getExpandIconClass = function() {\n  var tree = this.getTree();\n  var hideLines = !tree.getShowLines() ||\n      tree == this.getParent() && !tree.getShowRootLines();\n\n  var config = this.config_;\n  var sb = new goog.string.StringBuffer();\n  sb.append(config.cssTreeIcon, ' ', config.cssExpandTreeIcon, ' ');\n\n  if (this.hasChildren()) {\n    var bits = 0;\n    /*\n      Bitmap used to determine which icon to use\n      1  Plus\n      2  Minus\n      4  T Line\n      8  L Line\n    */\n\n    if (tree.getShowExpandIcons() && this.isUserCollapsible_) {\n      if (this.getExpanded()) {\n        bits = 2;\n      } else {\n        bits = 1;\n      }\n    }\n\n    if (!hideLines) {\n      if (this.isLastSibling()) {\n        bits += 4;\n      } else {\n        bits += 8;\n      }\n    }\n\n    switch (bits) {\n      case 1:\n        sb.append(config.cssExpandTreeIconPlus);\n        break;\n      case 2:\n        sb.append(config.cssExpandTreeIconMinus);\n        break;\n      case 4:\n        sb.append(config.cssExpandTreeIconL);\n        break;\n      case 5:\n        sb.append(config.cssExpandTreeIconLPlus);\n        break;\n      case 6:\n        sb.append(config.cssExpandTreeIconLMinus);\n        break;\n      case 8:\n        sb.append(config.cssExpandTreeIconT);\n        break;\n      case 9:\n        sb.append(config.cssExpandTreeIconTPlus);\n        break;\n      case 10:\n        sb.append(config.cssExpandTreeIconTMinus);\n        break;\n      default:  // 0\n        sb.append(config.cssExpandTreeIconBlank);\n    }\n  } else {\n    if (hideLines) {\n      sb.append(config.cssExpandTreeIconBlank);\n    } else if (this.isLastSibling()) {\n      sb.append(config.cssExpandTreeIconL);\n    } else {\n      sb.append(config.cssExpandTreeIconT);\n    }\n  }\n  return sb.toString();\n};\n\n\n/**\n * @return {!goog.html.SafeStyle} The line style.\n */\ngoog.ui.tree.BaseNode.prototype.getLineStyle = function() {\n  var nonEmptyAndExpanded = this.getExpanded() && this.hasChildren();\n  return goog.html.SafeStyle.create({\n    'background-position': this.getBackgroundPosition(),\n    'display': nonEmptyAndExpanded ? null : 'none'\n  });\n};\n\n\n/**\n * @return {string} The background position style value.\n */\ngoog.ui.tree.BaseNode.prototype.getBackgroundPosition = function() {\n  return (this.isLastSibling() ? '-100' : (this.getDepth() - 1) *\n                  this.config_.indentWidth) +\n      'px 0';\n};\n\n\n/**\n * @return {Element} The element for the tree node.\n * @override\n */\ngoog.ui.tree.BaseNode.prototype.getElement = function() {\n  var el = goog.ui.tree.BaseNode.superClass_.getElement.call(this);\n  if (!el) {\n    el = this.getDomHelper().getElement(this.getId());\n    this.setElementInternal(el);\n  }\n  return el;\n};\n\n\n/**\n * @return {Element} The row is the div that is used to draw the node without\n *     the children.\n */\ngoog.ui.tree.BaseNode.prototype.getRowElement = function() {\n  var el = this.getElement();\n  return el ? /** @type {Element} */ (el.firstChild) : null;\n};\n\n\n/**\n * @return {Element} The expanded icon element.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.getExpandIconElement = function() {\n  var el = this.getRowElement();\n  return el ? /** @type {Element} */ (el.firstChild) : null;\n};\n\n\n/**\n * @return {Element} The icon element.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.getIconElement = function() {\n  var el = this.getRowElement();\n  return el ? /** @type {Element} */ (el.childNodes[1]) : null;\n};\n\n\n/**\n * @return {Element} The label element.\n */\ngoog.ui.tree.BaseNode.prototype.getLabelElement = function() {\n  var el = this.getRowElement();\n  // TODO: find/fix race condition that requires us to add\n  // the lastChild check\n  return el && el.lastChild ?\n      /** @type {Element} */ (el.lastChild.previousSibling) :\n                             null;\n};\n\n\n/**\n * @return {Element} The element after the label.\n */\ngoog.ui.tree.BaseNode.prototype.getAfterLabelElement = function() {\n  var el = this.getRowElement();\n  return el ? /** @type {Element} */ (el.lastChild) : null;\n};\n\n\n/**\n * @return {Element} The div containing the children.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.getChildrenElement = function() {\n  var el = this.getElement();\n  return el ? /** @type {Element} */ (el.lastChild) : null;\n};\n\n\n/**\n * Sets the icon class for the node.\n * @param {string} s The icon class.\n */\ngoog.ui.tree.BaseNode.prototype.setIconClass = function(s) {\n  this.iconClass_ = s;\n  if (this.isInDocument()) {\n    this.updateIcon_();\n  }\n};\n\n\n/**\n * Gets the icon class for the node.\n * @return {string} s The icon source.\n */\ngoog.ui.tree.BaseNode.prototype.getIconClass = function() {\n  return this.iconClass_;\n};\n\n\n/**\n * Sets the icon class for when the node is expanded.\n * @param {string} s The expanded icon class.\n */\ngoog.ui.tree.BaseNode.prototype.setExpandedIconClass = function(s) {\n  this.expandedIconClass_ = s;\n  if (this.isInDocument()) {\n    this.updateIcon_();\n  }\n};\n\n\n/**\n * Gets the icon class for when the node is expanded.\n * @return {string} The class.\n */\ngoog.ui.tree.BaseNode.prototype.getExpandedIconClass = function() {\n  return this.expandedIconClass_;\n};\n\n\n/**\n * Sets the text of the label.\n * @param {string} s The plain text of the label.\n */\ngoog.ui.tree.BaseNode.prototype.setText = function(s) {\n  this.setSafeHtml(goog.html.SafeHtml.htmlEscape(s));\n};\n\n\n/**\n * Returns the text of the label. If the text was originally set as HTML, the\n * return value is unspecified.\n * @return {string} The plain text of the label.\n */\ngoog.ui.tree.BaseNode.prototype.getText = function() {\n  return goog.string.unescapeEntities(goog.html.SafeHtml.unwrap(this.html_));\n};\n\n\n/**\n * Sets the HTML of the label.\n * @param {!goog.html.SafeHtml} html The HTML object for the label.\n */\ngoog.ui.tree.BaseNode.prototype.setSafeHtml = function(html) {\n  this.html_ = html;\n  var el = this.getLabelElement();\n  if (el) {\n    goog.dom.safe.setInnerHtml(el, html);\n  }\n  var tree = this.getTree();\n  if (tree) {\n    // Tell the tree control about the updated label text.\n    tree.setNode(this);\n  }\n};\n\n\n/**\n * Returns the html of the label.\n * @return {string} The html string of the label.\n * @final\n */\ngoog.ui.tree.BaseNode.prototype.getHtml = function() {\n  return goog.html.SafeHtml.unwrap(this.getSafeHtml());\n};\n\n\n/**\n * Returns the html of the label.\n * @return {!goog.html.SafeHtml} The html string of the label.\n */\ngoog.ui.tree.BaseNode.prototype.getSafeHtml = function() {\n  return this.html_;\n};\n\n\n/**\n * Sets the text of the tooltip.\n * @param {string} s The tooltip text to set.\n */\ngoog.ui.tree.BaseNode.prototype.setToolTip = function(s) {\n  this.toolTip_ = s;\n  var el = this.getLabelElement();\n  if (el) {\n    el.title = s;\n  }\n};\n\n\n/**\n * Returns the text of the tooltip.\n * @return {?string} The tooltip text.\n */\ngoog.ui.tree.BaseNode.prototype.getToolTip = function() {\n  return this.toolTip_;\n};\n\n\n/**\n * Updates the row styles.\n */\ngoog.ui.tree.BaseNode.prototype.updateRow = function() {\n  var rowEl = this.getRowElement();\n  if (rowEl) {\n    rowEl.className = this.getRowClassName();\n  }\n};\n\n\n/**\n * Updates the expand icon of the node.\n */\ngoog.ui.tree.BaseNode.prototype.updateExpandIcon = function() {\n  var img = this.getExpandIconElement();\n  if (img) {\n    img.className = this.getExpandIconClass();\n  }\n  var cel = this.getChildrenElement();\n  if (cel) {\n    cel.style.backgroundPosition = this.getBackgroundPosition();\n  }\n};\n\n\n/**\n * Updates the icon of the node. Assumes that this.getElement() is created.\n * @private\n */\ngoog.ui.tree.BaseNode.prototype.updateIcon_ = function() {\n  this.getIconElement().className = this.getCalculatedIconClass();\n};\n\n\n/**\n * Handles mouse down event.\n * @param {!goog.events.BrowserEvent} e The browser event.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.onMouseDown = function(e) {\n  var el = e.target;\n  // expand icon\n  var type = el.getAttribute('type');\n  if (type == 'expand' && this.hasChildren()) {\n    if (this.isUserCollapsible_) {\n      this.toggle();\n    }\n    return;\n  }\n\n  this.select();\n  this.updateRow();\n};\n\n\n/**\n * Handles a click event.\n * @param {!goog.events.BrowserEvent} e The browser event.\n * @protected\n * @suppress {underscore|visibility}\n */\ngoog.ui.tree.BaseNode.prototype.onClick_ = goog.events.Event.preventDefault;\n\n\n/**\n * Handles a double click event.\n * @param {!goog.events.BrowserEvent} e The browser event.\n * @protected\n * @suppress {underscore|visibility}\n */\ngoog.ui.tree.BaseNode.prototype.onDoubleClick_ = function(e) {\n  var el = e.target;\n  // expand icon\n  var type = el.getAttribute('type');\n  if (type == 'expand' && this.hasChildren()) {\n    return;\n  }\n\n  if (this.isUserCollapsible_) {\n    this.toggle();\n  }\n};\n\n\n/**\n * Handles a key down event.\n * @param {!goog.events.BrowserEvent} e The browser event.\n * @return {boolean} The handled value.\n * @protected\n */\ngoog.ui.tree.BaseNode.prototype.onKeyDown = function(e) {\n  var handled = true;\n  switch (e.keyCode) {\n    case goog.events.KeyCodes.RIGHT:\n      if (e.altKey) {\n        break;\n      }\n      if (this.hasChildren()) {\n        if (!this.getExpanded()) {\n          this.setExpanded(true);\n        } else {\n          this.getFirstChild().select();\n        }\n      }\n      break;\n\n    case goog.events.KeyCodes.LEFT:\n      if (e.altKey) {\n        break;\n      }\n      if (this.hasChildren() && this.getExpanded() && this.isUserCollapsible_) {\n        this.setExpanded(false);\n      } else {\n        var parent = this.getParent();\n        var tree = this.getTree();\n        // don't go to root if hidden\n        if (parent && (tree.getShowRootNode() || parent != tree)) {\n          parent.select();\n        }\n      }\n      break;\n\n    case goog.events.KeyCodes.DOWN:\n      var nextNode = this.getNextShownNode();\n      if (nextNode) {\n        nextNode.select();\n      }\n      break;\n\n    case goog.events.KeyCodes.UP:\n      var previousNode = this.getPreviousShownNode();\n      if (previousNode) {\n        previousNode.select();\n      }\n      break;\n\n    default:\n      handled = false;\n  }\n\n  if (handled) {\n    e.preventDefault();\n    var tree = this.getTree();\n    if (tree) {\n      // clear type ahead buffer as user navigates with arrow keys\n      tree.clearTypeAhead();\n    }\n  }\n\n  return handled;\n};\n\n\n\n/**\n * @return {goog.ui.tree.BaseNode} The last shown descendant.\n */\ngoog.ui.tree.BaseNode.prototype.getLastShownDescendant = function() {\n  if (!this.getExpanded() || !this.hasChildren()) {\n    return this;\n  }\n  // we know there is at least 1 child\n  return this.getLastChild().getLastShownDescendant();\n};\n\n\n/**\n * @return {goog.ui.tree.BaseNode} The next node to show or null if there isn't\n *     a next node to show.\n */\ngoog.ui.tree.BaseNode.prototype.getNextShownNode = function() {\n  if (this.hasChildren() && this.getExpanded()) {\n    return this.getFirstChild();\n  } else {\n    var parent = this;\n    var next;\n    while (parent != this.getTree()) {\n      next = parent.getNextSibling();\n      if (next != null) {\n        return next;\n      }\n      parent = parent.getParent();\n    }\n    return null;\n  }\n};\n\n\n/**\n * @return {goog.ui.tree.BaseNode} The previous node to show.\n */\ngoog.ui.tree.BaseNode.prototype.getPreviousShownNode = function() {\n  var ps = this.getPreviousSibling();\n  if (ps != null) {\n    return ps.getLastShownDescendant();\n  }\n  var parent = this.getParent();\n  var tree = this.getTree();\n  if (!tree.getShowRootNode() && parent == tree) {\n    return null;\n  }\n  // The root is the first node.\n  if (this == tree) {\n    return null;\n  }\n  return /** @type {goog.ui.tree.BaseNode} */ (parent);\n};\n\n\n/**\n * @return {*} Data set by the client.\n * @deprecated Use {@link #getModel} instead.\n */\ngoog.ui.tree.BaseNode.prototype.getClientData =\n    goog.ui.tree.BaseNode.prototype.getModel;\n\n\n/**\n * Sets client data to associate with the node.\n * @param {*} data The client data to associate with the node.\n * @deprecated Use {@link #setModel} instead.\n */\ngoog.ui.tree.BaseNode.prototype.setClientData =\n    goog.ui.tree.BaseNode.prototype.setModel;\n\n\n/**\n * @return {Object} The configuration for the tree.\n */\ngoog.ui.tree.BaseNode.prototype.getConfig = function() {\n  return this.config_;\n};\n\n\n/**\n * Internal method that is used to set the tree control on the node.\n * @param {goog.ui.tree.TreeControl} tree The tree control.\n */\ngoog.ui.tree.BaseNode.prototype.setTreeInternal = function(tree) {\n  if (this.tree != tree) {\n    this.tree = tree;\n    // Add new node to the type ahead node map.\n    tree.setNode(this);\n    this.forEachChild(function(child) { child.setTreeInternal(tree); });\n  }\n};\n\n\n/**\n * A default configuration for the tree.\n */\ngoog.ui.tree.BaseNode.defaultConfig = {\n  indentWidth: 19,\n  cssRoot: goog.getCssName('goog-tree-root') + ' ' +\n      goog.getCssName('goog-tree-item'),\n  cssHideRoot: goog.getCssName('goog-tree-hide-root'),\n  cssItem: goog.getCssName('goog-tree-item'),\n  cssChildren: goog.getCssName('goog-tree-children'),\n  cssChildrenNoLines: goog.getCssName('goog-tree-children-nolines'),\n  cssTreeRow: goog.getCssName('goog-tree-row'),\n  cssItemLabel: goog.getCssName('goog-tree-item-label'),\n  cssTreeIcon: goog.getCssName('goog-tree-icon'),\n  cssExpandTreeIcon: goog.getCssName('goog-tree-expand-icon'),\n  cssExpandTreeIconPlus: goog.getCssName('goog-tree-expand-icon-plus'),\n  cssExpandTreeIconMinus: goog.getCssName('goog-tree-expand-icon-minus'),\n  cssExpandTreeIconTPlus: goog.getCssName('goog-tree-expand-icon-tplus'),\n  cssExpandTreeIconTMinus: goog.getCssName('goog-tree-expand-icon-tminus'),\n  cssExpandTreeIconLPlus: goog.getCssName('goog-tree-expand-icon-lplus'),\n  cssExpandTreeIconLMinus: goog.getCssName('goog-tree-expand-icon-lminus'),\n  cssExpandTreeIconT: goog.getCssName('goog-tree-expand-icon-t'),\n  cssExpandTreeIconL: goog.getCssName('goog-tree-expand-icon-l'),\n  cssExpandTreeIconBlank: goog.getCssName('goog-tree-expand-icon-blank'),\n  cssExpandedFolderIcon: goog.getCssName('goog-tree-expanded-folder-icon'),\n  cssCollapsedFolderIcon: goog.getCssName('goog-tree-collapsed-folder-icon'),\n  cssFileIcon: goog.getCssName('goog-tree-file-icon'),\n  cssExpandedRootIcon: goog.getCssName('goog-tree-expanded-folder-icon'),\n  cssCollapsedRootIcon: goog.getCssName('goog-tree-collapsed-folder-icon'),\n  cssSelectedRow: goog.getCssName('selected')\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Definition of the goog.ui.tree.TreeNode class.\n *\n * @author arv@google.com (Erik Arvidsson)\n * @author eae@google.com (Emil A Eklund)\n *\n * This is a based on the webfx tree control. See file comment in\n * treecontrol.js.\n */\n\ngoog.provide('goog.ui.tree.TreeNode');\n\ngoog.require('goog.ui.tree.BaseNode');\n\n\n\n/**\n * A single node in the tree.\n * @param {string|!goog.html.SafeHtml} content The content of the node label.\n *     Strings are treated as plain-text and will be HTML escaped.\n * @param {Object=} opt_config The configuration for the tree. See\n *    goog.ui.tree.TreeControl.defaultConfig. If not specified, a default config\n *    will be used.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper.\n * @constructor\n * @extends {goog.ui.tree.BaseNode}\n */\ngoog.ui.tree.TreeNode = function(content, opt_config, opt_domHelper) {\n  goog.ui.tree.BaseNode.call(this, content, opt_config, opt_domHelper);\n};\ngoog.inherits(goog.ui.tree.TreeNode, goog.ui.tree.BaseNode);\n\n\n/**\n * Returns the tree.\n * @return {?goog.ui.tree.TreeControl} The tree.\n * @override\n */\ngoog.ui.tree.TreeNode.prototype.getTree = function() {\n  if (this.tree) {\n    return this.tree;\n  }\n  var parent = this.getParent();\n  if (parent) {\n    var tree = parent.getTree();\n    if (tree) {\n      this.setTreeInternal(tree);\n      return tree;\n    }\n  }\n  return null;\n};\n\n\n/**\n * Returns the source for the icon.\n * @return {string} Src for the icon.\n * @override\n */\ngoog.ui.tree.TreeNode.prototype.getCalculatedIconClass = function() {\n  var expanded = this.getExpanded();\n  var expandedIconClass = this.getExpandedIconClass();\n  if (expanded && expandedIconClass) {\n    return expandedIconClass;\n  }\n  var iconClass = this.getIconClass();\n  if (!expanded && iconClass) {\n    return iconClass;\n  }\n\n  // fall back on default icons\n  var config = this.getConfig();\n  if (this.hasChildren()) {\n    if (expanded && config.cssExpandedFolderIcon) {\n      return config.cssTreeIcon + ' ' + config.cssExpandedFolderIcon;\n    } else if (!expanded && config.cssCollapsedFolderIcon) {\n      return config.cssTreeIcon + ' ' + config.cssCollapsedFolderIcon;\n    }\n  } else {\n    if (config.cssFileIcon) {\n      return config.cssTreeIcon + ' ' + config.cssFileIcon;\n    }\n  }\n  return '';\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Datastructure: Trie.\n *\n *\n * This file provides the implementation of a trie data structure.  A trie is a\n * data structure that stores key/value pairs in a prefix tree.  See:\n *     http://en.wikipedia.org/wiki/Trie\n */\n\n\ngoog.provide('goog.structs.Trie');\n\ngoog.require('goog.object');\ngoog.require('goog.structs');\n\n\n\n/**\n * Class for a Trie datastructure.  Trie data structures are made out of trees\n * of Trie classes.\n *\n * @param {goog.structs.Trie<VALUE>|Object<string, VALUE>=} opt_trie Optional\n *     goog.structs.Trie or Object to initialize trie with.\n * @constructor\n * @template VALUE\n */\ngoog.structs.Trie = function(opt_trie) {\n  /**\n   * This trie's value.  For the base trie, this will be the value of the\n   * empty key, if defined.\n   * @private {VALUE}\n   */\n  this.value_ = undefined;\n\n  /**\n   * This trie's child nodes.\n   * @private {!Object<!goog.structs.Trie<VALUE>>}\n   */\n  this.childNodes_ = {};\n\n  if (opt_trie) {\n    this.setAll(opt_trie);\n  }\n};\n\n\n/**\n * Sets the given key/value pair in the trie.  O(L), where L is the length\n * of the key.\n * @param {string} key The key.\n * @param {VALUE} value The value.\n */\ngoog.structs.Trie.prototype.set = function(key, value) {\n  this.setOrAdd_(key, value, false);\n};\n\n\n/**\n * Adds the given key/value pair in the trie.  Throw an exception if the key\n * already exists in the trie.  O(L), where L is the length of the key.\n * @param {string} key The key.\n * @param {VALUE} value The value.\n */\ngoog.structs.Trie.prototype.add = function(key, value) {\n  this.setOrAdd_(key, value, true);\n};\n\n\n/**\n * Helper function for set and add.  Adds the given key/value pair to\n * the trie, or, if the key already exists, sets the value of the key. If\n * opt_add is true, then throws an exception if the key already has a value in\n * the trie.  O(L), where L is the length of the key.\n * @param {string} key The key.\n * @param {VALUE} value The value.\n * @param {boolean=} opt_add Throw exception if key is already in the trie.\n * @private\n */\ngoog.structs.Trie.prototype.setOrAdd_ = function(key, value, opt_add) {\n  var node = this;\n  for (var characterPosition = 0; characterPosition < key.length;\n       characterPosition++) {\n    var currentCharacter = key.charAt(characterPosition);\n    if (!node.childNodes_[currentCharacter]) {\n      node.childNodes_[currentCharacter] = new goog.structs.Trie();\n    }\n    node = node.childNodes_[currentCharacter];\n  }\n  if (opt_add && node.value_ !== undefined) {\n    throw Error('The collection already contains the key \"' + key + '\"');\n  } else {\n    node.value_ = value;\n  }\n};\n\n\n/**\n * Adds multiple key/value pairs from another goog.structs.Trie or Object.\n * O(N) where N is the number of nodes in the trie.\n * @param {!Object<string, VALUE>|!goog.structs.Trie<VALUE>} trie Object\n *     containing the data to add.\n */\ngoog.structs.Trie.prototype.setAll = function(trie) {\n  var keys = goog.structs.getKeys(trie);\n  var values = goog.structs.getValues(trie);\n\n  for (var i = 0; i < keys.length; i++) {\n    this.set(keys[i], values[i]);\n  }\n};\n\n\n/**\n * Traverse along the given path, returns the child node at ending.\n * Returns undefined if node for the path doesn't exist.\n * @param {string} path The path to traverse.\n * @return {!goog.structs.Trie<VALUE>|undefined}\n * @private\n */\ngoog.structs.Trie.prototype.getChildNode_ = function(path) {\n  var node = this;\n  for (var characterPosition = 0; characterPosition < path.length;\n       characterPosition++) {\n    var currentCharacter = path.charAt(characterPosition);\n    node = node.childNodes_[currentCharacter];\n    if (!node) {\n      return undefined;\n    }\n  }\n  return node;\n};\n\n\n/**\n * Retrieves a value from the trie given a key.  O(L), where L is the length of\n * the key.\n * @param {string} key The key to retrieve from the trie.\n * @return {VALUE|undefined} The value of the key in the trie, or undefined if\n *     the trie does not contain this key.\n */\ngoog.structs.Trie.prototype.get = function(key) {\n  var node = this.getChildNode_(key);\n  return node ? node.value_ : undefined;\n};\n\n\n/**\n * Retrieves all values from the trie that correspond to prefixes of the given\n * input key. O(L), where L is the length of the key.\n *\n * @param {string} key The key to use for lookup. The given key as well as all\n *     prefixes of the key are retrieved.\n * @param {?number=} opt_keyStartIndex Optional position in key to start lookup\n *     from. Defaults to 0 if not specified.\n * @return {!Object<string, VALUE>} Map of end index of matching prefixes and\n *     corresponding values. Empty if no match found.\n */\ngoog.structs.Trie.prototype.getKeyAndPrefixes = function(\n    key, opt_keyStartIndex) {\n  var node = this;\n  var matches = {};\n  var characterPosition = opt_keyStartIndex || 0;\n\n  if (node.value_ !== undefined) {\n    matches[characterPosition] = node.value_;\n  }\n\n  for (; characterPosition < key.length; characterPosition++) {\n    var currentCharacter = key.charAt(characterPosition);\n    if (!(currentCharacter in node.childNodes_)) {\n      break;\n    }\n    node = node.childNodes_[currentCharacter];\n    if (node.value_ !== undefined) {\n      matches[characterPosition] = node.value_;\n    }\n  }\n\n  return matches;\n};\n\n\n/**\n * Gets the values of the trie.  Not returned in any reliable order.  O(N) where\n * N is the number of nodes in the trie.  Calls getValuesInternal_.\n * @return {!Array<VALUE>} The values in the trie.\n */\ngoog.structs.Trie.prototype.getValues = function() {\n  var allValues = [];\n  this.getValuesInternal_(allValues);\n  return allValues;\n};\n\n\n/**\n * Gets the values of the trie.  Not returned in any reliable order.  O(N) where\n * N is the number of nodes in the trie.  Builds the values as it goes.\n * @param {!Array<VALUE>} allValues Array to place values into.\n * @private\n */\ngoog.structs.Trie.prototype.getValuesInternal_ = function(allValues) {\n  if (this.value_ !== undefined) {\n    allValues.push(this.value_);\n  }\n  for (var childNode in this.childNodes_) {\n    this.childNodes_[childNode].getValuesInternal_(allValues);\n  }\n};\n\n\n/**\n * Gets the keys of the trie.  Not returned in any reliable order.  O(N) where\n * N is the number of nodes in the trie (or prefix subtree).\n * @param {string=} opt_prefix Find only keys with this optional prefix.\n * @return {!Array<string>} The keys in the trie.\n */\ngoog.structs.Trie.prototype.getKeys = function(opt_prefix) {\n  var allKeys = [];\n  if (opt_prefix) {\n    // Traverse to the given prefix, then call getKeysInternal_ to dump the\n    // keys below that point.\n    var node = this;\n    for (var characterPosition = 0; characterPosition < opt_prefix.length;\n         characterPosition++) {\n      var currentCharacter = opt_prefix.charAt(characterPosition);\n      if (!node.childNodes_[currentCharacter]) {\n        return [];\n      }\n      node = node.childNodes_[currentCharacter];\n    }\n    node.getKeysInternal_(opt_prefix, allKeys);\n  } else {\n    this.getKeysInternal_('', allKeys);\n  }\n  return allKeys;\n};\n\n\n/**\n * Private method to get keys from the trie.  Builds the keys as it goes.\n * @param {string} keySoFar The partial key (prefix) traversed so far.\n * @param {!Array<string>} allKeys The partially built array of keys seen so\n *     far.\n * @private\n */\ngoog.structs.Trie.prototype.getKeysInternal_ = function(keySoFar, allKeys) {\n  if (this.value_ !== undefined) {\n    allKeys.push(keySoFar);\n  }\n  for (var childNode in this.childNodes_) {\n    this.childNodes_[childNode].getKeysInternal_(keySoFar + childNode, allKeys);\n  }\n};\n\n\n/**\n * Checks to see if a certain key is in the trie.  O(L), where L is the length\n * of the key.\n * @param {string} key A key that may be in the trie.\n * @return {boolean} Whether the trie contains key.\n */\ngoog.structs.Trie.prototype.containsKey = function(key) {\n  return this.get(key) !== undefined;\n};\n\n\n/**\n * Checks to see if a certain prefix is in the trie. O(L), where L is the length\n * of the prefix.\n * @param {string} prefix A prefix that may be in the trie.\n * @return {boolean} Whether any key of the trie has the prefix.\n */\ngoog.structs.Trie.prototype.containsPrefix = function(prefix) {\n  // Empty string is any key's prefix.\n  if (prefix.length == 0) {\n    return !this.isEmpty();\n  }\n  return !!this.getChildNode_(prefix);\n};\n\n\n/**\n * Checks to see if a certain value is in the trie.  Worst case is O(N) where\n * N is the number of nodes in the trie.\n * @param {VALUE} value A value that may be in the trie.\n * @return {boolean} Whether the trie contains the value.\n */\ngoog.structs.Trie.prototype.containsValue = function(value) {\n  if (this.value_ === value) {\n    return true;\n  }\n  for (var childNode in this.childNodes_) {\n    if (this.childNodes_[childNode].containsValue(value)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Completely empties a trie of all keys and values.  ~O(1)\n */\ngoog.structs.Trie.prototype.clear = function() {\n  this.childNodes_ = {};\n  this.value_ = undefined;\n};\n\n\n/**\n * Removes a key from the trie or throws an exception if the key is not in the\n * trie.  O(L), where L is the length of the key.\n * @param {string} key A key that should be removed from the trie.\n * @return {VALUE} The value whose key was removed.\n */\ngoog.structs.Trie.prototype.remove = function(key) {\n  var node = this;\n  var parents = [];\n  for (var characterPosition = 0; characterPosition < key.length;\n       characterPosition++) {\n    var currentCharacter = key.charAt(characterPosition);\n    if (!node.childNodes_[currentCharacter]) {\n      throw Error('The collection does not have the key \"' + key + '\"');\n    }\n\n    // Archive the current parent and child name (key in childNodes_) so that\n    // we may remove the following node and its parents if they are empty.\n    parents.push([node, currentCharacter]);\n\n    node = node.childNodes_[currentCharacter];\n  }\n  var oldValue = node.value_;\n  delete node.value_;\n\n  while (parents.length > 0) {\n    var currentParentAndCharacter = parents.pop();\n    var currentParent = currentParentAndCharacter[0];\n    var currentCharacter = currentParentAndCharacter[1];\n    if (currentParent.childNodes_[currentCharacter].isEmpty()) {\n      // If the child is empty, then remove it.\n      delete currentParent.childNodes_[currentCharacter];\n    } else {\n      // No point of traversing back any further, since we can't remove this\n      // path.\n      break;\n    }\n  }\n  return oldValue;\n};\n\n\n/**\n * Clones a trie and returns a new trie.  O(N), where N is the number of nodes\n * in the trie.\n * @return {!goog.structs.Trie<VALUE>} A new goog.structs.Trie with the same\n *     key value pairs.\n */\ngoog.structs.Trie.prototype.clone = function() {\n  return new goog.structs.Trie(this);\n};\n\n\n/**\n * Returns the number of key value pairs in the trie.  O(N), where N is the\n * number of nodes in the trie.\n * TODO: This could be optimized by storing a weight (count below) in every\n * node.\n * @return {number} The number of pairs.\n */\ngoog.structs.Trie.prototype.getCount = function() {\n  return goog.structs.getCount(this.getValues());\n};\n\n\n/**\n * Returns true if this trie contains no elements.  ~O(1).\n * @return {boolean} True iff this trie contains no elements.\n */\ngoog.structs.Trie.prototype.isEmpty = function() {\n  return this.value_ === undefined && goog.object.isEmpty(this.childNodes_);\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Provides the typeahead functionality for the tree class.\n *\n */\n\ngoog.provide('goog.ui.tree.TypeAhead');\ngoog.provide('goog.ui.tree.TypeAhead.Offset');\n\ngoog.require('goog.array');\ngoog.require('goog.events.KeyCodes');\ngoog.require('goog.string');\ngoog.require('goog.structs.Trie');\n\n\n\n/**\n * Constructs a TypeAhead object.\n * @constructor\n * @final\n */\ngoog.ui.tree.TypeAhead = function() {\n  /**\n   * Map of tree nodes to allow for quick access by characters in the label\n   * text.\n   * @private {goog.structs.Trie<Array<goog.ui.tree.BaseNode>>}\n   */\n  this.nodeMap_ = new goog.structs.Trie();\n\n  /**\n   * Buffer for storing typeahead characters.\n   * @private {string}\n   */\n  this.buffer_ = '';\n\n  /**\n   * Matching labels from the latest typeahead search.\n   * @private {?Array<string>}\n   */\n  this.matchingLabels_ = null;\n\n  /**\n   * Matching nodes from the latest typeahead search. Used when more than\n   * one node is present with the same label text.\n   * @private {?Array<goog.ui.tree.BaseNode>}\n   */\n  this.matchingNodes_ = null;\n\n  /**\n   * Specifies the current index of the label from the latest typeahead search.\n   * @private {number}\n   */\n  this.matchingLabelIndex_ = 0;\n\n  /**\n   * Specifies the index into matching nodes when more than one node is found\n   * with the same label.\n   * @private {number}\n   */\n  this.matchingNodeIndex_ = 0;\n};\n\n\n/**\n * Enum for offset values that are used for ctrl-key navigation among the\n * multiple matches of a given typeahead buffer.\n *\n * @enum {number}\n */\ngoog.ui.tree.TypeAhead.Offset = {\n  DOWN: 1,\n  UP: -1\n};\n\n\n/**\n * Handles navigation keys.\n * @param {goog.events.BrowserEvent} e The browser event.\n * @return {boolean} The handled value.\n */\ngoog.ui.tree.TypeAhead.prototype.handleNavigation = function(e) {\n  var handled = false;\n\n  switch (e.keyCode) {\n    // Handle ctrl+down, ctrl+up to navigate within typeahead results.\n    case goog.events.KeyCodes.DOWN:\n    case goog.events.KeyCodes.UP:\n      if (e.ctrlKey) {\n        this.jumpTo_(\n            e.keyCode == goog.events.KeyCodes.DOWN ?\n                goog.ui.tree.TypeAhead.Offset.DOWN :\n                goog.ui.tree.TypeAhead.Offset.UP);\n        handled = true;\n      }\n      break;\n\n    // Remove the last typeahead char.\n    case goog.events.KeyCodes.BACKSPACE:\n      var length = this.buffer_.length - 1;\n      handled = true;\n      if (length > 0) {\n        this.buffer_ = this.buffer_.substring(0, length);\n        this.jumpToLabel_(this.buffer_);\n      } else if (length == 0) {\n        // Clear the last character in typeahead.\n        this.buffer_ = '';\n      } else {\n        handled = false;\n      }\n      break;\n\n    // Clear typeahead buffer.\n    case goog.events.KeyCodes.ESC:\n      this.buffer_ = '';\n      handled = true;\n      break;\n  }\n\n  return handled;\n};\n\n\n/**\n * Handles the character presses.\n * @param {goog.events.BrowserEvent} e The browser event.\n *    Expected event type is goog.events.KeyHandler.EventType.KEY.\n * @return {boolean} The handled value.\n */\ngoog.ui.tree.TypeAhead.prototype.handleTypeAheadChar = function(e) {\n  var handled = false;\n\n  if (!e.ctrlKey && !e.altKey) {\n    // Since goog.structs.Trie.getKeys compares characters during\n    // lookup, we should use charCode instead of keyCode where possible.\n    // Convert to lowercase, typeahead is case insensitive.\n    var ch = String.fromCharCode(e.charCode || e.keyCode).toLowerCase();\n    if (goog.string.isUnicodeChar(ch) && (ch != ' ' || this.buffer_)) {\n      this.buffer_ += ch;\n      handled = this.jumpToLabel_(this.buffer_);\n    }\n  }\n\n  return handled;\n};\n\n\n/**\n * Adds or updates the given node in the nodemap. The label text is used as a\n * key and the node id is used as a value. In the case that the key already\n * exists, such as when more than one node exists with the same label, then this\n * function creates an array to hold the multiple nodes.\n * @param {goog.ui.tree.BaseNode} node Node to be added or updated.\n */\ngoog.ui.tree.TypeAhead.prototype.setNodeInMap = function(node) {\n  var labelText = node.getText();\n  if (labelText &&\n      !goog.string.isEmptyOrWhitespace(goog.string.makeSafe(labelText))) {\n    // Typeahead is case insensitive, convert to lowercase.\n    labelText = labelText.toLowerCase();\n\n    var previousValue = this.nodeMap_.get(labelText);\n    if (previousValue) {\n      // Found a previously created array, add the given node.\n      previousValue.push(node);\n    } else {\n      // Create a new array and set the array as value.\n      var nodeList = [node];\n      this.nodeMap_.set(labelText, nodeList);\n    }\n  }\n};\n\n\n/**\n * Removes the given node from the nodemap.\n * @param {goog.ui.tree.BaseNode} node Node to be removed.\n */\ngoog.ui.tree.TypeAhead.prototype.removeNodeFromMap = function(node) {\n  var labelText = node.getText();\n  if (labelText &&\n      !goog.string.isEmptyOrWhitespace(goog.string.makeSafe(labelText))) {\n    labelText = labelText.toLowerCase();\n\n    var nodeList = this.nodeMap_.get(labelText);\n    if (nodeList) {\n      // Remove the node's descendants from the nodemap.\n      var count = node.getChildCount();\n      for (var i = 0; i < count; i++) {\n        this.removeNodeFromMap(node.getChildAt(i));\n      }\n      // Remove the node from the array.\n      goog.array.remove(nodeList, node);\n      if (!nodeList.length) {\n        this.nodeMap_.remove(labelText);\n      }\n    }\n  }\n};\n\n\n/**\n * Select the first matching node for the given typeahead.\n * @param {string} typeAhead Typeahead characters to match.\n * @return {boolean} True iff a node is found.\n * @private\n */\ngoog.ui.tree.TypeAhead.prototype.jumpToLabel_ = function(typeAhead) {\n  var handled = false;\n  var labels = this.nodeMap_.getKeys(typeAhead);\n\n  // Make sure we have at least one matching label.\n  if (labels && labels.length) {\n    this.matchingNodeIndex_ = 0;\n    this.matchingLabelIndex_ = 0;\n\n    var nodes = this.nodeMap_.get(labels[0]);\n    if ((handled = this.selectMatchingNode_(nodes))) {\n      this.matchingLabels_ = labels;\n    }\n  }\n\n  // TODO(user): beep when no node is found\n  return handled;\n};\n\n\n/**\n * Select the next or previous node based on the offset.\n * @param {goog.ui.tree.TypeAhead.Offset} offset DOWN or UP.\n * @return {boolean} Whether a node is found.\n * @private\n */\ngoog.ui.tree.TypeAhead.prototype.jumpTo_ = function(offset) {\n  var handled = false;\n  var labels = this.matchingLabels_;\n\n  if (labels) {\n    var nodes = null;\n    var nodeIndexOutOfRange = false;\n\n    // Navigate within the nodes array.\n    if (this.matchingNodes_) {\n      var newNodeIndex = this.matchingNodeIndex_ + offset;\n      if (newNodeIndex >= 0 && newNodeIndex < this.matchingNodes_.length) {\n        this.matchingNodeIndex_ = newNodeIndex;\n        nodes = this.matchingNodes_;\n      } else {\n        nodeIndexOutOfRange = true;\n      }\n    }\n\n    // Navigate to the next or previous label.\n    if (!nodes) {\n      var newLabelIndex = this.matchingLabelIndex_ + offset;\n      if (newLabelIndex >= 0 && newLabelIndex < labels.length) {\n        this.matchingLabelIndex_ = newLabelIndex;\n      }\n\n      if (labels.length > this.matchingLabelIndex_) {\n        nodes = this.nodeMap_.get(labels[this.matchingLabelIndex_]);\n      }\n\n      // Handle the case where we are moving beyond the available nodes,\n      // while going UP select the last item of multiple nodes with same label\n      // and while going DOWN select the first item of next set of nodes\n      if (nodes && nodes.length && nodeIndexOutOfRange) {\n        this.matchingNodeIndex_ =\n            (offset == goog.ui.tree.TypeAhead.Offset.UP) ? nodes.length - 1 : 0;\n      }\n    }\n\n    if ((handled = this.selectMatchingNode_(nodes))) {\n      this.matchingLabels_ = labels;\n    }\n  }\n\n  // TODO(user): beep when no node is found\n  return handled;\n};\n\n\n/**\n * Given a nodes array reveals and selects the node while using node index.\n * @param {Array<goog.ui.tree.BaseNode>|undefined} nodes Nodes array to select\n *     the node from.\n * @return {boolean} Whether a matching node was found.\n * @private\n */\ngoog.ui.tree.TypeAhead.prototype.selectMatchingNode_ = function(nodes) {\n  var node;\n\n  if (nodes) {\n    // Find the matching node.\n    if (this.matchingNodeIndex_ < nodes.length) {\n      node = nodes[this.matchingNodeIndex_];\n      this.matchingNodes_ = nodes;\n    }\n\n    if (node) {\n      node.reveal();\n      node.select();\n    }\n  }\n\n  return !!node;\n};\n\n\n/**\n * Clears the typeahead buffer.\n */\ngoog.ui.tree.TypeAhead.prototype.clear = function() {\n  this.buffer_ = '';\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Definition of the goog.ui.tree.TreeControl class, which\n * provides a way to view a hierarchical set of data.\n *\n * @author arv@google.com (Erik Arvidsson)\n * @author eae@google.com (Emil A Eklund)\n *\n * This is a based on the webfx tree control. It since been updated to add\n * typeahead support, as well as accessibility support using ARIA framework.\n *\n * @see ../../demos/tree/demo.html\n */\n\ngoog.provide('goog.ui.tree.TreeControl');\n\ngoog.require('goog.a11y.aria');\ngoog.require('goog.asserts');\ngoog.require('goog.dom.classlist');\ngoog.require('goog.events.EventType');\ngoog.require('goog.events.FocusHandler');\ngoog.require('goog.events.KeyHandler');\ngoog.require('goog.html.SafeHtml');\ngoog.require('goog.log');\ngoog.require('goog.ui.tree.BaseNode');\ngoog.require('goog.ui.tree.TreeNode');\ngoog.require('goog.ui.tree.TypeAhead');\ngoog.require('goog.userAgent');\n\n\n\n/**\n * This creates a TreeControl object. A tree control provides a way to\n * view a hierarchical set of data.\n * @param {string|!goog.html.SafeHtml} content The content of the node label.\n *     Strings are treated as plain-text and will be HTML escaped.\n * @param {Object=} opt_config The configuration for the tree. See\n *    goog.ui.tree.TreeControl.defaultConfig. If not specified, a default config\n *    will be used.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper.\n * @constructor\n * @extends {goog.ui.tree.BaseNode}\n */\ngoog.ui.tree.TreeControl = function(content, opt_config, opt_domHelper) {\n  goog.ui.tree.BaseNode.call(this, content, opt_config, opt_domHelper);\n\n  // The root is open and selected by default.\n  this.setExpandedInternal(true);\n  this.setSelectedInternal(true);\n\n  this.selectedItem_ = this;\n\n  /**\n   * Used for typeahead support.\n   * @private {!goog.ui.tree.TypeAhead}\n   */\n  this.typeAhead_ = new goog.ui.tree.TypeAhead();\n\n  /**\n   * The object handling keyboard events.\n   * @private {?goog.events.KeyHandler}\n   */\n  this.keyHandler_ = null;\n\n  /**\n   * The object handling focus events.\n   * @private {?goog.events.FocusHandler}\n   */\n  this.focusHandler_ = null;\n\n  /**\n   * Logger\n   * @private {?goog.log.Logger}\n   */\n  this.logger_ = goog.log.getLogger('this');\n\n  /**\n   * Whether the tree is focused.\n   * @private {boolean}\n   */\n  this.focused_ = false;\n\n  /**\n   * Child node that currently has focus.\n   * @private {?goog.ui.tree.BaseNode}\n   */\n  this.focusedNode_ = null;\n\n  /**\n   * Whether to show lines.\n   * @private {boolean}\n   */\n  this.showLines_ = true;\n\n  /**\n   * Whether to show expanded lines.\n   * @private {boolean}\n   */\n  this.showExpandIcons_ = true;\n\n  /**\n   * Whether to show the root node.\n   * @private {boolean}\n   */\n  this.showRootNode_ = true;\n\n  /**\n   * Whether to show the root lines.\n   * @private {boolean}\n   */\n  this.showRootLines_ = true;\n\n  if (goog.userAgent.IE) {\n    /** @preserveTry */\n    try {\n      // works since IE6SP1\n      document.execCommand('BackgroundImageCache', false, true);\n    } catch (e) {\n      goog.log.warning(this.logger_, 'Failed to enable background image cache');\n    }\n  }\n};\ngoog.inherits(goog.ui.tree.TreeControl, goog.ui.tree.BaseNode);\n\n\n/** @override */\ngoog.ui.tree.TreeControl.prototype.getTree = function() {\n  return this;\n};\n\n\n/** @override */\ngoog.ui.tree.TreeControl.prototype.getDepth = function() {\n  return 0;\n};\n\n\n/**\n * Expands the parent chain of this node so that it is visible.\n * @override\n */\ngoog.ui.tree.TreeControl.prototype.reveal = function() {\n  // always expanded by default\n  // needs to be overriden so that we don't try to reveal our parent\n  // which is a generic component\n};\n\n\n/**\n * Handles focus on the tree.\n * @param {!goog.events.BrowserEvent} e The browser event.\n * @private\n */\ngoog.ui.tree.TreeControl.prototype.handleFocus_ = function(e) {\n  this.focused_ = true;\n  goog.dom.classlist.add(\n      goog.asserts.assert(this.getElement()), goog.getCssName('focused'));\n\n  if (this.selectedItem_) {\n    this.selectedItem_.select();\n  }\n};\n\n\n/**\n * Handles blur on the tree.\n * @param {!goog.events.BrowserEvent} e The browser event.\n * @private\n */\ngoog.ui.tree.TreeControl.prototype.handleBlur_ = function(e) {\n  this.focused_ = false;\n  goog.dom.classlist.remove(\n      goog.asserts.assert(this.getElement()), goog.getCssName('focused'));\n};\n\n\n/**\n * @return {boolean} Whether the tree has keyboard focus.\n */\ngoog.ui.tree.TreeControl.prototype.hasFocus = function() {\n  return this.focused_;\n};\n\n\n/** @override */\ngoog.ui.tree.TreeControl.prototype.getExpanded = function() {\n  return !this.showRootNode_ ||\n      goog.ui.tree.TreeControl.superClass_.getExpanded.call(this);\n};\n\n\n/** @override */\ngoog.ui.tree.TreeControl.prototype.setExpanded = function(expanded) {\n  if (!this.showRootNode_) {\n    this.setExpandedInternal(expanded);\n  } else {\n    goog.ui.tree.TreeControl.superClass_.setExpanded.call(this, expanded);\n  }\n};\n\n\n/** @override */\ngoog.ui.tree.TreeControl.prototype.getExpandIconSafeHtml = function() {\n  // no expand icon for root element\n  return goog.html.SafeHtml.EMPTY;\n};\n\n\n/** @override */\ngoog.ui.tree.TreeControl.prototype.getIconElement = function() {\n  var el = this.getRowElement();\n  return el ? /** @type {Element} */ (el.firstChild) : null;\n};\n\n\n/** @override */\ngoog.ui.tree.TreeControl.prototype.getExpandIconElement = function() {\n  // no expand icon for root element\n  return null;\n};\n\n\n/** @override */\ngoog.ui.tree.TreeControl.prototype.updateExpandIcon = function() {\n  // no expand icon\n};\n\n\n/** @override */\ngoog.ui.tree.TreeControl.prototype.getRowClassName = function() {\n  return goog.ui.tree.TreeControl.superClass_.getRowClassName.call(this) +\n      (this.showRootNode_ ? '' : ' ' + this.getConfig().cssHideRoot);\n};\n\n\n/**\n * Returns the source for the icon.\n * @return {string} Src for the icon.\n * @override\n */\ngoog.ui.tree.TreeControl.prototype.getCalculatedIconClass = function() {\n  var expanded = this.getExpanded();\n  var expandedIconClass = this.getExpandedIconClass();\n  if (expanded && expandedIconClass) {\n    return expandedIconClass;\n  }\n  var iconClass = this.getIconClass();\n  if (!expanded && iconClass) {\n    return iconClass;\n  }\n\n  // fall back on default icons\n  var config = this.getConfig();\n  if (expanded && config.cssExpandedRootIcon) {\n    return config.cssTreeIcon + ' ' + config.cssExpandedRootIcon;\n  } else if (!expanded && config.cssCollapsedRootIcon) {\n    return config.cssTreeIcon + ' ' + config.cssCollapsedRootIcon;\n  }\n  return '';\n};\n\n\n/**\n * Sets the selected item.\n * @param {goog.ui.tree.BaseNode} node The item to select.\n */\ngoog.ui.tree.TreeControl.prototype.setSelectedItem = function(node) {\n  if (this.selectedItem_ == node) {\n    return;\n  }\n\n  var hadFocus = false;\n  if (this.selectedItem_) {\n    hadFocus = this.selectedItem_ == this.focusedNode_;\n    this.selectedItem_.setSelectedInternal(false);\n  }\n\n  this.selectedItem_ = node;\n\n  if (node) {\n    node.setSelectedInternal(true);\n    if (hadFocus) {\n      node.select();\n    }\n  }\n\n  this.dispatchEvent(goog.events.EventType.CHANGE);\n};\n\n\n/**\n * Returns the selected item.\n * @return {goog.ui.tree.BaseNode} The currently selected item.\n */\ngoog.ui.tree.TreeControl.prototype.getSelectedItem = function() {\n  return this.selectedItem_;\n};\n\n\n/**\n * Sets whether to show lines.\n * @param {boolean} b Whether to show lines.\n */\ngoog.ui.tree.TreeControl.prototype.setShowLines = function(b) {\n  if (this.showLines_ != b) {\n    this.showLines_ = b;\n    if (this.isInDocument()) {\n      this.updateLinesAndExpandIcons_();\n    }\n  }\n};\n\n\n/**\n * @return {boolean} Whether to show lines.\n */\ngoog.ui.tree.TreeControl.prototype.getShowLines = function() {\n  return this.showLines_;\n};\n\n\n/**\n * Updates the lines after the tree has been drawn.\n * @private\n */\ngoog.ui.tree.TreeControl.prototype.updateLinesAndExpandIcons_ = function() {\n  var tree = this;\n  var showLines = tree.getShowLines();\n  var showRootLines = tree.getShowRootLines();\n\n  /**\n   * Recursively walk through all nodes and update the class names of the\n   * expand icon and the children element.\n   * @param {!goog.ui.tree.BaseNode} node\n   */\n  function updateShowLines(node) {\n    var childrenEl = node.getChildrenElement();\n    if (childrenEl) {\n      var hideLines = !showLines || tree == node.getParent() && !showRootLines;\n      var childClass = hideLines ? node.getConfig().cssChildrenNoLines :\n                                   node.getConfig().cssChildren;\n      childrenEl.className = childClass;\n\n      var expandIconEl = node.getExpandIconElement();\n      if (expandIconEl) {\n        expandIconEl.className = node.getExpandIconClass();\n      }\n    }\n    node.forEachChild(updateShowLines);\n  }\n  updateShowLines(this);\n};\n\n\n/**\n * Sets whether to show root lines.\n * @param {boolean} b Whether to show root lines.\n */\ngoog.ui.tree.TreeControl.prototype.setShowRootLines = function(b) {\n  if (this.showRootLines_ != b) {\n    this.showRootLines_ = b;\n    if (this.isInDocument()) {\n      this.updateLinesAndExpandIcons_();\n    }\n  }\n};\n\n\n/**\n * @return {boolean} Whether to show root lines.\n */\ngoog.ui.tree.TreeControl.prototype.getShowRootLines = function() {\n  return this.showRootLines_;\n};\n\n\n/**\n * Sets whether to show expand icons.\n * @param {boolean} b Whether to show expand icons.\n */\ngoog.ui.tree.TreeControl.prototype.setShowExpandIcons = function(b) {\n  if (this.showExpandIcons_ != b) {\n    this.showExpandIcons_ = b;\n    if (this.isInDocument()) {\n      this.updateLinesAndExpandIcons_();\n    }\n  }\n};\n\n\n/**\n * @return {boolean} Whether to show expand icons.\n */\ngoog.ui.tree.TreeControl.prototype.getShowExpandIcons = function() {\n  return this.showExpandIcons_;\n};\n\n\n/**\n * Sets whether to show the root node.\n * @param {boolean} b Whether to show the root node.\n */\ngoog.ui.tree.TreeControl.prototype.setShowRootNode = function(b) {\n  if (this.showRootNode_ != b) {\n    this.showRootNode_ = b;\n    if (this.isInDocument()) {\n      var el = this.getRowElement();\n      if (el) {\n        el.className = this.getRowClassName();\n      }\n    }\n    // Ensure that we do not hide the selected item.\n    if (!b && this.getSelectedItem() == this && this.getFirstChild()) {\n      this.setSelectedItem(this.getFirstChild());\n    }\n  }\n};\n\n\n/**\n * @return {boolean} Whether to show the root node.\n */\ngoog.ui.tree.TreeControl.prototype.getShowRootNode = function() {\n  return this.showRootNode_;\n};\n\n\n/**\n * Add roles and states.\n * @protected\n * @override\n */\ngoog.ui.tree.TreeControl.prototype.initAccessibility = function() {\n  goog.ui.tree.TreeControl.superClass_.initAccessibility.call(this);\n\n  var elt = this.getElement();\n  goog.asserts.assert(elt, 'The DOM element for the tree cannot be null.');\n  goog.a11y.aria.setRole(elt, 'tree');\n  goog.a11y.aria.setState(elt, 'labelledby', this.getLabelElement().id);\n};\n\n\n/** @override */\ngoog.ui.tree.TreeControl.prototype.enterDocument = function() {\n  goog.ui.tree.TreeControl.superClass_.enterDocument.call(this);\n  var el = this.getElement();\n  el.className = this.getConfig().cssRoot;\n  el.setAttribute('hideFocus', 'true');\n  this.attachEvents_();\n  this.initAccessibility();\n};\n\n\n/** @override */\ngoog.ui.tree.TreeControl.prototype.exitDocument = function() {\n  goog.ui.tree.TreeControl.superClass_.exitDocument.call(this);\n  this.detachEvents_();\n};\n\n\n/**\n * Adds the event listeners to the tree.\n * @private\n */\ngoog.ui.tree.TreeControl.prototype.attachEvents_ = function() {\n  var el = this.getElement();\n  el.tabIndex = 0;\n\n  var kh = this.keyHandler_ = new goog.events.KeyHandler(el);\n  var fh = this.focusHandler_ = new goog.events.FocusHandler(el);\n\n  this.getHandler()\n      .listen(fh, goog.events.FocusHandler.EventType.FOCUSOUT, this.handleBlur_)\n      .listen(fh, goog.events.FocusHandler.EventType.FOCUSIN, this.handleFocus_)\n      .listen(kh, goog.events.KeyHandler.EventType.KEY, this.handleKeyEvent)\n      .listen(el, goog.events.EventType.MOUSEDOWN, this.handleMouseEvent_)\n      .listen(el, goog.events.EventType.CLICK, this.handleMouseEvent_)\n      .listen(el, goog.events.EventType.DBLCLICK, this.handleMouseEvent_);\n};\n\n\n/**\n * Removes the event listeners from the tree.\n * @private\n */\ngoog.ui.tree.TreeControl.prototype.detachEvents_ = function() {\n  this.keyHandler_.dispose();\n  this.keyHandler_ = null;\n  this.focusHandler_.dispose();\n  this.focusHandler_ = null;\n};\n\n\n/**\n * Handles mouse events.\n * @param {!goog.events.BrowserEvent} e The browser event.\n * @private\n */\ngoog.ui.tree.TreeControl.prototype.handleMouseEvent_ = function(e) {\n  goog.log.fine(this.logger_, 'Received event ' + e.type);\n  var node = this.getNodeFromEvent_(e);\n  if (node) {\n    switch (e.type) {\n      case goog.events.EventType.MOUSEDOWN:\n        node.onMouseDown(e);\n        break;\n      case goog.events.EventType.CLICK:\n        node.onClick_(e);\n        break;\n      case goog.events.EventType.DBLCLICK:\n        node.onDoubleClick_(e);\n        break;\n    }\n  }\n};\n\n\n/**\n * Handles key down on the tree.\n * @param {!goog.events.BrowserEvent} e The browser event.\n * @return {boolean} The handled value.\n */\ngoog.ui.tree.TreeControl.prototype.handleKeyEvent = function(e) {\n  var handled = false;\n\n  // Handle typeahead and navigation keystrokes.\n  handled = this.typeAhead_.handleNavigation(e) ||\n      (this.selectedItem_ && this.selectedItem_.onKeyDown(e)) ||\n      this.typeAhead_.handleTypeAheadChar(e);\n\n  if (handled) {\n    e.preventDefault();\n  }\n\n  return handled;\n};\n\n\n/**\n * Finds the containing node given an event.\n * @param {!goog.events.BrowserEvent} e The browser event.\n * @return {goog.ui.tree.BaseNode} The containing node or null if no node is\n *     found.\n * @private\n */\ngoog.ui.tree.TreeControl.prototype.getNodeFromEvent_ = function(e) {\n  // find the right node\n  var node = null;\n  var target = e.target;\n  while (target != null) {\n    var id = target.id;\n    node = goog.ui.tree.BaseNode.allNodes[id];\n    if (node) {\n      return node;\n    }\n    if (target == this.getElement()) {\n      break;\n    }\n    target = target.parentNode;\n  }\n  return null;\n};\n\n\n/**\n * Creates a new tree node using the same config as the root.\n * @param {string=} opt_content The content of the node label. Strings are\n *     treated as plain-text and will be HTML escaped. To set SafeHtml content,\n *     omit opt_content and call setSafeHtml on the resulting node.\n * @return {!goog.ui.tree.TreeNode} The new item.\n */\ngoog.ui.tree.TreeControl.prototype.createNode = function(opt_content) {\n  return new goog.ui.tree.TreeNode(opt_content || goog.html.SafeHtml.EMPTY,\n      this.getConfig(), this.getDomHelper());\n};\n\n\n/**\n * Allows the caller to notify that the given node has been added or just had\n * been updated in the tree.\n * @param {goog.ui.tree.BaseNode} node New node being added or existing node\n *    that just had been updated.\n */\ngoog.ui.tree.TreeControl.prototype.setNode = function(node) {\n  this.typeAhead_.setNodeInMap(node);\n};\n\n\n/**\n * Allows the caller to notify that the given node is being removed from the\n * tree.\n * @param {goog.ui.tree.BaseNode} node Node being removed.\n */\ngoog.ui.tree.TreeControl.prototype.removeNode = function(node) {\n  this.typeAhead_.removeNodeFromMap(node);\n};\n\n\n/**\n * Clear the typeahead buffer.\n */\ngoog.ui.tree.TreeControl.prototype.clearTypeAhead = function() {\n  this.typeAhead_.clear();\n};\n\n\n/**\n * A default configuration for the tree.\n */\ngoog.ui.tree.TreeControl.defaultConfig = goog.ui.tree.BaseNode.defaultConfig;\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Toolbox from whence to create blocks.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Toolbox');\n\ngoog.require('Blockly.Flyout');\ngoog.require('goog.events.BrowserFeature');\ngoog.require('goog.style');\ngoog.require('goog.ui.tree.TreeControl');\ngoog.require('goog.ui.tree.TreeNode');\ngoog.require('goog.math.Rect');\n\n\n/**\n * Class for a toolbox.\n * @constructor\n */\nBlockly.Toolbox = function(blockSpaceEditor) {\n  this.blockSpaceEditor_ = blockSpaceEditor;\n  this.createDom(this.blockSpaceEditor_.svg_);\n};\n\n/**\n * Width of the toolbox.\n * @type {number}\n */\nBlockly.Toolbox.prototype.width = 0;\n\n/**\n * Configuration constants for Closure's tree UI.\n * @type {Object.<string,*>}\n * @const\n * @private\n */\nBlockly.Toolbox.CONFIG_ = {\n  indentWidth: 19,\n  cssRoot: 'blocklyTreeRoot',\n  cssHideRoot: 'blocklyHidden',\n  cssItem: '',\n  cssTreeRow: 'blocklyTreeRow',\n  cssItemLabel: 'blocklyTreeLabel',\n  cssTreeIcon: 'blocklyTreeIcon',\n  cssExpandedFolderIcon: 'blocklyTreeIconOpen',\n  cssFileIcon: 'blocklyTreeIconNone',\n  cssSelectedRow: 'blocklyTreeSelected'\n};\n\n/**\n * Creates the toolbox's DOM.  Only needs to be called once.\n * @param {!Element} svg The top-level SVG element.\n */\nBlockly.Toolbox.prototype.createDom = function (svg) {\n  // Create an HTML container for the Toolbox menu.\n  this.HtmlDiv = goog.dom.createDom('div', 'blocklyToolboxDiv');\n  this.HtmlDiv.setAttribute('dir', Blockly.RTL ? 'RTL' : 'LTR');\n  goog.dom.insertSiblingBefore(this.HtmlDiv, svg);\n\n  // Add a trashcan inside a holder svg element.\n  this.trashcanHolder = Blockly.createSvgElement('svg', {\n    id: 'trashcanHolder',\n    width: 70,\n    height: 90,\n    style: 'display: none; position: absolute'\n  }, this.HtmlDiv);\n  if (!Blockly.isPortrait){\n    this.trashcan = new Blockly.Trashcan(this);\n    this.svgTrashcan = this.trashcan.createDom();\n    this.svgTrashcan.setAttribute('transform', 'translate(0, 10)');\n    this.trashcanHolder.appendChild(this.svgTrashcan);\n  }\n\n  /**\n   * @type {!Blockly.Flyout}\n   * @private\n   */\n  this.flyout_ = new Blockly.Flyout(this.blockSpaceEditor_);\n  svg.appendChild(this.flyout_.createDom(true));\n\n  // Clicking on toolbox closes popups.\n  Blockly.bindEvent_(this.HtmlDiv, 'mousedown', this,\n      function(e) {\n        Blockly.fireUiEvent(window, 'resize');\n        if (Blockly.isRightButton(e) || e.target == this.HtmlDiv) {\n          // Close flyout.\n          this.blockSpaceEditor_.hideChaff(false);\n        } else {\n          // Just close popups.\n          this.blockSpaceEditor_.hideChaff(true);\n        }\n      });\n};\n\n/**\n * Initializes the toolbox.\n * @param {!BlockSpace} blockSpace The blockSpace this toolbox's flyout will create blocks in\n * @param {!BlockSpaceEditor} blockSpaceEditor The editor blockSpace this toolbox's flyout will be positioned in\n */\nBlockly.Toolbox.prototype.init = function(blockSpace, blockSpaceEditor) {\n  Blockly.Toolbox.CONFIG_['cleardotPath'] = Blockly.assetUrl('media/1x1.gif');\n  Blockly.Toolbox.CONFIG_['cssCollapsedFolderIcon'] =\n      'blocklyTreeIconClosed' + (Blockly.RTL ? 'Rtl' : 'Ltr');\n  var tree = new Blockly.Toolbox.TreeControl(this, 'root', Blockly.Toolbox.CONFIG_);\n  this.tree_ = tree;\n  tree.setShowRootNode(false);\n  tree.setShowLines(false);\n  tree.setShowExpandIcons(false);\n  tree.setSelectedItem(null);\n\n  this.HtmlDiv.style.display = 'block';\n  this.flyout_.init(blockSpace, true);\n  this.populate_();\n  tree.render(this.HtmlDiv);\n\n  // If the document resizes, reposition the toolbox.\n  goog.events.listen(window, goog.events.EventType.RESIZE,\n                     goog.partial(this.position_, blockSpaceEditor), false, this);\n  this.position_(blockSpaceEditor);\n  this.enabled = true;\n};\n\n/**\n * Move the toolbox to the edge.\n * @private\n */\nBlockly.Toolbox.prototype.position_ = function(blockSpaceEditor) {\n  var treeDiv = this.HtmlDiv;\n  var svgBox = goog.style.getBorderBox(blockSpaceEditor.svg_);\n  var svgSize = blockSpaceEditor.svgSize();\n  if (Blockly.RTL) {\n    treeDiv.style.right = svgBox.right + 'px';\n  } else {\n    treeDiv.style.marginLeft = svgBox.left;\n  }\n  treeDiv.style.height = svgSize.height + 'px';\n  this.width = treeDiv.offsetWidth;\n  if (!Blockly.RTL) {\n    // For some reason the LTR toolbox now reports as 1px too wide.\n    this.width -= 1;\n  }\n\n  if (!blockSpaceEditor.hideTrashRect_) {\n    // Update the toolbox background rectangle location/dimension to match the div.\n    var rectX = Blockly.RTL ? (svgSize.width - treeDiv.offsetWidth) : 0;\n    blockSpaceEditor.svgBackground_.setAttribute(\"x\", rectX);\n    blockSpaceEditor.svgBackground_.setAttribute(\"width\", treeDiv.offsetWidth);\n    blockSpaceEditor.svgBackground_.setAttribute(\"height\", svgSize.height);\n  }\n\n  // Center the trashcan.\n  var toolboxWidth = treeDiv.offsetWidth;\n  var trashcanWidth = this.trashcanHolder.getAttribute(\"width\");\n  var trashcanX = Math.round(toolboxWidth / 2 - trashcanWidth / 2);\n  this.trashcanHolder.style[\"left\"] = trashcanX + 'px';\n};\n\nBlockly.Toolbox.prototype.updateToolbox = function(tree) {\n  \n  var tree = new Blockly.Toolbox.TreeControl(this, 'root', Blockly.Toolbox.CONFIG_);\n  this.tree_ = tree;\n  tree.setShowRootNode(false);\n  tree.setShowLines(false);\n  tree.setShowExpandIcons(false);\n  tree.setSelectedItem(null);\n  \n  Blockly.languageTree = Blockly.Xml.textToDom(tree);\n  // this.flyout_.init(blockSpace, true);\n  this.populate_();\n  tree.render(this.HtmlDiv);\n  this.addColour_();\n};\n\n/**\n * Fill the toolbox with categories and blocks.\n * @private\n */\nBlockly.Toolbox.prototype.populate_ = function() {\n  var rootOut = this.tree_;\n  rootOut.blocks = [];\n  var hasColours = false;\n  function syncTrees(treeIn, treeOut) {\n    for (var i = 0, childIn; childIn = treeIn.childNodes[i]; i++) {\n      if (!childIn.tagName) {\n        // Skip over text.\n        continue;\n      }\n      var name = childIn.tagName.toUpperCase();\n      if (name === 'CATEGORY') {\n        var catMsg = childIn.getAttribute('name');\n        var catname = Blockly.Msg[catMsg];\n        if (!catname) {\n          catname = catMsg;\n        }\n\n        switch (catname.trim()) {\n          case 'Actions': {\n            catname = '';\n            break;\n          }\n          case 'Loops': {\n            catname = '';\n            break;\n          }\n          case 'Events': {\n            catname = '';\n            break;\n          }\n          case 'Conditionals': {\n            catname = '';\n            break;\n          }\n          case 'Functions': {\n            catname = '';\n            break;\n          }\n          case 'Math': {\n            catname = '';\n            break;\n          }\n          case 'Variables': {\n            catname = '';\n            break;\n          }\n          case 'Brushes': {\n            catname = '';\n            break;\n          }\n          case 'Color': {\n            catname = '';\n            break;\n          }\n          case 'Prebuilt': {\n            catname = '';\n            break;\n          }\n          case 'Text': {\n            catname = '';\n            break;\n          }\n          case 'Input': {\n            catname = '';\n            break;\n          }\n        }\n\n\n        var childOut = rootOut.createNode(catname);\n        childOut.categoryName = catname;\n        childOut.blocks = [];\n        treeOut.add(childOut);\n        var custom = childIn.getAttribute('custom');\n        if (custom) {\n          // Variables and procedures have special categories that are dynamic.\n          childOut.blocks[0] = custom;\n        }\n\n        \n        syncTrees(childIn, childOut);\n        \n      } else if (name === 'BLOCK') {\n        treeOut.blocks.push(childIn);\n      }\n    }\n  }\n  syncTrees(Blockly.languageTree, this.tree_);\n  this.hasColours_ = hasColours;\n  if (rootOut.blocks.length) {\n    throw 'Toolbox cannot have both blocks and categories in the root level.';\n  }\n\n  // Fire a resize event since the toolbox may have changed width and height.\n  Blockly.fireUiEvent(window, 'resize');\n};\n\n/**\n * Unhighlight any previously specified option.\n */\nBlockly.Toolbox.prototype.clearSelection = function() {\n  this.tree_.setSelectedItem(null);\n};\n\n/**\n* Return the deletion rectangle for this toolbar.\n* @return {goog.math.Rect} Rectangle in which to delete.\n*/\nBlockly.Toolbox.prototype.getRect = function() {\n  // BIG_NUM is offscreen padding so that blocks dragged beyond the toolbox\n  // area are still deleted.  Must be smaller than Infinity, but larger than\n  // the largest screen size.\n  var BIG_NUM = 10000000;\n  var left = -BIG_NUM\n  // Assumes that the toolbox is on the SVG edge.  If this changes\n  // (e.g. toolboxes in mutators) then this code will need to be more complex.\n  if (Blockly.RTL) {\n    var svgSize = Blockly.mainBlockSpaceEditor.svgSize();\n    left = svgSize.width - this.width;\n  }\n  return new goog.math.Rect(left, -BIG_NUM, BIG_NUM + this.width, 2 * BIG_NUM);\n};\n\n// Extending Closure's Tree UI.\n\n/**\n * Extention of a TreeControl object that uses a custom tree node.\n * @param {string} html The HTML content of the node label.\n * @param {Object=} opt_config The configuration for the tree. See\n *    goog.ui.tree.TreeControl.DefaultConfig. If not specified, a default config\n *    will be used.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper.\n * @constructor\n * @extends {goog.ui.tree.TreeControl}\n */\nBlockly.Toolbox.TreeControl = function(toolbox, html, opt_config, opt_domHelper) {\n  goog.ui.tree.TreeControl.call(this, html, opt_config, opt_domHelper);\n  this.toolbox_ = toolbox;\n};\ngoog.inherits(Blockly.Toolbox.TreeControl, goog.ui.tree.TreeControl);\n\n/**\n * Adds touch handling to TreeControl.\n * @override\n */\nBlockly.Toolbox.TreeControl.prototype.enterDocument = function() {\n  Blockly.Toolbox.TreeControl.superClass_.enterDocument.call(this);\n\n  // Add touch handler.\n  if (goog.events.BrowserFeature.TOUCH_ENABLED ||\n      'onpointerdown' in window ||\n      'onmspointerdown' in window) {\n    var el = this.getElement();\n    var handler = this.handleTouchEvent_.bind(this);\n    Blockly.bindEvent_(el, goog.events.EventType.TOUCHSTART, this, handler);\n    Blockly.bindEvent_(el, goog.events.EventType.POINTERDOWN, this, handler);\n    Blockly.bindEvent_(el, goog.events.EventType.MSPOINTERDOWN, this, handler);\n  }\n};\n\n/**\n * Handles touch events.\n * @param {!goog.events.BrowserEvent} e The browser event.\n * @private\n */\nBlockly.Toolbox.TreeControl.prototype.handleTouchEvent_ = function(e) {\n  // Rate limit to once every 50ms\n  if (this.touchRateLimited) {\n    return;\n  }\n  this.touchRateLimited = true;\n  setTimeout(function () {\n    this.touchRateLimited = false;\n  }.bind(this));\n\n  e.preventDefault();\n  var node = this.getNodeFromEvent_(e);\n  if (node && (e.type === goog.events.EventType.TOUCHSTART ||\n               e.type === goog.events.EventType.POINTERDOWN ||\n               e.type === goog.events.EventType.MSPOINTERDOWN)) {\n    // Fire asynchronously since onMouseDown takes long enough that the browser\n    // would fire the default mouse event before this method returns.\n    e.stopImmediatePropagation();\n    window.setTimeout(function() {\n      node.onMouseDown(e);  // Same behavior for click and touch.\n    }, 1);\n  }\n};\n\n/**\n * Creates a new tree node using a custom tree node.\n * @param {string} html The html content of the node label.\n * @return {goog.ui.tree.TreeNode} The new item.\n * @override\n */\nBlockly.Toolbox.TreeControl.prototype.createNode = function(html) {\n  return new Blockly.Toolbox.TreeNode(this.toolbox_, html || '', this.getConfig(),\n      this.getDomHelper());\n};\n\n/**\n * Display/hide the flyout when an item is selected.\n * @param {goog.ui.tree.BaseNode} node The item to select.\n * @override\n */\nBlockly.Toolbox.TreeControl.prototype.setSelectedItem = function(node) {\n  if (this.selectedItem_ == node) {\n    return;\n  }\n  goog.ui.tree.TreeControl.prototype.setSelectedItem.call(this, node);\n  if (node && node.blocks && node.blocks.length) {\n    this.toolbox_.flyout_.show(node.blocks);\n  } else {\n    // Hide the flyout.\n    this.toolbox_.flyout_.hide();\n  }\n};\n\n/**\n * An single node in the tree, customized for Blockly's UI.\n * @param {string} html The html content of the node label.\n * @param {Object=} opt_config The configuration for the tree. See\n *    goog.ui.tree.TreeControl.DefaultConfig. If not specified, a default config\n *    will be used.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper.\n * @constructor\n * @extends {goog.ui.tree.TreeNode}\n */\nBlockly.Toolbox.TreeNode = function(toolbox, html, opt_config, opt_domHelper) {\n  goog.ui.tree.TreeNode.call(this, html, opt_config, opt_domHelper);\n  var resize = function() {\n    Blockly.fireUiEvent(window, 'resize');\n  };\n\n  this.toolbox_ = toolbox;\n\n  // Fire a resize event since the toolbox may have changed width.\n  goog.events.listen(this.toolbox_.tree_,\n      goog.ui.tree.BaseNode.EventType.EXPAND, resize);\n  goog.events.listen(this.toolbox_.tree_,\n      goog.ui.tree.BaseNode.EventType.COLLAPSE, resize);\n};\ngoog.inherits(Blockly.Toolbox.TreeNode, goog.ui.tree.TreeNode);\n\n/**\n * Do not show the +/- icon.\n * @return {goog.html.SafeHtml} The source for the icon.\n * @override\n */\nBlockly.Toolbox.TreeNode.prototype.getExpandIconSafeHtml = function() {\n  return goog.html.SafeHtml.create('span');\n};\n\n/**\n * Supress population of the +/- icon.\n * @return {null} Null.\n * @protected\n * @override\n */\nBlockly.Toolbox.TreeNode.prototype.getExpandIconElement = function() {\n  return null;\n};\n\n/**\n * Expand or collapse the node on mouse click.\n * @param {!goog.events.BrowserEvent} e The browser event.\n * @override\n */\nBlockly.Toolbox.TreeNode.prototype.onMouseDown = function(e) {\n  if (!this.toolbox_.enabled) {\n    return;\n  }\n  // Expand icon.\n  if (this.hasChildren() && this.isUserCollapsible_) {\n    this.toggle();\n    this.select();\n  } else if (this.isSelected()) {\n    this.getTree().setSelectedItem(null);\n  } else {\n    this.select();\n  }\n  this.updateRow();\n\n  e.stopPropagation();\n};\n\n/**\n * Supress the inherited double-click behaviour.\n * @param {!goog.events.BrowserEvent} e The browser event.\n * @override\n * @private\n */\nBlockly.Toolbox.TreeNode.prototype.onDoubleClick_ = function(e) {\n  // NOP.\n};\n\n/**\n * Recursively add colours to this toolbox.\n * @param {Blockly.Toolbox.TreeNode} opt_tree Starting point of tree.\n *     Defaults to the root node.\n * @private\n */\nBlockly.Toolbox.prototype.addColour_ = function(opt_tree, opt_sub) {\n  var tree = opt_tree || this.tree_; \n  var currentColour = tree.hexColour;\n  var children = tree.getChildren();\n  for (var i = 0, child; child = children[i]; i++) {\n    var element = child.getRowElement();\n    if (element) {\n      if (!!child.hexColour) {\n        element.style['background-color']= child.hexColour;\n      }\n      if (!!child.categoryName) {\n        element.setAttribute(\"category-name\", child.categoryName);\n      }\n    }\n    this.addColour_(child, true);\n  }\n};","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Utility functions for handling variables and procedure names.\n * Note that variables and procedures share the same name space, meaning that\n * one can't have a variable and a procedure of the same name.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Variables');\n\n// TODO(scr): Fix circular dependencies\n// goog.require('Blockly.Block');\ngoog.require('Blockly.Toolbox');\ngoog.require('Blockly.BlockSpace');\n\n\n/**\n * Category to separate variable names from procedures and generated functions.\n */\nBlockly.Variables.NAME_TYPE = 'VARIABLE';\nBlockly.Variables.NAME_TYPE_LOCAL = 'LOCALVARIABLE';\n\nBlockly.Variables.DEFAULT_CATEGORY = 'Default';\n\n/**\n * Find all user-created variables.\n * Currently searches the main blockspace only\n * @param {Array.<Blockly.Block>=} opt_blocks Optional root blocks.\n * @param {string=} opt_category only return variables in this category, or all\n *   variables if not specified\n * @return {!Array.<string>} Array of variable names.\n */\nBlockly.Variables.allVariables = function(opt_blocks, opt_category) {\n  if (opt_category && opt_category !== Blockly.Variables.DEFAULT_CATEGORY &&\n      (Blockly.valueTypeTabShapeMap &&\n      Blockly.valueTypeTabShapeMap[opt_category] === undefined)) {\n    throw new Error('Variable category must be \"Default\" or a strict type');\n  }\n  var blocks;\n  if (opt_blocks) {\n    opt_blocks = Array.isArray(opt_blocks) ? opt_blocks : [opt_blocks];\n    blocks = opt_blocks.reduce(function(blocks, block) {\n      return blocks.concat(block.getDescendants());\n    }, []);\n  } else if (Blockly.mainBlockSpace) {\n    blocks = Blockly.mainBlockSpace.getAllBlocks();\n  } else {\n    return [];\n  }\n  var variableHash = {};\n  // Iterate through every block and add each variable to the hash.\n  for (var x = 0; x < blocks.length; x++) {\n    if (!blocks[x].getVars) {\n      continue;\n    }\n    var blockVariables;\n    if (opt_category) {\n      blockVariables = blocks[x].getVars()[opt_category] || [];\n    } else {\n      blockVariables = Blockly.Variables.allVariablesFromBlock(blocks[x]);\n    }\n    for (var y = 0; y < blockVariables.length; y++) {\n      var varName = blockVariables[y];\n      // Variable name may be null if the block is only half-built.\n      if (varName) {\n        variableHash[Blockly.Names.PREFIX_ + varName.toLowerCase()] = varName;\n      }\n    }\n  }\n  // Flatten the hash into a list.\n  var variableList = [];\n  for (var name in variableHash) {\n    variableList.push(variableHash[name]);\n  }\n  return variableList;\n};\n\n/**\n * Find all the variables used in the provided block.\n * @param {Blockly.Block} block Block to check for variables\n * @returns {string[]} Array of all the variables used.\n */\nBlockly.Variables.allVariablesFromBlock = function(block) {\n  if (!block.getVars) {\n    return [];\n  }\n  var varsByCategory = block.getVars();\n  return Object.keys(varsByCategory).reduce(function (vars, category) {\n    return vars.concat(varsByCategory[category]);\n  }, []);\n}\n\n/**\n * Standard implementation of getVars for blocks with a single 'VAR' title\n * @param {string=} opt_category Variable category, defaults to 'Default'\n */\nBlockly.Variables.getVars = function (opt_category) {\n  var category = opt_category || Blockly.Variables.DEFAULT_CATEGORY;\n  var vars = {}\n  vars[category] = [this.getTitleValue('VAR')];\n  return vars;\n}\n\n/**\n * Find all instances of the specified variable in the current workspace and\n * rename them. Does not affect variables in other workspaces.\n * @param {string} oldName Variable to rename.\n * @param {string} newName New variable name.\n * @param {Blockly.BlockSpace} blockSpace BlockSpace to rename child blocks of\n */\nBlockly.Variables.renameVariable = function(oldName, newName, blockSpace) {\n  if (newName === oldName) {\n    return;\n  }\n  var blocks = blockSpace.getAllBlocks({shareMainModal: false});\n  // Iterate through every block.\n  for (var x = 0; x < blocks.length; x++) {\n    var func = blocks[x].renameVar;\n    if (func) {\n      func.call(blocks[x], oldName, newName);\n    }\n  }\n\n  Blockly.FunctionEditor.allFunctionEditors.forEach(function (functionEditor) {\n    if (functionEditor.isOpen()) {\n      functionEditor.renameParameter(oldName, newName);\n      functionEditor.refreshParamsEverywhere();\n    }\n  });\n};\n\n/**\n * Find all instances of the specified variable in the current workspace and\n * delete them. Does not affect variables in other workspaces.\n * @param {string} oldName Variable to rename.\n * @param {Blockly.BlockSpace} blockSpace blockspace context for variable\n */\nBlockly.Variables.deleteVariable = function(nameToRemove, blockSpace) {\n  var blocks = blockSpace.getAllBlocks({shareMainModal: false});\n  // Iterate through every block.\n  for (var x = 0; x < blocks.length; x++) {\n    var func = blocks[x].removeVar;\n    if (func) {\n      func.call(blocks[x], nameToRemove);\n    }\n  }\n  // Notify the modal workspace to remove the parameter from its flyout\n  Blockly.FunctionEditor.allFunctionEditors.forEach(function (functionEditor) {\n    if (functionEditor.isOpen()) {\n      functionEditor.removeParameter(nameToRemove);\n      functionEditor.refreshParamsEverywhere();\n    }\n  });\n};\n\n/**\n * Construct the blocks required by the flyout for the variable category.\n * @param {!Array.<!Blockly.Block>} blocks List of blocks to show.\n * @param {!Array.<number>} gaps List of widths between blocks.\n * @param {number} margin Standard margin width for calculating gaps.\n * @param {!Blockly.BlockSpace} blockSpace The flyout's blockSpace.\n * @param {string} category The category of variables to show.\n * @param {boolean} addDefaultVar Whether to insert a default variable\n */\nBlockly.Variables.flyoutCategory = function(\n  blocks,\n  gaps,\n  margin,\n  blockSpace,\n  category,\n  addDefaultVar\n) {\n  var variableList = Blockly.Variables.allVariables(null, category);\n  variableList.sort(goog.string.caseInsensitiveCompare);\n  if (addDefaultVar) {\n    // In addition to the user's variables, we also want to display the default\n    // variable name at the top.  We also don't want this duplicated if the\n    // user has created a variable of the same name.\n    variableList.unshift(null);\n  }\n  var defaultVariable = undefined;\n  for (var i = 0; i < variableList.length; i++) {\n    if (variableList[i] === defaultVariable) {\n      continue;\n    }\n    var getBlock = Blockly.Variables.getGetter(blockSpace, category);\n    getBlock && getBlock.initSvg();\n    var setBlock = Blockly.Variables.getSetter(blockSpace, category);\n    setBlock && setBlock.initSvg();\n    if (variableList[i] === null && (getBlock || setBlock)) {\n      defaultVariable = (getBlock || setBlock).getVars(category)[0];\n    } else {\n      getBlock && getBlock.setTitleValue(variableList[i], 'VAR');\n      setBlock && setBlock.setTitleValue(variableList[i], 'VAR');\n    }\n    setBlock && blocks.push(setBlock);\n    getBlock && blocks.push(getBlock);\n    if (getBlock && setBlock) {\n      gaps.push(margin, margin * 3);\n    } else {\n      gaps.push(margin * 2);\n    }\n  }\n};\n\nBlockly.Variables.getters = {\n  'Default': 'variables_get',\n};\nBlockly.Variables.getGetter = function(blockSpace, category) {\n  var getterName = Blockly.Variables.getters[category];\n  return (getterName && Blockly.Blocks[getterName]) ?\n      new Blockly.Block(blockSpace, getterName) : null;\n};\nBlockly.Variables.registerGetter = function(category, blockName) {\n  Blockly.Variables.getters[category] = blockName;\n};\n\nBlockly.Variables.setters = {\n  'Default': 'variables_set',\n};\nBlockly.Variables.getSetter = function(blockSpace, category) {\n  var setterName = Blockly.Variables.setters[category];\n  return (setterName && Blockly.Blocks[setterName]) ?\n      new Blockly.Block(blockSpace, setterName) : null;\n};\nBlockly.Variables.registerSetter = function(category, blockName) {\n  Blockly.Variables.setters[category] = blockName;\n};\n\n/**\n* Return a new variable name that is not yet being used. This will try to\n* generate single letter variable names in the range 'i' to 'z' to start with.\n* If no unique name is located it will try 'i1' to 'z1', then 'i2' to 'z2' etc.\n* @return {string} New variable name.\n*/\nBlockly.Variables.generateUniqueName = function(baseName) {\n  if (baseName) {\n    return Blockly.Variables.generateUniqueNameFromBase_(baseName);\n  }\n\n  var variableList = Blockly.Variables.allVariables();\n  var newName = '';\n  if (variableList.length) {\n    variableList.sort(goog.string.caseInsensitiveCompare);\n    var nameSuffix = 0, potName = 'i', i = 0, inUse = false;\n    while (!newName) {\n      i = 0;\n      inUse = false;\n      while (i < variableList.length && !inUse) {\n        if (variableList[i].toLowerCase() == potName) {\n          // This potential name is already used.\n          inUse = true;\n        }\n        i++;\n      }\n      if (inUse) {\n        // Try the next potential name.\n        if (potName[0] === 'z') {\n          // Reached the end of the character sequence so back to 'a' but with\n          // a new suffix.\n          nameSuffix++;\n          potName = 'a';\n        } else {\n          potName = String.fromCharCode(potName.charCodeAt(0) + 1);\n          if (potName[0] == 'l') {\n            // Avoid using variable 'l' because of ambiguity with '1'.\n            potName = String.fromCharCode(potName.charCodeAt(0) + 1);\n          }\n        }\n        if (nameSuffix > 0) {\n          potName += nameSuffix;\n        }\n      } else {\n        // We can use the current potential name.\n        newName = potName;\n      }\n    }\n  } else {\n    newName = 'i';\n  }\n  return newName;\n};\n\n/**\n * Given a base name, attempts to find an unused variable using that baseName\n * followed by an integer. For example, if given \"counter1\", it will look at\n * counter1, then counter2, then counter3, etc.\n * @param {string} baseName\n */\nBlockly.Variables.generateUniqueNameFromBase_ = function(baseName) {\n  var variableList = Blockly.Variables.allVariables();\n  if (variableList.indexOf(baseName) === -1) {\n    return baseName;\n  }\n\n  var num = 1;\n  var match = /^([^\\d]*)(\\d+)$/.exec(baseName);\n  if (match) {\n    baseName = match[1];\n    num = parseInt(match[2], 10) + 1;\n  }\n\n  // There are more efficient ways this could be done if we have large numbers\n  // of variables, but since we expect on the order of 10s in the worst case,\n  // I optimized for code simplicity\n  do {\n    var newName = baseName + num.toString();\n    if (variableList.indexOf(newName) === -1) {\n      return newName;\n    }\n  } while(num++);\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Variable input field.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.FieldVariable');\n\ngoog.require('Blockly.FieldDropdown');\ngoog.require('Blockly.Msg');\ngoog.require('Blockly.Variables');\n\n/**\n * Class for a variable's dropdown field.\n * @param {!string} varname The default name for the variable.  If null,\n *     a unique variable name will be generated.\n * @param {?Function} opt_changeHandler A function that is executed when a new\n *     option is selected.\n * @param {?Function} opt_createHandler A function that is executed after creation\n * @param {?string} opt_category Only show variables from this category\n * @extends {Blockly.FieldDropdown}\n * @constructor\n */\nBlockly.FieldVariable = function(\n    varname,\n    opt_changeHandler,\n    opt_createHandler,\n    opt_category) {\n  this.category = opt_category || Blockly.Variables.DEFAULT_CATEGORY;\n  var changeHandler;\n  if (opt_changeHandler === Blockly.FieldParameter.dropdownChange) {\n    changeHandler = opt_changeHandler;\n  } else if (opt_changeHandler) {\n    // Wrap the user's change handler together with the variable rename handler.\n    var thisObj = this;\n    changeHandler = function(value) {\n      var retVal = thisObj.dropdownChange(value);\n      var newVal;\n      if (retVal === undefined) {\n        newVal = value;  // Existing variable selected.\n      } else if (retVal === null) {\n        newVal = thisObj.getValue();  // Abort, no change.\n      } else {\n        newVal = retVal;  // Variable name entered.\n      }\n      opt_changeHandler.call(thisObj, newVal);\n      return retVal;\n    };\n  } else {\n    changeHandler = this.dropdownChange;\n  }\n\n  Blockly.FieldVariable.superClass_.constructor.call(this,\n      opt_createHandler || Blockly.FieldVariable.dropdownCreate, changeHandler);\n\n  if (varname) {\n    this.setValue(varname);\n  } else {\n    this.setValue(Blockly.Variables.generateUniqueName());\n  }\n};\ngoog.inherits(Blockly.FieldVariable, Blockly.FieldDropdown);\n\n\n/**\n * Get the variable's name (use a variableDB to convert into a real name).\n * Unline a regular dropdown, variables are literal and have no neutral value.\n * @return {string} Current text.\n */\nBlockly.FieldVariable.prototype.getValue = function() {\n  return this.getText();\n};\n\n/**\n * Set the variable name.\n * @param {string} text New text.\n */\nBlockly.FieldVariable.prototype.setValue = function(text) {\n  this.value_ = text;\n  this.setText(text);\n};\n\n/**\n * Return a sorted list of variable names for variable dropdown menus.\n * Include a special option at the end for creating a new variable name.\n * @return {!Array.<string>} Array of variable names.\n * @this {!Blockly.FieldVariable}\n */\nBlockly.FieldVariable.dropdownCreate = function() {\n  var variableList = Blockly.Variables.allVariables(null, this.category);\n  // Ensure that the currently selected variable is an option.\n  var name = this.getText();\n  if (name && variableList.indexOf(name) == -1) {\n    variableList.push(name);\n  }\n  variableList.sort(goog.string.caseInsensitiveCompare);\n  variableList.push(Blockly.Msg.RENAME_VARIABLE);\n  variableList.push(Blockly.Msg.NEW_VARIABLE);\n  // Variables are not language-specific, use the name as both the user-facing\n  // text and the internal representation.\n  var options = [];\n  for (var x = 0; x < variableList.length; x++) {\n    options[x] = [variableList[x], variableList[x]];\n  }\n  return options;\n};\n\n/**\n * Event handler for a change in variable name.\n * Special case the 'New variable...' and 'Rename variable...' options.\n * In both of these special cases, prompt the user for a new name.\n * @param {string} text The selected dropdown menu option.\n * @return {null|undefined|string} An acceptable new variable name, or null if\n *     change is to be either aborted (cancel button) or has been already\n *     handled (rename), or undefined if an existing variable was chosen.\n * @this {!Blockly.FieldVariable}\n */\nBlockly.FieldVariable.prototype.dropdownChange = function(text) {\n  if (text === Blockly.Msg.RENAME_VARIABLE) {\n    var oldVar = this.getText();\n    this.getParentEditor_().hideChaff();\n    Blockly.FieldVariable.modalPromptName(\n        Blockly.Msg.RENAME_VARIABLE_TITLE.replace('%1', oldVar),\n        Blockly.Msg.CONFIRM_RENAME_VARIABLE,\n        oldVar,\n        function(newVar) {\n          Blockly.Variables.renameVariable(oldVar, newVar, this.sourceBlock_.blockSpace);\n        }.bind(this));\n    return null;\n  } else if (text === Blockly.Msg.NEW_VARIABLE) {\n    this.getParentEditor_().hideChaff();\n    Blockly.FieldVariable.modalPromptName(\n        Blockly.Msg.NEW_VARIABLE_TITLE,\n        Blockly.Msg.CONFIRM_CREATE_VARIABLE,\n        '',\n        function(newVar) {\n          this.setText(newVar);\n          // Since variables are case-insensitive, ensure that if the new variable\n          // matches with an existing variable, the new case prevails throughout.\n          Blockly.Variables.renameVariable(newVar, newVar, this.sourceBlock_.blockSpace);\n        }.bind(this));\n    return null;\n  }\n  return undefined;\n};\n\n/**\n * Prompt the user for a variable name and perform some whitespace cleanup\n * @param {string} promptText description text for window prompt\n * @param {string} confirmButtonLabel Label of confirm button, e.g. \"Rename\"\n * @param {string} defaultText default input text for window prompt\n * @param {Function} callback with parameter (text) of new name\n */\nBlockly.FieldVariable.modalPromptName =\n    function(promptText, confirmButtonLabel, defaultText, callback) {\n  Blockly.showSimpleDialog({\n    bodyText: promptText,\n    prompt: true,\n    promptPrefill: defaultText,\n    cancelText: confirmButtonLabel,\n    confirmText: Blockly.Msg.CANCEL,\n    onConfirm: null,\n    onCancel: callback\n  });\n}\n\nBlockly.FieldVariable.removeExtraWhitespace = function(inputString) {\n  var multipleWhitespaceCharactersRegex = /[\\s\\xa0]+/g;\n  var leadingTrailingWhitespaceRegex = /^ | $/g;\n  return inputString\n    .replace(multipleWhitespaceCharactersRegex, ' ')\n    .replace(leadingTrailingWhitespaceRegex, '');\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Variable input field.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.FieldParameter');\n\ngoog.require('Blockly.FieldVariable');\n\n/**\n * Class for a variable's parameter dropdown field.\n * @param {!string} varname The default name for the variable.  If null,\n *     a unique variable name will be generated.\n * @param {?Function} opt_changeHandler A function that is executed when a new\n *     option is selected.\n * @param {?Function} opt_createHandler A function that is executed after creation\n * @extends {Blockly.FieldDropdown}\n * * @extends {Blockly.FieldDropdown}\n * @constructor\n */\nBlockly.FieldParameter = function(varname, opt_changeHandler, opt_createHandler) {\n  Blockly.FieldParameter.superClass_.constructor.call(this, varname,\n    Blockly.FieldParameter.dropdownChange, Blockly.FieldParameter.dropdownCreate);\n};\ngoog.inherits(Blockly.FieldParameter, Blockly.FieldVariable);\n\n/**\n * Return a sorted list of parameter names for parameter dropdown menus.\n * Include a special option at the end for deleting a parameter.\n * @return {!Array.<string>} Array of parameter names.\n * @this {!Blockly.FieldParameter}\n */\nBlockly.FieldParameter.dropdownCreate = function() {\n  var variableList = [\n    Blockly.Msg.RENAME_PARAMETER,\n    Blockly.Msg.DELETE_PARAMETER\n  ];\n  // Variables are not language-specific, use the name as both the user-facing\n  // text and the internal representation.\n  var options = [];\n  for (var x = 0; x < variableList.length; x++) {\n    options[x] = [variableList[x], variableList[x]];\n  }\n  return options;\n};\n\nBlockly.FieldParameter.dropdownChange = function(text) {\n  var oldVar = this.getText();\n  if (text === Blockly.Msg.RENAME_PARAMETER) {\n    this.getParentEditor_().hideChaff();\n    Blockly.FieldVariable.modalPromptName(\n        Blockly.Msg.RENAME_PARAMETER_TITLE.replace('%1', oldVar),\n        Blockly.Msg.CONFIRM_RENAME_VARIABLE,\n        oldVar,\n        function(newVar) {\n          Blockly.Variables.renameVariable(oldVar, newVar, this.sourceBlock_.blockSpace);\n        }.bind(this));\n  } else if (text === Blockly.Msg.DELETE_PARAMETER) {\n    Blockly.showSimpleDialog({\n      bodyText: Blockly.Msg.DELETE_PARAMETER_TITLE.replace('%1', oldVar),\n      cancelText: Blockly.Msg.DELETE,\n      confirmText: Blockly.Msg.KEEP,\n      onConfirm: null,\n      onCancel: function() {\n        Blockly.Variables.deleteVariable(oldVar, this.sourceBlock_.blockSpace);\n      }.bind(this),\n      cancelButtonClass: 'red-delete-button'\n    });\n  }\n  return null;\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Top-level block editing blockSpace\n */\n'use strict';\n\ngoog.provide('Blockly.BlockSpaceEditor');\ngoog.require('Blockly.BlockSpace');\ngoog.require('Blockly.BlockSvgUnused');\ngoog.require('goog.array');\ngoog.require('goog.style');\n\n/**\n * Class for a top-level block editing blockSpace.\n * Handles constructing a top-level SVG element, and positioning, sizing, and certain\n * focus/mouse handling operations for itself.\n * @constructor\n *\n * @param {object} opt_options optional options\n * @param {Function} opt_options.getMetrics A function that returns size/scrolling metrics.\n * @param {Function} opt_options.setMetrics A function that sets size/scrolling metrics.\n * @param {boolean} opt_options.readOnly whether or not to create this as a read-only\n *      BlockSpaceEditor\n * @param {boolean} opt_options.noScrolling whether or not to disable scrolling (only\n *      recommended when readOnly)\n * @param {boolean} opt_options.hideTrashRect The trash rectangle is a dark grey rectangle\n *      covering the entire toolbox area, and is faded in when the user drags a block\n *      towards the toolbox to delete it.  However, when creating a blockspace for\n *      something like the function editor, we don't want to create an additional one,\n *      relying on the main blockspace editor's one instead.\n * @param {boolean} opt_options.readOnly whether or not to initialize this workspace in\n *      readOnly mode. All Blockly elements that are (or can be) aware of this\n *      BlockSpaceEditor will consider Blockly to be in readOnly mode if this\n *      BlockSpaceEditor.readOnly OR Blockly.readOnly are true\n * @param {boolean} opt_options.disableTooltip whether or not to disable tooltips for this\n *      blockSpace. It is recommended that only one blockSpace per page allow tooltips.\n * @param {boolean} opt_options.disableEventBindings whether or not to skip setting up dom\n *      event handlers for this blockspace\n */\nBlockly.BlockSpaceEditor = function(container, opt_options) {\n  opt_options = opt_options || {};\n\n  if (opt_options.getMetrics) {\n    this.getBlockSpaceMetrics_ = opt_options.getMetrics;\n  }\n  if (opt_options.setMetrics) {\n    this.setBlockSpaceMetrics_ = opt_options.setMetrics;\n  }\n  if (opt_options.hideTrashRect) {\n    this.hideTrashRect_ = opt_options.hideTrashRect;\n  }\n  if (opt_options.disableTooltip) {\n    this.disableTooltip = opt_options.disableTooltip;\n  }\n  if (opt_options.disableEventBindings) {\n    this.disableEventBindings = opt_options.disableEventBindings;\n  }\n\n  this.readOnly_ = !!opt_options.readOnly;\n  this.noScrolling_ = !!opt_options.noScrolling;\n  this.inline_ = !!opt_options.inline;\n  this.movementLocked_ = false;\n\n  /**\n   * @type {Blockly.BlockSpace}\n   */\n  this.blockSpace = new Blockly.BlockSpace(this,\n    goog.bind(this.getBlockSpaceMetrics_, this),\n    goog.bind(this.setBlockSpaceMetrics_, this),\n    container\n  );\n\n  /**\n   * Set of blocks with limits, keyed by block type. Used to enforce\n   * limited quantities of blocks in workspace.\n   * @type {Blockly.BlockLimits}\n   */\n  this.blockLimits = new Blockly.BlockLimits();\n\n  this.createDom_(container);\n  this.init_();\n};\n\n/**\n * If enabled, during block bumping the entire block will be bumped into view.\n *\n * If disabled, when dragged off the bottom or right of the blockspace, the\n * block will be bumped until their top or left is within the paddingjust\n * enough block in view to grab.\n * @type {boolean}\n */\nBlockly.BlockSpaceEditor.BUMP_ENTIRE_BLOCK = false;\n\n/**\n * Padding (in pixels) within the inside of the block space for bumping.\n * @type {number}\n * @const\n */\nBlockly.BlockSpaceEditor.ENTIRE_BUMP_PADDING_TOP = 2;\nBlockly.BlockSpaceEditor.ENTIRE_BUMP_PADDING_LEFT = 2;\nBlockly.BlockSpaceEditor.ENTIRE_BUMP_PADDING_BOTTOM = 2;\nBlockly.BlockSpaceEditor.ENTIRE_BUMP_PADDING_RIGHT = 2;\n\nBlockly.BlockSpaceEditor.BUMP_PADDING_TOP = 15;\nBlockly.BlockSpaceEditor.BUMP_PADDING_LEFT = 15;\nBlockly.BlockSpaceEditor.BUMP_PADDING_BOTTOM = 25;\nBlockly.BlockSpaceEditor.BUMP_PADDING_RIGHT = 25;\n\n/**\n * When enabled, draws debug boxes around blocks and dimensions used in bumping\n * logic.\n * @type {boolean}\n */\nBlockly.BlockSpaceEditor.BUMP_DEBUG = false;\n\n/**\n * When enabled, outputs debug logging about block bumping.\n * @type {boolean}\n */\nBlockly.BlockSpaceEditor.SCROLL_DRAG_DEBUG = false;\n\n/**\n * Create an SVG element containing SVG filter and pattern definitions usable\n * within any BlockSpace.\n * @param {Element} container the parent element for the <svg> effects element\n * @private\n */\nBlockly.BlockSpaceEditor.prototype.populateSVGEffects_ = function(container) {\n  if (goog.dom.getElement('blocklySvgDefsGlobal')) {\n    return;\n  }\n  var svg = Blockly.createSvgElement('svg', {\n    id: 'blocklyFilters',\n    width: 0,\n    height: 0,\n    style: 'display: block'\n  }, container);\n  /*\n   <defs>\n   ... filters go here ...\n   </defs>\n   */\n  var defs = Blockly.createSvgElement('defs', {\n    id: 'blocklySvgDefsGlobal'\n  }, svg);\n  var filter, feSpecularLighting, feMerge, pattern;\n  /*\n   <filter id=\"blocklyEmboss\">\n   <feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"1\" result=\"blur\"/>\n   <feSpecularLighting in=\"blur\" surfaceScale=\"1\" specularConstant=\"0.5\"\n   specularExponent=\"10\" lighting-color=\"white\"\n   result=\"specOut\">\n   <fePointLight x=\"-5000\" y=\"-10000\" z=\"20000\"/>\n   </feSpecularLighting>\n   <feComposite in=\"specOut\" in2=\"SourceAlpha\" operator=\"in\"\n   result=\"specOut\"/>\n   <feComposite in=\"SourceGraphic\" in2=\"specOut\" operator=\"arithmetic\"\n   k1=\"0\" k2=\"1\" k3=\"1\" k4=\"0\"/>\n   </filter>\n   */\n  filter = Blockly.createSvgElement('filter', {'id': 'blocklyEmboss'}, defs);\n  Blockly.createSvgElement('feGaussianBlur',\n      {'in': 'SourceAlpha', 'stdDeviation': 1, 'result': 'blur'}, filter);\n  feSpecularLighting = Blockly.createSvgElement('feSpecularLighting',\n      {'in': 'blur', 'surfaceScale': 1, 'specularConstant': 0.5,\n        'specularExponent': 10, 'lighting-color': 'white', 'result': 'specOut'},\n      filter);\n  Blockly.createSvgElement('fePointLight',\n      {'x': -5000, 'y': -10000, 'z': 20000}, feSpecularLighting);\n  Blockly.createSvgElement('feComposite',\n      {'in': 'specOut', 'in2': 'SourceAlpha', 'operator': 'in',\n        'result': 'specOut'}, filter);\n  Blockly.createSvgElement('feComposite',\n      {'in': 'SourceGraphic', 'in2': 'specOut', 'operator': 'arithmetic',\n        'k1': 0, 'k2': 1, 'k3': 1, 'k4': 0}, filter);\n  /*\n   <filter id=\"blocklyTrashcanShadowFilter\">\n   <feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"2\" result=\"blur\"/>\n   <feOffset in=\"blur\" dx=\"1\" dy=\"1\" result=\"offsetBlur\"/>\n   <feMerge>\n   <feMergeNode in=\"offsetBlur\"/>\n   <feMergeNode in=\"SourceGraphic\"/>\n   </feMerge>\n   </filter>\n   */\n  filter = Blockly.createSvgElement('filter',\n      {'id': 'blocklyTrashcanShadowFilter', 'height': '150%', 'y': '-20%'}, defs);\n  Blockly.createSvgElement('feGaussianBlur',\n      {'in': 'SourceAlpha', 'stdDeviation': 2, 'result': 'blur'}, filter);\n  Blockly.createSvgElement('feOffset',\n      {'in': 'blur', 'dx': 1, 'dy': 1, 'result': 'offsetBlur'}, filter);\n  feMerge = Blockly.createSvgElement('feMerge', {}, filter);\n  Blockly.createSvgElement('feMergeNode', {'in': 'offsetBlur'}, feMerge);\n  Blockly.createSvgElement('feMergeNode', {'in': 'SourceGraphic'}, feMerge);\n  /*\n   <filter id=\"blocklyShadowFilter\">\n   <feGaussianBlur stdDeviation=\"2\"/>\n   </filter>\n   */\n  filter = Blockly.createSvgElement('filter',\n      {'id': 'blocklyShadowFilter'}, defs);\n  Blockly.createSvgElement('feGaussianBlur', {'stdDeviation': 2}, filter);\n  /*\n   <pattern id=\"blocklyDisabledPattern\" patternUnits=\"userSpaceOnUse\"\n   width=\"10\" height=\"10\">\n   <rect width=\"10\" height=\"10\" fill=\"#aaa\" />\n   <path d=\"M 0 0 L 10 10 M 10 0 L 0 10\" stroke=\"#cc0\" />\n   </pattern>\n   */\n  pattern = Blockly.createSvgElement('pattern',\n      {'id': 'blocklyDisabledPattern', 'patternUnits': 'userSpaceOnUse',\n        'width': 10, 'height': 10}, defs);\n  Blockly.createSvgElement('rect',\n      {'width': 10, 'height': 10, 'fill': '#aaa'}, pattern);\n  Blockly.createSvgElement('path',\n      {'d': 'M 0 0 L 10 10 M 10 0 L 0 10', 'stroke': '#cc0'}, pattern);\n  /*\n   <filter id=\"blocklyTypeHintFilter\">\n     <feConvolveMatrix order=\"5,5\" kernelMatrix=\"0 0 ... 0.5 1\">\n   </filter>\n   */\n  filter = Blockly.createSvgElement('filter', {\n    id: 'blocklyTypeHintFilter'\n  }, defs);\n  Blockly.createSvgElement('feConvolveMatrix', {\n    order: '5,5',\n    kernelMatrix: '0 0 0 0 0 0 0 0 0.5 1 0.5 1 1 1 1 0 0 0 0 0 0 0 0 0.5 1'\n  }, filter);\n};\n\n/**\n * Create the SVG image.\n * @param {!Element} container Containing element.\n * @private\n */\nBlockly.BlockSpaceEditor.prototype.createDom_ = function(container) {\n  // Sadly browsers (Chrome vs Firefox) are currently inconsistent in laying\n  // out content in RTL mode.  Therefore Blockly forces the use of LTR,\n  // then manually positions content in RTL as needed.\n  container.setAttribute('dir', 'LTR');\n\n  this.populateSVGEffects_(container);\n\n  // Build the SVG DOM.\n  /*\n   <svg\n   xmlns=\"http://www.w3.org/2000/svg\"\n   xmlns:html=\"http://www.w3.org/1999/xhtml\"\n   xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n   version=\"1.1\"\n   class=\"blocklySvg\">\n   ...\n   </svg>\n   */\n  var svg = Blockly.createSvgElement('svg', {\n    'xmlns': 'http://www.w3.org/2000/svg',\n    'xmlns:html': 'http://www.w3.org/1999/xhtml',\n    'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n    'version': '1.1',\n    'class': this.inline_ ? 'blocklySvg inline' : 'blocklySvg'\n  }, null);\n  this.svg_ = svg;\n\n  container.appendChild(svg);\n  goog.events.listen(svg, 'selectstart', function() { return false; });\n  this.defs_ = Blockly.createSvgElement('defs', { id: 'blocklySvgDefs'}, svg);\n  this.blockSpace.maxBlocks = Blockly.maxBlocks;\n\n  // If we're going to have a toolbox, create a rect which is the same\n  // location/dimensions as the HTML div that contains the rest of the toolbox.\n  // This new rect will have the grey shade of the toolbox background.  We create\n  // it here so that blocks can be dragged over the top of it.  The HTML div\n  // appears over the blocks, meaning that blocks dragged to it would appear\n  // underneath it, if it had a background color, which wouldn't look as good.\n  if (!this.hideTrashRect_ && !this.isReadOnly() && Blockly.hasCategories) {\n    this.svgBackground_ = Blockly.createSvgElement('rect',\n      {'id': 'toolboxRect', 'class': 'blocklyToolboxBackground'},\n      this.svg_);\n  }\n\n  svg.appendChild(this.blockSpace.createDom());\n\n  if (!this.isReadOnly()) {\n    // Determine if there needs to be a category tree, or a simple list of\n    // blocks.  This cannot be changed later, since the UI is very different.\n    this.addToolboxOrFlyout_();\n\n    // Add a handler that allows the workspace to bump blocks back into their\n    // working area.\n    this.addChangeListener(this.bumpBlocksIfNotDragging);\n  }\n\n  /**\n   * When disabled, we wont allow you to drag blocks into blockSpace\n   */\n  this.setEnableToolbox = function (enabled) {\n    if (!this.isReadOnly()) {\n      if (this.flyout_) {\n        this.flyout_.setEnabled(enabled);\n      } else if (this.toolbox) {\n        this.toolbox.enabled = enabled;\n      }\n    }\n  };\n\n  if (!this.disableTooltip) {\n    svg.appendChild(Blockly.Tooltip.createDom());\n  }\n  this.svgResize();\n\n  // Create an HTML container for popup overlays (e.g. editor widgets).\n  if (!Blockly.WidgetDiv.DIV) {\n    Blockly.WidgetDiv.DIV = goog.dom.createDom('div', 'blocklyWidgetDiv');\n    Blockly.WidgetDiv.DIV.style.direction = Blockly.RTL ? 'rtl' : 'ltr';\n    document.body.appendChild(Blockly.WidgetDiv.DIV);\n  }\n};\n\n/**\n * Adds an SVG element to this BlockSpace's <defs>\n * @param {SVGElement} definitionToAdd\n */\nBlockly.BlockSpaceEditor.prototype.addToSvgDefs = function(definitionToAdd) {\n  this.defs_.appendChild(definitionToAdd);\n};\n\nBlockly.BlockSpaceEditor.prototype.addToolboxOrFlyout_ = function() {\n  if (Blockly.hasCategories) {\n    this.toolbox = new Blockly.Toolbox(this);\n  } else {\n    this.addFlyout_();\n  }\n};\n\nBlockly.BlockSpaceEditor.prototype.addFlyout_ = function() {\n  /**\n   * @type {?Blockly.Flyout}\n   * @private\n   */\n  this.flyout_ = new Blockly.Flyout(this, true);\n  var flyout = this.flyout_;\n  var flyoutSvg = flyout.createDom(false);\n  flyout.init(this.blockSpace, true);\n  flyout.autoClose = false;\n  // Insert the flyout behind the blockSpace so that blocks appear on top.\n  if (Blockly.isPortrait) {\n    goog.dom.insertSiblingAfter(flyoutSvg, this.blockSpace.svgGroup_);\n  } else {\n    goog.dom.insertSiblingBefore(flyoutSvg, this.blockSpace.svgGroup_);\n  }\n};\n\n/**\n * Gather and return a list of delete rectangles related to this editor.\n * @public\n * @return {Array.<Rect>} A list of delete area rectangles.\n */\nBlockly.BlockSpaceEditor.prototype.getDeleteAreas = function() {\n  var deleteAreas = [];\n\n  if (this.flyout_) {\n    goog.array.extend(deleteAreas, this.flyout_.getRect());\n  }\n\n  if (this.toolbox) {\n    goog.array.extend(deleteAreas, this.toolbox.getRect());\n  }\n\n  return deleteAreas;\n};\n\n/**\n * If a drag operation is not active, bumps blocks into the BlockSpace.\n */\nBlockly.BlockSpaceEditor.prototype.bumpBlocksIfNotDragging = function() {\n  // Immediately return if dragging, to avoid expensive calculations\n  if (Blockly.Block.isDragging()) {\n    return;\n  }\n\n  this.bumpBlocksIntoBlockSpace();\n};\n\n/**\n * Bumps blocks back in to BlockSpace area.\n * If BUMP_ENTIRE_BLOCK is true, bumps entire block back in.\n * If BUMP_ENTIRE_BLOCK is false, bumps just enough for block to be grippable\n *     within a padded inner area.\n * @private\n */\nBlockly.BlockSpaceEditor.prototype.bumpBlocksIntoBlockSpace = function() {\n  // Can't bump if we don't know our workspace dimensions\n  var metrics = this.blockSpace.getMetrics();\n  if (!metrics) {\n    return;\n  }\n\n  if (!Blockly.BlockSpaceEditor.BUMP_ENTIRE_BLOCK) {\n    var blockSpaceSize = this.blockSpace.getScrollableSize(metrics);\n\n    // Calculate bounds of view, including bump padding\n    var blockSpaceInnerTop = Blockly.BlockSpaceEditor.BUMP_PADDING_TOP;\n    var blockSpaceInnerLeft = Blockly.BlockSpaceEditor.BUMP_PADDING_LEFT;\n    var blockSpaceInnerBottom = blockSpaceSize.height\n      - Blockly.BlockSpaceEditor.BUMP_PADDING_BOTTOM;\n    var blockSpaceInnerRight = blockSpaceSize.width\n      - Blockly.BlockSpaceEditor.BUMP_PADDING_RIGHT;\n    var blockSpaceInnerWidth = blockSpaceInnerRight - blockSpaceInnerLeft;\n    var blockSpaceInnerHeight = blockSpaceInnerBottom - blockSpaceInnerTop;\n  }\n\n  // Check every block, and bump if needed.\n  this.blockSpace.getTopBlocks(false, false).forEach(function (block) {\n    if (!block.isVisible() || block.isCurrentlyBeingDragged()) {\n      return;\n    }\n\n    if (!Blockly.BlockSpaceEditor.BUMP_ENTIRE_BLOCK) {\n      // Skip block if it doesn't fit in the view anyway.\n      var blockHW = block.getHeightWidth();\n      if (blockHW.width > blockSpaceInnerWidth || blockHW.height > blockSpaceInnerHeight) {\n        return;\n      }\n    }\n\n    var howFarOutsideLeft, howFarOutsideRight, howFarAboveTop, howFarBelowBottom;\n\n    if (!Blockly.BlockSpaceEditor.BUMP_ENTIRE_BLOCK) {\n      // If these values are positive, the block needs to be bumped\n      var blockXY = block.getRelativeToSurfaceXY();\n      howFarOutsideLeft = Math.max(0, blockSpaceInnerLeft - blockXY.x);\n      howFarOutsideRight = Math.max(0, blockXY.x - blockSpaceInnerRight);\n      howFarAboveTop = Math.max(0, blockSpaceInnerTop - blockXY.y);\n      howFarBelowBottom = Math.max(0, blockXY.y - blockSpaceInnerBottom);\n    } else {\n      var paddedBlockSpaceBox = this.blockSpace.getScrollableBox()\n        .expand(-Blockly.BlockSpaceEditor.ENTIRE_BUMP_PADDING_TOP,\n        -Blockly.BlockSpaceEditor.ENTIRE_BUMP_PADDING_RIGHT,\n        -Blockly.BlockSpaceEditor.ENTIRE_BUMP_PADDING_BOTTOM,\n        -Blockly.BlockSpaceEditor.ENTIRE_BUMP_PADDING_LEFT);\n      var originalBlockBox = block.getBox();\n      var overflow = Blockly.getBoxOverflow(paddedBlockSpaceBox, originalBlockBox);\n\n      // If overflow values are positive, the block needs to be bumped\n      howFarOutsideLeft = Math.max(0, overflow.left);\n      howFarOutsideRight = Math.max(0, overflow.right);\n      howFarAboveTop = Math.max(0, overflow.top);\n      howFarBelowBottom = Math.max(0, overflow.bottom);\n    }\n\n    // Calculate needed bump\n    var moveX = howFarOutsideLeft ? howFarOutsideLeft : -howFarOutsideRight;\n    var moveY = howFarAboveTop ? howFarAboveTop : -howFarBelowBottom;\n\n    if (Blockly.BlockSpaceEditor.BUMP_ENTIRE_BLOCK) {\n      // If the block doesn't fit in the view, move, instead, flush to the left\n      // or top.\n      if (Blockly.isBoxWiderThan(originalBlockBox, paddedBlockSpaceBox)) {\n        moveX = overflow.left;\n      }\n      if (Blockly.isBoxTallerThan(originalBlockBox, paddedBlockSpaceBox)) {\n        moveY = overflow.top\n      }\n    }\n\n    var shouldBump = moveX || moveY;\n    if (shouldBump) {\n      block.moveBy(moveX, moveY);\n    }\n\n    if (Blockly.BlockSpaceEditor.BUMP_DEBUG &&\n        Blockly.BlockSpaceEditor.BUMP_ENTIRE_BLOCK) {\n      var afterBumpBlockBox = block.getBox();\n      var originalBlockBoxColor = shouldBump ? \"red\" : \"green\";\n      this.blockSpace.drawDebugBox(\"block box\" + block.id,\n        originalBlockBox, originalBlockBoxColor);\n      this.blockSpace.drawDebugBox(\"block after\" + block.id,\n        afterBumpBlockBox, \"purple\");\n      this.blockSpace.drawDebugBox(\"block space box\" + block.id,\n        paddedBlockSpaceBox, \"blue\");\n    }\n  }, this);\n};\n\n\nBlockly.BlockSpaceEditor.prototype.init_ = function() {\n  this.detectBrokenControlPoints();\n\n  // Bind pan-drag handlers\n  this.blockSpace.bindBeginPanDragHandler(this.svg_,\n    goog.bind(this.hideChaff, this));\n  this.blockSpace.bindScrollOnWheelHandler(this.svg_);\n\n  Blockly.bindEvent_(Blockly.WidgetDiv.DIV, 'contextmenu', null,\n    Blockly.blockContextMenu);\n\n  if (!this.disableEventBindings && !Blockly.documentEventsBound_) {\n    // Only bind the window/document events once.\n    // Destroying and reinjecting Blockly should not bind again.\n    Blockly.bindEvent_(window, 'resize', this, this.svgResize);\n    Blockly.bindEvent_(document, 'keydown', this, this.onKeyDown_);\n    Blockly.bindEvent_(document, 'copy', this, this.onCutCopy_);\n    Blockly.bindEvent_(document, 'cut', this, this.onCutCopy_);\n    Blockly.bindEvent_(document, 'paste', this, this.onPaste_);\n    // Some iPad versions don't fire resize after portrait to landscape change.\n    if (goog.userAgent.IPAD) {\n      Blockly.bindEvent_(window, 'orientationchange', document, function () {\n        Blockly.fireUiEvent(window, 'resize');\n      }, false);\n    }\n    Blockly.documentEventsBound_ = true;\n  }\n\n  if (Blockly.languageTree && !this.isReadOnly()) {\n    if (Blockly.hasCategories) {\n      this.toolbox.init(this.blockSpace, this);\n    } else {\n      // Build a fixed flyout with the root blocks.\n      this.flyout_.init(this.blockSpace, true);\n      this.updateFlyout();\n    }\n  }\n  if (!this.noScrolling_ &&\n      (Blockly.hasVerticalScrollbars || Blockly.hasHorizontalScrollbars)) {\n    this.blockSpace.scrollbarPair = new Blockly.ScrollbarPair(\n      this.blockSpace, Blockly.hasHorizontalScrollbars, Blockly.hasVerticalScrollbars);\n    this.blockSpace.scrollbarPair.resize();\n  }\n};\n\nBlockly.BlockSpaceEditor.prototype.updateFlyout = function() {\n  if (this.flyout_ && Blockly.languageTree) {\n    this.flyout_.show(Blockly.languageTree.childNodes);\n    this.svgResize();\n  }\n};\n\nBlockly.BlockSpaceEditor.prototype.getAllFlyoutBlocks = function() {\n  if (!this.flyout_) {\n    return [];\n  }\n  return this.flyout_.getAllBlocks();\n};\n\nBlockly.BlockSpaceEditor.prototype.detectBrokenControlPoints = function() {\n  if (goog.userAgent.WEBKIT) {\n    /* HACK:\n     WebKit bug 67298 causes control points to be included in the reported\n     bounding box.  Detect if this browser suffers from this bug by drawing a\n     shape that is 50px high, and has a control point that sticks up by 5px.\n     If the getBBox function returns a height of 55px instead of 50px, then\n     this browser has broken control points.\n\n     This was fixed in Chrome 63. BROKEN_CONTROL_POINTS and all this detector\n     code can be removed when we drop support for Chrome versions older than\n     that.\n     */\n    var container = Blockly.createSvgElement('g', {}, this.svg_);\n    Blockly.createSvgElement('path',\n      {'d': 'm 0,0 c 0,-5 0,-5 0,0 H 50 V 50 z'}, container);\n    if (Blockly.isMsie() || Blockly.isTrident()) {\n      container.style.display = \"inline\";\n      /* reqd for IE */\n      container.bBox_ = {\n        x: container.getBBox().x,\n        y: container.getBBox().y,\n        width: container.scrollWidth,\n        height: container.scrollHeight\n      };\n    }\n    else {\n      container.bBox_ = container.getBBox();\n    }\n    // if (container.bBox_.height > 50) {\n    //   // Chrome (v28) and Opera (v15) report 55, Safari (v6.0.5) reports 53.75.\n    //   // Blockly.BROKEN_CONTROL_POINTS = true;\n    // }\n    this.svg_.removeChild(container);\n  }\n};\n\n\n/**\n * Returns the dimensions of the current SVG image.\n * @return {!Object} Contains width, height, top and left properties.\n */\nBlockly.BlockSpaceEditor.prototype.svgSize = function() {\n  return {\n    width: this.svg_.cachedWidth_,\n    height: this.svg_.cachedHeight_\n  };\n};\n\n/**\n * Size the SVG image to completely fill its container.  Record both\n * the height/width and the absolute position of the SVG image.\n */\nBlockly.BlockSpaceEditor.prototype.svgResize = function() {\n  var svg = this.svg_;\n  var svgStyle = window.getComputedStyle(svg);\n  var svgBorderWidth = 0;\n  if (svgStyle) {\n    svgBorderWidth = (parseInt(svgStyle.borderLeftWidth, 10) || 0) +\n      (parseInt(svgStyle.borderRightWidth, 10) || 0);\n  }\n\n  // Subtract any pixels present above the svg element from the available height\n  var containerDiv = svg.parentNode;\n  var headerHeight = this.getWorkspaceTopOffset();\n\n  var svgWidth = containerDiv.clientWidth - svgBorderWidth;\n  var svgHeight = containerDiv.clientHeight - headerHeight;\n\n  if (svg.cachedWidth_ != svgWidth) {\n    svg.setAttribute('width', svgWidth + 'px');\n    svg.cachedWidth_ = svgWidth;\n  }\n  if (svg.cachedHeight_ != svgHeight) {\n    svg.setAttribute('height', svgHeight + 'px');\n    svg.cachedHeight_ = svgHeight;\n  }\n\n  // Update the scrollbars (if they exist).\n  if (this.blockSpace.scrollbarPair) {\n    this.blockSpace.scrollbarPair.resize();\n  } else {\n    this.setBlockSpaceMetricsNoScroll_();\n  }\n};\n\nBlockly.BlockSpaceEditor.prototype.getWorkspaceTopOffset = function() {\n  var svg = this.svg_;\n  var containerDiv = svg.parentNode;\n  var containerStyle = window.getComputedStyle(containerDiv);\n  var containerTopBorder = containerStyle ? (parseInt(containerStyle.borderTopWidth, 10) || 0) : 0;\n  return goog.style.getPageOffsetTop(svg) -\n    (goog.style.getPageOffsetTop(containerDiv) + containerTopBorder);\n};\n\n/**\n * @param {Element} svgElementToAdd\n */\nBlockly.BlockSpaceEditor.prototype.appendSVGChild = function(svgElementToAdd) {\n  this.svg_.appendChild(svgElementToAdd);\n};\n\n/**\n * @returns {!SVGElement}\n */\nBlockly.BlockSpaceEditor.prototype.getSVGElement = function() {\n  return this.svg_;\n};\n\n/**\n * @return {number} Return the width, in pixels, of the blockSpace.\n */\nBlockly.BlockSpaceEditor.prototype.getBlockSpaceWidth = function() {\n  var metrics = this.blockSpace.getMetrics();\n  return metrics ? metrics.viewWidth : 0;\n};\n\n/**\n * @return {number} Return the width, in pixels, of the main blockSpace's toolbox.\n * Note, this includes the categories tree (for levels with categories).\n */\nBlockly.BlockSpaceEditor.prototype.getToolboxWidth = function() {\n  var width = 0;\n  var flyout = this.flyout_ || (this.toolbox && this.toolbox.flyout_);\n  if (flyout) {\n    var metrics = flyout.blockSpace_.getMetrics();\n    if (metrics) {\n      width = metrics.viewWidth;\n    }\n  }\n  if (this.toolbox) {\n    width += this.toolbox.HtmlDiv.getBoundingClientRect().width;\n  }\n  return width;\n};\n\n/**\n* Set the cursor to be displayed when over something draggable.\n* @param {Blockly.Cursor} cursorType Enum.\n*/\nBlockly.BlockSpaceEditor.prototype.setCursor = function(cursorType) {\n  Blockly.Css.setCursor(cursorType, this.svg_);\n};\n\n/**\n * Handle a key-down on SVG drawing surface.\n * @param {!Event} e Key down event.\n * @private\n */\nBlockly.BlockSpaceEditor.prototype.onKeyDown_ = function(e) {\n  if (Blockly.isTargetInput(e)) {\n    // When focused on an HTML text input widget, don't trap any keys.\n    return;\n  }\n  if (e.keyCode == 9 || e.keyCode == 27) {\n    // Pressing tab or esc closes the context menu.\n    this.hideChaff();\n  } else if (e.keyCode == 8 || e.keyCode == 46) {\n    // Delete or backspace.\n    try {\n      if (Blockly.selected && Blockly.selected.isDeletable()) {\n        this.hideChaff();\n        Blockly.selected.dispose(true, true);\n      }\n    } finally {\n      // Stop the browser from going back to the previous page.\n      // Use a finally so that any error in delete code above doesn't disappear\n      // from the console when the page rolls back.\n      e.preventDefault();\n    }\n  } else if (e.altKey || e.ctrlKey || e.metaKey) {\n    if (Blockly.selected &&\n      Blockly.selected.isDeletable() &&\n      Blockly.selected.isCopyable()) {\n      this.hideChaff();\n      if (e.keyCode == 67 || e.keyCode == 88) {\n        // 'c' for copy, 'x' for cut.\n        Blockly.BlockSpaceEditor.copy_(Blockly.selected);\n      }\n    }\n  }\n};\n\n/**\n * Handle a clipboard copy on SVG drawing surface.\n * @param {!Event} e Copy event.\n * @private\n */\nBlockly.BlockSpaceEditor.prototype.onCutCopy_ = function(e) {\n  if (Blockly.selected) {\n    e.clipboardData.setData('text/xml', Blockly.clipboard_);\n    e.preventDefault();\n\n    if (e.type === 'cut') {\n      Blockly.selected.dispose(true, true);\n    }\n  }\n};\n\n/**\n * Handle a clipboard paste on SVG drawing surface.\n * @param {!Event} e Paste event.\n * @private\n */\nBlockly.BlockSpaceEditor.prototype.onPaste_ = function(e) {\n  try {\n    var xml = Blockly.Xml.textToDom(e.clipboardData.getData('text/xml') || e.clipboardData.getData('text/plain'));\n    Blockly.focusedBlockSpace.paste(xml);\n  } catch (e) {\n    if (!/did not obtain a valid XML tree/.test(e)) {\n      throw e;\n    }\n  }\n};\n\n/**\n * Stop binding to the global mouseup and mousemove events.\n * @private\n */\nBlockly.BlockSpaceEditor.terminateDrag_ = function() {\n  Blockly.Block.terminateDrag_();\n  Blockly.Flyout.terminateDrag_();\n};\n\n/**\n * Copy a block onto the local clipboard.\n * @param {!Blockly.Block} block Block to be copied.\n * @private\n */\nBlockly.BlockSpaceEditor.copy_ = function(block) {\n  var xmlBlock = Blockly.Xml.blockToDom(block);\n  Blockly.Xml.deleteNext(xmlBlock);\n  // Encode start position in XML.\n  var xy = block.getRelativeToSurfaceXY();\n  xmlBlock.setAttribute('x', Blockly.RTL ? -xy.x : xy.x);\n  xmlBlock.setAttribute('y', xy.y);\n  // To be read by `this.onCutCopy_`.\n  Blockly.clipboard_ = '<xml>' + Blockly.Xml.domToText(xmlBlock) + '</xml>';\n};\n\n/**\n * Show the context menu for the blockSpace.\n * @param {!Event} e Mouse event\n * @private\n */\nBlockly.BlockSpaceEditor.showContextMenu_ = function(e) {\n  if (this.isReadOnly()) {\n    return;\n  }\n  var options = [];\n\n  if (Blockly.collapse) {\n    var hasCollapsedBlocks = false;\n    var hasExpandedBlocks = false;\n    var topBlocks = this.getTopBlocks(false);\n    for (var i = 0; i < topBlocks.length; i++) {\n      if (topBlocks[i].isCollapsed()) {\n        hasCollapsedBlocks = true;\n      } else {\n        hasExpandedBlocks = true;\n      }\n    }\n\n    // Option to collapse top blocks.\n    var collapseOption = {enabled: hasExpandedBlocks};\n    collapseOption.text = Blockly.Msg.COLLAPSE_ALL;\n    collapseOption.callback = function() {\n      for (var i = 0; i < topBlocks.length; i++) {\n        topBlocks[i].setCollapsed(true);\n      }\n    };\n    options.push(collapseOption);\n\n    // Option to expand top blocks.\n    var expandOption = {enabled: hasCollapsedBlocks};\n    expandOption.text = Blockly.Msg.EXPAND_ALL;\n    expandOption.callback = function() {\n      for (var i = 0; i < topBlocks.length; i++) {\n        topBlocks[i].setCollapsed(false);\n      }\n    };\n    options.push(expandOption);\n  }\n\n  // Option to get help.\n  var helpOption = {enabled: false};\n  helpOption.text = Blockly.Msg.HELP;\n  helpOption.callback = function() {};\n  options.push(helpOption);\n\n  Blockly.ContextMenu.show(e, options);\n};\n\n/**\n * Close tooltips, context menus, dropdown selections, etc.\n * @param {boolean=} opt_allowToolbox If true, don't close the toolbox.\n */\nBlockly.BlockSpaceEditor.prototype.hideChaff = function(opt_allowToolbox) {\n  Blockly.Tooltip.hide();\n  Blockly.WidgetDiv.hide();\n  if (this.toolbox && !opt_allowToolbox &&\n    this.toolbox.flyout_ && this.toolbox.flyout_.autoClose) {\n    this.toolbox.clearSelection();\n  }\n};\n\n/**\n * Return an object with all the metrics required to size scrollbars for the\n * main blockSpace.\n *\n * Returned object may be null, typically if the blockspace is not visible and\n * we are running Firefox.\n *\n * The following properties are computed:\n * .viewHeight: Height of the visible rectangle,\n * .viewWidth: Width of the visible rectangle,\n * .contentHeight: Height of the contents,\n * .contentWidth: Width of the content,\n * .viewTop: Offset of top edge of visible rectangle from parent,\n * .viewLeft: Offset of left edge of visible rectangle from parent,\n * .contentTop: Offset of the top-most content from the y=0 coordinate,\n * .contentLeft: Offset of the left-most content from the x=0 coordinate.\n * .absoluteTop: Top-edge of view.\n * .absoluteLeft: Left-edge of view.\n * @return {Object|null} Contains size and position metrics of main blockSpace.\n * @private\n */\nBlockly.BlockSpaceEditor.prototype.getBlockSpaceMetrics_ = function() {\n  /** @type {goog.math.Rect} */\n  var blockBoundingRect;\n\n  var svgSize = this.svgSize(); // includes toolbox\n  var toolboxWidth = 0;\n  if (this.toolbox || this.flyout_) {\n    toolboxWidth = this.toolbox ? this.toolbox.width : (Blockly.isPortrait? 0 : this.flyout_.width_);\n  }\n  svgSize.width -= toolboxWidth;\n  try {\n    var mainCanvasBBox = this.getCanvasBBox(this.blockSpace.getCanvas());\n    blockBoundingRect = Blockly.svgRectToRect(mainCanvasBBox);\n    if (this.blockSpace.pickedUpBlockOrigin_) {\n      // Expand the blockBoundingRect to include origin of block being dragged\n      blockBoundingRect.boundingRect(this.blockSpace.pickedUpBlockOrigin_);\n    }\n  } catch (e) {\n    // Firefox has trouble with hidden elements (Bug 528969).\n    return null;\n  }\n\n  var absoluteLeft = Blockly.RTL ? 0 : toolboxWidth;\n\n  // view*: Viewport dimensions relative to workspace 0,0\n  // content*: Bounding rect on actual blocks, relative to workspace 0,0\n  // absolute*: Blockspace origin offset from the SVG element origin\n  //            (top right of toolbox in LTR, top left of SVG in RTL)\n  var viewLeft = this.blockSpace.getScrollOffsetX();\n  var viewWidth = svgSize.width;\n  var viewHeight = svgSize.height;\n  var viewTop = this.blockSpace.getScrollOffsetY();\n\n  return {\n    viewHeight: viewHeight,\n    viewWidth: viewWidth,\n    viewTop: viewTop,\n    viewLeft: viewLeft,\n    contentHeight: blockBoundingRect.height,\n    contentWidth: blockBoundingRect.width,\n    contentTop: blockBoundingRect.top,\n    contentLeft: blockBoundingRect.left,\n    absoluteTop: 0,\n    absoluteLeft: absoluteLeft\n  };\n};\n\n/**\n * Gets a bbox\n * May throw error if canvas is hidden in Firefox\n * @param {SVGGElement} canvas - the svg canvas\n * @returns {SVGRect}\n */\nBlockly.BlockSpaceEditor.prototype.getCanvasBBox = function(canvas) {\n  if (Blockly.isMsie() || Blockly.isTrident()) {\n    canvas.style.display = \"inline\"; // required for IE\n    return {\n      x: canvas.getBBox().x,\n      y: canvas.getBBox().y,\n      width: canvas.scrollWidth,\n      height: canvas.scrollHeight\n    };\n  }\n\n  return canvas.getBBox();\n};\n\n/**\n * Sets the X/Y translations of the main blockSpace to match the scrollbars.\n * @param {!Object} xyRatio Contains an x and/or y property which is a float\n *     between 0 and 1 specifying the degree of scrolling.\n * @private\n */\nBlockly.BlockSpaceEditor.prototype.setBlockSpaceMetrics_ = function(xyRatio) {\n  if (!this.blockSpace.scrollbarPair) {\n    throw \"Attempt to set editor's scroll position without scrollbars.\";\n  }\n  var metrics = this.getBlockSpaceMetrics_();\n  var blockSpaceSize = this.blockSpace.getScrollableSize(metrics);\n  if (goog.isNumber(xyRatio.x)) {\n    this.blockSpace.xOffsetFromView = -blockSpaceSize.width * xyRatio.x;\n  }\n  if (goog.isNumber(xyRatio.y)) {\n    this.blockSpace.yOffsetFromView = -blockSpaceSize.height * xyRatio.y;\n  }\n  var x = this.blockSpace.xOffsetFromView + metrics.absoluteLeft;\n  var y = this.blockSpace.yOffsetFromView + metrics.absoluteTop;\n  var translation = 'translate(' + x + ',' + y + ')';\n  this.blockSpace.getCanvas().setAttribute('transform', translation);\n  this.blockSpace.getBubbleCanvas().setAttribute('transform', translation);\n  if (this.blockSpace.getTrashCan()) {\n    this.blockSpace.getTrashCan().setAttribute(\"style\", \"display: block; pointer-events: none\");\n    this.blockSpace.getTrashCan().setAttribute('transform', 'translate(' + (metrics.absoluteLeft + metrics.viewWidth - 100) + ',' + 0 + ')');\n  }\n\n  var offset = Blockly.convertCoordinates(x, y, this.svg_, false);\n  this.blockSpace.getDragCanvas().setAttribute('transform', 'translate(' + offset.x + ',' + offset.y + ')');\n};\n\n/**\n * Sets the X/Y translations of the main blockSpace when scrollbars are\n * disabled.\n * @private\n */\nBlockly.BlockSpaceEditor.prototype.setBlockSpaceMetricsNoScroll_ = function() {\n  var metrics = this.getBlockSpaceMetrics_();\n  if (metrics) {\n    var translation = 'translate(' + (metrics.absoluteLeft) + ',' +\n      (metrics.absoluteTop) + ')';\n    this.blockSpace.getCanvas().setAttribute('transform', translation);\n    this.blockSpace.getBubbleCanvas().setAttribute('transform',\n      translation);\n\n    var offset = Blockly.convertCoordinates(metrics.absoluteLeft, metrics.absoluteTop, this.svg_, false);\n    this.blockSpace.getDragCanvas().setAttribute('transform', 'translate(' + offset.x + ',' + offset.y + ')');\n  }\n};\n\n/**\n * When something in Blockly's blockSpace changes, call a function.\n * @param {!Function} func Function to call.\n * @return {BindData} Opaque data that can be passed to\n *     removeChangeListener.\n */\nBlockly.BlockSpaceEditor.prototype.addChangeListener = function(func) {\n  return Blockly.bindEvent_(this.blockSpace.getCanvas(),\n    'blocklyBlockSpaceChange', this, func);\n};\nBlockly.BlockSpaceEditor.prototype.addUnusedBlocksHelpListener = function(func) {\n  return Blockly.bindEvent_(this.blockSpace.getCanvas(),\n    Blockly.BlockSvgUnused.UNUSED_BLOCK_HELP_EVENT, this, func);\n};\n\n/**\n * @returns {boolean}\n */\nBlockly.BlockSpaceEditor.prototype.isReadOnly = function() {\n  return (Blockly.readOnly || this.readOnly_);\n};\n\n/**\n * Disable block movement, but unlike readonly mode still allow field editing.\n */\nBlockly.BlockSpaceEditor.prototype.lockMovement = function() {\n  this.movementLocked_ = true;\n};\n\nBlockly.BlockSpaceEditor.prototype.unlockMovement = function() {\n  this.movementLocked_ = false;\n};\n\nBlockly.BlockSpaceEditor.prototype.isMovementLocked = function() {\n  return this.movementLocked_;\n};\n\n/**\n * @returns {boolean}\n */\nBlockly.BlockSpaceEditor.prototype.shouldHavePadding = function() {\n  return !this.inline_;\n};\n\n/**\n * Stop listening for Blockly's blockSpace changes.\n * @param {BindData} BindData Opaque data from addChangeListener.\n */\nBlockly.removeChangeListener = function(bindData) {\n  Blockly.unbindEvent_(bindData);\n};\n","/**\n * @fileoverview Horizontal flyout tray with no categories.\n */\n'use strict';\n\ngoog.provide('Blockly.HorizontalFlyout');\n\ngoog.require('Blockly.Flyout');\ngoog.require('Blockly.Block');\n\n/**\n * Class for a horizontal flyout.\n * @constructor\n */\nBlockly.HorizontalFlyout = function(blockSpaceEditor) {\n  Blockly.Flyout.apply(this, arguments);\n  this.autoClose = false;\n  this.height_ = 10;\n  this.flyoutRows = 0;\n  this.customYOffset = 0;\n};\ngoog.inherits(Blockly.HorizontalFlyout, Blockly.Flyout);\n\n/**\n * Show and populate the flyout.\n * @param {!Array|string} xmlList List of blocks to show.\n *     Variables and procedures have a custom set of blocks.\n */\nBlockly.HorizontalFlyout.prototype.show = function(xmlList) {\n  var metrics = this.targetBlockSpace_.getMetrics();\n  this.width_ = Math.max(0, metrics.viewWidth - this.CORNER_RADIUS * 2);\n  Blockly.HorizontalFlyout.superClass_.show.apply(this, arguments);\n};\n\n/**\n * Hide and empty the flyout.\n */\nBlockly.HorizontalFlyout.prototype.hide = function() {\n  this.height_ = 10;\n  this.flyoutRows = 0;\n  Blockly.HorizontalFlyout.superClass_.hide.apply(this, arguments);\n};\n\nBlockly.HorizontalFlyout.prototype.setVisibility = function(show) {\n  if (show) {\n    this.softShow();\n  } else {\n    this.softHide();\n  }\n};\n\n/**\n * Hides flyoutsoft in that it doesn't destroy all flyout blocks\n */\nBlockly.HorizontalFlyout.prototype.softHide = function() {\n  Blockly.addClass_(this.svgGroup_, 'hiddenFlyout');\n};\n\n/**\n * Shows flyoutsoft in that it doesn't also populate new blocks\n */\nBlockly.HorizontalFlyout.prototype.softShow = function() {\n  Blockly.removeClass_(this.svgGroup_, 'hiddenFlyout');\n};\n\n/**\n * Move the toolbox to the top of the workspace.\n * @private\n */\nBlockly.HorizontalFlyout.prototype.position_ = function() {\n  if (!this.isVisible()) {\n    return;\n  }\n  var metrics = this.targetBlockSpace_.getMetrics();\n  if (!metrics) {\n    // Hidden components will return null.\n    return;\n  }\n  var edgeHeight = this.height_ - this.CORNER_RADIUS;\n  var edgeWidth = Math.max(0, metrics.viewWidth - this.CORNER_RADIUS * 2);\n  var path = ['M 0,0'];\n  path.push('v', edgeHeight);\n  path.push('a', this.CORNER_RADIUS, this.CORNER_RADIUS, 0, 0, 0,\n      this.CORNER_RADIUS,\n      this.CORNER_RADIUS);\n  path.push('h', edgeWidth);\n  path.push('a', this.CORNER_RADIUS, this.CORNER_RADIUS, 0, 0, 0,\n      this.CORNER_RADIUS,\n      -this.CORNER_RADIUS);\n  path.push('v', -edgeHeight);\n  path.push('z');\n  this.svgBackground_.setAttribute('d', path.join(' '));\n\n  this.width_ = edgeWidth;\n  var x = metrics.absoluteLeft;\n  var y = metrics.absoluteTop - this.height_ + this.customYOffset;\n  this.svgGroup_.setAttribute('transform', 'translate(' + x + ',' + y + ')');\n\n  // Update the scrollbar (if one exists).\n  if (this.scrollbar_) {\n    this.scrollbar_.resize();\n  }\n\n  this.svgBackground_.style.pointerEvents =\n    this.scrollbar_ ? 'initial' : 'none';\n};\n\nBlockly.HorizontalFlyout.prototype.getYPosition = function () {\n  return this.customYOffset || 0;\n};\n\n/**\n * Arrange the given block in the flyout, and update cursorX/cursorY.\n * @private\n */\nBlockly.HorizontalFlyout.prototype.layoutBlock_ = function(block, cursor, gap,\n    initialX) {\n  var blockHW = block.getHeightWidth();\n  if ((Blockly.RTL && cursor.x - blockHW.width < 0)\n      || (!Blockly.RTL && cursor.x + blockHW.width > this.width_)) {\n    this.flyoutRows++;\n    cursor.y += blockHW.height + gap / 2;\n    cursor.x = initialX;\n  }\n  block.moveBy(cursor.x, cursor.y);\n  var offset = blockHW.width + gap / 2;\n  if (Blockly.RTL) {\n    offset = -offset;\n  }\n  cursor.x += offset;\n  this.height_ = cursor.y + blockHW.height + gap / 2;\n};\n\n/**\n * Blocks in HorizontalFlyouts don't get reflowed from their initial position.\n */\nBlockly.HorizontalFlyout.prototype.reflow = function() {\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A LinkedMap data structure that is accessed using key/value\n * pairs like an ordinary Map, but which guarantees a consistent iteration\n * order over its entries. The iteration order is either insertion order (the\n * default) or ordered from most recent to least recent use. By setting a fixed\n * size, the LRU version of the LinkedMap makes an effective object cache. This\n * data structure is similar to Java's LinkedHashMap.\n *\n * @author brenneman@google.com (Shawn Brenneman)\n */\n\n\ngoog.provide('goog.structs.LinkedMap');\n\ngoog.require('goog.structs.Map');\n\n\n\n/**\n * Class for a LinkedMap datastructure, which combines O(1) map access for\n * key/value pairs with a linked list for a consistent iteration order. Sample\n * usage:\n *\n * <pre>\n * var m = new LinkedMap();\n * m.set('param1', 'A');\n * m.set('param2', 'B');\n * m.set('param3', 'C');\n * alert(m.getKeys()); // param1, param2, param3\n *\n * var c = new LinkedMap(5, true);\n * for (var i = 0; i < 10; i++) {\n *   c.set('entry' + i, false);\n * }\n * alert(c.getKeys()); // entry9, entry8, entry7, entry6, entry5\n *\n * c.set('entry5', true);\n * c.set('entry1', false);\n * alert(c.getKeys()); // entry1, entry5, entry9, entry8, entry7\n * </pre>\n *\n * @param {number=} opt_maxCount The maximum number of objects to store in the\n *     LinkedMap. If unspecified or 0, there is no maximum.\n * @param {boolean=} opt_cache When set, the LinkedMap stores items in order\n *     from most recently used to least recently used, instead of insertion\n *     order.\n * @param {function(string, VALUE)=} opt_evictionCallback Called with the\n *     removed stringified key as the first argument and value as the second\n *     argument after the key was evicted from the LRU because the max count\n *     was reached.\n * @constructor\n * @template KEY, VALUE\n */\ngoog.structs.LinkedMap = function(\n    opt_maxCount, opt_cache, opt_evictionCallback) {\n  /**\n   * The maximum number of entries to allow, or null if there is no limit.\n   * @private {?number}\n   */\n  this.maxCount_ = opt_maxCount || null;\n\n  /** @private @const {boolean} */\n  this.cache_ = !!opt_cache;\n\n  /** @private {function(string, VALUE)|undefined} */\n  this.evictionCallback_ = opt_evictionCallback;\n\n  /**\n   * @private @const {!goog.structs.Map<string,\n   *     goog.structs.LinkedMap.Node_<string, VALUE>>}\n   */\n  this.map_ = new goog.structs.Map();\n\n  this.head_ = new goog.structs.LinkedMap.Node_('', undefined);\n  this.head_.next = this.head_.prev = this.head_;\n};\n\n\n/**\n * Finds a node and updates it to be the most recently used.\n * @param {string} key The key of the node.\n * @return {goog.structs.LinkedMap.Node_<string, VALUE>} The node or null if not\n *     found.\n * @private\n */\ngoog.structs.LinkedMap.prototype.findAndMoveToTop_ = function(key) {\n  var node = this.map_.get(key);\n  if (node) {\n    if (this.cache_) {\n      node.remove();\n      this.insert_(node);\n    }\n  }\n  return node;\n};\n\n\n/**\n * Retrieves the value for a given key. If this is a caching LinkedMap, the\n * entry will become the most recently used.\n * @param {string} key The key to retrieve the value for.\n * @param {VALUE=} opt_val A default value that will be returned if the key is\n *     not found, defaults to undefined.\n * @return {VALUE} The retrieved value.\n */\ngoog.structs.LinkedMap.prototype.get = function(key, opt_val) {\n  var node = this.findAndMoveToTop_(key);\n  return node ? node.value : opt_val;\n};\n\n\n/**\n * Retrieves the value for a given key without updating the entry to be the\n * most recently used.\n * @param {string} key The key to retrieve the value for.\n * @param {VALUE=} opt_val A default value that will be returned if the key is\n *     not found.\n * @return {VALUE} The retrieved value.\n */\ngoog.structs.LinkedMap.prototype.peekValue = function(key, opt_val) {\n  var node = this.map_.get(key);\n  return node ? node.value : opt_val;\n};\n\n\n/**\n * Sets a value for a given key. If this is a caching LinkedMap, this entry\n * will become the most recently used.\n * @param {string} key Key with which the specified value is to be associated.\n * @param {VALUE} value Value to be associated with the specified key.\n */\ngoog.structs.LinkedMap.prototype.set = function(key, value) {\n  var node = this.findAndMoveToTop_(key);\n  if (node) {\n    node.value = value;\n  } else {\n    node = new goog.structs.LinkedMap.Node_(key, value);\n    this.map_.set(key, node);\n    this.insert_(node);\n  }\n};\n\n\n/**\n * Returns the value of the first node without making any modifications.\n * @return {VALUE} The value of the first node or undefined if the map is empty.\n */\ngoog.structs.LinkedMap.prototype.peek = function() {\n  return this.head_.next.value;\n};\n\n\n/**\n * Returns the value of the last node without making any modifications.\n * @return {VALUE} The value of the last node or undefined if the map is empty.\n */\ngoog.structs.LinkedMap.prototype.peekLast = function() {\n  return this.head_.prev.value;\n};\n\n\n/**\n * Removes the first node from the list and returns its value.\n * @return {VALUE} The value of the popped node, or undefined if the map was\n *     empty.\n */\ngoog.structs.LinkedMap.prototype.shift = function() {\n  return this.popNode_(this.head_.next);\n};\n\n\n/**\n * Removes the last node from the list and returns its value.\n * @return {VALUE} The value of the popped node, or undefined if the map was\n *     empty.\n */\ngoog.structs.LinkedMap.prototype.pop = function() {\n  return this.popNode_(this.head_.prev);\n};\n\n\n/**\n * Removes a value from the LinkedMap based on its key.\n * @param {string} key The key to remove.\n * @return {boolean} True if the entry was removed, false if the key was not\n *     found.\n */\ngoog.structs.LinkedMap.prototype.remove = function(key) {\n  var node = this.map_.get(key);\n  if (node) {\n    this.removeNode(node);\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Removes a node from the {@code LinkedMap}. It can be overridden to do\n * further cleanup such as disposing of the node value.\n * @param {!goog.structs.LinkedMap.Node_<string, VALUE>} node The node to\n *     remove.\n * @protected\n */\ngoog.structs.LinkedMap.prototype.removeNode = function(node) {\n  node.remove();\n  this.map_.remove(node.key);\n};\n\n\n/**\n * @return {number} The number of items currently in the LinkedMap. Sub classes\n *     may override this to change how items are counted (e.g. to introduce\n *     per item weight). Truncation will always proceed as long as the count\n *     returned from this method is higher than the max count for this map.\n */\ngoog.structs.LinkedMap.prototype.getCount = function() {\n  return this.map_.getCount();\n};\n\n\n/**\n * @return {boolean} True if the cache is empty, false if it contains any items.\n */\ngoog.structs.LinkedMap.prototype.isEmpty = function() {\n  return this.map_.isEmpty();\n};\n\n\n/**\n * Sets a callback that fires when an entry is evicted because max entry\n * count is reached. The callback is called with the removed stringified key\n * as the first argument and value as the second argument after the key was\n * evicted from the LRU because the max count was reached.\n * @param {function(string, VALUE)} evictionCallback\n */\ngoog.structs.LinkedMap.prototype.setEvictionCallback = function(\n    evictionCallback) {\n  this.evictionCallback_ = evictionCallback;\n};\n\n\n/**\n * Sets the maximum number of entries allowed in this object, truncating any\n * excess objects if necessary.\n * @param {number} maxCount The new maximum number of entries to allow.\n */\ngoog.structs.LinkedMap.prototype.setMaxCount = function(maxCount) {\n  this.maxCount_ = maxCount || null;\n  if (this.maxCount_ != null) {\n    this.truncate_(this.maxCount_);\n  }\n};\n\n\n/**\n * @return {!Array<string>} The list of the keys in the appropriate order for\n *     this LinkedMap.\n */\ngoog.structs.LinkedMap.prototype.getKeys = function() {\n  return this.map(function(val, key) { return key; });\n};\n\n\n/**\n * @return {!Array<VALUE>} The list of the values in the appropriate order for\n *     this LinkedMap.\n */\ngoog.structs.LinkedMap.prototype.getValues = function() {\n  return this.map(function(val, key) { return val; });\n};\n\n\n/**\n * Tests whether a provided value is currently in the LinkedMap. This does not\n * affect item ordering in cache-style LinkedMaps.\n * @param {VALUE} value The value to check for.\n * @return {boolean} Whether the value is in the LinkedMap.\n */\ngoog.structs.LinkedMap.prototype.contains = function(value) {\n  return this.some(function(el) { return el == value; });\n};\n\n\n/**\n * Tests whether a provided key is currently in the LinkedMap. This does not\n * affect item ordering in cache-style LinkedMaps.\n * @param {string} key The key to check for.\n * @return {boolean} Whether the key is in the LinkedMap.\n */\ngoog.structs.LinkedMap.prototype.containsKey = function(key) {\n  return this.map_.containsKey(key);\n};\n\n\n/**\n * Removes all entries in this object.\n */\ngoog.structs.LinkedMap.prototype.clear = function() {\n  this.truncate_(0);\n};\n\n\n/**\n * Calls a function on each item in the LinkedMap.\n *\n * @see goog.structs.forEach\n * @param {function(this:T, VALUE, KEY, goog.structs.LinkedMap<KEY, VALUE>)} f\n * @param {T=} opt_obj The value of \"this\" inside f.\n * @template T\n */\ngoog.structs.LinkedMap.prototype.forEach = function(f, opt_obj) {\n  for (var n = this.head_.next; n != this.head_; n = n.next) {\n    f.call(opt_obj, n.value, n.key, this);\n  }\n};\n\n\n/**\n * Calls a function on each item in the LinkedMap and returns the results of\n * those calls in an array.\n *\n * @see goog.structs.map\n * @param {function(this:T, VALUE, KEY,\n *         goog.structs.LinkedMap<KEY, VALUE>): RESULT} f\n *     The function to call for each item. The function takes\n *     three arguments: the value, the key, and the LinkedMap.\n * @param {T=} opt_obj The object context to use as \"this\" for the\n *     function.\n * @return {!Array<RESULT>} The results of the function calls for each item in\n *     the LinkedMap.\n * @template T,RESULT\n */\ngoog.structs.LinkedMap.prototype.map = function(f, opt_obj) {\n  var rv = [];\n  for (var n = this.head_.next; n != this.head_; n = n.next) {\n    rv.push(f.call(opt_obj, n.value, n.key, this));\n  }\n  return rv;\n};\n\n\n/**\n * Calls a function on each item in the LinkedMap and returns true if any of\n * those function calls returns a true-like value.\n *\n * @see goog.structs.some\n * @param {function(this:T, VALUE, KEY,\n *         goog.structs.LinkedMap<KEY, VALUE>):boolean} f\n *     The function to call for each item. The function takes\n *     three arguments: the value, the key, and the LinkedMap, and returns a\n *     boolean.\n * @param {T=} opt_obj The object context to use as \"this\" for the\n *     function.\n * @return {boolean} Whether f evaluates to true for at least one item in the\n *     LinkedMap.\n * @template T\n */\ngoog.structs.LinkedMap.prototype.some = function(f, opt_obj) {\n  for (var n = this.head_.next; n != this.head_; n = n.next) {\n    if (f.call(opt_obj, n.value, n.key, this)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Calls a function on each item in the LinkedMap and returns true only if every\n * function call returns a true-like value.\n *\n * @see goog.structs.some\n * @param {function(this:T, VALUE, KEY,\n *         goog.structs.LinkedMap<KEY, VALUE>):boolean} f\n *     The function to call for each item. The function takes\n *     three arguments: the value, the key, and the Cache, and returns a\n *     boolean.\n * @param {T=} opt_obj The object context to use as \"this\" for the\n *     function.\n * @return {boolean} Whether f evaluates to true for every item in the Cache.\n * @template T\n */\ngoog.structs.LinkedMap.prototype.every = function(f, opt_obj) {\n  for (var n = this.head_.next; n != this.head_; n = n.next) {\n    if (!f.call(opt_obj, n.value, n.key, this)) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * Appends a node to the list. LinkedMap in cache mode adds new nodes to\n * the head of the list, otherwise they are appended to the tail. If there is a\n * maximum size, the list will be truncated if necessary.\n *\n * @param {goog.structs.LinkedMap.Node_<string, VALUE>} node The item to insert.\n * @private\n */\ngoog.structs.LinkedMap.prototype.insert_ = function(node) {\n  if (this.cache_) {\n    node.next = this.head_.next;\n    node.prev = this.head_;\n\n    this.head_.next = node;\n    node.next.prev = node;\n  } else {\n    node.prev = this.head_.prev;\n    node.next = this.head_;\n\n    this.head_.prev = node;\n    node.prev.next = node;\n  }\n\n  if (this.maxCount_ != null) {\n    this.truncate_(this.maxCount_);\n  }\n};\n\n\n/**\n * Removes elements from the LinkedMap if the given count has been exceeded.\n * In cache mode removes nodes from the tail of the list. Otherwise removes\n * nodes from the head.\n * @param {number} count Number of elements to keep.\n * @private\n */\ngoog.structs.LinkedMap.prototype.truncate_ = function(count) {\n  while (this.getCount() > count) {\n    var toRemove = this.cache_ ? this.head_.prev : this.head_.next;\n    this.removeNode(toRemove);\n    if (this.evictionCallback_) {\n      this.evictionCallback_(toRemove.key, toRemove.value);\n    }\n  }\n};\n\n\n/**\n * Removes the node from the LinkedMap if it is not the head, and returns\n * the node's value.\n * @param {!goog.structs.LinkedMap.Node_<string, VALUE>} node The item to\n *     remove.\n * @return {VALUE} The value of the popped node.\n * @private\n */\ngoog.structs.LinkedMap.prototype.popNode_ = function(node) {\n  if (this.head_ != node) {\n    this.removeNode(node);\n  }\n  return node.value;\n};\n\n\n\n/**\n * Internal class for a doubly-linked list node containing a key/value pair.\n * @param {KEY} key The key.\n * @param {VALUE} value The value.\n * @constructor\n * @template KEY, VALUE\n * @private\n */\ngoog.structs.LinkedMap.Node_ = function(key, value) {\n  /** @type {KEY} */\n  this.key = key;\n\n  /** @type {VALUE} */\n  this.value = value;\n};\n\n\n/**\n * The next node in the list.\n * @type {!goog.structs.LinkedMap.Node_<KEY, VALUE>}\n */\ngoog.structs.LinkedMap.Node_.prototype.next;\n\n\n/**\n * The previous node in the list.\n * @type {!goog.structs.LinkedMap.Node_<KEY, VALUE>}\n */\ngoog.structs.LinkedMap.Node_.prototype.prev;\n\n\n/**\n * Causes this node to remove itself from the list.\n */\ngoog.structs.LinkedMap.Node_.prototype.remove = function() {\n  this.prev.next = this.next;\n  this.next.prev = this.prev;\n\n  delete this.prev;\n  delete this.next;\n};\n","/**\n * @fileoverview Object representing a separate function editor. This function\n * editor provides a separate modal workspace where a user can modify a given\n * function definition.\n */\n'use strict';\n\ngoog.provide('Blockly.FunctionEditor');\n\ngoog.require('Blockly.BlockSpace');\ngoog.require('Blockly.BlockSpaceEditor');\ngoog.require('Blockly.HorizontalFlyout');\ngoog.require('goog.style');\ngoog.require('goog.dom');\ngoog.require('goog.array');\ngoog.require('goog.events');\ngoog.require('goog.structs.LinkedMap');\n\n/**\n * Class for a modal function editor.\n * @constructor\n */\nBlockly.FunctionEditor = function(\n    opt_msgOverrides,\n    opt_definitionBlockType,\n    opt_parameterBlockTypes,\n    opt_disableParamEditing,\n    opt_paramTypes) {\n  /**\n   * Whether this editor has been initialized\n   * @type {boolean}\n   * @private\n   */\n  this.created_ = false;\n\n  /**\n   * Current blocks in the editor's parameter toolbox\n   * @type {!goog.structs.LinkedMap.<string,SVGElement>}\n   * @protected\n   */\n  this.orderedParamIDsToBlocks_ = new goog.structs.LinkedMap();\n\n  /**\n   * Current block being edited\n   * @type {?Blockly.Block}\n   */\n  this.functionDefinitionBlock = null;\n\n  /**\n   * Enclosing container div for the function editor, shown and hidden as\n   * editor is toggled.\n   * Note: visibility is used as indicator of modal open state.\n   * @type {?Element}\n   * @protected\n   */\n  this.container_ = null;\n\n  this.closeButton_ = null;\n\n  /**\n   * @protected {Blockly.SvgTextButton}\n   */\n  this.deleteButton_ = null;\n\n  this.contractDiv_ = null;\n\n  /**\n   * @type {Blockly.HorizontalFlyout}\n   * @protected\n   */\n  this.flyout_ = null;\n  this.frameBase_ = null;\n  this.frameInner_ = null;\n  this.frameText_ = null;\n  this.modalBackground_ = null;\n  this.onResizeWrapper_ = null;\n\n  /** @type {BlockSpace} */\n  this.modalBlockSpace = null;\n\n  this.msgOverrides_ = opt_msgOverrides || {};\n  if (opt_definitionBlockType) {\n    this.definitionBlockType = opt_definitionBlockType;\n  }\n  this.parameterBlockTypes = opt_parameterBlockTypes || {};\n  this.disableParamEditing = opt_disableParamEditing || false;\n  this.paramTypes = opt_paramTypes || [];\n\n  Blockly.FunctionEditor.allFunctionEditors.push(this);\n};\n\nBlockly.FunctionEditor.BLOCK_LAYOUT_LEFT_MARGIN = Blockly.BlockSpaceEditor.BUMP_PADDING_LEFT;\nBlockly.FunctionEditor.BLOCK_LAYOUT_TOP_MARGIN = Blockly.BlockSpaceEditor.BUMP_PADDING_TOP;\n\n/**\n * Margin between the delete and close buttons in pixels.\n * @type {number}\n */\nBlockly.FunctionEditor.DELETE_BUTTON_MARGIN = 25;\n\n/**\n * Amount of space the \"close\" button should hang off the right of the\n * window chrome.\n * @type {number}\n */\nBlockly.FunctionEditor.CLOSE_BUTTON_OVERHANG = 14;\n\n/** @type {number} */\nBlockly.FunctionEditor.RTL_CLOSE_BUTTON_OFFSET = 5;\n\n/** @type {number} */\nBlockly.FunctionEditor.BUTTON_TOP_OFFSET = -22;\n\n/** @type {Blockly.FunctionEditor[]} */\nBlockly.FunctionEditor.allFunctionEditors = [];\n\n/**\n * Get a string from Blockly.Msg, unless overridden by msgOverrides\n */\nBlockly.FunctionEditor.prototype.getMsg = function(label) {\n  return this.msgOverrides_[label] || Blockly.Msg[label];\n};\n\nBlockly.FunctionEditor.prototype.paramEditingDisabled = function () {\n  return Blockly.disableParamEditing || this.disableParamEditing;\n};\n\n/**\n * The type of block to instantiate in the function editing area\n * @type {string}\n * @protected\n */\nBlockly.FunctionEditor.prototype.definitionBlockType = 'procedures_defnoreturn';\n\n/**\n * The type of block to instantiate for parameter definition\n * @type {string}\n */\nBlockly.FunctionEditor.prototype.defaultParameterBlockType = 'parameters_get';\n\n/**\n * @param {String} autoOpenFunction - name of function to auto-open\n */\nBlockly.FunctionEditor.prototype.autoOpenFunction = function(autoOpenFunction) {\n  this.autoOpenWithLevelConfiguration({\n    autoOpenFunction: autoOpenFunction\n  });\n};\n\n/**\n * Auto-opens the function editor with given configuration parameters\n * @param {Object} configuration\n * @param {string} configuration.autoOpenFunction - function to open\n * @protected\n */\nBlockly.FunctionEditor.prototype.autoOpenWithLevelConfiguration = function(configuration) {\n  if (configuration.autoOpenFunction) {\n    this.openAndEditFunction(configuration.autoOpenFunction);\n  }\n};\n\n/**\n * @param {Blockly.Block} procedureBlock procedure block which has a title value 'NAME'\n */\nBlockly.FunctionEditor.prototype.openEditorForCallBlock_ = function(procedureBlock) {\n  var functionName = procedureBlock.getTitleValue('NAME');\n  this.openEditorForFunction(procedureBlock, functionName);\n}\n\n/**\n * @param {string} functionName name of function for which to open editor\n */\nBlockly.FunctionEditor.prototype.openEditorForFunction = function(procedureBlock, functionName) {\n  procedureBlock.blockSpace.blockSpaceEditor.hideChaff();\n  this.hideIfOpen();\n  this.openAndEditFunction(functionName);\n};\n\nBlockly.FunctionEditor.prototype.openAndEditFunction = function(functionName) {\n  var targetFunctionDefinitionBlock = Blockly.mainBlockSpace.findFunction(\n      functionName);\n  if (!targetFunctionDefinitionBlock) {\n    throw new Error(\"Can't find definition block to edit\");\n  }\n\n  this.show();\n  this.setupUIForBlock_(targetFunctionDefinitionBlock);\n  this.functionDefinitionBlock = this.moveToModalBlockSpace(targetFunctionDefinitionBlock);\n  this.functionDefinitionBlock.setMovable(false);\n  this.functionDefinitionBlock.setDeletable(false);\n  this.functionDefinitionBlock.setEditable(false);\n  this.populateParamToolbox_();\n  this.setupUIAfterBlockInEditor_();\n\n  this.container_.querySelector('#functionNameText').value = functionName;\n  this.container_.querySelector('#functionDescriptionText').value =\n      this.functionDefinitionBlock.description_ || '';\n  this.deleteButton_.setVisible(targetFunctionDefinitionBlock.userCreated);\n\n  Blockly.fireUiEvent(window, 'function_editor_opened');\n};\n\n/**\n * Lets subclass tweak the UI based on the given target block\n * @param targetFunctionDefinitionBlock\n * @protected\n */\nBlockly.FunctionEditor.prototype.setupUIForBlock_ = function(targetFunctionDefinitionBlock) {\n};\n\n/**\n * Lets subclass tweak the UI once the function block is set\n * @protected\n */\nBlockly.FunctionEditor.prototype.setupUIAfterBlockInEditor_ = function() {\n\n};\n\nBlockly.FunctionEditor.prototype.populateParamToolbox_ = function() {\n  this.orderedParamIDsToBlocks_.clear();\n  this.addParamsFromProcedure_();\n  this.resetParamIDs_();\n  this.refreshParamsEverywhere();\n};\n\n/** @protected */\nBlockly.FunctionEditor.prototype.addParamsFromProcedure_ = function() {\n  var procedureInfo = this.functionDefinitionBlock.getProcedureInfo();\n  for (var i = 0; i < procedureInfo.parameterNames.length; i++) {\n    if (procedureInfo.parameterTypes) {\n      this.addParameter(procedureInfo.parameterNames[i], procedureInfo.parameterTypes[i]);\n    } else {\n      this.addParameter(procedureInfo.parameterNames[i]);\n    }\n  }\n};\n\nBlockly.FunctionEditor.prototype.getParamNameType = function(parameterID) {\n  var blockXML = this.orderedParamIDsToBlocks_.get(parameterID);\n  if (!blockXML) {\n    throw \"Block not found for ID \" + parameterID;\n  }\n  return this.paramNameTypeFromXML_(blockXML);\n};\n\nBlockly.FunctionEditor.prototype.paramNameTypeFromXML_ = function(blockXML) {\n  var infoObject = {};\n  infoObject.name = blockXML.firstElementChild.textContent;\n  infoObject.type = blockXML.childNodes[1].textContent;\n  return infoObject;\n};\n\nBlockly.FunctionEditor.prototype.openWithNewFunction = function() {\n  this.ensureCreated_();\n\n  var tempFunctionDefinitionBlock = Blockly.Xml.domToBlock(Blockly.mainBlockSpace,\n    Blockly.createSvgElement('block', {type: this.definitionBlockType}));\n  tempFunctionDefinitionBlock.userCreated = true;\n  this.openAndEditFunction(tempFunctionDefinitionBlock.getTitleValue('NAME'));\n};\n\nBlockly.FunctionEditor.prototype.bindToolboxHandlers_ = function() {\n  var paramAddTextElement = this.container_.querySelector('#paramAddText');\n  var paramAddTypeSelect = this.container_.querySelector('#paramAddType');\n  var paramAddButton = this.container_.querySelector('#paramAddButton');\n  if (!this.paramEditingDisabled()) {\n    Blockly.bindEvent_(paramAddButton, 'click', this,\n        goog.bind(this.addParamFromInputField_, this, paramAddTextElement, paramAddTypeSelect));\n    Blockly.bindEvent_(paramAddTextElement, 'keydown', this, function(e) {\n      if (e.keyCode === goog.events.KeyCodes.ENTER) {\n        this.addParamFromInputField_(paramAddTextElement, paramAddTypeSelect);\n      }\n    });\n  }\n};\n\nBlockly.FunctionEditor.prototype.addParamFromInputField_ = function(\n    parameterTextElement, paramAddTypeSelect) {\n  var newParamName = parameterTextElement.value;\n  parameterTextElement.value = '';\n  var newParamType = paramAddTypeSelect && paramAddTypeSelect.value;\n  this.addParameter(newParamName, newParamType);\n  this.refreshParamsEverywhere();\n};\n\nBlockly.FunctionEditor.prototype.addParameter = function(newParameterName, newParameterType) {\n  this.orderedParamIDsToBlocks_.set(goog.events.getUniqueId('parameter'), this.newParameterBlock(newParameterName, newParameterType));\n};\n\nBlockly.FunctionEditor.prototype.getParameterBlockType = function(type) {\n  return this.parameterBlockTypes[type] || this.defaultParameterBlockType;\n}\n\nBlockly.FunctionEditor.prototype.newParameterBlock = function(newParameterName, newParameterType) {\n  var parameterBlockType = this.getParameterBlockType(newParameterType);\n  var param = Blockly.createSvgElement('block', {type: parameterBlockType});\n  var v = Blockly.createSvgElement('title', {name: 'VAR'}, param);\n  if (newParameterType) {\n    Blockly.createSvgElement('mutation', {output: newParameterType}, param);\n  }\n  v.textContent = newParameterName;\n  return param;\n};\n\nBlockly.FunctionEditor.prototype.renameParameter = function(oldName, newName) {\n  this.orderedParamIDsToBlocks_.forEach(function(block, paramID, linkedMap) {\n    if (block.firstElementChild &&\n        block.firstElementChild.textContent === oldName) {\n      block.firstElementChild.textContent = newName;\n    }\n  });\n  this.forEachParameterGetBlock(oldName, function(block) {\n    block.setTitleValue(newName, 'VAR');\n  });\n};\n\nBlockly.FunctionEditor.prototype.changeParameterTypeInFlyoutXML = function(name, newType) {\n  this.orderedParamIDsToBlocks_.forEach(function(blockXML, paramID, linkedMap) {\n    if (blockXML.firstElementChild &&\n        blockXML.firstElementChild.textContent === name) {\n      // e.g. <block type=\"functional_parameters_get\"><title name=\"VAR\">seconds</title><mutation><outputtype>Number</outputtype></mutation></block>\n      var mutationNode = blockXML.childNodes[1];\n      var outputTypeNode = mutationNode.firstElementChild;\n      outputTypeNode.textContent = newType;\n    }\n  });\n};\n\n/**\n * Remove procedure parameter from the toolbox and everywhere it is used\n * @param {String} nameToRemove\n */\nBlockly.FunctionEditor.prototype.removeParameter = function(nameToRemove) {\n  var keysToDelete = [];\n  this.orderedParamIDsToBlocks_.forEach(function(block, paramID) {\n    if (block.firstElementChild && block.firstElementChild.textContent === nameToRemove) {\n      keysToDelete.push(paramID);\n    }\n  });\n  keysToDelete.forEach(function(key) { this.orderedParamIDsToBlocks_.remove(key); }, this);\n  this.forEachParameterGetBlock(nameToRemove, function(block) {\n    block.dispose(true, false);\n  });\n  this.refreshParamsEverywhere();\n};\n\nBlockly.FunctionEditor.prototype.refreshParamsEverywhere = function() {\n  this.refreshParamsInFlyout_();\n  this.refreshParamsOnFunction_();\n};\n\nBlockly.FunctionEditor.prototype.refreshParamsInFlyout_ = function() {\n  this.flyout_.show(this.orderedParamIDsToBlocks_.getValues());\n};\n\nBlockly.FunctionEditor.prototype.resetParamIDs_ = function() {\n  var paramArrays = this.paramsAsParallelArrays_();\n  paramArrays.paramIDs = null; // No IDs causes next update to initialize IDs\n  this.functionDefinitionBlock.updateParamsFromArrays(\n    paramArrays.paramNames, paramArrays.paramIDs, paramArrays.paramTypes);\n};\n\nBlockly.FunctionEditor.prototype.refreshParamsOnFunction_ = function() {\n  var paramArrays = this.paramsAsParallelArrays_();\n  this.functionDefinitionBlock.updateParamsFromArrays(\n    paramArrays.paramNames, paramArrays.paramIDs, paramArrays.paramTypes);\n};\n\n/**\n * @returns {{paramNames: Array, paramIDs: Array, paramTypes: Array}}\n *    parallel arrays of parameter names, IDs, types, suitable as input\n *    for calling updateParamsFromArrays on procedures\n */\nBlockly.FunctionEditor.prototype.paramsAsParallelArrays_ = function() {\n  var paramNames = [];\n  var paramIDs = [];\n  var paramTypes = [];\n\n  this.orderedParamIDsToBlocks_.forEach(function(blockXML, paramID) {\n    // <mutation><name></name><outputtype></outputtype></mutation>\n    paramNames.push(blockXML.firstElementChild.textContent);\n    paramIDs.push(paramID);\n    if (blockXML.childNodes.length > 1) {\n      // Functional blocks and procedures store output mutations differently.\n      var node = blockXML.childNodes[1];\n      paramTypes.push(node.getAttribute('output') || node.textContent);\n    }\n  }, this);\n  return {paramNames: paramNames, paramIDs: paramIDs, paramTypes: paramTypes};\n};\n\nBlockly.FunctionEditor.prototype.forEachParameterGetBlock = function(paramName, callback) {\n  if (!this.functionDefinitionBlock) {\n    return;\n  }\n  this.functionDefinitionBlock.getDescendants().forEach(function(block) {\n    if (block.type == 'parameters_get' &&\n        Blockly.Names.equals(paramName, block.getTitleValue('VAR'))) {\n      callback(block);\n    }\n  });\n}\n\nBlockly.FunctionEditor.prototype.show = function() {\n  this.ensureCreated_();\n  this.position_();\n  goog.style.setElementShown(this.container_, true);\n  goog.style.setElementShown(this.modalBackground_, true);\n  Blockly.focusedBlockSpace = this.modalBlockSpace;\n  if (Blockly.selected) {\n    Blockly.selected.unselect();\n  }\n};\n\n/**\n * Is the function editor currently open?\n */\nBlockly.FunctionEditor.prototype.isOpen = function() {\n  return this.isCreated() && goog.style.isElementShown(this.container_);\n};\n\nBlockly.FunctionEditor.prototype.isCreated = function() {\n  return !!this.container_;\n};\n\nBlockly.FunctionEditor.prototype.ensureCreated_ = function() {\n  if (!this.isCreated()) {\n    this.create_();\n  }\n};\n\nBlockly.FunctionEditor.prototype.onClose = function() {\n  this.hideIfOpen();\n};\n\nBlockly.FunctionEditor.prototype.hideIfOpen = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n  this.hideAndRestoreBlocks_();\n  this.modalBlockSpace.clear();\n};\n\n/**\n * Hides the function editor, moving existing blocks to the\n * main BlockSpace\n * @protected\n */\nBlockly.FunctionEditor.prototype.hideAndRestoreBlocks_ = function() {\n  var functionDefinitionBlock = this.functionDefinitionBlock;\n  // Clear block reference to stop re-layout mid-block deletion\n  this.functionDefinitionBlock = null;\n  this.moveToMainBlockSpace_(functionDefinitionBlock);\n\n  this.container_.querySelector('#functionNameText').value = '';\n  this.container_.querySelector('#functionDescriptionText').value = '';\n  if (this.container_.querySelector('#paramAddText')) {\n    this.container_.querySelector('#paramAddText').value = '';\n  }\n\n  goog.style.setElementShown(this.container_, false);\n  goog.style.setElementShown(this.modalBackground_, false);\n\n  Blockly.focusedBlockSpace = Blockly.mainBlockSpace;\n  Blockly.fireUiEvent(window, 'function_editor_closed');\n};\n\n/**\n * Moves a block in the modal BlockSpace to the main BlockSpace.\n * Note: destroys the existing Block object in the process\n * @param blockToMove\n * @protected\n */\nBlockly.FunctionEditor.prototype.moveToMainBlockSpace_ = function(blockToMove) {\n  blockToMove.setMovable(true);\n  blockToMove.setDeletable(true);\n  var dom = Blockly.Xml.blockToDom(blockToMove);\n  blockToMove.dispose(false, false, true);\n  var newBlock = Blockly.Xml.domToBlock(Blockly.mainBlockSpace, dom);\n  newBlock.setCurrentlyHidden(true);\n};\n\n/**\n * Moves an existing block to this modal BlockSpace\n * Note: destroys the existing Block object in the process\n * @param {Blockly.Block} blockToMove\n * @returns {Blockly.Block} copy of block in modal BlockSpace\n * @protected\n */\nBlockly.FunctionEditor.prototype.moveToModalBlockSpace = function(blockToMove) {\n  var dom = Blockly.Xml.blockToDom(blockToMove);\n  blockToMove.dispose(false, false, true);\n  var newCopyOfBlock = Blockly.Xml.domToBlock(this.modalBlockSpace, dom);\n  newCopyOfBlock.moveTo(Blockly.RTL\n    ? this.modalBlockSpace.getMetrics().viewWidth - Blockly.FunctionEditor.BLOCK_LAYOUT_LEFT_MARGIN\n    : Blockly.FunctionEditor.BLOCK_LAYOUT_LEFT_MARGIN, Blockly.FunctionEditor.BLOCK_LAYOUT_TOP_MARGIN);\n  newCopyOfBlock.setCurrentlyHidden(false);\n  newCopyOfBlock.setUserVisible(true, true);\n  return newCopyOfBlock;\n};\n\nBlockly.FunctionEditor.prototype.create_ = function() {\n  if (this.created_) {\n    throw \"Attempting to re-create already created Function Editor\";\n  }\n\n  this.container_ = document.createElement('div');\n  this.container_.setAttribute('id', 'modalContainer');\n  goog.dom.insertSiblingAfter(this.container_, Blockly.mainBlockSpaceEditor.svg_);\n  this.container_.style.top = Blockly.mainBlockSpaceEditor.getWorkspaceTopOffset() + 'px';\n  var self = this;\n  this.modalBlockSpaceEditor = new Blockly.BlockSpaceEditor(this.container_, {\n    getMetrics: function() {\n      // `this` is the new BlockSpaceEditor\n      var metrics = Blockly.BlockSpaceEditor.prototype.getBlockSpaceMetrics_.call(this);\n      if (!metrics) {\n        return null;\n      }\n\n      metrics.absoluteLeft +=\n          FRAME_MARGIN_SIDE + Blockly.Bubble.BORDER_WIDTH + 1;\n      metrics.absoluteTop += self.getBlockSpaceEditorToScreenTop_();\n      metrics.viewWidth -=\n          (FRAME_MARGIN_SIDE + Blockly.Bubble.BORDER_WIDTH) * 2;\n      metrics.viewHeight -=\n          FRAME_MARGIN_TOP + Blockly.Bubble.BORDER_WIDTH + self.getWindowBorderChromeHeight();\n      return metrics;\n    },\n    setMetrics: function (xyRatio) {\n      // `this` is the new BlockSpaceEditor\n      Blockly.BlockSpaceEditor.prototype.setBlockSpaceMetrics_.call(this, xyRatio);\n      if (self.contractDiv_) {\n        self.resizeUIComponents_();\n        self.layOutBlockSpaceItems_();\n      }\n    },\n    hideTrashRect: true\n  });\n\n  this.modalBlockSpace = this.modalBlockSpaceEditor.blockSpace;\n  this.modalBlockSpace.customFlyoutMetrics_ = Blockly.mainBlockSpace.getMetrics;\n  this.modalBlockSpace.bindBeginPanDragHandler(this.container_, goog.bind(function () {\n    this.modalBlockSpaceEditor.hideChaff();\n  }, this));\n  this.modalBlockSpace.bindScrollOnWheelHandler(this.container_);\n\n  Blockly.modalBlockSpace = this.modalBlockSpace;\n  Blockly.modalBlockSpaceEditor = this.modalBlockSpaceEditor;\n\n  var clipPathID = \"modalBlockCanvasClipRect\";\n  var clipPath = Blockly.createSvgElement(\n    \"clipPath\", {\n      id: clipPathID\n    }\n  );\n\n  this.modalBlockSpaceEditor.addToSvgDefs(clipPath);\n  var clipPathURL = \"url(#\" + clipPathID + \")\";\n  this.modalBlockSpace.getClippingGroup().setAttribute('clip-path', clipPathURL);\n\n  // Clip path gets positioned/size dynamically later\n  this.clipPathRect_ = Blockly.createSvgElement(\"rect\", {\n    x: 0,\n    y: 0,\n    width: 1,\n    height: 1\n  }, clipPath);\n\n  this.modalBlockSpaceEditor.addChangeListener(\n      Blockly.mainBlockSpace.fireChangeEvent);\n\n  // Add modal background and close button\n  this.modalBackground_ =\n      Blockly.createSvgElement('g', {'class': 'modalBackground'});\n  Blockly.mainBlockSpaceEditor.appendSVGChild(this.modalBackground_);\n\n  this.addCloseButton_();\n  this.addDeleteButton_();\n  this.addEditorFrame_();\n  this.createContractDom_();\n  this.createParameterEditor_();\n\n  this.setupParametersToolbox_();\n\n  this.resizeUIComponents_();\n  this.bindToolboxHandlers_();\n\n  // The function editor block space passes clicks through via\n  // pointer-events:none, so register the unselect handler on lower elements\n  Blockly.bindEvent_(this.container_, 'mousedown', this,\n      function(e) {\n    // Only handle clicks on modalContainer, not a descendant\n    if (e.target === e.currentTarget) {\n      this.modalBlockSpaceEditor.hideChaff();\n      if (Blockly.selected) {\n        Blockly.selected.unselect();\n      }\n    }\n  });\n\n  // Enable editor close on press of ESC key\n  Blockly.bindEvent_(goog.dom.getDocument().body, 'keyup', this, function(e) {\n    if (e.keyCode === goog.events.KeyCodes.ESC) {\n      this.onClose();\n    }\n  });\n\n  Blockly.bindEvent_(this.container_.querySelector('#modalEditorClose'), 'mousedown', this,\n      this.onClose);\n  Blockly.bindEvent_(this.container_.querySelector('#functionNameText'), 'input', this,\n      functionNameChange);\n  // IE9 doesn't fire oninput when delete key is pressed, bind keydown also\n  Blockly.bindEvent_(this.container_.querySelector('#functionNameText'), 'keydown', this,\n      functionNameChange);\n  function functionNameChange(e) {\n    var value = e.target.value;\n    var disallowedCharacters = /\\)|\\(/g;\n    if (disallowedCharacters.test(value)) {\n      value = value.replace(disallowedCharacters, '');\n      this.container_.querySelector('#functionNameText').value = value;\n    }\n    this.functionDefinitionBlock.setTitleValue(value, 'NAME');\n  }\n\n  Blockly.bindEvent_(this.contractDiv_, 'mousedown', null, function() {\n    if (Blockly.selected) {\n      Blockly.selected.unselect();\n    }\n  });\n\n  Blockly.bindEvent_(this.container_.querySelector('#functionDescriptionText'), 'input',\n      this, functionDescriptionChange);\n  // IE9 doesn't fire oninput when delete key is pressed, bind keydown also\n  Blockly.bindEvent_(this.container_.querySelector('#functionDescriptionText'), 'keydown',\n      this, functionDescriptionChange);\n  function functionDescriptionChange(e) {\n    this.functionDefinitionBlock.description_ = e.target.value;\n  }\n\n  this.onResizeWrapper_ = Blockly.bindEvent_(window,\n      goog.events.EventType.RESIZE, this, this.position_);\n\n  this.modalBlockSpaceEditor.svgResize();\n};\n\n/**\n * Sizes and positions the non-block UI components of the editor to match the\n * blockspace metrics.\n * @private\n */\nBlockly.FunctionEditor.prototype.resizeUIComponents_ = function () {\n  var metrics = this.modalBlockSpace.getMetrics();\n  this.resizeFrame_(metrics);\n  this.positionClippingRects_(metrics);\n  this.positionSizeContractDom_(metrics.viewWidth);\n  this.positionCloseButton_(metrics);\n  this.positionDeleteButton_(metrics);\n};\n\n/**\n * Resizes the editor background frame to the given width and height\n * @param {Object} metrics - block space metrics\n * @private\n */\nBlockly.FunctionEditor.prototype.resizeFrame_ = function (metrics) {\n  var width = metrics.viewWidth;\n  var height = metrics.viewHeight;\n  var top = metrics.absoluteTop - this.getBlockSpaceEditorToScreenTop_();\n  this.modalBackground_.setAttribute('transform', 'translate(0,' + top + ')');\n  this.frameBase_.setAttribute('width',\n    width + 2 * Blockly.Bubble.BORDER_WIDTH);\n  this.frameBase_.setAttribute('height',\n    height + 2 * Blockly.Bubble.BORDER_WIDTH + FRAME_HEADER_HEIGHT);\n  this.frameInner_.setAttribute('width', width);\n  this.frameInner_.setAttribute('height', height);\n  if (Blockly.RTL) {\n    this.frameBase_.setAttribute('x', FRAME_MARGIN_SIDE);\n    this.frameInner_.setAttribute('x',\n        FRAME_MARGIN_SIDE + Blockly.Bubble.BORDER_WIDTH + 1);\n    this.frameText_.setAttribute('x', width - 2 * FRAME_MARGIN_SIDE);\n  }\n};\n\n/**\n * Positions the DOM and SVG clipping rects to match the updated metrics.\n * @param {Object} metrics - block space metrics\n * @private\n */\nBlockly.FunctionEditor.prototype.positionClippingRects_ = function (metrics) {\n  var width = metrics.viewWidth;\n  var height = metrics.viewHeight;\n  this.clipPathRect_.setAttribute('x', metrics.absoluteLeft);\n  this.clipPathRect_.setAttribute('y', metrics.absoluteTop);\n  this.clipPathRect_.setAttribute('width', width);\n  this.clipPathRect_.setAttribute('height', height);\n  this.frameClipDiv_.style.left = metrics.absoluteLeft + 'px';\n  this.frameClipDiv_.style.top = metrics.absoluteTop + 'px';\n  this.frameClipDiv_.style.width = width + 'px';\n  this.frameClipDiv_.style.height = height + 'px';\n};\n\n/**\n * Resizes the contract DOM based on the modal blockspace's dimensions.\n * @param {number} viewWidth modal blockspace's metrics.viewWidth\n * @private\n */\nBlockly.FunctionEditor.prototype.positionSizeContractDom_ = function (viewWidth) {\n  this.contractDiv_.style.left = this.modalBlockSpace.xOffsetFromView + 'px';\n  this.contractDiv_.style.top = this.getContractDomTopY_() + 'px';\n  this.contractDiv_.style.width = viewWidth + 'px';\n  this.positionFlyout_(0);\n};\n\n/**\n * Position close button based on new metrics\n * @param {Object} metrics - block space metrics\n * @private\n */\nBlockly.FunctionEditor.prototype.positionCloseButton_ = function (metrics) {\n  this.closeButton_.setAttribute('transform', 'translate(' +\n      (Blockly.RTL ? Blockly.FunctionEditor.RTL_CLOSE_BUTTON_OFFSET :\n        metrics.absoluteLeft + metrics.viewWidth + Blockly.FunctionEditor.CLOSE_BUTTON_OVERHANG -\n      this.closeButton_.firstElementChild.getAttribute('width')) +\n      ',' + (metrics.absoluteTop + Blockly.FunctionEditor.BUTTON_TOP_OFFSET) + ')');\n};\n\n/**\n * Position close button based on new metrics\n * @param {Object} metrics - block space metrics\n * @private\n */\nBlockly.FunctionEditor.prototype.positionDeleteButton_ = function (metrics) {\n  var closeButtonWidth = this.closeButton_.firstElementChild.getAttribute('width');\n  var deleteButtonWidth = this.deleteButton_.getButtonWidth();\n  var rightEdge = metrics.absoluteLeft + metrics.viewWidth;\n  var closeButtonLeft = Blockly.FunctionEditor.CLOSE_BUTTON_OVERHANG -\n      closeButtonWidth;\n  var deleteButtonLeft = rightEdge + closeButtonLeft - deleteButtonWidth;\n  var ltrXOffset = deleteButtonLeft -\n      Blockly.FunctionEditor.DELETE_BUTTON_MARGIN;\n  var rtlXOffset = Blockly.FunctionEditor.RTL_CLOSE_BUTTON_OFFSET +\n      closeButtonWidth + Blockly.FunctionEditor.DELETE_BUTTON_MARGIN;\n  var xPosition = (Blockly.RTL ? rtlXOffset : ltrXOffset);\n  this.deleteButton_.renderAt(xPosition, metrics.absoluteTop + Blockly.FunctionEditor.BUTTON_TOP_OFFSET);\n};\n\n/**\n * @returns {Number} in pixels\n * @protected\n */\nBlockly.FunctionEditor.prototype.getBlockSpaceEditorToScreenTop_ = function () {\n  return this.getWindowBorderChromeHeight();\n};\n\n/**\n * @returns {Number} in pixels\n */\nBlockly.FunctionEditor.prototype.getWindowBorderChromeHeight = function () {\n  return FRAME_MARGIN_TOP +\n    Blockly.Bubble.BORDER_WIDTH + FRAME_HEADER_HEIGHT;\n};\n\n/**\n * @returns {Number}\n * @protected\n */\nBlockly.FunctionEditor.prototype.getContractDivHeight = function () {\n  return this.contractDiv_\n    ? this.contractDiv_.getBoundingClientRect().height\n    : 0;\n};\n\n/**\n * @returns {boolean} whether the function editor is open and ready for display\n * @protected\n */\nBlockly.FunctionEditor.prototype.readyToBeLaidOut_ = function () {\n  return this.functionDefinitionBlock &&\n    this.functionDefinitionBlock.svgInitialized() &&\n    this.isOpen();\n};\n\n/**\n * Positions flyout at given editor layout position\n * @param {number} currentY - current position, relative to the blockspace\n *  being scrolled\n * @returns {number} next location to layout\n * @protected\n */\nBlockly.FunctionEditor.prototype.positionFlyout_ = function (currentY) {\n  currentY += this.flyout_.getHeight(); // positioned from bottom\n\n  this.flyout_.customYOffset = currentY +\n    this.modalBlockSpace.yOffsetFromView; // positioned in parent coords\n  this.flyout_.position_();\n\n  return currentY;\n};\n\nBlockly.FunctionEditor.prototype.layOutBlockSpaceItems_ = function () {\n  if (!this.readyToBeLaidOut_()) {\n    return;\n  }\n\n  var currentX = Blockly.RTL ?\n    this.modalBlockSpace.getMetrics().viewWidth - Blockly.FunctionEditor.BLOCK_LAYOUT_LEFT_MARGIN :\n    Blockly.FunctionEditor.BLOCK_LAYOUT_LEFT_MARGIN;\n  var currentY = this.getContractDivHeight();\n  currentY = this.positionFlyout_(currentY);\n\n  currentY += Blockly.FunctionEditor.BLOCK_LAYOUT_TOP_MARGIN;\n  this.functionDefinitionBlock.moveTo(currentX, currentY);\n};\n\n/**\n * Add close button to the top right of the modal dialog\n * @private\n */\nBlockly.FunctionEditor.prototype.addCloseButton_ = function () {\n  this.closeButton_ = Blockly.createSvgElement('g', {\n    'id': 'modalEditorClose',\n    'filter': 'url(#blocklyTrashcanShadowFilter)'\n  });\n  var padding = 7;\n  var r = Blockly.createSvgElement('rect', {\n    'rx': 12,\n    'ry': 12,\n    'fill': '#7665a0',\n    'stroke': 'white',\n    'stroke-width': '2.5'\n  }, this.closeButton_);\n  var text = Blockly.createSvgElement('text', {\n    'x': padding,\n    'y': padding,\n    'class': 'blocklyText'\n  }, this.closeButton_);\n  text.textContent = this.getMsg('CLOSE');\n  this.modalBlockSpaceEditor.appendSVGChild(this.closeButton_);\n  var bounds = text.getBoundingClientRect();\n  r.setAttribute('width', bounds.width + 2 * padding);\n  r.setAttribute('height', bounds.height + padding);\n  r.setAttribute('y', -bounds.height + padding - 1);\n};\n\n/**\n * Add delete button to the top right of the modal dialog, to the\n * left of the Close button.\n * @private\n */\nBlockly.FunctionEditor.prototype.addDeleteButton_ = function () {\n  this.deleteButton_ = new Blockly.SvgTextButton(\n      this.modalBlockSpaceEditor.getSVGElement(), this.getMsg('DELETE'),\n      this.onDeletePressed.bind(this));\n};\n\nBlockly.FunctionEditor.prototype.onDeletePressed = function () {\n  var functionName = this.functionDefinitionBlock.getProcedureInfo().name;\n  var deleteMessage = this.getMsg('CONFIRM_DELETE_FUNCTION_MESSAGE').replace('%1',\n      functionName);\n  Blockly.showSimpleDialog({\n    bodyText: deleteMessage,\n    cancelText: this.getMsg('DELETE'),\n    confirmText: this.getMsg('KEEP'),\n    onConfirm: null,\n    onCancel: this.onDeleteConfirmed.bind(this, functionName),\n    cancelButtonClass: 'red-delete-button'\n  });\n};\n\nBlockly.FunctionEditor.prototype.onDeleteConfirmed = function (functionName) {\n  this.hideIfOpen();\n\n  var functionDefinition = Blockly.mainBlockSpace.findFunction(functionName);\n  var examples = Blockly.mainBlockSpace.findFunctionExamples(functionName);\n\n  examples.concat(functionDefinition).forEach(function (block) {\n    block.dispose(false, false, true);\n  });\n};\n\nBlockly.FunctionEditor.prototype.setupParametersToolbox_ = function () {\n  this.flyout_ = new Blockly.HorizontalFlyout(this.modalBlockSpaceEditor);\n  var flyoutDom = this.flyout_.createDom();\n  this.modalBlockSpace.getClippingGroup().insertBefore(flyoutDom,\n    this.modalBlockSpace.svgBlockCanvas_);\n  this.flyout_.init(this.modalBlockSpace, false);\n};\n\nBlockly.FunctionEditor.prototype.addEditorFrame_ = function () {\n  // if we are in readOnly mode, don't pad. Otherwise, pad left\n  // based on the size of either the Toolbox or the Flyout\n  var left = this.modalBlockSpace.isReadOnly() ? 0 : Blockly.hasCategories ?\n      goog.dom.getElementByClass('blocklyToolboxDiv').getBoundingClientRect().width :\n      goog.dom.getElementByClass('blocklyFlyoutBackground').getBoundingClientRect().width;\n  var top = 0;\n  this.frameBase_ = Blockly.createSvgElement('rect', {\n    x: left + FRAME_MARGIN_SIDE,\n    y: top + FRAME_MARGIN_TOP,\n    fill: 'hsl(94, 73%, 35%)',\n    rx: Blockly.Bubble.BORDER_WIDTH,\n    ry: Blockly.Bubble.BORDER_WIDTH\n  }, this.modalBackground_);\n  this.frameInner_ = Blockly.createSvgElement('rect', {\n    x: left + FRAME_MARGIN_SIDE + Blockly.Bubble.BORDER_WIDTH,\n    y: top + FRAME_MARGIN_TOP + Blockly.Bubble.BORDER_WIDTH +\n      FRAME_HEADER_HEIGHT,\n    fill: '#ffffff'\n  }, this.modalBackground_);\n  this.frameText_ = Blockly.createSvgElement('text', {\n    x: left + FRAME_MARGIN_SIDE + 16,\n    y: top + FRAME_MARGIN_TOP + 22,\n    'class': 'blocklyText',\n    style: 'font-size: 12pt'\n  }, this.modalBackground_);\n  this.frameText_.textContent = this.getMsg('FUNCTION_HEADER');\n};\n\nBlockly.FunctionEditor.prototype.position_ = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n\n  var metrics = this.modalBlockSpace.getMetrics();\n  this.resizeFrame_(metrics);\n  // Resize contract div width\n  this.positionSizeContractDom_(metrics.viewWidth);\n\n  this.layOutBlockSpaceItems_();\n\n  // Move workspace to account for horizontal flyout height\n  this.modalBlockSpaceEditor.svgResize();\n};\n\n/**\n * @returns {number} Y position for contract DOM\n * @protected\n */\nBlockly.FunctionEditor.prototype.getContractDomTopY_ = function() {\n  return this.modalBlockSpace.yOffsetFromView;\n};\n\nBlockly.FunctionEditor.prototype.createParameterEditor_ = function() {\n  if (this.paramEditingDisabled()) {\n    return;\n  }\n\n  var paramTypeSelect = '';\n  if (this.paramTypes.length > 0) {\n    paramTypeSelect = this.paramTypes.map(function (type) {\n      return '<option>' + type + '</option>';\n    }).join('\\n');\n    paramTypeSelect = '<select id=\"paramAddType\" style=\"pointer-events: auto; margin: 0; width: 100px;\">' + paramTypeSelect + '</select> ';\n  }\n\n  this.container_.querySelector('#paramEditingArea').innerHTML =\n    '<div>' + this.getMsg('FUNCTION_PARAMETERS_LABEL') + '</div>'\n    + '<div>'\n    + '<input id=\"paramAddText\" type=\"text\" style=\"width: 200px;\"/> '\n    + paramTypeSelect\n    + '<button id=\"paramAddButton\" class=\"btn no-mc\">' + this.getMsg('ADD_PARAMETER') + '</button>'\n    + '</div>';\n};\n\nBlockly.FunctionEditor.prototype.createFrameClipDiv_ = function () {\n  var frameClipDiv = goog.dom.createDom('div');\n  frameClipDiv.style.position = 'absolute';\n  frameClipDiv.style.overflow = 'hidden';\n  frameClipDiv.style.pointerEvents = 'none';\n  return frameClipDiv;\n};\n\nBlockly.FunctionEditor.prototype.createContractDom_ = function() {\n  this.contractDiv_ = goog.dom.createDom('div',\n      'blocklyToolboxDiv paramToolbox blocklyText flyoutColorGray innerModalDiv');\n  if (Blockly.RTL) {\n    this.contractDiv_.setAttribute('dir', 'RTL');\n  }\n  this.contractDiv_.innerHTML =\n      '<div>' + this.getMsg('FUNCTION_NAME_LABEL') + '</div>'\n      + '<div><input id=\"functionNameText\" type=\"text\"></div>'\n      + '<div>' + this.getMsg('FUNCTION_DESCRIPTION_LABEL') + '</div>'\n      + '<div><textarea id=\"functionDescriptionText\" rows=\"2\"></textarea></div>'\n      + '<div style=\"margin: 0;\" id=\"paramEditingArea\"></div>';\n  this.contractDiv_.style.display = 'block';\n  this.frameClipDiv_ = this.createFrameClipDiv_();\n  this.frameClipDiv_.insertBefore(this.contractDiv_, this.frameClipDiv_.firstChild);\n  this.container_.insertBefore(this.frameClipDiv_, this.container_.firstChild);\n};\n","/**\n * @fileoverview Set of types for block connections\n */\n'use strict';\n\ngoog.provide('Blockly.BlockValueType');\n\n/**\n * Enum of block types. Used for e.g., configuring allowable input connections\n * and occasionally block coloring\n * @enum {string}\n */\nBlockly.BlockValueType = {\n  NONE: 'None', // Typically as a connection/input check means \"accepts any type\"\n  STRING: 'String',\n  NUMBER: 'Number',\n  IMAGE: 'Image',\n  BOOLEAN: 'Boolean',\n  FUNCTION: 'Function',\n  COLOUR: 'Colour',\n  ARRAY: 'Array',\n\n  // p5.play Sprite\n  SPRITE: 'Sprite',\n\n  /**\n   * {Object} Behavior\n   * {function} Behavior.func\n   * {Array} Behavior.extraArgs\n   */\n  BEHAVIOR: 'Behavior',\n\n  /**\n   * {Object} Location\n   * {number} Location.x\n   * {number} Location.y\n   */\n  LOCATION: 'Location',\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Class for caching image dimensions which have been dynamically determined\n */\n'use strict';\n\ngoog.provide('Blockly.FunctionalBlockUtils');\ngoog.provide('Blockly.FunctionalTypeColors');\ngoog.require('Blockly.BlockValueType');\n\nvar typesToColors = {};\ntypesToColors[Blockly.BlockValueType.NONE] = [0, 0, 0]; // 000000\ntypesToColors[Blockly.BlockValueType.NUMBER] = [192, 1.00, 0.99]; // 00ccff\ntypesToColors[Blockly.BlockValueType.STRING] = [180, 1.00, 0.60]; // 0099999\ntypesToColors[Blockly.BlockValueType.IMAGE] = [285, 1.00, 0.80]; // 9900cc\ntypesToColors[Blockly.BlockValueType.BOOLEAN] = [90, 1.00, 0.4]; // 336600\n\n/**\n * Map of colors associated with given types\n * @type {Object.<Blockly.BlockValueType, Array>}\n */\nBlockly.FunctionalTypeColors = typesToColors;\n\n/**\n * Helper function to create the init section for a functional block.\n * @param {Blockly.Block} block The block to initialize.\n * @param {string} title Localized block title to display.\n * @param {string} type Block type which appears in xml.\n * @param {Array} args Arguments to this block.\n * @param {number=} config_opt.titleFontSize Optional title font size\n * @param {boolean=} config_opt.verticallyStackInputs Inputs are stacked\n *   vertically instead of horizontally.\n */\nBlockly.FunctionalBlockUtils.initTitledFunctionalBlock = function (block, title, type, args, config_opt) {\n  config_opt = config_opt || {};\n  block.setFunctional(true, {\n    headerHeight: 30\n  });\n  block.setHSV.apply(block, Blockly.FunctionalTypeColors[type]);\n\n  var options = {\n    fixedSize: { height: 35 },\n    fontSize: config_opt.titleFontSize\n  };\n  block.appendDummyInput()\n    .appendTitle(new Blockly.FieldLabel(title, options))\n    .setAlign(Blockly.ALIGN_CENTRE);\n\n  for (var i = 0; i < args.length; i++) {\n    var arg = args[i];\n    var input = block.appendFunctionalInput(arg.name);\n    input.setInline(i > 0 && !config_opt.verticallyStackInputs);\n    input.setHSV.apply(input, Blockly.FunctionalTypeColors[arg.type]);\n    input.setCheck(arg.type);\n    input.setAlign(Blockly.ALIGN_CENTRE);\n  }\n\n  if (type === Blockly.BlockValueType.NONE) {\n    block.setFunctionalOutput(false);\n  } else {\n    block.setFunctionalOutput(true, type);\n  }\n};\n\nBlockly.FunctionalBlockUtils.installStringPicker = function(blockly, generator, options) {\n  var values = options.values;\n  var blockName = options.blockName;\n  blockly.Blocks[blockName] = {\n    init: function () {\n      this.setFunctional(true, {\n        headerHeight: 0,\n        rowBuffer: 3\n      });\n      this.setHSV.apply(this, Blockly.FunctionalTypeColors[Blockly.BlockValueType.STRING]);\n      this.appendDummyInput()\n        .appendTitle(new Blockly.FieldLabel('\"'))\n        .appendTitle(new blockly.FieldDropdown(values), 'VAL')\n        .appendTitle(new Blockly.FieldLabel('\"'))\n        .setAlign(Blockly.ALIGN_CENTRE);\n      this.setFunctionalOutput(true, blockly.BlockValueType.STRING);\n    }\n  };\n\n  generator[blockName] = function() {\n    return blockly.JavaScript.quote_(this.getTitleValue('VAL'));\n  };\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for adding, removing and setting classes.  Prefer\n * {@link goog.dom.classlist} over these utilities since goog.dom.classlist\n * conforms closer to the semantics of Element.classList, is faster (uses\n * native methods rather than parsing strings on every call) and compiles\n * to smaller code as a result.\n *\n * Note: these utilities are meant to operate on HTMLElements and\n * will not work on elements with differing interfaces (such as SVGElements).\n *\n * @author arv@google.com (Erik Arvidsson)\n */\n\n\ngoog.provide('goog.dom.classes');\n\ngoog.require('goog.array');\n\n\n/**\n * Sets the entire class name of an element.\n * @param {Node} element DOM node to set class of.\n * @param {string} className Class name(s) to apply to element.\n * @deprecated Use goog.dom.classlist.set instead.\n */\ngoog.dom.classes.set = function(element, className) {\n  element.className = className;\n};\n\n\n/**\n * Gets an array of class names on an element\n * @param {Node} element DOM node to get class of.\n * @return {!Array<?>} Class names on {@code element}. Some browsers add extra\n *     properties to the array. Do not depend on any of these!\n * @deprecated Use goog.dom.classlist.get instead.\n */\ngoog.dom.classes.get = function(element) {\n  var className = element.className;\n  // Some types of elements don't have a className in IE (e.g. iframes).\n  // Furthermore, in Firefox, className is not a string when the element is\n  // an SVG element.\n  return goog.isString(className) && className.match(/\\S+/g) || [];\n};\n\n\n/**\n * Adds a class or classes to an element. Does not add multiples of class names.\n * @param {Node} element DOM node to add class to.\n * @param {...string} var_args Class names to add.\n * @return {boolean} Whether class was added (or all classes were added).\n * @deprecated Use goog.dom.classlist.add or goog.dom.classlist.addAll instead.\n */\ngoog.dom.classes.add = function(element, var_args) {\n  var classes = goog.dom.classes.get(element);\n  var args = goog.array.slice(arguments, 1);\n  var expectedCount = classes.length + args.length;\n  goog.dom.classes.add_(classes, args);\n  goog.dom.classes.set(element, classes.join(' '));\n  return classes.length == expectedCount;\n};\n\n\n/**\n * Removes a class or classes from an element.\n * @param {Node} element DOM node to remove class from.\n * @param {...string} var_args Class name(s) to remove.\n * @return {boolean} Whether all classes in {@code var_args} were found and\n *     removed.\n * @deprecated Use goog.dom.classlist.remove or goog.dom.classlist.removeAll\n *     instead.\n */\ngoog.dom.classes.remove = function(element, var_args) {\n  var classes = goog.dom.classes.get(element);\n  var args = goog.array.slice(arguments, 1);\n  var newClasses = goog.dom.classes.getDifference_(classes, args);\n  goog.dom.classes.set(element, newClasses.join(' '));\n  return newClasses.length == classes.length - args.length;\n};\n\n\n/**\n * Helper method for {@link goog.dom.classes.add} and\n * {@link goog.dom.classes.addRemove}. Adds one or more classes to the supplied\n * classes array.\n * @param {Array<string>} classes All class names for the element, will be\n *     updated to have the classes supplied in {@code args} added.\n * @param {Array<string>} args Class names to add.\n * @private\n */\ngoog.dom.classes.add_ = function(classes, args) {\n  for (var i = 0; i < args.length; i++) {\n    if (!goog.array.contains(classes, args[i])) {\n      classes.push(args[i]);\n    }\n  }\n};\n\n\n/**\n * Helper method for {@link goog.dom.classes.remove} and\n * {@link goog.dom.classes.addRemove}. Calculates the difference of two arrays.\n * @param {!Array<string>} arr1 First array.\n * @param {!Array<string>} arr2 Second array.\n * @return {!Array<string>} The first array without the elements of the second\n *     array.\n * @private\n */\ngoog.dom.classes.getDifference_ = function(arr1, arr2) {\n  return goog.array.filter(\n      arr1, function(item) { return !goog.array.contains(arr2, item); });\n};\n\n\n/**\n * Switches a class on an element from one to another without disturbing other\n * classes. If the fromClass isn't removed, the toClass won't be added.\n * @param {Node} element DOM node to swap classes on.\n * @param {string} fromClass Class to remove.\n * @param {string} toClass Class to add.\n * @return {boolean} Whether classes were switched.\n * @deprecated Use goog.dom.classlist.swap instead.\n */\ngoog.dom.classes.swap = function(element, fromClass, toClass) {\n  var classes = goog.dom.classes.get(element);\n\n  var removed = false;\n  for (var i = 0; i < classes.length; i++) {\n    if (classes[i] == fromClass) {\n      goog.array.splice(classes, i--, 1);\n      removed = true;\n    }\n  }\n\n  if (removed) {\n    classes.push(toClass);\n    goog.dom.classes.set(element, classes.join(' '));\n  }\n\n  return removed;\n};\n\n\n/**\n * Adds zero or more classes to an element and removes zero or more as a single\n * operation. Unlike calling {@link goog.dom.classes.add} and\n * {@link goog.dom.classes.remove} separately, this is more efficient as it only\n * parses the class property once.\n *\n * If a class is in both the remove and add lists, it will be added. Thus,\n * you can use this instead of {@link goog.dom.classes.swap} when you have\n * more than two class names that you want to swap.\n *\n * @param {Node} element DOM node to swap classes on.\n * @param {?(string|Array<string>)} classesToRemove Class or classes to\n *     remove, if null no classes are removed.\n * @param {?(string|Array<string>)} classesToAdd Class or classes to add, if\n *     null no classes are added.\n * @deprecated Use goog.dom.classlist.addRemove instead.\n */\ngoog.dom.classes.addRemove = function(element, classesToRemove, classesToAdd) {\n  var classes = goog.dom.classes.get(element);\n  if (goog.isString(classesToRemove)) {\n    goog.array.remove(classes, classesToRemove);\n  } else if (goog.isArray(classesToRemove)) {\n    classes = goog.dom.classes.getDifference_(classes, classesToRemove);\n  }\n\n  if (goog.isString(classesToAdd) &&\n      !goog.array.contains(classes, classesToAdd)) {\n    classes.push(classesToAdd);\n  } else if (goog.isArray(classesToAdd)) {\n    goog.dom.classes.add_(classes, classesToAdd);\n  }\n\n  goog.dom.classes.set(element, classes.join(' '));\n};\n\n\n/**\n * Returns true if an element has a class.\n * @param {Node} element DOM node to test.\n * @param {string} className Class name to test for.\n * @return {boolean} Whether element has the class.\n * @deprecated Use goog.dom.classlist.contains instead.\n */\ngoog.dom.classes.has = function(element, className) {\n  return goog.array.contains(goog.dom.classes.get(element), className);\n};\n\n\n/**\n * Adds or removes a class depending on the enabled argument.\n * @param {Node} element DOM node to add or remove the class on.\n * @param {string} className Class name to add or remove.\n * @param {boolean} enabled Whether to add or remove the class (true adds,\n *     false removes).\n * @deprecated Use goog.dom.classlist.enable or goog.dom.classlist.enableAll\n *     instead.\n */\ngoog.dom.classes.enable = function(element, className, enabled) {\n  if (enabled) {\n    goog.dom.classes.add(element, className);\n  } else {\n    goog.dom.classes.remove(element, className);\n  }\n};\n\n\n/**\n * Removes a class if an element has it, and adds it the element doesn't have\n * it.  Won't affect other classes on the node.\n * @param {Node} element DOM node to toggle class on.\n * @param {string} className Class to toggle.\n * @return {boolean} True if class was added, false if it was removed\n *     (in other words, whether element has the class after this function has\n *     been called).\n * @deprecated Use goog.dom.classlist.toggle instead.\n */\ngoog.dom.classes.toggle = function(element, className) {\n  var add = !goog.dom.classes.has(element, className);\n  goog.dom.classes.enable(element, className, add);\n  return add;\n};\n","'use strict';\n\ngoog.provide('Blockly.ExampleView');\ngoog.require('goog.dom.classes');\n\n/** @const */ var NO_RESULT_TEXT = \"\";\n/** @const */ var SUCCESS_TEXT = \"Matches definition.\";\n/** @const */ var RESULT_TEXT_TOP_MARGIN = 14;\n/** @const */ var EMPTY_EXAMPLE_INPUT_WIDTH = 40;\n\n/**\n * Handles laying out an example block with a test button\n * @constructor\n * @param {Element} dom\n * @param {SVGElement} svg\n * @param {Blockly.ContractEditor} contractEditor\n */\nBlockly.ExampleView = function (dom, svg, contractEditor) {\n  this.domParent_ = dom;\n  this.svgParent_ = svg;\n  this.contractEditor_ = contractEditor;\n  this.block_ = null;\n\n  this.horizontalLine = Blockly.createSvgElement('rect', {\n    'fill': Blockly.ContractEditor.GRID_LINE_COLOR,\n    'height': 2.0\n  }, this.svgParent_);\n  Blockly.svgIgnoreMouseEvents(this.horizontalLine);\n\n  this.grayBackdrop = Blockly.createSvgElement('rect', {\n    'fill': '#DDD'\n  }, this.svgParent_, {'belowExisting': true});\n  this.grayBackdrop.style.pointerEvents = 'none';\n  Blockly.svgIgnoreMouseEvents(this.grayBackdrop);\n\n  this.testExampleButton = this.initializeTestButton_(\"Test\", \"run26\",\n    this.testExample_.bind(this));\n  this.resetExampleButton = this.initializeTestButton_(\"Reset\", \"reset26\",\n    this.reset.bind(this));\n  goog.dom.classes.add(this.resetExampleButton, 'resetButton');\n  goog.dom.append(this.domParent_, this.testExampleButton);\n  goog.dom.append(this.domParent_, this.resetExampleButton);\n  this.resultText = goog.dom.createDom('div', 'example-result-text');\n  Blockly.svgIgnoreMouseEvents(this.resultText);\n  this.resultText.innerHTML = NO_RESULT_TEXT;\n  goog.dom.append(this.domParent_, this.resultText);\n  this.refreshTestingUI(false);\n};\n\n/**\n * Create/configure our test/reset buttons.\n */\nBlockly.ExampleView.prototype.initializeTestButton_ = function (buttonText,\n    iconClass, callback) {\n  var newButton = goog.dom.createDom('button',\n    'testButton launch blocklyLaunch exampleAreaButton');\n  var testText = goog.dom.createDom('div');\n  testText.innerHTML = buttonText;\n  var runImage = goog.dom.createDom('img', iconClass);\n  runImage.setAttribute('src', Blockly.assetUrl('media/1x1.gif'));\n  goog.dom.append(newButton, runImage);\n  goog.dom.append(newButton, testText);\n  Blockly.bindEvent_(newButton, 'click', null, callback);\n  return newButton;\n};\n\n/**\n * @returns {Blockly.Block} The example block this view represents\n */\n Blockly.ExampleView.prototype.getBlock  = function() {\n  return this.block_;\n};\n\n/**\n * Performs the test for this example, setting the result text appropriately.\n */\nBlockly.ExampleView.prototype.testExample_ = function () {\n  this.contractEditor_.resetExampleViews();\n\n  var failure = this.contractEditor_.testExample(this.block_, true);\n  this.setResult(failure || SUCCESS_TEXT);\n  this.refreshTestingUI(true);\n\n  // TODO(bjordan): UI re-layout post-result?\n};\n\n/**\n * Reset to a non-running state, clearing our result text.\n */\nBlockly.ExampleView.prototype.reset = function () {\n  // If reset button isn't visible, don't change anything, thus keeping around\n  // old result text\n  if (goog.style.isElementShown(this.resetExampleButton)) {\n    this.contractEditor_.resetExample(this.block_);\n    this.resultText.innerHTML = NO_RESULT_TEXT;\n    this.refreshTestingUI(false);\n  }\n};\n\n/**\n * @param {string} failure The failure text. If null, set to success text\n */\nBlockly.ExampleView.prototype.setResult = function (failure) {\n  this.resultText.innerHTML = failure || SUCCESS_TEXT;\n  this.refreshTestingUI(false);\n};\n\n/**\n * @param {boolean} active Is this example's result currently visualized\n */\nBlockly.ExampleView.prototype.refreshTestingUI = function (active) {\n  goog.style.setElementShown(this.resultText, Blockly.showExampleTestButtons);\n  goog.style.setElementShown(this.testExampleButton,\n      Blockly.showExampleTestButtons && !active);\n  goog.style.setElementShown(this.resetExampleButton,\n      Blockly.showExampleTestButtons && active);\n};\n\n/**\n * Places the example at the specified location, returning an incremented Y\n * coordinate.\n * @param block\n * @param {number} currentY - Y coordinate to start at, relative to svgParent\n * @param {number} exampleMaxInputWidth - max width of example call blocks\n * @param {number} marginLeft\n * @param {number} marginBelow\n * @param {number} fullWidth - full width of layout area\n * @param {number} midLineX - midline location\n * @param {number} exampleDivTop - top of our DOM parent relative to SVG parent\n * @returns {number} the y coordinate to continue laying out at\n */\nBlockly.ExampleView.prototype.placeExampleAndGetNewY = function (\n    block, currentY, exampleMaxInputWidth, marginLeft, marginBelow, fullWidth,\n    midLineX, exampleDivTop) {\n  this.block_ = block;\n  var newY = currentY;\n\n  var commonMargin = marginBelow / 2;\n  newY += commonMargin;\n\n  if (!block.isCurrentlyBeingDragged()) {\n    var input = block.getInput(Blockly.ContractEditor.EXAMPLE_BLOCK_ACTUAL_INPUT_NAME);\n    if (input.type === Blockly.FUNCTIONAL_INPUT) {\n      var originalExtraSpace = input.extraSpace;\n      var width = EMPTY_EXAMPLE_INPUT_WIDTH;\n      var functionCallBlock = block.getInputTargetBlock(\n        Blockly.ContractEditor.EXAMPLE_BLOCK_ACTUAL_INPUT_NAME);\n      if (functionCallBlock) {\n        width = functionCallBlock.getHeightWidth().width;\n      }\n      input.extraSpace = exampleMaxInputWidth - width;\n      if (input.extraSpace !== originalExtraSpace) {\n        block.render(true);\n      }\n    }\n\n    block.moveTo(marginLeft, newY);\n  }\n\n  newY += block.getHeightWidth().height;\n\n  newY += commonMargin;\n\n  var exampleButtonX = midLineX + commonMargin;\n  [this.testExampleButton, this.resetExampleButton].forEach(function (button) {\n    button.style.top = newY - exampleDivTop + 'px';\n    button.style.left = exampleButtonX + 'px';\n  });\n\n  // Only test or reset will be visible\n  var buttonWidth = Math.max(this.resetExampleButton.offsetWidth,\n    this.testExampleButton.offsetWidth);\n  var buttonHeight = Math.max(this.resetExampleButton.offsetHeight,\n    this.testExampleButton.offsetHeight);\n\n  this.resultText.style.top = (newY + RESULT_TEXT_TOP_MARGIN - exampleDivTop)\n      + 'px';\n  var exampleButtonRight = exampleButtonX + buttonWidth;\n  this.resultText.style.left = commonMargin + exampleButtonRight + 'px';\n\n  newY += buttonHeight;\n\n  newY += commonMargin;\n\n  this.horizontalLine.setAttribute('transform', 'translate(' + 0 + ',' + newY + ')');\n  this.horizontalLine.setAttribute('width', fullWidth);\n\n  this.grayBackdrop.setAttribute('transform', 'translate('+ 0 +','+ currentY +')');\n  this.grayBackdrop.setAttribute('width', midLineX);\n  this.grayBackdrop.setAttribute('height', newY - currentY);\n\n  return newY;\n};\n\n\nBlockly.ExampleView.prototype.dispose = function () {\n  goog.dom.removeNode(this.horizontalLine);\n  goog.dom.removeNode(this.grayBackdrop);\n  goog.dom.removeNode(this.testExampleButton);\n  goog.dom.removeNode(this.resetExampleButton);\n  goog.dom.removeNode(this.resultText);\n};\n","'use strict';\n\ngoog.provide('Blockly.ContractEditorSectionView');\n\n/** @const */ var DOWN_TRIANGLE_CHARACTER = '\\u25BC'; // \n/** @const */ var RIGHT_TRIANGLE_CHARACTER = '\\u25B6'; // \n/** @const */ var DARK_GRAY_HEX = '#898989';\n/** @const */ var YELLOW_HEX = '#ffa400';\n/** @const */ var HIGHLIGHT_BOX_WIDTH = 10; //px\n/** @const */ var DEFAULT_HEADER_HEIGHT = 25; //px\n\n/**\n * Header with a block below it\n * @constructor\n * @param {SVGElement} canvas\n * @param {Object} opt_options\n *  {Function<boolean>} placeContentCallback\n *  {Function<boolean>} onCollapseCallback\n */\nBlockly.ContractEditorSectionView = function (canvas, opt_options) {\n  this.headerText_ = opt_options.headerText;\n  this.onCollapseCallback_ = opt_options.onCollapseCallback;\n  this.placeContentCallback = opt_options.placeContentCallback;\n  this.headerHeight = opt_options.headerHeight || DEFAULT_HEADER_HEIGHT;\n  /**\n   * @type {number|null}\n   * @private\n   */\n  this.sectionNumber_ = opt_options.hasOwnProperty('sectionNumber') ? opt_options.sectionNumber : null;\n\n  /**\n   * @type {?Blockly.SvgHighlightBox}\n   */\n  this.highlightBox_ = opt_options.highlightBox || null;\n\n  // Whether this is the current highlight box target\n  this.highlighted_ = false;\n\n  this.completelyHidden_ = false;\n\n  /**\n   * @type {Blockly.SvgHeader}\n   * @private\n   */\n  this.header_ = new Blockly.SvgHeader(canvas, {\n    headerText: this.textForCurrentState_(),\n    onMouseDown: goog.bind(this.toggleCollapse, this),\n    backgroundColor: DARK_GRAY_HEX\n  });\n  this.collapsed_ = false;\n  this.showHeader_ = true;\n};\n\nBlockly.ContractEditorSectionView.prototype.setHeaderColor = function (colorHex) {\n  this.header_.setColor(colorHex)\n};\n\nBlockly.ContractEditorSectionView.prototype.textForCurrentState_ = function () {\n  if (!this.onCollapseCallback_) {\n    return this.headerText_;\n  }\n\n  var displayText = \"\";\n\n  var arrowCharacter = this.collapsed_ ?\n    RIGHT_TRIANGLE_CHARACTER :\n    DOWN_TRIANGLE_CHARACTER;\n\n  displayText += arrowCharacter + \" \";\n\n  if (this.sectionNumber_ !== null) {\n    displayText += this.sectionNumber_ + \". \";\n  }\n\n  displayText += this.headerText_;\n\n  return displayText;\n};\n\n/**\n * @param {boolean} shouldBeHidden\n */\nBlockly.ContractEditorSectionView.prototype.setHidden = function (shouldBeHidden) {\n  this.completelyHidden_ = shouldBeHidden;\n  if (shouldBeHidden) {\n    this.setCollapsed(true);\n  }\n  this.refreshHeaderText_();\n};\n\nBlockly.ContractEditorSectionView.prototype.removeSectionNumber = function () {\n  this.sectionNumber_ = null;\n  this.refreshHeaderText_();\n};\n\n/**\n * Mark this view as collapsed.\n * Will visually collapse during next placement.\n * @private\n */\nBlockly.ContractEditorSectionView.prototype.toggleCollapse = function () {\n  this.setCollapsed(!this.collapsed_);\n};\n/**\n * Set the view\n * @param isCollapsed\n * @private\n */\nBlockly.ContractEditorSectionView.prototype.setCollapsed = function (isCollapsed) {\n  this.collapsed_ = isCollapsed;\n  this.header_.showSeparator(isCollapsed);\n  if (this.onCollapseCallback_) {\n    this.onCollapseCallback_(this.collapsed_);\n  }\n  this.refreshHeaderText_();\n};\n\n/**\n * @returns {boolean} whether this section is currently collapsed\n */\nBlockly.ContractEditorSectionView.prototype.isCollapsed = function () {\n  return this.collapsed_;\n};\n\nBlockly.ContractEditorSectionView.prototype.refreshHeaderText_ = function () {\n  this.header_.setText(this.textForCurrentState_());\n};\n\nBlockly.ContractEditorSectionView.prototype.setHighlighted = function (highlighted) {\n  this.highlighted_ = highlighted;\n};\n\n/**\n * Show or hide the header\n * @param {boolean} showHeader\n * @public\n */\nBlockly.ContractEditorSectionView.prototype.setHeaderVisible = function (showHeader) {\n  this.showHeader_ = showHeader;\n};\n\n/**\n * Places the example header and block at the specified location,\n * returning an incremented Y coordinate\n * @param currentY\n * @param width\n * @returns {Number} the currentY to continue laying out at\n */\nBlockly.ContractEditorSectionView.prototype.placeAndGetNewY = function (currentY, width) {\n  if (this.completelyHidden_) {\n    this.header_.setVisible(false);\n    return currentY;\n  }\n\n  var startY = currentY;\n\n  this.header_.setVisible(this.showHeader_);\n\n  if (this.showHeader_) {\n    this.header_.setPositionSize(currentY, width, this.headerHeight);\n    currentY += this.headerHeight;\n  }\n\n  if (!this.collapsed_) {\n    currentY = this.placeAndGetNewYInnerSegment_(currentY);\n  }\n\n  if (this.highlighted_) {\n    this.highlightBox_.setPositionSize(startY, width, currentY - startY);\n  }\n\n  return currentY;\n};\n\nBlockly.ContractEditorSectionView.prototype.placeAndGetNewYInnerSegment_ = function (currentY) {\n    if (this.placeContentCallback) {\n      currentY = this.placeContentCallback(currentY);\n    }\n    return currentY;\n};\n","'use strict';\n\ngoog.provide('Blockly.ContractDefinitionSection');\ngoog.require('Blockly.BlockSpaceEditor');\n\n/**\n * Margin in pixels to leave between the function block and the flyout.\n * @type {number}\n * @const\n */\nvar FUNCTION_BLOCK_VERTICAL_MARGIN = Blockly.BlockSpaceEditor.BUMP_PADDING_TOP;\n/**\n * Margin to leave to the left of the function definition block.\n * @type {number}\n * @const\n */\nvar FUNCTION_BLOCK_MIN_HORIZONTAL_MARGIN =\n    Blockly.BlockSpaceEditor.BUMP_PADDING_LEFT;\n\n/**\n * Handles UI state and layout for the contract editor definition section/block\n * @param {Element} canvasToDrawOn element this section should be drawn on\n * @constructor\n */\nBlockly.ContractDefinitionSection = function (canvasToDrawOn) {\n  this.definitionTableGroup = Blockly.createSvgElement('g', {}, canvasToDrawOn);\n  this.grayDefinitionBackground = Blockly.createSvgElement('rect', {\n    'fill': '#DDD'\n  }, this.definitionTableGroup);\n  Blockly.svgIgnoreMouseEvents(this.grayDefinitionBackground);\n\n  this.verticalDefinitionMidline = Blockly.createSvgElement('rect', {\n    'fill': Blockly.ContractEditor.GRID_LINE_COLOR\n  }, this.definitionTableGroup);\n  this.verticalDefinitionMidline.setAttribute('width', 2.0);\n  Blockly.svgIgnoreMouseEvents(this.verticalDefinitionMidline);\n\n  this.horizontalDefinitionTopLine = Blockly.createSvgElement('rect', {\n    'fill': Blockly.ContractEditor.GRID_LINE_COLOR\n  }, this.definitionTableGroup);\n  this.horizontalDefinitionTopLine.setAttribute('height', 2.0);\n  Blockly.svgIgnoreMouseEvents(this.horizontalDefinitionTopLine);\n  this.horizontalDefinitionBottomLine = Blockly.createSvgElement('rect', {\n    'fill': Blockly.ContractEditor.GRID_LINE_COLOR\n  }, this.definitionTableGroup);\n  this.horizontalDefinitionBottomLine.setAttribute('height', 2.0);\n  Blockly.svgIgnoreMouseEvents(this.horizontalDefinitionBottomLine);\n};\n\n/**\n * Update UI to match new collapse state\n * @param {boolean} isNowCollapsed - whether we are now collapsed\n */\nBlockly.ContractDefinitionSection.prototype.handleCollapse = function (isNowCollapsed) {\n  this.definitionTableGroup.style.display = isNowCollapsed ? 'none' : 'block';\n};\n\n/**\n * Lays out the contract definition section. Places the definition block and\n * (if not in variable mode) draws grid lines to match the example section.\n * Coordinates are all relative to the parent canvas.\n * @param {number} currentY - starting Y coordinate for\n * @param {number} verticalMidlineX - X offset for the column separator\n * @param {number} fullWidth - full width to layout in\n * @param {?Blockly.Block} functionDefinitionBlock - definition block to place\n *        (possibly null during initialization steps)\n * @returns {number} new Y to continue laying out at\n */\nBlockly.ContractDefinitionSection.prototype.placeContent = function (currentY,\n    verticalMidlineX, fullWidth, functionDefinitionBlock) {\n  if (!functionDefinitionBlock) {\n    return currentY;\n  }\n\n  var verticalMidlineY = currentY;\n\n  if (functionDefinitionBlock.isVariable()) {\n    this.definitionTableGroup.style.display = 'none';\n  } else {\n    this.definitionTableGroup.style.display = 'block';\n    this.horizontalDefinitionTopLine.setAttribute('transform',\n        'translate(' + 0 + ',' + verticalMidlineY + ')');\n    this.verticalDefinitionMidline.setAttribute('transform',\n        'translate(' + verticalMidlineX + ',' + verticalMidlineY + ')');\n    this.grayDefinitionBackground.setAttribute('transform',\n        'translate(' + 0 + ',' + currentY + ')');\n    this.horizontalDefinitionTopLine.setAttribute('width', fullWidth);\n  }\n\n  currentY += FUNCTION_BLOCK_VERTICAL_MARGIN;\n\n  var xOffset = functionDefinitionBlock.isVariable() ?\n      FUNCTION_BLOCK_MIN_HORIZONTAL_MARGIN :\n      FUNCTION_BLOCK_MIN_HORIZONTAL_MARGIN + verticalMidlineX;\n  functionDefinitionBlock.moveTo(xOffset, currentY);\n\n  currentY += functionDefinitionBlock.getHeightWidth().height;\n\n  currentY += FUNCTION_BLOCK_VERTICAL_MARGIN;\n\n  if (!functionDefinitionBlock.isVariable()) {\n    this.horizontalDefinitionBottomLine.setAttribute('transform',\n        'translate(' + 0 + ',' + currentY + ')');\n    this.horizontalDefinitionBottomLine.setAttribute('width', fullWidth);\n    this.verticalDefinitionMidline.setAttribute('height', currentY - verticalMidlineY);\n    this.grayDefinitionBackground.setAttribute('height', currentY - verticalMidlineY);\n    this.grayDefinitionBackground.setAttribute('width', verticalMidlineX);\n  }\n\n  return currentY;\n};\n","'use strict';\n\ngoog.provide('Blockly.SvgHeader');\n\n/** @const */ var TEXT_PADDING_LEFT = '10'; // px\n/** @const */ var SEPARATOR_LINE_HEIGHT = 2; // px\n\n/**\n * A horizontal SVG bar with rectangular background and text\n * @param {!Element} parent {!Element}\n * @param {Object=} opt_options\n * @constructor\n */\nBlockly.SvgHeader = function (parent, opt_options) {\n  var options = opt_options || {\n    backgroundColor: '#000',\n    headerText: 'Default Header'\n  };\n\n  var extraStyle = options.onMouseDown ? '' : 'pointer-events: none;';\n\n  this.svgGroup_ = Blockly.createSvgElement('g',\n    {style: extraStyle},\n    parent,\n    {belowExisting: true});\n  this.rectangleElement_ = Blockly.createSvgElement('rect',\n    {'fill': options.backgroundColor, 'style': extraStyle},\n    this.svgGroup_);\n  this.separatorElement_ = Blockly.createSvgElement('rect',\n  {'fill': '#FFF', 'style': extraStyle + 'opacity:.3;'},\n    this.svgGroup_);\n  this.textElement_ = Blockly.createSvgElement('text',\n    {'class': 'contractEditorHeaderText', 'style': extraStyle}, this.svgGroup_);\n  if (options.headerText) {\n    this.textElement_.textContent = options.headerText;\n  }\n  if (options.onMouseDown) {\n    Blockly.bindEvent_(this.svgGroup_, 'click', null, options.onMouseDown);\n  }\n};\n\nBlockly.SvgHeader.prototype.showSeparator = function (shouldShow) {\n  goog.style.setElementShown(this.separatorElement_, shouldShow);\n};\n\nBlockly.SvgHeader.prototype.setColor = function (colorHex) {\n  this.rectangleElement_.setAttribute('fill', colorHex);\n};\n\n/**\n * @param yOffset {Number}\n * @param width {Number}\n * @param height {Number}\n */\nBlockly.SvgHeader.prototype.setPositionSize = function (yOffset, width, height) {\n  this.svgGroup_.setAttribute('transform', 'translate(' + 0 + ',' + yOffset + ')');\n  this.rectangleElement_.setAttribute('width', width + 2); // 2 is extra for overlap, sometimes <1px spacing\n  this.separatorElement_.setAttribute('width', width);\n  this.separatorElement_.setAttribute('height', SEPARATOR_LINE_HEIGHT);\n  this.separatorElement_.setAttribute('transform', 'translate(' + 0 + ',' + (height - 1) + ')');\n  this.rectangleElement_.setAttribute('height', height);\n  this.textElement_.setAttribute('x', TEXT_PADDING_LEFT);\n  var rectangleMiddleY = height / 2;\n  // text getBBox() height seems to be off by a bit, 1/3 of getBBox height looks best\n  var thirdTextHeight = this.textElement_.getBBox().height / 3;\n\n  this.textElement_.setAttribute('y', rectangleMiddleY + thirdTextHeight);\n};\n\nBlockly.SvgHeader.prototype.setText = function (text) {\n  this.textElement_.textContent = text;\n};\n\nBlockly.SvgHeader.prototype.setVisible = function (visible) {\n  goog.style.setElementShown(this.svgGroup_, visible);\n};\n\nBlockly.SvgHeader.prototype.removeSelf = function () {\n  goog.dom.removeNode(this.svgGroup_);\n};\n","'use strict';\n\ngoog.provide('Blockly.SvgTextButton');\n\n/**\n * A clickable SVG button with text on it\n * @param {!SVGElement} parent\n * @param {String} text\n * @param {Function} onMouseDown\n * @constructor\n */\nBlockly.SvgTextButton = function (parent, text, onMouseDown) {\n  var button = Blockly.createSvgElement('g', {\n    'class': 'svgTextButton',\n    'filter': 'url(#blocklyTrashcanShadowFilter)'\n  }, parent);\n  var padding = 7;\n  var purpleFillColor = '#7665a0';\n  this.buttonRect = Blockly.createSvgElement('rect', {\n    'rx': 12,\n    'ry': 12,\n    'fill': purpleFillColor,\n    'stroke': 'white',\n    'stroke-width': '2.5'\n  }, button);\n  var textElement = Blockly.createSvgElement('text', {\n    'x': padding,\n    'y': padding,\n    'class': 'blocklyText'\n  }, button);\n  textElement.textContent = text;\n  var bounds = textElement.getBoundingClientRect();\n  this.buttonRect.setAttribute('width', bounds.width + 2 * padding);\n  this.buttonRectHeight = bounds.height + padding;\n  this.buttonRect.setAttribute('height', this.buttonRectHeight);\n  this.buttonRectYOffset = -bounds.height + padding - 1;\n  this.buttonRect.setAttribute('y', this.buttonRectYOffset);\n\n  Blockly.bindEvent_(button, 'click', null, onMouseDown);\n\n  this.svgGroup_ = button;\n};\n\n/**\n * @param xOffset {Number}\n * @param yOffset {Number}\n * @return {Number} y offset to continue rendering at\n */\nBlockly.SvgTextButton.prototype.renderAt = function (xOffset, yOffset) {\n  this.svgGroup_.setAttribute('transform', 'translate(' + xOffset + ','\n      + yOffset + ')');\n  return yOffset + this.buttonRectHeight;\n};\n\nBlockly.SvgTextButton.prototype.setVisible = function (visible) {\n  goog.style.setElementShown(this.svgGroup_, visible);\n};\n\n/**\n * @returns {number} width of the button\n */\nBlockly.SvgTextButton.prototype.getButtonWidth = function () {\n  return parseInt(this.buttonRect.getAttribute('width'), 10);\n};\n","'use strict';\n\ngoog.provide('Blockly.SvgHighlightBox');\n\n/**\n * A horizontal SVG highlight box with rectangular background and text\n * @param {!Element} parent {!Element}\n * @param {Object=} opt_options\n * @constructor\n */\nBlockly.SvgHighlightBox = function (parent, opt_options) {\n  opt_options = opt_options || {};\n  var color = opt_options.color || '#000';\n  var thickness = opt_options.thickness || '30';\n\n  var extraStyle = 'pointer-events: none;';\n\n  this.svgGroup_ = Blockly.createSvgElement('g', {\n    style: extraStyle\n  }, parent);\n\n  this.highlightRectangle_ = Blockly.createSvgElement('rect', {\n    'fill': 'none',\n    'stroke-width': thickness,\n    'stroke': color\n  }, this.svgGroup_);\n};\n\n/**\n * @param yOffset {Number}\n * @param width {Number}\n * @param height {Number}\n */\nBlockly.SvgHighlightBox.prototype.setPositionSize = function (yOffset, width, height) {\n  this.svgGroup_.setAttribute('transform', 'translate(' + 0 + ',' + yOffset + ')');\n  this.highlightRectangle_.setAttribute('width', width);\n  this.highlightRectangle_.setAttribute('height', height);\n};\n","'use strict';\n\ngoog.provide('Blockly.TypeDropdown');\n\n/**\n * A DOM-based type selection dropdown\n * @param {!Object} options\n * @param {Function} options.onTypeChanged takes parameter {String} newType\n * @param {Array.<BlockValueType>} options.typeChoices\n * @constructor\n */\nBlockly.TypeDropdown = function (options) {\n  /**\n   * @type {goog.ui.Select}\n   * @private\n   */\n  this.selectComponent_ = null;\n\n  /**\n   * @type {Element}\n   * @private\n   */\n  this.buttonColorSquareDiv_ = null;\n\n  /**\n   * Called with new {Blockly.BlockValueType}\n   * @type {Function}\n   * @private\n   */\n  this.onTypeChanged_ = options.onTypeChanged;\n\n  /**\n   * Types to make available\n   * @type {Array.<BlockValueType>}\n   * @private\n   */\n  this.typeChoices_ = options.typeChoices;\n\n  /**\n   * Current type of select dropdown\n   * @type {Blockly.BlockValueType}\n   * @private\n   */\n  this.type_ = options.type;\n\n  // For disposal\n  this.changeListenerKey_ = null;\n};\n\nBlockly.TypeDropdown.prototype.render = function (parent) {\n  var selectComponent = this.renderSelectComponent_(parent);\n  this.buttonColorSquareDiv_ = this.createColorSquareDiv();\n  goog.dom.appendChild(selectComponent.getElement(), this.buttonColorSquareDiv_);\n  this.setSquareIconColor(this.type_, this.buttonColorSquareDiv_);\n  this.attachListeners_(selectComponent);\n  this.selectComponent_ = selectComponent;\n  this.setType_(this.type_);\n};\n\nBlockly.TypeDropdown.prototype.setType_ = function (newType) {\n  this.type_ = newType;\n  this.setSquareIconColor(this.type_, this.buttonColorSquareDiv_);\n};\n\n/**\n * @param {Element} parent parent to render on\n * @returns {goog.ui.Select}\n * @private\n */\nBlockly.TypeDropdown.prototype.renderSelectComponent_ = function (parent) {\n  var selectComponent = this.createSelect_();\n  selectComponent.render(parent);\n  return selectComponent;\n};\n\n/**\n * @returns {goog.ui.Select} new dropdown\n * @private\n */\nBlockly.TypeDropdown.prototype.createSelect_ = function() {\n  var newTypeDropdown = new goog.ui.Select(null, null,\n    goog.ui.FlatMenuButtonRenderer.getInstance(),\n    null,\n    new Blockly.CustomCssClassMenuRenderer('colored-type-dropdown'));\n  this.typeChoices_.forEach(function (choiceKey) {\n    var menuItem = new goog.ui.MenuItem(choiceKey);\n    newTypeDropdown.addItem(menuItem);\n    var colorIconDiv = this.createColorSquareDiv();\n    goog.dom.insertChildAt(menuItem.getElement(), colorIconDiv, 0);\n    this.setSquareIconColor(choiceKey, colorIconDiv);\n  }, this);\n  newTypeDropdown.setValue(this.type_);\n  return newTypeDropdown;\n};\n\n/**\n * @returns {Element}\n * @private\n */\nBlockly.TypeDropdown.prototype.createColorSquareDiv = function () {\n  return goog.dom.createDom('div', 'color-square-icon');\n};\n\nBlockly.TypeDropdown.prototype.attachListeners_ = function (selectComponent) {\n  this.changeListenerKey_ = goog.events.listen(selectComponent, goog.ui.Component.EventType.CHANGE,\n    goog.bind(this.selectChanged_, this));\n};\n\n/**\n * @param comboBoxEvent\n * @private\n */\nBlockly.TypeDropdown.prototype.selectChanged_ = function(comboBoxEvent) {\n  /** @type {Blockly.BlockValueType} */\n  var newType = comboBoxEvent.target.getContent();\n  this.setType_(newType);\n  this.onTypeChanged_(newType);\n};\n\n/**\n * Updates dropdown button's color square to match given type\n * @param {Blockly.BlockValueType} newType\n * @param {Element} colorIconDiv\n */\nBlockly.TypeDropdown.prototype.setSquareIconColor = function (newType, colorIconDiv) {\n  var hsvColor = Blockly.FunctionalTypeColors[newType];\n  var hexColor = goog.color.hsvToHex(hsvColor[0], hsvColor[1], hsvColor[2] * 255);\n  colorIconDiv.style.background = hexColor;\n};\n\nBlockly.TypeDropdown.prototype.dispose = function () {\n  goog.events.unlistenByKey(this.changeListenerKey_);\n  this.selectComponent_.dispose();\n};\n","'use strict';\n\ngoog.provide('Blockly.DomainNameInput');\n\n/**\n * A DOM-based input which sends events on changes\n * @param {!Object} options\n * @param {string} options.name initial name of domain\n * @param {Function} options.onNameChanged with parameter {String} newName\n * @param {Function} options.onEnterPressed\n * @constructor\n */\nBlockly.DomainNameInput = function (options) {\n  this.onNameChanged = options.onNameChanged;\n  this.onEnterPressed = options.onEnterPressed;\n  this.name = options.name;\n\n  /**\n   * Array of event keys usable by Blockly.unbindEvent_ to remove listeners\n   * @type {BindData}\n   * @private\n   */\n  this.eventsToUnbind_ = [];\n  /**\n   * Reference to created <input> element for later disposal\n   * @type {Element}\n   * @private\n   */\n  this.inputElement_ = null;\n};\n\nBlockly.DomainNameInput.prototype.render = function (parent) {\n  var inputElement = goog.dom.createDom('input');\n  inputElement.type = \"text\";\n  inputElement.style.width = \"200px\";\n  inputElement.style.placeholder = Blockly.Msg.FUNCTIONAL_NAME_LABEL;\n\n  if (this.name) {\n    inputElement.value = this.name;\n  }\n\n  parent.appendChild(inputElement);\n\n\n  this.eventsToUnbind_.push(Blockly.bindEvent_(inputElement, 'input', this, this.onInputChange_));\n  // IE9 doesn't fire oninput when delete key is pressed, bind keydown also\n  this.eventsToUnbind_.push(Blockly.bindEvent_(inputElement, 'keydown', this, this.onInputChange_));\n\n  this.inputElement_ = inputElement;\n};\n\n/**\n * @param {Event} DOM event from <input> tag 'input' or 'keydown' changes\n * @private\n */\nBlockly.DomainNameInput.prototype.onInputChange_ = function (event) {\n  if (this.onNameChanged) {\n    this.onNameChanged(event.target.value);\n  }\n};\n\nBlockly.DomainNameInput.prototype.dispose = function () {\n  this.eventsToUnbind_.forEach(function(eventHandle) {\n    Blockly.unbindEvent_(eventHandle);\n  });\n  goog.array.clear(this.eventsToUnbind_);\n\n  goog.dom.removeNode(this.inputElement_);\n};\n","'use strict';\n\ngoog.provide('Blockly.XButton');\n\n/**\n * A simple button with an \"x\" on it which sends an event on press\n *\n * Note: styling depends on bootstrap 'btn' class\n *\n * @param {!Object} options\n * @param options.onNameChanged takes {string} newName\n * @param options.onEnterPressed\n * @constructor\n */\nBlockly.XButton = function (options) {\n  this.onButtonPressed = options.onButtonPressed;\n\n  // For disposal\n  this.eventsToUnbind_ = [];\n  this.buttonElement_ = null;\n};\n\nBlockly.XButton.prototype.render = function (parent) {\n  var buttonElement = goog.dom.createDom('button');\n  buttonElement.className = \"btn\";\n  buttonElement.innerHTML = \"Remove\";\n  buttonElement.style.marginRight = \"-10px\"; // specific to contract editor\n\n  parent.appendChild(buttonElement);\n\n  this.eventsToUnbind_.push(Blockly.bindEvent_(buttonElement, 'click', this, goog.bind(function () {\n    if (this.onButtonPressed) {\n      this.onButtonPressed();\n    }\n  }, this)));\n\n  this.buttonElement_ = buttonElement;\n};\n\nBlockly.XButton.prototype.dispose = function () {\n  this.eventsToUnbind_.forEach(function(eventHandle) {\n    Blockly.unbindEvent_(eventHandle);\n  });\n  goog.array.clear(this.eventsToUnbind_);\n\n  goog.dom.removeNode(this.buttonElement_);\n};\n","'use strict';\n\ngoog.provide('Blockly.DomainEditor');\n\ngoog.require('goog.dom');\ngoog.require('Blockly.TypeDropdown');\ngoog.require('Blockly.DomainNameInput');\ngoog.require('Blockly.XButton');\n\n/**\n * A DOM-based parameter editor\n * @param {!Object} options\n * @param {string} options.name\n * @param {string} options.paramID unique ID of domain\n * @param {Blockly.BlockValueType} options.type\n * @param {Function} options.onRemovePress\n * @param {Function} options.onTypeChanged takes {Blockly.BlockValueType} newType\n * @param {Function} options.onNameChanged takes {string} uniqueID\n * @param {Object.<String, Blockly.BlockValueType>} options.typeChoices\n * @constructor\n */\nBlockly.DomainEditor = function (options) {\n  this.options = options;\n\n  /**\n   * @private {Element}\n   */\n  this.editorDom_ = null;\n  /**\n   * @private {Blockly.TypeDropdown}\n   */\n  this.typeDropdown_ = null;\n  /**\n   * @private {Blockly.DomainNameInput}\n   */\n  this.nameInput_ = null;\n};\n\n/**\n * Get unique parameter ID of editor\n * @returns {string}\n */\nBlockly.DomainEditor.prototype.getParamID = function () {\n  return this.options.paramID;\n};\n\n/**\n * @param {Element} parent\n */\nBlockly.DomainEditor.prototype.render = function (parent) {\n  var editorDOM = goog.dom.createDom('div');\n\n  var typeDropdown = new Blockly.TypeDropdown({\n    onTypeChanged: this.options.onTypeChanged,\n    typeChoices: this.options.typeChoices,\n    type: this.options.type\n  });\n\n  var nameInput = new Blockly.DomainNameInput({\n    onNameChanged: this.options.onNameChanged,\n    name: this.options.name\n  });\n\n  var xButton = new Blockly.XButton({\n    onButtonPressed: this.options.onRemovePress\n  });\n\n  nameInput.render(editorDOM);\n  typeDropdown.render(editorDOM);\n  xButton.render(editorDOM);\n\n  parent.appendChild(editorDOM);\n\n  // For disposal\n  this.editorDom_ = editorDOM;\n  this.typeDropdown_ = typeDropdown;\n  this.nameInput_ = nameInput;\n};\n\nBlockly.DomainEditor.prototype.dispose = function () {\n  this.nameInput_.dispose();\n  this.typeDropdown_.dispose();\n  goog.dom.removeNode(this.editorDom_);\n};\n","'use strict';\n\ngoog.provide('Blockly.CustomCssClassMenuRenderer');\n\ngoog.require('goog.ui.MenuRenderer');\n\n/**\n * Simple dropdown menu renderer override to include a class on the dropdown menu.\n * @constructor\n */\nBlockly.CustomCssClassMenuRenderer = function (customCssClass) {\n  this.customCssClass_ = customCssClass;\n  Blockly.CustomCssClassMenuRenderer.superClass_.constructor.call(this);\n};\ngoog.inherits(Blockly.CustomCssClassMenuRenderer, goog.ui.MenuRenderer);\ngoog.addSingletonGetter(Blockly.CustomCssClassMenuRenderer);\n\nBlockly.CustomCssClassMenuRenderer.prototype.getCssClass = function () {\n  return goog.ui.MenuRenderer.CSS_CLASS + ' ' + this.customCssClass_;\n};\n","// Copyright 2010 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Enum for button side constants. In its own file so as to not\n * cause a circular dependency with {@link goog.ui.ButtonRenderer}.\n *\n * @author doughtie@google.com (Gavin Doughtie)\n */\n\ngoog.provide('goog.ui.ButtonSide');\n\n\n/**\n * Constants for button sides, see {@link goog.ui.Button.prototype.setCollapsed}\n * for details.\n * @enum {number}\n */\ngoog.ui.ButtonSide = {\n  /** Neither side. */\n  NONE: 0,\n  /** Left for LTR, right for RTL. */\n  START: 1,\n  /** Right for LTR, left for RTL. */\n  END: 2,\n  /** Both sides. */\n  BOTH: 3\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Default renderer for {@link goog.ui.Button}s.\n *\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.ButtonRenderer');\n\ngoog.require('goog.a11y.aria');\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.a11y.aria.State');\ngoog.require('goog.asserts');\ngoog.require('goog.ui.ButtonSide');\ngoog.require('goog.ui.Component');\ngoog.require('goog.ui.ControlRenderer');\n\n\n\n/**\n * Default renderer for {@link goog.ui.Button}s.  Extends the superclass with\n * the following button-specific API methods:\n * <ul>\n *   <li>{@code getValue} - returns the button element's value\n *   <li>{@code setValue} - updates the button element to reflect its new value\n *   <li>{@code getTooltip} - returns the button element's tooltip text\n *   <li>{@code setTooltip} - updates the button element's tooltip text\n *   <li>{@code setCollapsed} - removes one or both of the button element's\n *       borders\n * </ul>\n * For alternate renderers, see {@link goog.ui.NativeButtonRenderer},\n * {@link goog.ui.CustomButtonRenderer}, and {@link goog.ui.FlatButtonRenderer}.\n * @constructor\n * @extends {goog.ui.ControlRenderer}\n */\ngoog.ui.ButtonRenderer = function() {\n  goog.ui.ControlRenderer.call(this);\n};\ngoog.inherits(goog.ui.ButtonRenderer, goog.ui.ControlRenderer);\ngoog.addSingletonGetter(goog.ui.ButtonRenderer);\n\n\n/**\n * Default CSS class to be applied to the root element of components rendered\n * by this renderer.\n * @type {string}\n */\ngoog.ui.ButtonRenderer.CSS_CLASS = goog.getCssName('goog-button');\n\n\n/**\n * Returns the ARIA role to be applied to buttons.\n * @return {goog.a11y.aria.Role|undefined} ARIA role.\n * @override\n */\ngoog.ui.ButtonRenderer.prototype.getAriaRole = function() {\n  return goog.a11y.aria.Role.BUTTON;\n};\n\n\n/**\n * Updates the button's ARIA (accessibility) state if the button is being\n * treated as a checkbox. Also makes sure that attributes which aren't\n * supported by buttons aren't being added.\n * @param {Element} element Element whose ARIA state is to be updated.\n * @param {goog.ui.Component.State} state Component state being enabled or\n *     disabled.\n * @param {boolean} enable Whether the state is being enabled or disabled.\n * @protected\n * @override\n */\ngoog.ui.ButtonRenderer.prototype.updateAriaState = function(\n    element, state, enable) {\n  switch (state) {\n    // If button has CHECKED or SELECTED state, assign aria-pressed\n    case goog.ui.Component.State.SELECTED:\n    case goog.ui.Component.State.CHECKED:\n      goog.asserts.assert(element, 'The button DOM element cannot be null.');\n      goog.a11y.aria.setState(element, goog.a11y.aria.State.PRESSED, enable);\n      break;\n    default:\n    case goog.ui.Component.State.OPENED:\n    case goog.ui.Component.State.DISABLED:\n      goog.ui.ButtonRenderer.base(\n          this, 'updateAriaState', element, state, enable);\n      break;\n  }\n};\n\n\n/** @override */\ngoog.ui.ButtonRenderer.prototype.createDom = function(button) {\n  var element = goog.ui.ButtonRenderer.base(this, 'createDom', button);\n  this.setTooltip(element, button.getTooltip());\n\n  var value = button.getValue();\n  if (value) {\n    this.setValue(element, value);\n  }\n\n  // If this is a toggle button, set ARIA state\n  if (button.isSupportedState(goog.ui.Component.State.CHECKED)) {\n    this.updateAriaState(\n        element, goog.ui.Component.State.CHECKED, button.isChecked());\n  }\n\n  return element;\n};\n\n\n/** @override */\ngoog.ui.ButtonRenderer.prototype.decorate = function(button, element) {\n  // The superclass implementation takes care of common attributes; we only\n  // need to set the value and the tooltip.\n  element =\n      goog.ui.ButtonRenderer.superClass_.decorate.call(this, button, element);\n\n  button.setValueInternal(this.getValue(element));\n  button.setTooltipInternal(this.getTooltip(element));\n\n  // If this is a toggle button, set ARIA state\n  if (button.isSupportedState(goog.ui.Component.State.CHECKED)) {\n    this.updateAriaState(\n        element, goog.ui.Component.State.CHECKED, button.isChecked());\n  }\n\n  return element;\n};\n\n\n/**\n * Takes a button's root element, and returns the value associated with it.\n * No-op in the base class.\n * @param {Element} element The button's root element.\n * @return {string|undefined} The button's value (undefined if none).\n */\ngoog.ui.ButtonRenderer.prototype.getValue = goog.nullFunction;\n\n\n/**\n * Takes a button's root element and a value, and updates the element to reflect\n * the new value.  No-op in the base class.\n * @param {Element} element The button's root element.\n * @param {string} value New value.\n */\ngoog.ui.ButtonRenderer.prototype.setValue = goog.nullFunction;\n\n\n/**\n * Takes a button's root element, and returns its tooltip text.\n * @param {Element} element The button's root element.\n * @return {string|undefined} The tooltip text.\n */\ngoog.ui.ButtonRenderer.prototype.getTooltip = function(element) {\n  return element.title;\n};\n\n\n/**\n * Takes a button's root element and a tooltip string, and updates the element\n * with the new tooltip.\n * @param {Element} element The button's root element.\n * @param {string} tooltip New tooltip text.\n * @protected\n */\ngoog.ui.ButtonRenderer.prototype.setTooltip = function(element, tooltip) {\n  if (element) {\n    // Don't set a title attribute if there isn't a tooltip. Blank title\n    // attributes can be interpreted incorrectly by screen readers.\n    if (tooltip) {\n      element.title = tooltip;\n    } else {\n      element.removeAttribute('title');\n    }\n  }\n};\n\n\n/**\n * Collapses the border on one or both sides of the button, allowing it to be\n * combined with the adjacent button(s), forming a single UI componenet with\n * multiple targets.\n * @param {goog.ui.Button} button Button to update.\n * @param {number} sides Bitmap of one or more {@link goog.ui.ButtonSide}s for\n *     which borders should be collapsed.\n * @protected\n */\ngoog.ui.ButtonRenderer.prototype.setCollapsed = function(button, sides) {\n  var isRtl = button.isRightToLeft();\n  var collapseLeftClassName =\n      goog.getCssName(this.getStructuralCssClass(), 'collapse-left');\n  var collapseRightClassName =\n      goog.getCssName(this.getStructuralCssClass(), 'collapse-right');\n\n  button.enableClassName(\n      isRtl ? collapseRightClassName : collapseLeftClassName,\n      !!(sides & goog.ui.ButtonSide.START));\n  button.enableClassName(\n      isRtl ? collapseLeftClassName : collapseRightClassName,\n      !!(sides & goog.ui.ButtonSide.END));\n};\n\n\n/** @override */\ngoog.ui.ButtonRenderer.prototype.getCssClass = function() {\n  return goog.ui.ButtonRenderer.CSS_CLASS;\n};\n","// Copyright 2015 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Defines the goog.dom.InputType enum.  This enumerates\n * all input element types (for INPUT, BUTTON, SELECT and TEXTAREA\n * elements) in either the the W3C HTML 4.01 index of elements or the\n * HTML5 draft specification.\n *\n * References:\n * http://www.w3.org/TR/html401/sgml/dtd.html#InputType\n * http://www.w3.org/TR/html-markup/input.html#input\n * https://html.spec.whatwg.org/multipage/forms.html#dom-input-type\n * https://html.spec.whatwg.org/multipage/forms.html#dom-button-type\n * https://html.spec.whatwg.org/multipage/forms.html#dom-select-type\n * https://html.spec.whatwg.org/multipage/forms.html#dom-textarea-type\n *\n * @author mpn@google.com (Michal Nazarewicz)\n */\ngoog.provide('goog.dom.InputType');\n\n\n/**\n * Enum of all input types (for INPUT, BUTTON, SELECT and TEXTAREA elements)\n * specified by the W3C HTML4.01 and HTML5 specifications.\n * @enum {string}\n */\ngoog.dom.InputType = {\n  BUTTON: 'button',\n  CHECKBOX: 'checkbox',\n  COLOR: 'color',\n  DATE: 'date',\n  DATETIME: 'datetime',\n  DATETIME_LOCAL: 'datetime-local',\n  EMAIL: 'email',\n  FILE: 'file',\n  HIDDEN: 'hidden',\n  IMAGE: 'image',\n  MENU: 'menu',\n  MONTH: 'month',\n  NUMBER: 'number',\n  PASSWORD: 'password',\n  RADIO: 'radio',\n  RANGE: 'range',\n  RESET: 'reset',\n  SEARCH: 'search',\n  SELECT_MULTIPLE: 'select-multiple',\n  SELECT_ONE: 'select-one',\n  SUBMIT: 'submit',\n  TEL: 'tel',\n  TEXT: 'text',\n  TEXTAREA: 'textarea',\n  TIME: 'time',\n  URL: 'url',\n  WEEK: 'week'\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Native browser button renderer for {@link goog.ui.Button}s.\n *\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.NativeButtonRenderer');\n\ngoog.require('goog.asserts');\ngoog.require('goog.dom.InputType');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.classlist');\ngoog.require('goog.events.EventType');\ngoog.require('goog.ui.ButtonRenderer');\ngoog.require('goog.ui.Component');\n\n\n\n/**\n * Renderer for {@link goog.ui.Button}s.  Renders and decorates native HTML\n * button elements.  Since native HTML buttons have built-in support for many\n * features, overrides many expensive (and redundant) superclass methods to\n * be no-ops.\n * @constructor\n * @extends {goog.ui.ButtonRenderer}\n */\ngoog.ui.NativeButtonRenderer = function() {\n  goog.ui.ButtonRenderer.call(this);\n};\ngoog.inherits(goog.ui.NativeButtonRenderer, goog.ui.ButtonRenderer);\ngoog.addSingletonGetter(goog.ui.NativeButtonRenderer);\n\n\n/** @override */\ngoog.ui.NativeButtonRenderer.prototype.getAriaRole = function() {\n  // Native buttons don't need ARIA roles to be recognized by screen readers.\n  return undefined;\n};\n\n\n/**\n * Returns the button's contents wrapped in a native HTML button element.  Sets\n * the button's disabled attribute as needed.\n * @param {goog.ui.Control} button Button to render.\n * @return {Element} Root element for the button (a native HTML button element).\n * @override\n */\ngoog.ui.NativeButtonRenderer.prototype.createDom = function(button) {\n  this.setUpNativeButton_(button);\n  return button.getDomHelper().createDom(\n      goog.dom.TagName.BUTTON, {\n        'class': this.getClassNames(button).join(' '),\n        'disabled': !button.isEnabled(),\n        'title': button.getTooltip() || '',\n        'value': button.getValue() || ''\n      },\n      button.getCaption() || '');\n};\n\n\n/**\n * Overrides {@link goog.ui.ButtonRenderer#canDecorate} by returning true only\n * if the element is an HTML button.\n * @param {Element} element Element to decorate.\n * @return {boolean} Whether the renderer can decorate the element.\n * @override\n */\ngoog.ui.NativeButtonRenderer.prototype.canDecorate = function(element) {\n  return element.tagName == goog.dom.TagName.BUTTON ||\n      (element.tagName == goog.dom.TagName.INPUT &&\n       (element.type == goog.dom.InputType.BUTTON ||\n        element.type == goog.dom.InputType.SUBMIT ||\n        element.type == goog.dom.InputType.RESET));\n};\n\n\n/** @override */\ngoog.ui.NativeButtonRenderer.prototype.decorate = function(button, element) {\n  this.setUpNativeButton_(button);\n  if (element.disabled) {\n    // Add the marker class for the DISABLED state before letting the superclass\n    // implementation decorate the element, so its state will be correct.\n    var disabledClassName = goog.asserts.assertString(\n        this.getClassForState(goog.ui.Component.State.DISABLED));\n    goog.dom.classlist.add(element, disabledClassName);\n  }\n  return goog.ui.NativeButtonRenderer.superClass_.decorate.call(\n      this, button, element);\n};\n\n\n/**\n * Native buttons natively support BiDi and keyboard focus.\n * @suppress {visibility} getHandler and performActionInternal\n * @override\n */\ngoog.ui.NativeButtonRenderer.prototype.initializeDom = function(button) {\n  // WARNING:  This is a hack, and it is only applicable to native buttons,\n  // which are special because they do natively what most goog.ui.Controls\n  // do programmatically.  Do not use your renderer's initializeDom method\n  // to hook up event handlers!\n  button.getHandler().listen(\n      button.getElement(), goog.events.EventType.CLICK,\n      button.performActionInternal);\n};\n\n\n/**\n * @override\n * Native buttons don't support text selection.\n */\ngoog.ui.NativeButtonRenderer.prototype.setAllowTextSelection =\n    goog.nullFunction;\n\n\n/**\n * @override\n * Native buttons natively support right-to-left rendering.\n */\ngoog.ui.NativeButtonRenderer.prototype.setRightToLeft = goog.nullFunction;\n\n\n/**\n * @override\n * Native buttons are always focusable as long as they are enabled.\n */\ngoog.ui.NativeButtonRenderer.prototype.isFocusable = function(button) {\n  return button.isEnabled();\n};\n\n\n/**\n * @override\n * Native buttons natively support keyboard focus.\n */\ngoog.ui.NativeButtonRenderer.prototype.setFocusable = goog.nullFunction;\n\n\n/**\n * @override\n * Native buttons also expose the DISABLED state in the HTML button's\n * {@code disabled} attribute.\n */\ngoog.ui.NativeButtonRenderer.prototype.setState = function(\n    button, state, enable) {\n  goog.ui.NativeButtonRenderer.superClass_.setState.call(\n      this, button, state, enable);\n  var element = button.getElement();\n  if (element && state == goog.ui.Component.State.DISABLED) {\n    element.disabled = enable;\n  }\n};\n\n\n/**\n * @override\n * Native buttons store their value in the HTML button's {@code value}\n * attribute.\n */\ngoog.ui.NativeButtonRenderer.prototype.getValue = function(element) {\n  // TODO(attila): Make this work on IE!  This never worked...\n  // See http://www.fourmilab.ch/fourmilog/archives/2007-03/000824.html\n  // for a description of the problem.\n  return element.value;\n};\n\n\n/**\n * @override\n * Native buttons also expose their value in the HTML button's {@code value}\n * attribute.\n */\ngoog.ui.NativeButtonRenderer.prototype.setValue = function(element, value) {\n  if (element) {\n    // TODO(attila): Make this work on IE!  This never worked...\n    // See http://www.fourmilab.ch/fourmilog/archives/2007-03/000824.html\n    // for a description of the problem.\n    element.value = value;\n  }\n};\n\n\n/**\n * @override\n * Native buttons don't need ARIA states to support accessibility, so this is\n * a no-op.\n */\ngoog.ui.NativeButtonRenderer.prototype.updateAriaState = goog.nullFunction;\n\n\n/**\n * Sets up the button control such that it doesn't waste time adding\n * functionality that is already natively supported by native browser\n * buttons.\n * @param {goog.ui.Control} button Button control to configure.\n * @private\n */\ngoog.ui.NativeButtonRenderer.prototype.setUpNativeButton_ = function(button) {\n  button.setHandleMouseEvents(false);\n  button.setAutoStates(goog.ui.Component.State.ALL, false);\n  button.setSupportedState(goog.ui.Component.State.FOCUSED, false);\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A button control. This implementation extends {@link\n * goog.ui.Control}.\n *\n * @author attila@google.com (Attila Bodis)\n * @see ../demos/button.html\n */\n\ngoog.provide('goog.ui.Button');\ngoog.provide('goog.ui.Button.Side');\n\ngoog.require('goog.events.EventType');\ngoog.require('goog.events.KeyCodes');\ngoog.require('goog.events.KeyHandler');\ngoog.require('goog.ui.ButtonRenderer');\ngoog.require('goog.ui.ButtonSide');\ngoog.require('goog.ui.Component');\ngoog.require('goog.ui.Control');\ngoog.require('goog.ui.NativeButtonRenderer');\ngoog.require('goog.ui.registry');\n\n\n\n/**\n * A button control, rendered as a native browser button by default.\n *\n * @param {goog.ui.ControlContent=} opt_content Text caption or existing DOM\n *     structure to display as the button's caption (if any).\n * @param {goog.ui.ButtonRenderer=} opt_renderer Renderer used to render or\n *     decorate the button; defaults to {@link goog.ui.NativeButtonRenderer}.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper, used for\n *     document interaction.\n * @constructor\n * @extends {goog.ui.Control}\n */\ngoog.ui.Button = function(opt_content, opt_renderer, opt_domHelper) {\n  goog.ui.Control.call(\n      this, opt_content,\n      opt_renderer || goog.ui.NativeButtonRenderer.getInstance(),\n      opt_domHelper);\n};\ngoog.inherits(goog.ui.Button, goog.ui.Control);\ngoog.tagUnsealableClass(goog.ui.Button);\n\n\n/**\n * Constants for button sides, see {@link goog.ui.Button.prototype.setCollapsed}\n * for details. Aliased from goog.ui.ButtonSide to support legacy users without\n * creating a circular dependency in {@link goog.ui.ButtonRenderer}.\n * @enum {number}\n * @deprecated use {@link goog.ui.ButtonSide} instead.\n */\ngoog.ui.Button.Side = goog.ui.ButtonSide;\n\n\n/**\n * Value associated with the button.\n * @type {*}\n * @private\n */\ngoog.ui.Button.prototype.value_;\n\n\n/**\n * Tooltip text for the button, displayed on hover.\n * @type {string|undefined}\n * @private\n */\ngoog.ui.Button.prototype.tooltip_;\n\n\n// goog.ui.Button API implementation.\n\n\n/**\n * Returns the value associated with the button.\n * @return {*} Button value (undefined if none).\n */\ngoog.ui.Button.prototype.getValue = function() {\n  return this.value_;\n};\n\n\n/**\n * Sets the value associated with the button, and updates its DOM.\n * @param {*} value New button value.\n */\ngoog.ui.Button.prototype.setValue = function(value) {\n  this.value_ = value;\n  var renderer = /** @type {!goog.ui.ButtonRenderer} */ (this.getRenderer());\n  renderer.setValue(this.getElement(), /** @type {string} */ (value));\n};\n\n\n/**\n * Sets the value associated with the button.  Unlike {@link #setValue},\n * doesn't update the button's DOM.  Considered protected; to be called only\n * by renderer code during element decoration.\n * @param {*} value New button value.\n * @protected\n */\ngoog.ui.Button.prototype.setValueInternal = function(value) {\n  this.value_ = value;\n};\n\n\n/**\n * Returns the tooltip for the button.\n * @return {string|undefined} Tooltip text (undefined if none).\n */\ngoog.ui.Button.prototype.getTooltip = function() {\n  return this.tooltip_;\n};\n\n\n/**\n * Sets the tooltip for the button, and updates its DOM.\n * @param {string} tooltip New tooltip text.\n */\ngoog.ui.Button.prototype.setTooltip = function(tooltip) {\n  this.tooltip_ = tooltip;\n  this.getRenderer().setTooltip(this.getElement(), tooltip);\n};\n\n\n/**\n * Sets the tooltip for the button.  Unlike {@link #setTooltip}, doesn't update\n * the button's DOM.  Considered protected; to be called only by renderer code\n * during element decoration.\n * @param {string} tooltip New tooltip text.\n * @protected\n */\ngoog.ui.Button.prototype.setTooltipInternal = function(tooltip) {\n  this.tooltip_ = tooltip;\n};\n\n\n/**\n * Collapses the border on one or both sides of the button, allowing it to be\n * combined with the adjancent button(s), forming a single UI componenet with\n * multiple targets.\n * @param {number} sides Bitmap of one or more {@link goog.ui.ButtonSide}s for\n *     which borders should be collapsed.\n */\ngoog.ui.Button.prototype.setCollapsed = function(sides) {\n  this.getRenderer().setCollapsed(this, sides);\n};\n\n\n// goog.ui.Control & goog.ui.Component API implementation.\n\n\n/** @override */\ngoog.ui.Button.prototype.disposeInternal = function() {\n  goog.ui.Button.superClass_.disposeInternal.call(this);\n  delete this.value_;\n  delete this.tooltip_;\n};\n\n\n/** @override */\ngoog.ui.Button.prototype.enterDocument = function() {\n  goog.ui.Button.superClass_.enterDocument.call(this);\n  if (this.isSupportedState(goog.ui.Component.State.FOCUSED)) {\n    var keyTarget = this.getKeyEventTarget();\n    if (keyTarget) {\n      this.getHandler().listen(\n          keyTarget, goog.events.EventType.KEYUP, this.handleKeyEventInternal);\n    }\n  }\n};\n\n\n/**\n * Attempts to handle a keyboard event; returns true if the event was handled,\n * false otherwise.  If the button is enabled and the Enter/Space key was\n * pressed, handles the event by dispatching an {@code ACTION} event,\n * and returns true. Overrides {@link goog.ui.Control#handleKeyEventInternal}.\n * @param {goog.events.KeyEvent} e Key event to handle.\n * @return {boolean} Whether the key event was handled.\n * @protected\n * @override\n */\ngoog.ui.Button.prototype.handleKeyEventInternal = function(e) {\n  if (e.keyCode == goog.events.KeyCodes.ENTER &&\n          e.type == goog.events.KeyHandler.EventType.KEY ||\n      e.keyCode == goog.events.KeyCodes.SPACE &&\n          e.type == goog.events.EventType.KEYUP) {\n    return this.performActionInternal(e);\n  }\n  // Return true for space keypress (even though the event is handled on keyup)\n  // as preventDefault needs to be called up keypress to take effect in IE and\n  // WebKit.\n  return e.keyCode == goog.events.KeyCodes.SPACE;\n};\n\n\n// Register a decorator factory function for goog.ui.Buttons.\ngoog.ui.registry.setDecoratorByClassName(\n    goog.ui.ButtonRenderer.CSS_CLASS,\n    function() { return new goog.ui.Button(null); });\n","// Copyright 2009 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Common CSS class name constants.\n *\n * @author mkretzschmar@google.com (Martin Kretzschmar)\n */\n\ngoog.provide('goog.ui.INLINE_BLOCK_CLASSNAME');\n\n\n/**\n * CSS class name for applying the \"display: inline-block\" property in a\n * cross-browser way.\n * @type {string}\n */\ngoog.ui.INLINE_BLOCK_CLASSNAME = goog.getCssName('goog-inline-block');\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Similar functionality of {@link goog.ui.ButtonRenderer},\n * but uses a <div> element instead of a <button> or <input> element.\n *\n */\n\ngoog.provide('goog.ui.FlatButtonRenderer');\n\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.asserts');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.classlist');\ngoog.require('goog.ui.Button');\ngoog.require('goog.ui.ButtonRenderer');\ngoog.require('goog.ui.INLINE_BLOCK_CLASSNAME');\ngoog.require('goog.ui.registry');\n\n\n\n/**\n * Flat renderer for {@link goog.ui.Button}s.  Flat buttons can contain\n * almost arbitrary HTML content, will flow like inline elements, but can be\n * styled like block-level elements.\n * @constructor\n * @extends {goog.ui.ButtonRenderer}\n */\ngoog.ui.FlatButtonRenderer = function() {\n  goog.ui.ButtonRenderer.call(this);\n};\ngoog.inherits(goog.ui.FlatButtonRenderer, goog.ui.ButtonRenderer);\ngoog.addSingletonGetter(goog.ui.FlatButtonRenderer);\n\n\n/**\n * Default CSS class to be applied to the root element of components rendered\n * by this renderer.\n * @type {string}\n */\ngoog.ui.FlatButtonRenderer.CSS_CLASS = goog.getCssName('goog-flat-button');\n\n\n/**\n * Returns the control's contents wrapped in a div element, with\n * the renderer's own CSS class and additional state-specific classes applied\n * to it, and the button's disabled attribute set or cleared as needed.\n * Overrides {@link goog.ui.ButtonRenderer#createDom}.\n * @param {goog.ui.Control} button Button to render.\n * @return {!Element} Root element for the button.\n * @override\n */\ngoog.ui.FlatButtonRenderer.prototype.createDom = function(button) {\n  var classNames = this.getClassNames(button);\n  var attributes = {\n    'class': goog.ui.INLINE_BLOCK_CLASSNAME + ' ' + classNames.join(' ')\n  };\n  var element = button.getDomHelper().createDom(\n      goog.dom.TagName.DIV, attributes, button.getContent());\n  this.setTooltip(element, button.getTooltip());\n  return element;\n};\n\n\n/**\n * Returns the ARIA role to be applied to flat buttons.\n * @return {goog.a11y.aria.Role|undefined} ARIA role.\n * @override\n */\ngoog.ui.FlatButtonRenderer.prototype.getAriaRole = function() {\n  return goog.a11y.aria.Role.BUTTON;\n};\n\n\n/**\n * Returns true if this renderer can decorate the element.  Overrides\n * {@link goog.ui.ButtonRenderer#canDecorate} by returning true if the\n * element is a DIV, false otherwise.\n * @param {Element} element Element to decorate.\n * @return {boolean} Whether the renderer can decorate the element.\n * @override\n */\ngoog.ui.FlatButtonRenderer.prototype.canDecorate = function(element) {\n  return element.tagName == goog.dom.TagName.DIV;\n};\n\n\n/**\n * Takes an existing element and decorates it with the flat button control.\n * Initializes the control's ID, content, tooltip, value, and state based\n * on the ID of the element, its child nodes, and its CSS classes, respectively.\n * Returns the element.  Overrides {@link goog.ui.ButtonRenderer#decorate}.\n * @param {goog.ui.Control} button Button instance to decorate the element.\n * @param {Element} element Element to decorate.\n * @return {Element} Decorated element.\n * @override\n */\ngoog.ui.FlatButtonRenderer.prototype.decorate = function(button, element) {\n  goog.asserts.assert(element);\n  goog.dom.classlist.add(element, goog.ui.INLINE_BLOCK_CLASSNAME);\n  return goog.ui.FlatButtonRenderer.superClass_.decorate.call(\n      this, button, element);\n};\n\n\n/**\n * Flat buttons can't use the value attribute since they are div elements.\n * Overrides {@link goog.ui.ButtonRenderer#getValue} to prevent trying to\n * access the element's value.\n * @param {Element} element The button control's root element.\n * @return {string} Value not valid for flat buttons.\n * @override\n */\ngoog.ui.FlatButtonRenderer.prototype.getValue = function(element) {\n  // Flat buttons don't store their value in the DOM.\n  return '';\n};\n\n\n/**\n * Returns the CSS class to be applied to the root element of components\n * rendered using this renderer.\n * @return {string} Renderer-specific CSS class.\n * @override\n */\ngoog.ui.FlatButtonRenderer.prototype.getCssClass = function() {\n  return goog.ui.FlatButtonRenderer.CSS_CLASS;\n};\n\n\n// Register a decorator factory function for Flat Buttons.\ngoog.ui.registry.setDecoratorByClassName(\n    goog.ui.FlatButtonRenderer.CSS_CLASS, function() {\n      // Uses goog.ui.Button, but with FlatButtonRenderer.\n      return new goog.ui.Button(null, goog.ui.FlatButtonRenderer.getInstance());\n    });\n","// Copyright 2012 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Bidi utility functions.\n *\n */\n\ngoog.provide('goog.style.bidi');\n\ngoog.require('goog.dom');\ngoog.require('goog.style');\ngoog.require('goog.userAgent');\n\n\n/**\n * Returns the normalized scrollLeft position for a scrolled element.\n * @param {Element} element The scrolled element.\n * @return {number} The number of pixels the element is scrolled. 0 indicates\n *     that the element is not scrolled at all (which, in general, is the\n *     left-most position in ltr and the right-most position in rtl).\n */\ngoog.style.bidi.getScrollLeft = function(element) {\n  var isRtl = goog.style.isRightToLeft(element);\n  if (isRtl && goog.userAgent.GECKO) {\n    // ScrollLeft starts at 0 and then goes negative as the element is scrolled\n    // towards the left.\n    return -element.scrollLeft;\n  } else if (\n      isRtl &&\n      !(goog.userAgent.EDGE_OR_IE && goog.userAgent.isVersionOrHigher('8'))) {\n    // ScrollLeft starts at the maximum positive value and decreases towards\n    // 0 as the element is scrolled towards the left. However, for overflow\n    // visible, there is no scrollLeft and the value always stays correctly at 0\n    var overflowX = goog.style.getComputedOverflowX(element);\n    if (overflowX == 'visible') {\n      return element.scrollLeft;\n    } else {\n      return element.scrollWidth - element.clientWidth - element.scrollLeft;\n    }\n  }\n  // ScrollLeft behavior is identical in rtl and ltr, it starts at 0 and\n  // increases as the element is scrolled away from the start.\n  return element.scrollLeft;\n};\n\n\n/**\n * Returns the \"offsetStart\" of an element, analogous to offsetLeft but\n * normalized for right-to-left environments and various browser\n * inconsistencies. This value returned can always be passed to setScrollOffset\n * to scroll to an element's left edge in a left-to-right offsetParent or\n * right edge in a right-to-left offsetParent.\n *\n * For example, here offsetStart is 10px in an LTR environment and 5px in RTL:\n *\n * <pre>\n * |          xxxxxxxxxx     |\n *  ^^^^^^^^^^   ^^^^   ^^^^^\n *     10px      elem    5px\n * </pre>\n *\n * If an element is positioned before the start of its offsetParent, the\n * startOffset may be negative.  This can be used with setScrollOffset to\n * reliably scroll to an element:\n *\n * <pre>\n * var scrollOffset = goog.style.bidi.getOffsetStart(element);\n * goog.style.bidi.setScrollOffset(element.offsetParent, scrollOffset);\n * </pre>\n *\n * @see setScrollOffset\n *\n * @param {Element} element The element for which we need to determine the\n *     offsetStart position.\n * @return {number} The offsetStart for that element.\n */\ngoog.style.bidi.getOffsetStart = function(element) {\n  element = /** @type {!HTMLElement} */ (element);\n  var offsetLeftForReal = element.offsetLeft;\n\n  // The element might not have an offsetParent.\n  // For example, the node might not be attached to the DOM tree,\n  // and position:fixed children do not have an offset parent.\n  // Just try to do the best we can with what we have.\n  var bestParent = element.offsetParent;\n\n  if (!bestParent && goog.style.getComputedPosition(element) == 'fixed') {\n    bestParent = goog.dom.getOwnerDocument(element).documentElement;\n  }\n\n  // Just give up in this case.\n  if (!bestParent) {\n    return offsetLeftForReal;\n  }\n\n  if (goog.userAgent.GECKO) {\n    // When calculating an element's offsetLeft, Firefox erroneously subtracts\n    // the border width from the actual distance.  So we need to add it back.\n    var borderWidths = goog.style.getBorderBox(bestParent);\n    offsetLeftForReal += borderWidths.left;\n  } else if (\n      goog.userAgent.isDocumentModeOrHigher(8) &&\n      !goog.userAgent.isDocumentModeOrHigher(9)) {\n    // When calculating an element's offsetLeft, IE8/9-Standards Mode\n    // erroneously adds the border width to the actual distance.  So we need to\n    // subtract it.\n    var borderWidths = goog.style.getBorderBox(bestParent);\n    offsetLeftForReal -= borderWidths.left;\n  }\n\n  if (goog.style.isRightToLeft(bestParent)) {\n    // Right edge of the element relative to the left edge of its parent.\n    var elementRightOffset = offsetLeftForReal + element.offsetWidth;\n\n    // Distance from the parent's right edge to the element's right edge.\n    return bestParent.clientWidth - elementRightOffset;\n  }\n\n  return offsetLeftForReal;\n};\n\n\n/**\n * Sets the element's scrollLeft attribute so it is correctly scrolled by\n * offsetStart pixels.  This takes into account whether the element is RTL and\n * the nuances of different browsers.  To scroll to the \"beginning\" of an\n * element use getOffsetStart to obtain the element's offsetStart value and then\n * pass the value to setScrollOffset.\n * @see getOffsetStart\n * @param {Element} element The element to set scrollLeft on.\n * @param {number} offsetStart The number of pixels to scroll the element.\n *     If this value is < 0, 0 is used.\n */\ngoog.style.bidi.setScrollOffset = function(element, offsetStart) {\n  offsetStart = Math.max(offsetStart, 0);\n  // In LTR and in \"mirrored\" browser RTL (such as IE), we set scrollLeft to\n  // the number of pixels to scroll.\n  // Otherwise, in RTL, we need to account for different browser behavior.\n  if (!goog.style.isRightToLeft(element)) {\n    element.scrollLeft = offsetStart;\n  } else if (goog.userAgent.GECKO) {\n    // Negative scroll-left positions in RTL.\n    element.scrollLeft = -offsetStart;\n  } else if (\n      !(goog.userAgent.EDGE_OR_IE && goog.userAgent.isVersionOrHigher('8'))) {\n    // Take the current scrollLeft value and move to the right by the\n    // offsetStart to get to the left edge of the element, and then by\n    // the clientWidth of the element to get to the right edge.\n    element.scrollLeft =\n        element.scrollWidth - offsetStart - element.clientWidth;\n  } else {\n    element.scrollLeft = offsetStart;\n  }\n};\n\n\n/**\n * Sets the element's left style attribute in LTR or right style attribute in\n * RTL.  Also clears the left attribute in RTL and the right attribute in LTR.\n * @param {Element} elem The element to position.\n * @param {number} left The left position in LTR; will be set as right in RTL.\n * @param {?number} top The top position.  If null only the left/right is set.\n * @param {boolean} isRtl Whether we are in RTL mode.\n */\ngoog.style.bidi.setPosition = function(elem, left, top, isRtl) {\n  if (!goog.isNull(top)) {\n    elem.style.top = top + 'px';\n  }\n  if (isRtl) {\n    elem.style.right = left + 'px';\n    elem.style.left = '';\n  } else {\n    elem.style.left = left + 'px';\n    elem.style.right = '';\n  }\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Common positioning code.\n *\n * @author eae@google.com (Emil A Eklund)\n */\n\ngoog.provide('goog.positioning');\ngoog.provide('goog.positioning.Corner');\ngoog.provide('goog.positioning.CornerBit');\ngoog.provide('goog.positioning.Overflow');\ngoog.provide('goog.positioning.OverflowStatus');\n\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.math.Coordinate');\ngoog.require('goog.math.Rect');\ngoog.require('goog.math.Size');\ngoog.require('goog.style');\ngoog.require('goog.style.bidi');\n\n\n/**\n * Enum for bits in the {@see goog.positioning.Corner) bitmap.\n *\n * @enum {number}\n */\ngoog.positioning.CornerBit = {\n  BOTTOM: 1,\n  CENTER: 2,\n  RIGHT: 4,\n  FLIP_RTL: 8\n};\n\n\n/**\n * Enum for representing an element corner for positioning the popup.\n *\n * The START constants map to LEFT if element directionality is left\n * to right and RIGHT if the directionality is right to left.\n * Likewise END maps to RIGHT or LEFT depending on the directionality.\n *\n * @enum {number}\n */\ngoog.positioning.Corner = {\n  TOP_LEFT: 0,\n  TOP_RIGHT: goog.positioning.CornerBit.RIGHT,\n  BOTTOM_LEFT: goog.positioning.CornerBit.BOTTOM,\n  BOTTOM_RIGHT:\n      goog.positioning.CornerBit.BOTTOM | goog.positioning.CornerBit.RIGHT,\n  TOP_START: goog.positioning.CornerBit.FLIP_RTL,\n  TOP_END:\n      goog.positioning.CornerBit.FLIP_RTL | goog.positioning.CornerBit.RIGHT,\n  BOTTOM_START:\n      goog.positioning.CornerBit.BOTTOM | goog.positioning.CornerBit.FLIP_RTL,\n  BOTTOM_END: goog.positioning.CornerBit.BOTTOM |\n      goog.positioning.CornerBit.RIGHT | goog.positioning.CornerBit.FLIP_RTL,\n  TOP_CENTER: goog.positioning.CornerBit.CENTER,\n  BOTTOM_CENTER:\n      goog.positioning.CornerBit.BOTTOM | goog.positioning.CornerBit.CENTER\n};\n\n\n/**\n * Enum for representing position handling in cases where the element would be\n * positioned outside the viewport.\n *\n * @enum {number}\n */\ngoog.positioning.Overflow = {\n  /** Ignore overflow */\n  IGNORE: 0,\n\n  /** Try to fit horizontally in the viewport at all costs. */\n  ADJUST_X: 1,\n\n  /** If the element can't fit horizontally, report positioning failure. */\n  FAIL_X: 2,\n\n  /** Try to fit vertically in the viewport at all costs. */\n  ADJUST_Y: 4,\n\n  /** If the element can't fit vertically, report positioning failure. */\n  FAIL_Y: 8,\n\n  /** Resize the element's width to fit in the viewport. */\n  RESIZE_WIDTH: 16,\n\n  /** Resize the element's height to fit in the viewport. */\n  RESIZE_HEIGHT: 32,\n\n  /**\n   * If the anchor goes off-screen in the x-direction, position the movable\n   * element off-screen. Otherwise, try to fit horizontally in the viewport.\n   */\n  ADJUST_X_EXCEPT_OFFSCREEN: 64 | 1,\n\n  /**\n   * If the anchor goes off-screen in the y-direction, position the movable\n   * element off-screen. Otherwise, try to fit vertically in the viewport.\n   */\n  ADJUST_Y_EXCEPT_OFFSCREEN: 128 | 4\n};\n\n\n/**\n * Enum for representing the outcome of a positioning call.\n *\n * @enum {number}\n */\ngoog.positioning.OverflowStatus = {\n  NONE: 0,\n  ADJUSTED_X: 1,\n  ADJUSTED_Y: 2,\n  WIDTH_ADJUSTED: 4,\n  HEIGHT_ADJUSTED: 8,\n  FAILED_LEFT: 16,\n  FAILED_RIGHT: 32,\n  FAILED_TOP: 64,\n  FAILED_BOTTOM: 128,\n  FAILED_OUTSIDE_VIEWPORT: 256\n};\n\n\n/**\n * Shorthand to check if a status code contains any fail code.\n * @type {number}\n */\ngoog.positioning.OverflowStatus.FAILED =\n    goog.positioning.OverflowStatus.FAILED_LEFT |\n    goog.positioning.OverflowStatus.FAILED_RIGHT |\n    goog.positioning.OverflowStatus.FAILED_TOP |\n    goog.positioning.OverflowStatus.FAILED_BOTTOM |\n    goog.positioning.OverflowStatus.FAILED_OUTSIDE_VIEWPORT;\n\n\n/**\n * Shorthand to check if horizontal positioning failed.\n * @type {number}\n */\ngoog.positioning.OverflowStatus.FAILED_HORIZONTAL =\n    goog.positioning.OverflowStatus.FAILED_LEFT |\n    goog.positioning.OverflowStatus.FAILED_RIGHT;\n\n\n/**\n * Shorthand to check if vertical positioning failed.\n * @type {number}\n */\ngoog.positioning.OverflowStatus.FAILED_VERTICAL =\n    goog.positioning.OverflowStatus.FAILED_TOP |\n    goog.positioning.OverflowStatus.FAILED_BOTTOM;\n\n\n/**\n * Positions a movable element relative to an anchor element. The caller\n * specifies the corners that should touch. This functions then moves the\n * movable element accordingly.\n *\n * @param {Element} anchorElement The element that is the anchor for where\n *    the movable element should position itself.\n * @param {goog.positioning.Corner} anchorElementCorner The corner of the\n *     anchorElement for positioning the movable element.\n * @param {Element} movableElement The element to move.\n * @param {goog.positioning.Corner} movableElementCorner The corner of the\n *     movableElement that that should be positioned adjacent to the anchor\n *     element.\n * @param {goog.math.Coordinate=} opt_offset An offset specified in pixels.\n *    After the normal positioning algorithm is applied, the offset is then\n *    applied. Positive coordinates move the popup closer to the center of the\n *    anchor element. Negative coordinates move the popup away from the center\n *    of the anchor element.\n * @param {goog.math.Box=} opt_margin A margin specified in pixels.\n *    After the normal positioning algorithm is applied and any offset, the\n *    margin is then applied. Positive coordinates move the popup away from the\n *    spot it was positioned towards its center. Negative coordinates move it\n *    towards the spot it was positioned away from its center.\n * @param {?number=} opt_overflow Overflow handling mode. Defaults to IGNORE if\n *     not specified. Bitmap, {@see goog.positioning.Overflow}.\n * @param {goog.math.Size=} opt_preferredSize The preferred size of the\n *     movableElement.\n * @param {goog.math.Box=} opt_viewport Box object describing the dimensions of\n *     the viewport. The viewport is specified relative to offsetParent of\n *     {@code movableElement}. In other words, the viewport can be thought of as\n *     describing a \"position: absolute\" element contained in the offsetParent.\n *     It defaults to visible area of nearest scrollable ancestor of\n *     {@code movableElement} (see {@code goog.style.getVisibleRectForElement}).\n * @return {goog.positioning.OverflowStatus} Status bitmap,\n *     {@see goog.positioning.OverflowStatus}.\n */\ngoog.positioning.positionAtAnchor = function(\n    anchorElement, anchorElementCorner, movableElement, movableElementCorner,\n    opt_offset, opt_margin, opt_overflow, opt_preferredSize, opt_viewport) {\n\n  goog.asserts.assert(movableElement);\n  var movableParentTopLeft =\n      goog.positioning.getOffsetParentPageOffset(movableElement);\n\n  // Get the visible part of the anchor element.  anchorRect is\n  // relative to anchorElement's page.\n  var anchorRect = goog.positioning.getVisiblePart_(anchorElement);\n\n  // Translate anchorRect to be relative to movableElement's page.\n  goog.style.translateRectForAnotherFrame(\n      anchorRect, goog.dom.getDomHelper(anchorElement),\n      goog.dom.getDomHelper(movableElement));\n\n  // Offset based on which corner of the element we want to position against.\n  var corner =\n      goog.positioning.getEffectiveCorner(anchorElement, anchorElementCorner);\n  var offsetLeft = anchorRect.left;\n  if (corner & goog.positioning.CornerBit.RIGHT) {\n    offsetLeft += anchorRect.width;\n  } else if (corner & goog.positioning.CornerBit.CENTER) {\n    offsetLeft += anchorRect.width / 2;\n  }\n\n  // absolutePos is a candidate position relative to the\n  // movableElement's window.\n  var absolutePos = new goog.math.Coordinate(\n      offsetLeft, anchorRect.top +\n          (corner & goog.positioning.CornerBit.BOTTOM ? anchorRect.height : 0));\n\n  // Translate absolutePos to be relative to the offsetParent.\n  absolutePos =\n      goog.math.Coordinate.difference(absolutePos, movableParentTopLeft);\n\n  // Apply offset, if specified\n  if (opt_offset) {\n    absolutePos.x +=\n        (corner & goog.positioning.CornerBit.RIGHT ? -1 : 1) * opt_offset.x;\n    absolutePos.y +=\n        (corner & goog.positioning.CornerBit.BOTTOM ? -1 : 1) * opt_offset.y;\n  }\n\n  // Determine dimension of viewport.\n  var viewport;\n  if (opt_overflow) {\n    if (opt_viewport) {\n      viewport = opt_viewport;\n    } else {\n      viewport = goog.style.getVisibleRectForElement(movableElement);\n      if (viewport) {\n        viewport.top -= movableParentTopLeft.y;\n        viewport.right -= movableParentTopLeft.x;\n        viewport.bottom -= movableParentTopLeft.y;\n        viewport.left -= movableParentTopLeft.x;\n      }\n    }\n  }\n\n  return goog.positioning.positionAtCoordinate(\n      absolutePos, movableElement, movableElementCorner, opt_margin, viewport,\n      opt_overflow, opt_preferredSize);\n};\n\n\n/**\n * Calculates the page offset of the given element's\n * offsetParent. This value can be used to translate any x- and\n * y-offset relative to the page to an offset relative to the\n * offsetParent, which can then be used directly with as position\n * coordinate for {@code positionWithCoordinate}.\n * @param {!Element} movableElement The element to calculate.\n * @return {!goog.math.Coordinate} The page offset, may be (0, 0).\n */\ngoog.positioning.getOffsetParentPageOffset = function(movableElement) {\n  // Ignore offset for the BODY element unless its position is non-static.\n  // For cases where the offset parent is HTML rather than the BODY (such as in\n  // IE strict mode) there's no need to get the position of the BODY as it\n  // doesn't affect the page offset.\n  var movableParentTopLeft;\n  var parent = /** @type {?} */ (movableElement).offsetParent;\n  if (parent) {\n    var isBody = parent.tagName == goog.dom.TagName.HTML ||\n        parent.tagName == goog.dom.TagName.BODY;\n    if (!isBody || goog.style.getComputedPosition(parent) != 'static') {\n      // Get the top-left corner of the parent, in page coordinates.\n      movableParentTopLeft = goog.style.getPageOffset(parent);\n\n      if (!isBody) {\n        movableParentTopLeft = goog.math.Coordinate.difference(\n            movableParentTopLeft,\n            new goog.math.Coordinate(\n                goog.style.bidi.getScrollLeft(parent), parent.scrollTop));\n      }\n    }\n  }\n\n  return movableParentTopLeft || new goog.math.Coordinate();\n};\n\n\n/**\n * Returns intersection of the specified element and\n * goog.style.getVisibleRectForElement for it.\n *\n * @param {Element} el The target element.\n * @return {!goog.math.Rect} Intersection of getVisibleRectForElement\n *     and the current bounding rectangle of the element.  If the\n *     intersection is empty, returns the bounding rectangle.\n * @private\n */\ngoog.positioning.getVisiblePart_ = function(el) {\n  var rect = goog.style.getBounds(el);\n  var visibleBox = goog.style.getVisibleRectForElement(el);\n  if (visibleBox) {\n    rect.intersection(goog.math.Rect.createFromBox(visibleBox));\n  }\n  return rect;\n};\n\n\n/**\n * Positions the specified corner of the movable element at the\n * specified coordinate.\n *\n * @param {goog.math.Coordinate} absolutePos The coordinate to position the\n *     element at.\n * @param {Element} movableElement The element to be positioned.\n * @param {goog.positioning.Corner} movableElementCorner The corner of the\n *     movableElement that that should be positioned.\n * @param {goog.math.Box=} opt_margin A margin specified in pixels.\n *    After the normal positioning algorithm is applied and any offset, the\n *    margin is then applied. Positive coordinates move the popup away from the\n *    spot it was positioned towards its center. Negative coordinates move it\n *    towards the spot it was positioned away from its center.\n * @param {goog.math.Box=} opt_viewport Box object describing the dimensions of\n *     the viewport. Required if opt_overflow is specified.\n * @param {?number=} opt_overflow Overflow handling mode. Defaults to IGNORE if\n *     not specified, {@see goog.positioning.Overflow}.\n * @param {goog.math.Size=} opt_preferredSize The preferred size of the\n *     movableElement. Defaults to the current size.\n * @return {goog.positioning.OverflowStatus} Status bitmap.\n */\ngoog.positioning.positionAtCoordinate = function(\n    absolutePos, movableElement, movableElementCorner, opt_margin, opt_viewport,\n    opt_overflow, opt_preferredSize) {\n  absolutePos = absolutePos.clone();\n\n  // Offset based on attached corner and desired margin.\n  var corner =\n      goog.positioning.getEffectiveCorner(movableElement, movableElementCorner);\n  var elementSize = goog.style.getSize(movableElement);\n  var size =\n      opt_preferredSize ? opt_preferredSize.clone() : elementSize.clone();\n\n  var positionResult = goog.positioning.getPositionAtCoordinate(\n      absolutePos, size, corner, opt_margin, opt_viewport, opt_overflow);\n\n  if (positionResult.status & goog.positioning.OverflowStatus.FAILED) {\n    return positionResult.status;\n  }\n\n  goog.style.setPosition(movableElement, positionResult.rect.getTopLeft());\n  size = positionResult.rect.getSize();\n  if (!goog.math.Size.equals(elementSize, size)) {\n    goog.style.setBorderBoxSize(movableElement, size);\n  }\n\n  return positionResult.status;\n};\n\n\n/**\n * Computes the position for an element to be placed on-screen at the\n * specified coordinates. Returns an object containing both the resulting\n * rectangle, and the overflow status bitmap.\n *\n * @param {!goog.math.Coordinate} absolutePos The coordinate to position the\n *     element at.\n * @param {!goog.math.Size} elementSize The size of the element to be\n *     positioned.\n * @param {goog.positioning.Corner} elementCorner The corner of the\n *     movableElement that that should be positioned.\n * @param {goog.math.Box=} opt_margin A margin specified in pixels.\n *    After the normal positioning algorithm is applied and any offset, the\n *    margin is then applied. Positive coordinates move the popup away from the\n *    spot it was positioned towards its center. Negative coordinates move it\n *    towards the spot it was positioned away from its center.\n * @param {goog.math.Box=} opt_viewport Box object describing the dimensions of\n *     the viewport. Required if opt_overflow is specified.\n * @param {?number=} opt_overflow Overflow handling mode. Defaults to IGNORE\n *     if not specified, {@see goog.positioning.Overflow}.\n * @return {{rect:!goog.math.Rect, status:goog.positioning.OverflowStatus}}\n *     Object containing the computed position and status bitmap.\n */\ngoog.positioning.getPositionAtCoordinate = function(\n    absolutePos, elementSize, elementCorner, opt_margin, opt_viewport,\n    opt_overflow) {\n  absolutePos = absolutePos.clone();\n  elementSize = elementSize.clone();\n  var status = goog.positioning.OverflowStatus.NONE;\n\n  if (opt_margin || elementCorner != goog.positioning.Corner.TOP_LEFT) {\n    if (elementCorner & goog.positioning.CornerBit.RIGHT) {\n      absolutePos.x -= elementSize.width + (opt_margin ? opt_margin.right : 0);\n    } else if (elementCorner & goog.positioning.CornerBit.CENTER) {\n      absolutePos.x -= elementSize.width / 2;\n    } else if (opt_margin) {\n      absolutePos.x += opt_margin.left;\n    }\n    if (elementCorner & goog.positioning.CornerBit.BOTTOM) {\n      absolutePos.y -=\n          elementSize.height + (opt_margin ? opt_margin.bottom : 0);\n    } else if (opt_margin) {\n      absolutePos.y += opt_margin.top;\n    }\n  }\n\n  // Adjust position to fit inside viewport.\n  if (opt_overflow) {\n    status = opt_viewport ?\n        goog.positioning.adjustForViewport_(\n            absolutePos, elementSize, opt_viewport, opt_overflow) :\n        goog.positioning.OverflowStatus.FAILED_OUTSIDE_VIEWPORT;\n  }\n\n  var rect = new goog.math.Rect(0, 0, 0, 0);\n  rect.left = absolutePos.x;\n  rect.top = absolutePos.y;\n  rect.width = elementSize.width;\n  rect.height = elementSize.height;\n  return {rect: rect, status: status};\n};\n\n\n/**\n * Adjusts the position and/or size of an element, identified by its position\n * and size, to fit inside the viewport. If the position or size of the element\n * is adjusted the pos or size objects, respectively, are modified.\n *\n * @param {goog.math.Coordinate} pos Position of element, updated if the\n *     position is adjusted.\n * @param {goog.math.Size} size Size of element, updated if the size is\n *     adjusted.\n * @param {goog.math.Box} viewport Bounding box describing the viewport.\n * @param {number} overflow Overflow handling mode,\n *     {@see goog.positioning.Overflow}.\n * @return {goog.positioning.OverflowStatus} Status bitmap,\n *     {@see goog.positioning.OverflowStatus}.\n * @private\n */\ngoog.positioning.adjustForViewport_ = function(pos, size, viewport, overflow) {\n  var status = goog.positioning.OverflowStatus.NONE;\n\n  var ADJUST_X_EXCEPT_OFFSCREEN =\n      goog.positioning.Overflow.ADJUST_X_EXCEPT_OFFSCREEN;\n  var ADJUST_Y_EXCEPT_OFFSCREEN =\n      goog.positioning.Overflow.ADJUST_Y_EXCEPT_OFFSCREEN;\n  if ((overflow & ADJUST_X_EXCEPT_OFFSCREEN) == ADJUST_X_EXCEPT_OFFSCREEN &&\n      (pos.x < viewport.left || pos.x >= viewport.right)) {\n    overflow &= ~goog.positioning.Overflow.ADJUST_X;\n  }\n  if ((overflow & ADJUST_Y_EXCEPT_OFFSCREEN) == ADJUST_Y_EXCEPT_OFFSCREEN &&\n      (pos.y < viewport.top || pos.y >= viewport.bottom)) {\n    overflow &= ~goog.positioning.Overflow.ADJUST_Y;\n  }\n\n  // Left edge outside viewport, try to move it.\n  if (pos.x < viewport.left && overflow & goog.positioning.Overflow.ADJUST_X) {\n    pos.x = viewport.left;\n    status |= goog.positioning.OverflowStatus.ADJUSTED_X;\n  }\n\n  // Ensure object is inside the viewport width if required.\n  if (overflow & goog.positioning.Overflow.RESIZE_WIDTH) {\n    // Move left edge inside viewport.\n    var originalX = pos.x;\n    if (pos.x < viewport.left) {\n      pos.x = viewport.left;\n      status |= goog.positioning.OverflowStatus.WIDTH_ADJUSTED;\n    }\n\n    // Shrink width to inside right of viewport.\n    if (pos.x + size.width > viewport.right) {\n      // Set the width to be either the new maximum width within the viewport\n      // or the width originally within the viewport, whichever is less.\n      size.width = Math.min(\n          viewport.right - pos.x, originalX + size.width - viewport.left);\n      size.width = Math.max(size.width, 0);\n      status |= goog.positioning.OverflowStatus.WIDTH_ADJUSTED;\n    }\n  }\n\n  // Right edge outside viewport, try to move it.\n  if (pos.x + size.width > viewport.right &&\n      overflow & goog.positioning.Overflow.ADJUST_X) {\n    pos.x = Math.max(viewport.right - size.width, viewport.left);\n    status |= goog.positioning.OverflowStatus.ADJUSTED_X;\n  }\n\n  // Left or right edge still outside viewport, fail if the FAIL_X option was\n  // specified, ignore it otherwise.\n  if (overflow & goog.positioning.Overflow.FAIL_X) {\n    status |=\n        (pos.x < viewport.left ? goog.positioning.OverflowStatus.FAILED_LEFT :\n                                 0) |\n        (pos.x + size.width > viewport.right ?\n             goog.positioning.OverflowStatus.FAILED_RIGHT :\n             0);\n  }\n\n  // Top edge outside viewport, try to move it.\n  if (pos.y < viewport.top && overflow & goog.positioning.Overflow.ADJUST_Y) {\n    pos.y = viewport.top;\n    status |= goog.positioning.OverflowStatus.ADJUSTED_Y;\n  }\n\n  // Ensure object is inside the viewport height if required.\n  if (overflow & goog.positioning.Overflow.RESIZE_HEIGHT) {\n    // Move top edge inside viewport.\n    var originalY = pos.y;\n    if (pos.y < viewport.top) {\n      pos.y = viewport.top;\n      status |= goog.positioning.OverflowStatus.HEIGHT_ADJUSTED;\n    }\n\n    // Shrink height to inside bottom of viewport.\n    if (pos.y + size.height > viewport.bottom) {\n      // Set the height to be either the new maximum height within the viewport\n      // or the height originally within the viewport, whichever is less.\n      size.height = Math.min(\n          viewport.bottom - pos.y, originalY + size.height - viewport.top);\n      size.height = Math.max(size.height, 0);\n      status |= goog.positioning.OverflowStatus.HEIGHT_ADJUSTED;\n    }\n  }\n\n  // Bottom edge outside viewport, try to move it.\n  if (pos.y + size.height > viewport.bottom &&\n      overflow & goog.positioning.Overflow.ADJUST_Y) {\n    pos.y = Math.max(viewport.bottom - size.height, viewport.top);\n    status |= goog.positioning.OverflowStatus.ADJUSTED_Y;\n  }\n\n  // Top or bottom edge still outside viewport, fail if the FAIL_Y option was\n  // specified, ignore it otherwise.\n  if (overflow & goog.positioning.Overflow.FAIL_Y) {\n    status |=\n        (pos.y < viewport.top ? goog.positioning.OverflowStatus.FAILED_TOP :\n                                0) |\n        (pos.y + size.height > viewport.bottom ?\n             goog.positioning.OverflowStatus.FAILED_BOTTOM :\n             0);\n  }\n\n  return status;\n};\n\n\n/**\n * Returns an absolute corner (top/bottom left/right) given an absolute\n * or relative (top/bottom start/end) corner and the direction of an element.\n * Absolute corners remain unchanged.\n * @param {Element} element DOM element to test for RTL direction.\n * @param {goog.positioning.Corner} corner The popup corner used for\n *     positioning.\n * @return {goog.positioning.Corner} Effective corner.\n */\ngoog.positioning.getEffectiveCorner = function(element, corner) {\n  return /** @type {goog.positioning.Corner} */ (\n      (corner & goog.positioning.CornerBit.FLIP_RTL &&\n               goog.style.isRightToLeft(element) ?\n           corner ^ goog.positioning.CornerBit.RIGHT :\n           corner) &\n      ~goog.positioning.CornerBit.FLIP_RTL);\n};\n\n\n/**\n * Returns the corner opposite the given one horizontally.\n * @param {goog.positioning.Corner} corner The popup corner used to flip.\n * @return {goog.positioning.Corner} The opposite corner horizontally.\n */\ngoog.positioning.flipCornerHorizontal = function(corner) {\n  return /** @type {goog.positioning.Corner} */ (\n      corner ^ goog.positioning.CornerBit.RIGHT);\n};\n\n\n/**\n * Returns the corner opposite the given one vertically.\n * @param {goog.positioning.Corner} corner The popup corner used to flip.\n * @return {goog.positioning.Corner} The opposite corner vertically.\n */\ngoog.positioning.flipCornerVertical = function(corner) {\n  return /** @type {goog.positioning.Corner} */ (\n      corner ^ goog.positioning.CornerBit.BOTTOM);\n};\n\n\n/**\n * Returns the corner opposite the given one horizontally and vertically.\n * @param {goog.positioning.Corner} corner The popup corner used to flip.\n * @return {goog.positioning.Corner} The opposite corner horizontally and\n *     vertically.\n */\ngoog.positioning.flipCorner = function(corner) {\n  return /** @type {goog.positioning.Corner} */ (\n      corner ^ goog.positioning.CornerBit.BOTTOM ^\n      goog.positioning.CornerBit.RIGHT);\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Abstract base class for positioning implementations.\n *\n * @author eae@google.com (Emil A Eklund)\n */\n\ngoog.provide('goog.positioning.AbstractPosition');\n\n\n\n/**\n * Abstract position object. Encapsulates position and overflow handling.\n *\n * @constructor\n */\ngoog.positioning.AbstractPosition = function() {};\n\n\n/**\n * Repositions the element. Abstract method, should be overloaded.\n *\n * @param {Element} movableElement Element to position.\n * @param {goog.positioning.Corner} corner Corner of the movable element that\n *     should be positioned adjacent to the anchored element.\n * @param {goog.math.Box=} opt_margin A margin specified in pixels.\n * @param {goog.math.Size=} opt_preferredSize PreferredSize of the\n *     movableElement.\n */\ngoog.positioning.AbstractPosition.prototype.reposition = function(\n    movableElement, corner, opt_margin, opt_preferredSize) {};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Client positioning class.\n *\n * @author eae@google.com (Emil A Eklund)\n */\n\ngoog.provide('goog.positioning.AnchoredPosition');\n\ngoog.require('goog.positioning');\ngoog.require('goog.positioning.AbstractPosition');\n\n\n\n/**\n * Encapsulates a popup position where the popup is anchored at a corner of\n * an element.\n *\n * When using AnchoredPosition, it is recommended that the popup element\n * specified in the Popup constructor or Popup.setElement be absolutely\n * positioned.\n *\n * @param {Element} anchorElement Element the movable element should be\n *     anchored against.\n * @param {goog.positioning.Corner} corner Corner of anchored element the\n *     movable element should be positioned at.\n * @param {number=} opt_overflow Overflow handling mode. Defaults to IGNORE if\n *     not specified. Bitmap, {@see goog.positioning.Overflow}.\n * @constructor\n * @extends {goog.positioning.AbstractPosition}\n */\ngoog.positioning.AnchoredPosition = function(\n    anchorElement, corner, opt_overflow) {\n  /**\n   * Element the movable element should be anchored against.\n   * @type {Element}\n   */\n  this.element = anchorElement;\n\n  /**\n   * Corner of anchored element the movable element should be positioned at.\n   * @type {goog.positioning.Corner}\n   */\n  this.corner = corner;\n\n  /**\n   * Overflow handling mode. Defaults to IGNORE if not specified.\n   * Bitmap, {@see goog.positioning.Overflow}.\n   * @type {number|undefined}\n   * @private\n   */\n  this.overflow_ = opt_overflow;\n};\ngoog.inherits(\n    goog.positioning.AnchoredPosition, goog.positioning.AbstractPosition);\n\n\n/**\n * Repositions the movable element.\n *\n * @param {Element} movableElement Element to position.\n * @param {goog.positioning.Corner} movableCorner Corner of the movable element\n *     that should be positioned adjacent to the anchored element.\n * @param {goog.math.Box=} opt_margin A margin specifin pixels.\n * @param {goog.math.Size=} opt_preferredSize PreferredSize of the\n *     movableElement (unused in this class).\n * @override\n */\ngoog.positioning.AnchoredPosition.prototype.reposition = function(\n    movableElement, movableCorner, opt_margin, opt_preferredSize) {\n  goog.positioning.positionAtAnchor(\n      this.element, this.corner, movableElement, movableCorner, undefined,\n      opt_margin, this.overflow_);\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Anchored viewport positioning class.\n *\n * @author eae@google.com (Emil A Eklund)\n */\n\ngoog.provide('goog.positioning.AnchoredViewportPosition');\n\ngoog.require('goog.positioning');\ngoog.require('goog.positioning.AnchoredPosition');\ngoog.require('goog.positioning.Overflow');\ngoog.require('goog.positioning.OverflowStatus');\n\n\n\n/**\n * Encapsulates a popup position where the popup is anchored at a corner of\n * an element. The corners are swapped if dictated by the viewport. For instance\n * if a popup is anchored with its top left corner to the bottom left corner of\n * the anchor the popup is either displayed below the anchor (as specified) or\n * above it if there's not enough room to display it below.\n *\n * When using this positioning object it's recommended that the movable element\n * be absolutely positioned.\n *\n * @param {Element} anchorElement Element the movable element should be\n *     anchored against.\n * @param {goog.positioning.Corner} corner Corner of anchored element the\n *     movable element should be positioned at.\n * @param {boolean=} opt_adjust Whether the positioning should be adjusted until\n *     the element fits inside the viewport even if that means that the anchored\n *     corners are ignored.\n * @param {goog.math.Box=} opt_overflowConstraint Box object describing the\n *     dimensions in which the movable element could be shown.\n * @constructor\n * @extends {goog.positioning.AnchoredPosition}\n */\ngoog.positioning.AnchoredViewportPosition = function(\n    anchorElement, corner, opt_adjust, opt_overflowConstraint) {\n  goog.positioning.AnchoredPosition.call(this, anchorElement, corner);\n\n  /**\n   * The last resort algorithm to use if the algorithm can't fit inside\n   * the viewport.\n   *\n   * IGNORE = do nothing, just display at the preferred position.\n   *\n   * ADJUST_X | ADJUST_Y = Adjust until the element fits, even if that means\n   * that the anchored corners are ignored.\n   *\n   * @type {number}\n   * @private\n   */\n  this.lastResortOverflow_ = opt_adjust ? (goog.positioning.Overflow.ADJUST_X |\n                                           goog.positioning.Overflow.ADJUST_Y) :\n                                          goog.positioning.Overflow.IGNORE;\n\n  /**\n   * The dimensions in which the movable element could be shown.\n   * @type {goog.math.Box|undefined}\n   * @private\n   */\n  this.overflowConstraint_ = opt_overflowConstraint || undefined;\n};\ngoog.inherits(\n    goog.positioning.AnchoredViewportPosition,\n    goog.positioning.AnchoredPosition);\n\n\n/**\n * @return {goog.math.Box|undefined} The box object describing the\n *     dimensions in which the movable element will be shown.\n */\ngoog.positioning.AnchoredViewportPosition.prototype.getOverflowConstraint =\n    function() {\n  return this.overflowConstraint_;\n};\n\n\n/**\n * @param {goog.math.Box|undefined} overflowConstraint Box object describing the\n *     dimensions in which the movable element could be shown.\n */\ngoog.positioning.AnchoredViewportPosition.prototype.setOverflowConstraint =\n    function(overflowConstraint) {\n  this.overflowConstraint_ = overflowConstraint;\n};\n\n\n/**\n * @return {number} A bitmask for the \"last resort\" overflow.\n */\ngoog.positioning.AnchoredViewportPosition.prototype.getLastResortOverflow =\n    function() {\n  return this.lastResortOverflow_;\n};\n\n\n/**\n * @param {number} lastResortOverflow A bitmask for the \"last resort\" overflow,\n *     if we fail to fit the element on-screen.\n */\ngoog.positioning.AnchoredViewportPosition.prototype.setLastResortOverflow =\n    function(lastResortOverflow) {\n  this.lastResortOverflow_ = lastResortOverflow;\n};\n\n\n/**\n * Repositions the movable element.\n *\n * @param {Element} movableElement Element to position.\n * @param {goog.positioning.Corner} movableCorner Corner of the movable element\n *     that should be positioned adjacent to the anchored element.\n * @param {goog.math.Box=} opt_margin A margin specified in pixels.\n * @param {goog.math.Size=} opt_preferredSize The preferred size of the\n *     movableElement.\n * @override\n */\ngoog.positioning.AnchoredViewportPosition.prototype.reposition = function(\n    movableElement, movableCorner, opt_margin, opt_preferredSize) {\n  var status = goog.positioning.positionAtAnchor(\n      this.element, this.corner, movableElement, movableCorner, null,\n      opt_margin,\n      goog.positioning.Overflow.FAIL_X | goog.positioning.Overflow.FAIL_Y,\n      opt_preferredSize, this.overflowConstraint_);\n\n  // If the desired position is outside the viewport try mirroring the corners\n  // horizontally or vertically.\n  if (status & goog.positioning.OverflowStatus.FAILED) {\n    var cornerFallback = this.adjustCorner(status, this.corner);\n    var movableCornerFallback = this.adjustCorner(status, movableCorner);\n\n    status = goog.positioning.positionAtAnchor(\n        this.element, cornerFallback, movableElement, movableCornerFallback,\n        null, opt_margin,\n        goog.positioning.Overflow.FAIL_X | goog.positioning.Overflow.FAIL_Y,\n        opt_preferredSize, this.overflowConstraint_);\n\n    if (status & goog.positioning.OverflowStatus.FAILED) {\n      // If that also fails, pick the best corner from the two tries,\n      // and adjust the position until it fits.\n      cornerFallback = this.adjustCorner(status, cornerFallback);\n      movableCornerFallback = this.adjustCorner(status, movableCornerFallback);\n\n      goog.positioning.positionAtAnchor(\n          this.element, cornerFallback, movableElement, movableCornerFallback,\n          null, opt_margin, this.getLastResortOverflow(), opt_preferredSize,\n          this.overflowConstraint_);\n    }\n  }\n};\n\n\n/**\n * Adjusts the corner if X or Y positioning failed.\n * @param {number} status The status of the last positionAtAnchor call.\n * @param {goog.positioning.Corner} corner The corner to adjust.\n * @return {goog.positioning.Corner} The adjusted corner.\n * @protected\n */\ngoog.positioning.AnchoredViewportPosition.prototype.adjustCorner = function(\n    status, corner) {\n  if (status & goog.positioning.OverflowStatus.FAILED_HORIZONTAL) {\n    corner = goog.positioning.flipCornerHorizontal(corner);\n  }\n\n  if (status & goog.positioning.OverflowStatus.FAILED_VERTICAL) {\n    corner = goog.positioning.flipCornerVertical(corner);\n  }\n\n  return corner;\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Anchored viewport positioning class with both adjust and\n *     resize options for the popup.\n *\n * @author eae@google.com (Emil A Eklund)\n */\n\ngoog.provide('goog.positioning.MenuAnchoredPosition');\n\ngoog.require('goog.positioning.AnchoredViewportPosition');\ngoog.require('goog.positioning.Overflow');\n\n\n\n/**\n * Encapsulates a popup position where the popup is anchored at a corner of\n * an element.  The positioning behavior changes based on the values of\n * opt_adjust and opt_resize.\n *\n * When using this positioning object it's recommended that the movable element\n * be absolutely positioned.\n *\n * @param {Element} anchorElement Element the movable element should be\n *     anchored against.\n * @param {goog.positioning.Corner} corner Corner of anchored element the\n *     movable element should be positioned at.\n * @param {boolean=} opt_adjust Whether the positioning should be adjusted until\n *     the element fits inside the viewport even if that means that the anchored\n *     corners are ignored.\n * @param {boolean=} opt_resize Whether the positioning should be adjusted until\n *     the element fits inside the viewport on the X axis and its height is\n *     resized so if fits in the viewport. This take precedence over opt_adjust.\n * @constructor\n * @extends {goog.positioning.AnchoredViewportPosition}\n */\ngoog.positioning.MenuAnchoredPosition = function(\n    anchorElement, corner, opt_adjust, opt_resize) {\n  goog.positioning.AnchoredViewportPosition.call(\n      this, anchorElement, corner, opt_adjust || opt_resize);\n\n  if (opt_adjust || opt_resize) {\n    var overflowX = goog.positioning.Overflow.ADJUST_X_EXCEPT_OFFSCREEN;\n    var overflowY = opt_resize ?\n        goog.positioning.Overflow.RESIZE_HEIGHT :\n        goog.positioning.Overflow.ADJUST_Y_EXCEPT_OFFSCREEN;\n    this.setLastResortOverflow(overflowX | overflowY);\n  }\n};\ngoog.inherits(\n    goog.positioning.MenuAnchoredPosition,\n    goog.positioning.AnchoredViewportPosition);\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A custom button renderer that uses CSS voodoo to render a\n * button-like object with fake rounded corners.\n *\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.CustomButtonRenderer');\n\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.asserts');\ngoog.require('goog.dom.NodeType');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.classlist');\ngoog.require('goog.string');\ngoog.require('goog.ui.ButtonRenderer');\ngoog.require('goog.ui.INLINE_BLOCK_CLASSNAME');\n\n\n\n/**\n * Custom renderer for {@link goog.ui.Button}s.  Custom buttons can contain\n * almost arbitrary HTML content, will flow like inline elements, but can be\n * styled like block-level elements.\n *\n * @constructor\n * @extends {goog.ui.ButtonRenderer}\n */\ngoog.ui.CustomButtonRenderer = function() {\n  goog.ui.ButtonRenderer.call(this);\n};\ngoog.inherits(goog.ui.CustomButtonRenderer, goog.ui.ButtonRenderer);\ngoog.addSingletonGetter(goog.ui.CustomButtonRenderer);\n\n\n/**\n * Default CSS class to be applied to the root element of components rendered\n * by this renderer.\n * @type {string}\n */\ngoog.ui.CustomButtonRenderer.CSS_CLASS = goog.getCssName('goog-custom-button');\n\n\n/**\n * Returns the button's contents wrapped in the following DOM structure:\n *\n *    <div class=\"goog-inline-block goog-custom-button\">\n *      <div class=\"goog-inline-block goog-custom-button-outer-box\">\n *        <div class=\"goog-inline-block goog-custom-button-inner-box\">\n *          Contents...\n *        </div>\n *      </div>\n *    </div>\n *\n * Overrides {@link goog.ui.ButtonRenderer#createDom}.\n * @param {goog.ui.Control} control goog.ui.Button to render.\n * @return {!Element} Root element for the button.\n * @override\n */\ngoog.ui.CustomButtonRenderer.prototype.createDom = function(control) {\n  var button = /** @type {goog.ui.Button} */ (control);\n  var classNames = this.getClassNames(button);\n  var attributes = {\n    'class': goog.ui.INLINE_BLOCK_CLASSNAME + ' ' + classNames.join(' ')\n  };\n  var buttonElement = button.getDomHelper().createDom(\n      goog.dom.TagName.DIV, attributes,\n      this.createButton(button.getContent(), button.getDomHelper()));\n  this.setTooltip(buttonElement, /** @type {!string}*/ (button.getTooltip()));\n\n  return buttonElement;\n};\n\n\n/**\n * Returns the ARIA role to be applied to custom buttons.\n * @return {goog.a11y.aria.Role|undefined} ARIA role.\n * @override\n */\ngoog.ui.CustomButtonRenderer.prototype.getAriaRole = function() {\n  return goog.a11y.aria.Role.BUTTON;\n};\n\n\n/**\n * Takes the button's root element and returns the parent element of the\n * button's contents.  Overrides the superclass implementation by taking\n * the nested DIV structure of custom buttons into account.\n * @param {Element} element Root element of the button whose content\n *     element is to be returned.\n * @return {Element} The button's content element (if any).\n * @override\n */\ngoog.ui.CustomButtonRenderer.prototype.getContentElement = function(element) {\n  return element && element.firstChild &&\n      /** @type {Element} */ (element.firstChild.firstChild);\n};\n\n\n/**\n * Takes a text caption or existing DOM structure, and returns the content\n * wrapped in a pseudo-rounded-corner box.  Creates the following DOM structure:\n *\n *    <div class=\"goog-inline-block goog-custom-button-outer-box\">\n *      <div class=\"goog-inline-block goog-custom-button-inner-box\">\n *        Contents...\n *      </div>\n *    </div>\n *\n * Used by both {@link #createDom} and {@link #decorate}.  To be overridden\n * by subclasses.\n * @param {goog.ui.ControlContent} content Text caption or DOM structure to wrap\n *     in a box.\n * @param {goog.dom.DomHelper} dom DOM helper, used for document interaction.\n * @return {Element} Pseudo-rounded-corner box containing the content.\n */\ngoog.ui.CustomButtonRenderer.prototype.createButton = function(content, dom) {\n  return dom.createDom(\n      goog.dom.TagName.DIV, goog.ui.INLINE_BLOCK_CLASSNAME + ' ' +\n          goog.getCssName(this.getCssClass(), 'outer-box'),\n      dom.createDom(\n          goog.dom.TagName.DIV, goog.ui.INLINE_BLOCK_CLASSNAME + ' ' +\n              goog.getCssName(this.getCssClass(), 'inner-box'),\n          content));\n};\n\n\n/**\n * Returns true if this renderer can decorate the element.  Overrides\n * {@link goog.ui.ButtonRenderer#canDecorate} by returning true if the\n * element is a DIV, false otherwise.\n * @param {Element} element Element to decorate.\n * @return {boolean} Whether the renderer can decorate the element.\n * @override\n */\ngoog.ui.CustomButtonRenderer.prototype.canDecorate = function(element) {\n  return element.tagName == goog.dom.TagName.DIV;\n};\n\n\n/**\n * Check if the button's element has a box structure.\n * @param {goog.ui.Button} button Button instance whose structure is being\n *     checked.\n * @param {Element} element Element of the button.\n * @return {boolean} Whether the element has a box structure.\n * @protected\n */\ngoog.ui.CustomButtonRenderer.prototype.hasBoxStructure = function(\n    button, element) {\n  var outer = button.getDomHelper().getFirstElementChild(element);\n  var outerClassName = goog.getCssName(this.getCssClass(), 'outer-box');\n  if (outer && goog.dom.classlist.contains(outer, outerClassName)) {\n    var inner = button.getDomHelper().getFirstElementChild(outer);\n    var innerClassName = goog.getCssName(this.getCssClass(), 'inner-box');\n    if (inner && goog.dom.classlist.contains(inner, innerClassName)) {\n      // We have a proper box structure.\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Takes an existing element and decorates it with the custom button control.\n * Initializes the control's ID, content, tooltip, value, and state based\n * on the ID of the element, its child nodes, and its CSS classes, respectively.\n * Returns the element.  Overrides {@link goog.ui.ButtonRenderer#decorate}.\n * @param {goog.ui.Control} control Button instance to decorate the element.\n * @param {Element} element Element to decorate.\n * @return {Element} Decorated element.\n * @override\n */\ngoog.ui.CustomButtonRenderer.prototype.decorate = function(control, element) {\n  goog.asserts.assert(element);\n\n  var button = /** @type {goog.ui.Button} */ (control);\n  // Trim text nodes in the element's child node list; otherwise madness\n  // ensues (i.e. on Gecko, buttons will flicker and shift when moused over).\n  goog.ui.CustomButtonRenderer.trimTextNodes_(element, true);\n  goog.ui.CustomButtonRenderer.trimTextNodes_(element, false);\n\n  // Create the buttom dom if it has not been created.\n  if (!this.hasBoxStructure(button, element)) {\n    element.appendChild(\n        this.createButton(element.childNodes, button.getDomHelper()));\n  }\n\n  goog.dom.classlist.addAll(\n      element, [goog.ui.INLINE_BLOCK_CLASSNAME, this.getCssClass()]);\n  return goog.ui.CustomButtonRenderer.superClass_.decorate.call(\n      this, button, element);\n};\n\n\n/**\n * Returns the CSS class to be applied to the root element of components\n * rendered using this renderer.\n * @return {string} Renderer-specific CSS class.\n * @override\n */\ngoog.ui.CustomButtonRenderer.prototype.getCssClass = function() {\n  return goog.ui.CustomButtonRenderer.CSS_CLASS;\n};\n\n\n/**\n * Takes an element and removes leading or trailing whitespace from the start\n * or the end of its list of child nodes.  The Boolean argument determines\n * whether to trim from the start or the end of the node list.  Empty text\n * nodes are removed, and the first non-empty text node is trimmed from the\n * left or the right as appropriate.  For example,\n *\n *    <div class=\"goog-inline-block\">\n *      #text \"\"\n *      #text \"\\n    Hello \"\n *      <span>...</span>\n *      #text \" World!    \\n\"\n *      #text \"\"\n *    </div>\n *\n * becomes\n *\n *    <div class=\"goog-inline-block\">\n *      #text \"Hello \"\n *      <span>...</span>\n *      #text \" World!\"\n *    </div>\n *\n * This is essential for Gecko, where leading/trailing whitespace messes with\n * the layout of elements with -moz-inline-box (used in goog-inline-block), and\n * optional but harmless for non-Gecko.\n *\n * @param {Element} element Element whose child node list is to be trimmed.\n * @param {boolean} fromStart Whether to trim from the start or from the end.\n * @private\n */\ngoog.ui.CustomButtonRenderer.trimTextNodes_ = function(element, fromStart) {\n  if (element) {\n    var node = fromStart ? element.firstChild : element.lastChild, next;\n    // Tag soup HTML may result in a DOM where siblings have different parents.\n    while (node && node.parentNode == element) {\n      // Get the next/previous sibling here, since the node may be removed.\n      next = fromStart ? node.nextSibling : node.previousSibling;\n      if (node.nodeType == goog.dom.NodeType.TEXT) {\n        // Found a text node.\n        var text = node.nodeValue;\n        if (goog.string.trim(text) == '') {\n          // Found an empty text node; remove it.\n          element.removeChild(node);\n        } else {\n          // Found a non-empty text node; trim from the start/end, then exit.\n          node.nodeValue = fromStart ? goog.string.trimLeft(text) :\n                                       goog.string.trimRight(text);\n          break;\n        }\n      } else {\n        // Found a non-text node; done.\n        break;\n      }\n      node = next;\n    }\n  }\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Renderer for {@link goog.ui.MenuButton}s and subclasses.\n *\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.MenuButtonRenderer');\n\ngoog.require('goog.dom');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.style');\ngoog.require('goog.ui.CustomButtonRenderer');\ngoog.require('goog.ui.INLINE_BLOCK_CLASSNAME');\ngoog.require('goog.ui.Menu');\ngoog.require('goog.ui.MenuRenderer');\n\n\n\n/**\n * Renderer for {@link goog.ui.MenuButton}s.  This implementation overrides\n * {@link goog.ui.CustomButtonRenderer#createButton} to create a separate\n * caption and dropdown element.\n * @constructor\n * @extends {goog.ui.CustomButtonRenderer}\n */\ngoog.ui.MenuButtonRenderer = function() {\n  goog.ui.CustomButtonRenderer.call(this);\n};\ngoog.inherits(goog.ui.MenuButtonRenderer, goog.ui.CustomButtonRenderer);\ngoog.addSingletonGetter(goog.ui.MenuButtonRenderer);\n\n\n/**\n * Default CSS class to be applied to the root element of components rendered\n * by this renderer.\n * @type {string}\n */\ngoog.ui.MenuButtonRenderer.CSS_CLASS = goog.getCssName('goog-menu-button');\n\n\n/**\n * Takes the button's root element and returns the parent element of the\n * button's contents.  Overrides the superclass implementation by taking\n * the nested DIV structure of menu buttons into account.\n * @param {Element} element Root element of the button whose content element\n *     is to be returned.\n * @return {Element} The button's content element.\n * @override\n */\ngoog.ui.MenuButtonRenderer.prototype.getContentElement = function(element) {\n  return goog.ui.MenuButtonRenderer.superClass_.getContentElement.call(\n      this,\n      /** @type {Element} */ (element && element.firstChild));\n};\n\n\n/**\n * Takes an element, decorates it with the menu button control, and returns\n * the element.  Overrides {@link goog.ui.CustomButtonRenderer#decorate} by\n * looking for a child element that can be decorated by a menu, and if it\n * finds one, decorates it and attaches it to the menu button.\n * @param {goog.ui.Control} control goog.ui.MenuButton to decorate the element.\n * @param {Element} element Element to decorate.\n * @return {Element} Decorated element.\n * @override\n */\ngoog.ui.MenuButtonRenderer.prototype.decorate = function(control, element) {\n  var button = /** @type {goog.ui.MenuButton} */ (control);\n  // TODO(attila):  Add more robust support for subclasses of goog.ui.Menu.\n  var menuElem = goog.dom.getElementsByTagNameAndClass(\n      '*', goog.ui.MenuRenderer.CSS_CLASS, element)[0];\n  if (menuElem) {\n    // Move the menu element directly under the body (but hide it first to\n    // prevent flicker; see bug 1089244).\n    goog.style.setElementShown(menuElem, false);\n    goog.dom.appendChild(goog.dom.getOwnerDocument(menuElem).body, menuElem);\n\n    // Decorate the menu and attach it to the button.\n    var menu = new goog.ui.Menu();\n    menu.decorate(menuElem);\n    button.setMenu(menu);\n  }\n\n  // Let the superclass do the rest.\n  return goog.ui.MenuButtonRenderer.superClass_.decorate.call(\n      this, button, element);\n};\n\n\n/**\n * Takes a text caption or existing DOM structure, and returns the content and\n * a dropdown arrow element wrapped in a pseudo-rounded-corner box.  Creates\n * the following DOM structure:\n *\n *    <div class=\"goog-inline-block goog-menu-button-outer-box\">\n *      <div class=\"goog-inline-block goog-menu-button-inner-box\">\n *        <div class=\"goog-inline-block goog-menu-button-caption\">\n *          Contents...\n *        </div>\n *        <div class=\"goog-inline-block goog-menu-button-dropdown\">\n *          &nbsp;\n *        </div>\n *      </div>\n *    </div>\n *\n * @param {goog.ui.ControlContent} content Text caption or DOM structure\n *     to wrap in a box.\n * @param {goog.dom.DomHelper} dom DOM helper, used for document interaction.\n * @return {Element} Pseudo-rounded-corner box containing the content.\n * @override\n */\ngoog.ui.MenuButtonRenderer.prototype.createButton = function(content, dom) {\n  return goog.ui.MenuButtonRenderer.superClass_.createButton.call(\n      this, [this.createCaption(content, dom), this.createDropdown(dom)], dom);\n};\n\n\n/**\n * Takes a text caption or existing DOM structure, and returns it wrapped in\n * an appropriately-styled DIV.  Creates the following DOM structure:\n *\n *    <div class=\"goog-inline-block goog-menu-button-caption\">\n *      Contents...\n *    </div>\n *\n * @param {goog.ui.ControlContent} content Text caption or DOM structure\n *     to wrap in a box.\n * @param {goog.dom.DomHelper} dom DOM helper, used for document interaction.\n * @return {Element} Caption element.\n */\ngoog.ui.MenuButtonRenderer.prototype.createCaption = function(content, dom) {\n  return goog.ui.MenuButtonRenderer.wrapCaption(\n      content, this.getCssClass(), dom);\n};\n\n\n/**\n * Takes a text caption or existing DOM structure, and returns it wrapped in\n * an appropriately-styled DIV.  Creates the following DOM structure:\n *\n *    <div class=\"goog-inline-block goog-menu-button-caption\">\n *      Contents...\n *    </div>\n *\n * @param {goog.ui.ControlContent} content Text caption or DOM structure\n *     to wrap in a box.\n * @param {string} cssClass The CSS class for the renderer.\n * @param {goog.dom.DomHelper} dom DOM helper, used for document interaction.\n * @return {!Element} Caption element.\n */\ngoog.ui.MenuButtonRenderer.wrapCaption = function(content, cssClass, dom) {\n  return dom.createDom(\n      goog.dom.TagName.DIV, goog.ui.INLINE_BLOCK_CLASSNAME + ' ' +\n          goog.getCssName(cssClass, 'caption'),\n      content);\n};\n\n\n/**\n * Returns an appropriately-styled DIV containing a dropdown arrow element.\n * Creates the following DOM structure:\n *\n *    <div class=\"goog-inline-block goog-menu-button-dropdown\">\n *      &nbsp;\n *    </div>\n *\n * @param {goog.dom.DomHelper} dom DOM helper, used for document interaction.\n * @return {Element} Dropdown element.\n */\ngoog.ui.MenuButtonRenderer.prototype.createDropdown = function(dom) {\n  // 00A0 is &nbsp;\n  return dom.createDom(\n      goog.dom.TagName.DIV, goog.ui.INLINE_BLOCK_CLASSNAME + ' ' +\n          goog.getCssName(this.getCssClass(), 'dropdown'),\n      '\\u00A0');\n};\n\n\n/**\n * Returns the CSS class to be applied to the root element of components\n * rendered using this renderer.\n * @return {string} Renderer-specific CSS class.\n * @override\n */\ngoog.ui.MenuButtonRenderer.prototype.getCssClass = function() {\n  return goog.ui.MenuButtonRenderer.CSS_CLASS;\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Detects the specific browser and not just the rendering engine.\n *\n */\n\ngoog.provide('goog.userAgent.product');\n\ngoog.require('goog.labs.userAgent.browser');\ngoog.require('goog.labs.userAgent.platform');\ngoog.require('goog.userAgent');\n\n\n/**\n * @define {boolean} Whether the code is running on the Firefox web browser.\n */\ngoog.define('goog.userAgent.product.ASSUME_FIREFOX', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the product is an\n *     iPhone.\n */\ngoog.define('goog.userAgent.product.ASSUME_IPHONE', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the product is an\n *     iPad.\n */\ngoog.define('goog.userAgent.product.ASSUME_IPAD', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the product is an\n *     AOSP browser or WebView inside a pre KitKat Android phone or tablet.\n */\ngoog.define('goog.userAgent.product.ASSUME_ANDROID', false);\n\n\n/**\n * @define {boolean} Whether the code is running on the Chrome web browser on\n * any platform or AOSP browser or WebView in a KitKat+ Android phone or tablet.\n */\ngoog.define('goog.userAgent.product.ASSUME_CHROME', false);\n\n\n/**\n * @define {boolean} Whether the code is running on the Safari web browser.\n */\ngoog.define('goog.userAgent.product.ASSUME_SAFARI', false);\n\n\n/**\n * Whether we know the product type at compile-time.\n * @type {boolean}\n * @private\n */\ngoog.userAgent.product.PRODUCT_KNOWN_ = goog.userAgent.ASSUME_IE ||\n    goog.userAgent.ASSUME_EDGE || goog.userAgent.ASSUME_OPERA ||\n    goog.userAgent.product.ASSUME_FIREFOX ||\n    goog.userAgent.product.ASSUME_IPHONE ||\n    goog.userAgent.product.ASSUME_IPAD ||\n    goog.userAgent.product.ASSUME_ANDROID ||\n    goog.userAgent.product.ASSUME_CHROME ||\n    goog.userAgent.product.ASSUME_SAFARI;\n\n\n/**\n * Whether the code is running on the Opera web browser.\n * @type {boolean}\n */\ngoog.userAgent.product.OPERA = goog.userAgent.OPERA;\n\n\n/**\n * Whether the code is running on an IE web browser.\n * @type {boolean}\n */\ngoog.userAgent.product.IE = goog.userAgent.IE;\n\n\n/**\n * Whether the code is running on an Edge web browser.\n * @type {boolean}\n */\ngoog.userAgent.product.EDGE = goog.userAgent.EDGE;\n\n\n/**\n * Whether the code is running on the Firefox web browser.\n * @type {boolean}\n */\ngoog.userAgent.product.FIREFOX = goog.userAgent.product.PRODUCT_KNOWN_ ?\n    goog.userAgent.product.ASSUME_FIREFOX :\n    goog.labs.userAgent.browser.isFirefox();\n\n\n/**\n * Whether the user agent is an iPhone or iPod (as in iPod touch).\n * @return {boolean}\n * @private\n */\ngoog.userAgent.product.isIphoneOrIpod_ = function() {\n  return goog.labs.userAgent.platform.isIphone() ||\n      goog.labs.userAgent.platform.isIpod();\n};\n\n\n/**\n * Whether the code is running on an iPhone or iPod touch.\n *\n * iPod touch is considered an iPhone for legacy reasons.\n * @type {boolean}\n */\ngoog.userAgent.product.IPHONE = goog.userAgent.product.PRODUCT_KNOWN_ ?\n    goog.userAgent.product.ASSUME_IPHONE :\n    goog.userAgent.product.isIphoneOrIpod_();\n\n\n/**\n * Whether the code is running on an iPad.\n * @type {boolean}\n */\ngoog.userAgent.product.IPAD = goog.userAgent.product.PRODUCT_KNOWN_ ?\n    goog.userAgent.product.ASSUME_IPAD :\n    goog.labs.userAgent.platform.isIpad();\n\n\n/**\n * Whether the code is running on AOSP browser or WebView inside\n * a pre KitKat Android phone or tablet.\n * @type {boolean}\n */\ngoog.userAgent.product.ANDROID = goog.userAgent.product.PRODUCT_KNOWN_ ?\n    goog.userAgent.product.ASSUME_ANDROID :\n    goog.labs.userAgent.browser.isAndroidBrowser();\n\n\n/**\n * Whether the code is running on the Chrome web browser on any platform\n * or AOSP browser or WebView in a KitKat+ Android phone or tablet.\n * @type {boolean}\n */\ngoog.userAgent.product.CHROME = goog.userAgent.product.PRODUCT_KNOWN_ ?\n    goog.userAgent.product.ASSUME_CHROME :\n    goog.labs.userAgent.browser.isChrome();\n\n\n/**\n * @return {boolean} Whether the browser is Safari on desktop.\n * @private\n */\ngoog.userAgent.product.isSafariDesktop_ = function() {\n  return goog.labs.userAgent.browser.isSafari() &&\n      !goog.labs.userAgent.platform.isIos();\n};\n\n\n/**\n * Whether the code is running on the desktop Safari web browser.\n * Note: the legacy behavior here is only true for Safari not running\n * on iOS.\n * @type {boolean}\n */\ngoog.userAgent.product.SAFARI = goog.userAgent.product.PRODUCT_KNOWN_ ?\n    goog.userAgent.product.ASSUME_SAFARI :\n    goog.userAgent.product.isSafariDesktop_();\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A menu button control.\n *\n * @author attila@google.com (Attila Bodis)\n * @see ../demos/menubutton.html\n */\n\ngoog.provide('goog.ui.MenuButton');\n\ngoog.require('goog.Timer');\ngoog.require('goog.a11y.aria');\ngoog.require('goog.a11y.aria.State');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.events.EventType');\ngoog.require('goog.events.KeyCodes');\ngoog.require('goog.events.KeyHandler');\ngoog.require('goog.math.Box');\ngoog.require('goog.math.Rect');\ngoog.require('goog.positioning');\ngoog.require('goog.positioning.Corner');\ngoog.require('goog.positioning.MenuAnchoredPosition');\ngoog.require('goog.positioning.Overflow');\ngoog.require('goog.style');\ngoog.require('goog.ui.Button');\ngoog.require('goog.ui.Component');\ngoog.require('goog.ui.IdGenerator');\ngoog.require('goog.ui.Menu');\ngoog.require('goog.ui.MenuButtonRenderer');\ngoog.require('goog.ui.MenuItem');\ngoog.require('goog.ui.MenuRenderer');\ngoog.require('goog.ui.registry');\ngoog.require('goog.userAgent');\ngoog.require('goog.userAgent.product');\n\n\n\n/**\n * A menu button control.  Extends {@link goog.ui.Button} by composing a button\n * with a dropdown arrow and a popup menu.\n *\n * @param {goog.ui.ControlContent=} opt_content Text caption or existing DOM\n *     structure to display as the button's caption (if any).\n * @param {goog.ui.Menu=} opt_menu Menu to render under the button when clicked.\n * @param {goog.ui.ButtonRenderer=} opt_renderer Renderer used to render or\n *     decorate the menu button; defaults to {@link goog.ui.MenuButtonRenderer}.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper, used for\n *     document interaction.\n * @param {!goog.ui.MenuRenderer=} opt_menuRenderer Renderer used to render or\n *     decorate the menu; defaults to {@link goog.ui.MenuRenderer}.\n * @constructor\n * @extends {goog.ui.Button}\n */\ngoog.ui.MenuButton = function(\n    opt_content, opt_menu, opt_renderer, opt_domHelper, opt_menuRenderer) {\n  goog.ui.Button.call(\n      this, opt_content,\n      opt_renderer || goog.ui.MenuButtonRenderer.getInstance(), opt_domHelper);\n\n  // Menu buttons support the OPENED state.\n  this.setSupportedState(goog.ui.Component.State.OPENED, true);\n\n  /**\n   * The menu position on this button.\n   * @type {!goog.positioning.AnchoredPosition}\n   * @private\n   */\n  this.menuPosition_ = new goog.positioning.MenuAnchoredPosition(\n      null, goog.positioning.Corner.BOTTOM_START);\n\n  if (opt_menu) {\n    this.setMenu(opt_menu);\n  }\n  this.menuMargin_ = null;\n  this.timer_ = new goog.Timer(500);  // 0.5 sec\n\n  // Phones running iOS prior to version 4.2.\n  if ((goog.userAgent.product.IPHONE || goog.userAgent.product.IPAD) &&\n      // Check the webkit version against the version for iOS 4.2.1.\n      !goog.userAgent.isVersionOrHigher('533.17.9')) {\n    // @bug 4322060 This is required so that the menu works correctly on\n    // iOS prior to version 4.2. Otherwise, the blur action closes the menu\n    // before the menu button click can be processed.\n    this.setFocusablePopupMenu(true);\n  }\n\n  /** @private {!goog.ui.MenuRenderer} */\n  this.menuRenderer_ = opt_menuRenderer || goog.ui.MenuRenderer.getInstance();\n};\ngoog.inherits(goog.ui.MenuButton, goog.ui.Button);\ngoog.tagUnsealableClass(goog.ui.MenuButton);\n\n\n/**\n * The menu.\n * @type {goog.ui.Menu|undefined}\n * @private\n */\ngoog.ui.MenuButton.prototype.menu_;\n\n\n/**\n * The position element.  If set, use positionElement_ to position the\n * popup menu instead of the default which is to use the menu button element.\n * @type {Element|undefined}\n * @private\n */\ngoog.ui.MenuButton.prototype.positionElement_;\n\n\n/**\n * The margin to apply to the menu's position when it is shown.  If null, no\n * margin will be applied.\n * @type {goog.math.Box}\n * @private\n */\ngoog.ui.MenuButton.prototype.menuMargin_;\n\n\n/**\n * Whether the attached popup menu is focusable or not (defaults to false).\n * Popup menus attached to menu buttons usually don't need to be focusable,\n * i.e. the button retains keyboard focus, and forwards key events to the\n * menu for processing.  However, menus like {@link goog.ui.FilteredMenu}\n * need to be focusable.\n * @type {boolean}\n * @private\n */\ngoog.ui.MenuButton.prototype.isFocusablePopupMenu_ = false;\n\n\n/**\n * A Timer to correct menu position.\n * @type {goog.Timer}\n * @private\n */\ngoog.ui.MenuButton.prototype.timer_;\n\n\n/**\n * The bounding rectangle of the button element.\n * @type {goog.math.Rect}\n * @private\n */\ngoog.ui.MenuButton.prototype.buttonRect_;\n\n\n/**\n * The viewport rectangle.\n * @type {goog.math.Box}\n * @private\n */\ngoog.ui.MenuButton.prototype.viewportBox_;\n\n\n/**\n * The original size.\n * @type {goog.math.Size|undefined}\n * @private\n */\ngoog.ui.MenuButton.prototype.originalSize_;\n\n\n/**\n * Do we render the drop down menu as a sibling to the label, or at the end\n * of the current dom?\n * @type {boolean}\n * @private\n */\ngoog.ui.MenuButton.prototype.renderMenuAsSibling_ = false;\n\n\n/**\n * Whether to select the first item in the menu when it is opened using\n * enter or space. By default, the first item is selected only when\n * opened by a key up or down event. When this is on, the first item will\n * be selected due to any of the four events.\n * @private\n */\ngoog.ui.MenuButton.prototype.selectFirstOnEnterOrSpace_ = false;\n\n\n/**\n * Sets up event handlers specific to menu buttons.\n * @override\n */\ngoog.ui.MenuButton.prototype.enterDocument = function() {\n  goog.ui.MenuButton.superClass_.enterDocument.call(this);\n  this.attachKeyDownEventListener_(true);\n  if (this.menu_) {\n    this.attachMenuEventListeners_(this.menu_, true);\n  }\n  goog.a11y.aria.setState(\n      this.getElementStrict(), goog.a11y.aria.State.HASPOPUP, !!this.menu_);\n};\n\n\n/**\n * Removes event handlers specific to menu buttons, and ensures that the\n * attached menu also exits the document.\n * @override\n */\ngoog.ui.MenuButton.prototype.exitDocument = function() {\n  goog.ui.MenuButton.superClass_.exitDocument.call(this);\n  this.attachKeyDownEventListener_(false);\n  if (this.menu_) {\n    this.setOpen(false);\n    this.menu_.exitDocument();\n    this.attachMenuEventListeners_(this.menu_, false);\n\n    var menuElement = this.menu_.getElement();\n    if (menuElement) {\n      goog.dom.removeNode(menuElement);\n    }\n  }\n};\n\n\n/** @override */\ngoog.ui.MenuButton.prototype.disposeInternal = function() {\n  goog.ui.MenuButton.superClass_.disposeInternal.call(this);\n  if (this.menu_) {\n    this.menu_.dispose();\n    delete this.menu_;\n  }\n  delete this.positionElement_;\n  this.timer_.dispose();\n};\n\n\n/**\n * Handles mousedown events.  Invokes the superclass implementation to dispatch\n * an ACTIVATE event and activate the button.  Also toggles the visibility of\n * the attached menu.\n * @param {goog.events.Event} e Mouse event to handle.\n * @override\n * @protected\n */\ngoog.ui.MenuButton.prototype.handleMouseDown = function(e) {\n  goog.ui.MenuButton.superClass_.handleMouseDown.call(this, e);\n  if (this.isActive()) {\n    // The component was allowed to activate; toggle menu visibility.\n    this.setOpen(!this.isOpen(), e);\n    if (this.menu_) {\n      this.menu_.setMouseButtonPressed(this.isOpen());\n    }\n  }\n};\n\n\n/**\n * Handles mouseup events.  Invokes the superclass implementation to dispatch\n * an ACTION event and deactivate the button.\n * @param {goog.events.Event} e Mouse event to handle.\n * @override\n * @protected\n */\ngoog.ui.MenuButton.prototype.handleMouseUp = function(e) {\n  goog.ui.MenuButton.superClass_.handleMouseUp.call(this, e);\n  if (this.menu_ && !this.isActive()) {\n    this.menu_.setMouseButtonPressed(false);\n  }\n};\n\n\n/**\n * Performs the appropriate action when the menu button is activated by the\n * user.  Overrides the superclass implementation by not dispatching an {@code\n * ACTION} event, because menu buttons exist only to reveal menus, not to\n * perform actions themselves.  Calls {@link #setActive} to deactivate the\n * button.\n * @param {goog.events.Event} e Mouse or key event that triggered the action.\n * @return {boolean} Whether the action was allowed to proceed.\n * @override\n * @protected\n */\ngoog.ui.MenuButton.prototype.performActionInternal = function(e) {\n  this.setActive(false);\n  return true;\n};\n\n\n/**\n * Handles mousedown events over the document.  If the mousedown happens over\n * an element unrelated to the component, hides the menu.\n * TODO(attila): Reconcile this with goog.ui.Popup (and handle frames/windows).\n * @param {goog.events.BrowserEvent} e Mouse event to handle.\n * @protected\n */\ngoog.ui.MenuButton.prototype.handleDocumentMouseDown = function(e) {\n  if (this.menu_ && this.menu_.isVisible() &&\n      !this.containsElement(/** @type {Element} */ (e.target))) {\n    // User clicked somewhere else in the document while the menu was visible;\n    // dismiss menu.\n    this.setOpen(false);\n  }\n};\n\n\n/**\n * Returns true if the given element is to be considered part of the component,\n * even if it isn't a DOM descendant of the component's root element.\n * @param {Element} element Element to test (if any).\n * @return {boolean} Whether the element is considered part of the component.\n * @protected\n */\ngoog.ui.MenuButton.prototype.containsElement = function(element) {\n  return element && goog.dom.contains(this.getElement(), element) ||\n      this.menu_ && this.menu_.containsElement(element) || false;\n};\n\n\n/** @override */\ngoog.ui.MenuButton.prototype.handleKeyEventInternal = function(e) {\n  // Handle SPACE on keyup and all other keys on keypress.\n  if (e.keyCode == goog.events.KeyCodes.SPACE) {\n    // Prevent page scrolling in Chrome.\n    e.preventDefault();\n    if (e.type != goog.events.EventType.KEYUP) {\n      // Ignore events because KeyCodes.SPACE is handled further down.\n      return true;\n    }\n  } else if (e.type != goog.events.KeyHandler.EventType.KEY) {\n    return false;\n  }\n\n  if (this.menu_ && this.menu_.isVisible()) {\n    // Menu is open.\n    var isEnterOrSpace = e.keyCode == goog.events.KeyCodes.ENTER ||\n        e.keyCode == goog.events.KeyCodes.SPACE;\n    var handledByMenu = this.menu_.handleKeyEvent(e);\n    if (e.keyCode == goog.events.KeyCodes.ESC || isEnterOrSpace) {\n      // Dismiss the menu.\n      this.setOpen(false);\n      return true;\n    }\n    return handledByMenu;\n  }\n\n  if (e.keyCode == goog.events.KeyCodes.DOWN ||\n      e.keyCode == goog.events.KeyCodes.UP ||\n      e.keyCode == goog.events.KeyCodes.SPACE ||\n      e.keyCode == goog.events.KeyCodes.ENTER) {\n    // Menu is closed, and the user hit the down/up/space/enter key; open menu.\n    this.setOpen(true, e);\n    return true;\n  }\n\n  // Key event wasn't handled by the component.\n  return false;\n};\n\n\n/**\n * Handles {@code ACTION} events dispatched by an activated menu item.\n * @param {goog.events.Event} e Action event to handle.\n * @protected\n */\ngoog.ui.MenuButton.prototype.handleMenuAction = function(e) {\n  // Close the menu on click.\n  this.setOpen(false);\n};\n\n\n/**\n * Handles {@code BLUR} events dispatched by the popup menu by closing it.\n * Only registered if the menu is focusable.\n * @param {goog.events.Event} e Blur event dispatched by a focusable menu.\n */\ngoog.ui.MenuButton.prototype.handleMenuBlur = function(e) {\n  // Close the menu when it reports that it lost focus, unless the button is\n  // pressed (active).\n  if (!this.isActive()) {\n    this.setOpen(false);\n  }\n};\n\n\n/**\n * Handles blur events dispatched by the button's key event target when it\n * loses keyboard focus by closing the popup menu (unless it is focusable).\n * Only registered if the button is focusable.\n * @param {goog.events.Event} e Blur event dispatched by the menu button.\n * @override\n * @protected\n */\ngoog.ui.MenuButton.prototype.handleBlur = function(e) {\n  if (!this.isFocusablePopupMenu()) {\n    this.setOpen(false);\n  }\n  goog.ui.MenuButton.superClass_.handleBlur.call(this, e);\n};\n\n\n/**\n * Returns the menu attached to the button.  If no menu is attached, creates a\n * new empty menu.\n * @return {goog.ui.Menu} Popup menu attached to the menu button.\n */\ngoog.ui.MenuButton.prototype.getMenu = function() {\n  if (!this.menu_) {\n    this.setMenu(new goog.ui.Menu(this.getDomHelper(), this.menuRenderer_));\n  }\n  return this.menu_ || null;\n};\n\n\n/**\n * Replaces the menu attached to the button with the argument, and returns the\n * previous menu (if any).\n * @param {goog.ui.Menu?} menu New menu to be attached to the menu button (null\n *     to remove the menu).\n * @return {goog.ui.Menu|undefined} Previous menu (undefined if none).\n */\ngoog.ui.MenuButton.prototype.setMenu = function(menu) {\n  var oldMenu = this.menu_;\n\n  // Do nothing unless the new menu is different from the current one.\n  if (menu != oldMenu) {\n    if (oldMenu) {\n      this.setOpen(false);\n      if (this.isInDocument()) {\n        this.attachMenuEventListeners_(oldMenu, false);\n      }\n      delete this.menu_;\n    }\n    if (this.isInDocument()) {\n      goog.a11y.aria.setState(\n          this.getElementStrict(), goog.a11y.aria.State.HASPOPUP, !!menu);\n    }\n    if (menu) {\n      this.menu_ = menu;\n      menu.setParent(this);\n      menu.setVisible(false);\n      menu.setAllowAutoFocus(this.isFocusablePopupMenu());\n      if (this.isInDocument()) {\n        this.attachMenuEventListeners_(menu, true);\n      }\n    }\n  }\n\n  return oldMenu;\n};\n\n\n/**\n * Specify which positioning algorithm to use.\n *\n * This method is preferred over the fine-grained positioning methods like\n * setPositionElement, setAlignMenuToStart, and setScrollOnOverflow. Calling\n * this method will override settings by those methods.\n *\n * @param {goog.positioning.AnchoredPosition} position The position of the\n *     Menu the button. If the position has a null anchor, we will use the\n *     menubutton element as the anchor.\n */\ngoog.ui.MenuButton.prototype.setMenuPosition = function(position) {\n  if (position) {\n    this.menuPosition_ = position;\n    this.positionElement_ = position.element;\n  }\n};\n\n\n/**\n * Sets an element for anchoring the menu.\n * @param {Element} positionElement New element to use for\n *     positioning the dropdown menu.  Null to use the default behavior\n *     of positioning to this menu button.\n */\ngoog.ui.MenuButton.prototype.setPositionElement = function(positionElement) {\n  this.positionElement_ = positionElement;\n  this.positionMenu();\n};\n\n\n/**\n * Sets a margin that will be applied to the menu's position when it is shown.\n * If null, no margin will be applied.\n * @param {goog.math.Box} margin Margin to apply.\n */\ngoog.ui.MenuButton.prototype.setMenuMargin = function(margin) {\n  this.menuMargin_ = margin;\n};\n\n\n/**\n * Sets whether to select the first item in the menu when it is opened using\n * enter or space. By default, the first item is selected only when\n * opened by a key up or down event. When this is on, the first item will\n * be selected due to any of the four events.\n * @param {boolean} select\n */\ngoog.ui.MenuButton.prototype.setSelectFirstOnEnterOrSpace = function(select) {\n  this.selectFirstOnEnterOrSpace_ = select;\n};\n\n\n/**\n * Adds a new menu item at the end of the menu.\n * @param {goog.ui.MenuItem|goog.ui.MenuSeparator|goog.ui.Control} item Menu\n *     item to add to the menu.\n */\ngoog.ui.MenuButton.prototype.addItem = function(item) {\n  this.getMenu().addChild(item, true);\n};\n\n\n/**\n * Adds a new menu item at the specific index in the menu.\n * @param {goog.ui.MenuItem|goog.ui.MenuSeparator} item Menu item to add to the\n *     menu.\n * @param {number} index Index at which to insert the menu item.\n */\ngoog.ui.MenuButton.prototype.addItemAt = function(item, index) {\n  this.getMenu().addChildAt(item, index, true);\n};\n\n\n/**\n * Removes the item from the menu and disposes of it.\n * @param {goog.ui.MenuItem|goog.ui.MenuSeparator} item The menu item to remove.\n */\ngoog.ui.MenuButton.prototype.removeItem = function(item) {\n  var child = this.getMenu().removeChild(item, true);\n  if (child) {\n    child.dispose();\n  }\n};\n\n\n/**\n * Removes the menu item at a given index in the menu and disposes of it.\n * @param {number} index Index of item.\n */\ngoog.ui.MenuButton.prototype.removeItemAt = function(index) {\n  var child = this.getMenu().removeChildAt(index, true);\n  if (child) {\n    child.dispose();\n  }\n};\n\n\n/**\n * Returns the menu item at a given index.\n * @param {number} index Index of menu item.\n * @return {goog.ui.MenuItem?} Menu item (null if not found).\n */\ngoog.ui.MenuButton.prototype.getItemAt = function(index) {\n  return this.menu_ ?\n      /** @type {goog.ui.MenuItem} */ (this.menu_.getChildAt(index)) :\n                                      null;\n};\n\n\n/**\n * Returns the number of items in the menu (including separators).\n * @return {number} The number of items in the menu.\n */\ngoog.ui.MenuButton.prototype.getItemCount = function() {\n  return this.menu_ ? this.menu_.getChildCount() : 0;\n};\n\n\n/**\n * Shows/hides the menu button based on the value of the argument.  Also hides\n * the popup menu if the button is being hidden.\n * @param {boolean} visible Whether to show or hide the button.\n * @param {boolean=} opt_force If true, doesn't check whether the component\n *     already has the requested visibility, and doesn't dispatch any events.\n * @return {boolean} Whether the visibility was changed.\n * @override\n */\ngoog.ui.MenuButton.prototype.setVisible = function(visible, opt_force) {\n  var visibilityChanged =\n      goog.ui.MenuButton.superClass_.setVisible.call(this, visible, opt_force);\n  if (visibilityChanged && !this.isVisible()) {\n    this.setOpen(false);\n  }\n  return visibilityChanged;\n};\n\n\n/**\n * Enables/disables the menu button based on the value of the argument, and\n * updates its CSS styling.  Also hides the popup menu if the button is being\n * disabled.\n * @param {boolean} enable Whether to enable or disable the button.\n * @override\n */\ngoog.ui.MenuButton.prototype.setEnabled = function(enable) {\n  goog.ui.MenuButton.superClass_.setEnabled.call(this, enable);\n  if (!this.isEnabled()) {\n    this.setOpen(false);\n  }\n};\n\n\n// TODO(nicksantos): AlignMenuToStart and ScrollOnOverflow and PositionElement\n// should all be deprecated, in favor of people setting their own\n// AnchoredPosition with the parameters they need. Right now, we try\n// to be backwards-compatible as possible, but this is incomplete because\n// the APIs are non-orthogonal.\n\n\n/**\n * @return {boolean} Whether the menu is aligned to the start of the button\n *     (left if the render direction is left-to-right, right if the render\n *     direction is right-to-left).\n */\ngoog.ui.MenuButton.prototype.isAlignMenuToStart = function() {\n  var corner = this.menuPosition_.corner;\n  return corner == goog.positioning.Corner.BOTTOM_START ||\n      corner == goog.positioning.Corner.TOP_START;\n};\n\n\n/**\n * Sets whether the menu is aligned to the start or the end of the button.\n * @param {boolean} alignToStart Whether the menu is to be aligned to the start\n *     of the button (left if the render direction is left-to-right, right if\n *     the render direction is right-to-left).\n */\ngoog.ui.MenuButton.prototype.setAlignMenuToStart = function(alignToStart) {\n  this.menuPosition_.corner = alignToStart ?\n      goog.positioning.Corner.BOTTOM_START :\n      goog.positioning.Corner.BOTTOM_END;\n};\n\n\n/**\n * Sets whether the menu should scroll when it's too big to fix vertically on\n * the screen.  The css of the menu element should have overflow set to auto.\n * Note: Adding or removing items while the menu is open will not work correctly\n * if scrollOnOverflow is on.\n * @param {boolean} scrollOnOverflow Whether the menu should scroll when too big\n *     to fit on the screen.  If false, adjust logic will be used to try and\n *     reposition the menu to fit.\n */\ngoog.ui.MenuButton.prototype.setScrollOnOverflow = function(scrollOnOverflow) {\n  if (this.menuPosition_.setLastResortOverflow) {\n    var overflowX = goog.positioning.Overflow.ADJUST_X;\n    var overflowY = scrollOnOverflow ? goog.positioning.Overflow.RESIZE_HEIGHT :\n                                       goog.positioning.Overflow.ADJUST_Y;\n    this.menuPosition_.setLastResortOverflow(overflowX | overflowY);\n  }\n};\n\n\n/**\n * @return {boolean} Wether the menu will scroll when it's to big to fit\n *     vertically on the screen.\n */\ngoog.ui.MenuButton.prototype.isScrollOnOverflow = function() {\n  return this.menuPosition_.getLastResortOverflow &&\n      !!(this.menuPosition_.getLastResortOverflow() &\n         goog.positioning.Overflow.RESIZE_HEIGHT);\n};\n\n\n/**\n * @return {boolean} Whether the attached menu is focusable.\n */\ngoog.ui.MenuButton.prototype.isFocusablePopupMenu = function() {\n  return this.isFocusablePopupMenu_;\n};\n\n\n/**\n * Sets whether the attached popup menu is focusable.  If the popup menu is\n * focusable, it may steal keyboard focus from the menu button, so the button\n * will not hide the menu on blur.\n * @param {boolean} focusable Whether the attached menu is focusable.\n */\ngoog.ui.MenuButton.prototype.setFocusablePopupMenu = function(focusable) {\n  // TODO(attila):  The menu itself should advertise whether it is focusable.\n  this.isFocusablePopupMenu_ = focusable;\n};\n\n\n/**\n * Sets whether to render the menu as a sibling element of the button.\n * Normally, the menu is a child of document.body.  This option is useful if\n * you need the menu to inherit styles from a common parent element, or if you\n * otherwise need it to share a parent element for desired event handling.  One\n * example of the latter is if the parent is in a goog.ui.Popup, to ensure that\n * clicks on the menu are considered being within the popup.\n * @param {boolean} renderMenuAsSibling Whether we render the menu at the end\n *     of the dom or as a sibling to the button/label that renders the drop\n *     down.\n */\ngoog.ui.MenuButton.prototype.setRenderMenuAsSibling = function(\n    renderMenuAsSibling) {\n  this.renderMenuAsSibling_ = renderMenuAsSibling;\n};\n\n\n/**\n * Reveals the menu and hooks up menu-specific event handling.\n * @deprecated Use {@link #setOpen} instead.\n */\ngoog.ui.MenuButton.prototype.showMenu = function() {\n  this.setOpen(true);\n};\n\n\n/**\n * Hides the menu and cleans up menu-specific event handling.\n * @deprecated Use {@link #setOpen} instead.\n */\ngoog.ui.MenuButton.prototype.hideMenu = function() {\n  this.setOpen(false);\n};\n\n\n/**\n * Opens or closes the attached popup menu.\n * @param {boolean} open Whether to open or close the menu.\n * @param {goog.events.Event=} opt_e Event that caused the menu to be opened.\n * @override\n */\ngoog.ui.MenuButton.prototype.setOpen = function(open, opt_e) {\n  goog.ui.MenuButton.superClass_.setOpen.call(this, open);\n  if (this.menu_ && this.hasState(goog.ui.Component.State.OPENED) == open) {\n    if (open) {\n      if (!this.menu_.isInDocument()) {\n        if (this.renderMenuAsSibling_) {\n          // When we render the menu in the same parent as this button, we\n          // prefer to add it immediately after the button. This way, the screen\n          // readers will go to the menu on the very next element after the\n          // button is read.\n          var nextElementSibling =\n              goog.dom.getNextElementSibling(this.getElement());\n          if (nextElementSibling) {\n            this.menu_.renderBefore(nextElementSibling);\n          } else {\n            this.menu_.render(\n                /** @type {Element} */ (this.getElement().parentNode));\n          }\n        } else {\n          this.menu_.render();\n        }\n      }\n      this.viewportBox_ =\n          goog.style.getVisibleRectForElement(this.getElement());\n      this.buttonRect_ = goog.style.getBounds(this.getElement());\n      this.positionMenu();\n\n      // As per aria spec, highlight the first element in the menu when\n      // keyboarding up or down. Thus, the first menu item will be announced\n      // for screen reader users. If selectFirstOnEnterOrSpace is set, do this\n      // for enter or space as well.\n      var isEnterOrSpace =\n          !!opt_e && (opt_e.keyCode == goog.events.KeyCodes.ENTER ||\n                      opt_e.keyCode == goog.events.KeyCodes.SPACE);\n      var isUpOrDown = !!opt_e && (opt_e.keyCode == goog.events.KeyCodes.DOWN ||\n                                   opt_e.keyCode == goog.events.KeyCodes.UP);\n      var focus =\n          isUpOrDown || (isEnterOrSpace && this.selectFirstOnEnterOrSpace_);\n      if (focus) {\n        this.menu_.highlightFirst();\n      } else {\n        this.menu_.setHighlightedIndex(-1);\n      }\n    } else {\n      this.setActive(false);\n      this.menu_.setMouseButtonPressed(false);\n\n      var element = this.getElement();\n      // Clear any remaining a11y state.\n      if (element) {\n        goog.a11y.aria.setState(\n            element, goog.a11y.aria.State.ACTIVEDESCENDANT, '');\n        goog.a11y.aria.setState(element, goog.a11y.aria.State.OWNS, '');\n      }\n\n      // Clear any sizes that might have been stored.\n      if (goog.isDefAndNotNull(this.originalSize_)) {\n        this.originalSize_ = undefined;\n        var elem = this.menu_.getElement();\n        if (elem) {\n          goog.style.setSize(elem, '', '');\n        }\n      }\n    }\n    this.menu_.setVisible(open, false, opt_e);\n    // In Pivot Tables the menu button somehow gets disposed of during the\n    // setVisible call, causing attachPopupListeners_ to fail.\n    // TODO(user): Debug what happens.\n    if (!this.isDisposed()) {\n      this.attachPopupListeners_(open);\n    }\n  }\n  if (this.menu_ && this.menu_.getElement()) {\n    // Remove the aria-hidden state on the menu element so that it won't be\n    // hidden to screen readers if it's inside a dialog (see b/17610491).\n    goog.a11y.aria.removeState(\n        this.menu_.getElementStrict(), goog.a11y.aria.State.HIDDEN);\n  }\n};\n\n\n/**\n * Resets the MenuButton's size.  This is useful for cases where items are added\n * or removed from the menu and scrollOnOverflow is on.  In those cases the\n * menu will not behave correctly and resize itself unless this is called\n * (usually followed by positionMenu()).\n */\ngoog.ui.MenuButton.prototype.invalidateMenuSize = function() {\n  this.originalSize_ = undefined;\n};\n\n\n/**\n * Positions the menu under the button.  May be called directly in cases when\n * the menu size is known to change.\n */\ngoog.ui.MenuButton.prototype.positionMenu = function() {\n  if (!this.menu_.isInDocument()) {\n    return;\n  }\n\n  var positionElement = this.positionElement_ || this.getElement();\n  var position = this.menuPosition_;\n  this.menuPosition_.element = positionElement;\n\n  var elem = this.menu_.getElement();\n  if (!this.menu_.isVisible()) {\n    elem.style.visibility = 'hidden';\n    goog.style.setElementShown(elem, true);\n  }\n\n  if (!this.originalSize_ && this.isScrollOnOverflow()) {\n    this.originalSize_ = goog.style.getSize(elem);\n  }\n  var popupCorner = goog.positioning.flipCornerVertical(position.corner);\n  position.reposition(elem, popupCorner, this.menuMargin_, this.originalSize_);\n\n  if (!this.menu_.isVisible()) {\n    goog.style.setElementShown(elem, false);\n    elem.style.visibility = 'visible';\n  }\n};\n\n\n/**\n * Periodically repositions the menu while it is visible.\n *\n * @param {goog.events.Event} e An event object.\n * @private\n */\ngoog.ui.MenuButton.prototype.onTick_ = function(e) {\n  // Call positionMenu() only if the button position or size was\n  // changed, or if the window's viewport was changed.\n  var currentButtonRect = goog.style.getBounds(this.getElement());\n  var currentViewport = goog.style.getVisibleRectForElement(this.getElement());\n  if (!goog.math.Rect.equals(this.buttonRect_, currentButtonRect) ||\n      !goog.math.Box.equals(this.viewportBox_, currentViewport)) {\n    this.buttonRect_ = currentButtonRect;\n    this.viewportBox_ = currentViewport;\n    this.positionMenu();\n  }\n};\n\n\n/**\n * Attaches or detaches menu event listeners to/from the given menu.\n * Called each time a menu is attached to or detached from the button.\n * @param {goog.ui.Menu} menu Menu on which to listen for events.\n * @param {boolean} attach Whether to attach or detach event listeners.\n * @private\n */\ngoog.ui.MenuButton.prototype.attachMenuEventListeners_ = function(\n    menu, attach) {\n  var handler = this.getHandler();\n  var method = attach ? handler.listen : handler.unlisten;\n\n  // Handle events dispatched by menu items.\n  method.call(\n      handler, menu, goog.ui.Component.EventType.ACTION, this.handleMenuAction);\n  method.call(\n      handler, menu, goog.ui.Component.EventType.CLOSE, this.handleCloseItem);\n  method.call(\n      handler, menu, goog.ui.Component.EventType.HIGHLIGHT,\n      this.handleHighlightItem);\n  method.call(\n      handler, menu, goog.ui.Component.EventType.UNHIGHLIGHT,\n      this.handleUnHighlightItem);\n};\n\n\n/**\n * Attaches or detaches a keydown event listener to/from the given element.\n * Called each time the button enters or exits the document.\n * @param {boolean} attach Whether to attach or detach the event listener.\n * @private\n */\ngoog.ui.MenuButton.prototype.attachKeyDownEventListener_ = function(attach) {\n  var handler = this.getHandler();\n  var method = attach ? handler.listen : handler.unlisten;\n\n  // Handle keydown events dispatched by the button.\n  method.call(\n      handler, this.getElement(), goog.events.EventType.KEYDOWN,\n      this.handleKeyDownEvent_);\n};\n\n\n/**\n * Handles {@code HIGHLIGHT} events dispatched by the attached menu.\n * @param {goog.events.Event} e Highlight event to handle.\n */\ngoog.ui.MenuButton.prototype.handleHighlightItem = function(e) {\n  var targetEl = e.target.getElement();\n  if (targetEl) {\n    this.setAriaActiveDescendant_(targetEl);\n  }\n};\n\n\n/**\n * Handles {@code KEYDOWN} events dispatched by the button element. When the\n * button is focusable and the menu is present and visible, prevents the event\n * from propagating since the desired behavior is only to close the menu.\n * @param {goog.events.Event} e KeyDown event to handle.\n * @private\n */\ngoog.ui.MenuButton.prototype.handleKeyDownEvent_ = function(e) {\n  if (this.isSupportedState(goog.ui.Component.State.FOCUSED) &&\n      this.getKeyEventTarget() && this.menu_ && this.menu_.isVisible()) {\n    e.stopPropagation();\n  }\n};\n\n\n/**\n * Handles UNHIGHLIGHT events dispatched by the associated menu.\n * @param {goog.events.Event} e Unhighlight event to handle.\n */\ngoog.ui.MenuButton.prototype.handleUnHighlightItem = function(e) {\n  if (!this.menu_.getHighlighted()) {\n    var element = this.getElement();\n    goog.asserts.assert(element, 'The menu button DOM element cannot be null.');\n    goog.a11y.aria.setState(element, goog.a11y.aria.State.ACTIVEDESCENDANT, '');\n    goog.a11y.aria.setState(element, goog.a11y.aria.State.OWNS, '');\n  }\n};\n\n\n/**\n * Handles {@code CLOSE} events dispatched by the associated menu.\n * @param {goog.events.Event} e Close event to handle.\n */\ngoog.ui.MenuButton.prototype.handleCloseItem = function(e) {\n  // When a submenu is closed by pressing left arrow, no highlight event is\n  // dispatched because the newly focused item was already highlighted, so this\n  // scenario is handled by listening for the submenu close event instead.\n  if (this.isOpen() && e.target instanceof goog.ui.MenuItem) {\n    var menuItem = /** @type {!goog.ui.MenuItem} */ (e.target);\n    var menuItemEl = menuItem.getElement();\n    if (menuItem.isVisible() && menuItem.isHighlighted() &&\n        menuItemEl != null) {\n      this.setAriaActiveDescendant_(menuItemEl);\n    }\n  }\n};\n\n\n/**\n * Updates the aria-activedescendant attribute to the given target element.\n * @param {!Element} targetEl The target element.\n * @private\n */\ngoog.ui.MenuButton.prototype.setAriaActiveDescendant_ = function(targetEl) {\n  var element = this.getElement();\n  goog.asserts.assert(element, 'The menu button DOM element cannot be null.');\n\n  // If target element has an activedescendant, then set this control's\n  // activedescendant to that, otherwise set it to the target element. This is\n  // a workaround for some screen readers which do not handle\n  // aria-activedescendant redirection properly.\n  var targetActiveDescendant = goog.a11y.aria.getActiveDescendant(targetEl);\n  var activeDescendant = targetActiveDescendant || targetEl;\n\n  if (!activeDescendant.id) {\n    // Create an id if there isn't one already.\n    var idGenerator = goog.ui.IdGenerator.getInstance();\n    activeDescendant.id = idGenerator.getNextUniqueId();\n  }\n\n  goog.a11y.aria.setActiveDescendant(element, activeDescendant);\n  goog.a11y.aria.setState(\n      element, goog.a11y.aria.State.OWNS, activeDescendant.id);\n};\n\n\n/**\n * Attaches or detaches event listeners depending on whether the popup menu\n * is being shown or hidden.  Starts listening for document mousedown events\n * and for menu blur events when the menu is shown, and stops listening for\n * these events when it is hidden.  Called from {@link #setOpen}.\n * @param {boolean} attach Whether to attach or detach event listeners.\n * @private\n */\ngoog.ui.MenuButton.prototype.attachPopupListeners_ = function(attach) {\n  var handler = this.getHandler();\n  var method = attach ? handler.listen : handler.unlisten;\n\n  // Listen for document mousedown events in the capture phase, because\n  // the target may stop propagation of the event in the bubble phase.\n  method.call(\n      handler, this.getDomHelper().getDocument(),\n      goog.events.EventType.MOUSEDOWN, this.handleDocumentMouseDown, true);\n\n  // Only listen for blur events dispatched by the menu if it is focusable.\n  if (this.isFocusablePopupMenu()) {\n    method.call(\n        handler, /** @type {!goog.events.EventTarget} */ (this.menu_),\n        goog.ui.Component.EventType.BLUR, this.handleMenuBlur);\n  }\n\n  method.call(handler, this.timer_, goog.Timer.TICK, this.onTick_);\n  if (attach) {\n    this.timer_.start();\n  } else {\n    this.timer_.stop();\n  }\n};\n\n\n// Register a decorator factory function for goog.ui.MenuButtons.\ngoog.ui.registry.setDecoratorByClassName(\n    goog.ui.MenuButtonRenderer.CSS_CLASS, function() {\n      // MenuButton defaults to using MenuButtonRenderer.\n      return new goog.ui.MenuButton(null);\n    });\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Similar functionality of {@link goog.ui.MenuButtonRenderer},\n * but inherits from {@link goog.ui.FlatButtonRenderer} instead of\n * {@link goog.ui.CustomButtonRenderer}. This creates a simpler menu button\n * that will look more like a traditional <select> menu.\n *\n */\n\ngoog.provide('goog.ui.FlatMenuButtonRenderer');\n\ngoog.require('goog.dom');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.style');\ngoog.require('goog.ui.FlatButtonRenderer');\ngoog.require('goog.ui.INLINE_BLOCK_CLASSNAME');\ngoog.require('goog.ui.Menu');\ngoog.require('goog.ui.MenuButton');\ngoog.require('goog.ui.MenuRenderer');\ngoog.require('goog.ui.registry');\n\n\n\n/**\n * Flat Menu Button renderer. Creates a simpler version of\n * {@link goog.ui.MenuButton} that doesn't look like a button and\n * doesn't have rounded corners. Uses just a `<div>` and looks more like\n * a traditional `<select>` element.\n * @constructor\n * @extends {goog.ui.FlatButtonRenderer}\n */\ngoog.ui.FlatMenuButtonRenderer = function() {\n  goog.ui.FlatButtonRenderer.call(this);\n};\ngoog.inherits(goog.ui.FlatMenuButtonRenderer, goog.ui.FlatButtonRenderer);\ngoog.addSingletonGetter(goog.ui.FlatMenuButtonRenderer);\n\n\n/**\n * Default CSS class to be applied to the root element of components rendered\n * by this renderer.\n * @type {string}\n */\ngoog.ui.FlatMenuButtonRenderer.CSS_CLASS =\n    goog.getCssName('goog-flat-menu-button');\n\n\n/**\n * Returns the button's contents wrapped in the following DOM structure:\n *\n *    <div class=\"goog-inline-block goog-flat-menu-button\">\n *        <div class=\"goog-inline-block goog-flat-menu-button-caption\">\n *          Contents...\n *        </div>\n *        <div class=\"goog-inline-block goog-flat-menu-button-dropdown\">\n *          &nbsp;\n *        </div>\n *    </div>\n *\n * Overrides {@link goog.ui.FlatButtonRenderer#createDom}.\n * @param {goog.ui.Control} control Button to render.\n * @return {!Element} Root element for the button.\n * @override\n */\ngoog.ui.FlatMenuButtonRenderer.prototype.createDom = function(control) {\n  var button = /** @type {goog.ui.Button} */ (control);\n  var classNames = this.getClassNames(button);\n  var attributes = {\n    'class': goog.ui.INLINE_BLOCK_CLASSNAME + ' ' + classNames.join(' ')\n  };\n  var element =\n      button.getDomHelper().createDom(goog.dom.TagName.DIV, attributes, [\n        this.createCaption(button.getContent(), button.getDomHelper()),\n        this.createDropdown(button.getDomHelper())\n      ]);\n  this.setTooltip(element, /** @type {!string}*/ (button.getTooltip()));\n  return element;\n};\n\n\n/**\n * Takes the button's root element and returns the parent element of the\n * button's contents.\n * @param {Element} element Root element of the button whose content\n * element is to be returned.\n * @return {Element} The button's content element (if any).\n * @override\n */\ngoog.ui.FlatMenuButtonRenderer.prototype.getContentElement = function(element) {\n  return element && /** @type {Element} */ (element.firstChild);\n};\n\n\n/**\n * Takes an element, decorates it with the menu button control, and returns\n * the element.  Overrides {@link goog.ui.CustomButtonRenderer#decorate} by\n * looking for a child element that can be decorated by a menu, and if it\n * finds one, decorates it and attaches it to the menu button.\n * @param {goog.ui.Control} button Menu button to decorate the element.\n * @param {Element} element Element to decorate.\n * @return {Element} Decorated element.\n * @override\n */\ngoog.ui.FlatMenuButtonRenderer.prototype.decorate = function(button, element) {\n  // TODO(user): MenuButtonRenderer uses the exact same code.\n  // Refactor this block to its own module where both can use it.\n  var menuElem = goog.dom.getElementsByTagNameAndClass(\n      '*', goog.ui.MenuRenderer.CSS_CLASS, element)[0];\n  if (menuElem) {\n    // Move the menu element directly under the body, but hide it first; see\n    // bug 1089244.\n    goog.style.setElementShown(menuElem, false);\n    button.getDomHelper().getDocument().body.appendChild(menuElem);\n\n    // Decorate the menu and attach it to the button.\n    var menu = new goog.ui.Menu();\n    menu.decorate(menuElem);\n    button.setMenu(menu);\n  }\n\n  // Add the caption if it's not already there.\n  var captionElem = goog.dom.getElementsByTagNameAndClass(\n      '*', goog.getCssName(this.getCssClass(), 'caption'), element)[0];\n  if (!captionElem) {\n    element.appendChild(\n        this.createCaption(element.childNodes, button.getDomHelper()));\n  }\n\n  // Add the dropdown icon if it's not already there.\n  var dropdownElem = goog.dom.getElementsByTagNameAndClass(\n      '*', goog.getCssName(this.getCssClass(), 'dropdown'), element)[0];\n  if (!dropdownElem) {\n    element.appendChild(this.createDropdown(button.getDomHelper()));\n  }\n\n  // Let the superclass do the rest.\n  return goog.ui.FlatMenuButtonRenderer.superClass_.decorate.call(\n      this, button, element);\n};\n\n\n/**\n * Takes a text caption or existing DOM structure, and returns it wrapped in\n * an appropriately-styled DIV.  Creates the following DOM structure:\n *\n *    <div class=\"goog-inline-block goog-flat-menu-button-caption\">\n *      Contents...\n *    </div>\n *\n * @param {goog.ui.ControlContent} content Text caption or DOM structure to wrap\n *     in a box.\n * @param {goog.dom.DomHelper} dom DOM helper, used for document interaction.\n * @return {Element} Caption element.\n */\ngoog.ui.FlatMenuButtonRenderer.prototype.createCaption = function(\n    content, dom) {\n  return dom.createDom(\n      goog.dom.TagName.DIV, goog.ui.INLINE_BLOCK_CLASSNAME + ' ' +\n          goog.getCssName(this.getCssClass(), 'caption'),\n      content);\n};\n\n\n/**\n * Returns an appropriately-styled DIV containing a dropdown arrow element.\n * Creates the following DOM structure:\n *\n *    <div class=\"goog-inline-block goog-flat-menu-button-dropdown\">\n *      &nbsp;\n *    </div>\n *\n * @param {goog.dom.DomHelper} dom DOM helper, used for document interaction.\n * @return {!Element} Dropdown element.\n */\ngoog.ui.FlatMenuButtonRenderer.prototype.createDropdown = function(dom) {\n  // 00A0 is &nbsp;\n  return dom.createDom(\n      goog.dom.TagName.DIV, {\n        'class': goog.ui.INLINE_BLOCK_CLASSNAME + ' ' +\n            goog.getCssName(this.getCssClass(), 'dropdown'),\n        'aria-hidden': true\n      },\n      '\\u00A0');\n};\n\n\n/**\n * Returns the CSS class to be applied to the root element of components\n * rendered using this renderer.\n * @return {string} Renderer-specific CSS class.\n * @override\n */\ngoog.ui.FlatMenuButtonRenderer.prototype.getCssClass = function() {\n  return goog.ui.FlatMenuButtonRenderer.CSS_CLASS;\n};\n\n\n// Register a decorator factory function for Flat Menu Buttons.\ngoog.ui.registry.setDecoratorByClassName(\n    goog.ui.FlatMenuButtonRenderer.CSS_CLASS, function() {\n      // Uses goog.ui.MenuButton, but with FlatMenuButtonRenderer.\n      return new goog.ui.MenuButton(\n          null, null, goog.ui.FlatMenuButtonRenderer.getInstance());\n    });\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A menu item class that supports selection state.\n *\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.Option');\n\ngoog.require('goog.ui.Component');\ngoog.require('goog.ui.MenuItem');\ngoog.require('goog.ui.registry');\n\n\n\n/**\n * Class representing a menu option.  This is just a convenience class that\n * extends {@link goog.ui.MenuItem} by making it selectable.\n *\n * @param {goog.ui.ControlContent} content Text caption or DOM structure to\n *     display as the content of the item (use to add icons or styling to\n *     menus).\n * @param {*=} opt_model Data/model associated with the menu item.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper used for\n *     document interactions.\n * @constructor\n * @extends {goog.ui.MenuItem}\n */\ngoog.ui.Option = function(content, opt_model, opt_domHelper) {\n  goog.ui.MenuItem.call(this, content, opt_model, opt_domHelper);\n  this.setSelectable(true);\n};\ngoog.inherits(goog.ui.Option, goog.ui.MenuItem);\n\n\n/**\n * Performs the appropriate action when the option is activated by the user.\n * Overrides the superclass implementation by not changing the selection state\n * of the option and not dispatching any SELECTED events, for backwards\n * compatibility with existing uses of this class.\n * @param {goog.events.Event} e Mouse or key event that triggered the action.\n * @return {boolean} True if the action was allowed to proceed, false otherwise.\n * @override\n */\ngoog.ui.Option.prototype.performActionInternal = function(e) {\n  return this.dispatchEvent(goog.ui.Component.EventType.ACTION);\n};\n\n\n// Register a decorator factory function for goog.ui.Options.\ngoog.ui.registry.setDecoratorByClassName(\n    goog.getCssName('goog-option'), function() {\n      // Option defaults to using MenuItemRenderer.\n      return new goog.ui.Option(null);\n    });\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A class that supports single selection from a dropdown menu,\n * with semantics similar to the native HTML <code>&lt;select&gt;</code>\n * element.\n *\n * @author attila@google.com (Attila Bodis)\n * @see ../demos/select.html\n */\n\ngoog.provide('goog.ui.Select');\n\ngoog.require('goog.a11y.aria');\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.a11y.aria.State');\ngoog.require('goog.array');\ngoog.require('goog.events.EventType');\ngoog.require('goog.ui.Component');\ngoog.require('goog.ui.IdGenerator');\ngoog.require('goog.ui.MenuButton');\ngoog.require('goog.ui.MenuItem');\ngoog.require('goog.ui.MenuRenderer');\ngoog.require('goog.ui.SelectionModel');\ngoog.require('goog.ui.registry');\n\n\n\n/**\n * A selection control.  Extends {@link goog.ui.MenuButton} by composing a\n * menu with a selection model, and automatically updating the button's caption\n * based on the current selection.\n *\n * Select fires the following events:\n *   CHANGE - after selection changes.\n *\n * @param {goog.ui.ControlContent=} opt_caption Default caption or existing DOM\n *     structure to display as the button's caption when nothing is selected.\n *     Defaults to no caption.\n * @param {goog.ui.Menu=} opt_menu Menu containing selection options.\n * @param {goog.ui.ButtonRenderer=} opt_renderer Renderer used to render or\n *     decorate the control; defaults to {@link goog.ui.MenuButtonRenderer}.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper, used for\n *     document interaction.\n * @param {!goog.ui.MenuRenderer=} opt_menuRenderer Renderer used to render or\n *     decorate the menu; defaults to {@link goog.ui.MenuRenderer}.\n * @constructor\n * @extends {goog.ui.MenuButton}\n */\ngoog.ui.Select = function(\n    opt_caption, opt_menu, opt_renderer, opt_domHelper, opt_menuRenderer) {\n  goog.ui.Select.base(\n      this, 'constructor', opt_caption, opt_menu, opt_renderer, opt_domHelper,\n      opt_menuRenderer ||\n          new goog.ui.MenuRenderer(goog.a11y.aria.Role.LISTBOX));\n  /**\n   * Default caption to show when no option is selected.\n   * @private {goog.ui.ControlContent}\n   */\n  this.defaultCaption_ = this.getContent();\n\n  /**\n   * The initial value of the aria label of the content element. This will be\n   * null until the caption is first populated and will be non-null thereafter.\n   * @private {?string}\n   */\n  this.initialAriaLabel_ = null;\n\n  this.setPreferredAriaRole(goog.a11y.aria.Role.LISTBOX);\n};\ngoog.inherits(goog.ui.Select, goog.ui.MenuButton);\ngoog.tagUnsealableClass(goog.ui.Select);\n\n\n/**\n * The selection model controlling the items in the menu.\n * @type {goog.ui.SelectionModel}\n * @private\n */\ngoog.ui.Select.prototype.selectionModel_ = null;\n\n\n/** @override */\ngoog.ui.Select.prototype.enterDocument = function() {\n  goog.ui.Select.superClass_.enterDocument.call(this);\n  this.updateCaption();\n  this.listenToSelectionModelEvents_();\n};\n\n\n/**\n * Decorates the given element with this control.  Overrides the superclass\n * implementation by initializing the default caption on the select button.\n * @param {Element} element Element to decorate.\n * @override\n */\ngoog.ui.Select.prototype.decorateInternal = function(element) {\n  goog.ui.Select.superClass_.decorateInternal.call(this, element);\n  var caption = this.getCaption();\n  if (caption) {\n    // Initialize the default caption.\n    this.setDefaultCaption(caption);\n  } else if (!this.getSelectedItem()) {\n    // If there is no default caption and no selected item, select the first\n    // option (this is technically an arbitrary choice, but what most people\n    // would expect to happen).\n    this.setSelectedIndex(0);\n  }\n};\n\n\n/** @override */\ngoog.ui.Select.prototype.disposeInternal = function() {\n  goog.ui.Select.superClass_.disposeInternal.call(this);\n\n  if (this.selectionModel_) {\n    this.selectionModel_.dispose();\n    this.selectionModel_ = null;\n  }\n\n  this.defaultCaption_ = null;\n};\n\n\n/**\n * Handles {@link goog.ui.Component.EventType.ACTION} events dispatched by\n * the menu item clicked by the user.  Updates the selection model, calls\n * the superclass implementation to hide the menu, stops the propagation of\n * the event, and dispatches an ACTION event on behalf of the select control\n * itself.  Overrides {@link goog.ui.MenuButton#handleMenuAction}.\n * @param {goog.events.Event} e Action event to handle.\n * @override\n */\ngoog.ui.Select.prototype.handleMenuAction = function(e) {\n  this.setSelectedItem(/** @type {goog.ui.MenuItem} */ (e.target));\n  goog.ui.Select.base(this, 'handleMenuAction', e);\n\n  // NOTE(chrishenry): We should not stop propagation and then fire\n  // our own ACTION event. Fixing this without breaking anyone\n  // relying on this event is hard though.\n  e.stopPropagation();\n  this.dispatchEvent(goog.ui.Component.EventType.ACTION);\n};\n\n\n/**\n * Handles {@link goog.events.EventType.SELECT} events raised by the\n * selection model when the selection changes.  Updates the contents of the\n * select button.\n * @param {goog.events.Event} e Selection event to handle.\n */\ngoog.ui.Select.prototype.handleSelectionChange = function(e) {\n  var item = this.getSelectedItem();\n  goog.ui.Select.superClass_.setValue.call(this, item && item.getValue());\n  this.updateCaption();\n};\n\n\n/**\n * Replaces the menu currently attached to the control (if any) with the given\n * argument, and updates the selection model.  Does nothing if the new menu is\n * the same as the old one.  Overrides {@link goog.ui.MenuButton#setMenu}.\n * @param {goog.ui.Menu} menu New menu to be attached to the menu button.\n * @return {goog.ui.Menu|undefined} Previous menu (undefined if none).\n * @override\n */\ngoog.ui.Select.prototype.setMenu = function(menu) {\n  // Call superclass implementation to replace the menu.\n  var oldMenu = goog.ui.Select.superClass_.setMenu.call(this, menu);\n\n  // Do nothing unless the new menu is different from the current one.\n  if (menu != oldMenu) {\n    // Clear the old selection model (if any).\n    if (this.selectionModel_) {\n      this.selectionModel_.clear();\n    }\n\n    // Initialize new selection model (unless the new menu is null).\n    if (menu) {\n      if (this.selectionModel_) {\n        menu.forEachChild(function(child, index) {\n          this.setCorrectAriaRole_(\n              /** @type {goog.ui.MenuItem|goog.ui.MenuSeparator} */ (child));\n          this.selectionModel_.addItem(child);\n        }, this);\n      } else {\n        this.createSelectionModel_(menu);\n      }\n    }\n  }\n\n  return oldMenu;\n};\n\n\n/**\n * Returns the default caption to be shown when no option is selected.\n * @return {goog.ui.ControlContent} Default caption.\n */\ngoog.ui.Select.prototype.getDefaultCaption = function() {\n  return this.defaultCaption_;\n};\n\n\n/**\n * Sets the default caption to the given string or DOM structure.\n * @param {goog.ui.ControlContent} caption Default caption to be shown\n *    when no option is selected.\n */\ngoog.ui.Select.prototype.setDefaultCaption = function(caption) {\n  this.defaultCaption_ = caption;\n  this.updateCaption();\n};\n\n\n/**\n * Adds a new menu item at the end of the menu.\n * @param {goog.ui.Control} item Menu item to add to the menu.\n * @override\n */\ngoog.ui.Select.prototype.addItem = function(item) {\n  this.setCorrectAriaRole_(\n      /** @type {goog.ui.MenuItem|goog.ui.MenuSeparator} */ (item));\n  goog.ui.Select.superClass_.addItem.call(this, item);\n\n  if (this.selectionModel_) {\n    this.selectionModel_.addItem(item);\n  } else {\n    this.createSelectionModel_(this.getMenu());\n  }\n  this.updateAriaActiveDescendant_();\n};\n\n\n/**\n * Adds a new menu item at a specific index in the menu.\n * @param {goog.ui.MenuItem|goog.ui.MenuSeparator} item Menu item to add to the\n *     menu.\n * @param {number} index Index at which to insert the menu item.\n * @override\n */\ngoog.ui.Select.prototype.addItemAt = function(item, index) {\n  this.setCorrectAriaRole_(\n      /** @type {goog.ui.MenuItem|goog.ui.MenuSeparator} */ (item));\n  goog.ui.Select.superClass_.addItemAt.call(this, item, index);\n\n  if (this.selectionModel_) {\n    this.selectionModel_.addItemAt(item, index);\n  } else {\n    this.createSelectionModel_(this.getMenu());\n  }\n};\n\n\n/**\n * Removes an item from the menu and disposes it.\n * @param {goog.ui.MenuItem|goog.ui.MenuSeparator} item The menu item to remove.\n * @override\n */\ngoog.ui.Select.prototype.removeItem = function(item) {\n  goog.ui.Select.superClass_.removeItem.call(this, item);\n  if (this.selectionModel_) {\n    this.selectionModel_.removeItem(item);\n  }\n};\n\n\n/**\n * Removes a menu item at a given index in the menu and disposes it.\n * @param {number} index Index of item.\n * @override\n */\ngoog.ui.Select.prototype.removeItemAt = function(index) {\n  goog.ui.Select.superClass_.removeItemAt.call(this, index);\n  if (this.selectionModel_) {\n    this.selectionModel_.removeItemAt(index);\n  }\n};\n\n\n/**\n * Selects the specified option (assumed to be in the select menu), and\n * deselects the previously selected option, if any.  A null argument clears\n * the selection.\n * @param {goog.ui.MenuItem} item Option to be selected (null to clear\n *     the selection).\n */\ngoog.ui.Select.prototype.setSelectedItem = function(item) {\n  if (this.selectionModel_) {\n    var prevItem = this.getSelectedItem();\n    this.selectionModel_.setSelectedItem(item);\n\n    if (item != prevItem) {\n      this.dispatchEvent(goog.ui.Component.EventType.CHANGE);\n    }\n  }\n};\n\n\n/**\n * Selects the option at the specified index, or clears the selection if the\n * index is out of bounds.\n * @param {number} index Index of the option to be selected.\n */\ngoog.ui.Select.prototype.setSelectedIndex = function(index) {\n  if (this.selectionModel_) {\n    this.setSelectedItem(/** @type {goog.ui.MenuItem} */\n        (this.selectionModel_.getItemAt(index)));\n  }\n};\n\n\n/**\n * Selects the first option found with an associated value equal to the\n * argument, or clears the selection if no such option is found.  A null\n * argument also clears the selection.  Overrides {@link\n * goog.ui.Button#setValue}.\n * @param {*} value Value of the option to be selected (null to clear\n *     the selection).\n * @override\n */\ngoog.ui.Select.prototype.setValue = function(value) {\n  if (goog.isDefAndNotNull(value) && this.selectionModel_) {\n    for (var i = 0, item; item = this.selectionModel_.getItemAt(i); i++) {\n      if (item && typeof item.getValue == 'function' &&\n          item.getValue() == value) {\n        this.setSelectedItem(/** @type {!goog.ui.MenuItem} */ (item));\n        return;\n      }\n    }\n  }\n\n  this.setSelectedItem(null);\n};\n\n\n/**\n * Gets the value associated with the currently selected option (null if none).\n *\n * Note that unlike {@link goog.ui.Button#getValue} which this method overrides,\n * the \"value\" of a Select instance is the value of its selected menu item, not\n * its own value. This makes a difference because the \"value\" of a Button is\n * reset to the value of the element it decorates when it's added to the DOM\n * (via ButtonRenderer), whereas the value of the selected item is unaffected.\n * So while setValue() has no effect on a Button before it is added to the DOM,\n * it will make a persistent change to a Select instance (which is consistent\n * with any changes made by {@link goog.ui.Select#setSelectedItem} and\n * {@link goog.ui.Select#setSelectedIndex}).\n *\n * @override\n */\ngoog.ui.Select.prototype.getValue = function() {\n  var selectedItem = this.getSelectedItem();\n  return selectedItem ? selectedItem.getValue() : null;\n};\n\n\n/**\n * Returns the currently selected option.\n * @return {goog.ui.MenuItem} The currently selected option (null if none).\n */\ngoog.ui.Select.prototype.getSelectedItem = function() {\n  return this.selectionModel_ ?\n      /** @type {goog.ui.MenuItem} */ (this.selectionModel_.getSelectedItem()) :\n                                      null;\n};\n\n\n/**\n * Returns the index of the currently selected option.\n * @return {number} 0-based index of the currently selected option (-1 if none).\n */\ngoog.ui.Select.prototype.getSelectedIndex = function() {\n  return this.selectionModel_ ? this.selectionModel_.getSelectedIndex() : -1;\n};\n\n\n/**\n * @return {goog.ui.SelectionModel} The selection model.\n * @protected\n */\ngoog.ui.Select.prototype.getSelectionModel = function() {\n  return this.selectionModel_;\n};\n\n\n/**\n * Creates a new selection model and sets up an event listener to handle\n * {@link goog.events.EventType.SELECT} events dispatched by it.\n * @param {goog.ui.Component=} opt_component If provided, will add the\n *     component's children as items to the selection model.\n * @private\n */\ngoog.ui.Select.prototype.createSelectionModel_ = function(opt_component) {\n  this.selectionModel_ = new goog.ui.SelectionModel();\n  if (opt_component) {\n    opt_component.forEachChild(function(child, index) {\n      this.setCorrectAriaRole_(\n          /** @type {goog.ui.MenuItem|goog.ui.MenuSeparator} */ (child));\n      this.selectionModel_.addItem(child);\n    }, this);\n  }\n  this.listenToSelectionModelEvents_();\n};\n\n\n/**\n * Subscribes to events dispatched by the selection model.\n * @private\n */\ngoog.ui.Select.prototype.listenToSelectionModelEvents_ = function() {\n  if (this.selectionModel_) {\n    this.getHandler().listen(\n        this.selectionModel_, goog.events.EventType.SELECT,\n        this.handleSelectionChange);\n  }\n};\n\n\n/**\n * Updates the caption to be shown in the select button.  If no option is\n * selected and a default caption is set, sets the caption to the default\n * caption; otherwise to the empty string.\n * @protected\n */\ngoog.ui.Select.prototype.updateCaption = function() {\n  var item = this.getSelectedItem();\n  this.setContent(item ? item.getCaption() : this.defaultCaption_);\n\n  var contentElement = this.getRenderer().getContentElement(this.getElement());\n  // Despite the ControlRenderer interface indicating the return value is\n  // {Element}, many renderers cast element.firstChild to {Element} when it is\n  // really {Node}. Checking tagName verifies this is an {!Element}.\n  if (contentElement && this.getDomHelper().isElement(contentElement)) {\n    if (this.initialAriaLabel_ == null) {\n      this.initialAriaLabel_ = goog.a11y.aria.getLabel(contentElement);\n    }\n    var itemElement = item ? item.getElement() : null;\n    goog.a11y.aria.setLabel(\n        contentElement, itemElement ? goog.a11y.aria.getLabel(itemElement) :\n                                      this.initialAriaLabel_);\n    this.updateAriaActiveDescendant_();\n  }\n};\n\n\n/**\n * Updates the aria active descendant attribute.\n * @private\n */\ngoog.ui.Select.prototype.updateAriaActiveDescendant_ = function() {\n  var renderer = this.getRenderer();\n  if (renderer) {\n    var contentElement = renderer.getContentElement(this.getElement());\n    if (contentElement) {\n      var buttonElement = this.getElementStrict();\n      if (!contentElement.id) {\n        contentElement.id = goog.ui.IdGenerator.getInstance().getNextUniqueId();\n      }\n      goog.a11y.aria.setRole(contentElement, goog.a11y.aria.Role.OPTION);\n      goog.a11y.aria.setState(\n          buttonElement, goog.a11y.aria.State.ACTIVEDESCENDANT,\n          contentElement.id);\n      if (this.selectionModel_) {\n        // We can't use selectionmodel's getItemCount here because we need to\n        // skip separators.\n        var items = this.selectionModel_.getItems();\n        goog.a11y.aria.setState(\n            contentElement, goog.a11y.aria.State.SETSIZE,\n            this.getNumMenuItems_(items));\n        // Set a human-readable selection index, excluding menu separators.\n        var index = this.selectionModel_.getSelectedIndex();\n        goog.a11y.aria.setState(\n            contentElement, goog.a11y.aria.State.POSINSET, index >= 0 ?\n                this.getNumMenuItems_(goog.array.slice(items, 0, index + 1)) :\n                0);\n      }\n    }\n  }\n};\n\n\n/**\n * Gets the number of menu items in the array.\n * @param {!Array<?Object>} items The items.\n * @return {number}\n * @private\n */\ngoog.ui.Select.prototype.getNumMenuItems_ = function(items) {\n  return goog.array.count(\n      items, function(item) { return item instanceof goog.ui.MenuItem; });\n};\n\n\n/**\n * Sets the correct ARIA role for the menu item or separator.\n * @param {goog.ui.MenuItem|goog.ui.MenuSeparator} item The item to set.\n * @private\n */\ngoog.ui.Select.prototype.setCorrectAriaRole_ = function(item) {\n  item.setPreferredAriaRole(\n      item instanceof goog.ui.MenuItem ? goog.a11y.aria.Role.OPTION :\n                                         goog.a11y.aria.Role.SEPARATOR);\n};\n\n\n/**\n * Opens or closes the menu.  Overrides {@link goog.ui.MenuButton#setOpen} by\n * highlighting the currently selected option on open.\n * @param {boolean} open Whether to open or close the menu.\n * @param {goog.events.Event=} opt_e Mousedown event that caused the menu to\n *     be opened.\n * @override\n */\ngoog.ui.Select.prototype.setOpen = function(open, opt_e) {\n  goog.ui.Select.superClass_.setOpen.call(this, open, opt_e);\n\n  if (this.isOpen()) {\n    this.getMenu().setHighlightedIndex(this.getSelectedIndex());\n  } else {\n    this.updateAriaActiveDescendant_();\n  }\n};\n\n\n// Register a decorator factory function for goog.ui.Selects.\ngoog.ui.registry.setDecoratorByClassName(\n    goog.getCssName('goog-select'), function() {\n      // Select defaults to using MenuButtonRenderer, since it shares its L&F.\n      return new goog.ui.Select(null);\n    });\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Provides a function that decorates an element based on its CSS\n * class name.\n * @author attila@google.com (Attila Bodis)\n */\n\ngoog.provide('goog.ui.decorate');\n\ngoog.require('goog.ui.registry');\n\n\n/**\n * Decorates the element with a suitable {@link goog.ui.Component} instance, if\n * a matching decorator is found.\n * @param {Element} element Element to decorate.\n * @return {goog.ui.Component?} New component instance, decorating the element.\n */\ngoog.ui.decorate = function(element) {\n  var decorator = goog.ui.registry.getDecorator(element);\n  if (decorator) {\n    decorator.decorate(element);\n  }\n  return decorator;\n};\n","/**\n * @fileoverview Object representing a separate function editor. This function\n * editor provides a separate modal workspace where a user can modify a given\n * function definition.\n */\n'use strict';\n\ngoog.provide('Blockly.ContractEditor');\n\ngoog.require('Blockly.FunctionEditor');\ngoog.require('Blockly.FunctionalBlockUtils');\ngoog.require('Blockly.ExampleView');\ngoog.require('Blockly.BlockValueType');\ngoog.require('Blockly.FunctionalTypeColors');\ngoog.require('Blockly.ContractEditorSectionView');\ngoog.require('Blockly.ContractDefinitionSection');\ngoog.require('Blockly.SvgHeader');\ngoog.require('Blockly.SvgTextButton');\ngoog.require('Blockly.SvgHighlightBox');\ngoog.require('Blockly.DomainEditor');\ngoog.require('Blockly.TypeDropdown');\ngoog.require('Blockly.CustomCssClassMenuRenderer');\ngoog.require('goog.ui.Component.EventType');\ngoog.require('goog.ui.FlatMenuButtonRenderer');\ngoog.require('goog.ui.Option');\ngoog.require('goog.ui.Select');\ngoog.require('goog.ui.Separator');\ngoog.require('goog.ui.decorate');\ngoog.require('goog.ui.Component.EventType');\ngoog.require('goog.events');\ngoog.require('goog.color');\ngoog.require('goog.array');\n\n/** @const */ var EXAMPLE_BLOCK_MARGIN_BELOW = 20; // px\n/** @const */ var EXAMPLE_BLOCK_MARGIN_LEFT = Blockly.FunctionEditor.BLOCK_LAYOUT_LEFT_MARGIN; // px\n/** @const */ var EXAMPLE_BLOCK_SECTION_MAGIN_BELOW = 10; // px\n/** @const */ var EXAMPLE_BLOCK_SECTION_MAGIN_ABOVE = 15; // px\n/** @const */ var HEADER_HEIGHT = 30; // px\n/** @const */ var DEFAULT_EXAMPLE_CALL_SECTION_WIDTH = 100; // px\n/** @const */ var MARGIN_BLOCK_TO_CALL_SLOT = 13; // px\n\n/** @const */ var USER_TYPE_CHOICES = [\n  Blockly.BlockValueType.NUMBER,\n  Blockly.BlockValueType.STRING,\n  Blockly.BlockValueType.IMAGE,\n  Blockly.BlockValueType.BOOLEAN\n];\n\n/** The following must match up with level config parameters */\n/** @const */ var CONTRACT_SECTION_NAME = 'contract';\n/** @const */ var EXAMPLES_SECTION_NAME = 'examples';\n/** @const */ var DEFINITION_SECTION_NAME = 'definition';\n/** @const */ var HIGHLIGHT_CONFIG_SUFFIX = 'Highlight';\n/** @const */ var COLLAPSE_CONFIG_SUFFIX = 'Collapse';\n/** @const */ var DISABLE_EXAMPLES_CONFIG_NAME = 'disableExamples';\n\n/**\n * Class for a functional block-specific contract editor.\n * @param {Object} configuration - configuration parameters\n * @param {boolean} configuration.disableExamples - whether to never show examples\n * @constructor\n */\nBlockly.ContractEditor = function(configuration) {\n  Blockly.ContractEditor.superClass_.constructor.call(this);\n\n  /**\n   * Whether examples should be hidden for the lifetime of this editor\n   * @type {boolean}\n   * @private\n   */\n  this.disableExamples_ = configuration[DISABLE_EXAMPLES_CONFIG_NAME];\n\n  /** @type {Blockly.TypeDropdown} */\n  this.outputTypeSelector = null;\n\n  /**\n   * Example blocks in this modal dialog\n   * @type {!Array.<Blockly.Blocks.functional_example>}\n   * @private\n   */\n  this.exampleBlocks = [];\n\n  /**\n   * @type {Array.<Blockly.DomainEditor>}\n   * @private\n   */\n  this.domainEditors_ = [];\n\n  /**\n   * @type {?Blockly.ContractEditorSectionView}\n   * @private\n   */\n  this.contractSectionView_ = null;\n  /**\n   * @type {?Blockly.ContractEditorSectionView}\n   * @private\n   */\n  this.examplesSectionView_ = null;\n  /**\n   * @type {?Blockly.ContractEditorSectionView}\n   * @private\n   */\n  this.definitionSectionView_ = null;\n\n  /**\n   * @type {goog.structs.LinkedMap.<string,Blockly.ContractEditorSectionView>}\n   * @private\n   */\n  this.allSections_ = new goog.structs.LinkedMap();\n\n  /**\n   * Briefly set to store level configuration until after the editor\n   * is initialized and opened to further configure the editor\n   * @type {Object}\n   * @private\n   */\n  this.autoOpenConfig_ = null;\n\n  /**\n   * @returns {string}\n   * @private\n   */\n  this.testHandler_ = function (block) {\n    return \"Block ID is \" + block.id;\n  }\n\n  /**\n   * @returns {string}\n   * @private\n   */\n  this.testResetHandler_ = function () { };\n\n  this.customFailureCloseHandler_ = function () { return false; };\n\n  /**\n   * @type {Blockly.ExampleView[]}\n   * @private\n   */\n  this.exampleViews_ = [];\n};\ngoog.inherits(Blockly.ContractEditor, Blockly.FunctionEditor);\n\nBlockly.ContractEditor.EXAMPLE_BLOCK_TYPE = 'functional_example';\nBlockly.ContractEditor.EXAMPLE_BLOCK_ACTUAL_INPUT_NAME = 'ACTUAL';\n\nBlockly.ContractEditor.DEFAULT_OUTPUT_TYPE = Blockly.BlockValueType.NUMBER;\nBlockly.ContractEditor.DEFAULT_PARAMETER_TYPE = Blockly.BlockValueType.NUMBER;\n\nBlockly.ContractEditor.GRID_LINE_COLOR = '#5b6770'; // dark gray\n\nBlockly.ContractEditor.prototype.definitionBlockType = 'functional_definition';\nBlockly.ContractEditor.prototype.parameterBlockType = 'functional_parameters_get';\n\nBlockly.ContractEditor.prototype.create_ = function() {\n  Blockly.ContractEditor.superClass_.create_.call(this);\n\n  var canvasToDrawOn = this.modalBlockSpace.svgBlockCanvas_;\n\n  var sharedHighlightBox = new Blockly.SvgHighlightBox(canvasToDrawOn, {\n    color: YELLOW_HEX,\n    thickness: HIGHLIGHT_BOX_WIDTH\n  });\n\n  this.contractSectionView_ = new Blockly.ContractEditorSectionView(canvasToDrawOn,\n    {\n      sectionNumber: 1,\n      headerHeight: HEADER_HEIGHT,\n      onCollapseCallback: goog.bind(function (isNowCollapsed) {\n        // goog.ui.setElementShown toggles between \"hidden\" and \"hidden\" due to\n        // inherited properties, so set display directly instead\n        this.contractDiv_.style.display = isNowCollapsed ? 'none' : 'block';\n        this.position_();\n      }, this),\n      placeContentCallback: goog.bind(function (currentY) {\n        return currentY + this.getContractDivHeight();\n      }, this),\n      highlightBox: sharedHighlightBox,\n      headerText: \"Contract and Purpose Statement\" // TODO(bjordan): i18n,\n    }\n  );\n\n  this.hiddenExampleBlocks_ = [];\n  this.exampleAreaDiv = goog.dom.createDom('div', 'exampleAreaDiv innerModalDiv');\n  this.addExampleButton = goog.dom.createDom('button', 'exampleAreaButton btn');\n  this.addExampleButton.innerHTML = \"Add Example\";\n  Blockly.bindEvent_(this.addExampleButton, 'click', this, this.addNewExampleBlock_);\n  goog.dom.append(this.exampleAreaDiv, this.addExampleButton);\n  this.exampleAreaDiv.style.display = 'block';\n  this.exampleAreaDiv.style.position = 'absolute';\n  goog.dom.insertChildAt(this.frameClipDiv_, this.exampleAreaDiv, 0);\n\n  this.callText = goog.dom.createDom('div', 'callResultText');\n  this.callText.innerHTML = \"Call\";\n  Blockly.svgIgnoreMouseEvents(this.callText);\n  goog.dom.appendChild(this.exampleAreaDiv, this.callText);\n\n  this.resultText = goog.dom.createDom('div', 'callResultText');\n  this.resultText.innerHTML = \"Result\";\n  goog.dom.appendChild(this.exampleAreaDiv, this.resultText);\n  Blockly.svgIgnoreMouseEvents(this.resultText);\n\n  this.examplesTableGroup = Blockly.createSvgElement('g', {}, canvasToDrawOn);\n\n  this.topHorizontalLine = Blockly.createSvgElement('rect', {\n    'fill': Blockly.ContractEditor.GRID_LINE_COLOR\n  }, this.examplesTableGroup);\n  this.topHorizontalLine.setAttribute('height', 2.0);\n  Blockly.svgIgnoreMouseEvents(this.topHorizontalLine);\n\n  // TODO(bjordan): get horizontal line #X helper, lay out below examples\n\n\n  this.verticalExampleMidline = Blockly.createSvgElement('rect', {\n    'fill': Blockly.ContractEditor.GRID_LINE_COLOR\n  }, this.examplesTableGroup);\n  this.verticalExampleMidline.setAttribute('width', 2.0);\n\n  this.examplesSectionView_ = new Blockly.ContractEditorSectionView(\n    canvasToDrawOn, {\n      sectionNumber: 2,\n      headerHeight: HEADER_HEIGHT,\n      headerText: \"Examples\", // TODO(bjordan): i18n\n      placeContentCallback: this.onPlaceExampleContent.bind(this),\n      highlightBox: sharedHighlightBox,\n      onCollapseCallback: goog.bind(function (isNowCollapsed) {\n        this.exampleAreaDiv.style.display = isNowCollapsed ? 'none' : 'block';\n        this.examplesTableGroup.style.display = isNowCollapsed ? 'none' : 'block';\n        this.hiddenExampleBlocks_ = this.setBlockSubsetVisibility(\n          !isNowCollapsed, goog.bind(this.isBlockInExampleArea, this),\n          this.hiddenExampleBlocks_);\n        this.position_();\n      }, this)\n    });\n\n  this.hiddenDefinitionBlocks_ = [];\n\n  this.definitionSectionLogic_ = new Blockly.ContractDefinitionSection(canvasToDrawOn);\n  this.definitionSectionView_ = new Blockly.ContractEditorSectionView(\n    canvasToDrawOn, {\n      sectionNumber: 3,\n      headerHeight: HEADER_HEIGHT,\n      headerText: \"Definition\", /** TODO(bjordan) i18n */\n      onCollapseCallback: goog.bind(function (isNowCollapsed) {\n        this.flyout_.setVisibility(!isNowCollapsed);\n        if (!isNowCollapsed) {\n          this.refreshParamsInFlyout_();\n        }\n        this.hiddenDefinitionBlocks_ = this.setBlockSubsetVisibility(\n          !isNowCollapsed, goog.bind(this.isBlockInFunctionArea, this),\n          this.hiddenDefinitionBlocks_);\n        this.definitionSectionLogic_.handleCollapse(isNowCollapsed);\n        this.position_();\n      }, this),\n      highlightBox: sharedHighlightBox,\n      placeContentCallback: goog.bind(function (currentY) {\n        if (this.flyout_) {\n          currentY = this.positionFlyout_(currentY);\n        }\n\n        return this.definitionSectionLogic_.placeContent(currentY,\n            this.getVerticalMidlineOffset_(),\n            this.getFullWidth(),\n            this.functionDefinitionBlock);\n      }, this)\n    });\n\n  this.allSections_.set(CONTRACT_SECTION_NAME, this.contractSectionView_);\n  this.allSections_.set(EXAMPLES_SECTION_NAME, this.examplesSectionView_);\n  this.allSections_.set(DEFINITION_SECTION_NAME, this.definitionSectionView_);\n};\n\n/**\n * Auto-opens a function editor\n * String configuration parameters are either \"true\" or \"false\"\n * @param {Object} configuration - configuration for the auto-opened editor\n * @param {string} configuration.autoOpenFunction - function to auto-open\n * @param {string} configuration.contractCollapse - auto-collapse contract section\n * @param {string} configuration.contractHighlight - auto-highlight contract section\n * @param {string} configuration.examplesCollapse - auto-collapse examples section\n * @param {string} configuration.examplesHighlight - auto-highlight examples section\n * @param {string} configuration.definitionCollapse - auto-collapse definition section\n * @param {string} configuration.definitionHighlight - auto-highlight definition section\n * @override\n */\nBlockly.ContractEditor.prototype.autoOpenWithLevelConfiguration = function (configuration) {\n  this.autoOpenConfig_ = configuration;\n  Blockly.ContractEditor.superClass_.autoOpenWithLevelConfiguration.call(this, configuration);\n};\n\n/**\n * Hides a set of blocks\n * @param isVisible whether to set blocks in area visible (true) or invisible (false)\n * @param blockFilter subset of blocks to look at\n * @param hiddenBlockArray array containing currently hidden blocks\n * @returns {Array.<Blockly.Block>} newly hidden blocks if any are hidden\n */\nBlockly.ContractEditor.prototype.setBlockSubsetVisibility = function(isVisible, blockFilter, hiddenBlockArray) {\n  var nowHidden = [];\n  if (isVisible) {\n    hiddenBlockArray.forEach(function (block) {\n      block.setCurrentlyHidden(false);\n    }, this);\n  } else {\n    this.modalBlockSpace.getTopBlocks()\n      .filter(blockFilter)\n      .forEach(function (block) {\n        nowHidden.push(block);\n        block.setCurrentlyHidden(true);\n      }, this);\n  }\n  return nowHidden;\n};\n\nBlockly.ContractEditor.prototype.isBlockInFunctionArea = function (block) {\n  return this.isVisibleInEditor_(block) && !this.isBlockInExampleArea(block);\n};\n\nBlockly.ContractEditor.prototype.isBlockInExampleArea = function (block) {\n  return this.isAnExampleBlockInEditor_(block) ||\n    (block !== this.functionDefinitionBlock &&\n      this.isVisibleInEditor_(block) &&\n      block.getRelativeToSurfaceXY().y < this.getFlyoutTopPosition());\n};\n\nBlockly.ContractEditor.prototype.isVisibleInEditor_ = function (block) {\n  return block.blockSpace === this.modalBlockSpace &&\n    block.isVisible();\n};\n\nBlockly.ContractEditor.prototype.getFlyoutTopPosition = function () {\n  return (this.flyout_.getYPosition() - this.flyout_.getHeight());\n};\n\nBlockly.ContractEditor.prototype.isAnExampleBlockInEditor_ = function (block) {\n  return goog.array.contains(this.exampleBlocks, block);\n};\n\nBlockly.ContractEditor.prototype.hideAndRestoreBlocks_ = function() {\n  Blockly.ContractEditor.superClass_.hideAndRestoreBlocks_.call(this);\n  goog.array.clone(this.exampleBlocks).forEach(function(exampleBlock) {\n    this.moveToMainBlockSpace_(exampleBlock);\n  }, this);\n  goog.array.clear(this.exampleBlocks);\n  this.domainEditors_.forEach(function (editor) {\n    editor.dispose();\n  }, this);\n  goog.array.clear(this.domainEditors_);\n\n  this.outputTypeSelector.dispose();\n  this.outputTypeSelector = null;\n};\n\nBlockly.ContractEditor.prototype.openAndEditFunction = function(functionName) {\n  Blockly.ContractEditor.superClass_.openAndEditFunction.call(this, functionName);\n\n  this.addRangeEditor_();\n  this.updateFrameColorForType_(this.functionDefinitionBlock.getOutputType());\n  this.functionDefinitionBlock.setDeletable(false);\n  this.moveExampleBlocksToModal_(functionName);\n  this.setupAfterExampleBlocksAdded_();\n\n  this.position_();\n  this.resetParamIDs_();\n  this.refreshParamsEverywhere();\n};\n\nBlockly.ContractEditor.prototype.setSectionHighlighted = function (viewToHighlight) {\n  this.allSections_.forEach(function (view) {\n    view.setHighlighted(view === viewToHighlight);\n  }, this);\n};\n\nBlockly.ContractEditor.prototype.addNewExampleBlock_ = function () {\n  this.addNewExampleBlockForFunction_(this.functionDefinitionBlock);\n  this.refreshBlockInputTypes_();\n};\n\n/**\n * Adds a new example block to the editor for the given function definition\n * @private\n */\nBlockly.ContractEditor.prototype.addNewExampleBlockForFunction_ = function (functionDefinitionBlock) {\n  var createdExampleBlock = this.createExampleBlock_(functionDefinitionBlock);\n  this.addExampleBlockFromMainBlockSpace(createdExampleBlock);\n  this.position_();\n};\n\n/**\n * @param {!String} functionName function which will have its examples moved to\n *    the editor\n * @private\n */\nBlockly.ContractEditor.prototype.moveExampleBlocksToModal_ = function (functionName) {\n  var exampleBlocks = Blockly.mainBlockSpace.findFunctionExamples(functionName);\n  exampleBlocks.forEach(function(exampleBlock) {\n    this.addExampleBlockFromMainBlockSpace(exampleBlock)\n  }, this);\n};\n\n/**\n * Allows app to pass in a function that should be run against an example block\n * when user hits Test button\n * @param {function} testHandler\n */\nBlockly.ContractEditor.prototype.registerTestHandler = function(testHandler) {\n  this.testHandler_ = testHandler;\n};\n\n/**\n * Allows app to pass in a function that should be run when user resets a test\n * @param {function} testResetHandler\n */\nBlockly.ContractEditor.prototype.registerTestResetHandler = function (testResetHandler) {\n  this.testResetHandler_ = testResetHandler;\n};\n\n/**\n * Allows app to pass in a function that is called on contract editor close if\n * any examples fail. This function should return true if the app wants to own\n * closing the dialog\n * @param {function} handler\n */\nBlockly.ContractEditor.prototype.registerTestsFailedOnCloseHandler = function (handler) {\n  this.customFailureCloseHandler_ = handler;\n};\n\n/**\n * Moves a given example block to the modal blockspace.\n * @param {Blockly.Block} exampleBlock\n */\nBlockly.ContractEditor.prototype.addExampleBlockFromMainBlockSpace = function(exampleBlock) {\n  var movedExampleBlock = this.moveToModalBlockSpace(exampleBlock);\n  var functionCall = movedExampleBlock.getInputTargetBlock(\n      Blockly.ContractEditor.EXAMPLE_BLOCK_ACTUAL_INPUT_NAME);\n  functionCall.setCanDisconnectFromParent(false);\n  this.exampleBlocks.push(movedExampleBlock);\n  movedExampleBlock.blockEvents.listen(Blockly.Block.EVENTS.AFTER_DROPPED, function () {\n    // Layout our blocks, which pops this example back into its slot.\n    this.layOutBlockSpaceItems_();\n\n    // Update scrollable size now that the example is back in its spot & not\n    // extending the scrollable area.\n    this.modalBlockSpace.updateScrollableSize();\n  }.bind(this));\n  movedExampleBlock.blockEvents.listenOnce(Blockly.Block.EVENTS.AFTER_DISPOSED,\n    this.removeExampleBlock_.bind(this, movedExampleBlock), false, this);\n};\n\n/**\n * Update examples and the function definition's input types to match\n * the function definition block's type.\n * @private\n */\nBlockly.ContractEditor.prototype.refreshBlockInputTypes_ = function () {\n  this.setBlockInputsToType_(this.currentFunctionDefinitionType_());\n};\n\nBlockly.ContractEditor.prototype.setBlockInputsToType_ = function (newType) {\n  var blocksToUpdate = this.exampleBlocks.concat(this.functionDefinitionBlock);\n  blocksToUpdate.forEach(function (exampleBlock) {\n    exampleBlock.updateInputsToType(newType);\n  }, this);\n};\n\n/**\n * @returns {Blockly.BlockValueType}\n * @private\n */\nBlockly.ContractEditor.prototype.currentFunctionDefinitionType_ = function () {\n  return this.functionDefinitionBlock.outputType_;\n};\n\n/**\n * Removes the given example block from the example block list\n * @param block\n * @private\n */\nBlockly.ContractEditor.prototype.removeExampleBlock_ = function(block) {\n  goog.array.remove(this.exampleBlocks, block);\n  this.position_();\n};\n\nBlockly.ContractEditor.prototype.openWithNewVariable = function() {\n  this.openWithNewFunction(true);\n};\n\nBlockly.ContractEditor.prototype.openWithNewFunction = function(isVariable) {\n  this.ensureCreated_();\n\n  var tempFunctionDefinitionBlock = Blockly.Xml.domToBlock(Blockly.mainBlockSpace,\n    Blockly.createSvgElement('block', {type: this.definitionBlockType}));\n  tempFunctionDefinitionBlock.updateOutputType(Blockly.ContractEditor.DEFAULT_OUTPUT_TYPE);\n  tempFunctionDefinitionBlock.userCreated = true;\n\n  if (isVariable) {\n    tempFunctionDefinitionBlock.convertToVariable();\n  } else {\n    for (var i = 0; i < Blockly.defaultNumExampleBlocks; i++) {\n      this.addNewExampleBlockForFunction_(tempFunctionDefinitionBlock);\n    }\n  }\n\n  this.openAndEditFunction(tempFunctionDefinitionBlock.getTitleValue('NAME'));\n};\n\n/**\n * Creates a new example block in the main BlockSpace\n * @returns {Blockly.Block} the newly added block\n * @private\n */\nBlockly.ContractEditor.prototype.createExampleBlock_ = function (functionDefinitionBlock) {\n  var temporaryExampleBlock = Blockly.Xml.domToBlock(Blockly.mainBlockSpace,\n    Blockly.createSvgElement('block', {type: Blockly.ContractEditor.EXAMPLE_BLOCK_TYPE}));\n  var caller = Blockly.Procedures.createCallerFromDefinition(Blockly.mainBlockSpace,\n    functionDefinitionBlock);\n  temporaryExampleBlock.attachBlockToInputName(\n    caller, Blockly.ContractEditor.EXAMPLE_BLOCK_ACTUAL_INPUT_NAME);\n  return temporaryExampleBlock;\n};\n\nBlockly.ContractEditor.prototype.getFullWidth = function () {\n  return this.modalBlockSpace.getMetrics().viewWidth;\n};\n/**\n * @override\n */\nBlockly.ContractEditor.prototype.layOutBlockSpaceItems_ = function () {\n  if (!this.readyToBeLaidOut_()) {\n    return;\n  }\n\n  var fullWidth = this.getFullWidth();\n\n  var currentY = 0;\n  currentY = this.contractSectionView_.placeAndGetNewY(currentY, fullWidth);\n  currentY = this.examplesSectionView_.placeAndGetNewY(currentY, fullWidth);\n  this.definitionSectionView_.placeAndGetNewY(currentY, fullWidth);\n};\n\n/**\n * @override\n */\nBlockly.ContractEditor.prototype.createContractDom_ = function() {\n  this.contractDiv_ = goog.dom.createDom('div',\n      'blocklyToolboxDiv paramToolbox blocklyText contractEditor flyoutColorGray innerModalDiv');\n  if (Blockly.RTL) {\n    this.contractDiv_.setAttribute('dir', 'RTL');\n  }\n  this.contractDiv_.innerHTML =\n          '<div>' + Blockly.Msg.FUNCTIONAL_NAME_LABEL + '</div>'\n        + '<div><input id=\"functionNameText\" type=\"text\"></div>'\n        + '<div><span id=\"domain-label\">' + Blockly.Msg.FUNCTIONAL_DOMAIN_LABEL + '</span> <span class=\"contract-type-hint\"  id=\"domain-hint\">(the domain is the type of input)</span>' + '</div>'\n        + '<div id=\"domain-area\" style=\"margin: 0;\">'\n        + '</div>'\n        + '<div class=\"clear\" style=\"margin: 0;\"></div>'\n        + '<button id=\"paramAddButton\" class=\"btn\">' + 'Add Domain' + '</button>'\n        + '<div class=\"clear\" style=\"margin: 0;\"></div>'\n        + '<div id=\"range-area\" style=\"margin: 0;\">'\n          + '<div>'\n            +'<span id=\"outputTypeTitle\">' + Blockly.Msg.FUNCTIONAL_RANGE_LABEL + '</span>'\n            +' '\n            +'<span class=\"contract-type-hint\" id=\"range-hint\">(the range is the type of output)</span>'\n          + '</div>'\n          + '<span id=\"outputTypeDropdown\"></span>'\n        + '</div>'\n        + '<div id=\"description-area\" style=\"margin: 0px;\">'\n          + '<div>' + Blockly.Msg.FUNCTIONAL_DESCRIPTION_LABEL + '</div>'\n          + '<div><textarea id=\"functionDescriptionText\" rows=\"2\"></textarea></div>'\n        + '</div>';\n  var metrics = this.modalBlockSpace.getMetrics();\n  this.contractDiv_.style.left = metrics.absoluteLeft + 'px';\n  this.contractDiv_.style.top = metrics.absoluteTop + 'px';\n  this.contractDiv_.style.width = metrics.viewWidth + 'px';\n  this.contractDiv_.style.display = 'block';\n  this.frameClipDiv_ = this.createFrameClipDiv_();\n  this.frameClipDiv_.insertBefore(this.contractDiv_, this.frameClipDiv_.firstChild);\n  this.container_.insertBefore(this.frameClipDiv_, this.container_.firstChild);\n  this.initializeAddButton_();\n};\n\n/**\n * Contract editor uses custom parameter editing area.\n * Don't create parameter editing DOM.\n * @override\n */\nBlockly.ContractEditor.prototype.createParameterEditor_ = function () {\n};\n\n/**\n * Contract editor uses custom parameter editing area.\n * Don't attach event handlers.\n * @override\n */\nBlockly.ContractEditor.prototype.bindToolboxHandlers_ = function () {\n};\n\nBlockly.ContractEditor.prototype.chromeBottomToContractDivDistance_ = function () {\n  return (this.isShowingHeaders_() ? HEADER_HEIGHT : 0);\n};\n\nBlockly.ContractEditor.prototype.getContractDomTopY_ = function () {\n  return this.chromeBottomToContractDivDistance_()\n    + this.modalBlockSpace.yOffsetFromView;\n};\n\n/**\n * @override\n */\nBlockly.ContractEditor.prototype.setupUIForBlock_ = function(targetFunctionDefinitionBlock) {\n  var isEditingVariable = targetFunctionDefinitionBlock.isVariable();\n  this.frameText_.textContent =\n    isEditingVariable ?\n      Blockly.Msg.FUNCTIONAL_VARIABLE_HEADER :\n      Blockly.Msg.CONTRACT_EDITOR_HEADER;\n  goog.dom.setTextContent(goog.dom.getElement('outputTypeTitle'),\n    isEditingVariable ? Blockly.Msg.FUNCTIONAL_VARIABLE_TYPE : Blockly.Msg.FUNCTIONAL_RANGE_LABEL);\n  goog.style.setElementShown(goog.dom.getElement('domain-area'), !isEditingVariable);\n  goog.style.setElementShown(goog.dom.getElement('domain-label'), !isEditingVariable);\n  goog.style.setElementShown(goog.dom.getElement('paramAddButton'), !isEditingVariable);\n  goog.style.setElementShown(goog.dom.getElement('description-area'), !isEditingVariable);\n  goog.style.setElementShown(goog.dom.getElement('range-hint'), !isEditingVariable);\n  goog.style.setElementShown(goog.dom.getElement('domain-hint'), !isEditingVariable);\n};\n\nBlockly.ContractEditor.prototype.setupAfterExampleBlocksAdded_ = function() {\n  this.refreshBlockInputTypes_();\n\n  var isEditingVariable = this.functionDefinitionBlock.isVariable();\n\n  if (isEditingVariable) {\n    this.setupSectionsForVariable_();\n  } else {\n    this.setupSectionsForContract_(this.autoOpenConfig_);\n  }\n\n  this.autoOpenConfig_ = null;\n};\n\nBlockly.ContractEditor.prototype.setupSectionsForVariable_ = function () {\n  this.contractSectionView_.setHidden(false);\n  this.contractSectionView_.setHeaderVisible(false);\n\n  this.examplesSectionView_.setHidden(true);\n\n  this.definitionSectionView_.setHidden(false);\n  this.definitionSectionView_.setHeaderVisible(false);\n};\n\nBlockly.ContractEditor.prototype.setupSectionsForContract_ = function (autoOpenConfig) {\n  this.allSections_.forEach(function (sectionView, sectionName) {\n    if (autoOpenConfig) {\n      var shouldHighlight = autoOpenConfig[sectionName + HIGHLIGHT_CONFIG_SUFFIX];\n      if (shouldHighlight) {\n        this.setSectionHighlighted(sectionView);\n      }\n      var shouldCollapse = autoOpenConfig[sectionName + COLLAPSE_CONFIG_SUFFIX];\n      sectionView.setCollapsed(shouldCollapse);\n    } else {\n      sectionView.setHighlighted(false);\n      sectionView.setHidden(false);\n      sectionView.setHeaderVisible(true);\n      sectionView.setCollapsed(sectionView.isCollapsed()); // refresh\n    }\n  }, this);\n\n  if (this.disableExamples_) {\n    this.contractSectionView_.removeSectionNumber();\n    this.definitionSectionView_.removeSectionNumber();\n    this.examplesSectionView_.setHidden(true);\n  }\n};\n\nBlockly.ContractEditor.prototype.isShowingHeaders_ = function () {\n  return !this.isEditingVariable();\n};\n\nBlockly.ContractEditor.prototype.isEditingVariable = function() {\n  return this.functionDefinitionBlock && this.functionDefinitionBlock.isVariable();\n};\n\n/**\n * Add a new parameter block to the toolbox (and set an output type mutation on it)\n * @param {String} newParameterName\n * @param {?String} opt_newParameterType\n * @override\n */\nBlockly.ContractEditor.prototype.addParameter = function(newParameterName, opt_newParameterType) {\n  var newParameterID = goog.events.getUniqueId('parameter');\n  this.orderedParamIDsToBlocks_.set(newParameterID,\n    this.newParameterBlock(newParameterName, opt_newParameterType));\n  this.addDomainEditorForParamID_(newParameterID);\n};\n\nBlockly.ContractEditor.prototype.addDomainEditorForParamID_ = function(paramID) {\n  var paramInfo = this.getParamNameType(paramID);\n  var name = paramInfo.name;\n  var type = paramInfo.type;\n\n  var domainEditor = new Blockly.DomainEditor({\n    paramID: paramID,\n    name: name,\n    type: type,\n    onRemovePress: goog.bind(this.removeContractParameter_, this, paramID),\n    onTypeChanged: goog.bind(this.changeParameterType_, this, paramID),\n    onNameChanged: goog.bind(this.changeParameterName_, this, paramID),\n    typeChoices: USER_TYPE_CHOICES\n  });\n  domainEditor.render(goog.dom.getElement('domain-area'));\n  this.domainEditors_.push(domainEditor);\n};\n\n/**\n * Delete the given parameter, destroying its editor and any usages.\n * @param {string} paramID - unique parameter ID\n * @private\n */\nBlockly.ContractEditor.prototype.removeContractParameter_ = function(paramID) {\n  this.orderedParamIDsToBlocks_.remove(paramID);\n  this.refreshParamsEverywhere();\n\n  goog.array.removeIf(this.domainEditors_, function (editor) {\n    if (editor.getParamID() === paramID) {\n      editor.dispose();\n      return true;\n    }\n    return false;\n  }, this);\n\n  this.position_();\n};\n\nBlockly.ContractEditor.prototype.newParameterBlock = function(newParameterName, opt_newParameterType) {\n  opt_newParameterType = opt_newParameterType || Blockly.ContractEditor.DEFAULT_PARAMETER_TYPE;\n  var newParamBlockDOM = Blockly.createSvgElement('block', {type: this.parameterBlockType});\n  var title = Blockly.createSvgElement('title', {name: 'VAR'}, newParamBlockDOM);\n  title.textContent = newParameterName;\n  if (opt_newParameterType) {\n    var mutation = Blockly.createSvgElement('mutation', {}, newParamBlockDOM);\n    var outputType = Blockly.createSvgElement('outputtype', {}, mutation);\n    outputType.textContent = opt_newParameterType;\n  }\n  return newParamBlockDOM;\n};\n\n/** @override */\nBlockly.ContractEditor.prototype.addParamsFromProcedure_ = function() {\n  var procedureInfo = this.functionDefinitionBlock.getProcedureInfo();\n  for (var i = 0; i < procedureInfo.parameterNames.length; i++) {\n    this.addParameter(procedureInfo.parameterNames[i], procedureInfo.parameterTypes[i]);\n  }\n};\n\nBlockly.ContractEditor.prototype.addRangeEditor_ = function() {\n  this.outputTypeSelector = new Blockly.TypeDropdown({\n    onTypeChanged: goog.bind(this.outputTypeChanged_, this),\n    typeChoices: USER_TYPE_CHOICES,\n    type: this.functionDefinitionBlock.getOutputType() || Blockly.ContractEditor.DEFAULT_OUTPUT_TYPE\n  });\n  this.outputTypeSelector.render(this.getOutputTypeDropdownElement_());\n};\n\n/**\n * @param {Blockly.BlockValueType} newType\n * @private\n */\nBlockly.ContractEditor.prototype.outputTypeChanged_ = function (newType) {\n  this.updateFrameColorForType_(newType);\n  if (this.functionDefinitionBlock) {\n    // avoid disconnection during type change by allowing any type temporarily\n    this.setBlockInputsToType_(Blockly.BlockValueType.NONE);\n    this.functionDefinitionBlock.updateOutputType(newType);\n    this.modalBlockSpace.events.dispatchEvent(Blockly.BlockSpace.EVENTS.BLOCK_SPACE_CHANGE);\n    this.refreshBlockInputTypes_();\n    this.modalBlockSpace.events.dispatchEvent(Blockly.BlockSpace.EVENTS.BLOCK_SPACE_CHANGE);\n  }\n};\n\nBlockly.ContractEditor.prototype.updateFrameColorForType_ = function (newType) {\n  var newColorHSV = Blockly.FunctionalTypeColors[newType];\n  var newColorHex = goog.color.hsvToHex(newColorHSV[0], newColorHSV[1], newColorHSV[2] * 255)\n  this.setFrameColor_(newColorHex);\n  this.allSections_.forEach(function (sectionView, sectionName) {\n    sectionView.setHeaderColor(newColorHex);\n  }, this);\n};\n\nBlockly.ContractEditor.prototype.setFrameColor_ = function (newColorHex) {\n  this.frameBase_.style.fill = newColorHex;\n};\n\nBlockly.ContractEditor.prototype.getOutputTypeDropdownElement_ = function () {\n  return goog.dom.getElement('outputTypeDropdown');\n};\n\nBlockly.ContractEditor.prototype.initializeAddButton_ = function() {\n  var paramAddButton = goog.dom.getElement('paramAddButton');\n  Blockly.bindEvent_(paramAddButton, 'mousedown', this, goog.bind(function () {\n    this.addParameter(Blockly.Variables.generateUniqueName());\n    this.refreshParamsEverywhere();\n  }, this));\n};\n\nBlockly.ContractEditor.prototype.changeParameterType_ = function(paramID, newType) {\n  var paramName = this.getParamNameType(paramID).name;\n  this.functionDefinitionBlock.changeParamType(paramName, newType);\n  this.changeParameterTypeInFlyoutXML(paramName, newType);\n  this.refreshParamsEverywhere()\n};\n\nBlockly.ContractEditor.prototype.changeParameterName_ = function(paramID, newName) {\n  var paramInfo = this.getParamNameType(paramID);\n  var oldName = paramInfo.name;\n\n  Blockly.Variables.renameVariable(oldName, newName, Blockly.modalBlockSpace)\n};\n\n/**\n * Returns the x offset for the vertical midline (w.r.t. the left side of the drawing\n * canvas).\n * @return {number}\n * @private\n */\nBlockly.ContractEditor.prototype.getVerticalMidlineOffset_ = function () {\n  return EXAMPLE_BLOCK_MARGIN_LEFT +\n      this.getMaxExampleCallBlockWidth_() +\n      MARGIN_BLOCK_TO_CALL_SLOT;\n};\n\n/**\n * Go through each of our example blocks and figure out which is widest\n * @return {number}\n */\nBlockly.ContractEditor.prototype.getMaxExampleCallBlockWidth_ = function () {\n  return this.exampleBlocks.reduce(function (previousMax, block) {\n    var functionCallBlock = block.getInputTargetBlock(\n      Blockly.ContractEditor.EXAMPLE_BLOCK_ACTUAL_INPUT_NAME);\n    if (!functionCallBlock) {\n      return previousMax;\n    }\n    var width = functionCallBlock.getHeightWidth().width;\n    return Math.max(previousMax, width);\n  }, DEFAULT_EXAMPLE_CALL_SECTION_WIDTH);\n};\n\n/**\n * Call reset on each of our views\n */\nBlockly.ContractEditor.prototype.resetExampleViews = function () {\n  this.exampleViews_.forEach(function (exampleView) {\n    exampleView.reset();\n  });\n};\n\n/**\n * Call our app-specific test handler for this block\n * @param {Blockly.Block} block\n * @param {boolean} visualize True if app should visualize the test\n * @return {string} Result failure, or null if no failure\n */\nBlockly.ContractEditor.prototype.testExample = function (block, visualize) {\n  var testHandlerResult = this.testHandler_(block, visualize);\n\n  var definitionInput = this.functionDefinitionBlock.getInput('STACK');\n  var definitionIsFilled = definitionInput.connection.isConnected();\n\n  return definitionIsFilled ? testHandlerResult :\n      Blockly.Msg.DEFINE_FUNCTION_FOR_EXAMPLE;\n};\n\n/**\n * Call our app-specific test reset handler for this block\n * @param {Blockly.Block} block\n */\nBlockly.ContractEditor.prototype.resetExample = function (block) {\n  this.testResetHandler_(block);\n};\n\nBlockly.ContractEditor.prototype.updateExampleResult = function (block, failure) {\n  this.exampleViews_.some(function (view) {\n    if (view.getBlock() === block) {\n      view.setResult(failure);\n      // Return true so that we stop looking for a matching view\n      return true;\n    }\n  });\n};\n\n/**\n * Handle example content being placed.\n * @param {number} currentY Current y location\n * @returns {number} Updated y location\n */\nBlockly.ContractEditor.prototype.onPlaceExampleContent = function (currentY) {\n  var maxWidth = this.getMaxExampleCallBlockWidth_();\n\n  var metrics = this.modalBlockSpace.getMetrics();\n\n  var exampleDivTop = currentY;\n  this.exampleAreaDiv.style.left = this.modalBlockSpace.xOffsetFromView + 'px';\n  this.exampleAreaDiv.style.top = this.modalBlockSpace.yOffsetFromView + currentY + 'px';\n  this.exampleAreaDiv.style.width = metrics.viewWidth + 'px';\n\n  var blockSplitMargin = (EXAMPLE_BLOCK_SECTION_MAGIN_BELOW / 2);\n\n  var newY = currentY;\n\n  var verticalMidlineOffset = this.getVerticalMidlineOffset_();\n\n  var verticalMidlineY = newY;\n  this.verticalExampleMidline.setAttribute('transform',\n    'translate(' + verticalMidlineOffset + ',' + newY + ')');\n\n  var exampleSectionVisible = this.exampleBlocks.length > 0;\n  if (exampleSectionVisible) {\n    newY += blockSplitMargin;\n\n    this.callText.style.top = newY - exampleDivTop + 'px';\n    this.callText.style.left = EXAMPLE_BLOCK_MARGIN_LEFT + 'px';\n\n    this.resultText.style.top = newY - exampleDivTop + 'px';\n    this.resultText.style.left = verticalMidlineOffset +\n      EXAMPLE_BLOCK_MARGIN_LEFT + 'px';\n\n    newY += this.callText.offsetHeight;\n\n    newY += blockSplitMargin;\n\n    this.topHorizontalLine.setAttribute('transform',\n      'translate(' + 0 + ',' + newY + ')');\n    this.topHorizontalLine.setAttribute('width', this.getFullWidth());\n\n    this.exampleBlocks.forEach(goog.bind(function (block, index) {\n      var canReuse = this.exampleViews_.length > index;\n      if (!canReuse) {\n        var newExampleView = new Blockly.ExampleView(this.exampleAreaDiv,\n            this.examplesTableGroup, this);\n        this.exampleViews_.push(newExampleView);\n      }\n      newY = this.exampleViews_[index].placeExampleAndGetNewY(block, newY,\n        maxWidth, EXAMPLE_BLOCK_MARGIN_LEFT, EXAMPLE_BLOCK_MARGIN_BELOW,\n        this.getFullWidth(), verticalMidlineOffset, exampleDivTop);\n    }, this));\n  }\n\n  for (var j = this.exampleBlocks.length; j < this.exampleViews_.length; j++) {\n    this.exampleViews_[j].dispose();\n  }\n  this.exampleViews_.length = this.exampleBlocks.length;\n\n  this.verticalExampleMidline.style.display = exampleSectionVisible ? 'block' : 'none';\n  this.topHorizontalLine.style.display = exampleSectionVisible ? 'block' : 'none';\n  this.callText.style.display = exampleSectionVisible ? 'block' : 'none';\n  this.resultText.style.display = exampleSectionVisible ? 'block' : 'none';\n\n  this.verticalExampleMidline.setAttribute('height', newY - verticalMidlineY);\n\n  newY += blockSplitMargin;\n\n  this.addExampleButton.style.top = newY - exampleDivTop + 'px';\n  this.addExampleButton.style.left = EXAMPLE_BLOCK_MARGIN_LEFT + 'px';\n  newY += this.addExampleButton.offsetHeight;\n  newY += EXAMPLE_BLOCK_SECTION_MAGIN_BELOW;\n\n  this.exampleAreaDiv.style.height = (newY - currentY) + 'px';\n\n  return newY;\n};\n\nBlockly.ContractEditor.prototype.onClose = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n  var allPass = true;\n  this.exampleViews_.forEach(function (view) {\n    var failure = this.testExample(view.getBlock(), false);\n    view.setResult(failure);\n    view.refreshTestingUI(false);\n    allPass = allPass && !failure;\n  }.bind(this));\n  if (!allPass && this.customFailureCloseHandler_()) {\n    // app has taken responsibilty for closing dialog (likely by launching\n    // modal confirm dialog\n    return;\n  }\n\n  this.hideIfOpen();\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Utility functions for generating executable code from\n * Blockly code.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.CodeGenerator');\ngoog.provide('Blockly.Generator');\n\ngoog.require('Blockly.Block');\n\n\n/**\n * Name space for the generator singleton.\n */\nBlockly.Generator = {};\n\n/**\n * Category to separate generated function names from variables and procedures.\n */\nBlockly.Generator.NAME_TYPE = 'generated_function';\n\n/**\n * Database of code generators, one for each language.\n */\nBlockly.Generator.languages = {};\n\n/**\n * Return the code generator for the specified language.  Create one if needed.\n * @param {string} name The language's name.\n * @return {!Blockly.CodeGenerator} Generator for this language.\n */\nBlockly.Generator.get = function(name) {\n  if (!(name in Blockly.Generator.languages)) {\n    var generator = new Blockly.CodeGenerator(name);\n    Blockly.Generator.languages[name] = generator;\n  }\n  return Blockly.Generator.languages[name];\n};\n\n/**\n * Generate code for all blocks in the blockSpace to the specified language.\n * @param {string} name Language name (e.g. 'JavaScript').\n * @param {array} blocks Return code under blocks in this array.\n * @param {boolean} opt_showHidden Whether or not to show non-user visible\n *   blocks, defaults to true. Nested blocks always inherit visibility.\n * @return {string} Generated code.\n */\nBlockly.Generator.blocksToCode = function(name, blocks, opt_showHidden) {\n  var code = [];\n  var generator = Blockly.Generator.get(name);\n  generator.init(blocks);\n  for (var x = 0, block; block = blocks[x]; x++) {\n    var line = generator.blockToCode(block, opt_showHidden);\n    if (line instanceof Array) {\n      // Value blocks return tuples of code and operator order.\n      // Top-level blocks don't care about operator order.\n      line = line[0];\n    }\n    if (line) {\n      if (block.outputConnection && generator.scrubNakedValue) {\n        // This block is a naked value.  Ask the language's code generator if\n        // it wants to append a semicolon, or something.\n        line = generator.scrubNakedValue(line);\n      }\n\n      if (block.isUnused()) {\n        line = \"/*\\n\" + line + \"*/\\n\";\n      }\n      code.push(line);\n    }\n  }\n  code = code.join('\\n');  // Blank line between each section.\n  code = generator.finish(code);\n  // Final scrubbing of whitespace.\n  code = code.replace(/^\\s+\\n/, '');\n  code = code.replace(/\\n\\s+$/, '\\n');\n  code = code.replace(/[ \\t]+\\n/g, '\\n');\n  return code;\n};\n\n/**\n * Generate code for all blocks defined by the given xml.\n * @see Blockly.Generator.xmlToBlocks\n * @param {string} name Language name (e.g. 'JavaScript').\n * @param {!Element} xml XML block\n *   blocks, defaults to true. Nested blocks always inherit visibility.\n * @return {string} Generated code.\n */\nBlockly.Generator.xmlToCode = function(name, xml) {\n  var blocks = Blockly.Generator.xmlToBlocks(name, xml);\n  return Blockly.Generator.blocksToCode(name, blocks);\n};\n\n/**\n * Generate all blocks defined by the given xml. Creates a\n * temporary readOnly BlockSpace to load the blocks into.\n * @param {string} name Language name (e.g. 'JavaScript').\n * @param {!Element} xml XML block\n *   blocks, defaults to true. Nested blocks always inherit visibility.\n * @return {string} Generated code.\n */\nBlockly.Generator.xmlToBlocks = function(name, xml) {\n  var div = document.createElement('div');\n  var blockSpace = Blockly.BlockSpace.createReadOnlyBlockSpace(div, xml, {\n    disableEventBindings: true,\n  });\n  return blockSpace.getTopBlocks(true);\n};\n\n/**\n * Generate code for all blocks in the blockSpace to the specified language.\n * @param {string} name Language name (e.g. 'JavaScript').\n * @param {?string|Array.<string>} opt_typeFilter Only return code under top\n *   blocks of this type (or list of types).\n * @param {boolean} opt_showHidden Whether or not to show non-user visible\n *   blocks, defaults to true. Nested blocks always inherit visibility.\n * @return {string} Generated code.\n */\nBlockly.Generator.blockSpaceToCode = function(name, opt_typeFilter, opt_showHidden) {\n  var blocksToGenerate;\n  if (opt_typeFilter) {\n    if (typeof opt_typeFilter == 'string') {\n      opt_typeFilter = [opt_typeFilter];\n    }\n    blocksToGenerate =\n      goog.array.filter(Blockly.mainBlockSpace.getTopBlocks(true), function(block) {\n        return goog.array.contains(opt_typeFilter, block.type);\n      }, this);\n  } else {\n    // Generate all top blocks.\n    blocksToGenerate = Blockly.mainBlockSpace.getTopBlocks(true);\n  }\n  return Blockly.Generator.blocksToCode(name, blocksToGenerate, opt_showHidden);\n};\n\n// The following are some helpful functions which can be used by multiple\n// languages.\n\n/**\n * Prepend a common prefix onto each line of code.\n * @param {string} text The lines of code.\n * @param {string} prefix The common prefix.\n * @return {string} The prefixed lines of code.\n */\nBlockly.Generator.prefixLines = function(text, prefix) {\n  return prefix + text.replace(/\\n(.)/g, '\\n' + prefix + '$1');\n};\n\n/**\n * Class for a code generator that translates the blocks into a language.\n * @param {string} name Language name of this generator.\n * @constructor\n */\nBlockly.CodeGenerator = function(name) {\n  this.name_ = name;\n  this.RESERVED_WORDS_ = '';\n};\n\n/**\n * Generate code for the specified block (and attached blocks).\n * @param {Blockly.Block} block The block to generate code for.\n * @param {boolean} opt_showHidden Whether or not to show non-user visible\n *     blocks, defaults to true. Nested blocks always inherit visibility.\n * @return {string|!Array} For statement blocks, the generated code.\n *     For value blocks, an array containing the generated code and an\n *     operator order value.  Returns '' if block is null.\n */\nBlockly.CodeGenerator.prototype.blockToCode = function(block, opt_showHidden) {\n  if (!block) {\n    return '';\n  }\n  var showHidden = opt_showHidden == undefined ? true : opt_showHidden;\n  if (block.disabled || (!showHidden && !block.isUserVisible())) {\n    // Skip past this block if it is disabled or hidden.\n    var nextBlock = block.nextConnection && block.nextConnection.targetBlock();\n    return this.blockToCode(nextBlock, opt_showHidden);\n  }\n\n  var func = this[block.type];\n  if (!func) {\n    return Blockly.Generator.prefixLines('Unknown block: ' + block.type + '\\n', '// ');\n  }\n  var code = func.call(block);\n\n  if (code instanceof Array) {\n    // Value blocks return tuples of code and operator order.\n    return [this.scrub_(block, code[0], opt_showHidden), code[1]];\n  } else {\n    return this.scrub_(block, code, opt_showHidden);\n  }\n};\n\n/**\n * Generate code representing the specified value input.\n * @param {!Blockly.Block} block The block containing the input.\n * @param {string} name The name of the input.\n * @param {number} order The maximum binding strength (minimum order value)\n *     of any operators adjacent to \"block\".\n * @return {string} Generated code or '' if no blocks are connected or the\n *     specified input does not exist.\n */\nBlockly.CodeGenerator.prototype.valueToCode = function(block, name, order) {\n  if (isNaN(order)) {\n    throw 'Expecting valid order from block \"' + block.type + '\".';\n  }\n  var targetBlock = block.getInputTargetBlock(name);\n  if (!targetBlock) {\n    return '';\n  }\n  var tuple = this.blockToCode(targetBlock);\n  if (tuple === '') {\n    // Disabled block.\n    return '';\n  }\n  if (!(tuple instanceof Array)) {\n    // Value blocks must return code and order of operations info.\n    // Statement blocks must only return code.\n    throw 'Expecting tuple from value block \"' + targetBlock.type + '\".';\n  }\n  var code = tuple[0];\n  var innerOrder = tuple[1];\n  if (isNaN(innerOrder)) {\n    throw 'Expecting valid order from value block \"' + targetBlock.type + '\".';\n  }\n  if (code && order <= innerOrder) {\n    // The operators outside this code are stonger than the operators\n    // inside this code.  To prevent the code from being pulled apart,\n    // wrap the code in parentheses.\n    // Technically, this should be handled on a language-by-language basis.\n    // However all known (sane) languages use parentheses for grouping.\n    code = '(' + code + ')';\n  }\n  return code;\n};\n\n/**\n * Generate code representing the statement.  Indent the code.\n * @param {!Blockly.Block} block The block containing the input.\n * @param {string} name The name of the input.\n * @return {string} Generated code or '' if no blocks are connected.\n */\nBlockly.CodeGenerator.prototype.statementToCode = function(block, name) {\n  var targetBlock = block.getInputTargetBlock(name);\n  var code = this.blockToCode(targetBlock);\n  if (!goog.isString(code)) {\n    // Value blocks must return code and order of operations info.\n    // Statement blocks must only return code.\n    throw 'Expecting code from statement block \"' + targetBlock.type + '\".';\n  }\n  if (code) {\n    code = Blockly.Generator.prefixLines(/** @type {string} */ (code), '  ');\n  }\n  return code;\n};\n\n/**\n * Add one or more words to the list of reserved words for this language.\n * @param {string} words Comma-separated list of words to add to the list.\n *     No spaces.  Duplicates are ok.\n */\nBlockly.CodeGenerator.prototype.addReservedWords = function(words) {\n  this.RESERVED_WORDS_ += words + ',';\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Utility functions for handling variables and procedure names.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Names');\n\n\n/**\n * Class for a database of entity names (variables, functions, etc).\n * @param {string} reservedWords A comma-separated string of words that are\n *     illegal for use as names in a language (e.g. 'new,if,this,...').\n * @constructor\n */\nBlockly.Names = function(reservedWords) {\n  this.reservedDict_ = {};\n  if (reservedWords) {\n    var splitWords = reservedWords.split(',');\n    for (var x = 0; x < splitWords.length; x++) {\n      this.reservedDict_[Blockly.Names.PREFIX_ + splitWords[x]] = true;\n    }\n  }\n  this.reset();\n};\n\n/**\n * When JavaScript (or most other languages) is generated, variable 'foo' and\n * procedure 'foo' would collide.  However, Blockly has no such problems since\n * variable get 'foo' and procedure call 'foo' are unambiguous.\n * Therefore, Blockly keeps a separate type name to disambiguate.\n * getName('foo', 'variable') -> 'foo'\n * getName('foo', 'procedure') -> 'foo2'\n */\n\n/**\n * JavaScript doesn't have a true hashtable, it uses object properties.\n * Since even clean objects have a few properties, prepend this prefix onto\n * names so that they don't collide with any builtins.\n * @const\n * @private\n */\nBlockly.Names.PREFIX_ = '$_';\n\n/**\n * Empty the database and start from scratch.  The reserved words are kept.\n */\nBlockly.Names.prototype.reset = function() {\n  this.db_ = {};\n  this.dbSpecificType_ = {};\n  this.dbReverse_ = {};\n};\n\n/**\n * Convert a Blockly entity name to a legal exportable entity name.\n * @param {string} name The Blockly entity name (no constraints).\n * @param {string} type The type of entity in Blockly\n *     ('VARIABLE', 'PROCEDURE', 'BUILTIN', etc...).\n * @param {string} specificType Optional specific type of entity in Blockly\n *     (e.g. 'LOCALVARIABLE').\n * @return {string} An entity name legal for the exported language.\n */\nBlockly.Names.prototype.getName = function(name, type, specificType) {\n  var normalized = Blockly.Names.PREFIX_ + name.toLowerCase() + '_' + type;\n  if (normalized in this.db_) {\n    return this.db_[normalized];\n  }\n  var safeName = this.getDistinctName(name, type);\n  this.db_[normalized] = safeName;\n  if (specificType) {\n    this.dbSpecificType_[normalized] = specificType;\n  }\n  return safeName;\n};\n\n/**\n * Check to see if a Blockly entity name exists with a specificType.\n * @param {string} name The Blockly entity name (no constraints).\n * @param {string} type The type of entity in Blockly\n *     ('VARIABLE', 'PROCEDURE', 'BUILTIN', etc...).\n * @param {string} type The specificType of entity in Blockly\n *     (e.g. 'LOCALVARIABLE').\n * @return {boolean} true if the entity names exists with the same specificType.\n */\nBlockly.Names.prototype.checkSpecificType = function(name, type, specificType) {\n  var normalized = Blockly.Names.PREFIX_ + name.toLowerCase() + '_' + type;\n  return (normalized in this.dbSpecificType_ &&\n          this.dbSpecificType_[normalized] === specificType);\n};\n\n/**\n * Convert a Blockly entity name to a legal exportable entity name.\n * Ensure that this is a new name not overlapping any previously defined name.\n * Also check against list of reserved words for the current language and\n * ensure name doesn't collide.\n * @param {string} name The Blockly entity name (no constraints).\n * @param {string} type The type of entity in Blockly\n *     ('VARIABLE', 'PROCEDURE', 'BUILTIN', etc...).\n * @return {string} An entity name legal for the exported language.\n */\nBlockly.Names.prototype.getDistinctName = function(name, type) {\n  var safeName = this.safeName_(name);\n  var i = '';\n  while (this.dbReverse_[Blockly.Names.PREFIX_ + safeName + i] ||\n      (Blockly.Names.PREFIX_ + safeName + i) in this.reservedDict_) {\n    // Collision with existing name.  Create a unique name.\n    i = i ? i + 1 : 2;\n  }\n  safeName += i;\n  this.dbReverse_[Blockly.Names.PREFIX_ + safeName] = true;\n  return safeName;\n};\n\n/**\n * Given a proposed entity name, generate a name that conforms to the\n * [_A-Za-z][_A-Za-z0-9]* format that most languages consider legal for\n * variables.\n * @param {string} name Potentially illegal entity name.\n * @return {string} Safe entity name.\n * @private\n */\nBlockly.Names.prototype.safeName_ = function(name) {\n  if (!name) {\n    name = 'unnamed';\n  } else {\n    // Unfortunately names in non-latin characters will look like\n    // _E9_9F_B3_E4_B9_90 which is pretty meaningless.\n    // name = encodeURI(name.replace(/ /g, '_')).replace(/[^\\w]/g, '_');\n    name = name.replace(/ /g, '_');\n    // Most languages don't allow names with leading numbers.\n    if ('0123456789'.indexOf(name[0]) != -1) {\n      name = 'my_' + name;\n    }\n  }\n  return name;\n};\n\n/**\n * Do the given two entity names refer to the same entity?\n * Blockly names are case-insensitive.\n * @param {string} name1 First name.\n * @param {string} name2 Second name.\n * @return {boolean} True if names are the same.\n */\nBlockly.Names.equals = function(name1, name2) {\n  return name1.toLowerCase() == name2.toLowerCase();\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Utility functions for handling procedures.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Procedures');\n\n// TODO(scr): Fix circular dependencies\n// goog.require('Blockly.Block');\ngoog.require('Blockly.FieldVariable');\ngoog.require('Blockly.Names');\ngoog.require('Blockly.BlockSpace');\ngoog.require('goog.events');\n\n\n/** Flyout category to separate procedure names from variables and generated functions. */\nBlockly.Procedures.NAME_TYPE = 'PROCEDURE';\n\n/** Flyout category type for functional variables, which are procedures under the covers */\nBlockly.Procedures.NAME_TYPE_FUNCTIONAL_VARIABLE = 'FUNCTIONAL_VARIABLE';\n\nBlockly.Procedures.DEFINITION_BLOCK_TYPES = [\n  'procedures_defnoreturn', 'procedures_defreturn', 'functional_definition'\n];\n\nBlockly.Procedures.PROCEDURAL_TO_FUNCTIONAL_CALL_TYPE = 'procedural_to_functional_call';\n\n/**\n * Find all user-created procedure definitions.\n * @return {!Array.<!Object>} Array of procedure definitions.\n *     Each procedure is defined by a procedure info object.\n */\nBlockly.Procedures.allProcedures = function() {\n  var proceduresReturn = [];\n  var proceduresNoReturn = [];\n  var proceduresFunctional = [];\n  var proceduresOther = [];\n\n  Blockly.mainBlockSpace.getAllBlocks().forEach(function(block) {\n    if (!block.getProcedureInfo) {\n      return;\n    }\n\n    var procedureInfo = block.getProcedureInfo();\n    switch (block.type) {\n      case 'functional_definition':\n        proceduresFunctional.push(procedureInfo);\n        if (Blockly.editBlocks === 'start_blocks') {\n          // Make extra procedural calls available for functional definitions in edit mode\n          var proceduralCallProcedureInfo = goog.object.clone(procedureInfo);\n          proceduralCallProcedureInfo.callType = Blockly.Procedures.PROCEDURAL_TO_FUNCTIONAL_CALL_TYPE;\n          proceduresFunctional.push(proceduralCallProcedureInfo);\n        }\n        break;\n      case 'procedures_defreturn':\n        proceduresReturn.push(procedureInfo);\n        break;\n      case 'procedures_defnoreturn':\n        proceduresNoReturn.push(procedureInfo);\n        break;\n      default:\n        proceduresOther.push(procedureInfo);\n    }\n  });\n\n  proceduresNoReturn.sort(Blockly.Procedures.procedureInfoSort_);\n  proceduresReturn.sort(Blockly.Procedures.procedureInfoSort_);\n  proceduresFunctional.sort(Blockly.Procedures.procedureInfoSort_);\n  proceduresOther.sort(Blockly.Procedures.procedureInfoSort_);\n  return goog.array.concat(proceduresNoReturn, proceduresReturn, proceduresFunctional, proceduresOther);\n};\n\n/**\n * Comparison function for case-insensitive sorting of the first element of\n * a tuple.\n * @param {!Array} ta First procedure info.\n * @param {!Array} tb Second procedure info.\n * @return {number} -1, 0, or 1 to signify greater than, equality, or less than.\n * @private\n */\nBlockly.Procedures.procedureInfoSort_ = function(ta, tb) {\n  var a = ta.name.toLowerCase();\n  var b = tb.name.toLowerCase();\n  if (a > b) {\n    return 1;\n  }\n  if (a < b) {\n    return -1;\n  }\n  return 0;\n};\n\n/**\n * Ensure two identically-named procedures don't exist.\n * @param {string} name Proposed procedure name.\n * @param {!Blockly.Block} block Block to disambiguate.\n * @return {string} Non-colliding name.\n */\nBlockly.Procedures.findLegalName = function(name, block) {\n  if (block.isInFlyout) {\n    // Flyouts can have multiple procedures called 'procedure'.\n    return name;\n  }\n  var newName = name;\n  while (!Blockly.Procedures.isLegalName(newName, block.blockSpace, block)) {\n    // Collision with another procedure.\n    var matchResult = newName.match(/^(.*?)(\\d+)$/);\n    if (!matchResult) {\n      newName += '2';\n    } else {\n      newName = matchResult[1] + (parseInt(matchResult[2], 10) + 1);\n    }\n  }\n  return newName;\n};\n\n/**\n * Does this procedure have a legal name?  Illegal names include names of\n * procedures already defined.\n * @param {string} name The questionable name.\n * @param {!Blockly.BlockSpace} blockSpace The blockSpace to scan for collisions.\n * @param {Blockly.Block} opt_exclude Optional block to exclude from\n *     comparisons (one doesn't want to collide with oneself).\n * @return {boolean} True if the name is legal.\n */\nBlockly.Procedures.isLegalName = function(name, blockSpace, opt_exclude) {\n  var blockExistsWithName = blockSpace.getAllBlocks()\n    .filter(function(block){ return block !== opt_exclude })\n    .some(function(block) {\n      return block.getProcedureInfo && Blockly.Names.equals(block.getProcedureInfo().name, name)\n    });\n  return !blockExistsWithName;\n};\n\n/**\n * Rename a procedure.  Called by the editable field.\n * NOTE: Requires `this` scope to be a blockly field\n * @param {string} text The proposed new name.\n * @return {string} The accepted name.\n * @this {!Blockly.FieldVariable}\n */\nBlockly.Procedures.rename = function(text) {\n  // Strip leading and trailing whitespace.  Beyond this, all names are legal.\n  text = text.replace(/^[\\s\\xa0]+|[\\s\\xa0]+$/g, '');\n\n  // Ensure two identically-named procedures don't exist.\n  text = Blockly.Procedures.findLegalName(text, this.sourceBlock_);\n  // Rename any callers.\n  var blocks = this.sourceBlock_.blockSpace.getAllBlocks().concat(\n    this.sourceBlock_.blockSpace.blockSpaceEditor.getAllFlyoutBlocks());\n  for (var x = 0; x < blocks.length; x++) {\n    var func = blocks[x].renameProcedure;\n    if (func) {\n      func.call(blocks[x], this.text_, text);\n    }\n  }\n  this.sourceBlock_.blockSpace.blockSpaceEditor.svgResize();\n  return text;\n};\n\n/**\n * Construct the blocks required by the flyout for the procedure category.\n * @param {!Array.<!Blockly.Block>} blocks List of blocks to show.\n * @param {!Array.<number>} gaps List of widths between blocks.\n * @param {number} margin Standard margin width for calculating gaps.\n * @param {!Blockly.BlockSpace} blockSpace The flyout's blockSpace.\n * @param {?Function.<Object>} opt_definitionCallFilter Optional filter with which to restrict\n *  the procedure definitions that get used to populate the call list. Takes one parameter\n *  of procedureInfo. Returning \"true\" means calls of this procedure definition\n *  will be included in the category.\n */\nBlockly.Procedures.flyoutCategory = function(blocks, gaps, margin, blockSpace, opt_procedureInfoFilter) {\n  if (!Blockly.functionEditor &&\n      !Blockly.disableProcedureAutopopulate &&\n      !Blockly.topLevelProcedureAutopopulate) {\n    if (Blockly.Blocks.procedures_defnoreturn) {\n      var block = new Blockly.Block(blockSpace, 'procedures_defnoreturn');\n      block.initSvg();\n      blocks.push(block);\n      gaps.push(margin * 2);\n    }\n    if (Blockly.Blocks.procedures_defreturn) {\n      var block = new Blockly.Block(blockSpace, 'procedures_defreturn');\n      block.initSvg();\n      blocks.push(block);\n      gaps.push(margin * 2);\n    }\n    if (Blockly.Blocks.procedures_ifreturn) {\n      var block = new Blockly.Block(blockSpace, 'procedures_ifreturn');\n      block.initSvg();\n      blocks.push(block);\n      gaps.push(margin * 2);\n    }\n    if (gaps.length) {\n      // Add slightly larger gap between system blocks and user calls.\n      gaps[gaps.length - 1] = margin * 3;\n    }\n  }\n\n  // Add available procedure call blocks\n  Blockly.Procedures.allProcedures().forEach(function(procedureDefinitionInfo) {\n    if (opt_procedureInfoFilter && !opt_procedureInfoFilter(procedureDefinitionInfo)) {\n      return;\n    }\n    var newCallBlock = Blockly.Procedures.createCallerBlock(blockSpace, procedureDefinitionInfo);\n    blocks.push(newCallBlock);\n    gaps.push(margin * 2);\n\n    if (!!Blockly.editBlocks) {\n      // Generate function passing blocks if we're level editing\n      var newPassBlock = Blockly.Procedures.createFunctionPassingBlock(blockSpace,\n        procedureDefinitionInfo);\n      blocks.push(newPassBlock);\n      gaps.push(margin * 2);\n    }\n  });\n};\n\nBlockly.Procedures.createCallerFromDefinition = function(blockSpace, definitionBlock) {\n  return Blockly.Procedures.createCallerBlock(blockSpace, definitionBlock.getProcedureInfo());\n};\n\nBlockly.Procedures.createCallerBlock = function(blockSpace, procedureDefinitionInfo) {\n  var title = procedureDefinitionInfo.callType === 'gamelab_behavior_get' ? 'VAR' : 'NAME';\n  var newCallBlock = new Blockly.Block(blockSpace, procedureDefinitionInfo.callType);\n  newCallBlock.setTitleValue(procedureDefinitionInfo.name, title);\n  var tempIds = [];\n  for (var t = 0; t < procedureDefinitionInfo.parameterNames.length; t++) {\n    tempIds[t] = 'ARG' + t;\n  }\n  newCallBlock.setProcedureParameters(\n    procedureDefinitionInfo.parameterNames,\n    tempIds,\n    procedureDefinitionInfo.parameterTypes);\n  newCallBlock.initSvg();\n  return newCallBlock;\n};\n\nBlockly.Procedures.createFunctionPassingBlock = function (blockSpace, procedureDefinitionInfo) {\n  var block = new Blockly.Block(blockSpace, 'functional_pass');\n  block.setTitleValue(procedureDefinitionInfo.name, 'NAME');\n  block.initSvg();\n  return block;\n};\n\n/**\n * Find all the callers of a named procedure.\n * @param {string} name Name of procedure.\n * @param {!Blockly.BlockSpace} blockSpace The blockSpace to find callers in.\n * @return {!Array.<!Blockly.Block>} Array of caller blocks.\n */\nBlockly.Procedures.getCallers = function(name, blockSpace) {\n  return blockSpace.getAllBlocks().filter(function(block) {\n    return block.getCallName && Blockly.Names.equals(name, block.getCallName());\n  });\n};\n\n/**\n * When a procedure definition is disposed of, find and dispose of all its\n *     callers.\n * @param {string} name Name of deleted procedure definition.\n * @param {!Blockly.BlockSpace} blockSpace The blockSpace to delete callers from.\n */\nBlockly.Procedures.disposeCallers = function(name, blockSpace) {\n  Blockly.Procedures.getCallers(name, blockSpace).forEach(function(caller) {\n    caller.dispose(true, false);\n  });\n};\n\n/**\n * When a procedure definition changes its parameters, find and edit all its\n * callers.\n * @param {string} name Name of edited procedure definition.\n * @param {!Blockly.BlockSpace} blockSpace The blockSpace to delete callers from.\n * @param {!Array.<string>} paramNames Array of new parameter names.\n * @param {!Array.<string>} paramIds Array of unique parameter IDs.\n * @param {?Array.<string>} opt_typeNames Array of types for parameters\n */\nBlockly.Procedures.mutateCallers = function(name, blockSpace,\n                                            paramNames, paramIds, opt_typeNames) {\n  Blockly.Procedures.getCallers(name, blockSpace).forEach(function(caller) {\n    caller.setProcedureParameters(paramNames, paramIds, opt_typeNames);\n  }, this);\n};\n\n/**\n * Find the definition block for the named procedure.\n * @param {string} name Name of procedure.\n * @param {!Blockly.BlockSpace} blockSpace The blockSpace to search.\n * @return {Blockly.Block} The procedure definition block, or null not found.\n */\nBlockly.Procedures.getDefinition = function(name, blockSpace) {\n  return goog.array.find(blockSpace.getAllBlocks(), function(block) {\n    return block.getProcedureInfo && Blockly.Names.equals(block.getProcedureInfo().name, name);\n  });\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview CSS Object Model helper functions.\n * References:\n * - W3C: http://dev.w3.org/csswg/cssom/\n * - MSDN: http://msdn.microsoft.com/en-us/library/ms531209(VS.85).aspx.\n * TODO(user): Consider hacking page, media, etc.. to work.\n *     This would be pretty challenging. IE returns the text for any rule\n *     regardless of whether or not the media is correct or not. Firefox at\n *     least supports CSSRule.type to figure out if it's a media type and then\n *     we could do something interesting, but IE offers no way for us to tell.\n */\n\ngoog.provide('goog.cssom');\ngoog.provide('goog.cssom.CssRuleType');\n\ngoog.require('goog.array');\ngoog.require('goog.dom');\ngoog.require('goog.dom.TagName');\n\n\n/**\n * Enumeration of {@code CSSRule} types.\n * @enum {number}\n */\ngoog.cssom.CssRuleType = {\n  STYLE: 1,\n  IMPORT: 3,\n  MEDIA: 4,\n  FONT_FACE: 5,\n  PAGE: 6,\n  NAMESPACE: 7\n};\n\n\n/**\n * Recursively gets all CSS as text, optionally starting from a given\n * CSSStyleSheet.\n * @param {(CSSStyleSheet|StyleSheetList)=} opt_styleSheet The CSSStyleSheet.\n * @return {string} css text.\n */\ngoog.cssom.getAllCssText = function(opt_styleSheet) {\n  var styleSheet = opt_styleSheet || document.styleSheets;\n  return /** @type {string} */ (goog.cssom.getAllCss_(styleSheet, true));\n};\n\n\n/**\n * Recursively gets all CSSStyleRules, optionally starting from a given\n * CSSStyleSheet.\n * Note that this excludes any CSSImportRules, CSSMediaRules, etc..\n * @param {(CSSStyleSheet|StyleSheetList)=} opt_styleSheet The CSSStyleSheet.\n * @return {Array<CSSStyleRule>} A list of CSSStyleRules.\n */\ngoog.cssom.getAllCssStyleRules = function(opt_styleSheet) {\n  var styleSheet = opt_styleSheet || document.styleSheets;\n  return /** @type {!Array<CSSStyleRule>} */ (\n      goog.cssom.getAllCss_(styleSheet, false));\n};\n\n\n/**\n * Returns the CSSRules from a styleSheet.\n * Worth noting here is that IE and FF differ in terms of what they will return.\n * Firefox will return styleSheet.cssRules, which includes ImportRules and\n * anything which implements the CSSRules interface. IE returns simply a list of\n * CSSRules.\n * @param {CSSStyleSheet} styleSheet The CSSStyleSheet.\n * @throws {Error} If we cannot access the rules on a stylesheet object - this\n *     can  happen if a stylesheet object's rules are accessed before the rules\n *     have been downloaded and parsed and are \"ready\".\n * @return {CSSRuleList} An array of CSSRules or null.\n */\ngoog.cssom.getCssRulesFromStyleSheet = function(styleSheet) {\n  var cssRuleList = null;\n  try {\n    // Select cssRules unless it isn't present.  For pre-IE9 IE, use the rules\n    // collection instead.\n    // It's important to be consistent in using only the W3C or IE apis on\n    // IE9+ where both are present to ensure that there is no indexing\n    // mismatches - the collections are subtly different in what the include or\n    // exclude which can lead to one collection being longer than the other\n    // depending on the page's construction.\n    cssRuleList = styleSheet.cssRules /* W3C */ || styleSheet.rules /* IE */;\n  } catch (e) {\n    // This can happen if we try to access the CSSOM before it's \"ready\".\n    if (e.code == 15) {\n      // Firefox throws an NS_ERROR_DOM_INVALID_ACCESS_ERR error if a stylesheet\n      // is read before it has been fully parsed. Let the caller know which\n      // stylesheet failed.\n      e.styleSheet = styleSheet;\n      throw e;\n    }\n  }\n  return cssRuleList;\n};\n\n\n/**\n * Gets all CSSStyleSheet objects starting from some CSSStyleSheet. Note that we\n * want to return the sheets in the order of the cascade, therefore if we\n * encounter an import, we will splice that CSSStyleSheet object in front of\n * the CSSStyleSheet that contains it in the returned array of CSSStyleSheets.\n * @param {(CSSStyleSheet|StyleSheetList)=} opt_styleSheet A CSSStyleSheet.\n * @param {boolean=} opt_includeDisabled If true, includes disabled stylesheets,\n *    defaults to false.\n * @return {!Array<CSSStyleSheet>} A list of CSSStyleSheet objects.\n */\ngoog.cssom.getAllCssStyleSheets = function(\n    opt_styleSheet, opt_includeDisabled) {\n  var styleSheetsOutput = [];\n  var styleSheet = opt_styleSheet || document.styleSheets;\n  var includeDisabled =\n      goog.isDef(opt_includeDisabled) ? opt_includeDisabled : false;\n\n  // Imports need to go first.\n  if (styleSheet.imports && styleSheet.imports.length) {\n    for (var i = 0, n = styleSheet.imports.length; i < n; i++) {\n      goog.array.extend(\n          styleSheetsOutput,\n          goog.cssom.getAllCssStyleSheets(\n              /** @type {CSSStyleSheet} */ (styleSheet.imports[i])));\n    }\n\n  } else if (styleSheet.length) {\n    // In case we get a StyleSheetList object.\n    // http://dev.w3.org/csswg/cssom/#the-stylesheetlist\n    for (var i = 0, n = styleSheet.length; i < n; i++) {\n      goog.array.extend(\n          styleSheetsOutput, goog.cssom.getAllCssStyleSheets(styleSheet[i]));\n    }\n  } else {\n    // We need to walk through rules in browsers which implement .cssRules\n    // to see if there are styleSheets buried in there.\n    // If we have a CSSStyleSheet within CssRules.\n    var cssRuleList = goog.cssom.getCssRulesFromStyleSheet(\n        /** @type {!CSSStyleSheet} */ (styleSheet));\n    if (cssRuleList && cssRuleList.length) {\n      // Chrome does not evaluate cssRuleList[i] to undefined when i >=n;\n      // so we use a (i < n) check instead of cssRuleList[i] in the loop below\n      // and in other places where we iterate over a rules list.\n      // See issue # 5917 in Chromium.\n      for (var i = 0, n = cssRuleList.length, cssRule; i < n; i++) {\n        cssRule = cssRuleList[i];\n        // There are more stylesheets to get on this object..\n        if (cssRule.styleSheet) {\n          goog.array.extend(\n              styleSheetsOutput,\n              goog.cssom.getAllCssStyleSheets(cssRule.styleSheet));\n        }\n      }\n    }\n  }\n\n  // This is a CSSStyleSheet. (IE uses .rules, W3c and Opera cssRules.)\n  if ((styleSheet.type || styleSheet.rules || styleSheet.cssRules) &&\n      (!styleSheet.disabled || includeDisabled)) {\n    styleSheetsOutput.push(styleSheet);\n  }\n\n  return styleSheetsOutput;\n};\n\n\n/**\n * Gets the cssText from a CSSRule object cross-browserly.\n * @param {CSSRule} cssRule A CSSRule.\n * @return {string} cssText The text for the rule, including the selector.\n */\ngoog.cssom.getCssTextFromCssRule = function(cssRule) {\n  var cssText = '';\n\n  if (cssRule.cssText) {\n    // W3C.\n    cssText = cssRule.cssText;\n  } else if (cssRule.style && cssRule.style.cssText && cssRule.selectorText) {\n    // IE: The spacing here is intended to make the result consistent with\n    // FF and Webkit.\n    // We also remove the special properties that we may have added in\n    // getAllCssStyleRules since IE includes those in the cssText.\n    var styleCssText =\n        cssRule.style.cssText\n            .replace(/\\s*-closure-parent-stylesheet:\\s*\\[object\\];?\\s*/gi, '')\n            .replace(/\\s*-closure-rule-index:\\s*[\\d]+;?\\s*/gi, '');\n    var thisCssText = cssRule.selectorText + ' { ' + styleCssText + ' }';\n    cssText = thisCssText;\n  }\n\n  return cssText;\n};\n\n\n/**\n * Get the index of the CSSRule in it's CSSStyleSheet.\n * @param {CSSRule} cssRule A CSSRule.\n * @param {CSSStyleSheet=} opt_parentStyleSheet A reference to the stylesheet\n *     object this cssRule belongs to.\n * @throws {Error} When we cannot get the parentStyleSheet.\n * @return {number} The index of the CSSRule, or -1.\n */\ngoog.cssom.getCssRuleIndexInParentStyleSheet = function(\n    cssRule, opt_parentStyleSheet) {\n  // Look for our special style.ruleIndex property from getAllCss.\n  if (cssRule.style && /** @type {!Object} */ (cssRule.style)['-closure-rule-index']) {\n    return (/** @type {!Object} */ (cssRule.style))['-closure-rule-index'];\n  }\n\n  var parentStyleSheet =\n      opt_parentStyleSheet || goog.cssom.getParentStyleSheet(cssRule);\n\n  if (!parentStyleSheet) {\n    // We could call getAllCssStyleRules() here to get our special indexes on\n    // the style object, but that seems like it could be wasteful.\n    throw Error('Cannot find a parentStyleSheet.');\n  }\n\n  var cssRuleList = goog.cssom.getCssRulesFromStyleSheet(parentStyleSheet);\n  if (cssRuleList && cssRuleList.length) {\n    for (var i = 0, n = cssRuleList.length, thisCssRule; i < n; i++) {\n      thisCssRule = cssRuleList[i];\n      if (thisCssRule == cssRule) {\n        return i;\n      }\n    }\n  }\n  return -1;\n};\n\n\n/**\n * We do some trickery in getAllCssStyleRules that hacks this in for IE.\n * If the cssRule object isn't coming from a result of that function call, this\n * method will return undefined in IE.\n * @param {CSSRule} cssRule The CSSRule.\n * @return {CSSStyleSheet} A styleSheet object.\n */\ngoog.cssom.getParentStyleSheet = function(cssRule) {\n  return cssRule.parentStyleSheet ||\n      cssRule.style &&\n      (/** @type {!Object} */ (cssRule.style))['-closure-parent-stylesheet'];\n};\n\n\n/**\n * Replace a cssRule with some cssText for a new rule.\n * If the cssRule object is not one of objects returned by\n * getAllCssStyleRules, then you'll need to provide both the styleSheet and\n * possibly the index, since we can't infer them from the standard cssRule\n * object in IE. We do some trickery in getAllCssStyleRules to hack this in.\n * @param {CSSRule} cssRule A CSSRule.\n * @param {string} cssText The text for the new CSSRule.\n * @param {CSSStyleSheet=} opt_parentStyleSheet A reference to the stylesheet\n *     object this cssRule belongs to.\n * @param {number=} opt_index The index of the cssRule in its parentStylesheet.\n * @throws {Error} If we cannot find a parentStyleSheet.\n * @throws {Error} If we cannot find a css rule index.\n */\ngoog.cssom.replaceCssRule = function(\n    cssRule, cssText, opt_parentStyleSheet, opt_index) {\n  var parentStyleSheet =\n      opt_parentStyleSheet || goog.cssom.getParentStyleSheet(cssRule);\n  if (parentStyleSheet) {\n    var index = Number(opt_index) >= 0 ?\n        Number(opt_index) :\n        goog.cssom.getCssRuleIndexInParentStyleSheet(cssRule, parentStyleSheet);\n    if (index >= 0) {\n      goog.cssom.removeCssRule(parentStyleSheet, index);\n      goog.cssom.addCssRule(parentStyleSheet, cssText, index);\n    } else {\n      throw Error('Cannot proceed without the index of the cssRule.');\n    }\n  } else {\n    throw Error('Cannot proceed without the parentStyleSheet.');\n  }\n};\n\n\n/**\n * Cross browser function to add a CSSRule into a CSSStyleSheet, optionally\n * at a given index.\n * @param {CSSStyleSheet} cssStyleSheet The CSSRule's parentStyleSheet.\n * @param {string} cssText The text for the new CSSRule.\n * @param {number=} opt_index The index of the cssRule in its parentStylesheet.\n * @throws {Error} If the css rule text appears to be ill-formatted.\n * TODO(bowdidge): Inserting at index 0 fails on Firefox 2 and 3 with an\n *     exception warning \"Node cannot be inserted at the specified point in\n *     the hierarchy.\"\n */\ngoog.cssom.addCssRule = function(cssStyleSheet, cssText, opt_index) {\n  var index = opt_index;\n  if (index == undefined || index < 0) {\n    // If no index specified, insert at the end of the current list\n    // of rules.\n    var rules = goog.cssom.getCssRulesFromStyleSheet(cssStyleSheet);\n    index = rules.length;\n  }\n  if (cssStyleSheet.insertRule) {\n    // W3C (including IE9+).\n    cssStyleSheet.insertRule(cssText, index);\n\n  } else {\n    // IE, pre 9: We have to parse the cssRule text to get the selector\n    // separated from the style text.\n    // aka Everything that isn't a colon, followed by a colon, then\n    // the rest is the style part.\n    var matches = /^([^\\{]+)\\{([^\\{]+)\\}/.exec(cssText);\n    if (matches.length == 3) {\n      var selector = matches[1];\n      var style = matches[2];\n      cssStyleSheet.addRule(selector, style, index);\n    } else {\n      throw Error('Your CSSRule appears to be ill-formatted.');\n    }\n  }\n};\n\n\n/**\n * Cross browser function to remove a CSSRule in a CSSStyleSheet at an index.\n * @param {CSSStyleSheet} cssStyleSheet The CSSRule's parentStyleSheet.\n * @param {number} index The CSSRule's index in the parentStyleSheet.\n */\ngoog.cssom.removeCssRule = function(cssStyleSheet, index) {\n  if (cssStyleSheet.deleteRule) {\n    // W3C.\n    cssStyleSheet.deleteRule(index);\n\n  } else {\n    // IE.\n    cssStyleSheet.removeRule(index);\n  }\n};\n\n\n/**\n * Appends a DOM node to HEAD containing the css text that's passed in.\n * @param {string} cssText CSS to add to the end of the document.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper user for\n *     document interactions.\n * @return {!Element} The newly created STYLE element.\n */\ngoog.cssom.addCssText = function(cssText, opt_domHelper) {\n  var domHelper = opt_domHelper || goog.dom.getDomHelper();\n  var document = domHelper.getDocument();\n  var cssNode = domHelper.createElement(goog.dom.TagName.STYLE);\n  cssNode.type = 'text/css';\n  var head = domHelper.getElementsByTagName(goog.dom.TagName.HEAD)[0];\n  head.appendChild(cssNode);\n  if (cssNode.styleSheet) {\n    // IE.\n    cssNode.styleSheet.cssText = cssText;\n  } else {\n    // W3C.\n    var cssTextNode = document.createTextNode(cssText);\n    cssNode.appendChild(cssTextNode);\n  }\n  return cssNode;\n};\n\n\n/**\n * Cross browser method to get the filename from the StyleSheet's href.\n * Explorer only returns the filename in the href, while other agents return\n * the full path.\n * @param {!StyleSheet} styleSheet Any valid StyleSheet object with an href.\n * @throws {Error} When there's no href property found.\n * @return {?string} filename The filename, or null if not an external\n *    styleSheet.\n */\ngoog.cssom.getFileNameFromStyleSheet = function(styleSheet) {\n  var href = styleSheet.href;\n\n  // Another IE/FF difference. IE returns an empty string, while FF and others\n  // return null for CSSStyleSheets not from an external file.\n  if (!href) {\n    return null;\n  }\n\n  // We need the regexp to ensure we get the filename minus any query params.\n  var matches = /([^\\/\\?]+)[^\\/]*$/.exec(href);\n  var filename = matches[1];\n  return filename;\n};\n\n\n/**\n * Recursively gets all CSS text or rules.\n * @param {CSSStyleSheet|StyleSheetList} styleSheet The CSSStyleSheet.\n * @param {boolean} isTextOutput If true, output is cssText, otherwise cssRules.\n * @return {string|!Array<CSSRule>} cssText or cssRules.\n * @private\n */\ngoog.cssom.getAllCss_ = function(styleSheet, isTextOutput) {\n  var cssOut = [];\n  var styleSheets = goog.cssom.getAllCssStyleSheets(styleSheet);\n\n  for (var i = 0; styleSheet = styleSheets[i]; i++) {\n    var cssRuleList = goog.cssom.getCssRulesFromStyleSheet(styleSheet);\n\n    if (cssRuleList && cssRuleList.length) {\n      var ruleIndex = 0;\n      for (var j = 0, n = cssRuleList.length, cssRule; j < n; j++) {\n        cssRule = cssRuleList[j];\n        // Gets cssText output, ignoring CSSImportRules.\n        if (isTextOutput && !cssRule.href) {\n          var res = goog.cssom.getCssTextFromCssRule(cssRule);\n          cssOut.push(res);\n\n        } else if (!cssRule.href) {\n          // Gets cssRules output, ignoring CSSImportRules.\n          if (cssRule.style) {\n            // This is a fun little hack to get parentStyleSheet into the rule\n            // object for IE since it failed to implement rule.parentStyleSheet.\n            // We can later read this property when doing things like hunting\n            // for indexes in order to delete a given CSSRule.\n            // Unfortunately we have to use the style object to store these\n            // pieces of info since the rule object is read-only.\n            if (!cssRule.parentStyleSheet) {\n              (/** @type {!Object} */ (cssRule.style))[\n                '-closure-parent-stylesheet'] = styleSheet;\n            }\n\n            // This is a hack to help with possible removal of the rule later,\n            // where we just append the rule's index in its parentStyleSheet\n            // onto the style object as a property.\n            // Unfortunately we have to use the style object to store these\n            // pieces of info since the rule object is read-only.\n            (/** @type {!Object} */ (cssRule.style))['-closure-rule-index'] =\n                isTextOutput ? undefined : ruleIndex;\n          }\n          cssOut.push(cssRule);\n        }\n        if (!isTextOutput) {\n          ruleIndex++;\n        }\n      }\n    }\n  }\n  return isTextOutput ? cssOut.join(' ') : cssOut;\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2013 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Inject Blockly's CSS synchronously.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Css');\n\ngoog.require('goog.cssom');\n\n/**\n * List of cursors.\n * @enum {string}\n */\nBlockly.Css.Cursor = {\n  OPEN: 'handopen',\n  CLOSED: 'handclosed'\n};\n\n/**\n* Current cursor (cached value).\n* @type string\n*/\nBlockly.Css.currentCursor_ = '';\n\n/**\n * Large stylesheet added by Blockly.Css.inject.\n * @type Element\n * @private\n */\nBlockly.Css.styleSheet_ = null;\n\n/**\n * Inject the CSS into the DOM.  This is preferable over using a regular CSS\n * file since:\n * a) It loads synchronously and doesn't force a redraw later.\n * b) It speeds up loading by not blocking on a separate HTTP transfer.\n * c) The CSS content may be made dynamic depending on init options.\n */\nBlockly.Css.inject = function(container) {\n  var text = Blockly.Css.CONTENT.join('\\n');\n\n  // Expand paths.\n  text = text\n    .replace(/%CONTAINER_ID%/g, container.id)\n    .replace(/%TREE_PATH%/g, Blockly.assetUrl('media/tree.png'))\n    .replace(/%CURSOR_OPEN_PATH%/g, Blockly.assetUrl('media/handopen.cur'))\n    .replace(/%CURSOR_CLOSED_PATH%/g, Blockly.assetUrl('media/handclosed.cur'));\n  Blockly.Css.styleSheet_ = goog.cssom.addCssText(text).sheet;\n};\n\n/**\n * Set the cursor to be displayed when over something draggable.\n * In most cases, it may be easier to call the setCursor helper on\n * BlockSpaceEditor than to use this method directly.\n * @param {Blockly.Cursor} cursor Enum.\n * @param {?SVGElement} opt_svg The blockSpace svg object to also set the cursor on.\n */\nBlockly.Css.setCursor = function(cursor, opt_svg) {\n  if (Blockly.readOnly) {\n    return;\n  }\n\n  if (Blockly.Css.currentCursor_ !== cursor) {\n    Blockly.Css.currentCursor_ = cursor;\n\n    // Set cursor on the toolbox and SVG surface, so that rapid movements\n    // don't result in cursor changing to an arrow momentarily.\n    if (opt_svg) {\n      if (cursor == Blockly.Css.Cursor.OPEN) {\n        Blockly.removeClass_(opt_svg.parentNode, 'dragging');\n      } else {\n        Blockly.addClass_(opt_svg.parentNode, 'dragging');\n      }\n    }\n  }\n};\n\n/**\n * Array making up the CSS content for Blockly.\n */\nBlockly.Css.CONTENT = [\n  '.blocklyFieldAngleTextInput {',\n  '  border: 1px solid #ccc;',\n  '  margin-top: -10px;',\n  '}',\n  '.blocklyFieldAngleDropdown {',\n  '  box-shadow: 4px 4px 6px #bbb;',\n  '  border-style: solid;',\n  '  border-width: 1px;',\n  '}',\n  '.blocklyFieldAngleDropdown > div {',\n  '  float: left;',\n  '}',\n  '.blocklyFieldAngleDropdown .goog-menu {',\n  '  box-shadow: none;',\n  '  min-height: 150px;',\n  '  border-style: none;',\n  '}',\n  '.blocklyFieldAngleDropdown .goog-menu::after {',\n  '  content: \\'\\';',\n  '  border-left: 1px solid #949ca2;',\n  '  position: absolute;',\n  '  height: 80%;',\n  '  right: 0;',\n  '  top: 10%;',\n  '}',\n  '.blocklyLimit rect {',\n  ' fill: #a69bc1;',\n  '}',\n  '.blocklyLimit.overLimit rect {',\n  ' fill: #daa53a;',\n  '}',\n  '.blocklyLimit .blocklyText {',\n  ' font-size: 10pt;',\n  ' fill: #fff;',\n  '}',\n  '.blocklyUnused .blocklyLimit rect {',\n  ' fill: #c6cacd;',\n  '}',\n  '.blocklyUnused .blocklyLimit .blocklyText {',\n  ' fill: #5b6770',\n  '}',\n  '.blocklyUnused .blocklyPath, .blocklyUnused .blocklyPathDark, .blocklyUnused .blocklyPathLight, .blocklyUnused .blocklyEditableText {',\n  ' opacity: 0.25;',\n  '}',\n  '.blocklyUnused .blocklyUnusedFrame {',\n  ' transition: opacity 2s;',\n  ' opacity: 0.8;',\n  '}',\n  '.blocklyUnused .blocklyUnusedFrame .blocklyText {',\n  ' fill: #000;',\n  '}',\n  '.blocklyUnused .blocklyUnusedFrame.hidden {',\n  ' opacity: 0;',\n  ' visibility: hidden',\n  '}',\n  '.blocklyUnused .blocklyHelp {',\n  ' cursor: pointer;',\n  '}',\n  '.blocklyUnused .blocklyHelp .blocklyText {',\n  ' fill: #fff;',\n  ' font-size: 10pt;',\n  ' text-anchor: middle;',\n  ' dominant-baseline: central;',\n  '}',\n  '.blocklyDraggable {',\n  '  cursor: url(%CURSOR_OPEN_PATH%) 8 5, auto;',\n  '}',\n  '.dragging, .dragging .blocklySvg, .dragging .blocklyDraggable {',\n  '  cursor: url(%CURSOR_CLOSED_PATH%) 7 3, auto !important;',\n  '}',\n  '#%CONTAINER_ID% {',\n  '  border: 1px solid #ddd;',\n  '}',\n  '#%CONTAINER_ID% .userHidden {',\n  '  display: none;',\n  '}',\n  '#%CONTAINER_ID% .hiddenFlyout {',\n  '  display: none !important;',\n  '}',\n  '#%CONTAINER_ID%.edit .userHidden {',\n  '  display: inline;',\n  '  fill-opacity: 0.5;',\n  '}',\n  '#%CONTAINER_ID%.edit .userHidden .blocklyPath {',\n  '  fill-opacity: 0.5;',\n  '}',\n  '#%CONTAINER_ID%.edit .userHidden .blocklyPathDark, #%CONTAINER_ID%.edit .userHidden .blocklyPathLight {',\n  '  display: none;',\n  '}',\n  '.blocklySvg {',\n  '  cursor: pointer;',\n  '  background-color: #fff;',\n  '  overflow: hidden;',\n  '}',\n  '.blocklySvg.inline {',\n  '  vertical-align: top;',\n  '}',\n  'g.blocklyDraggable {',\n  '  -ms-touch-action: none;',\n  '  touch-action: none;',\n  '}',\n  '.blocklyWidgetDiv {',\n  '  position: absolute;',\n  '  display: none;',\n  '  z-index: 999;',\n  '}',\n  '.blocklyResizeSE {',\n  '  fill: #aaa;',\n  '  cursor: se-resize;',\n  '}',\n  '.blocklyResizeSW {',\n  '  fill: #aaa;',\n  '  cursor: sw-resize;',\n  '}',\n  '.blocklyResizeLine {',\n  '  stroke-width: 1;',\n  '  stroke: #888;',\n  '}',\n  '.blocklyHighlightedConnectionPath {',\n  '  stroke-width: 4px;',\n  '  stroke: #fc3;',\n  '  fill: none;',\n  '}',\n  '.blocklyPathLight {',\n  '  fill: none;',\n  '  stroke-width: 1;',\n  '  stroke-linecap: round;',\n  '}',\n  '.blocklyTypeHint {',\n  '  fill: none;',\n  '  stroke-width: 5;',\n  '}',\n  '.blocklySelected>.blocklyTypeHint, .blocklyUnused .blocklyTypeHint {',\n  '  display: none;',\n  '}',\n  '.blocklySpotlight>.blocklyPath {',\n  '  fill: #fc3;',\n  '}',\n  '.blocklySelected>.blocklyPath {',\n  '  stroke-width: 3px;',\n  '  stroke: #fc3;',\n  '}',\n  '.blocklySelected>.blocklyPathLight {',\n  '  display: none;',\n  '}',\n  '.blocklyUndeletable>.blocklyEditableText>rect {',\n  '  fill-opacity: 1.0;',\n  '  fill: #ffdb74;',\n  '}',\n  '#blocklyDragCanvas {',\n  '  display: none;',\n  '  pointer-events: none;',\n  '  position: absolute;',\n  '  top: 0;',\n  '  left: 0;',\n  '  z-index: 10;',\n  '}',\n  '#blocklyDragCanvas.isDragging {',\n  '  display: block;',\n  '}',\n  '.blocklyDragging>.blocklyPath,',\n  '.blocklyDragging>.blocklyPathLight {',\n  '  fill-opacity: 0.8;',\n  '  stroke-opacity: 0.8;',\n  '}',\n  '.blocklyDragging>.blocklyPathDark {',\n  '  display: none;',\n  '}',\n  '.blocklyDisabled>.blocklyPath {',\n  '  fill-opacity: 0.50;',\n  '  stroke-opacity: 0.50;',\n  '}',\n  '.blocklyDisabled>.blocklyPathLight,',\n  '.blocklyDisabled>.blocklyPathDark {',\n  '  display: none;',\n  '}',\n  '.blocklyText {',\n  '  cursor: default;',\n  '  font-family: sans-serif;',\n  '  font-size: 11pt;',\n  '  fill: #fff;',\n  '}',\n  '.innerModalDiv {',\n  '  pointer-events: none !important;',\n  '}',\n  '.innerModalDiv .goog-flat-menu-button,',\n  '.innerModalDiv textarea,',\n  '.innerModalDiv input,',\n  '.innerModalDiv button {',\n  '  pointer-events: auto;',\n  '}',\n  '.flyoutColorGray {',\n  '  background-color: #DDD;',\n  '}',\n  '.contractEditor #paramAddButton {',\n  '  margin-top: 3px;',\n  '  margin-left: 10px;',\n  '  margin-bottom: 4px;',\n  '}',\n  '.contractEditorHeaderText {',\n  '  cursor: default;',\n  '  font-size: 12pt;',\n  '  fill: #fff;',\n  '}',\n  '.contract-type-hint {',\n  '  color: #898989;',\n  '  font-size: 11px;',\n  '}',\n  '.exampleAreaDiv {',\n  '  pointer-events: none;',\n  '}',\n  '.callResultText {',\n  '  color: #000;',\n  '  position: absolute;',\n  '}',\n  '.exampleAreaButton {',\n  '  pointer-events: initial;',\n  '  position: absolute;',\n  '}',\n  '.core-clearfix {',\n  '  overflow: auto;',\n  '}',\n  '.testButton {',\n  '  padding: 3px 0 !important;',\n  '  min-width: 95px !important;',\n  '}',\n  '.resetButton {',\n  '  border: 1px solid #0094ca !important;',\n  '  background-color: #0094ca !important;',\n  '}',\n  '.example-result-text {',\n  '  position: absolute;',\n  '  font-size: 16px;',\n  '}',\n  '.color-square-icon {',\n  '  float: left;',\n  '  width: 21px;',\n  '  height: 18px;',\n  '  margin-right: 9px !important;',\n  '  margin-left: 6px !important;',\n  '}',\n  '.goog-menuitem .color-square-icon {',\n  '  margin-left: -3px !important;',\n  '  margin-top: 2px !important;',\n  '}',\n  '.blocklyNonEditableText>text {',\n  '  pointer-events: none;',\n  '}',\n  '.blocklyNonEditableText>rect,',\n  '.blocklyEditableText>rect {',\n  '  fill: #fff;',\n  '  fill-opacity: 0.6;',\n  '}',\n  '.blocklyNonEditableText>text,',\n  '.blocklyEditableText>text {',\n  '  fill: #000;',\n  '}',\n  '.blocklyEditableText:hover>rect {',\n  '  stroke-width: 2;',\n  '  stroke: #fff;',\n  '}',\n  '/*',\n  ' * Don\\'t allow users to select text.  It gets annoying when trying to',\n  ' * drag a block and selected text moves instead.',\n  ' */',\n  '.blocklySvg text {',\n  '  -moz-user-select: none;',\n  '  -webkit-user-select: none;',\n  '  user-select: none;',\n  '  cursor: inherit;',\n  '}',\n\n  '.blocklyHidden {',\n  '  display: none;',\n  '}',\n  '.blocklyFieldDropdown:not(.blocklyHidden) {',\n  '  display: block;',\n  '}',\n  '.blocklyTooltipBackground {',\n  '  fill: #ffffc7;',\n  '  stroke-width: 1px;',\n  '  stroke: #d8d8d8;',\n  '}',\n  '.blocklyTooltipShadow,',\n  '.blocklyContextMenuShadow,',\n  '.blocklyDropdownMenuShadow {',\n  '  fill: #bbb;',\n  '  filter: url(#blocklyShadowFilter);',\n  '}',\n  '.blocklyTooltipText {',\n  '  font-family: sans-serif;',\n  '  font-size: 9pt;',\n  '  fill: #000;',\n  '}',\n  '#modalEditorClose:hover>rect {',\n  '  fill: #0094ca;',\n  '}',\n  '.svgTextButton:hover>rect {',\n  '  fill: #0094ca;',\n  '}',\n  '.red-delete-button {',\n  '  background-color: #cc0000 !important;',\n  '  border: 1px solid #cc0000 !important;',\n  '}',\n  '.blocklyIconShield {',\n  '  cursor: default;',\n  '  fill: #00c;',\n  '  stroke-width: 1px;',\n  '  stroke: #ccc;',\n  '}',\n  '.blocklyIconGroup:hover>.blocklyIconShield {',\n  '  fill: #00f;',\n  '  stroke: #fff;',\n  '}',\n  '.blocklyIconGroup:hover>.blocklyIconMark {',\n  '  fill: #fff;',\n  '}',\n  '.blocklyIconMark {',\n  '  cursor: default !important;',\n  '  font-family: sans-serif;',\n  '  font-size: 9pt;',\n  '  font-weight: bold;',\n  '  fill: #ccc;',\n  '  text-anchor: middle;',\n  '}',\n  '.blocklyWarningBody {',\n  '}',\n  '.blocklyMinimalBody {',\n  '  margin: 0;',\n  '  padding: 0;',\n  '}',\n  '.blocklyHtmlInput {',\n  '  font-family: sans-serif;',\n  '  font-size: 11pt;',\n  '  border: none;',\n  '  outline: none;',\n  '  width: 100%;',\n  '  -moz-appearance: textfield;',\n  '}',\n  '.blocklyHtmlInput::-webkit-inner-spin-button, .blocklyHtmlInput::-webkit-outer-spin-button {',\n  '  -webkit-appearance: none;',\n  '}',\n  '.blocklyContextMenuBackground,',\n  '.blocklyMutatorBackground {',\n  '  fill: #fff;',\n  '  stroke-width: 1;',\n  '  stroke: #ddd;',\n  '}',\n  '.newFunctionDiv {',\n  '  position: absolute;',\n  '  top: 120px;',\n  '  left: 600px;',\n  '}',\n  '#modalContainer .goog-flat-menu-button-caption {',\n  '  color: #555555;',\n  '  margin-left: 1px;',\n  '  margin-right: 0;',\n  '  min-width: 55px;',\n  '}',\n  '.blocklyContextMenuOptions>.blocklyMenuDiv,',\n  '.blocklyContextMenuOptions>.blocklyMenuDivDisabled,',\n  '.blocklyDropdownMenuOptions>.blocklyMenuDiv {',\n  '  fill: #fff;',\n  '}',\n  '.blocklyContextMenuOptions>.blocklyMenuDiv:hover>rect,',\n  '.blocklyDropdownMenuOptions>.blocklyMenuDiv:hover>rect {',\n  '  fill: #57e;',\n  '}',\n  '.blocklyMenuSelected>rect {',\n  '  fill: #57e;',\n  '}',\n  '.blocklyMenuText {',\n  '  cursor: default !important;',\n  '  font-family: sans-serif;',\n  '  font-size: 15px; /* All context menu sizes are based on pixels. */',\n  '  fill: #000;',\n  '}',\n  '.blocklyContextMenuOptions>.blocklyMenuDiv:hover>.blocklyMenuText,',\n  '.blocklyDropdownMenuOptions>.blocklyMenuDiv:hover>.blocklyMenuText {',\n  '  fill: #fff;',\n  '}',\n  '.blocklyMenuSelected>.blocklyMenuText {',\n  '  fill: #fff;',\n  '}',\n  '.blocklyMenuDivDisabled>.blocklyMenuText {',\n  '  fill: #ccc;',\n  '}',\n  '.blocklyFlyoutBackground {',\n  '  fill: #ddd;',\n  '  fill-opacity: 0.8;',\n  '}',\n  '.blocklyToolboxBackground {',\n  '  fill: #ddd;',\n  '}',\n  '.blocklyBackground {',\n  '  fill: #666;',\n  '}',\n  '.blocklyScrollbarBackground {',\n  '  fill: #fff;',\n  '  stroke-width: 1;',\n  '  stroke: #e4e4e4;',\n  '}',\n  '.blocklyScrollbarKnob {',\n  '  fill: #ccc;',\n  '}',\n  '.blocklyScrollbarBackground:hover+.blocklyScrollbarKnob,',\n  '.blocklyScrollbarKnob:hover {',\n  '  fill: #bbb;',\n  '}',\n  '.blocklyInvalidInput {',\n  '  background: #faa;',\n  '}',\n  '.blocklyAngleCircle {',\n  '  stroke: #444;',\n  '  stroke-width: 1;',\n  '  fill: #ddd;',\n  '  fill-opacity: 0.8;',\n  '}',\n  '.blocklyAngleMarks {',\n  '  stroke: #444;',\n  '  stroke-width: 1;',\n  '}',\n  '.blocklyAngleGuage {',\n  '  fill: #d00;',\n  '  fill-opacity: 0.8;  ',\n  '}',\n  '.blocklyContextMenu {',\n  '  border-radius: 4px;',\n  '}',\n  '.blocklyDropdownMenu {',\n  '  padding: 0 !important;',\n  '  position: relative !important;',\n  '}',\n  '.blocklyRectangularDropdownMenu .goog-menuitem {',\n  '  height: 100%;',\n  '  padding: 0 !important;',\n  '  border-radius: 5px;',\n  '  margin-bottom: 4px !important;',\n  '}',\n  '.fieldRectangularDropdownBackdrop {',\n  '  fill: #fff;',\n  '  fill-opacity: 0.6;',\n  '}',\n  '.blocklyRectangularDropdownArrow {',\n  '  fill: #7965a1;',\n  '  font-size: 20px !important;',\n  '}',\n  '.blocklyRectangularDropdownMenu .goog-menuitem-highlight, .goog-menuitem-hover {',\n  '  border-color: #7965a1 !important;',\n  '  border-style: dotted !important;',\n  '  border-width: 0px !important;',\n  '  margin: -4px -4px 0 !important;',\n  '  border-width: 4px !important;',\n  '  border-style: solid !important;',\n  '  padding-bottom: 0px !important;',\n  '  padding-top: 0px !important;',\n  '}',\n  '.colored-type-dropdown .goog-menuitem-content {',\n  '  color: #555555;',\n  '  float: left;',\n  '}',\n  '.colored-type-dropdown > .goog-menuitem {',\n  '  padding: 0px 40px 2px 13px;',\n  '}',\n  '.goog-menu {',\n  '  box-shadow: 4px 4px 6px #bbb;',\n  '  border-width: 2px;',\n  '}',\n  '.goog-menuitem {',\n  // '  height: 20px;',\n  '  padding-top: 0;',\n  '  padding-bottom: 0;',\n  '}',\n  '.goog-menuitem-highlight,',\n  '.goog-menuitem-hover {',\n  '  border-width: 0;',\n  '  background-color: #57e;',\n  '}',\n  '.goog-menuitem-highlight .goog-menuitem-content {',\n  '  color: #fff;',\n  '}',\n  '.goog-option-selected .goog-menuitem-checkbox:before {',\n  '  content: \"\";',\n  '}',\n  '.goog-menuitem-checkbox {',\n  '  background: \"\"',\n  '}',\n  '.blocklyRectangularDropdownMenu img {',\n  '  -webkit-border-radius: 5px;',\n  '  -moz-border-radius: 5px;',\n  '  border-radius: 5px;',\n  '}',\n  '.blocklyRectangularDropdownMenu {',\n  '  border-radius: 5px;',\n  '  box-shadow: none !important;',\n  '}',\n  /* Override the default Closure URL. */\n  '.goog-option-selected .goog-menuitem-checkbox,',\n  '.goog-option-selected .goog-menuitem-icon {',\n  /* disabling background as we want to use a text checkmark instead*/\n  //'  background: url(%SPRITES_PATH%) no-repeat 0 0 !important;',\n  '}',\n  '/* Category tree in Toolbox. */',\n  '.blocklyToolboxDiv {',\n  '  display: none;',\n  '  overflow-x: visible;',\n  '  overflow-y: auto;',\n  '  position: absolute;',\n  '}',\n  '.blocklyTreeRoot {',\n  '  padding: 4px 0;',\n  '}',\n  '.blocklyTreeRoot:focus {',\n  '  outline: none;',\n  '}',\n  '.blocklyTreeRow {',\n  '  line-height: 22px;',\n  '  height: 22px;',\n  '  padding-right: 1em;',\n  '  white-space: nowrap;',\n  '}',\n  '.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeRow {',\n  '  padding-right: 0;',\n  '  padding-left: 1em !important;',\n  '}',\n  '.blocklyTreeRow:hover {',\n  '  background-color: #e4e4e4;',\n  '}',\n  '.blocklyTreeIcon {',\n  '  height: 16px;',\n  '  width: 16px;',\n  '  vertical-align: middle;',\n  '  background-image: url(%TREE_PATH%);',\n  '}',\n  '.blocklyTreeIconClosedLtr {',\n  '  background-position: -32px -1px;',\n  '}',\n  '.blocklyTreeIconClosedRtl {',\n  '  background-position: 0px -1px;',\n  '}',\n  '.blocklyTreeIconOpen {',\n  '  background-position: -16px -1px;',\n  '}',\n  '.blocklyTreeIconNone {',\n  '  background-position: -48px -1px;',\n  '}',\n  '.blocklyTreeSelected>.blocklyTreeIconClosedLtr {',\n  '  background-position: -32px -17px;',\n  '}',\n  '.blocklyTreeSelected>.blocklyTreeIconClosedRtl {',\n  '  background-position: 0px -17px;',\n  '}',\n  '.blocklyTreeSelected>.blocklyTreeIconOpen {',\n  '  background-position: -16px -17px;',\n  '}',\n  '.blocklyTreeSelected>.blocklyTreeIconNone {',\n  '  background-position: -48px -17px;',\n  '}',\n  '.blocklyTreeLabel {',\n  '  cursor: default;',\n  '  font-family: sans-serif;',\n  '  font-size: 16px;',\n  '  padding: 0 3px;',\n  '  vertical-align: middle;',\n  '  -moz-user-select: none;',\n  '  -webkit-user-select: none;',\n  '  -ms-user-select: none;',\n  '  user-select: none;',\n  '}',\n  '.blocklyTreeSelected {',\n  '  background-color: #57e !important;',\n  '}',\n  '.blocklyTreeSelected .blocklyTreeLabel {',\n  '  color: #fff;',\n  '}',\n  '.blocklyArrow {',\n  '  font-size: 80%;',\n  '}',\n  '.paramToolbox {',\n  '  padding: 0 0 5px 0;',\n  '  pointer-events: auto;',\n  '}',\n  '.paramToolbox input, .paramToolbox textarea {',\n  '  box-sizing: border-box;',\n  '  width: 100%;',\n  '  margin: 0;',\n  '  resize: none;',\n  '}',\n  '.paramToolbox input, .paramToolbox button {',\n  '  height: 30px;',\n  '  margin: 0;',\n  '}',\n  '.paramToolbox div {',\n  '  margin: 4px 10px;',\n  '}',\n  '#modalContainer {',\n  '  position: absolute;',\n  '  width: 100%;',\n  '  bottom: 0;',\n  '}',\n  '#modalContainer > svg {',\n  '  position: absolute;',\n  '  top: 0;',\n  '  left: 0;',\n  '  background: transparent;',\n  '  pointer-events: none;',\n  '}',\n  '#modalContainer > svg * {',\n  '  pointer-events: visiblePainted;',\n  '}',\n\n  '/*',\n  ' * Copyright 2007 The Closure Library Authors. All Rights Reserved.',\n  ' *',\n  ' * Use of this source code is governed by the Apache License, Version 2.0.',\n  ' * See the COPYING file for details.',\n  ' */',\n\n  '/* Author: pupius@google.com (Daniel Pupius) */',\n\n  '/*',\n  ' Styles to make the colorpicker look like the old gmail color picker',\n  ' NOTE: without CSS scoping this will override styles defined in palette.css',\n  '*/',\n  '.goog-palette {',\n  '  outline: none;',\n  '  cursor: default;',\n  '}',\n\n  '.goog-palette-table {',\n  '  border: 1px solid #666;',\n  '  border-collapse: collapse;',\n  '}',\n\n  '.goog-palette-cell {',\n  '  height: 25px;',\n  '  width: 25px;',\n  '  margin: 0;',\n  '  border: 0;',\n  '  text-align: center;',\n  '  vertical-align: middle;',\n  '  border-right: 1px solid #666;',\n  '  font-size: 1px;',\n  '}',\n\n  '.goog-palette-colorswatch {',\n  '  position: relative;',\n  '  height: 25px;',\n  '  width: 25px;',\n  '  border: 1px solid #666;',\n  '}',\n\n  '.goog-palette-cell-hover .goog-palette-colorswatch {',\n  '  border: 1px solid #FFF;',\n  '}',\n\n  '.goog-palette-cell-selected .goog-palette-colorswatch {',\n  '  border: 1px solid #000;',\n  '  color: #fff;',\n  '}',\n  /* Copied from: goog/css/menu.css */\n  /*\n   * Copyright 2009 The Closure Library Authors. All Rights Reserved.\n   *\n   * Use of this source code is governed by the Apache License, Version 2.0.\n   * See the COPYING file for details.\n   */\n\n  /**\n   * Standard styling for menus created by goog.ui.MenuRenderer.\n   *\n   * @author attila@google.com (Attila Bodis)\n   */\n\n  '.goog-menu {',\n  '  background: #fff;',\n  '  border-color: #ccc #666 #666 #ccc;',\n  '  border-style: solid;',\n  '  border-width: 1px;',\n  '  cursor: default;',\n  '  font: normal 13px Arial, sans-serif;',\n  '  margin: 0;',\n  '  outline: none;',\n  '  padding: 4px 0;',\n  '  position: absolute;',\n  '  z-index: 20000;',  /* Arbitrary, but some apps depend on it... */\n  '}',\n\n  /* Copied from: goog/css/menuitem.css */\n  /*\n   * Copyright 2009 The Closure Library Authors. All Rights Reserved.\n   *\n   * Use of this source code is governed by the Apache License, Version 2.0.\n   * See the COPYING file for details.\n   */\n\n  /**\n   * Standard styling for menus created by goog.ui.MenuItemRenderer.\n   *\n   * @author attila@google.com (Attila Bodis)\n   */\n\n  /**\n   * State: resting.\n   *\n   * NOTE(mleibman,chrishenry):\n   * The RTL support in Closure is provided via two mechanisms -- \"rtl\" CSS\n   * classes and BiDi flipping done by the CSS compiler.  Closure supports RTL\n   * with or without the use of the CSS compiler.  In order for them not\n   * to conflict with each other, the \"rtl\" CSS classes need to have the #noflip\n   * annotation.  The non-rtl counterparts should ideally have them as well, but,\n   * since .goog-menuitem existed without .goog-menuitem-rtl for so long before\n   * being added, there is a risk of people having templates where they are not\n   * rendering the .goog-menuitem-rtl class when in RTL and instead rely solely\n   * on the BiDi flipping by the CSS compiler.  That's why we're not adding the\n   * #noflip to .goog-menuitem.\n   */\n  '.goog-menuitem {',\n  '  color: #000;',\n  '  font: normal 13px Arial, sans-serif;',\n  '  list-style: none;',\n  '  margin: 0;',\n     /* 28px on the left for icon or checkbox; 7em on the right for shortcut. */\n  '  padding: 4px 7em 4px 28px;',\n  '  white-space: nowrap;',\n  '}',\n\n  /* BiDi override for the resting state. */\n  /* #noflip */\n  '.goog-menuitem.goog-menuitem-rtl {',\n     /* Flip left/right padding for BiDi. */\n  '  padding-left: 7em;',\n  '  padding-right: 28px;',\n  '}',\n\n  /* If a menu doesn't have checkable items or items with icons, remove padding. */\n  '.goog-menu-nocheckbox .goog-menuitem,',\n  '.goog-menu-noicon .goog-menuitem {',\n  '  padding-left: 12px;',\n  '}',\n\n  /*\n   * If a menu doesn't have items with shortcuts, leave just enough room for\n   * submenu arrows, if they are rendered.\n   */\n  '.goog-menu-noaccel .goog-menuitem:not(.goog-menuitem-rtl) {',\n  '  padding-right: 20px;',\n  '}',\n  '.goog-menu-noaccel .goog-menuitem.goog-menuitem-rtl {',\n  '  padding-left: 20px;',\n  '}',\n\n  '.goog-menuitem-content {',\n  '  color: #000;',\n  '  font-size: 15px;',\n  '}',\n\n  /* State: disabled. */\n  '.goog-menuitem-disabled .goog-menuitem-accel,',\n  '.goog-menuitem-disabled .goog-menuitem-content {',\n  '  color: #ccc !important;',\n  '}',\n\n  '.goog-menuitem-disabled .goog-menuitem-icon {',\n  '  opacity: 0.3;',\n  '  -moz-opacity: 0.3;',\n  '  filter: alpha(opacity=30);',\n  '}',\n\n  /* State: hover. */\n  '.goog-menuitem-highlight,',\n  '.goog-menuitem-hover {',\n  '  background-color: #d6e9f8;',\n     /* Use an explicit top and bottom border so that the selection is visible',\n      * in high contrast mode. */\n  '  border-color: #d6e9f8;',\n  '  border-style: dotted;',\n  '  border-width: 1px 0;',\n  '  padding-bottom: 3px;',\n  '  padding-top: 3px;',\n  '}',\n\n  /* State: selected/checked. */\n  '.goog-menuitem-checkbox,',\n  '.goog-menuitem-icon {',\n  '  background-repeat: no-repeat;',\n  '  height: 16px;',\n  '  left: 6px;',\n  '  position: absolute;',\n  '  right: auto;',\n  '  vertical-align: middle;',\n  '  width: 16px;',\n  '}',\n\n  /* BiDi override for the selected/checked state. */\n  /* #noflip */\n  '.goog-menuitem-rtl .goog-menuitem-checkbox,',\n  '.goog-menuitem-rtl .goog-menuitem-icon {',\n     /* Flip left/right positioning. */\n  '  left: auto;',\n  '  right: 6px;',\n  '}',\n\n  '.goog-option-selected .goog-menuitem-checkbox,',\n  '.goog-option-selected .goog-menuitem-icon {',\n     /* Client apps may override the URL at which they serve the sprite. */\n     /* disable, because we want to use text instead*/\n  //'  background: url(//ssl.gstatic.com/editor/editortoolbar.png) no-repeat -512px 0;',\n  '}',\n\n  /* Keyboard shortcut (\"accelerator\") style. */\n  '.goog-menuitem-accel {',\n  '  color: #999;',\n     /* Keyboard shortcuts are untranslated; always left-to-right. */\n     /* #noflip */\n  '  direction: ltr;',\n  '  left: auto;',\n  '  padding: 0 6px;',\n  '  position: absolute;',\n  '  right: 0;',\n  '  text-align: right;',\n  '}',\n\n  /* BiDi override for shortcut style. */\n  /* #noflip */\n  '.goog-menuitem-rtl .goog-menuitem-accel {',\n     /* Flip left/right positioning and text alignment. */\n  '  left: 0;',\n  '  right: auto;',\n  '  text-align: left;',\n  '}',\n\n  /* Mnemonic styles. */\n  '.goog-menuitem-mnemonic-hint {',\n  '  text-decoration: underline;',\n  '}',\n\n  '.goog-menuitem-mnemonic-separator {',\n  '  color: #999;',\n  '  font-size: 12px;',\n  '  padding-left: 4px;',\n  '}',\n\n  /* Copied from: goog/css/menuseparator.css */\n  /*\n   * Copyright 2009 The Closure Library Authors. All Rights Reserved.\n   *\n   * Use of this source code is governed by the Apache License, Version 2.0.\n   * See the COPYING file for details.\n   */\n\n  /**\n   * Standard styling for menus created by goog.ui.MenuSeparatorRenderer.\n   *\n   * @author attila@google.com (Attila Bodis)\n   */\n\n  '.goog-menuseparator {',\n  '  border-top: 1px solid #ccc;',\n  '  margin: 4px 0;',\n  '  padding: 0;',\n  '}',\n\n  /**\n   * Standard styling for select menus\n   */\n  '.goog-flat-menu-button {',\n  '  background-color: #fff;',\n  '  border: 1px solid #c9c9c9;',\n  '  color: #333;',\n  '  cursor: pointer;',\n  '  font: normal 95%;',\n  '  list-style: none;',\n  '  margin: 0 2px;',\n  '  outline: none;',\n  '  padding: 1px 4px;',\n  '  position: relative;',\n  '  text-decoration: none;',\n  '  vertical-align: middle;',\n  '}',\n\n  '.goog-flat-menu-button-disabled * {',\n  '  border-color: #ccc;',\n  '  color: #999;',\n  '  cursor: default;',\n  '}',\n\n  '.goog-flat-menu-button-hover {',\n  '  border-color: #9cf #69e #69e #7af !important; /* Hover border wins. */',\n  '}',\n\n  '.goog-flat-menu-button-active {',\n  '  background-color: #bbb;',\n  '  background-position: bottom left;',\n  '}',\n\n  '.goog-flat-menu-button-focused {',\n  '  border-color: #bbb;',\n  '}',\n\n  '.goog-flat-menu-button-caption {',\n  '  padding-right: 10px;',\n  '  vertical-align: top;',\n  '}',\n\n  '.goog-flat-menu-button-dropdown {',\n  '  /* Client apps may override the URL at which they serve the sprite. */',\n  '  background: url(https://ssl.gstatic.com/editor/editortoolbar.png) no-repeat -388px 0;',\n  '  position: absolute;',\n  '  right: 2px;',\n  '  top: 0;',\n  '  vertical-align: top;',\n  '  width: 7px;',\n  '}',\n\n  '.goog-inline-block {',\n  '  position: relative;',\n  '  display: -moz-inline-box; /* Ignored by FF3 and later. */',\n  '  display: inline-block;',\n  '}',\n\n  ''\n];\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2013 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview A div that floats on top of Blockly.  This singleton contains\n *     temporary HTML UI widgets that the user is currently interacting with.\n *     E.g. text input areas, colour pickers, context menus.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.WidgetDiv');\n\ngoog.require('Blockly.Css');\ngoog.require('goog.dom');\n\n\n/**\n * The HTML container.  Set once by inject.js's Blockly.createDom_.\n * @type Element\n */\nBlockly.WidgetDiv.DIV = null;\n\n/**\n * The object currently using this container.\n * @private\n * @type Object \n */\nBlockly.WidgetDiv.owner_ = null;\n\n/**\n * Optional cleanup function set by whichever owner uses the widget.\n * @private\n * @type Function\n */\nBlockly.WidgetDiv.dispose_ = null;\n\n/**\n * Initialize and display the widget div.  Close the old one if needed.\n * @param {!Object} newOwner The owner that will be using this container.\n * @param {Function} dispose Optional cleanup function to be run when the widget\n *   is closed.\n */\nBlockly.WidgetDiv.show = function(newOwner, dispose) {\n  Blockly.WidgetDiv.hide();\n  Blockly.WidgetDiv.owner_ = newOwner;\n  Blockly.WidgetDiv.dispose_ = dispose;\n  Blockly.WidgetDiv.DIV.style.display = 'block';\n};\n\n/**\n * Is the container visible?\n * @return {boolean} True if visible.\n */\nBlockly.WidgetDiv.isVisible = function() {\n  return !!Blockly.WidgetDiv.owner_;\n};\n\n/**\n * Destroy the widget and hide the div.\n */\nBlockly.WidgetDiv.hide = function() {\n  if (Blockly.WidgetDiv.owner_) {\n    Blockly.WidgetDiv.DIV.style.display = 'none';\n    Blockly.WidgetDiv.dispose_ && Blockly.WidgetDiv.dispose_();\n    Blockly.WidgetDiv.owner_ = null;\n    Blockly.WidgetDiv.dispose_ = null;\n    goog.dom.removeChildren(Blockly.WidgetDiv.DIV);\n  }\n};\n\n/**\n * Destroy the widget and hide the div if it is being used by the specified\n *   object.\n * @param {!Object} oldOwner The object that was using this container.\n */\nBlockly.WidgetDiv.hideIfOwner = function(oldOwner) {\n  if (Blockly.WidgetDiv.isOwner(oldOwner)) {\n    Blockly.WidgetDiv.hide();\n  }\n};\n\nBlockly.WidgetDiv.isOwner = function(owner) {\n  return Blockly.WidgetDiv.owner_ == owner;\n};\n\n/**\n * Position the widget at a given location.  Prevent the widget from going\n * offscreen top or left (right in RTL).\n * @param {number} anchorX Horizontal location (window coorditates, not body).\n * @param {number} anchorY Vertical location (window coorditates, not body).\n * @param {!goog.math.Size} widowSize Height/width of window.\n * @param {!goog.math.Coordinate} scrollOffset X/y of window scrollbars.\n */\nBlockly.WidgetDiv.position = function(anchorX, anchorY, windowSize,\n                                      scrollOffset) {\n  // Don't let the widget go above the top edge of the window.\n  if (anchorY < scrollOffset.y) {\n    anchorY = scrollOffset.y;\n  }\n  if (Blockly.RTL) {\n    // Don't let the menu go right of the right edge of the window.\n    if (anchorX > windowSize.width + scrollOffset.x) {\n      anchorX = windowSize.width + scrollOffset.x;\n    }\n  } else {\n    // Don't let the widget go left of the left edge of the window.\n    if (anchorX < scrollOffset.x) {\n      anchorX = scrollOffset.x;\n    }\n  }\n  Blockly.WidgetDiv.DIV.style.left = anchorX + 'px';\n  Blockly.WidgetDiv.DIV.style.top = anchorY + 'px';\n};\n\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Functions for injecting Blockly into a web page.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.inject');\n\ngoog.require('Blockly.Css');\ngoog.require('Blockly.BlockSpaceEditor');\ngoog.require('goog.dom');\n\n/**\n * Initialize the SVG document with various handlers.\n * @param {!Element} container Containing element.\n * @param {Object} [opt_options] Optional dictionary of options.\n * @param {AudioPlayer} [opt_audioPlayer]\n *\n */\nBlockly.inject = function(container, opt_options, opt_audioPlayer) {\n  // Verify that the container is in document.\n  if (!goog.dom.contains(document, container)) {\n    throw 'Error: container is not in current document.';\n  }\n  if (opt_options) {\n    // TODO(scr): don't mix this in to global variables.\n    goog.mixin(Blockly, Blockly.parseOptions_(opt_options));\n  }\n\n  // Closure can be trusted to create HTML widgets with the proper direction.\n  goog.ui.Component.setDefaultRightToLeft(Blockly.RTL);\n\n  // Load CSS\n  Blockly.Css.inject(container);\n\n  // Load sounds\n  if (opt_audioPlayer) {\n    Blockly.audioPlayer = opt_audioPlayer;\n    Blockly.registerUISounds_(Blockly.audioPlayer);\n  }\n\n  /**\n   * @type {Blockly.BlockSpaceEditor}\n   */\n  Blockly.mainBlockSpaceEditor = new Blockly.BlockSpaceEditor(container);\n\n  /**\n   * @type {Blockly.BlockSpace}\n   */\n  Blockly.mainBlockSpace = Blockly.mainBlockSpaceEditor.blockSpace;\n  Blockly.fireUiEvent(document, Blockly.BlockSpace.EVENTS.MAIN_BLOCK_SPACE_CREATED);\n\n  if (Blockly.useModalFunctionEditor) {\n    /** @type {Blockly.FunctionEditor} */\n    Blockly.functionEditor = new Blockly.FunctionEditor();\n  } else if (Blockly.useContractEditor) {\n    Blockly.functionEditor = new Blockly.ContractEditor({\n      disableExamples: opt_options && opt_options.disableExamples\n    });\n    /** @type {Blockly.ContractEditor} */\n    Blockly.contractEditor = Blockly.functionEditor;\n  }\n\n  /**\n   * @type {Blockly.BlockSpace}\n   */\n  Blockly.focusedBlockSpace = Blockly.mainBlockSpace;\n};\n\n/**\n * Configure Blockly to behave according to a set of options.\n * @param {!Object} options Dictionary of options.\n * @return {Object} Parsed options.\n * @private\n */\nBlockly.parseOptions_ = function(options) {\n  var hasCategories, hasTrashcan, hasCollapse, grayOutUndeletableBlocks, tree,\n    hasScrollbars;\n\n  var readOnly = !!options['readOnly'];\n  var showUnusedBlocks = !!options['showUnusedBlocks'];\n\n  if (readOnly) {\n    hasCategories = false;\n    hasTrashcan = false;\n    hasCollapse = false;\n    grayOutUndeletableBlocks = false;\n    tree = null;\n  } else {\n    var tree = options['toolbox'];\n    if (tree) {\n      if (typeof tree != 'string' && typeof XSLTProcessor == 'undefined') {\n        // In this case the tree will not have been properly built by the\n        // browser. The HTML will be contained in the element, but it will\n        // not have the proper DOM structure since the browser doesn't support\n        // XSLTProcessor (XML -> HTML). This is the case in IE 9+.\n        tree = tree.outerHTML;\n      }\n      if (typeof tree == 'string') {\n        tree = Blockly.Xml.textToDom(tree);\n      }\n      hasCategories = !!tree.getElementsByTagName('category').length;\n    } else {\n      tree = null;\n      hasCategories = false;\n    }\n    hasTrashcan = options['trashcan'];\n    if (hasTrashcan === undefined) {\n      hasTrashcan = hasCategories;\n    }\n    hasCollapse = options['collapse'];\n    if (hasCollapse === undefined) {\n      hasCollapse = hasCategories;\n    }\n    grayOutUndeletableBlocks = options['grayOutUndeletableBlocks'];\n    if (grayOutUndeletableBlocks === undefined) {\n      grayOutUndeletableBlocks = false;\n    }\n  }\n  if (options['scrollbars']) {\n    options['hasVerticalScrollbars'] = true;\n    options['hasHorizontalScrollbars'] = true;\n  }\n  var topLevelProcedureAutopopulate = options['topLevelProcedureAutopopulate'] || false;\n  if (topLevelProcedureAutopopulate && hasCategories) {\n    console.warn(\"Don't use topLevelProcedureAutopopulate with a categorized toolbox\");\n    topLevelProcedureAutopopulate = false;\n  }\n  return {\n    isPortrait: options[\"isPortrait\"],\n    RTL: !!options['rtl'],\n    collapse: hasCollapse,\n    readOnly: readOnly,\n    showUnusedBlocks: showUnusedBlocks,\n    maxBlocks: options['maxBlocks'] || Infinity,\n    assetUrl: options['assetUrl'] || function(path) {\n      return './' + path;\n    },\n    hasCategories: hasCategories,\n    hasHorizontalScrollbars: options['hasHorizontalScrollbars'],\n    hasVerticalScrollbars: options['hasVerticalScrollbars'],\n    customSimpleDialog: options['customSimpleDialog'],\n    hasTrashcan: hasTrashcan,\n    varsInGlobals: options['varsInGlobals'] || false,\n    languageTree: tree,\n    disableIfElseEditing: options['disableIfElseEditing'] || false,\n    disableParamEditing: options['disableParamEditing'] || false,\n    disableVariableEditing: options['disableVariableEditing'] || false,\n    disableProcedureAutopopulate: options['disableProcedureAutopopulate'] || false,\n    topLevelProcedureAutopopulate: topLevelProcedureAutopopulate,\n    useModalFunctionEditor: options['useModalFunctionEditor'] || false,\n    useContractEditor: options['useContractEditor'] || false,\n    disableExamples: options['disableExamples'] || false,\n    defaultNumExampleBlocks: options['defaultNumExampleBlocks'] || 0,\n    grayOutUndeletableBlocks: grayOutUndeletableBlocks,\n    editBlocks: options['editBlocks'] || false,\n    showExampleTestButtons: options['showExampleTestButtons'] || false,\n    valueTypeTabShapeMap: options['valueTypeTabShapeMap'] || {},\n    typeHints: options['typeHints'] || false\n  };\n};\n\n/**\n * Initialize some core blockly sounds\n * @param {AudioPlayer} audioPlayer\n * @private\n */\nBlockly.registerUISounds_ = function(audioPlayer) {\n  // Load the sounds.\n  audioPlayer.register({\n    id: 'click',\n    mp3: Blockly.assetUrl('media/click.mp3'),\n    wav: Blockly.assetUrl('media/click.wav'),\n    ogg: Blockly.assetUrl('media/click.ogg')\n  });\n  audioPlayer.register({\n    id: 'delete',\n    mp3: Blockly.assetUrl('media/delete.mp3'),\n    wav: Blockly.assetUrl('media/delete.wav'),\n    ogg: Blockly.assetUrl('media/delete.ogg')\n  });\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Tool for caching the result of expensive deterministic\n * functions.\n *\n * @see http://en.wikipedia.org/wiki/Memoization\n *\n */\n\ngoog.provide('goog.memoize');\n\n\n/**\n * Decorator around functions that caches the inner function's return values.\n *\n * To cache parameterless functions, see goog.functions.cacheReturnValue.\n *\n * @param {Function} f The function to wrap. Its return value may only depend\n *     on its arguments and 'this' context. There may be further restrictions\n *     on the arguments depending on the capabilities of the serializer used.\n * @param {function(number, Object): string=} opt_serializer A function to\n *     serialize f's arguments. It must have the same signature as\n *     goog.memoize.simpleSerializer. It defaults to that function.\n * @this {Object} The object whose function is being wrapped.\n * @return {!Function} The wrapped function.\n */\ngoog.memoize = function(f, opt_serializer) {\n  var serializer = opt_serializer || goog.memoize.simpleSerializer;\n\n  return function() {\n    if (goog.memoize.ENABLE_MEMOIZE) {\n      // In the strict mode, when this function is called as a global function,\n      // the value of 'this' is undefined instead of a global object. See:\n      // https://developer.mozilla.org/en/JavaScript/Strict_mode\n      var thisOrGlobal = this || goog.global;\n      // Maps the serialized list of args to the corresponding return value.\n      var cache = thisOrGlobal[goog.memoize.CACHE_PROPERTY_] ||\n          (thisOrGlobal[goog.memoize.CACHE_PROPERTY_] = {});\n      var key = serializer(goog.getUid(f), arguments);\n      return cache.hasOwnProperty(key) ?\n          cache[key] :\n          (cache[key] = f.apply(this, arguments));\n    } else {\n      return f.apply(this, arguments);\n    }\n  };\n};\n\n\n/**\n * @define {boolean} Flag to disable memoization in unit tests.\n */\ngoog.define('goog.memoize.ENABLE_MEMOIZE', true);\n\n\n/**\n * Clears the memoization cache on the given object.\n * @param {Object} cacheOwner The owner of the cache. This is the {@code this}\n *     context of the memoized function.\n */\ngoog.memoize.clearCache = function(cacheOwner) {\n  cacheOwner[goog.memoize.CACHE_PROPERTY_] = {};\n};\n\n\n/**\n * Name of the property used by goog.memoize as cache.\n * @type {string}\n * @private\n */\ngoog.memoize.CACHE_PROPERTY_ = 'closure_memoize_cache_';\n\n\n/**\n * Simple and fast argument serializer function for goog.memoize.\n * Supports string, number, boolean, null and undefined arguments. Doesn't\n * support \\x0B characters in the strings.\n * @param {number} functionUid Unique identifier of the function whose result\n *     is cached.\n * @param {?{length:number}} args The arguments that the function to memoize is\n *     called with. Note: it is an array-like object, because supports indexing\n *     and has the length property.\n * @return {string} The list of arguments with type information concatenated\n *     with the functionUid argument, serialized as \\x0B-separated string.\n */\ngoog.memoize.simpleSerializer = function(functionUid, args) {\n  var context = [functionUid];\n  for (var i = args.length - 1; i >= 0; --i) {\n    context.push(typeof args[i], args[i]);\n  }\n  return context.join('\\x0B');\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Utility methods.\n * These methods are not specific to Blockly, and could be factored out if\n * a JavaScript framework such as Closure were used.\n * @author fraser@google.com (Neil Fraser)\n */\n\ngoog.provide('Blockly.utils');\n\ngoog.require('goog.array');\ngoog.require('goog.memoize');\ngoog.require('goog.events');\ngoog.require('goog.math.Rect');\n\n/**\n * Add a CSS class to a element.\n * Similar to Closure's goog.dom.classes.add, except it handles SVG elements.\n * @param {!Element} element DOM element to add class to.\n * @param {string} className Name of class to add.\n * @private\n */\nBlockly.addClass_ = function(element, className) {\n  var classes = element.getAttribute('class') || '';\n  if (!Blockly.stringContainsClass_(classes, className)) {\n    if (classes) {\n      classes += ' ';\n    }\n    element.setAttribute('class', classes + className);\n  }\n};\n\nBlockly.elementHasClass_ = function (element, className) {\n  return Blockly.stringContainsClass_(element.getAttribute('class') || '', className);\n};\n\nBlockly.stringContainsClass_ = function (classes, className) {\n  return (' ' + classes + ' ').indexOf(' ' + className + ' ') !== -1;\n};\n\n/**\n * Remove a CSS class from a element.\n * Similar to Closure's goog.dom.classes.remove, except it handles SVG elements.\n * @param {!Element} element DOM element to remove class from.\n * @param {string} className Name of class to remove.\n * @private\n */\nBlockly.removeClass_ = function(element, className) {\n  var classes = element.getAttribute('class');\n  if ((' ' + classes + ' ').indexOf(' ' + className + ' ') != -1) {\n    var classList = classes.split(/\\s+/);\n    for (var i = 0; i < classList.length; i++) {\n      if (!classList[i] || classList[i] == className) {\n        classList.splice(i, 1);\n        i--;\n      }\n    }\n    if (classList.length) {\n      element.setAttribute('class', classList.join(' '));\n    } else {\n      element.removeAttribute('class');\n    }\n  }\n};\n\n/** @typedef {!Array.<!Array>} BindData */\n\n/**\n * Bind an event to a function call.\n * @param {!Element} element Element upon which to listen.\n * @param {string} name Event name to listen to (e.g. 'mousedown').\n * @param {Object} thisObject The value of 'this' in the function.\n * @param {!Function} func Function to call when event is triggered.\n * @param {boolean} [useCapture=false] If true, bind event against capture\n *        phase instead of bubble phase.\n * @return {BindData} Opaque data that can be passed to unbindEvent_.\n * @private\n */\nBlockly.bindEvent_ = function(element, name, thisObject, func, useCapture) {\n  // Coerce useCapture to boolean\n  useCapture = !!useCapture;\n  var bindData = [];\n  var wrapFunc;\n  if (!element.addEventListener) {\n    throw 'Element is not a DOM node with addEventListener.';\n  }\n  wrapFunc = function(e) {\n    func.apply(thisObject, arguments);\n  };\n  // Add equivalent touch event.\n  var equivTouchEvent = Blockly.bindEvent_.TOUCH_MAP[name];\n  if (equivTouchEvent) {\n    // Also bind the mouse event, unless the browser supports pointer events.\n    if (!window.navigator.pointerEnabled && !window.navigator.msPointerEnabled) {\n      element.addEventListener(name, wrapFunc, useCapture);\n      bindData.push([element, name, wrapFunc, useCapture]);\n    }\n    wrapFunc = function (e) {\n      if (e.target && e.target.style) {\n        var targetStyle = e.target.style;\n        if (targetStyle.touchAction) {  // required for IE 11+\n          targetStyle.touchAction = \"none\";\n        } else if (targetStyle.msTouchAction) {  // required for IE 10\n          targetStyle.msTouchAction = \"none\";\n        }\n      }\n\n      // Punt on multitouch events.\n      var touchPoints = e.changedTouches || [e];\n      for (var i = 0; i < touchPoints.length; ++i) {\n        // Map the touch event's properties to the event.\n        e.clientX = touchPoints[i].clientX;\n        e.clientY = touchPoints[i].clientY;\n\n        func.apply(thisObject, arguments);\n      }\n    };\n    element.addEventListener(equivTouchEvent, wrapFunc, useCapture);\n    bindData.push([element, equivTouchEvent, wrapFunc, useCapture]);\n  } else {\n    element.addEventListener(name, wrapFunc, useCapture);\n    bindData.push([element, name, wrapFunc, useCapture]);\n  }\n  return bindData;\n};\n\n/**\n * The TOUCH_MAP lookup dictionary specifies additional touch events to fire,\n * in conjunction with mouse events.\n *\n * Note that this order is important; if pointer events are available,\n * we always want to prefer them. In some cases such as Windows 8.1\n * phones, both pointer and touch events are available.\n *\n * @type {Object}\n */\nBlockly.bindEvent_.TOUCH_MAP = {};\nif (window.navigator.pointerEnabled) {  // IE 11+ support\n  Blockly.bindEvent_.TOUCH_MAP = {\n    mousedown: 'pointerdown',\n    mousemove: 'pointermove',\n    mouseup: 'pointerup'\n  };\n} else if (window.navigator.msPointerEnabled) {  // IE 10 support\n  Blockly.bindEvent_.TOUCH_MAP = {\n    mousedown: 'MSPointerDown',\n    mousemove: 'MSPointerMove',\n    mouseup: 'MSPointerUp'\n  };\n} else if ('ontouchstart' in document.documentElement) {\n  Blockly.bindEvent_.TOUCH_MAP = {\n    mousedown: 'touchstart',\n    mousemove: 'touchmove',\n    mouseup: 'touchend'\n  };\n}\n\n/**\n * Unbind one or more events event from a function call.\n * @param {BindData} BindData Opaque data from bindEvent_.  This list is\n *     emptied during the course of calling this function.\n * @return {!Function} The function call.\n * @private\n */\nBlockly.unbindEvent_ = function(bindData) {\n  while (bindData.length) {\n    var bindDatum = bindData.pop();\n    var element = bindDatum[0];\n    var name = bindDatum[1];\n    var func = bindDatum[2];\n    var useCapture = bindDatum[3];\n    element.removeEventListener(name, func, useCapture);\n  }\n  return func;\n};\n\n/**\n * Fire a synthetic event.\n * @param {!Element} element The event's target element.\n * @param {string} eventName Name of event (e.g. 'click').\n * @param {object} opt_properties optional properties to add to the\n *    created event object (e.g. { screenX: 10 })\n */\nBlockly.fireUiEvent = function(element, eventName, opt_properties) {\n  opt_properties = opt_properties || {};\n\n  var doc = document;\n  if (doc.createEvent) {\n    // W3\n    var evt = doc.createEvent('UIEvents');\n    goog.object.extend(evt, opt_properties);\n    evt.initEvent(eventName, true, true);  // event type, bubbling, cancelable\n    element.dispatchEvent(evt);\n  } else if (doc.createEventObject) {\n    // MSIE\n    var evt = doc.createEventObject();\n    goog.object.extend(evt, opt_properties);\n    element.fireEvent('on' + eventName, evt);\n  } else {\n    throw 'FireEvent: No event creation mechanism.';\n  }\n};\n\n/**\n * Don't do anything for this event, just halt propagation.\n * @param {!Event} e An event.\n */\nBlockly.noEvent = function(e) {\n  // This event has been handled.  No need to bubble up to the document.\n  e.preventDefault();\n  e.stopPropagation();\n};\n\n/**\n * Return the coordinates of the top-left corner of this element relative to\n * its parent.\n * @param {!Element} element Element to find the coordinates of.\n * @return {!Object} Object with .x and .y properties.\n * @private\n */\nBlockly.getRelativeXY = function(element) {\n  var xy = {x: 0, y: 0};\n  // First, check for x and y attributes.\n  var x = element.getAttribute('x');\n  if (x) {\n    xy.x = parseFloat(x);\n  }\n  var y = element.getAttribute('y');\n  if (y) {\n    xy.y = parseFloat(y);\n  }\n  // Second, check for transform=\"translate(...)\" attribute.\n  var transform = element.getAttribute('transform');\n  // Note that Firefox and IE (9,10) return 'translate(12)' instead of\n  // 'translate(12, 0)'.\n  // Note that IE (9,10) returns 'translate(16 8)' instead of\n  // 'translate(16, 8)'.\n  var r = transform &&\n    transform.match(/translate\\(\\s*([-\\d.]+)([ ,]\\s*([-\\d.]+)\\s*\\))?/);\n  if (r) {\n    xy.x += parseFloat(r[1]);\n    if (r[3]) {\n      xy.y += parseFloat(r[3]);\n    }\n  }\n  return xy;\n};\n\n/**\n * Return the absolute coordinates of the top-left corner of this element.\n * The origin (0,0) is the top-left corner of the Blockly svg.\n * @param {!Element} element Element to find the coordinates of.\n * @param {Element=} opt_svgParent optional parent <svg> element, otherwise\n *    `element`'s parents will be searched\n * @return {!Object} Object with .x and .y properties.\n * @private\n */\nBlockly.getSvgXY_ = function(element, opt_svgParent) {\n  var x = 0;\n  var y = 0;\n  var topMostSVG = opt_svgParent || Blockly.topMostSVGParent(element);\n  do {\n    // Loop through this block and every parent.\n    var xy = Blockly.getRelativeXY(element);\n    x += xy.x;\n    y += xy.y;\n    element = element.parentNode;\n  } while (element && element !== topMostSVG);\n  return {x: x, y: y};\n};\n\n/**\n * Return the absolute coordinates of the top-left corner of this element.\n * The origin (0,0) is the top-left corner of the page body.\n * @param {!Element} element Element to find the coordinates of.\n * @param {Element=} opt_svgParent optional parent <svg> element, otherwise\n *    `element`'s parents will be searched\n * @return {!Object} Object with .x and .y properties.\n * @private\n */\nBlockly.getAbsoluteXY_ = function(element, opt_svgParent) {\n  var xy = Blockly.getSvgXY_(element, opt_svgParent);\n  return Blockly.convertCoordinates(xy.x, xy.y, opt_svgParent || Blockly.topMostSVGParent(element), false);\n};\n\n/**\n * Find top-most SVG element the given element is a child of\n * @param {!Element} element Element to find the coordinates of.\n * @return {!Element} topmost SVG element, if one exists, or the main editor SVG\n */\nBlockly.topMostSVGParent = function(element) {\n  var topMostSVG = null;\n\n  while (element) {\n    if (element.tagName === 'svg') {\n      topMostSVG = element;\n    }\n    element = goog.dom.getParentElement(element);\n  }\n\n  return (topMostSVG || Blockly.mainBlockSpaceEditor.getSVGElement());\n};\n\n/**\n * Helper method for creating SVG elements.\n * @param {string} name Element's tag name.\n * @param {!Object} attrs Dictionary of attribute names and values.\n * @param {Element=} opt_parent Optional parent on which to append the element.\n * @param {Object=} opt_options\n * @return {!SVGElement} Newly created SVG element.\n */\nBlockly.createSvgElement = function(name, attrs, opt_parent, opt_options) {\n  opt_options = opt_options || {};\n\n  var e = /** @type {!SVGElement} */ (\n      document.createElementNS(Blockly.SVG_NS, name));\n  for (var key in attrs) {\n    e.setAttribute(key, attrs[key]);\n  }\n  // IE defines a unique attribute \"runtimeStyle\", it is NOT applied to\n  // elements created with createElementNS. However, Closure checks for IE\n  // and assumes the presence of the attribute and crashes.\n  if (document.body.runtimeStyle) {  // Indicates presence of IE-only attr.\n    e.runtimeStyle = e.currentStyle = e.style;\n  }\n  if (opt_parent) {\n    if (opt_options.belowExisting) {\n      goog.dom.insertChildAt(opt_parent, e, 0);\n    } else {\n      goog.dom.appendChild(opt_parent, e);\n    }\n  }\n  return e;\n};\n\n/**\n * Is this event a right-click?\n * @param {!Event} e Mouse event.\n * @return {boolean} True if right-click.\n */\nBlockly.isRightButton = function(e) {\n  // Control-clicking in WebKit on Mac OS X fails to change button to 2.\n  return e.button == 2 || e.ctrlKey;\n};\n\n/**\n * Convert between HTML coordinates and SVG coordinates.\n * @param {number} x X input coordinate.\n * @param {number} y Y input coordinate.\n * @param {Element} svg parent SVG element\n * @param {boolean} toSvg True to convert to SVG coordinates.\n *     False to convert to mouse/HTML coordinates.\n * @return {!Object} Object with x and y properties in output coordinates.\n */\nBlockly.convertCoordinates = function(x, y, svg, toSvg) {\n  if (toSvg) {\n    x -= window.pageXOffset;\n    y -= window.pageYOffset;\n  }\n  var svgPoint = svg.createSVGPoint();\n  svgPoint.x = x;\n  svgPoint.y = y;\n  var matrix = svg.getScreenCTM();\n  if (!matrix) {\n    // Firefox returns null for getScreenCTM if svg is hidden or has 0 height.\n    var clientRect = svg.getBoundingClientRect();\n    matrix = svg.createSVGMatrix(clientRect.left, clientRect.top);\n  }\n  if (toSvg) {\n    matrix = matrix.inverse();\n  }\n  var xy = svgPoint.matrixTransform(matrix);\n  if (!toSvg) {\n    if (!((goog.userAgent.IPAD || goog.userAgent.IPHONE) &&\n        !goog.userAgent.isVersionOrHigher(538))) {\n      // Do nothing here on iOS 7 and earlier. svg.getScreenCTM\n      // ignores scrolling in those iOS versions, so the scroll\n      // position is already accounted for.\n      // https://bugs.webkit.org/show_bug.cgi?id=44083\n\n      xy.x += window.pageXOffset;\n      xy.y += window.pageYOffset;\n    }\n  }\n  return xy;\n};\n\n/**\n * Return the converted coordinates of the given mouse event.\n * The origin (0,0) is the top-left corner of the Blockly svg.\n * @param {!Event} e Mouse event.\n * @param {Element=} opt_svgParent optional parent <svg> element, otherwise\n *    `element`'s parents will be searched\n * @return {!Object} Object with .x and .y properties.\n */\nBlockly.mouseToSvg = function(e, opt_svgParent) {\n  return Blockly.mouseCoordinatesToSvg(\n    e.clientX,\n    e.clientY,\n    opt_svgParent || Blockly.topMostSVGParent(e.target));\n};\n\n/**\n * Return the converted coordinates of the given mouse coordinates.\n * The origin (0,0) is the top-left corner of the Blockly svg.\n * @param {number} clientX Mouse client X.\n * @param {number} clientY Mouse client Y.\n * @param {Element=} target element.\n * @return {Object} coordinate with .x and .y properties.\n */\nBlockly.mouseCoordinatesToSvg = function(clientX, clientY, target) {\n  return Blockly.convertCoordinates(\n      clientX + window.pageXOffset,\n      clientY + window.pageYOffset,\n      target, true);\n};\n\n/**\n * Converts given SVG coordinates to blockspace coordinates\n * @param {goog.math.Coordinate} coordinates\n * @param {Blockly.BlockSpace} blockSpace\n * @returns {goog.math.Coordinate}\n */\nBlockly.svgCoordinatesToViewport = function(coordinates, blockSpace) {\n  var blockSpaceMetrics = blockSpace.getMetrics();\n  return new goog.math.Coordinate(\n    coordinates.x - blockSpaceMetrics.absoluteLeft,\n    coordinates.y - blockSpaceMetrics.absoluteTop);\n};\n\n/**\n * Converts given SVG coordinates to blockspace coordinates\n * @param {goog.math.Coordinate} coordinates\n * @param {Blockly.BlockSpace} blockSpace\n * @returns {goog.math.Coordinate}\n */\nBlockly.viewportCoordinateToBlockSpace = function(coordinates, blockSpace) {\n  var viewportBox = blockSpace.getViewportBox();\n  return new goog.math.Coordinate(coordinates.x + viewportBox.left,\n    coordinates.y + viewportBox.top);\n};\n\n/**\n * Given an array of strings, return the length of the shortest one.\n * @param {!Array<string>} array Array of strings.\n * @return {number} Length of shortest string.\n */\nBlockly.shortestStringLength = function(array) {\n  if (!array.length) {\n    return 0;\n  }\n  var len = array[0].length;\n  for (var i = 1; i < array.length; i++) {\n    len = Math.min(len, array[i].length);\n  }\n  return len;\n};\n\n/**\n * Given an array of strings, return the length of the common prefix.\n * Words may not be split.  Any space after a word is included in the length.\n * @param {!Array<string>} array Array of strings.\n * @param {?number} opt_shortest Length of shortest string.\n * @return {number} Length of common prefix.\n */\nBlockly.commonWordPrefix = function(array, opt_shortest) {\n  if (!array.length) {\n    return 0;\n  } else if (array.length == 1) {\n    return array[0].length;\n  }\n  var wordPrefix = 0;\n  var max = opt_shortest || Blockly.shortestStringLength(array);\n  for (var len = 0; len < max; len++) {\n    var letter = array[0][len];\n    for (var i = 1; i < array.length; i++) {\n      if (letter != array[i][len]) {\n        return wordPrefix;\n      }\n    }\n    if (letter == ' ') {\n      wordPrefix = len + 1;\n    }\n  }\n  for (var i = 1; i < array.length; i++) {\n    var letter = array[i][len];\n    if (letter && letter != ' ') {\n      return wordPrefix;\n    }\n  }\n  return max;\n};\n\n/**\n * Given an array of strings, return the length of the common suffix.\n * Words may not be split.  Any space after a word is included in the length.\n * @param {!Array<string>} array Array of strings.\n * @param {?number} opt_shortest Length of shortest string.\n * @return {number} Length of common suffix.\n */\nBlockly.commonWordSuffix = function(array, opt_shortest) {\n  if (!array.length) {\n    return 0;\n  } else if (array.length == 1) {\n    return array[0].length;\n  }\n  var wordPrefix = 0;\n  var max = opt_shortest || Blockly.shortestStringLength(array);\n  for (var len = 0; len < max; len++) {\n    var letter = array[0].substr(-len - 1, 1);\n    for (var i = 1; i < array.length; i++) {\n      if (letter != array[i].substr(-len - 1, 1)) {\n        return wordPrefix;\n      }\n    }\n    if (letter == ' ') {\n      wordPrefix = len + 1;\n    }\n  }\n  for (var i = 1; i < array.length; i++) {\n    var letter = array[i].charAt(array[i].length - len - 1);\n    if (letter && letter != ' ') {\n      return wordPrefix;\n    }\n  }\n  return max;\n};\n\n/**\n * Is the given string a number (includes negative and decimals).\n * @param {string} str Input string.\n * @return {boolean} True if number, false otherwise.\n */\nBlockly.isNumber = function(str) {\n  return !!str.match(/^\\s*-?\\d+(\\.\\d+)?\\s*$/);\n};\n\nBlockly.isMsie = function() {\n  return window.navigator.userAgent.indexOf(\"MSIE\") >= 0;\n};\n\nBlockly.isTrident = function() {\n  return window.navigator.userAgent.indexOf(\"Trident\") >= 0;\n};\n\nBlockly.isIOS = function() {\n  return /iP(hone|od|ad)/.test(navigator.platform);\n};\n\n// Return the version of Internet Explorer (8+) or undefined if not IE.\nBlockly.ieVersion = function() {\n  return document.documentMode;\n};\n\n/**\n * Determine what colour overlaying the given foreground and background would result in,\n * given the opacity of the foreground colour\n * @param foregroundColor {string} hex foreground colour\n * @param backgroundColor {string} hex background colour\n * @param foregroundOpacity {number} opacity, number from 0.0 to 1.0\n * @returns {string} the hex value of the resulting colour\n */\nBlockly.mixColoursWithForegroundOpacity = function(foregroundColor, backgroundColor, foregroundOpacity) {\n  var foregroundRGB = goog.color.hexToRgb(foregroundColor);\n  var backgroundRGB = goog.color.hexToRgb(backgroundColor);\n  var resultRed = Math.round(backgroundRGB[0] * (1 - foregroundOpacity) + foregroundRGB[0] * foregroundOpacity);\n  var resultGreen = Math.round(backgroundRGB[1] * (1 - foregroundOpacity) + foregroundRGB[1] * foregroundOpacity);\n  var resultBlue = Math.round(backgroundRGB[2] * (1 - foregroundOpacity) + foregroundRGB[2] * foregroundOpacity);\n  return goog.color.rgbToHex(resultRed, resultGreen, resultBlue);\n};\n\n/**\n * Converts a printer-style string range to an array of numbers\n * e.g., \"1,2,3-5\" becomes [1,2,3,4,5]\n * @param rangeString {string} printer-style range, e.g., \"1,2,3-5\"\n * @returns  {Array.<!Number>}\n */\nBlockly.printerRangeToNumbers = function(rangeString) {\n  var rangeStringNoSpaces = rangeString.replace(/ /g, '');\n  var rangeItems = rangeStringNoSpaces.split(',');\n  var fullNumberList = [];\n  var rangeRegexp = /^(\\d+)\\-(\\d+)$/; // e.g., \"5-10\", \"20-30\"\n  var numberRegexp = /^(\\d+)$/; // e.g., \"3\", \"500\"\n  for (var i = 0; i < rangeItems.length; i++) {\n    var numberOrRange = rangeItems[i];\n    var rangeResult = rangeRegexp.exec(numberOrRange);\n    var numberResult = numberRegexp.exec(numberOrRange);\n    if (rangeResult) {\n      var lowerRange = Number(rangeResult[1]);\n      var upperNonInclusive = Number(rangeResult[2]) + 1;\n      var rangeArray = goog.array.range(lowerRange, upperNonInclusive);\n      fullNumberList = fullNumberList.concat(rangeArray);\n    } else if (numberResult) {\n      fullNumberList.push(Number(numberResult[1]));\n    }\n  }\n  return fullNumberList;\n};\n\n/**\n * Generates a globally unique ID\n * @returns {string|*}\n */\nBlockly.getUID = function() {\n  return goog.events.getUniqueId('blocklyUID');\n};\n\n/**\n * Is this event targeting a text input widget?\n * @param {!Event} e An event.\n * @return {boolean} True if text or textarea input.\n */\nBlockly.isTargetInput = function (e) {\n  return e.target.type == 'textarea' || e.target.type == 'text';\n};\n\n/**\n * Cancel the native context menu, unless the focus is on an HTML input widget.\n * @param {!Event} e contextmenu event.\n * @private\n */\nBlockly.blockContextMenu = function (e) {\n  if (!Blockly.isTargetInput(e)) {\n    e.preventDefault();\n  }\n};\n\n/**\n * Get normalized wheel scrolling amount from a given wheel or scrollwheel event\n * - in Safari, processes e.wheelDeltaY instead of e.deltaY, and normalizes\n *   so + is down\n * - in Firefox, multiplies event by 10 to account for browser's smaller deltas\n * @param {!Event} e scrollwheel or wheel event.\n * @return {number|null} wheelDeltaY normalized scroll dy, + is down, or null if\n * no wheel delta present in event\n*/\nBlockly.getNormalizedWheelDeltaY = function (e) {\n  // Safari uses wheelDeltaY (- is down), others use deltaY (+ is down)\n  var wheelDeltaY = e.deltaY || -e.wheelDeltaY; // + is down\n\n  if (!wheelDeltaY) {\n    return null;\n  }\n\n  if (goog.userAgent.GECKO) {\n    // Firefox's deltas are a tenth that of Chrome/Safari.\n    wheelDeltaY *= 10;\n  }\n\n  return wheelDeltaY;\n};\n\n/**\n * Given an outer box, returns a box with the amounts of an inner box's overflow\n * on each side.\n * @param {goog.math.Box} outerBox\n * @param {goog.math.Box} innerBox\n * @return {goog.math.Box} overflow on each side, (+) is amount hanging off\n */\nBlockly.getBoxOverflow = function (outerBox, innerBox) {\n  return new goog.math.Box(\n    Math.max(0, outerBox.top - innerBox.top),\n    Math.max(0, innerBox.right - outerBox.right),\n    Math.max(0, innerBox.bottom - outerBox.bottom),\n    Math.max(0, outerBox.left - innerBox.left));\n};\n\n/**\n * Gets a point's distance outside each side (or negative if inside box)\n * @param {goog.math.Box} outerBox\n * @param {goog.math.Coordinate} innerPoint\n * @return {goog.math.Box} distances to each side, from point's perspective\n */\nBlockly.getPointBoxOverflow = function (outerBox, innerPoint) {\n  return new goog.math.Box(\n    outerBox.top - innerPoint.y,\n    innerPoint.x - outerBox.right,\n    innerPoint.y - outerBox.bottom,\n    outerBox.left - innerPoint.x);\n};\n\n/**\n * @param {goog.math.Box} boxA\n * @param {goog.math.Box} boxB\n * @returns {boolean} whether boxA is wider than boxB\n */\nBlockly.isBoxWiderThan = function (boxA, boxB) {\n  return Blockly.getBoxWidth(boxA) > Blockly.getBoxWidth(boxB);\n};\n\n/**\n * @param {goog.math.Box} boxA\n * @param {goog.math.Box} boxB\n * @returns {boolean} whether boxA is taller than boxB\n */\nBlockly.isBoxTallerThan = function (boxA, boxB) {\n  return Blockly.getBoxHeight(boxA) > Blockly.getBoxHeight(boxB);\n};\n\n/**\n * @param {goog.math.Box} box\n * @return {number} width of box\n */\nBlockly.getBoxWidth = function (box) {\n  return box.right - box.left;\n};\n\n/**\n * @param {goog.math.Box} box\n * @return {number} height of box\n */\nBlockly.getBoxHeight = function (box) {\n  return box.bottom - box.top;\n};\n\n/**\n * @param {number} number\n * @param {number} min\n * @param {number} max\n * @param {boolean} inclusive\n * @return {boolean} whether given number is within range\n */\nBlockly.numberWithin = function (number, min, max, inclusive) {\n  return inclusive?\n    (number >= min && number <= max) :\n    (number > min && number < max);\n};\n\n/**\n * @param {SVGRect} svgRect\n * @returns {goog.math.Rect}\n */\nBlockly.svgRectToRect = function (svgRect) {\n  return new goog.math.Rect(svgRect.x, svgRect.y, svgRect.width,\n    svgRect.height);\n};\n\n\n/**\n * @param {Object} dialogOptions simple dialog options\n * @see FeedbackUtils.prototype.showSimpleDialog in cdo/apps/src/feedback.js\n *     for options\n */\nBlockly.showSimpleDialog = function (dialogOptions) {\n  if (Blockly.customSimpleDialog) {\n    Blockly.customSimpleDialog(dialogOptions);\n  }\n};\n\n/**\n * Direction properties for goog.math.Boxes\n * @type {string[]}\n */\nBlockly.BOX_DIRECTIONS = ['top', 'right', 'bottom', 'left'];\n\n/**\n * Given a box, adds a given amount to any non-zero side.\n * @param {goog.math.Box} box\n * @param {number} amount\n */\nBlockly.addToNonZeroSides = function (box, amount) {\n  Blockly.BOX_DIRECTIONS.forEach(function (direction) {\n    if (box[direction] !== 0) {\n      box[direction] += amount;\n    }\n  });\n};\n\n/**\n * Sets element to ignore pointer events.\n * Note: only use for SVG elements, only those support IE9 and 10\n * {@link https://css-tricks.com/almanac/properties/p/pointer-events/}\n * @param {Element} element - SVG element\n */\nBlockly.svgIgnoreMouseEvents = function (element) {\n  element.style.pointerEvents = 'none';\n};\n\n/**\n * Fires a mousedown, mouseup, click sequence of events on a given target.\n *\n * Note: Intended for testing only. Creates events using MouseEvents.\n * @param target\n */\nBlockly.fireTestClickSequence = function (target) {\n  Blockly.fireTestMouseEvent(target, 'mousedown');\n  Blockly.fireTestMouseEvent(target, 'mouseup');\n  Blockly.fireTestMouseEvent(target, 'click');\n};\n\n/**\n * Creates a mouse event and dispatches it on the given target.\n *\n * Note: this is for testing only. This is not cross-browser friendly.\n * Creates events using MouseEvents.\n * @param {EventTarget} target\n * @param {string} eventName e.g. click, mousedown, mouseup\n */\nBlockly.fireTestMouseEvent = function (target, eventName) {\n  if (!document.createEvent) {\n    throw \"fireTestMouseEvent is only for testing in browsers with createEvent\";\n  }\n\n  target.dispatchEvent(Blockly.makeTestMouseEvent(eventName));\n};\n\n/**\n * Makes a dummy mouse event with the given event name.\n * @param {string} eventName e.g. click, mousedown, mouseup\n */\nBlockly.makeTestMouseEvent = function (eventName) {\n  var event = document.createEvent(\"MouseEvents\");\n  event.initMouseEvent(eventName, true, true, window,\n      0, 0, 0, 0, 0, false, false, false, false, 0, null);\n  return event;\n};\n\n/**\n * Attempts to find a container block with an empty input.\n * @param {Blockly.Block[]} blocks\n * @returns {Blockly.Block|null} block with empty input, or null if none found\n */\nBlockly.findEmptyContainerBlock = function (blocks) {\n  for (var i = 0; i < blocks.length; i++) {\n    var block = blocks[i];\n    if (Blockly.findEmptyInput(block, Blockly.NEXT_STATEMENT)) {\n      return block;\n    }\n  }\n  return null;\n};\n\n/**\n * Finds an empty input of the given input type.\n * @param {Blockly.Block} block\n * @param {number} inputType\n * @returns {Blockly.Input|null} empty input or null if none found\n */\nBlockly.findEmptyInput = function (block, inputType) {\n  return goog.array.find(block.inputList, function(input) {\n    return input.type === inputType && !input.connection.targetConnection;\n  });\n};\n\n/**\n * Aggregates counts for the number of occurrences of unique keys in the given\n * list.\n * @param {string[]} list\n * @returns {Object.<string, number>}\n */\nBlockly.aggregateCounts = function (list) {\n  return list.reduce(function (prev, curr) {\n    var count = prev[curr] || 0;\n    prev[curr] = count + 1;\n    return prev;\n  }, {});\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Colour blocks for Blockly.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Blocks.colour');\n\ngoog.require('Blockly.Blocks');\n\n\nBlockly.Blocks.colour_picker = {\n  // Colour picker.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.COLOUR_PICKER_HELPURL);\n    this.setHSV(196, 1.0, 0.79);\n    this.appendDummyInput()\n        .appendTitle(new Blockly.FieldColour('#ff0000'), 'COLOUR');\n    this.setOutput(true, Blockly.BlockValueType.COLOUR);\n    this.setTooltip(Blockly.Msg.COLOUR_PICKER_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.colour_random = {\n  // Random colour.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.COLOUR_RANDOM_HELPURL);\n    this.setHSV(196, 1.0, 0.79);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.COLOUR_RANDOM_TITLE);\n    this.setOutput(true, Blockly.BlockValueType.COLOUR);\n    this.setTooltip(Blockly.Msg.COLOUR_RANDOM_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.colour_rgb = {\n  // Compose a colour from RGB components.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.COLOUR_RGB_HELPURL);\n    this.setHSV(196, 1.0, 0.79);\n    this.appendValueInput('RED')\n        .setCheck(Blockly.BlockValueType.NUMBER)\n        .setAlign(Blockly.ALIGN_RIGHT)\n        .appendTitle(Blockly.Msg.COLOUR_RGB_TITLE)\n        .appendTitle(Blockly.Msg.COLOUR_RGB_RED);\n    this.appendValueInput('GREEN')\n        .setCheck(Blockly.BlockValueType.NUMBER)\n        .setAlign(Blockly.ALIGN_RIGHT)\n        .appendTitle(Blockly.Msg.COLOUR_RGB_GREEN);\n    this.appendValueInput('BLUE')\n        .setCheck(Blockly.BlockValueType.NUMBER)\n        .setAlign(Blockly.ALIGN_RIGHT)\n        .appendTitle(Blockly.Msg.COLOUR_RGB_BLUE);\n    this.setOutput(true, Blockly.BlockValueType.COLOUR);\n    this.setTooltip(Blockly.Msg.COLOUR_RGB_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.colour_blend = {\n  // Blend two colours together.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.COLOUR_BLEND_HELPURL);\n    this.setHSV(42, 0.89, 0.99);\n    this.appendValueInput('COLOUR1')\n        .setCheck(Blockly.BlockValueType.COLOUR)\n        .setAlign(Blockly.ALIGN_RIGHT)\n        .appendTitle(Blockly.Msg.COLOUR_BLEND_TITLE)\n        .appendTitle(Blockly.Msg.COLOUR_BLEND_COLOUR1);\n    this.appendValueInput('COLOUR2')\n        .setCheck(Blockly.BlockValueType.COLOUR)\n        .setAlign(Blockly.ALIGN_RIGHT)\n        .appendTitle(Blockly.Msg.COLOUR_BLEND_COLOUR2);\n    this.appendValueInput('RATIO')\n        .setCheck(Blockly.BlockValueType.NUMBER)\n        .setAlign(Blockly.ALIGN_RIGHT)\n        .appendTitle(Blockly.Msg.COLOUR_BLEND_RATIO);\n    this.setOutput(true, Blockly.BlockValueType.COLOUR);\n    this.setTooltip(Blockly.Msg.COLOUR_BLEND_TOOLTIP);\n  }\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Procedure blocks for Blockly.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Blocks.functionalExamples');\n\ngoog.require('Blockly.Blocks');\n\n/**\n * Definition block for a custom functional block\n */\nBlockly.Blocks.functional_example = {\n  shouldHideIfInMainBlockSpace: function () {\n    return true;\n  },\n  isCopyable: function () {\n    return false;\n  },\n  init: function() {\n    this.setHSV(0.0, 0.0, .49);\n    this.setFunctional(true, { headerHeight: 0, rowBuffer: 3 });\n    this.setFunctionalOutput(false);\n    // TODO(bjordan): maybe add a bit of space here for a handle? TOP_HANDLE input type?\n    this.appendFunctionalInput('ACTUAL').setAlign(Blockly.ALIGN_CENTRE);\n    this.appendFunctionalInput('EXPECTED').setAlign(Blockly.ALIGN_CENTRE).setInline(true);\n    this.setTooltip(Blockly.Msg.EXAMPLE_DESCRIPTION);\n  },\n  mutationToDom: function() {\n  },\n  domToMutation: function(xmlElement) {\n  },\n  updateOutputType: function(outputType) {\n    this.outputType_ = outputType;\n    this.changeFunctionalOutput(this.outputType_);\n  },\n  /**\n   * Updates the functional examples' usage types\n   * @param {Blockly.BlockValueType} newType\n   */\n  updateInputsToType: function (newType) {\n    this.updateInputType_(this.getInput('EXPECTED'), newType);\n    this.updateInputType_(this.getInput('ACTUAL'), newType);\n    this.render();\n  },\n  /**\n   * Updates given input to match a given functional value type\n   * @param {Blockly.Input} input\n   * @param {Blockly.BlockValueType} newType\n   */\n  updateInputType_: function (input, newType) {\n    input.setHSV.apply(input, Blockly.FunctionalTypeColors[newType]);\n    input.setCheck(newType);\n  }\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Variable blocks for Blockly.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Blocks.variables');\n\ngoog.require('Blockly.Blocks');\ngoog.require('Blockly.Variables');\n\n\nBlockly.Blocks.variables_get = {\n  // Variable getter.\n  init: function() {\n    var fieldLabel = new Blockly.FieldLabel(Blockly.Msg.VARIABLES_GET_ITEM);\n    // Must be marked EDITABLE so that cloned blocks share the same var name\n    fieldLabel.EDITABLE = true;\n    this.setHelpUrl(Blockly.Msg.VARIABLES_GET_HELPURL);\n    this.setHSV(312, 0.32, 0.62);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.VARIABLES_GET_TITLE)\n        .appendTitle(Blockly.disableVariableEditing ? fieldLabel\n            : new Blockly.FieldVariable(Blockly.Msg.VARIABLES_GET_ITEM), 'VAR')\n        .appendTitle(Blockly.Msg.VARIABLES_GET_TAIL);\n    this.setOutput(true);\n    this.setTooltip(Blockly.Msg.VARIABLES_GET_TOOLTIP);\n  },\n  getVars: Blockly.Variables.getVars,\n  renameVar: function(oldName, newName) {\n    if (Blockly.Names.equals(oldName, this.getTitleValue('VAR'))) {\n      this.setTitleValue(newName, 'VAR');\n    }\n  },\n  removeVar: function(oldName) {\n    if (Blockly.Names.equals(oldName, this.getTitleValue('VAR'))) {\n      this.dispose(true, true);\n    }\n  },\n  contextMenuType_: 'variables_set',\n  customContextMenu: function(options) {\n    var option = {enabled: true};\n    var name = this.getTitleValue('VAR');\n    option.text = Blockly.Msg.VARIABLES_GET_CREATE_SET.replace('%1', name);\n    var xmlTitle = goog.dom.createDom('title', null, name);\n    xmlTitle.setAttribute('name', 'VAR');\n    var xmlBlock = goog.dom.createDom('block', null, xmlTitle);\n    xmlBlock.setAttribute('type', this.contextMenuType_);\n    option.callback = Blockly.ContextMenu.callbackFactory(this, xmlBlock);\n    options.push(option);\n  }\n};\n\nBlockly.Blocks.variables_set = {\n  // Variable setter.\n  init: function() {\n    var fieldLabel = new Blockly.FieldLabel(Blockly.Msg.VARIABLES_SET_ITEM);\n    // Must be marked EDITABLE so that cloned blocks share the same var name\n    fieldLabel.EDITABLE = true;\n    this.setHelpUrl(Blockly.Msg.VARIABLES_SET_HELPURL);\n    this.setHSV(312, 0.32, 0.62);\n    this.appendValueInput('VALUE')\n        .appendTitle(new Blockly.FieldImage(Blockly.assetUrlRoot + \"/assets/media/common_images/variables_set.png\"))\n        .appendTitle(Blockly.Msg.VARIABLES_SET_TITLE)\n        .appendTitle(Blockly.disableVariableEditing ? fieldLabel\n          : new Blockly.FieldVariable(Blockly.Msg.VARIABLES_SET_ITEM), 'VAR')\n        .appendTitle(Blockly.Msg.VARIABLES_SET_TAIL);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(Blockly.Msg.VARIABLES_SET_TOOLTIP);\n  },\n  getVars: Blockly.Variables.getVars,\n  renameVar: function(oldName, newName) {\n    if (Blockly.Names.equals(oldName, this.getTitleValue('VAR'))) {\n      this.setTitleValue(newName, 'VAR');\n    }\n  },\n  contextMenuMsg_: Blockly.Msg.VARIABLES_SET_CREATE_GET,\n  contextMenuType_: 'variables_get',\n  customContextMenu: Blockly.Blocks.variables_get.customContextMenu\n};\n\nBlockly.Blocks.parameters_get = {\n  // Variable getter.\n  init: function() {\n    var fieldLabel = new Blockly.FieldLabel(Blockly.Msg.VARIABLES_GET_ITEM);\n    // Must be marked EDITABLE so that cloned blocks share the same var name\n    fieldLabel.EDITABLE = true;\n    this.setHelpUrl(Blockly.Msg.VARIABLES_GET_HELPURL);\n    this.setHSV(7, 0.80, 0.95);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.VARIABLES_GET_TITLE)\n        .appendTitle(Blockly.disableVariableEditing ? fieldLabel\n            : new Blockly.FieldParameter(Blockly.Msg.VARIABLES_GET_ITEM), 'VAR')\n        .appendTitle(Blockly.Msg.VARIABLES_GET_TAIL);\n    this.setOutput(true);\n    this.setTooltip(Blockly.Msg.VARIABLES_GET_TOOLTIP);\n  },\n  mutationToDom: function() {\n    var checks = this.outputConnection.getCheck();\n    if (checks && checks.length === 1) {\n      var container = document.createElement('mutation');\n      container.setAttribute('output', checks[0]);\n      return container;\n    }\n  },\n  domToMutation: function(container) {\n    var type = container.getAttribute('output');\n    if (type) {\n      // Clear current color, so we can infer it from output type.\n      this.setColour(null);\n      var strict = !!Blockly.valueTypeTabShapeMap[type];\n      this.outputConnection.setCheck(type, strict);\n    }\n  },\n  renameVar: function(oldName, newName) {\n    // Params should only be used in the FunctionEditor but better to be safe\n    Blockly.FunctionEditor.allFunctionEditors.forEach(function(functionEditor) {\n      if (functionEditor.isOpen()) {\n        functionEditor.renameParameter(oldName, newName);\n        functionEditor.refreshParamsEverywhere();\n      }\n    });\n  },\n  removeVar: Blockly.Blocks.variables_get.removeVar\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Variable blocks for Blockly.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Blocks.functionalParameters');\n\ngoog.require('Blockly.Blocks');\ngoog.require('Blockly.Blocks.variables');\n\nBlockly.Blocks.functional_parameters_get = {\n  // Variable getter.\n  init: function() {\n    var fieldLabel = new Blockly.FieldLabel(Blockly.Msg.VARIABLES_GET_ITEM);\n    // Must be marked EDITABLE so that cloned blocks share the same var name\n    fieldLabel.EDITABLE = true;\n    this.setHelpUrl(Blockly.Msg.VARIABLES_GET_HELPURL);\n    this.setHSV(312, 0.32, 0.62);\n    this.setFunctional(true);\n    var options = {\n      fixedSize: { height: 35 }\n    };\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.VARIABLES_GET_TITLE)\n        .appendTitle(fieldLabel, 'VAR')\n        .appendTitle(Blockly.Msg.VARIABLES_GET_TAIL)\n        .setAlign(Blockly.ALIGN_CENTRE);\n    this.setFunctionalOutput(true);\n    this.setTooltip(Blockly.Msg.VARIABLES_GET_TOOLTIP);\n  },\n  renameVar: function(oldName, newName) {\n    if (!Blockly.functionEditor) {\n      // Params should only be used in the FunctionEditor but better to be safe\n      return;\n    }\n    var title = this.getTitle_('VAR');\n    if (title.getText() === oldName) {\n      title.setText(newName);\n    }\n  },\n  removeVar: Blockly.Blocks.variables_get.removeVar,\n  mutationToDom: function() {\n    var container = document.createElement('mutation');\n    // Add description mutation\n    if (this.description_) {\n      var desc = document.createElement('description');\n      desc.textContent = this.description_;\n      container.appendChild(desc);\n    }\n    if (this.outputType_) {\n      var outputType = document.createElement('outputtype');\n      outputType.textContent = this.outputType_;\n      container.appendChild(outputType);\n    }\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    for (var x = 0, childNode; childNode = xmlElement.childNodes[x]; x++) {\n      var nodeName = childNode.nodeName.toLowerCase();\n      if (nodeName === 'description') {\n        this.description_ = childNode.textContent;\n      } else if (nodeName === 'outputtype') {\n        this.outputType_ = childNode.textContent;\n        this.changeFunctionalOutput(this.outputType_);\n      }\n    }\n  }\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Procedure blocks for Blockly.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Blocks.procedures');\n\ngoog.require('Blockly.Blocks');\n\nBlockly.Block.createProcedureDefinitionBlock = function(config) {\n  config = config || {};\n  config.overrides = config.overrides || {};\n  var block = {\n    shouldHideIfInMainBlockSpace: function () {\n      return Blockly.useModalFunctionEditor;\n    },\n    // Define a procedure with no return value.\n    init: function() {\n      var showParamEditIcon = !Blockly.disableParamEditing && !Blockly.useModalFunctionEditor;\n\n      this.setHelpUrl(Blockly.Msg.PROCEDURES_DEFNORETURN_HELPURL);\n      this.setHSV(94, 0.84, 0.60);\n      var name = Blockly.Procedures.findLegalName(\n          Blockly.Msg.PROCEDURES_DEFNORETURN_PROCEDURE, this);\n      this.appendDummyInput()\n          .appendTitle(showParamEditIcon ? '' : ' ')\n          .appendTitle(new Blockly.FieldTextInput(name,\n          Blockly.Procedures.rename), 'NAME')\n          .appendTitle('', 'PARAMS');\n      this.appendStatementInput('STACK')\n          .appendTitle(Blockly.Msg.PROCEDURES_DEFNORETURN_DO);\n      if (showParamEditIcon) {\n        this.setMutator(new Blockly.Mutator(['procedures_mutatorarg']));\n      }\n      this.setTooltip(Blockly.Msg.PROCEDURES_DEFNORETURN_TOOLTIP);\n      // Only want to have the backdrop in the mainBlockSpace. We don't want it in\n      // the toolbox or in the feedback dialog (which is readonly).\n      this.setFramed(this.blockSpace === Blockly.mainBlockSpace && !this.blockSpace.isReadOnly());\n      this.parameterNames_ = [];\n      this.parameterTypes_ = [];\n      if (config.initPostScript) {\n        config.initPostScript(this);\n      }\n    },\n    updateParams_: function() {\n      // Check for duplicated arguments.\n      var badArg = false;\n      var hash = {};\n      for (var x = 0; x < this.parameterNames_.length; x++) {\n        if (hash['arg_' + this.parameterNames_[x].toLowerCase()]) {\n          badArg = true;\n          break;\n        }\n        hash['arg_' + this.parameterNames_[x].toLowerCase()] = true;\n      }\n      if (badArg) {\n        this.setWarningText(Blockly.Msg.PROCEDURES_DEF_DUPLICATE_WARNING);\n      } else {\n        this.setWarningText(null);\n      }\n      // Merge the arguments into a human-readable list.\n      var paramString = '';\n      if (this.parameterNames_.length) {\n        paramString = Blockly.Msg.PROCEDURES_BEFORE_PARAMS +\n            ' ' + this.parameterNames_.join(', ');\n      }\n      this.setTitleValue(paramString, 'PARAMS');\n    },\n    mutationToDom: function() {\n      var container = document.createElement('mutation');\n      // Add argument mutations\n      for (var x = 0; x < this.parameterNames_.length; x++) {\n        var parameter = document.createElement('arg');\n        parameter.setAttribute('name', this.parameterNames_[x]);\n        if (this.parameterTypes_ && this.parameterTypes_[x]) {\n          parameter.setAttribute('type', this.parameterTypes_[x]);\n        }\n        container.appendChild(parameter);\n      }\n      // Add description mutation\n      if (this.description_) {\n        var desc = document.createElement('description');\n        desc.textContent = this.description_;\n        container.appendChild(desc);\n      }\n      return container;\n    },\n    domToMutation: function(xmlElement) {\n      this.parameterNames_ = [];\n      for (var x = 0, childNode; childNode = xmlElement.childNodes[x]; x++) {\n        var nodeName = childNode.nodeName.toLowerCase();\n        if (nodeName === 'arg') {\n          this.parameterNames_.push(childNode.getAttribute('name'));\n          var type = childNode.getAttribute('type');\n          if (type) {\n            if (!this.parameterTypes_) {\n              this.parameterTypes_ = [];\n            }\n            this.parameterTypes_[this.parameterNames_.length - 1] = type;\n          }\n        } else if (nodeName === 'description') {\n          this.description_ = childNode.textContent;\n        }\n      }\n      this.updateParams_();\n    },\n    decompose: function(blockSpace) {\n      var containerBlock = new Blockly.Block(blockSpace,\n                                             'procedures_mutatorcontainer');\n      containerBlock.initSvg();\n      var connection = containerBlock.getInput('STACK').connection;\n      for (var x = 0; x < this.parameterNames_.length; x++) {\n        var paramBlock = new Blockly.Block(blockSpace, 'procedures_mutatorarg');\n        paramBlock.initSvg();\n        paramBlock.setTitleValue(this.parameterNames_[x], 'NAME');\n        paramBlock.setTitleValue(this.parameterTypes_[x], 'TYPE');\n        // Store the old location.\n        paramBlock.oldLocation = x;\n        connection.connect(paramBlock.previousConnection);\n        connection = paramBlock.nextConnection;\n      }\n      // Initialize procedure's callers with blank IDs.\n      Blockly.Procedures.mutateCallers(this.getTitleValue('NAME'),\n          this.blockSpace, this.parameterNames_, null);\n      return containerBlock;\n    },\n    /**\n     * Modifies this block's parameters to match a given mutator block\n     * @param {Blockly.Block} containerBlock mutator container block\n     */\n    compose: function(containerBlock) {\n      var currentParamBlock = containerBlock.getInputTargetBlock('STACK');\n      var paramNames = [];\n      var paramTypes = [];\n      var paramIDs = [];\n      while (currentParamBlock) {\n        paramNames.push(currentParamBlock.getTitleValue('NAME'));\n        paramTypes.push(currentParamBlock.getTitleValue('TYPE'));\n        paramIDs.push(currentParamBlock.id);\n        currentParamBlock = currentParamBlock.nextConnection &&\n          currentParamBlock.nextConnection.targetBlock();\n      }\n      this.updateParamsFromArrays(paramNames, paramIDs, paramTypes);\n    },\n    /**\n     * Updates parameters (renaming, deleting, adding as appropriate)\n     * on this procedure and its callers.\n     * @param {Array.<String>} paramNames ordered names of parameters for this procedure\n     * @param {Array.<String>} paramIDs unique IDs for each parameter, used to update existing\n     *     references to parameters across renames\n     * @param {Array.<String>} paramTypes ordered types of parameters for this procedure\n     */\n    updateParamsFromArrays: function(paramNames, paramIDs, paramTypes) {\n      this.parameterNames_ = goog.array.clone(paramNames);\n      this.parameterTypes_ = goog.array.clone(paramTypes);\n      this.paramIds_ = paramIDs ? goog.array.clone(paramIDs) : null;\n      this.updateParams_();\n      this.updateCallerParams_();\n    },\n    updateCallerParams_: function() {\n      Blockly.Procedures.mutateCallers(this.getTitleValue('NAME'),\n        this.blockSpace,\n        this.parameterNames_,\n        this.paramIds_,\n        this.parameterTypes_\n      );\n    },\n    /**\n     * Disposes of this block and (optionally) its callers\n     * @param {boolean} healStack see superclass\n     * @param {boolean} animate see superclass\n     * @param {?boolean} opt_keepCallers if false, callers of this method\n     *    are disposed\n     * @override\n     */\n    dispose: function(healStack, animate, opt_keepCallers) {\n      if (!opt_keepCallers) {\n        // Dispose of any callers.\n        var name = this.getTitleValue('NAME');\n        Blockly.Procedures.disposeCallers(name, this.blockSpace);\n      }\n      // Call parent's destructor.\n      Blockly.Block.prototype.dispose.apply(this, arguments);\n    },\n    getProcedureInfo: function() {\n      return {\n        name: this.getTitleValue('NAME'),\n        parameterNames: this.parameterNames_,\n        parameterIDs: this.paramIds_,\n        parameterTypes: this.parameterTypes_,\n        type: this.type,\n        callType: this.callType_\n      };\n    },\n    getVars: function() {\n      return {\n        Default: this.parameterNames_,\n      };\n    },\n    renameVar: function(oldName, newName) {\n      var change = false;\n      for (var x = 0; x < this.parameterNames_.length; x++) {\n        if (Blockly.Names.equals(oldName, this.parameterNames_[x])) {\n          this.parameterNames_[x] = newName;\n          change = true;\n        }\n      }\n      if (change) {\n        this.updateParams_();\n        // Update the mutator's variables if the mutator is open.\n        if (this.mutator && this.mutator.isVisible()) {\n          var blocks = this.mutator.blockSpace_.getAllBlocks();\n          for (var x = 0, block; block = blocks[x]; x++) {\n            if (block.type == 'procedures_mutatorarg' &&\n                Blockly.Names.equals(oldName, block.getTitleValue('NAME'))) {\n              block.setTitleValue(newName, 'NAME');\n            }\n          }\n        }\n      }\n    },\n    removeVar: function(oldName) {\n      var index = this.parameterNames_.indexOf(oldName);\n      if (index > -1) {\n        this.parameterNames_.splice(index, 1);\n        if (this.parameterTypes_) {\n          this.parameterTypes_.splice(index, 1);\n        }\n        this.updateParams_();\n      }\n    },\n    customContextMenu: function(options) {\n      // Add option to create caller.\n      var option = {enabled: true};\n      var name = this.getTitleValue('NAME');\n      option.text = Blockly.Msg.PROCEDURES_CREATE_DO.replace('%1', name);\n\n      var xmlMutation = goog.dom.createDom('mutation');\n      xmlMutation.setAttribute('name', name);\n      for (var x = 0; x < this.parameterNames_.length; x++) {\n        var xmlArg = goog.dom.createDom('arg');\n        xmlArg.setAttribute('name', this.parameterNames_[x]);\n        xmlMutation.appendChild(xmlArg);\n      }\n      var xmlBlock = goog.dom.createDom('block', null, xmlMutation);\n      xmlBlock.setAttribute('type', this.callType_);\n      option.callback = Blockly.ContextMenu.callbackFactory(this, xmlBlock);\n\n      options.push(option);\n      // Add options to create getters for each parameter.\n      for (var x = 0; x < this.parameterNames_.length; x++) {\n        var option = {enabled: true};\n        var name = this.parameterNames_[x];\n        option.text = Blockly.Msg.VARIABLES_SET_CREATE_GET.replace('%1', name);\n        var xmlTitle = goog.dom.createDom('title', null, name);\n        xmlTitle.setAttribute('name', 'VAR');\n        var xmlBlock = goog.dom.createDom('block', null, xmlTitle);\n        xmlBlock.setAttribute('type', 'variables_get');\n        option.callback = Blockly.ContextMenu.callbackFactory(this, xmlBlock);\n        options.push(option);\n      }\n    },\n    userCreated: false,\n    shouldBeGrayedOut: function () {\n      return false;\n    },\n    callType_: 'procedures_callnoreturn'\n  };\n  goog.object.extend(block, config.overrides);\n  return block;\n}\nBlockly.Blocks.procedures_defnoreturn = Blockly.Block.createProcedureDefinitionBlock();\n\nBlockly.Blocks.procedures_defreturn = {\n  shouldHideIfInMainBlockSpace: function () {\n    return Blockly.useModalFunctionEditor;\n  },\n  // Define a procedure with a return value.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.PROCEDURES_DEFRETURN_HELPURL);\n    this.setHSV(94, 0.84, 0.60);\n    var name = Blockly.Procedures.findLegalName(\n        Blockly.Msg.PROCEDURES_DEFRETURN_PROCEDURE, this);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.PROCEDURES_DEFRETURN_TITLE)\n        .appendTitle(new Blockly.FieldTextInput(name,\n        Blockly.Procedures.rename), 'NAME')\n        .appendTitle('', 'PARAMS');\n    this.appendStatementInput('STACK')\n        .appendTitle(Blockly.Msg.PROCEDURES_DEFRETURN_DO);\n    this.appendValueInput('RETURN')\n        .setAlign(Blockly.ALIGN_RIGHT)\n        .appendTitle(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN);\n    this.setMutator(new Blockly.Mutator(['procedures_mutatorarg']));\n    this.setTooltip(Blockly.Msg.PROCEDURES_DEFRETURN_TOOLTIP);\n    // Only want to have the backdrop in the mainBlockSpace. We don't want it in\n    // the toolbox or in the feedback dialog (which is readonly).\n    this.setFramed(this.blockSpace === Blockly.mainBlockSpace && !this.blockSpace.isReadOnly());\n    this.parameterNames_ = [];\n  },\n  updateParams_: Blockly.Blocks.procedures_defnoreturn.updateParams_,\n  updateCallerParams_: Blockly.Blocks.procedures_defnoreturn.updateCallerParams_,\n  updateParamsFromArrays: Blockly.Blocks.procedures_defnoreturn.updateParamsFromArrays,\n  mutationToDom: Blockly.Blocks.procedures_defnoreturn.mutationToDom,\n  domToMutation: Blockly.Blocks.procedures_defnoreturn.domToMutation,\n  decompose: Blockly.Blocks.procedures_defnoreturn.decompose,\n  compose: Blockly.Blocks.procedures_defnoreturn.compose,\n  dispose: Blockly.Blocks.procedures_defnoreturn.dispose,\n  getProcedureInfo: function() {\n    return {\n      name: this.getTitleValue('NAME'),\n      parameterNames: this.parameterNames_,\n      parameterIDs: this.paramIds_,\n      type: this.type,\n      callType: this.callType_\n    };\n  },\n  getVars: Blockly.Blocks.procedures_defnoreturn.getVars,\n  renameVar: Blockly.Blocks.procedures_defnoreturn.renameVar,\n  customContextMenu: Blockly.Blocks.procedures_defnoreturn.customContextMenu,\n  userCreated: Blockly.Blocks.procedures_defnoreturn.userCreated,\n  shouldBeGrayedOut: Blockly.Blocks.procedures_defnoreturn.shouldBeGrayedOut,\n  callType_: 'procedures_callreturn'\n};\n\nBlockly.Blocks.procedures_mutatorcontainer = {\n  // Procedure container (for mutator dialog).\n  init: function() {\n    this.setHSV(94, 0.84, 0.60);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.PROCEDURES_MUTATORCONTAINER_TITLE);\n    this.appendStatementInput('STACK');\n    this.setTooltip('');\n    this.contextMenu = false;\n  }\n};\n\nBlockly.Blocks.procedures_mutatorarg = {\n  // Procedure argument (for mutator dialog).\n  init: function() {\n    this.setHSV(94, 0.84, 0.60);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.PROCEDURES_MUTATORARG_TITLE)\n        .appendTitle(new Blockly.FieldTextInput('x', this.validator), 'NAME');\n    if (Blockly.valueTypeTabShapeMap) {\n      var typeOptions = function () {\n        return goog.object.getValues(Blockly.BlockValueType).map(function (v) {\n          return [v, v];\n        });\n      };\n      this.appendDummyInput()\n        .appendTitle(Blockly.Msg.PROCEDURES_MUTATORARG_TYPE)\n        .appendTitle(new Blockly.FieldDropdown(typeOptions), 'TYPE');\n      this.setInputsInline(true);\n    }\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip('');\n    this.contextMenu = false;\n  }\n};\n\nBlockly.Blocks.procedures_mutatorarg.validator = function(newVar) {\n  // Merge runs of whitespace.  Strip leading and trailing whitespace.\n  // Beyond this, all names are legal.\n  newVar = newVar.replace(/[\\s\\xa0]+/g, ' ').replace(/^ | $/g, '');\n  return newVar || null;\n};\n\nBlockly.Blocks.procedures_callnoreturn = {\n  // Call a procedure with no return value.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.PROCEDURES_CALLNORETURN_HELPURL);\n    this.setHSV(94, 0.84, 0.60);\n\n    var mainTitle = this.appendDummyInput()\n      .appendTitle(new Blockly.FieldImage(Blockly.assetUrlRoot + \"/assets/media/common_images/procedure_function.png\"))\n      .appendTitle(Blockly.Msg.PROCEDURES_CALLNORETURN_CALL)\n      .appendTitle('', 'NAME');\n\n    if (Blockly.useModalFunctionEditor) {\n      var editLabel = new Blockly.FieldIcon(Blockly.Msg.FUNCTION_EDIT);\n      Blockly.bindEvent_(editLabel.fieldGroup_, 'mousedown', this, this.openEditor);\n      mainTitle.appendTitle(editLabel);\n    }\n\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(Blockly.Msg.PROCEDURES_CALLNORETURN_TOOLTIP);\n    this.currentParameterNames_ = [];\n    this.parameterIDsToArgumentConnections = null;\n    this.currentParameterIDs = null;\n  },\n  openEditor: function (e) {\n    e.stopPropagation();\n    Blockly.functionEditor.openEditorForCallBlock_(this);\n  },\n  getCallName: function() {\n    return this.getTitleValue('NAME');\n  },\n  renameProcedure: function(oldName, newName) {\n    if (Blockly.Names.equals(oldName, this.getTitleValue('NAME'))) {\n      this.setTitleValue(newName, 'NAME');\n      this.setTooltip(\n          (this.outputConnection ? Blockly.Msg.PROCEDURES_CALLRETURN_TOOLTIP\n           : Blockly.Msg.PROCEDURES_CALLNORETURN_TOOLTIP)\n          .replace('%1', newName));\n    }\n  },\n  setProcedureParameters: function(paramNames, paramIds, paramTypes) {\n    // Data structures for parameters on each call block:\n    // this.arguments = ['x', 'y']\n    //     Existing param names.\n    // paramNames = ['x', 'y', 'z']\n    //     New param names.\n    // paramIds = ['piua', 'f8b_', 'oi.o']\n    //     IDs of params (consistent for each parameter through the life of a\n    //     mutator, regardless of param renaming).\n    // this.parameterIDsToArgumentConnections {piua: null, f8b_: Blockly.Connection}\n    //     Look-up of paramIds to connections plugged into the call block.\n    // this.currentParameterIDs = ['piua', 'f8b_']\n    //     Existing param IDs.\n    // Note that quarkConnections_ may include IDs that no longer exist, but\n    // which might reappear if a param is reattached in the mutator.\n    if (!paramIds) {\n      // Reset the quarks (a mutator is about to open).\n      this.parameterIDsToArgumentConnections = {};\n      this.currentParameterIDs = null;\n      return;\n    }\n    if (paramIds.length != paramNames.length) {\n      throw 'Error: paramNames and paramIds must be the same length.';\n    }\n    if (!this.currentParameterIDs) {\n      // Initialize tracking for this block.\n      this.parameterIDsToArgumentConnections = {};\n      if (paramNames.join('\\n') == this.currentParameterNames_.join('\\n')) {\n        // No change to the parameters, allow quarkConnections_ to be\n        // populated with the existing connections.\n        this.currentParameterIDs = paramIds;\n      } else {\n        this.currentParameterIDs = [];\n      }\n    }\n    // Switch off rendering while the block is rebuilt.\n    var savedRendered = this.rendered;\n    this.rendered = false;\n    // Update the quarkConnections_ with existing connections.\n    for (var x = this.currentParameterNames_.length - 1; x >= 0; x--) {\n      var input = this.getInput('ARG' + x);\n      if (input) {\n        var connection = input.connection.targetConnection;\n        this.parameterIDsToArgumentConnections[this.currentParameterIDs[x]] = connection;\n        // Disconnect all argument blocks and remove all inputs.\n        this.removeInput('ARG' + x);\n      }\n    }\n    // Rebuild the block's arguments.\n    this.currentParameterNames_ = [].concat(paramNames);\n    this.currentParameterIDs = paramIds;\n    this.currentParameterTypes_ = paramTypes;\n    for (var x = 0; x < this.currentParameterNames_.length; x++) {\n      var input = this.appendValueInput('ARG' + x)\n          .setAlign(Blockly.ALIGN_RIGHT)\n          .appendTitle(this.currentParameterNames_[x]);\n      if (this.currentParameterIDs) {\n        // Reconnect any child blocks.\n        var parameterID = this.currentParameterIDs[x];\n        if (parameterID in this.parameterIDsToArgumentConnections) {\n          var connection = this.parameterIDsToArgumentConnections[parameterID];\n          if (!connection || connection.targetConnection ||\n              connection.sourceBlock_.blockSpace != this.blockSpace) {\n            // Block no longer exists or has been attached elsewhere.\n            delete this.parameterIDsToArgumentConnections[parameterID];\n          } else {\n            input.connection.connect(connection);\n          }\n        }\n      }\n      input.setStrictCheck(this.currentParameterTypes_[x]);\n    }\n    // Restore rendering and show the changes.\n    this.rendered = savedRendered;\n    if (this.rendered) {\n      this.render();\n      this.bumpNeighbours();\n    }\n  },\n  mutationToDom: function() {\n    // Save the name and arguments (none of which are editable).\n    var container = document.createElement('mutation');\n    container.setAttribute('name', this.getTitleValue('NAME'));\n    for (var x = 0; x < this.currentParameterNames_.length; x++) {\n      var parameter = document.createElement('arg');\n      parameter.setAttribute('name', this.currentParameterNames_[x]);\n      if (this.currentParameterTypes_[x]) {\n        parameter.setAttribute('type', this.currentParameterTypes_[x]);\n      }\n      container.appendChild(parameter);\n    }\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    // Restore the name and parameters.\n    var name = xmlElement.getAttribute('name');\n    this.setTitleValue(name, 'NAME');\n    this.setTooltip(\n        (this.outputConnection ? Blockly.Msg.PROCEDURES_CALLRETURN_TOOLTIP\n         : Blockly.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace('%1', name));\n    var definitionBlock = Blockly.Procedures.getDefinition(name, this.blockSpace);\n    if (definitionBlock && definitionBlock.mutator && definitionBlock.mutator.isVisible()) {\n      // Initialize caller with the mutator's IDs.\n      var procedureInfo = definitionBlock.getProcedureInfo();\n      this.setProcedureParameters(procedureInfo.parameterNames, procedureInfo.parameterIDs, procedureInfo.parameterTypes);\n    } else {\n      this.currentParameterNames_ = [];\n      this.currentParameterTypes_ = [];\n      for (var x = 0, childNode; childNode = xmlElement.childNodes[x]; x++) {\n        if (childNode.nodeName.toLowerCase() == 'arg') {\n          this.currentParameterNames_.push(childNode.getAttribute('name'));\n          this.currentParameterTypes_.push(childNode.getAttribute('type'));\n        }\n      }\n      // Use parameter names as dummy IDs during initialization\n      this.setProcedureParameters(this.currentParameterNames_, this.currentParameterNames_, this.currentParameterTypes_);\n    }\n  },\n  renameVar: function(oldName, newName) {\n    for (var x = 0; x < this.currentParameterNames_.length; x++) {\n      if (Blockly.Names.equals(oldName, this.currentParameterNames_[x])) {\n        this.currentParameterNames_[x] = newName;\n        this.getInput('ARG' + x).titleRow[0].setText(newName);\n      }\n    }\n  },\n  customContextMenu: function(options) {\n    // Add option to find caller.\n    var option = {enabled: true};\n    option.text = Blockly.Msg.PROCEDURES_HIGHLIGHT_DEF;\n    var name = this.getTitleValue('NAME');\n    var blockSpace = this.blockSpace;\n    option.callback = function() {\n      var def = Blockly.Procedures.getDefinition(name, blockSpace);\n      def && def.select();\n    };\n    options.push(option);\n  }\n};\n\nBlockly.Blocks.procedures_callreturn = {\n  // Call a procedure with a return value.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.PROCEDURES_CALLRETURN_HELPURL);\n    this.setHSV(94, 0.84, 0.60);\n    var mainTitle = this.appendDummyInput()\n        .appendTitle(Blockly.Msg.PROCEDURES_CALLRETURN_CALL)\n        .appendTitle('', 'NAME');\n    if (Blockly.functionEditor) {\n      var editLabel = new Blockly.FieldIcon(Blockly.Msg.FUNCTION_EDIT);\n      Blockly.bindEvent_(editLabel.fieldGroup_, 'mousedown', this, this.openEditor);\n      mainTitle.appendTitle(editLabel);\n    }\n    this.setOutput(true);\n    this.setTooltip(Blockly.Msg.PROCEDURES_CALLRETURN_TOOLTIP);\n    this.currentParameterNames_ = [];\n    this.parameterIDsToArgumentConnections = null;\n    this.currentParameterIDs = null;\n  },\n  openEditor: Blockly.Blocks.procedures_callnoreturn.openEditor,\n  getCallName: Blockly.Blocks.procedures_callnoreturn.getCallName,\n  renameProcedure: Blockly.Blocks.procedures_callnoreturn.renameProcedure,\n  setProcedureParameters:\n      Blockly.Blocks.procedures_callnoreturn.setProcedureParameters,\n  mutationToDom: Blockly.Blocks.procedures_callnoreturn.mutationToDom,\n  domToMutation: Blockly.Blocks.procedures_callnoreturn.domToMutation,\n  renameVar: Blockly.Blocks.procedures_callnoreturn.renameVar,\n  customContextMenu: Blockly.Blocks.procedures_callnoreturn.customContextMenu\n};\n\nBlockly.Blocks.procedures_ifreturn = {\n  // Conditionally return value from a procedure.\n  init: function() {\n    this.setHelpUrl('http://c2.com/cgi/wiki?GuardClause');\n    this.setHSV(94, 0.84, 0.60);\n    this.appendValueInput('CONDITION')\n        .setCheck(Blockly.BlockValueType.BOOLEAN)\n        .appendTitle(Blockly.Msg.CONTROLS_IF_MSG_IF);\n    this.appendValueInput('VALUE')\n        .appendTitle(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN);\n    this.setInputsInline(true);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(Blockly.Msg.PROCEDURES_IFRETURN_TOOLTIP);\n    this.hasReturnValue_ = true;\n  },\n  mutationToDom: function() {\n    // Save whether this block has a return value.\n    var container = document.createElement('mutation');\n    container.setAttribute('value', Number(this.hasReturnValue_));\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    // Restore whether this block has a return value.\n    var value = xmlElement.getAttribute('value');\n    this.hasReturnValue_ = (value == 1);\n    if (!this.hasReturnValue_) {\n      this.removeInput('VALUE');\n      this.appendDummyInput('VALUE')\n        .appendTitle(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN);\n    }\n  },\n  onchange: function() {\n    if (!this.blockSpace) {\n      // Block has been deleted.\n      return;\n    }\n    var legal = false;\n    // Is the block nested in a procedure?\n    var block = this;\n    do {\n      if (block.type == 'procedures_defnoreturn' ||\n          block.type == 'procedures_defreturn') {\n        legal = true;\n        break;\n      }\n      block = block.getSurroundParent();\n    } while (block);\n    if (legal) {\n      // If needed, toggle whether this block has a return value.\n      if (block.type == 'procedures_defnoreturn' && this.hasReturnValue_) {\n        this.removeInput('VALUE');\n        this.appendDummyInput('VALUE')\n          .appendTitle(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN);\n        this.hasReturnValue_ = false;\n      } else if (block.type == 'procedures_defreturn' &&\n                 !this.hasReturnValue_) {\n        this.removeInput('VALUE');\n        this.appendValueInput('VALUE')\n          .appendTitle(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN);\n        this.hasReturnValue_ = true;\n      }\n      this.setWarningText(null);\n    } else {\n      this.setWarningText(Blockly.Msg.PROCEDURES_IFRETURN_WARNING);\n    }\n  }\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Procedure blocks for Blockly.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Blocks.functionalProcedures');\n\ngoog.require('Blockly.Blocks');\ngoog.require('Blockly.Blocks.procedures');\n\n/**\n * Definition block for a custom functional block\n */\nBlockly.Blocks.functional_definition = {\n  shouldHideIfInMainBlockSpace: function () {\n    return true;\n  },\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.PROCEDURES_DEFNORETURN_HELPURL);\n    this.setHSV(94, 0.84, 0.60);\n    this.setFunctional(true, {\n      headerHeight: 0,\n      rowBuffer: 3\n    });\n    this.setFunctionalOutput(false);\n    var name = Blockly.Procedures.findLegalName(Blockly.Msg.PROCEDURES_DEFNORETURN_PROCEDURE, this);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.DEFINE_FUNCTION_DEFINE)\n        .appendTitle(new Blockly.FieldTextInput(name, Blockly.Procedures.rename), 'NAME')\n        .appendTitle('', 'PARAMS');\n    this.appendFunctionalInput('STACK');\n    this.setFunctional(true);\n    this.setTooltip(Blockly.Msg.FUNCTIONAL_PROCEDURE_DEFINE_TOOLTIP);\n    /**\n     * Whether this block should be treated like a functional \"variable\"\n     * i.e., no domain, listed in variables category of functional app flyouts\n     * @type {boolean}\n     * @private\n     */\n    this.isFunctionalVariable_ = false;\n    this.parameterNames_ = [];\n    this.paramIds_ = [];\n    this.parameterTypes_ = [];\n  },\n  /**\n   * Updates the function definition's input type\n   * @param {Blockly.BlockValueType} newType\n   */\n  updateInputsToType: function (newType) {\n    this.updateInputType_(this.getInput('STACK'), newType);\n    this.render();\n  },\n  /**\n   * Updates given input to match a given functional value type\n   * @param {Blockly.Input} input\n   * @param {Blockly.BlockValueType} newType\n   */\n  updateInputType_: function (input, newType) {\n    input.setHSV.apply(input, Blockly.FunctionalTypeColors[newType]);\n    input.setCheck(newType);\n  },\n  mutationToDom: function() {\n    var container = document.createElement('mutation');\n    // Add argument mutations\n    for (var x = 0; x < this.parameterNames_.length; x++) {\n      var parameter = document.createElement('arg');\n      parameter.setAttribute('name', this.parameterNames_[x]);\n      if (this.parameterTypes_[x]) {\n        parameter.setAttribute('type', this.parameterTypes_[x]);\n      }\n      container.appendChild(parameter);\n    }\n    // Add description mutation\n    if (this.description_) {\n      var desc = document.createElement('description');\n      desc.textContent = this.description_;\n      container.appendChild(desc);\n    }\n    if (this.outputType_) {\n      var outputTypeMutation = document.createElement('outputType');\n      outputTypeMutation.textContent = this.outputType_;\n      container.appendChild(outputTypeMutation);\n    }\n    if (this.isFunctionalVariable_) {\n      var functionalVariableMutation = document.createElement('isfunctionalvariable');\n      functionalVariableMutation.textContent = 'true';\n      container.appendChild(functionalVariableMutation);\n    }\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    this.parameterNames_ = [];\n    for (var x = 0, childNode; childNode = xmlElement.childNodes[x]; x++) {\n      var nodeName = childNode.nodeName.toLowerCase();\n      if (nodeName === 'arg') {\n        this.parameterNames_.push(childNode.getAttribute('name'));\n        this.parameterTypes_.push(childNode.getAttribute('type'));\n      } else if (nodeName === 'description') {\n        this.description_ = childNode.textContent;\n      } else if (nodeName === 'outputtype') {\n        this.updateOutputType(childNode.textContent);\n      } else if (nodeName === 'isfunctionalvariable') {\n        this.isFunctionalVariable_ = true;\n      }\n    }\n    this.updateParams_();\n  },\n  isVariable: function() {\n    return this.isFunctionalVariable_;\n  },\n  convertToVariable: function() {\n    this.isFunctionalVariable_ = true;\n  },\n  /**\n   * Updates parameters (renaming, deleting, adding as appropriate)\n   * on this procedure and its callers.\n   * @param {Array.<String>} paramNames ordered names of parameters for this procedure\n   * @param {Array.<String>} paramIDs unique IDs for each parameter, used to update existing\n   *     references to parameters across renames\n   * @param {Array.<String>} paramTypes ordered types of parameters for this procedure\n   */\n  updateParamsFromArrays: function(paramNames, paramIDs, paramTypes) {\n    this.parameterNames_ = goog.array.clone(paramNames);\n    this.paramIds_ = paramIDs ? goog.array.clone(paramIDs) : null;\n    this.parameterTypes_ = goog.array.clone(paramTypes);\n    this.updateParams_();\n    this.updateCallerParams_();\n  },\n  updateParams_: function() {\n    // Check for duplicated arguments.\n    var badArg = false;\n    var hash = {};\n    for (var x = 0; x < this.parameterNames_.length; x++) {\n      if (hash['arg_' + this.parameterNames_[x].toLowerCase()]) {\n        badArg = true;\n        break;\n      }\n      hash['arg_' + this.parameterNames_[x].toLowerCase()] = true;\n    }\n    if (badArg) {\n      this.setWarningText(Blockly.Msg.PROCEDURES_DEF_DUPLICATE_WARNING);\n    } else {\n      this.setWarningText(null);\n    }\n    // Merge the arguments into a human-readable list.\n    var paramString = '';\n    if (this.parameterNames_.length) {\n      paramString = Blockly.Msg.PROCEDURES_BEFORE_PARAMS +\n        ' ' + this.parameterNames_.join(', ');\n    }\n    this.setTitleValue(paramString, 'PARAMS');\n  },\n  updateCallerParams_: function() {\n    Blockly.Procedures.mutateCallers(this.getTitleValue('NAME'),\n      this.blockSpace,\n      this.parameterNames_,\n      this.paramIds_,\n      this.parameterTypes_\n    );\n  },\n  getOutputType: function() {\n    return this.outputType_;\n  },\n  updateOutputType: function(outputType) {\n    this.outputType_ = outputType;\n    this.setHSV.apply(this, Blockly.FunctionalTypeColors[outputType]);\n  },\n  /**\n   * Disposes of this block and (optionally) its callers\n   * @param {boolean} healStack see superclass\n   * @param {boolean} animate see superclass\n   * @param {?boolean} opt_keepCallers if false, callers of this method\n   *    are disposed\n   * @override\n   */\n  dispose: function(healStack, animate, opt_keepCallers) {\n    if (!opt_keepCallers) {\n      // Dispose of any callers.\n      var name = this.getTitleValue('NAME');\n      Blockly.Procedures.disposeCallers(name, this.blockSpace);\n    }\n    // Call parent's destructor.\n    Blockly.Block.prototype.dispose.apply(this, arguments);\n  },\n  getProcedureInfo: function() {\n    return {\n      name: this.getTitleValue('NAME'),\n      type: this.type,\n      callType: this.callType_,\n      parameterNames: this.parameterNames_,\n      parameterTypes: this.parameterTypes_,\n      isFunctionalVariable: this.isFunctionalVariable_\n    }\n  },\n  getVars: function() {\n    return {\n      Default: this.parameterNames_,\n    };\n  },\n  renameVar: function(oldName, newName) {\n    var change = false;\n    for (var x = 0; x < this.parameterNames_.length; x++) {\n      if (Blockly.Names.equals(oldName, this.parameterNames_[x])) {\n        this.parameterNames_[x] = newName;\n        change = true;\n      }\n    }\n    if (change) {\n      this.updateParams_();\n      // Update the mutator's variables if the mutator is open.\n      if (this.mutator && this.mutator.isVisible()) {\n        var blocks = this.mutator.blockSpace_.getAllBlocks();\n        for (var x = 0, block; block = blocks[x]; x++) {\n          if (block.type == 'functional_procedures_mutatorarg' &&\n              Blockly.Names.equals(oldName, block.getTitleValue('NAME'))) {\n            block.setTitleValue(newName, 'NAME');\n          }\n        }\n      }\n    }\n  },\n  removeVar: function(oldName) {\n    var index = this.parameterNames_.indexOf(oldName);\n    if (index > -1) {\n      this.parameterNames_.splice(index, 1);\n      this.updateParams_();\n    }\n  },\n  changeParamType: function (name, newType) {\n    var changed = false;\n    for (var x = 0; x < this.parameterNames_.length; x++) {\n      if (Blockly.Names.equals(name, this.parameterNames_[x])) {\n        this.parameterTypes_[x] = newType;\n        changed = true;\n      }\n    }\n    if (changed) {\n      this.updateParams_();\n      this.updateCallerParams_();\n    }\n  },\n  shouldBeGrayedOut: function () {\n    return false;\n  },\n  callType_: 'functional_call'\n};\n\n/**\n * Caller block for a custom functional block\n */\nBlockly.Blocks.functional_call = {\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.PROCEDURES_CALLNORETURN_HELPURL);\n    // TODO(bjordan): localize / use user-defined description\n    this.setTooltip(\"Calls a user-defined function\");\n\n    this.setHSV(94, 0.84, 0.60);\n\n    var options = {\n      fixedSize: { height: 35 }\n    };\n\n    var mainTitle = this.appendDummyInput()\n        .appendTitle(new Blockly.FieldLabel('Function Call', options), 'NAME')\n        .appendTitle('', 'PARAM_TEXT');\n\n    if (Blockly.useContractEditor && this.blockSpace !== Blockly.modalBlockSpace) {\n      var editLabel = new Blockly.FieldIcon(Blockly.Msg.FUNCTION_EDIT);\n      Blockly.bindEvent_(editLabel.fieldGroup_, 'mousedown', this, this.openEditor);\n      mainTitle.appendTitle(editLabel);\n      this.editLabel_ = editLabel;\n    }\n\n    this.setFunctional(true);\n\n    /**\n     * Used to detect changes in and update parameter names & argument connections\n     * @type {Array}\n     * @private\n     */\n    this.currentParameterNames_ = [];\n    this.parameterIDsToArgumentConnections_ = {};\n    this.currentParameterIDs_ = [];\n    this.currentParameterTypes_ = [];\n\n    /**\n     * Used to sync with changes in parent function definition\n     */\n    /** @type {string} @private */\n    this.currentOutputType_ = null;\n    /** @type {string} @private */\n    this.currentDescription_ = null;\n\n    this.blockSpace.events.listen(Blockly.BlockSpace.EVENTS.BLOCK_SPACE_CHANGE,\n      this.updateAttributesFromDefinition_, false, this);\n\n    this.changeFunctionalOutput(Blockly.BlockValueType.NONE);\n  },\n  updateAttributesFromDefinition_: function() {\n    var procedureDefinition = Blockly.Procedures.getDefinition(\n      this.getTitleValue('NAME'), this.blockSpace.blockSpaceEditor.blockSpace);\n    if (!procedureDefinition) {\n      // will be updated on later blockSpace change (once definition de-serialized)\n      return;\n    }\n\n    var outputTypeChanged = procedureDefinition.outputType_ && procedureDefinition.outputType_ !== this.currentOutputType_;\n    if (outputTypeChanged) {\n      this.currentOutputType_ = procedureDefinition.outputType_;\n      this.changeFunctionalOutput(procedureDefinition.outputType_);\n    }\n    var descriptionChanged = procedureDefinition.description_ && procedureDefinition.description_ !== this.currentDescription_;\n    if (descriptionChanged) {\n      this.currentDescription_ = procedureDefinition.description_;\n      this.setTooltip(procedureDefinition.description_);\n    }\n  },\n  beforeDispose: function() {\n    this.blockSpace.events.unlisten(Blockly.BlockSpace.EVENTS.BLOCK_SPACE_CHANGE,\n      this.updateAttributesFromDefinition_, false, this);\n  },\n  openEditor: function (e) {\n    e.stopPropagation();\n    Blockly.functionEditor.openEditorForCallBlock_(this);\n  },\n  getCallName: function() {\n    return this.getTitleValue('NAME');\n  },\n  getParamTypes: function () {\n    return this.currentParameterTypes_;\n  },\n  renameProcedure: function(oldName, newName) {\n    if (Blockly.Names.equals(oldName, this.getTitleValue('NAME'))) {\n      this.setTitleValue(newName, 'NAME');\n    }\n  },\n  setProcedureParameters: function(paramNames, paramIds, opt_paramTypes) {\n    if (!paramIds) {\n      // Get in to a state where parameter ID tracking can be reset next call\n      this.parameterIDsToArgumentConnections_ = {};\n      this.currentParameterIDs_ = null;\n      return;\n    }\n    if (paramIds.length != paramNames.length) {\n      throw 'Error: paramNames and paramIds must be the same length.';\n    }\n    if (!this.currentParameterIDs_) {\n      // Initialize tracking for this block.\n      this.parameterIDsToArgumentConnections_ = {};\n      if (paramNames.join('\\n') === this.currentParameterNames_.join('\\n')) {\n        // No change to the parameters, allow quarkConnections_ to be\n        // populated with the existing connections.\n        this.currentParameterIDs_ = paramIds;\n      } else {\n        this.currentParameterIDs_ = [];\n      }\n    }\n    // Switch off rendering while the block is rebuilt.\n    var savedRendered = this.rendered;\n    this.rendered = false;\n    // Update the parameterIDsToArgumentConnections with existing connections.\n    for (var x = this.currentParameterNames_.length - 1; x >= 0; x--) {\n      var input = this.getInput('ARG' + x);\n      if (input) {\n        var connection = input.connection.targetConnection;\n        this.parameterIDsToArgumentConnections_[this.currentParameterIDs_[x]] = connection;\n        // Disconnect all argument blocks and remove all inputs.\n        this.removeInput('ARG' + x);\n      }\n    }\n    // Rebuild the block's arguments.\n    this.currentParameterNames_ = goog.array.clone(paramNames);\n    this.currentParameterIDs_ = goog.array.clone(paramIds);\n    this.currentParameterTypes_ = goog.array.clone(opt_paramTypes);\n    for (var x = 0; x < this.currentParameterNames_.length; x++) {\n      var input = this.appendFunctionalInput('ARG' + x)\n        .setAlign(Blockly.ALIGN_CENTRE)\n        .setInline(x > 0);\n      var currentParameterType = this.currentParameterTypes_[x];\n      input.setHSV.apply(input, Blockly.FunctionalTypeColors[currentParameterType]);\n      input.setCheck(currentParameterType);\n      if (this.currentParameterIDs_) {\n        // Reconnect any child blocks.\n        var paramID = this.currentParameterIDs_[x];\n        if (paramID in this.parameterIDsToArgumentConnections_) {\n          var connection = this.parameterIDsToArgumentConnections_[paramID];\n          if (!connection || connection.targetConnection ||\n            connection.sourceBlock_.blockSpace != this.blockSpace) {\n            // Block no longer exists or has been attached elsewhere.\n            delete this.parameterIDsToArgumentConnections_[paramID];\n          } else {\n            input.connection.connect(connection);\n          }\n        }\n      }\n    }\n    this.refreshParameterTitleString_();\n    // Restore rendering and show the changes.\n    this.rendered = savedRendered;\n    if (this.rendered) {\n      this.render();\n    }\n  },\n  refreshParameterTitleString_: function() {\n    var parameterListString = this.currentParameterNames_.length > 0 ?\n    ' (' + this.currentParameterNames_.join(', ') + ')' : '';\n    this.setTitleValue(parameterListString, 'PARAM_TEXT');\n  },\n  mutationToDom: function() {\n    // Save the name and arguments (none of which are editable).\n    var container = document.createElement('mutation');\n    container.setAttribute('name', this.getTitleValue('NAME'));\n    for (var x = 0; x < this.currentParameterNames_.length; x++) {\n      var parameter = document.createElement('arg');\n      parameter.setAttribute('name', this.currentParameterNames_[x]);\n      parameter.setAttribute('type', this.currentParameterTypes_[x]);\n      container.appendChild(parameter);\n    }\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    // Restore the name and parameters.\n    var name = xmlElement.getAttribute('name');\n    this.setTitleValue(name, 'NAME');\n    this.setTooltip(\n      (this.outputConnection ? Blockly.Msg.PROCEDURES_CALLRETURN_TOOLTIP\n        : Blockly.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace('%1', name));\n\n    this.currentParameterNames_ = [];\n    this.currentParameterIDs_ = [];\n    this.currentParameterTypes_ = [];\n    for (var x = 0, childNode; childNode = xmlElement.childNodes[x]; x++) {\n      if (childNode.nodeName.toLowerCase() == 'arg') {\n        this.currentParameterNames_.push(childNode.getAttribute('name'));\n        this.currentParameterTypes_.push(childNode.getAttribute('type'));\n        this.currentParameterIDs_.push(Blockly.getUID());\n      }\n    }\n    this.setProcedureParameters(\n      this.currentParameterNames_,\n      this.currentParameterIDs_,\n      this.currentParameterTypes_);\n    this.updateAttributesFromDefinition_();\n  },\n  renameVar: function(oldName, newName) {\n    for (var x = 0; x < this.currentParameterNames_.length; x++) {\n      if (Blockly.Names.equals(oldName, this.currentParameterNames_[x])) {\n        this.currentParameterNames_[x] = newName;\n        this.refreshParameterTitleString_();\n      }\n    }\n  }\n};\n\n/**\n * Block to allow you to pass a functional block\n */\nBlockly.Blocks.functional_pass = {\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.PROCEDURES_CALLNORETURN_HELPURL);\n    // TODO(bjordan): localize / use user-defined description\n    this.setTooltip(\"Pass a user-defined function\");\n\n    this.setHSV(94, 0.84, 0.60);\n\n    var options = {\n      fixedSize: { height: 35 }\n    };\n\n    var mainTitle = this.appendDummyInput()\n        .appendTitle(new Blockly.FieldLabel('Pass Function', options), 'NAME')\n        .appendTitle('', 'PARAM_TEXT');\n\n    if (Blockly.useContractEditor && this.blockSpace !== Blockly.modalBlockSpace) {\n      var editLabel = new Blockly.FieldIcon(Blockly.Msg.FUNCTION_EDIT);\n      Blockly.bindEvent_(editLabel.fieldGroup_, 'mousedown', this, this.openEditor);\n      mainTitle.appendTitle(editLabel);\n      this.editLabel_ = editLabel;\n    }\n\n    this.setFunctional(true);\n    // functional_pass blocks are immovable, unless we're level editing\n    this.setMovable(!!Blockly.editBlocks);\n    this.setColorFromName_();\n    this.blockSpace.events.listen(Blockly.BlockSpace.EVENTS.BLOCK_SPACE_CHANGE,\n      this.setColorFromName_, false, this);\n\n    this.changeFunctionalOutput(Blockly.BlockValueType.FUNCTION);\n  },\n  openEditor: function(e) {\n    e.stopPropagation();\n    Blockly.functionEditor.openEditorForCallBlock_(this);\n  },\n  renameProcedure: function(oldName, newName) {\n    if (Blockly.Names.equals(oldName, this.getTitleValue('NAME'))) {\n      this.setTitleValue(newName, 'NAME');\n      this.setColorFromName_();\n    }\n  },\n\n  setColorFromName_: function () {\n    var name = this.getTitleValue('NAME');\n    if (!name) {\n      return;\n    }\n    var functionBlock = Blockly.mainBlockSpace.findFunction(name);\n    if (!functionBlock) {\n      return;\n    }\n    var type = functionBlock.getOutputType();\n    this.setHSV.apply(this, Blockly.FunctionalTypeColors[type]);\n  },\n\n  mutationToDom: function() {\n    // Save the name\n    var container = document.createElement('mutation');\n    container.setAttribute('name', this.getTitleValue('NAME'));\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    // Restore the name\n    var name = xmlElement.getAttribute('name');\n    this.setTitleValue(name, 'NAME');\n    this.setTooltip(\n      (this.outputConnection ? Blockly.Msg.PROCEDURES_CALLRETURN_TOOLTIP\n        : Blockly.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace('%1', name));\n    this.setColorFromName_();\n  }\n};\n\nBlockly.Blocks.procedural_to_functional_call = Blockly.Blocks.procedures_callreturn;\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview List blocks for Blockly.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Blocks.lists');\n\ngoog.require('Blockly.Blocks');\n\n\nBlockly.Blocks.lists_create_empty = {\n  // Create an empty list.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.LISTS_CREATE_EMPTY_HELPURL);\n    this.setHSV(40, 1.0, 0.99);\n    this.setOutput(true, Blockly.BlockValueType.ARRAY);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.LISTS_CREATE_EMPTY_TITLE);\n    this.setTooltip(Blockly.Msg.LISTS_CREATE_EMPTY_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.lists_create_with = {\n  // Create a list with any number of elements of any type.\n  init: function() {\n    this.setHSV(40, 1.0, 0.99);\n    this.appendValueInput('ADD0')\n        .appendTitle(Blockly.Msg.LISTS_CREATE_WITH_INPUT_WITH);\n    this.appendValueInput('ADD1');\n    this.appendValueInput('ADD2');\n    this.setOutput(true, Blockly.BlockValueType.ARRAY);\n    this.setMutator(new Blockly.Mutator(['lists_create_with_item']));\n    this.setTooltip(Blockly.Msg.LISTS_CREATE_WITH_TOOLTIP);\n    this.itemCount_ = 3;\n  },\n  mutationToDom: function(blockSpace) {\n    var container = document.createElement('mutation');\n    container.setAttribute('items', this.itemCount_);\n    return container;\n  },\n  domToMutation: function(container) {\n    for (var x = 0; x < this.itemCount_; x++) {\n      this.removeInput('ADD' + x);\n    }\n    this.itemCount_ = window.parseInt(container.getAttribute('items'), 10);\n    for (var x = 0; x < this.itemCount_; x++) {\n      var input = this.appendValueInput('ADD' + x);\n      if (x == 0) {\n        input.appendTitle(Blockly.Msg.LISTS_CREATE_WITH_INPUT_WITH);\n      }\n    }\n    if (this.itemCount_ == 0) {\n      this.appendDummyInput('EMPTY')\n          .appendTitle(Blockly.Msg.LISTS_CREATE_EMPTY_TITLE);\n    }\n  },\n  decompose: function(blockSpace) {\n    var containerBlock = new Blockly.Block(blockSpace,\n                                           'lists_create_with_container');\n    containerBlock.initSvg();\n    var connection = containerBlock.getInput('STACK').connection;\n    for (var x = 0; x < this.itemCount_; x++) {\n      var itemBlock = new Blockly.Block(blockSpace, 'lists_create_with_item');\n      itemBlock.initSvg();\n      connection.connect(itemBlock.previousConnection);\n      connection = itemBlock.nextConnection;\n    }\n    return containerBlock;\n  },\n  compose: function(containerBlock) {\n    // Disconnect all input blocks and remove all inputs.\n    if (this.itemCount_ == 0) {\n      this.removeInput('EMPTY');\n    } else {\n      for (var x = this.itemCount_ - 1; x >= 0; x--) {\n        this.removeInput('ADD' + x);\n      }\n    }\n    this.itemCount_ = 0;\n    // Rebuild the block's inputs.\n    var itemBlock = containerBlock.getInputTargetBlock('STACK');\n    while (itemBlock) {\n      var input = this.appendValueInput('ADD' + this.itemCount_);\n      if (this.itemCount_ == 0) {\n        input.appendTitle(Blockly.Msg.LISTS_CREATE_WITH_INPUT_WITH);\n      }\n      // Reconnect any child blocks.\n      if (itemBlock.valueConnection_) {\n        input.connection.connect(itemBlock.valueConnection_);\n      }\n      this.itemCount_++;\n      itemBlock = itemBlock.nextConnection &&\n          itemBlock.nextConnection.targetBlock();\n    }\n    if (this.itemCount_ == 0) {\n      this.appendDummyInput('EMPTY')\n          .appendTitle(Blockly.Msg.LISTS_CREATE_EMPTY_TITLE);\n    }\n  },\n  saveConnections: function(containerBlock) {\n    // Store a pointer to any connected child blocks.\n    var itemBlock = containerBlock.getInputTargetBlock('STACK');\n    var x = 0;\n    while (itemBlock) {\n      var input = this.getInput('ADD' + x);\n      itemBlock.valueConnection_ = input && input.connection.targetConnection;\n      x++;\n      itemBlock = itemBlock.nextConnection &&\n          itemBlock.nextConnection.targetBlock();\n    }\n  }\n};\n\nBlockly.Blocks.lists_create_with_container = {\n  // Container.\n  init: function() {\n    this.setHSV(40, 1.0, 0.99);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD);\n    this.appendStatementInput('STACK');\n    this.setTooltip(Blockly.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP);\n    this.contextMenu = false;\n  }\n};\n\nBlockly.Blocks.lists_create_with_item = {\n  // Add items.\n  init: function() {\n    this.setHSV(40, 1.0, 0.99);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.LISTS_CREATE_WITH_ITEM_TITLE);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(Blockly.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP);\n    this.contextMenu = false;\n  }\n};\n\nBlockly.Blocks.lists_repeat = {\n  // Create a list with one element repeated.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.LISTS_REPEAT_HELPURL);\n    this.setHSV(40, 1.0, 0.99);\n    this.setOutput(true, Blockly.BlockValueType.ARRAY);\n    this.interpolateMsg(Blockly.Msg.LISTS_REPEAT_TITLE,\n                        ['ITEM', null, Blockly.ALIGN_RIGHT],\n                        ['NUM', 'Number', Blockly.ALIGN_RIGHT],\n                        Blockly.ALIGN_RIGHT);\n    this.setTooltip(Blockly.Msg.LISTS_REPEAT_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.lists_length = {\n  // List length.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.LISTS_LENGTH_HELPURL);\n    this.setHSV(40, 1.0, 0.99);\n    this.appendValueInput('VALUE')\n        .setCheck([Blockly.BlockValueType.ARRAY, Blockly.BlockValueType.STRING])\n        .appendTitle(Blockly.Msg.LISTS_LENGTH_INPUT_LENGTH);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.setTooltip(Blockly.Msg.LISTS_LENGTH_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.lists_isEmpty = {\n  // Is the list empty?\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.LISTS_IS_EMPTY_HELPURL);\n    this.setHSV(40, 1.0, 0.99);\n    this.interpolateMsg(Blockly.Msg.LISTS_IS_EMPTY_TITLE,\n                        ['VALUE', ['Array', 'String'], Blockly.ALIGN_RIGHT],\n                        Blockly.ALIGN_RIGHT)\n    this.setInputsInline(true);\n    this.setOutput(true, Blockly.BlockValueType.BOOLEAN);\n    this.setTooltip(Blockly.Msg.LISTS_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.lists_indexOf = {\n  // Find an item in the list.\n  init: function() {\n    var OPERATORS =\n        [[Blockly.Msg.LISTS_INDEX_OF_FIRST, 'FIRST'],\n         [Blockly.Msg.LISTS_INDEX_OF_LAST, 'LAST']];\n    this.setHelpUrl(Blockly.Msg.LISTS_INDEX_OF_HELPURL);\n    this.setHSV(40, 1.0, 0.99);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.appendValueInput('VALUE')\n        .setCheck(Blockly.BlockValueType.ARRAY)\n        .appendTitle(Blockly.Msg.LISTS_INDEX_OF_INPUT_IN_LIST);\n    this.appendValueInput('FIND')\n        .appendTitle(new Blockly.FieldDropdown(OPERATORS), 'END');\n    this.setInputsInline(true);\n    this.setTooltip(Blockly.Msg.LISTS_INDEX_OF_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.lists_getIndex = {\n  // Get element at index.\n  init: function() {\n    var MODE =\n        [[Blockly.Msg.LISTS_GET_INDEX_GET, 'GET'],\n         [Blockly.Msg.LISTS_GET_INDEX_GET_REMOVE, 'GET_REMOVE'],\n         [Blockly.Msg.LISTS_GET_INDEX_REMOVE, 'REMOVE']];\n    this.WHERE_OPTIONS =\n        [[Blockly.Msg.LISTS_GET_INDEX_FROM_START, 'FROM_START'],\n         [Blockly.Msg.LISTS_GET_INDEX_FROM_END, 'FROM_END'],\n         [Blockly.Msg.LISTS_GET_INDEX_FIRST, 'FIRST'],\n         [Blockly.Msg.LISTS_GET_INDEX_LAST, 'LAST'],\n         [Blockly.Msg.LISTS_GET_INDEX_RANDOM, 'RANDOM']];\n    this.setHelpUrl(Blockly.Msg.LISTS_GET_INDEX_HELPURL);\n    this.setHSV(40, 1.0, 0.99);\n    var modeMenu = new Blockly.FieldDropdown(MODE, function(value) {\n      var isStatement = (value == 'REMOVE');\n      this.sourceBlock_.updateStatement(isStatement);\n    });\n    this.appendValueInput('VALUE')\n        .setCheck(Blockly.BlockValueType.ARRAY)\n        .appendTitle(Blockly.Msg.LISTS_GET_INDEX_INPUT_IN_LIST);\n    this.appendDummyInput()\n        .appendTitle(modeMenu, 'MODE')\n        .appendTitle('', 'SPACE');\n    this.appendDummyInput('AT');\n    if (Blockly.Msg.LISTS_GET_INDEX_TAIL) {\n      this.appendDummyInput('TAIL')\n          .appendTitle(Blockly.Msg.LISTS_GET_INDEX_TAIL);\n    }\n    this.setInputsInline(true);\n    this.setOutput(true);\n    this.updateAt(true);\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      var combo = thisBlock.getTitleValue('MODE') + '_' +\n          thisBlock.getTitleValue('WHERE');\n      return Blockly.Msg['LISTS_GET_INDEX_TOOLTIP_' + combo];\n    });\n  },\n  mutationToDom: function() {\n    // Save whether the block is a statement or a value.\n    // Save whether there is an 'AT' input.\n    var container = document.createElement('mutation');\n    var isStatement = !this.outputConnection;\n    container.setAttribute('statement', isStatement);\n    var isAt = this.getInput('AT').type == Blockly.INPUT_VALUE;\n    container.setAttribute('at', isAt);\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    // Restore the block shape.\n    // Note: Until January 2013 this block did not have mutations,\n    // so 'statement' defaults to false and 'at' defaults to true.\n    var isStatement = (xmlElement.getAttribute('statement') == 'true');\n    this.updateStatement(isStatement);\n    var isAt = (xmlElement.getAttribute('at') != 'false');\n    this.updateAt(isAt);\n  },\n  updateStatement: function(newStatement) {\n    // Switch between a value block and a statement block.\n    var oldStatement = !this.outputConnection;\n    if (newStatement != oldStatement) {\n      this.unplug(true, true);\n      if (newStatement) {\n        this.setOutput(false);\n        this.setPreviousStatement(true);\n        this.setNextStatement(true);\n      } else {\n        this.setPreviousStatement(false);\n        this.setNextStatement(false);\n        this.setOutput(true);\n      }\n    }\n  },\n  updateAt: function(isAt) {\n    // Create or delete an input for the numeric index.\n    // Destroy old 'AT' and 'ORDINAL' inputs.\n    this.removeInput('AT');\n    this.removeInput('ORDINAL', true);\n    // Create either a value 'AT' input or a dummy input.\n    if (isAt) {\n      this.appendValueInput('AT').setCheck(Blockly.BlockValueType.NUMBER);\n      if (Blockly.Msg.ORDINAL_NUMBER_SUFFIX) {\n        this.appendDummyInput('ORDINAL')\n            .appendTitle(Blockly.Msg.ORDINAL_NUMBER_SUFFIX);\n      }\n    } else {\n      this.appendDummyInput('AT');\n    }\n    var menu = new Blockly.FieldDropdown(this.WHERE_OPTIONS, function(value) {\n      var newAt = (value == 'FROM_START') || (value == 'FROM_END');\n      // The 'isAt' variable is available due to this function being a closure.\n      if (newAt != isAt) {\n        var block = this.sourceBlock_;\n        block.updateAt(newAt);\n        // This menu has been destroyed and replaced.  Update the replacement.\n        block.setTitleValue(value, 'WHERE');\n        return null;\n      }\n      return undefined;\n    });\n    this.getInput('AT').appendTitle(menu, 'WHERE');\n    if (Blockly.Msg.LISTS_GET_INDEX_TAIL) {\n      this.moveInputBefore('TAIL', null);\n    }\n  }\n};\n\nBlockly.Blocks.lists_setIndex = {\n  // Set element at index.\n  init: function() {\n    var MODE =\n        [[Blockly.Msg.LISTS_SET_INDEX_SET, 'SET'],\n         [Blockly.Msg.LISTS_SET_INDEX_INSERT, 'INSERT']];\n    this.WHERE_OPTIONS =\n        [[Blockly.Msg.LISTS_GET_INDEX_FROM_START, 'FROM_START'],\n         [Blockly.Msg.LISTS_GET_INDEX_FROM_END, 'FROM_END'],\n         [Blockly.Msg.LISTS_GET_INDEX_FIRST, 'FIRST'],\n         [Blockly.Msg.LISTS_GET_INDEX_LAST, 'LAST'],\n         [Blockly.Msg.LISTS_GET_INDEX_RANDOM, 'RANDOM']];\n    this.setHelpUrl(Blockly.Msg.LISTS_SET_INDEX_HELPURL);\n    this.setHSV(40, 1.0, 0.99);\n    this.appendValueInput('LIST')\n        .setCheck(Blockly.BlockValueType.ARRAY)\n        .appendTitle(Blockly.Msg.LISTS_SET_INDEX_INPUT_IN_LIST);\n    this.appendDummyInput()\n        .appendTitle(new Blockly.FieldDropdown(MODE), 'MODE')\n        .appendTitle('', 'SPACE');\n    this.appendDummyInput('AT');\n    this.appendValueInput('TO')\n        .appendTitle(Blockly.Msg.LISTS_SET_INDEX_INPUT_TO);\n    this.setInputsInline(true);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(Blockly.Msg.LISTS_SET_INDEX_TOOLTIP);\n    this.updateAt(true);\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      var combo = thisBlock.getTitleValue('MODE') + '_' +\n          thisBlock.getTitleValue('WHERE');\n      return Blockly.Msg['LISTS_SET_INDEX_TOOLTIP_' + combo];\n    });\n  },\n  mutationToDom: function() {\n    // Save whether there is an 'AT' input.\n    var container = document.createElement('mutation');\n    var isAt = this.getInput('AT').type == Blockly.INPUT_VALUE;\n    container.setAttribute('at', isAt);\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    // Restore the block shape.\n    // Note: Until January 2013 this block did not have mutations,\n    // so 'at' defaults to true.\n    var isAt = (xmlElement.getAttribute('at') != 'false');\n    this.updateAt(isAt);\n  },\n  updateAt: function(isAt) {\n    // Create or delete an input for the numeric index.\n    // Destroy old 'AT' and 'ORDINAL' input.\n    this.removeInput('AT');\n    this.removeInput('ORDINAL', true);\n    // Create either a value 'AT' input or a dummy input.\n    if (isAt) {\n      this.appendValueInput('AT').setCheck(Blockly.BlockValueType.NUMBER);\n      if (Blockly.Msg.ORDINAL_NUMBER_SUFFIX) {\n        this.appendDummyInput('ORDINAL')\n            .appendTitle(Blockly.Msg.ORDINAL_NUMBER_SUFFIX);\n      }\n    } else {\n      this.appendDummyInput('AT');\n    }\n    var menu = new Blockly.FieldDropdown(this.WHERE_OPTIONS, function(value) {\n      var newAt = (value == 'FROM_START') || (value == 'FROM_END');\n      // The 'isAt' variable is available due to this function being a closure.\n      if (newAt != isAt) {\n        var block = this.sourceBlock_;\n        block.updateAt(newAt);\n        // This menu has been destroyed and replaced.  Update the replacement.\n        block.setTitleValue(value, 'WHERE');\n        return null;\n      }\n      return undefined;\n    });\n    this.moveInputBefore('AT', 'TO');\n    if (this.getInput('ORDINAL')) {\n      this.moveInputBefore('ORDINAL', 'TO');\n    }\n\n    this.getInput('AT').appendTitle(menu, 'WHERE');\n  }\n};\n\nBlockly.Blocks.lists_getSublist = {\n  // Get sublist.\n  init: function() {\n    this.WHERE_OPTIONS_1 =\n        [[Blockly.Msg.LISTS_GET_INDEX_FROM_START, 'FROM_START'],\n         [Blockly.Msg.LISTS_GET_INDEX_FROM_END, 'FROM_END'],\n         [Blockly.Msg.LISTS_GET_INDEX_FIRST, 'FIRST']];\n    this.WHERE_OPTIONS_2 =\n        [[Blockly.Msg.LISTS_GET_INDEX_FROM_START, 'FROM_START'],\n         [Blockly.Msg.LISTS_GET_INDEX_FROM_END, 'FROM_END'],\n         [Blockly.Msg.LISTS_GET_INDEX_LAST, 'LAST']];\n    this.setHelpUrl(Blockly.Msg.LISTS_GET_SUBLIST_HELPURL);\n    this.setHSV(40, 1.0, 0.99);\n    this.appendValueInput('LIST')\n        .setCheck(Blockly.BlockValueType.ARRAY)\n        .appendTitle(Blockly.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST);\n    this.appendDummyInput('AT1');\n    this.appendDummyInput('AT2');\n    if (Blockly.Msg.LISTS_GET_SUBLIST_TAIL) {\n      this.appendDummyInput('TAIL')\n          .appendTitle(Blockly.Msg.LISTS_GET_SUBLIST_TAIL);\n    }\n    this.setInputsInline(true);\n    this.setOutput(true, Blockly.BlockValueType.ARRAY);\n    this.updateAt(1, true);\n    this.updateAt(2, true);\n    this.setTooltip(Blockly.Msg.LISTS_GET_SUBLIST_TOOLTIP);\n  },\n  mutationToDom: function() {\n    // Save whether there are 'AT' inputs.\n    var container = document.createElement('mutation');\n    var isAt1 = this.getInput('AT1').type == Blockly.INPUT_VALUE;\n    container.setAttribute('at1', isAt1);\n    var isAt2 = this.getInput('AT2').type == Blockly.INPUT_VALUE;\n    container.setAttribute('at2', isAt2);\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    // Restore the block shape.\n    var isAt1 = (xmlElement.getAttribute('at1') == 'true');\n    var isAt2 = (xmlElement.getAttribute('at2') == 'true');\n    this.updateAt(1, isAt1);\n    this.updateAt(2, isAt2);\n  },\n  updateAt: function(n, isAt) {\n    // Create or delete an input for the numeric index.\n    // Destroy old 'AT' and 'ORDINAL' inputs.\n    this.removeInput('AT' + n);\n    this.removeInput('ORDINAL' + n, true);\n    // Create either a value 'AT' input or a dummy input.\n    if (isAt) {\n      this.appendValueInput('AT' + n).setCheck(Blockly.BlockValueType.NUMBER);\n      if (Blockly.Msg.ORDINAL_NUMBER_SUFFIX) {\n        this.appendDummyInput('ORDINAL' + n)\n            .appendTitle(Blockly.Msg.ORDINAL_NUMBER_SUFFIX);\n      }\n    } else {\n      this.appendDummyInput('AT' + n);\n    }\n    var menu = new Blockly.FieldDropdown(this['WHERE_OPTIONS_' + n],\n        function(value) {\n      var newAt = (value == 'FROM_START') || (value == 'FROM_END');\n      // The 'isAt' variable is available due to this function being a closure.\n      if (newAt != isAt) {\n        var block = this.sourceBlock_;\n        block.updateAt(n, newAt);\n        // This menu has been destroyed and replaced.  Update the replacement.\n        block.setTitleValue(value, 'WHERE' + n);\n        return null;\n      }\n      return undefined;\n    });\n    this.getInput('AT' + n)\n        .appendTitle(menu, 'WHERE' + n);\n    if (n == 1) {\n      this.moveInputBefore('AT1', 'AT2');\n      if (this.getInput('ORDINAL1')) {\n        this.moveInputBefore('ORDINAL1', 'AT2');\n      }\n    }\n    if (Blockly.Msg.LISTS_GET_SUBLIST_TAIL) {\n      this.moveInputBefore('TAIL', null);\n    }\n  }\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Logic blocks for Blockly.\n * @author q.neutron@gmail.com (Quynh Neutron)\n */\n'use strict';\n\ngoog.provide('Blockly.Blocks.logic');\n\ngoog.require('Blockly.Blocks');\n\n\nBlockly.Blocks.controls_if = {\n  // If/elseif/else condition.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.CONTROLS_IF_HELPURL);\n    this.setColour(210);\n    this.appendValueInput('IF0')\n        .setCheck(Blockly.BlockValueType.BOOLEAN)\n        .appendTitle(Blockly.Msg.CONTROLS_IF_MSG_IF);\n    this.appendStatementInput('DO0')\n        .appendTitle(Blockly.Msg.CONTROLS_IF_MSG_THEN);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    if (!Blockly.disableIfElseEditing) {\n      this.setMutator(new Blockly.Mutator([\n        'controls_if_elseif',\n        'controls_if_else'\n      ]));\n    }\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      if (!thisBlock.elseifCount_ && !thisBlock.elseCount_) {\n        return Blockly.Msg.CONTROLS_IF_TOOLTIP_1;\n      } else if (!thisBlock.elseifCount_ && thisBlock.elseCount_) {\n        return Blockly.Msg.CONTROLS_IF_TOOLTIP_2;\n      } else if (thisBlock.elseifCount_ && !thisBlock.elseCount_) {\n        return Blockly.Msg.CONTROLS_IF_TOOLTIP_3;\n      } else if (thisBlock.elseifCount_ && thisBlock.elseCount_) {\n        return Blockly.Msg.CONTROLS_IF_TOOLTIP_4;\n      }\n      return '';\n    });\n    this.elseifCount_ = 0;\n    this.elseCount_ = 0;\n  },\n  mutationToDom: function() {\n    if (!this.elseifCount_ && !this.elseCount_) {\n      return null;\n    }\n    var container = document.createElement('mutation');\n    if (this.elseifCount_) {\n      container.setAttribute('elseif', this.elseifCount_);\n    }\n    if (this.elseCount_) {\n      container.setAttribute('else', 1);\n    }\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    this.elseifCount_ = window.parseInt(xmlElement.getAttribute('elseif'), 10);\n    this.elseCount_ = window.parseInt(xmlElement.getAttribute('else'), 10);\n    for (var x = 1; x <= this.elseifCount_; x++) {\n      this.appendValueInput('IF' + x)\n          .setCheck(Blockly.BlockValueType.BOOLEAN)\n          .appendTitle(Blockly.Msg.CONTROLS_IF_MSG_ELSEIF);\n      this.appendStatementInput('DO' + x)\n          .appendTitle(Blockly.Msg.CONTROLS_IF_MSG_THEN);\n    }\n    if (this.elseCount_) {\n      this.appendStatementInput('ELSE')\n          .appendTitle(Blockly.Msg.CONTROLS_IF_MSG_ELSE);\n    }\n  },\n  decompose: function(blockSpace) {\n    var containerBlock = new Blockly.Block(blockSpace, 'controls_if_if');\n    containerBlock.initSvg();\n    var connection = containerBlock.getInput('STACK').connection;\n    for (var x = 1; x <= this.elseifCount_; x++) {\n      var elseifBlock = new Blockly.Block(blockSpace, 'controls_if_elseif');\n      elseifBlock.initSvg();\n      connection.connect(elseifBlock.previousConnection);\n      connection = elseifBlock.nextConnection;\n    }\n    if (this.elseCount_) {\n      var elseBlock = new Blockly.Block(blockSpace, 'controls_if_else');\n      elseBlock.initSvg();\n      connection.connect(elseBlock.previousConnection);\n    }\n    return containerBlock;\n  },\n  compose: function(containerBlock) {\n    // Disconnect the else input blocks and remove the inputs.\n    if (this.elseCount_) {\n      this.removeInput('ELSE');\n    }\n    this.elseCount_ = 0;\n    // Disconnect all the elseif input blocks and remove the inputs.\n    for (var x = this.elseifCount_; x > 0; x--) {\n      this.removeInput('IF' + x);\n      this.removeInput('DO' + x);\n    }\n    this.elseifCount_ = 0;\n    // Rebuild the block's optional inputs.\n    var clauseBlock = containerBlock.getInputTargetBlock('STACK');\n    while (clauseBlock) {\n      switch (clauseBlock.type) {\n        case 'controls_if_elseif':\n          this.elseifCount_++;\n          var ifInput = this.appendValueInput('IF' + this.elseifCount_)\n              .setCheck(Blockly.BlockValueType.BOOLEAN)\n              .appendTitle(Blockly.Msg.CONTROLS_IF_MSG_ELSEIF);\n          var doInput = this.appendStatementInput('DO' + this.elseifCount_);\n          doInput.appendTitle(Blockly.Msg.CONTROLS_IF_MSG_THEN);\n          // Reconnect any child blocks.\n          if (clauseBlock.valueConnection_) {\n            ifInput.connection.connect(clauseBlock.valueConnection_);\n          }\n          if (clauseBlock.statementConnection_) {\n            doInput.connection.connect(clauseBlock.statementConnection_);\n          }\n          break;\n        case 'controls_if_else':\n          this.elseCount_++;\n          var elseInput = this.appendStatementInput('ELSE');\n          elseInput.appendTitle(Blockly.Msg.CONTROLS_IF_MSG_ELSE);\n          // Reconnect any child blocks.\n          if (clauseBlock.statementConnection_) {\n            elseInput.connection.connect(clauseBlock.statementConnection_);\n          }\n          break;\n        default:\n          throw 'Unknown block type.';\n      }\n      clauseBlock = clauseBlock.nextConnection &&\n          clauseBlock.nextConnection.targetBlock();\n    }\n  },\n  saveConnections: function(containerBlock) {\n    // Store a pointer to any connected child blocks.\n    var clauseBlock = containerBlock.getInputTargetBlock('STACK');\n    var x = 1;\n    while (clauseBlock) {\n      switch (clauseBlock.type) {\n        case 'controls_if_elseif':\n          var inputIf = this.getInput('IF' + x);\n          var inputDo = this.getInput('DO' + x);\n          clauseBlock.valueConnection_ =\n              inputIf && inputIf.connection.targetConnection;\n          clauseBlock.statementConnection_ =\n              inputDo && inputDo.connection.targetConnection;\n          x++;\n          break;\n        case 'controls_if_else':\n          var inputDo = this.getInput('ELSE');\n          clauseBlock.statementConnection_ =\n              inputDo && inputDo.connection.targetConnection;\n          break;\n        default:\n          throw 'Unknown block type.';\n      }\n      clauseBlock = clauseBlock.nextConnection &&\n          clauseBlock.nextConnection.targetBlock();\n    }\n  }\n};\n\nBlockly.Blocks.controls_if_if = {\n  // If condition.\n  init: function() {\n    this.setHSV(196, 1.0, 0.79);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.CONTROLS_IF_IF_TITLE_IF);\n    this.appendStatementInput('STACK');\n    this.setTooltip(Blockly.Msg.CONTROLS_IF_IF_TOOLTIP);\n    this.contextMenu = false;\n  }\n};\n\nBlockly.Blocks.controls_if_elseif = {\n  // Else-If condition.\n  init: function() {\n    this.setHSV(196, 1.0, 0.79);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(Blockly.Msg.CONTROLS_IF_ELSEIF_TOOLTIP);\n    this.contextMenu = false;\n  }\n};\n\nBlockly.Blocks.controls_if_else = {\n  // Else condition.\n  init: function() {\n    this.setHSV(196, 1.0, 0.79);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.CONTROLS_IF_ELSE_TITLE_ELSE);\n    this.setPreviousStatement(true);\n    this.setTooltip(Blockly.Msg.CONTROLS_IF_ELSE_TOOLTIP);\n    this.contextMenu = false;\n  }\n};\n\nBlockly.Blocks.logic_compare = {\n  // Comparison operator.\n  init: function() {\n    if (Blockly.RTL) {\n      var OPERATORS = [\n        ['=', 'EQ'],\n        ['\\u2260', 'NEQ'],\n        ['>', 'LT'],\n        ['\\u2265', 'LTE'],\n        ['<', 'GT'],\n        ['\\u2264', 'GTE']\n      ];\n    } else {\n      var OPERATORS = [\n        ['=', 'EQ'],\n        ['\\u2260', 'NEQ'],\n        ['<', 'LT'],\n        ['\\u2264', 'LTE'],\n        ['>', 'GT'],\n        ['\\u2265', 'GTE']\n      ];\n    }\n    this.setHelpUrl(Blockly.Msg.LOGIC_COMPARE_HELPURL);\n    this.setHSV(196, 1.0, 0.79);\n    this.setOutput(true, Blockly.BlockValueType.BOOLEAN);\n    this.appendValueInput('A');\n    this.appendValueInput('B')\n        .appendTitle(new Blockly.FieldDropdown(OPERATORS), 'OP');\n    this.setInputsInline(true);\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      var op = thisBlock.getTitleValue('OP');\n      var TOOLTIPS = {\n        EQ: Blockly.Msg.LOGIC_COMPARE_TOOLTIP_EQ,\n        NEQ: Blockly.Msg.LOGIC_COMPARE_TOOLTIP_NEQ,\n        LT: Blockly.Msg.LOGIC_COMPARE_TOOLTIP_LT,\n        LTE: Blockly.Msg.LOGIC_COMPARE_TOOLTIP_LTE,\n        GT: Blockly.Msg.LOGIC_COMPARE_TOOLTIP_GT,\n        GTE: Blockly.Msg.LOGIC_COMPARE_TOOLTIP_GTE\n      };\n      return TOOLTIPS[op];\n    });\n  }\n};\n\nBlockly.Blocks.logic_operation = {\n  // Logical operations: 'and', 'or'.\n  init: function() {\n    var OPERATORS =\n        [[Blockly.Msg.LOGIC_OPERATION_AND, 'AND'],\n         [Blockly.Msg.LOGIC_OPERATION_OR, 'OR']];\n    this.setHelpUrl(Blockly.Msg.LOGIC_OPERATION_HELPURL);\n    this.setHSV(196, 1.0, 0.79);\n    this.setOutput(true, Blockly.BlockValueType.BOOLEAN);\n    this.appendValueInput('A')\n        .setCheck(Blockly.BlockValueType.BOOLEAN);\n    this.appendValueInput('B')\n        .setCheck(Blockly.BlockValueType.BOOLEAN)\n        .appendTitle(new Blockly.FieldDropdown(OPERATORS), 'OP');\n    this.setInputsInline(true);\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      var op = thisBlock.getTitleValue('OP');\n      var TOOLTIPS = {\n        AND: Blockly.Msg.LOGIC_OPERATION_TOOLTIP_AND,\n        OR: Blockly.Msg.LOGIC_OPERATION_TOOLTIP_OR\n      };\n      return thisBlock.TOOLTIPS[op];\n    });\n  }\n};\n\n\nBlockly.Blocks.logic_negate = {\n  // Negation.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.LOGIC_NEGATE_HELPURL);\n    this.setHSV(196, 1.0, 0.79);\n    this.setOutput(true, Blockly.BlockValueType.BOOLEAN);\n    this.interpolateMsg(Blockly.Msg.LOGIC_NEGATE_TITLE,\n                        ['BOOL', Blockly.BlockValueType.BOOLEAN, Blockly.ALIGN_RIGHT],\n                        Blockly.ALIGN_RIGHT)\n    this.setTooltip(Blockly.Msg.LOGIC_NEGATE_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.logic_boolean = {\n  // Boolean data type: true and false.\n  init: function() {\n    var BOOLEANS =\n        [[Blockly.Msg.LOGIC_BOOLEAN_TRUE, 'TRUE'],\n         [Blockly.Msg.LOGIC_BOOLEAN_FALSE, 'FALSE']];\n    this.setHelpUrl(Blockly.Msg.LOGIC_BOOLEAN_HELPURL);\n    this.setHSV(196, 1.0, 0.79);\n    this.setOutput(true, Blockly.BlockValueType.BOOLEAN);\n    this.appendDummyInput()\n        .appendTitle(new Blockly.FieldDropdown(BOOLEANS), 'BOOL');\n    this.setTooltip(Blockly.Msg.LOGIC_BOOLEAN_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.logic_null = {\n  // Null data type.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.LOGIC_NULL_HELPURL);\n    this.setHSV(196, 1.0, 0.79);\n    this.setOutput(true);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.LOGIC_NULL);\n    this.setTooltip(Blockly.Msg.LOGIC_NULL_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.logic_ternary = {\n  // Ternary operator.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.LOGIC_TERNARY_HELPURL);\n    this.setHSV(196, 1.0, 0.79);\n    this.appendValueInput('IF')\n        .setCheck(Blockly.BlockValueType.BOOLEAN)\n        .appendTitle(Blockly.Msg.LOGIC_TERNARY_CONDITION);\n    this.appendValueInput('THEN')\n        .appendTitle(Blockly.Msg.LOGIC_TERNARY_IF_TRUE);\n    this.appendValueInput('ELSE')\n        .appendTitle(Blockly.Msg.LOGIC_TERNARY_IF_FALSE);\n    this.setOutput(true);\n    this.setTooltip(Blockly.Msg.LOGIC_TERNARY_TOOLTIP);\n  }\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Loop blocks for Blockly.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Blocks.loops');\n\ngoog.require('Blockly.Blocks');\n\n\nBlockly.Blocks.controls_repeat = {\n  // Repeat n times (internal number).\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.CONTROLS_REPEAT_HELPURL);\n    this.setHSV(120, 0.448, 0.647);\n    this.appendDummyInput()\n        .appendTitle(new Blockly.FieldImage(Blockly.assetUrlRoot + \"/assets/media/common_images/loop.png\"))\n        .appendTitle(Blockly.Msg.CONTROLS_REPEAT_TITLE_REPEAT)\n        .appendTitle(new Blockly.FieldTextInput('10',\n            Blockly.FieldTextInput.nonnegativeIntegerValidator), 'TIMES')\n        .appendTitle(Blockly.Msg.CONTROLS_REPEAT_TITLE_TIMES);\n    this.appendStatementInput('DO')\n        .appendTitle(Blockly.Msg.CONTROLS_REPEAT_INPUT_DO);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(Blockly.Msg.CONTROLS_REPEAT_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.controls_repeat_ext = {\n  // Repeat n times (external number).\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.CONTROLS_REPEAT_HELPURL);\n    this.setHSV(120, 0.448, 0.647);\n    this.appendDummyInput()\n        .appendTitle(new Blockly.FieldImage(Blockly.assetUrlRoot + \"/assets/media/common_images/loop.png\"));\n    this.interpolateMsg(Blockly.Msg.CONTROLS_REPEAT_TITLE,\n                        ['TIMES', 'Number', Blockly.ALIGN_RIGHT],\n                        Blockly.ALIGN_RIGHT);\n    this.appendStatementInput('DO')\n        .appendTitle(Blockly.Msg.CONTROLS_REPEAT_INPUT_DO);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setInputsInline(true);\n    this.setTooltip(Blockly.Msg.CONTROLS_REPEAT_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.controls_whileUntil = {\n  // Do while/until loop.\n  init: function() {\n    var OPERATORS =\n        [[Blockly.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE, 'WHILE'],\n         [Blockly.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL, 'UNTIL']];\n    this.setHelpUrl(Blockly.Msg.CONTROLS_WHILEUNTIL_HELPURL);\n    this.setHSV(120, 0.448, 0.647);\n    this.appendValueInput('BOOL')\n        .setCheck(Blockly.BlockValueType.BOOLEAN)\n        .appendTitle(new Blockly.FieldImage(Blockly.assetUrlRoot + \"/assets/media/common_images/loop.png\"))\n        .appendTitle(new Blockly.FieldDropdown(OPERATORS), 'MODE');\n    this.appendStatementInput('DO')\n        .appendTitle(Blockly.Msg.CONTROLS_WHILEUNTIL_INPUT_DO);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      var op = thisBlock.getTitleValue('MODE');\n      var TOOLTIPS = {\n        WHILE: Blockly.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE,\n        UNTIL: Blockly.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL\n      };\n      return TOOLTIPS[op];\n    });\n  }\n};\n\nBlockly.Blocks.controls_for = {\n  // For loop.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.CONTROLS_FOR_HELPURL);\n    this.setHSV(120, 0.448, 0.647);\n    this.appendDummyInput()\n        .appendTitle(new Blockly.FieldImage(Blockly.assetUrlRoot + \"/assets/media/common_images/loop.png\"))\n        .appendTitle(Blockly.Msg.CONTROLS_FOR_INPUT_WITH)\n        .appendTitle(new Blockly.FieldVariable(null), 'VAR');\n    this.interpolateMsg(Blockly.Msg.CONTROLS_FOR_INPUT_FROM_TO_BY,\n                        ['FROM', 'Number', Blockly.ALIGN_RIGHT],\n                        ['TO', 'Number', Blockly.ALIGN_RIGHT],\n                        ['BY', 'Number', Blockly.ALIGN_RIGHT],\n                        Blockly.ALIGN_RIGHT);\n    this.appendStatementInput('DO')\n        .appendTitle(Blockly.Msg.CONTROLS_FOR_INPUT_DO);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setInputsInline(true);\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      return Blockly.Msg.CONTROLS_FOR_TOOLTIP.replace('%1',\n          thisBlock.getTitleValue('VAR'));\n    });\n  },\n  getVars: Blockly.Variables.getVars,\n  renameVar: function(oldName, newName) {\n    if (Blockly.Names.equals(oldName, this.getTitleValue('VAR'))) {\n      this.setTitleValue(newName, 'VAR');\n    }\n  },\n  customContextMenu: function(options) {\n    var option = {enabled: true};\n    var name = this.getTitleValue('VAR');\n    option.text = Blockly.Msg.VARIABLES_SET_CREATE_GET.replace('%1', name);\n    var xmlTitle = goog.dom.createDom('title', null, name);\n    xmlTitle.setAttribute('name', 'VAR');\n    var xmlBlock = goog.dom.createDom('block', null, xmlTitle);\n    xmlBlock.setAttribute('type', 'variables_get');\n    option.callback = Blockly.ContextMenu.callbackFactory(this, xmlBlock);\n    options.push(option);\n  },\n  domToMutation: function(xmlElement) {\n    if (xmlElement.getAttribute('name') === 'default_var') {\n      var baseName = xmlElement.childNodes[0].data;\n      var newName = Blockly.Variables.generateUniqueNameFromBase_(baseName);\n      this.setTitleValue(newName, 'VAR');\n    }\n  }\n};\n\nBlockly.Blocks.controls_forEach = {\n  // For each loop.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.CONTROLS_FOREACH_HELPURL);\n    this.setHSV(120, 0.448, 0.647);\n    this.appendValueInput('LIST')\n        .setCheck(Blockly.BlockValueType.ARRAY)\n        .appendTitle(new Blockly.FieldImage(Blockly.assetUrlRoot + \"/assets/media/common_images/loop.png\"))\n        .appendTitle(Blockly.Msg.CONTROLS_FOREACH_INPUT_ITEM)\n        .appendTitle(new Blockly.FieldVariable(null), 'VAR')\n        .appendTitle(Blockly.Msg.CONTROLS_FOREACH_INPUT_INLIST);\n    if (Blockly.Msg.CONTROLS_FOREACH_INPUT_INLIST_TAIL) {\n      this.appendDummyInput()\n          .appendTitle(Blockly.Msg.CONTROLS_FOREACH_INPUT_INLIST_TAIL);\n      this.setInputsInline(true);\n    }\n    this.appendStatementInput('DO')\n        .appendTitle(Blockly.Msg.CONTROLS_FOREACH_INPUT_DO);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      return Blockly.Msg.CONTROLS_FOREACH_TOOLTIP.replace('%1',\n          thisBlock.getTitleValue('VAR'));\n    });\n  },\n  getVars: Blockly.Variables.getVars,\n  renameVar: function(oldName, newName) {\n    if (Blockly.Names.equals(oldName, this.getTitleValue('VAR'))) {\n      this.setTitleValue(newName, 'VAR');\n    }\n  },\n  customContextMenu: Blockly.Blocks.controls_for.customContextMenu\n};\n\nBlockly.Blocks.controls_flow_statements = {\n  // Flow statements: continue, break.\n  init: function() {\n    var OPERATORS =\n        [[Blockly.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK, 'BREAK'],\n         [Blockly.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE, 'CONTINUE']];\n    this.setHelpUrl(Blockly.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL);\n    this.setHSV(120, 0.448, 0.647);\n    this.appendDummyInput()\n        .appendTitle(new Blockly.FieldDropdown(OPERATORS), 'FLOW');\n    this.setPreviousStatement(true);\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      var op = thisBlock.getTitleValue('FLOW');\n      var TOOLTIPS = {\n        BREAK: Blockly.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK,\n        CONTINUE: Blockly.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE\n      };\n      return thisBlock.TOOLTIPS[op];\n    });\n  },\n  onchange: function() {\n    if (!this.blockSpace) {\n      // Block has been deleted.\n      return;\n    }\n    var legal = false;\n    // Is the block nested in a control statement?\n    var block = this;\n    do {\n      if (block.type == 'controls_repeat' ||\n          block.type == 'controls_repeat_ext' ||\n          block.type == 'controls_forEach' ||\n          block.type == 'controls_for' ||\n          block.type == 'controls_whileUntil') {\n        legal = true;\n        break;\n      }\n      block = block.getSurroundParent();\n    } while (block);\n    if (legal) {\n      this.setWarningText(null);\n    } else {\n      this.setWarningText(Blockly.Msg.CONTROLS_FLOW_STATEMENTS_WARNING);\n    }\n  }\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Math blocks for Blockly.\n * @author q.neutron@gmail.com (Quynh Neutron)\n */\n'use strict';\n\ngoog.provide('Blockly.Blocks.math');\n\ngoog.require('Blockly.Blocks');\n\n\nBlockly.Blocks.math_number = {\n  // Numeric value.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.MATH_NUMBER_HELPURL);\n    this.setHSV(258, 0.35, 0.62);\n    this.appendDummyInput()\n        .appendTitle(new Blockly.FieldTextInput('0',\n        Blockly.FieldTextInput.numberValidator), 'NUM');\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.setTooltip(Blockly.Msg.MATH_NUMBER_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.math_arithmetic = {\n  // Basic arithmetic operator.\n  init: function() {\n    var OPERATORS =\n        [[Blockly.Msg.MATH_ADDITION_SYMBOL, 'ADD'],\n         [Blockly.Msg.MATH_SUBTRACTION_SYMBOL, 'MINUS'],\n         [Blockly.Msg.MATH_MULTIPLICATION_SYMBOL, 'MULTIPLY'],\n         [Blockly.Msg.MATH_DIVISION_SYMBOL, 'DIVIDE'],\n         [Blockly.Msg.MATH_POWER_SYMBOL, 'POWER']];\n    this.setHelpUrl(Blockly.Msg.MATH_ARITHMETIC_HELPURL);\n    this.setHSV(258, 0.35, 0.62);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.appendValueInput('A')\n        .setCheck(Blockly.BlockValueType.NUMBER);\n    this.appendValueInput('B')\n        .setCheck(Blockly.BlockValueType.NUMBER)\n        .appendTitle(new Blockly.FieldDropdown(OPERATORS), 'OP');\n    this.setInputsInline(true);\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      var mode = thisBlock.getTitleValue('OP');\n      var TOOLTIPS = {\n        ADD: Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_ADD,\n        MINUS: Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS,\n        MULTIPLY: Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY,\n        DIVIDE: Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE,\n        POWER: Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_POWER\n      };\n      return TOOLTIPS[mode];\n    });\n  }\n};\n\nBlockly.Blocks.math_single = {\n  // Advanced math operators with single operand.\n  init: function() {\n    var OPERATORS =\n        [[Blockly.Msg.MATH_SINGLE_OP_ROOT, 'ROOT'],\n         [Blockly.Msg.MATH_SINGLE_OP_ABSOLUTE, 'ABS'],\n         ['-', 'NEG'],\n         ['ln', 'LN'],\n         ['log10', 'LOG10'],\n         ['e^', 'EXP'],\n         ['10^', 'POW10']];\n    this.setHelpUrl(Blockly.Msg.MATH_SINGLE_HELPURL);\n    this.setHSV(258, 0.35, 0.62);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.appendValueInput('NUM')\n        .setCheck(Blockly.BlockValueType.NUMBER)\n        .appendTitle(new Blockly.FieldDropdown(OPERATORS), 'OP');\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      var mode = thisBlock.getTitleValue('OP');\n      var TOOLTIPS = {\n        ROOT: Blockly.Msg.MATH_SINGLE_TOOLTIP_ROOT,\n        ABS: Blockly.Msg.MATH_SINGLE_TOOLTIP_ABS,\n        NEG: Blockly.Msg.MATH_SINGLE_TOOLTIP_NEG,\n        LN: Blockly.Msg.MATH_SINGLE_TOOLTIP_LN,\n        LOG10: Blockly.Msg.MATH_SINGLE_TOOLTIP_LOG10,\n        EXP: Blockly.Msg.MATH_SINGLE_TOOLTIP_EXP,\n        POW10: Blockly.Msg.MATH_SINGLE_TOOLTIP_POW10\n      };\n      return TOOLTIPS[mode];\n    });\n  }\n};\n\nBlockly.Blocks.math_trig = {\n  // Trigonometry operators.\n  init: function() {\n    var OPERATORS =\n        [[Blockly.Msg.MATH_TRIG_SIN, 'SIN'],\n         [Blockly.Msg.MATH_TRIG_COS, 'COS'],\n         [Blockly.Msg.MATH_TRIG_TAN, 'TAN'],\n         [Blockly.Msg.MATH_TRIG_ASIN, 'ASIN'],\n         [Blockly.Msg.MATH_TRIG_ACOS, 'ACOS'],\n         [Blockly.Msg.MATH_TRIG_ATAN, 'ATAN']];\n    this.setHelpUrl(Blockly.Msg.MATH_TRIG_HELPURL);\n    this.setHSV(258, 0.35, 0.62);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.appendValueInput('NUM')\n        .setCheck(Blockly.BlockValueType.NUMBER)\n        .appendTitle(new Blockly.FieldDropdown(OPERATORS), 'OP');\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      var mode = thisBlock.getTitleValue('OP');\n      var TOOLTIPS = {\n        SIN: Blockly.Msg.MATH_TRIG_TOOLTIP_SIN,\n        COS: Blockly.Msg.MATH_TRIG_TOOLTIP_COS,\n        TAN: Blockly.Msg.MATH_TRIG_TOOLTIP_TAN,\n        ASIN: Blockly.Msg.MATH_TRIG_TOOLTIP_ASIN,\n        ACOS: Blockly.Msg.MATH_TRIG_TOOLTIP_ACOS,\n        ATAN: Blockly.Msg.MATH_TRIG_TOOLTIP_ATAN\n      };\n      return TOOLTIPS[mode];\n    });\n  }\n};\n\nBlockly.Blocks.math_constant = {\n  // Constants: PI, E, the Golden Ratio, sqrt(2), 1/sqrt(2), INFINITY.\n  init: function() {\n    var CONSTANTS =\n        [['\\u03c0', 'PI'],\n         ['e', 'E'],\n         ['\\u03c6', 'GOLDEN_RATIO'],\n         ['sqrt(2)', 'SQRT2'],\n         ['sqrt(\\u00bd)', 'SQRT1_2'],\n         ['\\u221e', 'INFINITY']];\n    this.setHelpUrl(Blockly.Msg.MATH_CONSTANT_HELPURL);\n    this.setHSV(258, 0.35, 0.62);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.appendDummyInput()\n        .appendTitle(new Blockly.FieldDropdown(CONSTANTS), 'CONSTANT');\n    this.setTooltip(Blockly.Msg.MATH_CONSTANT_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.math_number_property = {\n  // Check if a number is even, odd, prime, whole, positive, or negative\n  // or if it is divisible by certain number. Returns true or false.\n  init: function() {\n    var PROPERTIES =\n        [[Blockly.Msg.MATH_IS_EVEN, 'EVEN'],\n         [Blockly.Msg.MATH_IS_ODD, 'ODD'],\n         [Blockly.Msg.MATH_IS_PRIME, 'PRIME'],\n         [Blockly.Msg.MATH_IS_WHOLE, 'WHOLE'],\n         [Blockly.Msg.MATH_IS_POSITIVE, 'POSITIVE'],\n         [Blockly.Msg.MATH_IS_NEGATIVE, 'NEGATIVE'],\n         [Blockly.Msg.MATH_IS_DIVISIBLE_BY, 'DIVISIBLE_BY']];\n    this.setHSV(258, 0.35, 0.62);\n    this.appendValueInput('NUMBER_TO_CHECK')\n        .setCheck(Blockly.BlockValueType.NUMBER);\n    var dropdown = new Blockly.FieldDropdown(PROPERTIES, function(option) {\n      var divisorInput = (option == 'DIVISIBLE_BY');\n      this.sourceBlock_.updateShape(divisorInput);\n    });\n    this.appendDummyInput()\n        .appendTitle(dropdown, 'PROPERTY');\n    this.setInputsInline(true);\n    this.setOutput(true, Blockly.BlockValueType.BOOLEAN);\n    this.setTooltip(Blockly.Msg.MATH_IS_TOOLTIP);\n  },\n  mutationToDom: function() {\n    // Save whether the 'divisorInput' should be true of false (present or not).\n    var container = document.createElement('mutation');\n    var divisorInput = (this.getTitleValue('PROPERTY') == 'DIVISIBLE_BY');\n    container.setAttribute('divisor_input', divisorInput);\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    // Restore the 'divisorInput'.\n    var divisorInput = (xmlElement.getAttribute('divisor_input') == 'true');\n    this.updateShape(divisorInput);\n  },\n  updateShape: function(divisorInput) {\n    // Add or remove a Value Input.\n    var inputExists = this.getInput('DIVISOR');\n    if (divisorInput) {\n      if (!inputExists) {\n        this.appendValueInput('DIVISOR')\n                 .setCheck(Blockly.BlockValueType.NUMBER);\n      }\n    } else if (inputExists) {\n      this.removeInput('DIVISOR');\n    }\n  }\n};\n\nBlockly.Blocks.math_change = {\n  // Add to a variable in place.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.MATH_CHANGE_HELPURL);\n    this.setHSV(258, 0.35, 0.62);\n    this.appendValueInput('DELTA')\n        .setCheck(Blockly.BlockValueType.NUMBER)\n        .appendTitle(Blockly.Msg.MATH_CHANGE_TITLE_CHANGE)\n        .appendTitle(new Blockly.FieldVariable(\n        Blockly.Msg.MATH_CHANGE_TITLE_ITEM), 'VAR')\n        .appendTitle(Blockly.Msg.MATH_CHANGE_INPUT_BY);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      return Blockly.Msg.MATH_CHANGE_TOOLTIP.replace('%1',\n          thisBlock.getTitleValue('VAR'));\n    });\n  },\n  getVars: Blockly.Variables.getVars,\n  renameVar: function(oldName, newName) {\n    if (Blockly.Names.equals(oldName, this.getTitleValue('VAR'))) {\n      this.setTitleValue(newName, 'VAR');\n    }\n  }\n};\n\nBlockly.Blocks.math_round = {\n  // Rounding functions.\n  init: function() {\n    var OPERATORS =\n        [[Blockly.Msg.MATH_ROUND_OPERATOR_ROUND, 'ROUND'],\n         [Blockly.Msg.MATH_ROUND_OPERATOR_ROUNDUP, 'ROUNDUP'],\n         [Blockly.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN, 'ROUNDDOWN']];\n    this.setHelpUrl(Blockly.Msg.MATH_ROUND_HELPURL);\n    this.setHSV(258, 0.35, 0.62);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.appendValueInput('NUM')\n        .setCheck(Blockly.BlockValueType.NUMBER)\n        .appendTitle(new Blockly.FieldDropdown(OPERATORS), 'OP');\n    this.setTooltip(Blockly.Msg.MATH_ROUND_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.math_on_list = {\n  // Evaluate a list of numbers to return sum, average, min, max, etc.\n  // Some functions also work on text (min, max, mode, median).\n  init: function() {\n    var OPERATORS =\n        [[Blockly.Msg.MATH_ONLIST_OPERATOR_SUM, 'SUM'],\n         [Blockly.Msg.MATH_ONLIST_OPERATOR_MIN, 'MIN'],\n         [Blockly.Msg.MATH_ONLIST_OPERATOR_MAX, 'MAX'],\n         [Blockly.Msg.MATH_ONLIST_OPERATOR_AVERAGE, 'AVERAGE'],\n         [Blockly.Msg.MATH_ONLIST_OPERATOR_MEDIAN, 'MEDIAN'],\n         [Blockly.Msg.MATH_ONLIST_OPERATOR_MODE, 'MODE'],\n         [Blockly.Msg.MATH_ONLIST_OPERATOR_STD_DEV, 'STD_DEV'],\n         [Blockly.Msg.MATH_ONLIST_OPERATOR_RANDOM, 'RANDOM']];\n    // Assign 'this' to a variable for use in the closure below.\n    var thisBlock = this;\n    this.setHelpUrl(Blockly.Msg.MATH_ONLIST_HELPURL);\n    this.setHSV(258, 0.35, 0.62);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    var dropdown = new Blockly.FieldDropdown(OPERATORS, function(newOp) {\n      if (newOp == 'MODE') {\n        thisBlock.outputConnection.setCheck(Blockly.BlockValueType.ARRAY);\n      } else {\n        thisBlock.outputConnection.setCheck(Blockly.BlockValueType.NUMBER);\n      }\n    });\n    this.appendValueInput('LIST')\n        .setCheck(Blockly.BlockValueType.ARRAY)\n        .appendTitle(dropdown, 'OP');\n    this.setTooltip(function() {\n      var mode = thisBlock.getTitleValue('OP');\n      var TOOLTIPS = {\n        SUM: Blockly.Msg.MATH_ONLIST_TOOLTIP_SUM,\n        MIN: Blockly.Msg.MATH_ONLIST_TOOLTIP_MIN,\n        MAX: Blockly.Msg.MATH_ONLIST_TOOLTIP_MAX,\n        AVERAGE: Blockly.Msg.MATH_ONLIST_TOOLTIP_AVERAGE,\n        MEDIAN: Blockly.Msg.MATH_ONLIST_TOOLTIP_MEDIAN,\n        MODE: Blockly.Msg.MATH_ONLIST_TOOLTIP_MODE,\n        STD_DEV: Blockly.Msg.MATH_ONLIST_TOOLTIP_STD_DEV,\n        RANDOM: Blockly.Msg.MATH_ONLIST_TOOLTIP_RANDOM\n      };\n      return thisBlock.TOOLTIPS[mode];\n    });\n  }\n};\n\nBlockly.Blocks.math_modulo = {\n  // Remainder of a division.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.MATH_MODULO_HELPURL);\n    this.setHSV(258, 0.35, 0.62);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.interpolateMsg(Blockly.Msg.MATH_MODULO_TITLE,\n                        ['DIVIDEND', 'Number', Blockly.ALIGN_RIGHT],\n                        ['DIVISOR', 'Number', Blockly.ALIGN_RIGHT],\n                        Blockly.ALIGN_RIGHT);\n    this.setInputsInline(true);\n    this.setTooltip(Blockly.Msg.MATH_MODULO_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.math_constrain = {\n  // Constrain a number between two limits.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.MATH_CONSTRAIN_HELPURL);\n    this.setHSV(258, 0.35, 0.62);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.interpolateMsg(Blockly.Msg.MATH_CONSTRAIN_TITLE,\n                        ['VALUE', 'Number', Blockly.ALIGN_RIGHT],\n                        ['LOW', 'Number', Blockly.ALIGN_RIGHT],\n                        ['HIGH', 'Number', Blockly.ALIGN_RIGHT],\n                        Blockly.ALIGN_RIGHT)\n    this.setInputsInline(true);\n    this.setTooltip(Blockly.Msg.MATH_CONSTRAIN_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.math_random_int = {\n  // Random integer between [X] and [Y].\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.MATH_RANDOM_INT_HELPURL);\n    this.setHSV(258, 0.35, 0.62);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.interpolateMsg(Blockly.Msg.MATH_RANDOM_INT_TITLE,\n                        ['FROM', 'Number', Blockly.ALIGN_RIGHT],\n                        ['TO', 'Number', Blockly.ALIGN_RIGHT],\n                        Blockly.ALIGN_RIGHT);\n    this.setInputsInline(true);\n    this.setTooltip(Blockly.Msg.MATH_RANDOM_INT_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.math_random_float = {\n  // Random fraction between 0 and 1.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.MATH_RANDOM_FLOAT_HELPURL);\n    this.setHSV(258, 0.35, 0.62);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM);\n    this.setTooltip(Blockly.Msg.MATH_RANDOM_FLOAT_TOOLTIP);\n  }\n};\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Text blocks for Blockly.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.Blocks.text');\n\ngoog.require('Blockly.Blocks');\n\n\nBlockly.Blocks.text = {\n  // Text value.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.TEXT_TEXT_HELPURL);\n    this.setColour(160);\n    this.appendDummyInput()\n        .appendTitle(new Blockly.FieldImage(\n              Blockly.assetUrl('media/quote0.png'), 12, 12))\n        .appendTitle(new Blockly.FieldTextInput(''), 'TEXT')\n        .appendTitle(new Blockly.FieldImage(\n              Blockly.assetUrl('media/quote1.png'), 12, 12));\n    this.setOutput(true, Blockly.BlockValueType.STRING);\n    this.setTooltip(Blockly.Msg.TEXT_TEXT_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.text_join = {\n  // Create a string made up of any number of elements of any type.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.TEXT_JOIN_HELPURL);\n    this.setColour(160);\n    this.appendValueInput('ADD0')\n        .appendTitle(Blockly.Msg.TEXT_JOIN_TITLE_CREATEWITH);\n    this.appendValueInput('ADD1');\n    this.setOutput(true, Blockly.BlockValueType.STRING);\n    this.setMutator(new Blockly.Mutator(['text_create_join_item']));\n    this.setTooltip(Blockly.Msg.TEXT_JOIN_TOOLTIP);\n    this.itemCount_ = 2;\n  },\n  mutationToDom: function() {\n    var container = document.createElement('mutation');\n    container.setAttribute('items', this.itemCount_);\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    for (var x = 0; x < this.itemCount_; x++) {\n      this.removeInput('ADD' + x);\n    }\n    this.itemCount_ = window.parseInt(xmlElement.getAttribute('items'), 10);\n    for (var x = 0; x < this.itemCount_; x++) {\n      var input = this.appendValueInput('ADD' + x);\n      if (x == 0) {\n        input.appendTitle(Blockly.Msg.TEXT_JOIN_TITLE_CREATEWITH);\n      }\n    }\n    if (this.itemCount_ == 0) {\n      this.appendDummyInput('EMPTY')\n          .appendTitle(new Blockly.FieldImage(\n                Blockly.assetUrl('media/quote0.png'), 12, 12))\n          .appendTitle(new Blockly.FieldImage(\n                Blockly.assetUrl('media/quote1.png'), 12, 12));\n    }\n  },\n  decompose: function(blockSpace) {\n    var containerBlock = new Blockly.Block(blockSpace,\n                                           'text_create_join_container');\n    containerBlock.initSvg();\n    var connection = containerBlock.getInput('STACK').connection;\n    for (var x = 0; x < this.itemCount_; x++) {\n      var itemBlock = new Blockly.Block(blockSpace, 'text_create_join_item');\n      itemBlock.initSvg();\n      connection.connect(itemBlock.previousConnection);\n      connection = itemBlock.nextConnection;\n    }\n    return containerBlock;\n  },\n  compose: function(containerBlock) {\n    // Disconnect all input blocks and remove all inputs.\n    if (this.itemCount_ == 0) {\n      this.removeInput('EMPTY');\n    } else {\n      for (var x = this.itemCount_ - 1; x >= 0; x--) {\n        this.removeInput('ADD' + x);\n      }\n    }\n    this.itemCount_ = 0;\n    // Rebuild the block's inputs.\n    var itemBlock = containerBlock.getInputTargetBlock('STACK');\n    while (itemBlock) {\n      var input = this.appendValueInput('ADD' + this.itemCount_);\n      if (this.itemCount_ == 0) {\n        input.appendTitle(Blockly.Msg.TEXT_JOIN_TITLE_CREATEWITH);\n      }\n      // Reconnect any child blocks.\n      if (itemBlock.valueConnection_) {\n        input.connection.connect(itemBlock.valueConnection_);\n      }\n      this.itemCount_++;\n      itemBlock = itemBlock.nextConnection &&\n          itemBlock.nextConnection.targetBlock();\n    }\n    if (this.itemCount_ == 0) {\n      this.appendDummyInput('EMPTY')\n          .appendTitle(new Blockly.FieldImage(\n                Blockly.assetUrl('media/quote0.png'), 12, 12))\n          .appendTitle(new Blockly.FieldImage(\n                Blockly.assetUrl('media/quote1.png'), 12, 12));\n    }\n  },\n  saveConnections: function(containerBlock) {\n    // Store a pointer to any connected child blocks.\n    var itemBlock = containerBlock.getInputTargetBlock('STACK');\n    var x = 0;\n    while (itemBlock) {\n      var input = this.getInput('ADD' + x);\n      itemBlock.valueConnection_ = input && input.connection.targetConnection;\n      x++;\n      itemBlock = itemBlock.nextConnection &&\n          itemBlock.nextConnection.targetBlock();\n    }\n  }\n};\n\nBlockly.Blocks.text_create_join_container = {\n  // Container.\n  init: function() {\n    this.setColour(160);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.TEXT_CREATE_JOIN_TITLE_JOIN);\n    this.appendStatementInput('STACK');\n    this.setTooltip(Blockly.Msg.TEXT_CREATE_JOIN_TOOLTIP);\n    this.contextMenu = false;\n  }\n};\n\nBlockly.Blocks.text_create_join_item = {\n  // Add items.\n  init: function() {\n    this.setColour(160);\n    this.appendDummyInput()\n        .appendTitle(Blockly.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(Blockly.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP);\n    this.contextMenu = false;\n  }\n};\n\nBlockly.Blocks.text_append = {\n  // Append to a variable in place.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.TEXT_APPEND_HELPURL);\n    this.setColour(160);\n    this.appendValueInput('TEXT')\n        .appendTitle(Blockly.Msg.TEXT_APPEND_TO)\n        .appendTitle(new Blockly.FieldVariable(\n        Blockly.Msg.TEXT_APPEND_VARIABLE), 'VAR')\n        .appendTitle(Blockly.Msg.TEXT_APPEND_APPENDTEXT);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      return Blockly.Msg.TEXT_APPEND_TOOLTIP.replace('%1',\n          thisBlock.getTitleValue('VAR'));\n    });\n  },\n  getVars: Blockly.Variables.getVars,\n  renameVar: function(oldName, newName) {\n    if (Blockly.Names.equals(oldName, this.getTitleValue('VAR'))) {\n      this.setTitleValue(newName, 'VAR');\n    }\n  }\n};\n\nBlockly.Blocks.text_length = {\n  // String length.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.TEXT_LENGTH_HELPURL);\n    this.setColour(160);\n    this.interpolateMsg(Blockly.Msg.TEXT_LENGTH_TITLE,\n                        ['VALUE', ['String', 'Array'], Blockly.ALIGN_RIGHT],\n                        Blockly.ALIGN_RIGHT);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.setTooltip(Blockly.Msg.TEXT_LENGTH_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.text_isEmpty = {\n  // Is the string null?\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.TEXT_ISEMPTY_HELPURL);\n    this.setColour(160);\n    this.interpolateMsg(Blockly.Msg.TEXT_ISEMPTY_TITLE,\n                        ['VALUE', ['String', 'Array'], Blockly.ALIGN_RIGHT],\n                        Blockly.ALIGN_RIGHT);\n    this.setOutput(true, Blockly.BlockValueType.BOOLEAN);\n    this.setTooltip(Blockly.Msg.TEXT_ISEMPTY_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.text_indexOf = {\n  // Find a substring in the text.\n  init: function() {\n    var OPERATORS =\n        [[Blockly.Msg.TEXT_INDEXOF_OPERATOR_FIRST, 'FIRST'],\n         [Blockly.Msg.TEXT_INDEXOF_OPERATOR_LAST, 'LAST']];\n    this.setHelpUrl(Blockly.Msg.TEXT_INDEXOF_HELPURL);\n    this.setColour(160);\n    this.setOutput(true, Blockly.BlockValueType.NUMBER);\n    this.appendValueInput('VALUE')\n        .setCheck(Blockly.BlockValueType.STRING)\n        .appendTitle(Blockly.Msg.TEXT_INDEXOF_INPUT_INTEXT);\n    this.appendValueInput('FIND')\n        .setCheck(Blockly.BlockValueType.STRING)\n        .appendTitle(new Blockly.FieldDropdown(OPERATORS), 'END');\n    if (Blockly.Msg.TEXT_INDEXOF_TAIL) {\n      this.appendDummyInput().appendTitle(Blockly.Msg.TEXT_INDEXOF_TAIL);\n    }\n    this.setInputsInline(true);\n    this.setTooltip(Blockly.Msg.TEXT_INDEXOF_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.text_charAt = {\n  // Get a character from the string.\n  init: function() {\n    this.WHERE_OPTIONS =\n        [[Blockly.Msg.TEXT_CHARAT_FROM_START, 'FROM_START'],\n         [Blockly.Msg.TEXT_CHARAT_FROM_END, 'FROM_END'],\n         [Blockly.Msg.TEXT_CHARAT_FIRST, 'FIRST'],\n         [Blockly.Msg.TEXT_CHARAT_LAST, 'LAST'],\n         [Blockly.Msg.TEXT_CHARAT_RANDOM, 'RANDOM']];\n    this.setHelpUrl(Blockly.Msg.TEXT_CHARAT_HELPURL);\n    this.setColour(160);\n    this.setOutput(true, Blockly.BlockValueType.STRING);\n    this.appendValueInput('VALUE')\n        .setCheck(Blockly.BlockValueType.STRING)\n        .appendTitle(Blockly.Msg.TEXT_CHARAT_INPUT_INTEXT);\n    this.appendDummyInput('AT');\n    this.setInputsInline(true);\n    this.updateAt(true);\n    this.setTooltip(Blockly.Msg.TEXT_CHARAT_TOOLTIP);\n  },\n  mutationToDom: function() {\n    // Save whether there is an 'AT' input.\n    var container = document.createElement('mutation');\n    var isAt = this.getInput('AT').type == Blockly.INPUT_VALUE;\n    container.setAttribute('at', isAt);\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    // Restore the 'AT' input.\n    // Note: Until January 2013 this block did not have mutations,\n    // so 'at' defaults to true.\n    var isAt = (xmlElement.getAttribute('at') != 'false');\n    this.updateAt(isAt);\n  },\n  updateAt: function(isAt) {\n    // Create or delete an input for the numeric index.\n    // Destroy old 'AT' and 'ORDINAL' inputs.\n    this.removeInput('AT');\n    this.removeInput('ORDINAL', true);\n    // Create either a value 'AT' input or a dummy input.\n    if (isAt) {\n      this.appendValueInput('AT').setCheck(Blockly.BlockValueType.NUMBER);\n      if (Blockly.Msg.ORDINAL_NUMBER_SUFFIX) {\n        this.appendDummyInput('ORDINAL')\n            .appendTitle(Blockly.Msg.ORDINAL_NUMBER_SUFFIX);\n      }\n    } else {\n      this.appendDummyInput('AT');\n    }\n    if (Blockly.Msg.TEXT_CHARAT_TAIL) {\n      this.removeInput('TAIL', true);\n      this.appendDummyInput('TAIL')\n          .appendTitle(Blockly.Msg.TEXT_CHARAT_TAIL);\n    }\n    var menu = new Blockly.FieldDropdown(this.WHERE_OPTIONS, function(value) {\n      var newAt = (value == 'FROM_START') || (value == 'FROM_END');\n      // The 'isAt' variable is available due to this function being a closure.\n      if (newAt != isAt) {\n        var block = this.sourceBlock_;\n        block.updateAt(newAt);\n        // This menu has been destroyed and replaced.  Update the replacement.\n        block.setTitleValue(value, 'WHERE');\n        return null;\n      }\n      return undefined;\n    });\n    this.getInput('AT').appendTitle(menu, 'WHERE');\n  }\n};\n\nBlockly.Blocks.text_getSubstring = {\n  // Get substring.\n  init: function() {\n    this.WHERE_OPTIONS_1 =\n        [[Blockly.Msg.TEXT_GET_SUBSTRING_START_FROM_START, 'FROM_START'],\n         [Blockly.Msg.TEXT_GET_SUBSTRING_START_FROM_END, 'FROM_END'],\n         [Blockly.Msg.TEXT_GET_SUBSTRING_START_FIRST, 'FIRST']];\n    this.WHERE_OPTIONS_2 =\n        [[Blockly.Msg.TEXT_GET_SUBSTRING_END_FROM_START, 'FROM_START'],\n         [Blockly.Msg.TEXT_GET_SUBSTRING_END_FROM_END, 'FROM_END'],\n         [Blockly.Msg.TEXT_GET_SUBSTRING_END_LAST, 'LAST']];\n    this.setHelpUrl(Blockly.Msg.TEXT_GET_SUBSTRING_HELPURL);\n    this.setColour(160);\n    this.appendValueInput('STRING')\n        .setCheck(Blockly.BlockValueType.STRING)\n        .appendTitle(Blockly.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT);\n    this.appendDummyInput('AT1');\n    this.appendDummyInput('AT2');\n    if (Blockly.Msg.TEXT_GET_SUBSTRING_TAIL) {\n      this.appendDummyInput('TAIL')\n          .appendTitle(Blockly.Msg.TEXT_GET_SUBSTRING_TAIL);\n    }\n    this.setInputsInline(true);\n    this.setOutput(true, Blockly.BlockValueType.STRING);\n    this.updateAt(1, true);\n    this.updateAt(2, true);\n    this.setTooltip(Blockly.Msg.TEXT_GET_SUBSTRING_TOOLTIP);\n  },\n  mutationToDom: function() {\n    // Save whether there are 'AT' inputs.\n    var container = document.createElement('mutation');\n    var isAt1 = this.getInput('AT1').type == Blockly.INPUT_VALUE;\n    container.setAttribute('at1', isAt1);\n    var isAt2 = this.getInput('AT2').type == Blockly.INPUT_VALUE;\n    container.setAttribute('at2', isAt2);\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    // Restore the block shape.\n    var isAt1 = (xmlElement.getAttribute('at1') == 'true');\n    var isAt2 = (xmlElement.getAttribute('at2') == 'true');\n    this.updateAt(1, isAt1);\n    this.updateAt(2, isAt2);\n  },\n  updateAt: function(n, isAt) {\n    // Create or delete an input for the numeric index.\n    // Destroy old 'AT' and 'ORDINAL' inputs.\n    this.removeInput('AT' + n);\n    this.removeInput('ORDINAL' + n, true);\n    // Create either a value 'AT' input or a dummy input.\n    if (isAt) {\n      this.appendValueInput('AT' + n).setCheck(Blockly.BlockValueType.NUMBER);\n      if (Blockly.Msg.ORDINAL_NUMBER_SUFFIX) {\n        this.appendDummyInput('ORDINAL' + n)\n            .appendTitle(Blockly.Msg.ORDINAL_NUMBER_SUFFIX);\n      }\n    } else {\n      this.appendDummyInput('AT' + n);\n    }\n    // Move tail, if present, to end of block.\n    if (n == 2 && Blockly.Msg.TEXT_GET_SUBSTRING_TAIL) {\n      this.removeInput('TAIL', true);\n      this.appendDummyInput('TAIL')\n          .appendTitle(Blockly.Msg.TEXT_GET_SUBSTRING_TAIL);\n    }\n    var menu = new Blockly.FieldDropdown(this['WHERE_OPTIONS_' + n],\n        function(value) {\n      var newAt = (value == 'FROM_START') || (value == 'FROM_END');\n      // The 'isAt' variable is available due to this function being a closure.\n      if (newAt != isAt) {\n        var block = this.sourceBlock_;\n        block.updateAt(n, newAt);\n        // This menu has been destroyed and replaced.  Update the replacement.\n        block.setTitleValue(value, 'WHERE' + n);\n        return null;\n      }\n      return undefined;\n    });\n    this.getInput('AT' + n)\n        .appendTitle(menu, 'WHERE' + n);\n    if (n == 1) {\n      this.moveInputBefore('AT1', 'AT2');\n    }\n  }\n};\n\nBlockly.Blocks.text_changeCase = {\n  // Change capitalization.\n  init: function() {\n    var OPERATORS =\n        [[Blockly.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE, 'UPPERCASE'],\n         [Blockly.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE, 'LOWERCASE'],\n         [Blockly.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE, 'TITLECASE']];\n    this.setHelpUrl(Blockly.Msg.TEXT_CHANGECASE_HELPURL);\n    this.setColour(160);\n    this.appendValueInput('TEXT')\n        .setCheck(Blockly.BlockValueType.STRING)\n        .appendTitle(new Blockly.FieldDropdown(OPERATORS), 'CASE');\n    this.setOutput(true, Blockly.BlockValueType.STRING);\n    this.setTooltip(Blockly.Msg.TEXT_CHANGECASE_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.text_trim = {\n  // Trim spaces.\n  init: function() {\n    var OPERATORS =\n        [[Blockly.Msg.TEXT_TRIM_OPERATOR_BOTH, 'BOTH'],\n         [Blockly.Msg.TEXT_TRIM_OPERATOR_LEFT, 'LEFT'],\n         [Blockly.Msg.TEXT_TRIM_OPERATOR_RIGHT, 'RIGHT']];\n    this.setHelpUrl(Blockly.Msg.TEXT_TRIM_HELPURL);\n    this.setColour(160);\n    this.appendValueInput('TEXT')\n        .setCheck(Blockly.BlockValueType.STRING)\n        .appendTitle(new Blockly.FieldDropdown(OPERATORS), 'MODE');\n    this.setOutput(true, Blockly.BlockValueType.STRING);\n    this.setTooltip(Blockly.Msg.TEXT_TRIM_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.text_print = {\n  // Print statement.\n  init: function() {\n    this.setHelpUrl(Blockly.Msg.TEXT_PRINT_HELPURL);\n    this.setColour(160);\n    this.interpolateMsg(Blockly.Msg.TEXT_PRINT_TITLE,\n                        ['TEXT', null, Blockly.ALIGN_RIGHT],\n                        Blockly.ALIGN_RIGHT);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(Blockly.Msg.TEXT_PRINT_TOOLTIP);\n  }\n};\n\nBlockly.Blocks.text_prompt = {\n  // Prompt function.\n  init: function() {\n    var TYPES =\n        [[Blockly.Msg.TEXT_PROMPT_TYPE_TEXT, 'TEXT'],\n         [Blockly.Msg.TEXT_PROMPT_TYPE_NUMBER, 'NUMBER']];\n    // Assign 'this' to a variable for use in the closure below.\n    var thisBlock = this;\n    this.setHelpUrl(Blockly.Msg.TEXT_PROMPT_HELPURL);\n    this.setColour(160);\n    var dropdown = new Blockly.FieldDropdown(TYPES, function(newOp) {\n      if (newOp == 'NUMBER') {\n        thisBlock.outputConnection.setCheck(Blockly.BlockValueType.NUMBER);\n      } else {\n        thisBlock.outputConnection.setCheck(Blockly.BlockValueType.STRING);\n      }\n    });\n    this.appendDummyInput()\n        .appendTitle(dropdown, 'TYPE')\n        .appendTitle(new Blockly.FieldImage(\n              Blockly.assetUrl('media/quote0.png'), 12, 12))\n        .appendTitle(new Blockly.FieldTextInput(''), 'TEXT')\n        .appendTitle(new Blockly.FieldImage(\n              Blockly.assetUrl('media/quote1.png'), 12, 12));\n    this.setOutput(true, Blockly.BlockValueType.STRING);\n    // Assign 'this' to a variable for use in the tooltip closure below.\n    var thisBlock = this;\n    this.setTooltip(function() {\n      return (thisBlock.getTitleValue('TYPE') == 'TEXT') ?\n          Blockly.Msg.TEXT_PROMPT_TOOLTIP_TEXT :\n          Blockly.Msg.TEXT_PROMPT_TOOLTIP_NUMBER;\n    });\n  }\n};\n","'use strict';\n\ngoog.provide('Blockly.Blocks.unknown');\n\ngoog.require('Blockly.Blocks');\n\nBlockly.Blocks.unknown = {\n  unknownBlock: true,\n  init: function() {\n    this.setHSV(0, 0, 0.8);\n  }\n};\n","/**\n * Visual Blocks Language\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Helper functions for generating JavaScript for blocks.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.JavaScript');\n\ngoog.require('Blockly.Generator');\ngoog.require('Blockly.CodeGenerator');\n\n\nBlockly.JavaScript = Blockly.Generator.get('JavaScript');\n\n/**\n * List of illegal variable names.\n * This is not intended to be a security feature.  Blockly is 100% client-side,\n * so bypassing this list is trivial.  This is intended to prevent users from\n * accidentally clobbering a built-in object or function.\n * @private\n */\nBlockly.JavaScript.addReservedWords(\n    'Blockly,' +  // In case JS is evaled in the current window.\n    // https://developer.mozilla.org/en/JavaScript/Reference/Reserved_Words\n    'break,case,catch,continue,debugger,default,delete,do,else,finally,for,function,if,in,instanceof,new,return,switch,this,throw,try,typeof,var,void,while,with,' +\n    'class,enum,export,extends,import,super,implements,interface,let,package,private,protected,public,static,yield,' +\n    'const,null,true,false,' +\n    // https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects\n    'Array,ArrayBuffer,Boolean,Date,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Error,eval,EvalError,Float32Array,Float64Array,Function,Infinity,Int16Array,Int32Array,Int8Array,isFinite,isNaN,Iterator,JSON,Math,NaN,Number,Object,parseFloat,parseInt,RangeError,ReferenceError,RegExp,StopIteration,String,SyntaxError,TypeError,Uint16Array,Uint32Array,Uint8Array,Uint8ClampedArray,undefined,uneval,URIError,' +\n    // https://developer.mozilla.org/en/DOM/window\n    'applicationCache,closed,Components,content,_content,controllers,crypto,defaultStatus,dialogArguments,directories,document,frameElement,frames,fullScreen,globalStorage,history,innerHeight,innerWidth,length,location,locationbar,localStorage,menubar,messageManager,mozAnimationStartTime,mozInnerScreenX,mozInnerScreenY,mozPaintCount,name,navigator,opener,outerHeight,outerWidth,pageXOffset,pageYOffset,parent,performance,personalbar,pkcs11,returnValue,screen,screenX,screenY,scrollbars,scrollMaxX,scrollMaxY,scrollX,scrollY,self,sessionStorage,sidebar,status,statusbar,toolbar,top,URL,window,' +\n    'addEventListener,alert,atob,back,blur,btoa,captureEvents,clearImmediate,clearInterval,clearTimeout,close,confirm,disableExternalCapture,dispatchEvent,dump,enableExternalCapture,escape,find,focus,forward,GeckoActiveXObject,getAttention,getAttentionWithCycleCount,getComputedStyle,getSelection,home,matchMedia,maximize,minimize,moveBy,moveTo,mozRequestAnimationFrame,open,openDialog,postMessage,print,prompt,QueryInterface,releaseEvents,removeEventListener,resizeBy,resizeTo,restore,routeEvent,scroll,scrollBy,scrollByLines,scrollByPages,scrollTo,setCursor,setImmediate,setInterval,setResizable,setTimeout,showModalDialog,sizeToContent,stop,unescape,updateCommands,XPCNativeWrapper,XPCSafeJSObjectWrapper,' +\n    'onabort,onbeforeunload,onblur,onchange,onclick,onclose,oncontextmenu,ondevicemotion,ondeviceorientation,ondragdrop,onerror,onfocus,onhashchange,onkeydown,onkeypress,onkeyup,onload,onmousedown,onmousemove,onmouseout,onmouseover,onmouseup,onmozbeforepaint,onpaint,onpopstate,onreset,onresize,onscroll,onselect,onsubmit,onunload,onpageshow,onpagehide,' +\n    'Image,Option,Worker,' +\n    // https://developer.mozilla.org/en/Gecko_DOM_Reference\n    'Event,Range,File,FileReader,Blob,BlobBuilder,' +\n    'Attr,CDATASection,CharacterData,Comment,console,DocumentFragment,DocumentType,DomConfiguration,DOMError,DOMErrorHandler,DOMException,DOMImplementation,DOMImplementationList,DOMImplementationRegistry,DOMImplementationSource,DOMLocator,DOMObject,DOMString,DOMStringList,DOMTimeStamp,DOMUserData,Entity,EntityReference,MediaQueryList,MediaQueryListListener,NameList,NamedNodeMap,Node,NodeFilter,NodeIterator,NodeList,Notation,Plugin,PluginArray,ProcessingInstruction,SharedWorker,Text,TimeRanges,Treewalker,TypeInfo,UserDataHandler,Worker,WorkerGlobalScope,' +\n    'HTMLDocument,HTMLElement,HTMLAnchorElement,HTMLAppletElement,HTMLAudioElement,HTMLAreaElement,HTMLBaseElement,HTMLBaseFontElement,HTMLBodyElement,HTMLBRElement,HTMLButtonElement,HTMLCanvasElement,HTMLDirectoryElement,HTMLDivElement,HTMLDListElement,HTMLEmbedElement,HTMLFieldSetElement,HTMLFontElement,HTMLFormElement,HTMLFrameElement,HTMLFrameSetElement,HTMLHeadElement,HTMLHeadingElement,HTMLHtmlElement,HTMLHRElement,HTMLIFrameElement,HTMLImageElement,HTMLInputElement,HTMLKeygenElement,HTMLLabelElement,HTMLLIElement,HTMLLinkElement,HTMLMapElement,HTMLMenuElement,HTMLMetaElement,HTMLModElement,HTMLObjectElement,HTMLOListElement,HTMLOptGroupElement,HTMLOptionElement,HTMLOutputElement,HTMLParagraphElement,HTMLParamElement,HTMLPreElement,HTMLQuoteElement,HTMLScriptElement,HTMLSelectElement,HTMLSourceElement,HTMLSpanElement,HTMLStyleElement,HTMLTableElement,HTMLTableCaptionElement,HTMLTableCellElement,HTMLTableDataCellElement,HTMLTableHeaderCellElement,HTMLTableColElement,HTMLTableRowElement,HTMLTableSectionElement,HTMLTextAreaElement,HTMLTimeElement,HTMLTitleElement,HTMLTrackElement,HTMLUListElement,HTMLUnknownElement,HTMLVideoElement,' +\n    'HTMLCanvasElement,CanvasRenderingContext2D,CanvasGradient,CanvasPattern,TextMetrics,ImageData,CanvasPixelArray,HTMLAudioElement,HTMLVideoElement,NotifyAudioAvailableEvent,HTMLCollection,HTMLAllCollection,HTMLFormControlsCollection,HTMLOptionsCollection,HTMLPropertiesCollection,DOMTokenList,DOMSettableTokenList,DOMStringMap,RadioNodeList,' +\n    'SVGDocument,SVGElement,SVGAElement,SVGAltGlyphElement,SVGAltGlyphDefElement,SVGAltGlyphItemElement,SVGAnimationElement,SVGAnimateElement,SVGAnimateColorElement,SVGAnimateMotionElement,SVGAnimateTransformElement,SVGSetElement,SVGCircleElement,SVGClipPathElement,SVGColorProfileElement,SVGCursorElement,SVGDefsElement,SVGDescElement,SVGEllipseElement,SVGFilterElement,SVGFilterPrimitiveStandardAttributes,SVGFEBlendElement,SVGFEColorMatrixElement,SVGFEComponentTransferElement,SVGFECompositeElement,SVGFEConvolveMatrixElement,SVGFEDiffuseLightingElement,SVGFEDisplacementMapElement,SVGFEDistantLightElement,SVGFEFloodElement,SVGFEGaussianBlurElement,SVGFEImageElement,SVGFEMergeElement,SVGFEMergeNodeElement,SVGFEMorphologyElement,SVGFEOffsetElement,SVGFEPointLightElement,SVGFESpecularLightingElement,SVGFESpotLightElement,SVGFETileElement,SVGFETurbulenceElement,SVGComponentTransferFunctionElement,SVGFEFuncRElement,SVGFEFuncGElement,SVGFEFuncBElement,SVGFEFuncAElement,SVGFontElement,SVGFontFaceElement,SVGFontFaceFormatElement,SVGFontFaceNameElement,SVGFontFaceSrcElement,SVGFontFaceUriElement,SVGForeignObjectElement,SVGGElement,SVGGlyphElement,SVGGlyphRefElement,SVGGradientElement,SVGLinearGradientElement,SVGRadialGradientElement,SVGHKernElement,SVGImageElement,SVGLineElement,SVGMarkerElement,SVGMaskElement,SVGMetadataElement,SVGMissingGlyphElement,SVGMPathElement,SVGPathElement,SVGPatternElement,SVGPolylineElement,SVGPolygonElement,SVGRectElement,SVGScriptElement,SVGStopElement,SVGStyleElement,SVGSVGElement,SVGSwitchElement,SVGSymbolElement,SVGTextElement,SVGTextPathElement,SVGTitleElement,SVGTRefElement,SVGTSpanElement,SVGUseElement,SVGViewElement,SVGVKernElement,' +\n    'SVGAngle,SVGColor,SVGICCColor,SVGElementInstance,SVGElementInstanceList,SVGLength,SVGLengthList,SVGMatrix,SVGNumber,SVGNumberList,SVGPaint,SVGPoint,SVGPointList,SVGPreserveAspectRatio,SVGRect,SVGStringList,SVGTransform,SVGTransformList,' +\n    'SVGAnimatedAngle,SVGAnimatedBoolean,SVGAnimatedEnumeration,SVGAnimatedInteger,SVGAnimatedLength,SVGAnimatedLengthList,SVGAnimatedNumber,SVGAnimatedNumberList,SVGAnimatedPreserveAspectRatio,SVGAnimatedRect,SVGAnimatedString,SVGAnimatedTransformList,' +\n    'SVGPathSegList,SVGPathSeg,SVGPathSegArcAbs,SVGPathSegArcRel,SVGPathSegClosePath,SVGPathSegCurvetoCubicAbs,SVGPathSegCurvetoCubicRel,SVGPathSegCurvetoCubicSmoothAbs,SVGPathSegCurvetoCubicSmoothRel,SVGPathSegCurvetoQuadraticAbs,SVGPathSegCurvetoQuadraticRel,SVGPathSegCurvetoQuadraticSmoothAbs,SVGPathSegCurvetoQuadraticSmoothRel,SVGPathSegLinetoAbs,SVGPathSegLinetoHorizontalAbs,SVGPathSegLinetoHorizontalRel,SVGPathSegLinetoRel,SVGPathSegLinetoVerticalAbs,SVGPathSegLinetoVerticalRel,SVGPathSegMovetoAbs,SVGPathSegMovetoRel,ElementTimeControl,TimeEvent,SVGAnimatedPathData,' +\n    'SVGAnimatedPoints,SVGColorProfileRule,SVGCSSRule,SVGExternalResourcesRequired,SVGFitToViewBox,SVGLangSpace,SVGLocatable,SVGRenderingIntent,SVGStylable,SVGTests,SVGTextContentElement,SVGTextPositioningElement,SVGTransformable,SVGUnitTypes,SVGURIReference,SVGViewSpec,SVGZoomAndPan');\n\n/**\n * Order of operation ENUMs.\n * https://developer.mozilla.org/en/JavaScript/Reference/Operators/Operator_Precedence\n */\nBlockly.JavaScript.ORDER_ATOMIC = 0;         // 0 \"\" ...\nBlockly.JavaScript.ORDER_MEMBER = 1;         // . []\nBlockly.JavaScript.ORDER_NEW = 1;            // new\nBlockly.JavaScript.ORDER_FUNCTION_CALL = 2;  // ()\nBlockly.JavaScript.ORDER_INCREMENT = 3;      // ++\nBlockly.JavaScript.ORDER_DECREMENT = 3;      // --\nBlockly.JavaScript.ORDER_LOGICAL_NOT = 4;    // !\nBlockly.JavaScript.ORDER_BITWISE_NOT = 4;    // ~\nBlockly.JavaScript.ORDER_UNARY_PLUS = 4;     // +\nBlockly.JavaScript.ORDER_UNARY_NEGATION = 4; // -\nBlockly.JavaScript.ORDER_TYPEOF = 4;         // typeof\nBlockly.JavaScript.ORDER_VOID = 4;           // void\nBlockly.JavaScript.ORDER_DELETE = 4;         // delete\nBlockly.JavaScript.ORDER_MULTIPLICATION = 5; // *\nBlockly.JavaScript.ORDER_DIVISION = 5;       // /\nBlockly.JavaScript.ORDER_MODULUS = 5;        // %\nBlockly.JavaScript.ORDER_ADDITION = 6;       // +\nBlockly.JavaScript.ORDER_SUBTRACTION = 6;    // -\nBlockly.JavaScript.ORDER_BITWISE_SHIFT = 7;  // << >> >>>\nBlockly.JavaScript.ORDER_RELATIONAL = 8;     // < <= > >=\nBlockly.JavaScript.ORDER_IN = 8;             // in\nBlockly.JavaScript.ORDER_INSTANCEOF = 8;     // instanceof\nBlockly.JavaScript.ORDER_EQUALITY = 9;       // == != === !==\nBlockly.JavaScript.ORDER_BITWISE_AND = 10;   // &\nBlockly.JavaScript.ORDER_BITWISE_XOR = 11;   // ^\nBlockly.JavaScript.ORDER_BITWISE_OR = 12;    // |\nBlockly.JavaScript.ORDER_LOGICAL_AND = 13;   // &&\nBlockly.JavaScript.ORDER_LOGICAL_OR = 14;    // ||\nBlockly.JavaScript.ORDER_CONDITIONAL = 15;   // ?:\nBlockly.JavaScript.ORDER_ASSIGNMENT = 16;    // = += -= *= /= %= <<= >>= ...\nBlockly.JavaScript.ORDER_COMMA = 17;         // ,\nBlockly.JavaScript.ORDER_NONE = 99;          // (...)\n\n/**\n * Arbitrary code to inject into locations that risk causing infinite loops.\n * Any instances of '%1' will be replaced by the block ID that failed.\n * E.g. '  checkTimeout(%1);\\n'\n * @type ?string\n */\nBlockly.JavaScript.INFINITE_LOOP_TRAP = null;\n\n/**\n * Initialise the database of variable names.\n * @param {Array.<Blockly.Block>=} opt_blocks Optional blocks to query for\n *    variable definitions.\n */\nBlockly.JavaScript.init = function(opt_blocks) {\n  // Create a dictionary of definitions to be printed before the code.\n  Blockly.JavaScript.definitions_ = {};\n\n  if (Blockly.Variables) {\n    if (!Blockly.JavaScript.variableDB_) {\n      Blockly.JavaScript.variableDB_ =\n          new Blockly.Names(Blockly.JavaScript.RESERVED_WORDS_);\n    } else {\n      Blockly.JavaScript.variableDB_.reset();\n    }\n\n    if (!Blockly.varsInGlobals) {\n      var defvars = [];\n      var variables = Blockly.Variables.allVariables(opt_blocks);\n\n      for (var x = 0; x < variables.length; x++) {\n        defvars[x] = 'var ' +\n            Blockly.JavaScript.variableDB_.getName(variables[x],\n            Blockly.Variables.NAME_TYPE) + ';';\n      }\n      Blockly.JavaScript.definitions_['variables'] = defvars.join('\\n');\n    }\n  }\n};\n\n/**\n * Prepend the generated code with the variable definitions.\n * @param {string} code Generated code.\n * @return {string} Completed code.\n */\nBlockly.JavaScript.finish = function(code) {\n  // Convert the definitions dictionary into a list.\n  var definitions = [];\n  for (var name in Blockly.JavaScript.definitions_) {\n    definitions.push(Blockly.JavaScript.definitions_[name]);\n  }\n  return definitions.join('\\n\\n') + '\\n\\n\\n' + code;\n};\n\n/**\n * Naked values are top-level blocks with outputs that aren't plugged into\n * anything.  A trailing semicolon is needed to make this legal.\n * @param {string} line Line of generated code.\n * @return {string} Legal line of code.\n */\nBlockly.JavaScript.scrubNakedValue = function(line) {\n  return line + ';\\n';\n};\n\n/**\n * Encode a string as a properly escaped JavaScript string, complete with\n * quotes.\n * @param {string} string Text to encode.\n * @return {string} JavaScript string.\n * @private\n */\nBlockly.JavaScript.quote_ = function(string) {\n  // TODO: This is a quick hack.  Replace with goog.string.quote\n  string = string.replace(/\\\\/g, '\\\\\\\\')\n                 .replace(/\\n/g, '\\\\\\n')\n                 .replace(/'/g, '\\\\\\'');\n  return '\\'' + string + '\\'';\n};\n\n/**\n * Translate a Blockly entity name into a JavaScript variable name.\n * @param {string} name Blockly entity name.\n * @return {string} name to be used in JavaScript code.\n */\nBlockly.JavaScript.translateVarName = function(name) {\n  var v = Blockly.JavaScript.variableDB_.getName(name,\n                                                 Blockly.Variables.NAME_TYPE);\n  if (Blockly.varsInGlobals) {\n    var isLocal = Blockly.JavaScript.variableDB_.checkSpecificType(\n                      name,\n                      Blockly.Variables.NAME_TYPE,\n                      Blockly.Variables.NAME_TYPE_LOCAL);\n    return isLocal ? v : ('Globals.' + v);\n  } else {\n    return v;\n  }\n};\n\n/**\n * Common tasks for generating JavaScript from blocks.\n * Calls any statements following this block.\n * @param {!Blockly.Block} block The current block.\n * @param {string} code The JavaScript code created for this block.\n * @param {boolean} opt_showHidden Whether or not to show non-user visible\n *     blocks, defaults to true.\n * @return {string} JavaScript code with subsequent blocks added.\n * @this {Blockly.CodeGenerator}\n * @private\n */\nBlockly.JavaScript.scrub_ = function(block, code, opt_showHidden) {\n  if (code === null) {\n    // Block has handled code generation itself.\n    return '';\n  }\n  var nextBlock = !block.skipNextBlockGeneration && block.nextConnection &&\n      block.nextConnection.targetBlock();\n  var nextCode = this.blockToCode(nextBlock, opt_showHidden);\n  return code + nextCode;\n};\n","/**\n * Visual Blocks Language\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Generating JavaScript for colour blocks.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.JavaScript.colour');\n\ngoog.require('Blockly.JavaScript');\n\n\nBlockly.JavaScript.colour_picker = function() {\n  // Colour picker.\n  var code = '\\'' + this.getTitleValue('COLOUR') + '\\'';\n  return [code, Blockly.JavaScript.ORDER_ATOMIC];\n};\n\nBlockly.JavaScript.colour_random = function() {\n  // Generate a random colour.\n  if (!Blockly.JavaScript.definitions_['colour_random']) {\n    var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n        'colour_random', Blockly.Generator.NAME_TYPE);\n    Blockly.JavaScript.colour_random.functionName = functionName;\n    var func = [];\n    func.push('function ' + functionName + '() {');\n    func.push('  var num = Math.floor(Math.random() * Math.pow(2, 24));');\n    func.push('  return \\'#\\' + (\\'00000\\' + num.toString(16)).substr(-6);');\n    func.push('}');\n    Blockly.JavaScript.definitions_['colour_random'] = func.join('\\n');\n  }\n  var code = Blockly.JavaScript.colour_random.functionName + '()';\n  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n\nBlockly.JavaScript.colour_rgb = function() {\n  // Compose a colour from RGB components expressed as percentages.\n  var red = Blockly.JavaScript.valueToCode(this, 'RED',\n      Blockly.JavaScript.ORDER_COMMA) || 0;\n  var green = Blockly.JavaScript.valueToCode(this, 'GREEN',\n      Blockly.JavaScript.ORDER_COMMA) || 0;\n  var blue = Blockly.JavaScript.valueToCode(this, 'BLUE',\n      Blockly.JavaScript.ORDER_COMMA) || 0;\n\n  if (!Blockly.JavaScript.definitions_['colour_rgb']) {\n    var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n        'colour_rgb', Blockly.Generator.NAME_TYPE);\n    Blockly.JavaScript.colour_rgb.functionName = functionName;\n    var func = [];\n    func.push('function ' + functionName + '(r, g, b) {');\n    func.push('  r = Math.round(Math.max(Math.min(Number(r), 255), 0));');\n    func.push('  g = Math.round(Math.max(Math.min(Number(g), 255), 0));');\n    func.push('  b = Math.round(Math.max(Math.min(Number(b), 255), 0));');\n    func.push('  r = (\\'0\\' + (r || 0).toString(16)).slice(-2);');\n    func.push('  g = (\\'0\\' + (g || 0).toString(16)).slice(-2);');\n    func.push('  b = (\\'0\\' + (b || 0).toString(16)).slice(-2);');\n    func.push('  return \\'#\\' + r + g + b;');\n    func.push('}');\n    Blockly.JavaScript.definitions_['colour_rgb'] = func.join('\\n');\n  }\n  var code = Blockly.JavaScript.colour_rgb.functionName +\n      '(' + red + ', ' + green + ', ' + blue + ')';\n  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n\nBlockly.JavaScript.colour_blend = function() {\n  // Blend two colours together.\n  var c1 = Blockly.JavaScript.valueToCode(this, 'COLOUR1',\n      Blockly.JavaScript.ORDER_COMMA) || '\\'#000000\\'';\n  var c2 = Blockly.JavaScript.valueToCode(this, 'COLOUR2',\n      Blockly.JavaScript.ORDER_COMMA) || '\\'#000000\\'';\n  var ratio = Blockly.JavaScript.valueToCode(this, 'RATIO',\n      Blockly.JavaScript.ORDER_COMMA) || 0.5;\n\n  if (!Blockly.JavaScript.definitions_['colour_blend']) {\n    var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n        'colour_blend', Blockly.Generator.NAME_TYPE);\n    Blockly.JavaScript.colour_blend.functionName = functionName;\n    var func = [];\n    func.push('function ' + functionName + '(c1, c2, ratio) {');\n    func.push('  ratio = Math.max(Math.min(Number(ratio), 1), 0);');\n    func.push('  var r1 = parseInt(c1.substring(1, 3), 16);');\n    func.push('  var g1 = parseInt(c1.substring(3, 5), 16);');\n    func.push('  var b1 = parseInt(c1.substring(5, 7), 16);');\n    func.push('  var r2 = parseInt(c2.substring(1, 3), 16);');\n    func.push('  var g2 = parseInt(c2.substring(3, 5), 16);');\n    func.push('  var b2 = parseInt(c2.substring(5, 7), 16);');\n    func.push('  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);');\n    func.push('  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);');\n    func.push('  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);');\n    func.push('  r = (\\'0\\' + (r || 0).toString(16)).slice(-2);');\n    func.push('  g = (\\'0\\' + (g || 0).toString(16)).slice(-2);');\n    func.push('  b = (\\'0\\' + (b || 0).toString(16)).slice(-2);');\n    func.push('  return \\'#\\' + r + g + b;');\n    func.push('}');\n    Blockly.JavaScript.definitions_['colour_blend'] = func.join('\\n');\n  }\n  var code = Blockly.JavaScript.colour_blend.functionName +\n      '(' + c1 + ', ' + c2 + ', ' + ratio + ')';\n  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n","/**\n * Visual Blocks Language\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Generating JavaScript for procedure blocks.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.JavaScript.functionalExamples');\n\ngoog.require('Blockly.JavaScript');\n\n/**\n * Generates javascript for a functional example\n * with expected and actual code blocks\n */\nBlockly.JavaScript.functional_example = function() {\n  var expectedValue = Blockly.JavaScript.statementToCode(this, 'EXPECTED', Blockly.JavaScript.ORDER_NONE) || 'null';\n  var actualValue = Blockly.JavaScript.statementToCode(this, 'ACTUAL', Blockly.JavaScript.ORDER_NONE) || 'null';\n  return ['(' + expectedValue + \" == \" + actualValue + ')', 0];\n};\n","/**\n * Visual Blocks Language\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Generating JavaScript for variable blocks.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.JavaScript.functionalParameters');\n\ngoog.require('Blockly.JavaScript');\n\nBlockly.JavaScript.functional_parameters_get = function() {\n  return Blockly.JavaScript.translateVarName(this.getTitleValue('VAR'));\n};\n","/**\n * Visual Blocks Language\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Generating JavaScript for procedure blocks.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.JavaScript.functionalProcedures');\n\ngoog.require('Blockly.JavaScript');\n\n\nBlockly.JavaScript.functional_definition = function() {\n  // Define a functional procedure with a return value.\n  var funcName = Blockly.JavaScript.variableDB_.getName(\n      this.getTitleValue('NAME'), Blockly.Procedures.NAME_TYPE);\n  // Store names for each of the args\n  // NOTE: It is important to do this first so the first call to getName()\n  // for each arg includes the specific type of NAME_TYPE_LOCAL (local var)\n  var args = [];\n  for (var x = 0; x < this.parameterNames_.length; x++) {\n    args[x] = Blockly.JavaScript.variableDB_.getName(this.parameterNames_[x],\n        Blockly.Variables.NAME_TYPE,\n        Blockly.Variables.NAME_TYPE_LOCAL);\n  }\n  var branch = '';\n\n  if (Blockly.JavaScript.INFINITE_LOOP_TRAP) {\n    branch = Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,\n        '\\'' + this.id + '\\'') + branch;\n  }\n  var returnValue = Blockly.JavaScript.statementToCode(this, 'STACK',\n      Blockly.JavaScript.ORDER_NONE) || '';\n  if (returnValue) {\n    returnValue = '  return ' + returnValue + ';\\n';\n  }\n  var code = (Blockly.varsInGlobals ?\n                'Globals.' + funcName + ' = function' :\n                'function ' + funcName) +\n             '(' + args.join(', ') + ') {\\n' + branch + returnValue + '\\n}';\n  code = Blockly.JavaScript.scrub_(this, code);\n  Blockly.JavaScript.definitions_[funcName] = code;\n  return null;\n};\n\nBlockly.JavaScript.functional_call = function() {\n  // Call a functional procedure with a return value.\n  var funcName = Blockly.JavaScript.variableDB_.getName(\n      this.getTitleValue('NAME'), Blockly.Procedures.NAME_TYPE);\n  var args = [];\n  for (var x = 0; x < this.currentParameterNames_.length; x++) {\n    args[x] = Blockly.JavaScript.statementToCode(this, 'ARG' + x,\n        Blockly.JavaScript.ORDER_COMMA) || 'null';\n  }\n  var code = (Blockly.varsInGlobals ? 'Globals.' : '') +\n              funcName + '(' + args.join(', ') + ')';\n  return code;\n};\n\nBlockly.JavaScript.functional_pass = function() {\n  // Pass a functional procedure\n  var funcName = Blockly.JavaScript.variableDB_.getName(\n      this.getTitleValue('NAME'), Blockly.Procedures.NAME_TYPE);\n  var code = (Blockly.varsInGlobals ? 'Globals.' : '') + funcName;\n  return code;\n};\n\nBlockly.JavaScript.procedural_to_functional_call = function() {\n  // Call a functional procedure with a return value.\n  var funcName = Blockly.JavaScript.variableDB_.getName(\n      this.getTitleValue('NAME'), Blockly.Procedures.NAME_TYPE);\n  var args = [];\n  for (var x = 0; x < this.currentParameterNames_.length; x++) {\n    var value = Blockly.JavaScript.valueToCode(this, 'ARG' + x,\n        Blockly.JavaScript.ORDER_COMMA);\n    args[x] = value || 'null';\n  }\n  var code = (Blockly.varsInGlobals ? 'Globals.' : '') +\n              funcName + '(' + args.join(', ') + ')';\n  // convert functional output to procedural output.\n  return [code, Blockly.JavaScript.ORDER_NONE];\n};\n","/**\n * Visual Blocks Language\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Generating JavaScript for list blocks.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.JavaScript.lists');\n\ngoog.require('Blockly.JavaScript');\n\n\nBlockly.JavaScript.lists_create_empty = function() {\n  // Create an empty list.\n  return ['[]', Blockly.JavaScript.ORDER_ATOMIC];\n};\n\nBlockly.JavaScript.lists_create_with = function() {\n  // Create a list with any number of elements of any type.\n  var code = new Array(this.itemCount_);\n  for (var n = 0; n < this.itemCount_; n++) {\n    code[n] = Blockly.JavaScript.valueToCode(this, 'ADD' + n,\n        Blockly.JavaScript.ORDER_COMMA) || 'null';\n  }\n  code = '[' + code.join(', ') + ']';\n  return [code, Blockly.JavaScript.ORDER_ATOMIC];\n};\n\nBlockly.JavaScript.lists_repeat = function() {\n  // Create a list with one element repeated.\n  if (!Blockly.JavaScript.definitions_['lists_repeat']) {\n    // Function copied from Closure's goog.array.repeat.\n    var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n        'lists_repeat', Blockly.Generator.NAME_TYPE);\n    Blockly.JavaScript.lists_repeat.repeat = functionName;\n    var func = [];\n    func.push('function ' + functionName + '(value, n) {');\n    func.push('  var array = [];');\n    func.push('  for (var i = 0; i < n; i++) {');\n    func.push('    array[i] = value;');\n    func.push('  }');\n    func.push('  return array;');\n    func.push('}');\n    Blockly.JavaScript.definitions_['lists_repeat'] = func.join('\\n');\n  }\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'ITEM',\n      Blockly.JavaScript.ORDER_COMMA) || 'null';\n  var argument1 = Blockly.JavaScript.valueToCode(this, 'NUM',\n      Blockly.JavaScript.ORDER_COMMA) || '0';\n  var code = Blockly.JavaScript.lists_repeat.repeat +\n      '(' + argument0 + ', ' + argument1 + ')';\n  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n\nBlockly.JavaScript.lists_length = function() {\n  // List length.\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'VALUE',\n      Blockly.JavaScript.ORDER_FUNCTION_CALL) || '\\'\\'';\n  return [argument0 + '.length', Blockly.JavaScript.ORDER_MEMBER];\n};\n\nBlockly.JavaScript.lists_isEmpty = function() {\n  // Is the list empty?\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'VALUE',\n      Blockly.JavaScript.ORDER_MEMBER) || '[]';\n  return ['!' + argument0 + '.length', Blockly.JavaScript.ORDER_LOGICAL_NOT];\n};\n\nBlockly.JavaScript.lists_indexOf = function() {\n  // Find an item in the list.\n  var operator = this.getTitleValue('END') == 'FIRST' ?\n      'indexOf' : 'lastIndexOf';\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'FIND',\n      Blockly.JavaScript.ORDER_NONE) || '\\'\\'';\n  var argument1 = Blockly.JavaScript.valueToCode(this, 'VALUE',\n      Blockly.JavaScript.ORDER_MEMBER) || '[]';\n  var code = argument1 + '.' + operator + '(' + argument0 + ') + 1';\n  return [code, Blockly.JavaScript.ORDER_MEMBER];\n};\n\nBlockly.JavaScript.lists_getIndex = function() {\n  // Get element at index.\n  // Note: Until January 2013 this block did not have MODE or WHERE inputs.\n  var mode = this.getTitleValue('MODE') || 'GET';\n  var where = this.getTitleValue('WHERE') || 'FROM_START';\n  var at = Blockly.JavaScript.valueToCode(this, 'AT',\n      Blockly.JavaScript.ORDER_UNARY_NEGATION) || '1';\n  var list = Blockly.JavaScript.valueToCode(this, 'VALUE',\n      Blockly.JavaScript.ORDER_MEMBER) || '[]';\n\n  if (where == 'FIRST') {\n    if (mode == 'GET') {\n      var code = list + '[0]';\n      return [code, Blockly.JavaScript.ORDER_MEMBER];\n    } else if (mode == 'GET_REMOVE') {\n      var code = list + '.shift()';\n      return [code, Blockly.JavaScript.ORDER_MEMBER];\n    } else if (mode == 'REMOVE') {\n      return list + '.shift();\\n';\n    }\n  } else if (where == 'LAST') {\n    if (mode == 'GET') {\n      var code = list + '.slice(-1)[0]';\n      return [code, Blockly.JavaScript.ORDER_MEMBER];\n    } else if (mode == 'GET_REMOVE') {\n      var code = list + '.pop()';\n      return [code, Blockly.JavaScript.ORDER_MEMBER];\n    } else if (mode == 'REMOVE') {\n      return list + '.pop();\\n';\n    }\n  } else if (where == 'FROM_START') {\n    // Blockly uses one-based indicies.\n    if (Blockly.isNumber(at)) {\n      // If the index is a naked number, decrement it right now.\n      at = parseFloat(at) - 1;\n    } else {\n      // If the index is dynamic, decrement it in code.\n      at += ' - 1';\n    }\n    if (mode == 'GET') {\n      var code = list + '[' + at + ']';\n      return [code, Blockly.JavaScript.ORDER_MEMBER];\n    } else if (mode == 'GET_REMOVE') {\n      var code = list + '.splice(' + at + ', 1)[0]';\n      return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n    } else if (mode == 'REMOVE') {\n      return list + '.splice(' + at + ', 1);\\n';\n    }\n  } else if (where == 'FROM_END') {\n    if (mode == 'GET') {\n      var code = list + '.slice(-' + at + ')[0]';\n      return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n    } else if (mode == 'GET_REMOVE' || mode == 'REMOVE') {\n      if (!Blockly.JavaScript.definitions_['lists_remove_from_end']) {\n        var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n            'lists_remove_from_end', Blockly.Generator.NAME_TYPE);\n        Blockly.JavaScript.lists_getIndex.lists_remove_from_end = functionName;\n        var func = [];\n        func.push('function ' + functionName + '(list, x) {');\n        func.push('  x = list.length - x;');\n        func.push('  return list.splice(x, 1)[0];');\n        func.push('}');\n        Blockly.JavaScript.definitions_['lists_remove_from_end'] =\n            func.join('\\n');\n      }\n      code = Blockly.JavaScript.lists_getIndex.lists_remove_from_end +\n          '(' + list + ', ' + at + ')';\n      if (mode == 'GET_REMOVE') {\n        return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n      } else if (mode == 'REMOVE') {\n        return code + ';\\n';\n      }\n    }\n  } else if (where == 'RANDOM') {\n    if (!Blockly.JavaScript.definitions_['lists_get_random_item']) {\n      var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n          'lists_get_random_item', Blockly.Generator.NAME_TYPE);\n      Blockly.JavaScript.lists_getIndex.random = functionName;\n      var func = [];\n      func.push('function ' + functionName + '(list, remove) {');\n      func.push('  var x = Math.floor(Math.random() * list.length);');\n      func.push('  if (remove) {');\n      func.push('    return list.splice(x, 1)[0];');\n      func.push('  } else {');\n      func.push('    return list[x];');\n      func.push('  }');\n      func.push('}');\n      Blockly.JavaScript.definitions_['lists_get_random_item'] =\n          func.join('\\n');\n    }\n    code = Blockly.JavaScript.lists_getIndex.random +\n        '(' + list + ', ' + (mode != 'GET') + ')';\n    if (mode == 'GET' || mode == 'GET_REMOVE') {\n      return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n    } else if (mode == 'REMOVE') {\n      return code + ';\\n';\n    }\n  }\n  throw 'Unhandled combination (lists_getIndex).';\n};\n\nBlockly.JavaScript.lists_setIndex = function() {\n  // Set element at index.\n  // Note: Until February 2013 this block did not have MODE or WHERE inputs.\n  var list = Blockly.JavaScript.valueToCode(this, 'LIST',\n      Blockly.JavaScript.ORDER_MEMBER) || '[]';\n  var mode = this.getTitleValue('MODE') || 'GET';\n  var where = this.getTitleValue('WHERE') || 'FROM_START';\n  var at = Blockly.JavaScript.valueToCode(this, 'AT',\n      Blockly.JavaScript.ORDER_NONE) || '1';\n  var value = Blockly.JavaScript.valueToCode(this, 'TO',\n      Blockly.JavaScript.ORDER_ASSIGNMENT) || 'null';\n  // Cache non-trivial values to variables to prevent repeated look-ups.\n  // Closure, which accesses and modifies 'list'.\n  function cacheList() {\n    if (list.match(/^\\w+$/)) {\n      return '';\n    }\n    var listVar = Blockly.JavaScript.variableDB_.getDistinctName(\n        'tmp_list', Blockly.Variables.NAME_TYPE);\n    var code = 'var ' + listVar + ' = ' + list + ';\\n';\n    list = listVar;\n    return code;\n  }\n  if (where == 'FIRST') {\n    if (mode == 'SET') {\n      return list + '[0] = ' + value + ';\\n';\n    } else if (mode == 'INSERT') {\n      return list + '.unshift(' + value + ');\\n';\n    }\n  } else if (where == 'LAST') {\n    if (mode == 'SET') {\n      var code = cacheList();\n      code += list + '[' + list + '.length - 1] = ' + value + ';\\n';\n      return code;\n    } else if (mode == 'INSERT') {\n      return list + '.push(' + value + ');\\n';\n    }\n  } else if (where == 'FROM_START') {\n    // Blockly uses one-based indicies.\n    if (Blockly.isNumber(at)) {\n      // If the index is a naked number, decrement it right now.\n      at = parseFloat(at) - 1;\n    } else {\n      // If the index is dynamic, decrement it in code.\n      at += ' - 1';\n    }\n    if (mode == 'SET') {\n      return list + '[' + at + '] = ' + value + ';\\n';\n    } else if (mode == 'INSERT') {\n      return list + '.splice(' + at + ', 0, ' + value + ');\\n';\n    }\n  } else if (where == 'FROM_END') {\n    var code = cacheList();\n    if (mode == 'SET') {\n      code += list + '[' + list + '.length - ' + at + '] = ' + value + ';\\n';\n      return code;\n    } else if (mode == 'INSERT') {\n      code += list + '.splice(' + list + '.length - ' + at + ', 0, ' + value +\n          ');\\n';\n      return code;\n    }\n  } else if (where == 'RANDOM') {\n    var code = cacheList();\n    var xVar = Blockly.JavaScript.variableDB_.getDistinctName(\n        'tmp_x', Blockly.Variables.NAME_TYPE);\n    code += 'var ' + xVar + ' = Math.floor(Math.random() * ' + list +\n        '.length);\\n';\n    if (mode == 'SET') {\n      code += list + '[' + xVar + '] = ' + value + ';\\n';\n      return code;\n    } else if (mode == 'INSERT') {\n      code += list + '.splice(' + xVar + ', 0, ' + value + ');\\n';\n      return code;\n    }\n  }\n  throw 'Unhandled combination (lists_setIndex).';\n};\n\nBlockly.JavaScript.lists_getSublist = function() {\n  // Get sublist.\n  var list = Blockly.JavaScript.valueToCode(this, 'LIST',\n      Blockly.JavaScript.ORDER_MEMBER) || '[]';\n  var where1 = this.getTitleValue('WHERE1');\n  var where2 = this.getTitleValue('WHERE2');\n  var at1 = Blockly.JavaScript.valueToCode(this, 'AT1',\n      Blockly.JavaScript.ORDER_NONE) || '1';\n  var at2 = Blockly.JavaScript.valueToCode(this, 'AT2',\n      Blockly.JavaScript.ORDER_NONE) || '1';\n  if (where1 == 'FIRST' && where2 == 'LAST') {\n    var code = list + '.concat()';\n  } else {\n    if (!Blockly.JavaScript.definitions_['lists_get_sublist']) {\n      var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n          'lists_get_sublist', Blockly.Generator.NAME_TYPE);\n      Blockly.JavaScript.lists_getSublist.func = functionName;\n      var func = [];\n      func.push('function ' + functionName +\n          '(list, where1, at1, where2, at2) {');\n      func.push('  function getAt(where, at) {');\n      func.push('    if (where == \\'FROM_START\\') {');\n      func.push('      at--;');\n      func.push('    } else if (where == \\'FROM_END\\') {');\n      func.push('      at = list.length - at;');\n      func.push('    } else if (where == \\'FIRST\\') {');\n      func.push('      at = 0;');\n      func.push('    } else if (where == \\'LAST\\') {');\n      func.push('      at = list.length - 1;');\n      func.push('    } else {');\n      func.push('      throw \\'Unhandled option (lists_getSublist).\\';');\n      func.push('    }');\n      func.push('    return at;');\n      func.push('  }');\n      func.push('  at1 = getAt(where1, at1);');\n      func.push('  at2 = getAt(where2, at2) + 1;');\n      func.push('  return list.slice(at1, at2);');\n      func.push('}');\n      Blockly.JavaScript.definitions_['lists_get_sublist'] =\n          func.join('\\n');\n    }\n    var code = Blockly.JavaScript.lists_getSublist.func + '(' + list + ', \\'' +\n        where1 + '\\', ' + at1 + ', \\'' + where2 + '\\', ' + at2 + ')';\n  }\n  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n","/**\n * Visual Blocks Language\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Generating JavaScript for logic blocks.\n * @author q.neutron@gmail.com (Quynh Neutron)\n */\n'use strict';\n\ngoog.provide('Blockly.JavaScript.logic');\n\ngoog.require('Blockly.JavaScript');\n\n\nBlockly.JavaScript.controls_if = function() {\n  // If/elseif/else condition.\n  var n = 0;\n  var argument = Blockly.JavaScript.valueToCode(this, 'IF' + n,\n      Blockly.JavaScript.ORDER_NONE) || 'false';\n  var branch = Blockly.JavaScript.statementToCode(this, 'DO' + n);\n  var code = 'if (' + argument + ') {\\n' + branch + '}';\n  for (n = 1; n <= this.elseifCount_; n++) {\n    argument = Blockly.JavaScript.valueToCode(this, 'IF' + n,\n        Blockly.JavaScript.ORDER_NONE) || 'false';\n    branch = Blockly.JavaScript.statementToCode(this, 'DO' + n);\n    code += ' else if (' + argument + ') {\\n' + branch + '}';\n  }\n  if (this.elseCount_) {\n    branch = Blockly.JavaScript.statementToCode(this, 'ELSE');\n    code += ' else {\\n' + branch + '}\\n';\n  }\n  return code + '\\n';\n};\n\nBlockly.JavaScript.logic_compare = function() {\n  // Comparison operator.\n  var mode = this.getTitleValue('OP');\n  var operator = Blockly.JavaScript.logic_compare.OPERATORS[mode];\n  var order = (operator == '==' || operator == '!=') ?\n      Blockly.JavaScript.ORDER_EQUALITY : Blockly.JavaScript.ORDER_RELATIONAL;\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'A', order) || '0';\n  var argument1 = Blockly.JavaScript.valueToCode(this, 'B', order) || '0';\n  var code = argument0 + ' ' + operator + ' ' + argument1;\n  return [code, order];\n};\n\nBlockly.JavaScript.logic_compare.OPERATORS = {\n  EQ: '==',\n  NEQ: '!=',\n  LT: '<',\n  LTE: '<=',\n  GT: '>',\n  GTE: '>='\n};\n\nBlockly.JavaScript.logic_operation = function() {\n  // Operations 'and', 'or'.\n  var operator = (this.getTitleValue('OP') == 'AND') ? '&&' : '||';\n  var order = (operator == '&&') ? Blockly.JavaScript.ORDER_LOGICAL_AND :\n      Blockly.JavaScript.ORDER_LOGICAL_OR;\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'A', order) || 'false';\n  var argument1 = Blockly.JavaScript.valueToCode(this, 'B', order) || 'false';\n  var code = argument0 + ' ' + operator + ' ' + argument1;\n  return [code, order];\n};\n\nBlockly.JavaScript.logic_negate = function() {\n  // Negation.\n  var order = Blockly.JavaScript.ORDER_LOGICAL_NOT;\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'BOOL', order) ||\n      'false';\n  var code = '!' + argument0;\n  return [code, order];\n};\n\nBlockly.JavaScript.logic_boolean = function() {\n  // Boolean values true and false.\n  var code = (this.getTitleValue('BOOL') == 'TRUE') ? 'true' : 'false';\n  return [code, Blockly.JavaScript.ORDER_ATOMIC];\n};\n\nBlockly.JavaScript.logic_null = function() {\n  // Null data type.\n  return ['null', Blockly.JavaScript.ORDER_ATOMIC];\n};\n\nBlockly.JavaScript.logic_ternary = function() {\n  // Ternary operator.\n  var value_if = Blockly.JavaScript.valueToCode(this, 'IF',\n      Blockly.JavaScript.ORDER_CONDITIONAL) || 'false';\n  var value_then = Blockly.JavaScript.valueToCode(this, 'THEN',\n      Blockly.JavaScript.ORDER_CONDITIONAL) || 'null';\n  var value_else = Blockly.JavaScript.valueToCode(this, 'ELSE',\n      Blockly.JavaScript.ORDER_CONDITIONAL) || 'null';\n  var code = value_if + ' ? ' + value_then + ' : ' + value_else\n  return [code, Blockly.JavaScript.ORDER_CONDITIONAL];\n};\n","/**\n * Visual Blocks Language\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Generating JavaScript for loop blocks.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.JavaScript.loops');\n\ngoog.require('Blockly.JavaScript');\n\n\nBlockly.JavaScript.controls_repeat = function() {\n  // Repeat n times (internal number).\n  var repeats = Number(this.getTitleValue('TIMES')) || 0;\n  var branch = Blockly.JavaScript.statementToCode(this, 'DO');\n  if (Blockly.JavaScript.INFINITE_LOOP_TRAP) {\n    branch = Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,\n        '\\'' + this.id + '\\'') + branch;\n  }\n  var loopVar = Blockly.JavaScript.variableDB_.getDistinctName(\n      'count', Blockly.Variables.NAME_TYPE);\n  var code = 'for (var ' + loopVar + ' = 0; ' +\n      loopVar + ' < ' + repeats + '; ' +\n      loopVar + '++) {\\n' +\n      branch + '}\\n';\n  return code;\n};\n\nBlockly.JavaScript.controls_repeat_ext = function() {\n  // Repeat n times (external number).\n  var repeats = Blockly.JavaScript.valueToCode(this, 'TIMES',\n      Blockly.JavaScript.ORDER_ASSIGNMENT) || '0';\n  var branch = Blockly.JavaScript.statementToCode(this, 'DO');\n  if (Blockly.JavaScript.INFINITE_LOOP_TRAP) {\n    branch = Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,\n        '\\'' + this.id + '\\'') + branch;\n  }\n  var code = '';\n  var loopVar = Blockly.JavaScript.variableDB_.getDistinctName(\n      'count', Blockly.Variables.NAME_TYPE);\n  var endVar = repeats;\n  if (!repeats.match(/^\\w+$/) && !Blockly.isNumber(repeats)) {\n    var endVar = Blockly.JavaScript.variableDB_.getDistinctName(\n        'repeat_end', Blockly.Variables.NAME_TYPE);\n    code += 'var ' + endVar + ' = ' + repeats + ';\\n';\n  }\n  code += 'for (var ' + loopVar + ' = 0; ' +\n      loopVar + ' < ' + endVar + '; ' +\n      loopVar + '++) {\\n' +\n      branch + '}\\n';\n  return code;\n};\n\nBlockly.JavaScript.controls_whileUntil = function() {\n  // Do while/until loop.\n  var until = this.getTitleValue('MODE') == 'UNTIL';\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'BOOL',\n      until ? Blockly.JavaScript.ORDER_LOGICAL_NOT :\n      Blockly.JavaScript.ORDER_NONE) || 'false';\n  var branch = Blockly.JavaScript.statementToCode(this, 'DO');\n  if (Blockly.JavaScript.INFINITE_LOOP_TRAP) {\n    branch = Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,\n        '\\'' + this.id + '\\'') + branch;\n  }\n  if (until) {\n    argument0 = '!' + argument0;\n  }\n  return 'while (' + argument0 + ') {\\n' + branch + '}\\n';\n};\n\nBlockly.JavaScript.controls_for = function() {\n  // For loop.\n  var variable0 = Blockly.JavaScript.translateVarName(\n      this.getTitleValue('VAR'));\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'FROM',\n      Blockly.JavaScript.ORDER_ASSIGNMENT) || '0';\n  var argument1 = Blockly.JavaScript.valueToCode(this, 'TO',\n      Blockly.JavaScript.ORDER_ASSIGNMENT) || '0';\n  var increment = Blockly.JavaScript.valueToCode(this, 'BY',\n      Blockly.JavaScript.ORDER_ASSIGNMENT) || '1';\n  var branch = Blockly.JavaScript.statementToCode(this, 'DO');\n  if (Blockly.JavaScript.INFINITE_LOOP_TRAP) {\n    branch = Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,\n        '\\'' + this.id + '\\'') + branch;\n  }\n  var code;\n  if (Blockly.isNumber(argument0) && Blockly.isNumber(argument1) &&\n      Blockly.isNumber(increment)) {\n    // All arguments are simple numbers.\n    var up = parseFloat(argument0) <= parseFloat(argument1);\n    code = 'for (' + variable0 + ' = ' + argument0 + '; ' +\n        variable0 + (up ? ' <= ' : ' >= ') + argument1 + '; ' +\n        variable0;\n    var step = Math.abs(parseFloat(increment));\n    if (step === 1) {\n      code += up ? '++' : '--';\n    } else {\n      code += (up ? ' += ' : ' -= ') + step;\n      if (step === 0) {\n        // guaranteed to loop infinitely if we're looping with step\n        branch = '  throw Infinity;\\n' + branch;\n      }\n    }\n    code += ') {\\n' + branch + '}\\n';\n  } else {\n    code = '';\n    // Cache non-trivial values to variables to prevent repeated look-ups.\n    var variable0Undec = Blockly.JavaScript.variableDB_.getName(\n        this.getTitleValue('VAR'), Blockly.Variables.NAME_TYPE);\n    var startVar = argument0;\n    if (!argument0.match(/^\\w+$/) && !Blockly.isNumber(argument0)) {\n      var startVar = Blockly.JavaScript.variableDB_.getDistinctName(\n          variable0Undec + '_start', Blockly.Variables.NAME_TYPE);\n      code += 'var ' + startVar + ' = ' + argument0 + ';\\n';\n    }\n    var endVar = argument1;\n    if (!argument1.match(/^\\w+$/) && !Blockly.isNumber(argument1)) {\n      var endVar = Blockly.JavaScript.variableDB_.getDistinctName(\n          variable0Undec + '_end', Blockly.Variables.NAME_TYPE);\n      code += 'var ' + endVar + ' = ' + argument1 + ';\\n';\n    }\n    // Determine loop direction at start, in case one of the bounds\n    // changes during loop execution.\n    var incVar = Blockly.JavaScript.variableDB_.getDistinctName(\n        variable0Undec + '_inc', Blockly.Variables.NAME_TYPE);\n    code += 'var ' + incVar + ' = ';\n    if (Blockly.isNumber(increment)) {\n      code += Math.abs(increment) + ';\\n';\n    } else {\n      code += 'Math.abs(' + increment + ');\\n';\n    }\n    code += 'if (' + startVar + ' > ' + endVar + ') {\\n';\n    code += '  ' + incVar + ' = -' + incVar +';\\n';\n    code += '}\\n';\n    code += 'for (' + variable0 + ' = ' + startVar + ';\\n' +\n        '     '  + incVar + ' >= 0 ? ' +\n        variable0 + ' <= ' + endVar + ' : ' +\n        variable0 + ' >= ' + endVar + ';\\n' +\n        '     ' + variable0 + ' += ' + incVar + ') {\\n' +\n        branch + '}\\n';\n  }\n  return code;\n};\n\nBlockly.JavaScript.controls_forEach = function() {\n  // For each loop.\n  var variable0 = Blockly.JavaScript.translateVarName(\n      this.getTitleValue('VAR'));\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'LIST',\n      Blockly.JavaScript.ORDER_ASSIGNMENT) || '[]';\n  var branch = Blockly.JavaScript.statementToCode(this, 'DO');\n  if (Blockly.JavaScript.INFINITE_LOOP_TRAP) {\n    branch = Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,\n        '\\'' + this.id + '\\'') + branch;\n  }\n  var code;\n  var variable0Undec = Blockly.JavaScript.variableDB_.getName(\n      this.getTitleValue('VAR'), Blockly.Variables.NAME_TYPE);\n  var indexVar = Blockly.JavaScript.variableDB_.getDistinctName(\n      variable0Undec + '_index', Blockly.Variables.NAME_TYPE);\n  if (argument0.match(/^\\w+$/)) {\n    branch = '  ' + variable0 + ' = ' + argument0 + '[' + indexVar + '];\\n' +\n        branch;\n    code = 'for (var ' + indexVar + ' in  ' + argument0 + ') {\\n' +\n        branch + '}\\n';\n  } else {\n    // The list appears to be more complicated than a simple variable.\n    // Cache it to a variable to prevent repeated look-ups.\n    var listVar = Blockly.JavaScript.variableDB_.getDistinctName(\n        variable0Undec + '_list', Blockly.Variables.NAME_TYPE);\n    branch = '  ' + variable0 + ' = ' + listVar + '[' + indexVar + '];\\n' +\n        branch;\n    code = 'var ' + listVar + ' = ' + argument0 + ';\\n' +\n        'for (var ' + indexVar + ' in ' + listVar + ') {\\n' +\n        branch + '}\\n';\n  }\n  return code;\n};\n\nBlockly.JavaScript.controls_flow_statements = function() {\n  // Flow statements: continue, break.\n  switch (this.getTitleValue('FLOW')) {\n    case 'BREAK':\n      return 'break;\\n';\n    case 'CONTINUE':\n      return 'continue;\\n';\n  }\n  throw 'Unknown flow statement.';\n};\n","/**\n * Visual Blocks Language\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Generating JavaScript for math blocks.\n * @author q.neutron@gmail.com (Quynh Neutron)\n */\n'use strict';\n\ngoog.provide('Blockly.JavaScript.math');\n\ngoog.require('Blockly.JavaScript');\n\n\nBlockly.JavaScript.math_number = function() {\n  // Numeric value.\n  var code = window.parseFloat(this.getTitleValue('NUM')) || 0;\n  return [code, Blockly.JavaScript.ORDER_ATOMIC];\n};\n\nBlockly.JavaScript.math_arithmetic = function() {\n  // Basic arithmetic operators, and power.\n  var mode = this.getTitleValue('OP');\n  var tuple = Blockly.JavaScript.math_arithmetic.OPERATORS[mode];\n  var operator = tuple[0];\n  var order = tuple[1];\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'A', order) || '0';\n  var argument1 = Blockly.JavaScript.valueToCode(this, 'B', order) || '0';\n  var code;\n  // Power in JavaScript requires a special case since it has no operator.\n  if (!operator) {\n    code = 'Math.pow(' + argument0 + ', ' + argument1 + ')';\n    return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n  }\n  code = argument0 + operator + argument1;\n  return [code, order];\n};\n\nBlockly.JavaScript.math_arithmetic.OPERATORS = {\n  ADD: [' + ', Blockly.JavaScript.ORDER_ADDITION],\n  MINUS: [' - ', Blockly.JavaScript.ORDER_SUBTRACTION],\n  MULTIPLY: [' * ', Blockly.JavaScript.ORDER_MULTIPLICATION],\n  DIVIDE: [' / ', Blockly.JavaScript.ORDER_DIVISION],\n  POWER: [null, Blockly.JavaScript.ORDER_COMMA]  // Handle power separately.\n};\n\nBlockly.JavaScript.math_single = function() {\n  // Math operators with single operand.\n  var operator = this.getTitleValue('OP');\n  var code;\n  var arg;\n  if (operator == 'NEG') {\n    // Negation is a special case given its different operator precedence.\n    arg = Blockly.JavaScript.valueToCode(this, 'NUM',\n        Blockly.JavaScript.ORDER_UNARY_NEGATION) || '0';\n    if (arg[0] == '-') {\n      // --3 is not legal in JS.\n      arg = ' ' + arg;\n    }\n    code = '-' + arg;\n    return [code, Blockly.JavaScript.ORDER_UNARY_NEGATION];\n  }\n  if (operator == 'SIN' || operator == 'COS' || operator == 'TAN') {\n    arg = Blockly.JavaScript.valueToCode(this, 'NUM',\n        Blockly.JavaScript.ORDER_DIVISION) || '0';\n  } else {\n    arg = Blockly.JavaScript.valueToCode(this, 'NUM',\n        Blockly.JavaScript.ORDER_NONE) || '0';\n  }\n  // First, handle cases which generate values that don't need parentheses\n  // wrapping the code.\n  switch (operator) {\n    case 'ABS':\n      code = 'Math.abs(' + arg + ')';\n      break;\n    case 'ROOT':\n      code = 'Math.sqrt(' + arg + ')';\n      break;\n    case 'LN':\n      code = 'Math.log(' + arg + ')';\n      break;\n    case 'EXP':\n      code = 'Math.exp(' + arg + ')';\n      break;\n    case 'POW10':\n      code = 'Math.pow(10,' + arg + ')';\n      break;\n    case 'ROUND':\n      code = 'Math.round(' + arg + ')';\n      break;\n    case 'ROUNDUP':\n      code = 'Math.ceil(' + arg + ')';\n      break;\n    case 'ROUNDDOWN':\n      code = 'Math.floor(' + arg + ')';\n      break;\n    case 'SIN':\n      code = 'Math.sin(' + arg + ' / 180 * Math.PI)';\n      break;\n    case 'COS':\n      code = 'Math.cos(' + arg + ' / 180 * Math.PI)';\n      break;\n    case 'TAN':\n      code = 'Math.tan(' + arg + ' / 180 * Math.PI)';\n      break;\n  }\n  if (code) {\n    return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n  }\n  // Second, handle cases which generate values that may need parentheses\n  // wrapping the code.\n  switch (operator) {\n    case 'LOG10':\n      code = 'Math.log(' + arg + ') / Math.log(10)';\n      break;\n    case 'ASIN':\n      code = 'Math.asin(' + arg + ') / Math.PI * 180';\n      break;\n    case 'ACOS':\n      code = 'Math.acos(' + arg + ') / Math.PI * 180';\n      break;\n    case 'ATAN':\n      code = 'Math.atan(' + arg + ') / Math.PI * 180';\n      break;\n    default:\n      throw 'Unknown math operator: ' + operator;\n  }\n  return [code, Blockly.JavaScript.ORDER_DIVISION];\n};\n\nBlockly.JavaScript.math_constant = function() {\n  // Constants: PI, E, the Golden Ratio, sqrt(2), 1/sqrt(2), INFINITY.\n  var constant = this.getTitleValue('CONSTANT');\n  return Blockly.JavaScript.math_constant.CONSTANTS[constant];\n};\n\nBlockly.JavaScript.math_constant.CONSTANTS = {\n  PI: ['Math.PI', Blockly.JavaScript.ORDER_MEMBER],\n  E: ['Math.E', Blockly.JavaScript.ORDER_MEMBER],\n  GOLDEN_RATIO: ['(1 + Math.sqrt(5)) / 2', Blockly.JavaScript.ORDER_DIVISION],\n  SQRT2: ['Math.SQRT2', Blockly.JavaScript.ORDER_MEMBER],\n  SQRT1_2: ['Math.SQRT1_2', Blockly.JavaScript.ORDER_MEMBER],\n  INFINITY: ['Infinity', Blockly.JavaScript.ORDER_ATOMIC]\n};\n\nBlockly.JavaScript.math_number_property = function() {\n  // Check if a number is even, odd, prime, whole, positive, or negative\n  // or if it is divisible by certain number. Returns true or false.\n  var number_to_check = Blockly.JavaScript.valueToCode(this, 'NUMBER_TO_CHECK',\n      Blockly.JavaScript.ORDER_MODULUS) || '0';\n  var dropdown_property = this.getTitleValue('PROPERTY');\n  var code;\n  if (dropdown_property == 'PRIME') {\n    // Prime is a special case as it is not a one-liner test.\n    if (!Blockly.JavaScript.definitions_['isPrime']) {\n      var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n          'isPrime', Blockly.Generator.NAME_TYPE);\n      Blockly.JavaScript.logic_prime= functionName;\n      var func = [];\n      func.push('function ' + functionName + '(n) {');\n      func.push('  // http://en.wikipedia.org/wiki/Primality_test#Naive_methods');\n      func.push('  if (n == 2 || n == 3) {');\n      func.push('    return true;');\n      func.push('  }');\n      func.push('  // False if n is NaN, negative, is 1, or not whole.');\n      func.push('  // And false if n is divisible by 2 or 3.');\n      func.push('  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 ||' +\n                ' n % 3 == 0) {');\n      func.push('    return false;');\n      func.push('  }');\n      func.push('  // Check all the numbers of form 6k +/- 1, up to sqrt(n).');\n      func.push('  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {');\n      func.push('    if (n % (x - 1) == 0 || n % (x + 1) == 0) {');\n      func.push('      return false;');\n      func.push('    }');\n      func.push('  }');\n      func.push('  return true;');\n      func.push('}');\n      Blockly.JavaScript.definitions_['isPrime'] = func.join('\\n');\n    }\n    code = Blockly.JavaScript.logic_prime + '(' + number_to_check + ')';\n    return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n  }\n  switch (dropdown_property) {\n    case 'EVEN':\n      code = number_to_check + ' % 2 == 0';\n      break;\n    case 'ODD':\n      code = number_to_check + ' % 2 == 1';\n      break;\n    case 'WHOLE':\n      code = number_to_check + ' % 1 == 0';\n      break;\n    case 'POSITIVE':\n      code = number_to_check + ' > 0';\n      break;\n    case 'NEGATIVE':\n      code = number_to_check + ' < 0';\n      break;\n    case 'DIVISIBLE_BY':\n      var divisor = Blockly.JavaScript.valueToCode(this, 'DIVISOR',\n          Blockly.JavaScript.ORDER_MODULUS) || '0';\n      code = number_to_check + ' % ' + divisor + ' == 0';\n      break;\n  }\n  return [code, Blockly.JavaScript.ORDER_EQUALITY];\n};\n\nBlockly.JavaScript.math_change = function() {\n  // Add to a variable in place.\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'DELTA',\n      Blockly.JavaScript.ORDER_ADDITION) || '0';\n  var varName = Blockly.JavaScript.translateVarName(this.getTitleValue('VAR'));\n  return varName + ' = (typeof ' + varName + ' == \\'number\\' ? ' + varName +\n      ' : 0) + ' + argument0 + ';\\n';\n};\n\n// Rounding functions have a single operand.\nBlockly.JavaScript.math_round = Blockly.JavaScript.math_single;\n// Trigonometry functions have a single operand.\nBlockly.JavaScript.math_trig = Blockly.JavaScript.math_single;\n\nBlockly.JavaScript.math_on_list = function() {\n  // Math functions for lists.\n  var func = this.getTitleValue('OP');\n  var list, code;\n  switch (func) {\n    case 'SUM':\n      list = Blockly.JavaScript.valueToCode(this, 'LIST',\n          Blockly.JavaScript.ORDER_MEMBER) || '[]';\n      code = list + '.reduce(function(x, y) {return x + y;})';\n      break;\n    case 'MIN':\n      list = Blockly.JavaScript.valueToCode(this, 'LIST',\n          Blockly.JavaScript.ORDER_COMMA) || '[]';\n      code = 'Math.min.apply(null, ' + list + ')';\n      break;\n    case 'MAX':\n      list = Blockly.JavaScript.valueToCode(this, 'LIST',\n          Blockly.JavaScript.ORDER_COMMA) || '[]';\n      code = 'Math.max.apply(null, ' + list + ')';\n      break;\n    case 'AVERAGE':\n      // math_median([null,null,1,3]) == 2.0.\n      if (!Blockly.JavaScript.definitions_['math_mean']) {\n        var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n            'math_mean', Blockly.Generator.NAME_TYPE);\n        Blockly.JavaScript.math_on_list.math_mean = functionName;\n        var func = [];\n        func.push('function ' + functionName + '(myList) {');\n        func.push('  return myList.reduce(function(x, y) {return x + y;}) / ' +\n                  'myList.length;');\n        func.push('}');\n        Blockly.JavaScript.definitions_['math_mean'] = func.join('\\n');\n      }\n      list = Blockly.JavaScript.valueToCode(this, 'LIST',\n          Blockly.JavaScript.ORDER_NONE) || '[]';\n      code = Blockly.JavaScript.math_on_list.math_mean + '(' + list + ')';\n      break;\n    case 'MEDIAN':\n      // math_median([null,null,1,3]) == 2.0.\n      if (!Blockly.JavaScript.definitions_['math_median']) {\n        var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n            'math_median', Blockly.Generator.NAME_TYPE);\n        Blockly.JavaScript.math_on_list.math_median = functionName;\n        var func = [];\n        func.push('function ' + functionName + '(myList) {');\n        func.push('  var localList = myList.filter(function (x) ' +\n                  '{return typeof x == \\'number\\';});');\n        func.push('  if (!localList.length) return null;');\n        func.push('  localList.sort(function(a, b) {return b - a;});');\n        func.push('  if (localList.length % 2 == 0) {');\n        func.push('    return (localList[localList.length / 2 - 1] + ' +\n                  'localList[localList.length / 2]) / 2;');\n        func.push('  } else {');\n        func.push('    return localList[(localList.length - 1) / 2];');\n        func.push('  }');\n        func.push('}');\n        Blockly.JavaScript.definitions_['math_median'] = func.join('\\n');\n      }\n      list = Blockly.JavaScript.valueToCode(this, 'LIST',\n          Blockly.JavaScript.ORDER_NONE) || '[]';\n      code = Blockly.JavaScript.math_on_list.math_median + '(' + list + ')';\n      break;\n    case 'MODE':\n      if (!Blockly.JavaScript.definitions_['math_modes']) {\n        var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n            'math_modes', Blockly.Generator.NAME_TYPE);\n        Blockly.JavaScript.math_on_list.math_modes = functionName;\n        // As a list of numbers can contain more than one mode,\n        // the returned result is provided as an array.\n        // Mode of [3, 'x', 'x', 1, 1, 2, '3'] -> ['x', 1].\n        var func = [];\n        func.push('function ' + functionName + '(values) {');\n        func.push('  var modes = [];');\n        func.push('  var counts = [];');\n        func.push('  var maxCount = 0;');\n        func.push('  for (var i = 0; i < values.length; i++) {');\n        func.push('    var value = values[i];');\n        func.push('    var found = false;');\n        func.push('    var thisCount;');\n        func.push('    for (var j = 0; j < counts.length; j++) {');\n        func.push('      if (counts[j][0] === value) {');\n        func.push('        thisCount = ++counts[j][1];');\n        func.push('        found = true;');\n        func.push('        break;');\n        func.push('      }');\n        func.push('    }');\n        func.push('    if (!found) {');\n        func.push('      counts.push([value, 1]);');\n        func.push('      thisCount = 1;');\n        func.push('    }');\n        func.push('    maxCount = Math.max(thisCount, maxCount);');\n        func.push('  }');\n        func.push('  for (var j = 0; j < counts.length; j++) {');\n        func.push('    if (counts[j][1] == maxCount) {');\n        func.push('        modes.push(counts[j][0]);');\n        func.push('    }');\n        func.push('  }');\n        func.push('  return modes;');\n        func.push('}');\n        Blockly.JavaScript.definitions_['math_modes'] = func.join('\\n');\n      }\n      list = Blockly.JavaScript.valueToCode(this, 'LIST',\n          Blockly.JavaScript.ORDER_NONE) || '[]';\n      code = Blockly.JavaScript.math_on_list.math_modes + '(' + list + ')';\n      break;\n    case 'STD_DEV':\n      if (!Blockly.JavaScript.definitions_['math_standard_deviation']) {\n        var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n            'math_standard_deviation', Blockly.Generator.NAME_TYPE);\n        Blockly.JavaScript.math_on_list.math_standard_deviation = functionName;\n        var func = [];\n        func.push('function ' + functionName + '(numbers) {');\n        func.push('  var n = numbers.length;');\n        func.push('  if (!n) return null;');\n        func.push('  var mean = numbers.reduce(function(x, y) ' +\n                  '{return x + y;}) / n;');\n        func.push('  var variance = 0;');\n        func.push('  for (var j = 0; j < n; j++) {');\n        func.push('    variance += Math.pow(numbers[j] - mean, 2);');\n        func.push('  }');\n        func.push('  variance = variance / n;');\n        func.push('  return Math.sqrt(variance);');\n        func.push('}');\n        Blockly.JavaScript.definitions_['math_standard_deviation'] =\n            func.join('\\n');\n      }\n      list = Blockly.JavaScript.valueToCode(this, 'LIST',\n          Blockly.JavaScript.ORDER_NONE) || '[]';\n      code = Blockly.JavaScript.math_on_list.math_standard_deviation +\n          '(' + list + ')';\n      break;\n    case 'RANDOM':\n      if (!Blockly.JavaScript.definitions_['math_random_item']) {\n        var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n            'math_random_item', Blockly.Generator.NAME_TYPE);\n        Blockly.JavaScript.math_on_list.math_random_item = functionName;\n        var func = [];\n        func.push('function ' + functionName + '(list) {');\n        func.push('  var x = Math.floor(Math.random() * list.length);');\n        func.push('  return list[x];');\n        func.push('}');\n        Blockly.JavaScript.definitions_['math_random_item'] = func.join('\\n');\n      }\n      list = Blockly.JavaScript.valueToCode(this, 'LIST',\n          Blockly.JavaScript.ORDER_NONE) || '[]';\n      code = Blockly.JavaScript.math_on_list.math_random_item +\n          '(' + list + ')';\n      break;\n    default:\n      throw 'Unknown operator: ' + func;\n  }\n  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n\nBlockly.JavaScript.math_modulo = function() {\n  // Remainder computation.\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'DIVIDEND',\n      Blockly.JavaScript.ORDER_MODULUS) || '0';\n  var argument1 = Blockly.JavaScript.valueToCode(this, 'DIVISOR',\n      Blockly.JavaScript.ORDER_MODULUS) || '0';\n  var code = argument0 + ' % ' + argument1;\n  return [code, Blockly.JavaScript.ORDER_MODULUS];\n};\n\nBlockly.JavaScript.math_constrain = function() {\n  // Constrain a number between two limits.\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'VALUE',\n      Blockly.JavaScript.ORDER_COMMA) || '0';\n  var argument1 = Blockly.JavaScript.valueToCode(this, 'LOW',\n      Blockly.JavaScript.ORDER_COMMA) || '0';\n  var argument2 = Blockly.JavaScript.valueToCode(this, 'HIGH',\n      Blockly.JavaScript.ORDER_COMMA) || 'Infinity';\n  var code = 'Math.min(Math.max(' + argument0 + ', ' + argument1 + '), ' +\n      argument2 + ')';\n  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n\nBlockly.JavaScript.math_random_int = function() {\n  // Random integer between [X] and [Y].\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'FROM',\n      Blockly.JavaScript.ORDER_COMMA) || '0';\n  var argument1 = Blockly.JavaScript.valueToCode(this, 'TO',\n      Blockly.JavaScript.ORDER_COMMA) || '0';\n  if (!Blockly.JavaScript.definitions_['math_random_int']) {\n    var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n        'math_random_int', Blockly.Generator.NAME_TYPE);\n    Blockly.JavaScript.math_random_int.random_function = functionName;\n    var func = [];\n    func.push('function ' + functionName + '(a, b) {');\n    func.push('  if (a > b) {');\n    func.push('    // Swap a and b to ensure a is smaller.');\n    func.push('    var c = a;');\n    func.push('    a = b;');\n    func.push('    b = c;');\n    func.push('  }');\n    func.push('  return Math.floor(Math.random() * (b - a + 1) + a);');\n    func.push('}');\n    Blockly.JavaScript.definitions_['math_random_int'] = func.join('\\n');\n  }\n  var code = Blockly.JavaScript.math_random_int.random_function +\n      '(' + argument0 + ', ' + argument1 + ')';\n  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n\nBlockly.JavaScript.math_random_float = function() {\n  // Random fraction between 0 and 1.\n  return ['Math.random()', Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n","/**\n * Visual Blocks Language\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Generating JavaScript for procedure blocks.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.JavaScript.procedures');\n\ngoog.require('Blockly.JavaScript');\n\n\nBlockly.JavaScript.procedures_defreturn = function() {\n  // Define a procedure with a return value.\n  var funcName = Blockly.JavaScript.variableDB_.getName(\n      this.getTitleValue('NAME'), Blockly.Procedures.NAME_TYPE);\n  // Store names for each of the args\n  // NOTE: It is important to do this first so the first call to getName()\n  // for each arg includes the specific type of NAME_TYPE_LOCAL (local var)\n  var args = [];\n  for (var x = 0; x < this.parameterNames_.length; x++) {\n    args[x] = Blockly.JavaScript.variableDB_.getName(this.parameterNames_[x],\n        Blockly.Variables.NAME_TYPE,\n        Blockly.Variables.NAME_TYPE_LOCAL);\n  }\n  var branch = Blockly.JavaScript.statementToCode(this, 'STACK');\n  if (Blockly.JavaScript.INFINITE_LOOP_TRAP) {\n    branch = Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,\n        '\\'' + this.id + '\\'') + branch;\n  }\n  var returnValue = Blockly.JavaScript.valueToCode(this, 'RETURN',\n      Blockly.JavaScript.ORDER_NONE) || '';\n  if (returnValue) {\n    returnValue = '  return ' + returnValue + ';\\n';\n  }\n  var code = (Blockly.varsInGlobals ?\n                'Globals.' + funcName + ' = function' :\n                'function ' + funcName) +\n             '(' + args.join(', ') + ') {\\n' + branch + returnValue + '}';\n  code = Blockly.JavaScript.scrub_(this, code);\n  Blockly.JavaScript.definitions_[funcName] = code;\n  return null;\n};\n\n// Defining a procedure without a return value uses the same generator as\n// a procedure with a return value.\nBlockly.JavaScript.procedures_defnoreturn =\n    Blockly.JavaScript.procedures_defreturn;\n\nBlockly.JavaScript.procedures_callreturn = function() {\n  // Call a procedure with a return value.\n  var funcName = Blockly.JavaScript.variableDB_.getName(\n      this.getTitleValue('NAME'), Blockly.Procedures.NAME_TYPE);\n  var args = [];\n  for (var x = 0; x < this.currentParameterNames_.length; x++) {\n    args[x] = Blockly.JavaScript.valueToCode(this, 'ARG' + x,\n        Blockly.JavaScript.ORDER_COMMA) || 'null';\n  }\n  var code = (Blockly.varsInGlobals ? 'Globals.' : '') +\n              funcName + '(' + args.join(', ') + ')';\n  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n\nBlockly.JavaScript.procedures_callnoreturn = function() {\n  // Call a procedure with no return value.\n  var funcName = Blockly.JavaScript.variableDB_.getName(\n      this.getTitleValue('NAME'), Blockly.Procedures.NAME_TYPE);\n  var args = [];\n  for (var x = 0; x < this.currentParameterNames_.length; x++) {\n    args[x] = Blockly.JavaScript.valueToCode(this, 'ARG' + x,\n        Blockly.JavaScript.ORDER_COMMA) || 'null';\n  }\n  var code = (Blockly.varsInGlobals ? 'Globals.' : '') +\n              funcName + '(' + args.join(', ') + ');\\n';\n  return code;\n};\n\nBlockly.JavaScript.procedures_ifreturn = function() {\n  // Conditionally return value from a procedure.\n  var condition = Blockly.JavaScript.valueToCode(this, 'CONDITION',\n      Blockly.JavaScript.ORDER_NONE) || 'false';\n  var code = 'if (' + condition + ') {\\n';\n  if (this.hasReturnValue_) {\n    var value = Blockly.JavaScript.valueToCode(this, 'VALUE',\n        Blockly.JavaScript.ORDER_NONE) || 'null';\n    code += '  return ' + value + ';\\n';\n  } else {\n    code += '  return;\\n';\n  }\n  code += '}\\n';\n  return code;\n};\n","/**\n * Visual Blocks Language\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Generating JavaScript for text blocks.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.JavaScript.text');\n\ngoog.require('Blockly.JavaScript');\n\n\nBlockly.JavaScript.text = function() {\n  // Text value.\n  var code = Blockly.JavaScript.quote_(this.getTitleValue('TEXT'));\n  return [code, Blockly.JavaScript.ORDER_ATOMIC];\n};\n\nBlockly.JavaScript.text_join = function() {\n  // Create a string made up of any number of elements of any type.\n  var code;\n  if (this.itemCount_ == 0) {\n    return ['\\'\\'', Blockly.JavaScript.ORDER_ATOMIC];\n  } else if (this.itemCount_ == 1) {\n    var argument0 = Blockly.JavaScript.valueToCode(this, 'ADD0',\n        Blockly.JavaScript.ORDER_NONE) || '\\'\\'';\n    code = 'String(' + argument0 + ')';\n    return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n  } else if (this.itemCount_ == 2) {\n    var argument0 = Blockly.JavaScript.valueToCode(this, 'ADD0',\n        Blockly.JavaScript.ORDER_NONE) || '\\'\\'';\n    var argument1 = Blockly.JavaScript.valueToCode(this, 'ADD1',\n        Blockly.JavaScript.ORDER_NONE) || '\\'\\'';\n    code = 'String(' + argument0 + ') + String(' + argument1 + ')';\n    return [code, Blockly.JavaScript.ORDER_ADDITION];\n  } else {\n    code = new Array(this.itemCount_);\n    for (var n = 0; n < this.itemCount_; n++) {\n      code[n] = Blockly.JavaScript.valueToCode(this, 'ADD' + n,\n          Blockly.JavaScript.ORDER_COMMA) || '\\'\\'';\n    }\n    code = '[' + code.join(',') + '].join(\\'\\')';\n    return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n  }\n};\n\nBlockly.JavaScript.text_append = function() {\n  // Append to a variable in place.\n  var varName = Blockly.JavaScript.translateVarName(this.getTitleValue('VAR'));\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'TEXT',\n      Blockly.JavaScript.ORDER_NONE) || '\\'\\'';\n  return varName + ' = String(' + varName + ') + String(' + argument0 + ');\\n';\n};\n\nBlockly.JavaScript.text_length = function() {\n  // String length.\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'VALUE',\n      Blockly.JavaScript.ORDER_FUNCTION_CALL) || '\\'\\'';\n  return [argument0 + '.length', Blockly.JavaScript.ORDER_MEMBER];\n};\n\nBlockly.JavaScript.text_isEmpty = function() {\n  // Is the string null?\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'VALUE',\n      Blockly.JavaScript.ORDER_MEMBER) || '\\'\\'';\n  return ['!' + argument0, Blockly.JavaScript.ORDER_LOGICAL_NOT];\n};\n\nBlockly.JavaScript.text_indexOf = function() {\n  // Search the text for a substring.\n  var operator = this.getTitleValue('END') == 'FIRST' ?\n      'indexOf' : 'lastIndexOf';\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'FIND',\n      Blockly.JavaScript.ORDER_NONE) || '\\'\\'';\n  var argument1 = Blockly.JavaScript.valueToCode(this, 'VALUE',\n      Blockly.JavaScript.ORDER_MEMBER) || '\\'\\'';\n  var code = argument1 + '.' + operator + '(' + argument0 + ') + 1';\n  return [code, Blockly.JavaScript.ORDER_MEMBER];\n};\n\nBlockly.JavaScript.text_charAt = function() {\n  // Get letter at index.\n  // Note: Until January 2013 this block did not have the WHERE input.\n  var where = this.getTitleValue('WHERE') || 'FROM_START';\n  var at = Blockly.JavaScript.valueToCode(this, 'AT',\n      Blockly.JavaScript.ORDER_UNARY_NEGATION) || '1';\n  var text = Blockly.JavaScript.valueToCode(this, 'VALUE',\n      Blockly.JavaScript.ORDER_MEMBER) || '\\'\\'';\n  switch (where) {\n    case 'FIRST':\n      var code = text + '.charAt(0)';\n      return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n    case 'LAST':\n      var code = text + '.slice(-1)';\n      return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n    case 'FROM_START':\n      // Blockly uses one-based indicies.\n      if (Blockly.isNumber(at)) {\n        // If the index is a naked number, decrement it right now.\n        at = parseFloat(at) - 1;\n      } else {\n        // If the index is dynamic, decrement it in code.\n        at += ' - 1';\n      }\n      var code = text + '.charAt(' + at + ')';\n      return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n    case 'FROM_END':\n      var code = text + '.slice(-' + at + ').charAt(0)';\n      return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n    case 'RANDOM':\n      if (!Blockly.JavaScript.definitions_['text_random_letter']) {\n        var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n            'text_random_letter', Blockly.Generator.NAME_TYPE);\n        Blockly.JavaScript.text_charAt.text_random_letter = functionName;\n        var func = [];\n        func.push('function ' + functionName + '(text) {');\n        func.push('  var x = Math.floor(Math.random() * text.length);');\n        func.push('  return text[x];');\n        func.push('}');\n        Blockly.JavaScript.definitions_['text_random_letter'] = func.join('\\n');\n      }\n      code = Blockly.JavaScript.text_charAt.text_random_letter +\n          '(' + text + ')';\n      return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n  }\n  throw 'Unhandled option (text_charAt).';\n};\n\nBlockly.JavaScript.text_getSubstring = function() {\n  // Get substring.\n  var text = Blockly.JavaScript.valueToCode(this, 'STRING',\n      Blockly.JavaScript.ORDER_MEMBER) || '[]';\n  var where1 = this.getTitleValue('WHERE1');\n  var where2 = this.getTitleValue('WHERE2');\n  var at1 = Blockly.JavaScript.valueToCode(this, 'AT1',\n      Blockly.JavaScript.ORDER_NONE) || '1';\n  var at2 = Blockly.JavaScript.valueToCode(this, 'AT2',\n      Blockly.JavaScript.ORDER_NONE) || '1';\n  if (where1 == 'FIRST' && where2 == 'LAST') {\n    var code = text;\n  } else {\n    if (!Blockly.JavaScript.definitions_['text_get_substring']) {\n      var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n          'text_get_substring', Blockly.Generator.NAME_TYPE);\n      Blockly.JavaScript.text_getSubstring.func = functionName;\n      var func = [];\n      func.push('function ' + functionName +\n          '(text, where1, at1, where2, at2) {');\n      func.push('  function getAt(where, at) {');\n      func.push('    if (where == \\'FROM_START\\') {');\n      func.push('      at--;');\n      func.push('    } else if (where == \\'FROM_END\\') {');\n      func.push('      at = text.length - at;');\n      func.push('    } else if (where == \\'FIRST\\') {');\n      func.push('      at = 0;');\n      func.push('    } else if (where == \\'LAST\\') {');\n      func.push('      at = text.length - 1;');\n      func.push('    } else {');\n      func.push('      throw \\'Unhandled option (text_getSubstring).\\';');\n      func.push('    }');\n      func.push('    return at;');\n      func.push('  }');\n      func.push('  at1 = getAt(where1, at1);');\n      func.push('  at2 = getAt(where2, at2) + 1;');\n      func.push('  return text.slice(at1, at2);');\n      func.push('}');\n      Blockly.JavaScript.definitions_['text_get_substring'] =\n          func.join('\\n');\n    }\n    var code = Blockly.JavaScript.text_getSubstring.func + '(' + text + ', \\'' +\n        where1 + '\\', ' + at1 + ', \\'' + where2 + '\\', ' + at2 + ')';\n  }\n  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n\nBlockly.JavaScript.text_changeCase = function() {\n  // Change capitalization.\n  var mode = this.getTitleValue('CASE');\n  var operator = Blockly.JavaScript.text_changeCase.OPERATORS[mode];\n  var code;\n  if (operator) {\n    // Upper and lower case are functions built into JavaScript.\n    var argument0 = Blockly.JavaScript.valueToCode(this, 'TEXT',\n        Blockly.JavaScript.ORDER_MEMBER) || '\\'\\'';\n    code = argument0 + operator;\n  } else {\n    if (!Blockly.JavaScript.definitions_['text_toTitleCase']) {\n      // Title case is not a native JavaScript function.  Define one.\n      var functionName = Blockly.JavaScript.variableDB_.getDistinctName(\n          'text_toTitleCase', Blockly.Generator.NAME_TYPE);\n      Blockly.JavaScript.text_changeCase.toTitleCase = functionName;\n      var func = [];\n      func.push('function ' + functionName + '(str) {');\n      func.push('  return str.replace(/\\\\S+/g,');\n      func.push('      function(txt) {return txt[0].toUpperCase() + ' +\n                'txt.substring(1).toLowerCase();});');\n      func.push('}');\n      Blockly.JavaScript.definitions_['text_toTitleCase'] = func.join('\\n');\n    }\n    var argument0 = Blockly.JavaScript.valueToCode(this, 'TEXT',\n        Blockly.JavaScript.ORDER_NONE) || '\\'\\'';\n    code = Blockly.JavaScript.text_changeCase.toTitleCase +\n        '(' + argument0 + ')';\n  }\n  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n\nBlockly.JavaScript.text_changeCase.OPERATORS = {\n  UPPERCASE: '.toUpperCase()',\n  LOWERCASE: '.toLowerCase()',\n  TITLECASE: null\n};\n\nBlockly.JavaScript.text_trim = function() {\n  // Trim spaces.\n  var mode = this.getTitleValue('MODE');\n  var operator = Blockly.JavaScript.text_trim.OPERATORS[mode];\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'TEXT',\n      Blockly.JavaScript.ORDER_MEMBER) || '\\'\\'';\n  return [argument0 + operator, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n\nBlockly.JavaScript.text_trim.OPERATORS = {\n  LEFT: '.trimLeft()',\n  RIGHT: '.trimRight()',\n  BOTH: '.trim()'\n};\n\nBlockly.JavaScript.text_print = function() {\n  // Print statement.\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'TEXT',\n      Blockly.JavaScript.ORDER_NONE) || '\\'\\'';\n  return 'window.alert(' + argument0 + ');\\n';\n};\n\nBlockly.JavaScript.text_prompt = function() {\n  // Prompt function.\n  var msg = Blockly.JavaScript.quote_(this.getTitleValue('TEXT'));\n  var code = 'window.prompt(' + msg + ')';\n  var toNumber = this.getTitleValue('TYPE') == 'NUMBER';\n  if (toNumber) {\n    code = 'window.parseFloat(' + code + ')';\n  }\n  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];\n};\n","/**\n * Visual Blocks Language\n *\n * Copyright 2012 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Generating JavaScript for variable blocks.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\ngoog.provide('Blockly.JavaScript.variables');\n\ngoog.require('Blockly.JavaScript');\n\n\nBlockly.JavaScript.variables_get = function() {\n  // Variable getter.\n  var code = Blockly.JavaScript.translateVarName(this.getTitleValue('VAR'));\n  return [code, Blockly.JavaScript.ORDER_ATOMIC];\n};\n\nBlockly.JavaScript.variables_set = function() {\n  // Variable setter.\n  var argument0 = Blockly.JavaScript.valueToCode(this, 'VALUE',\n      Blockly.JavaScript.ORDER_ASSIGNMENT) || '0';\n  var varName = Blockly.JavaScript.translateVarName(this.getTitleValue('VAR'));\n  return varName + ' = ' + argument0 + ';\\n';\n};\n\nBlockly.JavaScript.parameters_get = Blockly.JavaScript.variables_get;\nBlockly.JavaScript.parameters_set = Blockly.JavaScript.variables_set;\nBlockly.JavaScript.sprite_variables_get = Blockly.JavaScript.variables_get;\nBlockly.JavaScript.sprite_variables_set = Blockly.JavaScript.variables_set;\n","/**\n * Visual Blocks Editor\n *\n * Copyright 2011 Google Inc.\n * http://blockly.googlecode.com/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Core JavaScript library for Blockly.\n * @author fraser@google.com (Neil Fraser)\n */\n'use strict';\n\n// Top level object for Blockly.\ngoog.provide('Blockly');\n\n// Blockly core dependencies.\ngoog.require('Blockly.Block');\ngoog.require('Blockly.Connection');\ngoog.require('Blockly.FieldAngle');\ngoog.require('Blockly.FieldButton');\ngoog.require('Blockly.FieldCheckbox');\ngoog.require('Blockly.FieldColour');\ngoog.require('Blockly.FieldColourDropdown');\ngoog.require('Blockly.FieldDropdown');\ngoog.require('Blockly.FieldAngleDropdown');\ngoog.require('Blockly.FieldAngleTextInput');\ngoog.require('Blockly.FieldIcon');\ngoog.require('Blockly.FieldImage');\ngoog.require('Blockly.FieldImageDropdown');\ngoog.require('Blockly.FieldRectangularDropdown');\ngoog.require('Blockly.FieldTextInput');\ngoog.require('Blockly.FieldVariable');\ngoog.require('Blockly.FieldParameter');\ngoog.require('Blockly.FunctionEditor');\ngoog.require('Blockly.ContractEditor');\ngoog.require('Blockly.TypeDropdown');\ngoog.require('Blockly.DomainEditor');\ngoog.require('Blockly.DomainNameInput');\ngoog.require('Blockly.Generator');\ngoog.require('Blockly.ImageDimensionCache');\ngoog.require('Blockly.FunctionalBlockUtils');\ngoog.require('Blockly.BlockValueType');\ngoog.require('Blockly.FunctionalTypeColors');\ngoog.require('Blockly.Msg');\ngoog.require('Blockly.Procedures');\ngoog.require('Blockly.Toolbox');\ngoog.require('Blockly.WidgetDiv');\ngoog.require('Blockly.BlockSpace');\ngoog.require('Blockly.Blocks');\ngoog.require('Blockly.inject');\ngoog.require('Blockly.utils');\n\n// Closure dependencies.\ngoog.require('goog.dom');\ngoog.require('goog.color');\ngoog.require('goog.events');\ngoog.require('goog.string');\ngoog.require('goog.ui.ColorPicker');\ngoog.require('goog.ui.tree.TreeControl');\ngoog.require('goog.userAgent');\n\n// Blocks\ngoog.require('Blockly.Blocks');\ngoog.require('Blockly.Blocks.colour');\ngoog.require('Blockly.Blocks.functionalExamples');\ngoog.require('Blockly.Blocks.functionalParameters');\ngoog.require('Blockly.Blocks.functionalProcedures');\ngoog.require('Blockly.Blocks.lists');\ngoog.require('Blockly.Blocks.logic');\ngoog.require('Blockly.Blocks.loops');\ngoog.require('Blockly.Blocks.math');\ngoog.require('Blockly.Blocks.procedures');\ngoog.require('Blockly.Blocks.text');\ngoog.require('Blockly.Blocks.unknown');\ngoog.require('Blockly.Blocks.variables');\n\n// Generators\ngoog.require('Blockly.Generator');\ngoog.require('Blockly.JavaScript');\ngoog.require('Blockly.JavaScript.colour');\ngoog.require('Blockly.JavaScript.functionalExamples');\ngoog.require('Blockly.JavaScript.functionalParameters');\ngoog.require('Blockly.JavaScript.functionalProcedures');\ngoog.require('Blockly.JavaScript.lists');\ngoog.require('Blockly.JavaScript.logic');\ngoog.require('Blockly.JavaScript.loops');\ngoog.require('Blockly.JavaScript.math');\ngoog.require('Blockly.JavaScript.procedures');\ngoog.require('Blockly.JavaScript.text');\ngoog.require('Blockly.JavaScript.variables');\n\n/**\n * Returns an absolute URL to an asset in Blockly's directory.\n * Used for loading additional resources.\n * @param path Relative path to be resolved.\n */\nBlockly.assetUrl = undefined;\n\n/**\n * Required name space for SVG elements.\n * @const\n */\nBlockly.SVG_NS = 'http://www.w3.org/2000/svg';\n/**\n * Required name space for HTML elements.\n * @const\n */\nBlockly.HTML_NS = 'http://www.w3.org/1999/xhtml';\n\n/**\n * The richness of block colours, regardless of the hue.\n * Must be in the range of 0 (inclusive) to 1 (exclusive).\n */\nBlockly.HSV_SATURATION = 0.45;\n/**\n * The intensity of block colours, regardless of the hue.\n * Must be in the range of 0 (inclusive) to 1 (exclusive).\n */\nBlockly.HSV_VALUE = 0.65;\n\n/**\n * Convert an HSV model into an RGB hex triplet.\n * @param {number} hue Hue on a colour wheel (0-360).\n * @param {number} saturation The richness of block colours (0-1).\n * @param {number} value The intensity of block colours (0-1).\n * @return {string} RGB code, e.g. '#5ba65b'.\n */\nBlockly.makeColour = function(hue, saturation, value) {\n  return goog.color.hsvToHex(hue, saturation, value * 256);\n};\n\n/** CONNECTION INPUT TYPES */\n/**\n * ENUM for a right-facing value input.  E.g. 'test' or 'return'.\n * @const\n */\nBlockly.INPUT_VALUE = 1;\n/**\n * ENUM for a left-facing value output.  E.g. 'call random'.\n * @const\n */\nBlockly.OUTPUT_VALUE = 2;\n/**\n * ENUM for a down-facing block stack.  E.g. 'then-do' or 'else-do'.\n * @const\n */\nBlockly.NEXT_STATEMENT = 3;\n/**\n * ENUM for an up-facing block stack.  E.g. 'close screen'.\n * @const\n */\nBlockly.PREVIOUS_STATEMENT = 4;\n/**\n * ENUM for an dummy input.  Used to add title(s) with no input.\n * @const\n */\nBlockly.DUMMY_INPUT = 5;\nBlockly.FUNCTIONAL_INPUT = 6;\nBlockly.FUNCTIONAL_OUTPUT = 7;\n\n\n/**\n * ENUM for left alignment.\n * @const\n */\nBlockly.ALIGN_LEFT = -1;\n/**\n * ENUM for centre alignment.\n * @const\n */\nBlockly.ALIGN_CENTRE = 0;\n/**\n * ENUM for right alignment.\n * @const\n */\nBlockly.ALIGN_RIGHT = 1;\n\n/**\n * Lookup table for determining the opposite type of a connection.\n * @const\n */\nBlockly.OPPOSITE_TYPE = [];\nBlockly.OPPOSITE_TYPE[Blockly.INPUT_VALUE] = Blockly.OUTPUT_VALUE;\nBlockly.OPPOSITE_TYPE[Blockly.OUTPUT_VALUE] = Blockly.INPUT_VALUE;\nBlockly.OPPOSITE_TYPE[Blockly.NEXT_STATEMENT] = Blockly.PREVIOUS_STATEMENT;\nBlockly.OPPOSITE_TYPE[Blockly.PREVIOUS_STATEMENT] = Blockly.NEXT_STATEMENT;\nBlockly.OPPOSITE_TYPE[Blockly.FUNCTIONAL_INPUT] = Blockly.FUNCTIONAL_OUTPUT;\nBlockly.OPPOSITE_TYPE[Blockly.FUNCTIONAL_OUTPUT] = Blockly.FUNCTIONAL_INPUT;\n\n/**\n * Currently selected block.\n * @type {Blockly.Block}\n */\nBlockly.selected = null;\n\n/**\n * Is Blockly in a read-only, non-editable mode?\n * Note that this property may only be set before init is called.\n * It can't be used to dynamically toggle editability on and off.\n */\nBlockly.readOnly = false;\n\n/**\n * Whether or not 'unused' blocks (non-top-blocks without a parent)\n * should be rendered differently.\n * @const\n */\nBlockly.showUnusedBlocks = false;\n\n/**\n * Currently highlighted connection (during a drag).\n * @type {Blockly.Connection}\n * @private\n */\nBlockly.highlightedConnection_ = null;\n\n/**\n * Connection on dragged block that matches the highlighted connection.\n * @type {Blockly.Connection}\n * @private\n */\nBlockly.localConnection_ = null;\n\n/**\n * Number of pixels the mouse must move before a drag starts.\n * @const\n */\nBlockly.DRAG_RADIUS = 5;\n\n/**\n * Maximum misalignment between connections for them to snap together.\n * @const\n */\nBlockly.SNAP_RADIUS = 15;\n\n/**\n * Whether unconnected neighors should be explicitly bumped out of alignment\n * @const\n */\nBlockly.BUMP_UNCONNECTED = true;\n\n/**\n * Delay in ms between trigger and bumping unconnected block out of alignment.\n * @const\n */\nBlockly.BUMP_DELAY = 250;\n\n/**\n * Number of characters to truncate a collapsed block to.\n * @const\n */\nBlockly.COLLAPSE_CHARS = 30;\n\n/**\n * The main blockSpace (defined by inject.js).\n * @type {Blockly.BlockSpace}\n */\nBlockly.mainBlockSpace = null;\n\n/**\n * The main editor blockSpace (defined by inject.js).\n * @type {Blockly.BlockSpaceEditor}\n */\nBlockly.mainBlockSpaceEditor = null;\n\n/**\n * Contents of the local clipboard.\n * @type {Element}\n * @private\n */\nBlockly.clipboard_ = null;\n\n/**\n * Attempt to play a sound\n * @param {string} name ID of sound\n */\nBlockly.playAudio = function(name) {\n  if (Blockly.audioPlayer) {\n    Blockly.audioPlayer.play(name);\n  }\n};\n\n/**\n * Deselect any selections on the webpage.\n * Chrome will select text outside the SVG when double-clicking.\n * Deselect this text, so that it doesn't mess up any subsequent drag.\n */\nBlockly.removeAllRanges = function() {\n  function removeAllSafe() {\n    try {\n      window.getSelection().removeAllRanges();\n    } catch (e) {\n      // MSIE throws 'error 800a025e' here.\n    }\n  }\n\n  if (window.getSelection) {  // W3\n    var sel = window.getSelection();\n    if (sel && sel.removeAllRanges) {\n      removeAllSafe();\n      window.setTimeout(function() {\n        removeAllSafe();\n      }, 0);\n    }\n  }\n};\n\nBlockly.assetUrlRoot = \"https://images.k12mlmq.com\";\n","goog.require('Blockly');\ngoog.provide('BlocklyModule');\n\n// Fix goog.Timer\n// goog.global is set to the window object in most places where the closure\n// library is used, but since we build under webpack that is not the case for\n// us. goog.Timer.defaultTimerObject defaults to goog.global, but we need to\n// manually set it to the window object so that it has setTimeout, setInterval,\n// etc.\ngoog.require('goog.Timer');\ngoog.Timer.defaultTimerObject = window;\n\nmodule.exports = Blockly;"],"sourceRoot":""}